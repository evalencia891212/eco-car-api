(self.webpackChunkeco_car_sharing=self.webpackChunkeco_car_sharing||[]).push([[179],{3747:(Sf,Rc,Zs)=>{"use strict";function qr(t){return"function"==typeof t}function Mo(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const vo=Mo(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,s)=>`${s+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function p(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class Ai{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const l of e)l.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(qr(i))try{i()}catch(l){n=l instanceof vo?l.errors:[l]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const l of s)try{El(l)}catch(h){n=n??[],h instanceof vo?n=[...n,...h.errors]:n.push(h)}}if(n)throw new vo(n)}}add(n){var e;if(n&&n!==this)if(this.closed)El(n);else{if(n instanceof Ai){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&p(e,n)}remove(n){const{_finalizers:e}=this;e&&p(e,n),n instanceof Ai&&n._removeParent(this)}}Ai.EMPTY=(()=>{const t=new Ai;return t.closed=!0,t})();const Ra=Ai.EMPTY;function ar(t){return t instanceof Ai||t&&"closed"in t&&qr(t.remove)&&qr(t.add)&&qr(t.unsubscribe)}function El(t){qr(t)?t():t.unsubscribe()}const Di={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ia={setTimeout(t,n,...e){const{delegate:i}=ia;return i?.setTimeout?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=ia;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Wa(t){ia.setTimeout(()=>{const{onUnhandledError:n}=Di;if(!n)throw t;n(t)})}function Sa(){}const Ih=Bh("C",void 0,void 0);function Bh(t,n,e){return{kind:t,value:n,error:e}}let ec=null;function Oc(t){if(Di.useDeprecatedSynchronousErrorHandling){const n=!ec;if(n&&(ec={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=ec;if(ec=null,e)throw i}}else t()}class tc extends Ai{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,ar(n)&&n.add(this)):this.destination=kc}static create(n,e,i){return new Sr(n,e,i)}next(n){this.isStopped?ei(function Ta(t){return Bh("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?ei(function Dh(t){return Bh("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?ei(Ih,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Nn=Function.prototype.bind;function Sl(t,n){return Nn.call(t,n)}class od{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){Jo(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){Jo(i)}else Jo(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){Jo(e)}}}class Sr extends tc{constructor(n,e,i){let s;if(super(),qr(n)||!n)s={next:n??void 0,error:e??void 0,complete:i??void 0};else{let l;this&&Di.useDeprecatedNextContext?(l=Object.create(n),l.unsubscribe=()=>this.unsubscribe(),s={next:n.next&&Sl(n.next,l),error:n.error&&Sl(n.error,l),complete:n.complete&&Sl(n.complete,l)}):s=n}this.destination=new od(s)}}function Jo(t){Di.useDeprecatedSynchronousErrorHandling?function Ul(t){Di.useDeprecatedSynchronousErrorHandling&&ec&&(ec.errorThrown=!0,ec.error=t)}(t):Wa(t)}function ei(t,n){const{onStoppedNotification:e}=Di;e&&ia.setTimeout(()=>e(t,n))}const kc={closed:!0,next:Sa,error:function EA(t){throw t},complete:Sa},ll="function"==typeof Symbol&&Symbol.observable||"@@observable";function ir(t){return t}function Xu(t){return 0===t.length?ir:1===t.length?t[0]:function(e){return t.reduce((i,s)=>s(i),e)}}let Hr=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,s){const l=function kd(t){return t&&t instanceof tc||function Mh(t){return t&&qr(t.next)&&qr(t.error)&&qr(t.complete)}(t)&&ar(t)}(e)?e:new Sr(e,i,s);return Oc(()=>{const{operator:h,source:m}=this;l.add(h?h.call(l,m):m?this._subscribe(l):this._trySubscribe(l))}),l}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=Oa(i))((s,l)=>{const h=new Sr({next:m=>{try{e(m)}catch(b){l(b),h.unsubscribe()}},error:l,complete:s});this.subscribe(h)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[ll](){return this}pipe(...e){return Xu(e)(this)}toPromise(e){return new(e=Oa(e))((i,s)=>{let l;this.subscribe(h=>l=h,h=>s(h),()=>i(l))})}}return t.create=n=>new t(n),t})();function Oa(t){var n;return null!==(n=t??Di.Promise)&&void 0!==n?n:Promise}const Pd=Mo(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Li=(()=>{class t extends Hr{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new Tf(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new Pd}next(e){Oc(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){Oc(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){Oc(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:s,observers:l}=this;return i||s?Ra:(this.currentObservers=null,l.push(e),new Ai(()=>{this.currentObservers=null,p(l,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:s,isStopped:l}=this;i?e.error(s):l&&e.complete()}asObservable(){const e=new Hr;return e.source=this,e}}return t.create=(n,e)=>new Tf(n,e),t})();class Tf extends Li{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:Ra}}function ru(t){return qr(t?.lift)}function Xs(t){return n=>{if(ru(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Kr(t,n,e,i,s){return new dc(t,n,e,i,s)}class dc extends tc{constructor(n,e,i,s,l,h){super(n),this.onFinalize=l,this.shouldUnsubscribe=h,this._next=e?function(m){try{e(m)}catch(b){n.error(b)}}:super._next,this._error=s?function(m){try{s(m)}catch(b){n.error(b)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(m){n.error(m)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function Ht(t,n){return Xs((e,i)=>{let s=0;e.subscribe(Kr(i,l=>{i.next(t.call(n,l,s++))}))})}function zn(t){return this instanceof zn?(this.v=t,this):new zn(t)}function Zn(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function Re(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(l){e[l]=t[l]&&function(h){return new Promise(function(m,b){!function s(l,h,m,b){Promise.resolve(b).then(function(E){l({value:E,done:m})},h)}(m,b,(h=t[l](h)).done,h.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const Za=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Xa(t){return qr(t?.then)}function zl(t){return qr(t[ll])}function ua(t){return Symbol.asyncIterator&&qr(t?.[Symbol.asyncIterator])}function ha(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Jt=function Zt(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Wt(t){return qr(t?.[Jt])}function On(t){return function Vt(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,i=e.apply(t,n||[]),l=[];return s={},h("next"),h("throw"),h("return"),s[Symbol.asyncIterator]=function(){return this},s;function h(G){i[G]&&(s[G]=function(V){return new Promise(function(ne,re){l.push([G,V,ne,re])>1||m(G,V)})})}function m(G,V){try{!function b(G){G.value instanceof zn?Promise.resolve(G.value.v).then(E,M):L(l[0][2],G)}(i[G](V))}catch(ne){L(l[0][3],ne)}}function E(G){m("next",G)}function M(G){m("throw",G)}function L(G,V){G(V),l.shift(),l.length&&m(l[0][0],l[0][1])}}(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:s}=yield zn(e.read());if(s)return yield zn(void 0);yield yield zn(i)}}finally{e.releaseLock()}})}function Bn(t){return qr(t?.getReader)}function gn(t){if(t instanceof Hr)return t;if(null!=t){if(zl(t))return function Gn(t){return new Hr(n=>{const e=t[ll]();if(qr(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(Za(t))return function Ln(t){return new Hr(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(Xa(t))return function ii(t){return new Hr(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,Wa)})}(t);if(ua(t))return ji(t);if(Wt(t))return function Vn(t){return new Hr(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(Bn(t))return function Ur(t){return ji(On(t))}(t)}throw ha(t)}function ji(t){return new Hr(n=>{(function Ci(t,n){var e,i,s,l;return function Mi(t,n,e,i){return new(e||(e=Promise))(function(l,h){function m(M){try{E(i.next(M))}catch(L){h(L)}}function b(M){try{E(i.throw(M))}catch(L){h(L)}}function E(M){M.done?l(M.value):function s(l){return l instanceof e?l:new e(function(h){h(l)})}(M.value).then(m,b)}E((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Zn(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(h){s={error:h}}finally{try{i&&!i.done&&(l=e.return)&&(yield l.call(e))}finally{if(s)throw s.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function Jr(t,n,e,i=0,s=!1){const l=n.schedule(function(){e(),s?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(l),!s)return l}function es(t,n,e=1/0){return qr(n)?es((i,s)=>Ht((l,h)=>n(i,l,s,h))(gn(t(i,s))),e):("number"==typeof n&&(e=n),Xs((i,s)=>function wo(t,n,e,i,s,l,h,m){const b=[];let E=0,M=0,L=!1;const G=()=>{L&&!b.length&&!E&&n.complete()},V=re=>E<i?ne(re):b.push(re),ne=re=>{l&&n.next(re),E++;let de=!1;gn(e(re,M++)).subscribe(Kr(n,fe=>{s?.(fe),l?V(fe):n.next(fe)},()=>{de=!0},void 0,()=>{if(de)try{for(E--;b.length&&E<i;){const fe=b.shift();h?Jr(n,h,()=>ne(fe)):ne(fe)}G()}catch(fe){n.error(fe)}}))};return t.subscribe(Kr(n,V,()=>{L=!0,G()})),()=>{m?.()}}(i,s,t,e)))}function qo(t=1/0){return es(ir,t)}const Fo=new Hr(t=>t.complete());function Su(t){return t&&qr(t.schedule)}function da(t){return t[t.length-1]}function ad(t){return qr(da(t))?t.pop():void 0}function fc(t){return Su(da(t))?t.pop():void 0}function Ld(t,n=0){return Xs((e,i)=>{e.subscribe(Kr(i,s=>Jr(i,t,()=>i.next(s),n),()=>Jr(i,t,()=>i.complete(),n),s=>Jr(i,t,()=>i.error(s),n)))})}function Ud(t,n=0){return Xs((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function kg(t,n){if(!t)throw new Error("Iterable cannot be null");return new Hr(e=>{Jr(e,n,()=>{const i=t[Symbol.asyncIterator]();Jr(e,n,()=>{i.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function Gs(t,n){return n?function TA(t,n){if(null!=t){if(zl(t))return function e_(t,n){return gn(t).pipe(Ud(n),Ld(n))}(t,n);if(Za(t))return function SA(t,n){return new Hr(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(Xa(t))return function ld(t,n){return gn(t).pipe(Ud(n),Ld(n))}(t,n);if(ua(t))return kg(t,n);if(Wt(t))return function Og(t,n){return new Hr(e=>{let i;return Jr(e,n,()=>{i=t[Jt](),Jr(e,n,()=>{let s,l;try{({value:s,done:l}=i.next())}catch(h){return void e.error(h)}l?e.complete():e.next(s)},0,!0)}),()=>qr(i?.return)&&i.return()})}(t,n);if(Bn(t))return function Pg(t,n){return kg(On(t),n)}(t,n)}throw ha(t)}(t,n):gn(t)}function so(...t){const n=fc(t),e=function If(t,n){return"number"==typeof da(t)?t.pop():n}(t,1/0),i=t;return i.length?1===i.length?gn(i[0]):qo(e)(Gs(i,n)):Fo}class Fi extends Li{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:i}=this;if(n)throw e;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function Bi(...t){return Gs(t,fc(t))}function gp(t={}){const{connector:n=(()=>new Li),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:s=!0}=t;return l=>{let h,m,b,E=0,M=!1,L=!1;const G=()=>{m?.unsubscribe(),m=void 0},V=()=>{G(),h=b=void 0,M=L=!1},ne=()=>{const re=h;V(),re?.unsubscribe()};return Xs((re,de)=>{E++,!L&&!M&&G();const fe=b=b??n();de.add(()=>{E--,0===E&&!L&&!M&&(m=mp(ne,s))}),fe.subscribe(de),!h&&E>0&&(h=new Sr({next:he=>fe.next(he),error:he=>{L=!0,G(),m=mp(V,e,he),fe.error(he)},complete:()=>{M=!0,G(),m=mp(V,i),fe.complete()}}),gn(re).subscribe(h))})(l)}}function mp(t,n,...e){if(!0===n)return void t();if(!1===n)return;const i=new Sr({next:()=>{i.unsubscribe(),t()}});return gn(n(...e)).subscribe(i)}function cl(t,n){return Xs((e,i)=>{let s=null,l=0,h=!1;const m=()=>h&&!s&&i.complete();e.subscribe(Kr(i,b=>{s?.unsubscribe();let E=0;const M=l++;gn(t(b,M)).subscribe(s=Kr(i,L=>i.next(n?n(b,L,M,E++):L),()=>{s=null,m()}))},()=>{h=!0,m()}))})}function Tl(t,n=ir){return t=t??t_,Xs((e,i)=>{let s,l=!0;e.subscribe(Kr(i,h=>{const m=n(h);(l||!t(s,m))&&(l=!1,s=m,i.next(h))}))})}function t_(t,n){return t===n}function Ro(t){for(let n in t)if(t[n]===Ro)return n;throw Error("Could not find renamed property on target object.")}function cd(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function Un(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Un).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function Wr(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const ys=Ro({__forward_ref__:Ro});function Nr(t){return t.__forward_ref__=Nr,t.toString=function(){return Un(this())},t}function Br(t){return Qr(t)?t():t}function Qr(t){return"function"==typeof t&&t.hasOwnProperty(ys)&&t.__forward_ref__===Nr}function Df(t){return t&&!!t.\u0275providers}const Tu="https://g.co/ng/security#xss";class ln extends Error{constructor(n,e){super(function Ko(t,n){return`NG0${Math.abs(t)}${n?": "+n:""}`}(n,e)),this.code=n}}function kn(t){return"string"==typeof t?t:null==t?"":String(t)}function zd(t,n){throw new ln(-201,!1)}function qi(t,n,e,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${e} ${i} ${n} <=Actual]`))}function Pn(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function cs(t){return{providers:t.providers||[],imports:t.imports||[]}}function jd(t){return Of(t,kf)||Of(t,ud)}function Of(t,n){return t.hasOwnProperty(n)?t[n]:null}function Ju(t){return t&&(t.hasOwnProperty(Du)||t.hasOwnProperty(Lg))?t[Du]:null}const kf=Ro({\u0275prov:Ro}),Du=Ro({\u0275inj:Ro}),ud=Ro({ngInjectableDef:Ro}),Lg=Ro({ngInjectorDef:Ro});var vs=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(vs||{});let yp;function Pa(t){const n=yp;return yp=t,n}function IA(t,n,e){const i=jd(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&vs.Optional?null:void 0!==n?n:void zd(Un(t))}const Uo=globalThis;class pi{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Pn({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const hd={},dd="__NG_DI_FLAG__",au="ngTempTokenPath",$d=/\n/gm,wp="__source";let Vl;function Nc(t){const n=Vl;return Vl=t,n}function kh(t,n=vs.Default){if(void 0===Vl)throw new ln(-203,!1);return null===Vl?IA(t,void 0,n):Vl.get(t,n&vs.Optional?null:void 0,n)}function Xt(t,n=vs.Default){return(function Oh(){return yp}()||kh)(Br(t),n)}function In(t,n=vs.Default){return Xt(t,Nf(n))}function Nf(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function th(t){const n=[];for(let e=0;e<t.length;e++){const i=Br(t[e]);if(Array.isArray(i)){if(0===i.length)throw new ln(900,!1);let s,l=vs.Default;for(let h=0;h<i.length;h++){const m=i[h],b=ea(m);"number"==typeof b?-1===b?s=m.token:l|=b:s=m}n.push(Xt(s,l))}else n.push(Xt(i))}return n}function nh(t,n){return t[dd]=n,t.prototype[dd]=n,t}function ea(t){return t[dd]}function ih(t){return{toString:t}.toString()}var fd=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(fd||{}),Ac=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Ac||{});const Lc={},Ys=[],ic=Ro({\u0275cmp:Ro}),Bu=Ro({\u0275dir:Ro}),uu=Ro({\u0275pipe:Ro}),Na=Ro({\u0275mod:Ro}),Ia=Ro({\u0275fac:Ro}),Ad=Ro({__NG_ELEMENT_ID__:Ro}),Lf=Ro({__NG_ENV_ID__:Ro});function MA(t,n,e){let i=t.length;for(;;){const s=t.indexOf(n,e);if(-1===s)return s;if(0===s||t.charCodeAt(s-1)<=32){const l=n.length;if(s+l===i||t.charCodeAt(s+l)<=32)return s}e=s+1}}function Kd(t,n,e){let i=0;for(;i<e.length;){const s=e[i];if("number"==typeof s){if(0!==s)break;i++;const l=e[i++],h=e[i++],m=e[i++];t.setAttribute(n,h,m,l)}else{const l=s,h=e[++i];rh(l)?t.setProperty(n,l,h):t.setAttribute(n,l,h),i++}}return i}function Uf(t){return 3===t||4===t||6===t}function rh(t){return 64===t.charCodeAt(0)}function Hl(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const s=n[i];"number"==typeof s?e=s:0===e||FA(t,e,s,null,-1===e||2===e?n[++i]:null)}}return t}function FA(t,n,e,i,s){let l=0,h=t.length;if(-1===n)h=-1;else for(;l<t.length;){const m=t[l++];if("number"==typeof m){if(m===n){h=-1;break}if(m>n){h=l-1;break}}}for(;l<t.length;){const m=t[l];if("number"==typeof m)break;if(m===e){if(null===i)return void(null!==s&&(t[l+1]=s));if(i===t[l+1])return void(t[l+2]=s)}l++,null!==i&&l++,null!==s&&l++}-1!==h&&(t.splice(h,0,n),l=h+1),t.splice(l++,0,e),null!==i&&t.splice(l++,0,i),null!==s&&t.splice(l++,0,s)}const ul="ng-template";function sh(t,n,e){let i=0,s=!0;for(;i<t.length;){let l=t[i++];if("string"==typeof l&&s){const h=t[i++];if(e&&"class"===l&&-1!==MA(h.toLowerCase(),n,0))return!0}else{if(1===l){for(;i<t.length&&"string"==typeof(l=t[i++]);)if(l.toLowerCase()===n)return!0;return!1}"number"==typeof l&&(s=!1)}}return!1}function Ql(t){return 4===t.type&&t.value!==ul}function r_(t,n,e){return n===(4!==t.type||e?t.value:ul)}function R0(t,n,e){let i=4;const s=t.attrs||[],l=function Ep(t){for(let n=0;n<t.length;n++)if(Uf(t[n]))return n;return t.length}(s);let h=!1;for(let m=0;m<n.length;m++){const b=n[m];if("number"!=typeof b){if(!h)if(4&i){if(i=2|1&i,""!==b&&!r_(t,b,e)||""===b&&1===n.length){if(va(i))return!1;h=!0}}else{const E=8&i?b:n[++m];if(8&i&&null!==t.attrs){if(!sh(t.attrs,E,e)){if(va(i))return!1;h=!0}continue}const L=Wd(8&i?"class":b,s,Ql(t),e);if(-1===L){if(va(i))return!1;h=!0;continue}if(""!==E){let G;G=L>l?"":s[L+1].toLowerCase();const V=8&i?G:null;if(V&&-1!==MA(V,E,0)||2&i&&E!==G){if(va(i))return!1;h=!0}}}}else{if(!h&&!va(i)&&!va(b))return!1;if(h&&va(b))continue;h=!1,i=b|1&i}}return va(i)||h}function va(t){return 0==(1&t)}function Wd(t,n,e,i){if(null===n)return-1;let s=0;if(i||!e){let l=!1;for(;s<n.length;){const h=n[s];if(h===t)return s;if(3===h||6===h)l=!0;else{if(1===h||2===h){let m=n[++s];for(;"string"==typeof m;)m=n[++s];continue}if(4===h)break;if(0===h){s+=4;continue}}s+=l?1:2}return-1}return function Zd(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function xp(t,n,e=!1){for(let i=0;i<n.length;i++)if(R0(t,n[i],e))return!0;return!1}function s_(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let s=0;s<t.length;s++)if(t[s]!==i[s])continue e;return!0}}return!1}function Xd(t,n){return t?":not("+n.trim()+")":n}function Vg(t){let n=t[0],e=1,i=2,s="",l=!1;for(;e<t.length;){let h=t[e];if("string"==typeof h)if(2&i){const m=t[++e];s+="["+h+(m.length>0?'="'+m+'"':"")+"]"}else 8&i?s+="."+h:4&i&&(s+=" "+h);else""!==s&&!va(h)&&(n+=Xd(l,s),s=""),i=h,l=l||!va(i);e++}return""!==s&&(n+=Xd(l,s)),n}function Mr(t){return ih(()=>{const n=zf(t),e={...n,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===fd.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Ac.Emulated,styles:t.styles||Ys,_:null,schemas:t.schemas||null,tView:null,id:""};Yd(e);const i=t.dependencies;return e.directiveDefs=Vf(i,!1),e.pipeDefs=Vf(i,!0),e.id=function ah(t){let n=0;const e=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const s of e)n=Math.imul(31,n)+s.charCodeAt(0)<<0;return n+=2147483648,"c"+n}(e),e})}function Sp(t){return Is(t)||dl(t)}function Hg(t){return null!==t}function ps(t){return ih(()=>({type:t.type,bootstrap:t.bootstrap||Ys,declarations:t.declarations||Ys,imports:t.imports||Ys,exports:t.exports||Ys,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function Qg(t,n){if(null==t)return Lc;const e={};for(const i in t)if(t.hasOwnProperty(i)){let s=t[i],l=s;Array.isArray(s)&&(l=s[1],s=s[0]),e[s]=i,n&&(n[s]=l)}return e}function Xn(t){return ih(()=>{const n=zf(t);return Yd(n),n})}function hl(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function Is(t){return t[ic]||null}function dl(t){return t[Bu]||null}function fl(t){return t[uu]||null}function ra(t,n){const e=t[Na]||null;if(!e&&!0===n)throw new Error(`Type ${Un(t)} does not have '\u0275mod' property.`);return e}function zf(t){const n={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:t.inputs||Lc,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||Ys,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Qg(t.inputs,n),outputs:Qg(t.outputs)}}function Yd(t){t.features?.forEach(n=>n(t))}function Vf(t,n){if(!t)return null;const e=n?fl:Sp;return()=>("function"==typeof t?t():t).map(i=>e(i)).filter(Hg)}const Zi=0,Oi=1,gs=2,Wo=3,pc=4,Hf=5,jl=6,pd=7,Da=8,gc=9,lh=10,Zr=11,Qf=12,jf=13,ch=14,ba=15,Tp=16,OA=17,uh=18,Ip=19,jg=20,Ph=21,Nh=22,Gf=23,$f=24,Ds=25,Dp=1,gd=2,mc=7,Uc=9,Ya=11;function _c(t){return Array.isArray(t)&&"object"==typeof t[Dp]}function Gl(t){return Array.isArray(t)&&!0===t[Dp]}function PA(t){return 0!=(4&t.flags)}function Jd(t){return t.componentOffset>-1}function _d(t){return 1==(1&t.flags)}function yc(t){return!!t.template}function c_(t){return 0!=(512&t[gs])}function zc(t,n){return t.hasOwnProperty(Ia)?t[Ia]:null}let $s=null,Rp=!1;function hu(t){const n=$s;return $s=t,n}const Zg={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Yg(t){if(!$l(t)||t.dirty){if(!t.producerMustRecompute(t)&&!em(t))return void(t.dirty=!1);t.producerRecomputeValue(t),t.dirty=!1}}function vc(t){t.dirty=!0,function Op(t){if(void 0===t.liveConsumerNode)return;const n=Rp;Rp=!0;try{for(const e of t.liveConsumerNode)e.dirty||vc(e)}finally{Rp=n}}(t),t.consumerMarkedDirty?.(t)}function zh(t){return t&&(t.nextProducerIndex=0),hu(t)}function Jg(t,n){if(hu(n),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if($l(t))for(let e=t.nextProducerIndex;e<t.producerNode.length;e++)Pi(t.producerNode[e],t.producerIndexOfThis[e]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function em(t){uo(t);for(let n=0;n<t.producerNode.length;n++){const e=t.producerNode[n],i=t.producerLastReadVersion[n];if(i!==e.version||(Yg(e),i!==e.version))return!0}return!1}function tm(t){if(uo(t),$l(t))for(let n=0;n<t.producerNode.length;n++)Pi(t.producerNode[n],t.producerIndexOfThis[n]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Pi(t,n){if(function Kf(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}(t),uo(t),1===t.liveConsumerNode.length)for(let i=0;i<t.producerNode.length;i++)Pi(t.producerNode[i],t.producerIndexOfThis[i]);const e=t.liveConsumerNode.length-1;if(t.liveConsumerNode[n]=t.liveConsumerNode[e],t.liveConsumerIndexOfThis[n]=t.liveConsumerIndexOfThis[e],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,n<t.liveConsumerNode.length){const i=t.liveConsumerIndexOfThis[n],s=t.liveConsumerNode[n];uo(s),s.producerIndexOfThis[i]=n}}function $l(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function uo(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}let LA=null;const V0=()=>{},H0=(()=>({...Zg,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:t=>{t.schedule(t.ref)},hasRun:!1,cleanupFn:V0}))();class VA{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function Zo(){return A_}function A_(t){return t.type.prototype.ngOnChanges&&(t.setInput=Lp),Np}function Np(){const t=yd(this),n=t?.current;if(n){const e=t.previous;if(e===Lc)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function Lp(t,n,e,i){const s=this.declaredInputs[e],l=yd(t)||function Vc(t,n){return t[sm]=n}(t,{previous:Lc,current:null}),h=l.current||(l.current={}),m=l.previous,b=m[s];h[s]=new VA(b&&b.currentValue,n,m===Lc),t[i]=n}Zo.ngInherit=!0;const sm="__ngSimpleChanges__";function yd(t){return t[sm]||null}const Bs=function(t,n,e){};function Hs(t){for(;Array.isArray(t);)t=t[Zi];return t}function Hc(t,n){return Hs(n[t])}function ql(t,n){return Hs(n[t.index])}function Hh(t,n){return t.data[n]}function Ja(t,n){const e=n[t];return _c(e)?e:e[Zi]}function La(t,n){return null==n?null:t[n]}function fu(t){t[OA]=0}function g_(t){1024&t[gs]||(t[gs]|=1024,Vp(t,1))}function jA(t){1024&t[gs]&&(t[gs]&=-1025,Vp(t,-1))}function Vp(t,n){let e=t[Wo];if(null===e)return;e[Hf]+=n;let i=e;for(e=e[Wo];null!==e&&(1===n&&1===i[Hf]||-1===n&&0===i[Hf]);)e[Hf]+=n,i=e,e=e[Wo]}const Ir={lFrame:bd(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function GA(){return Ir.bindingsEnabled}function Au(){return null!==Ir.skipHydrationRootTNode}function Qn(){return Ir.lFrame.lView}function Js(){return Ir.lFrame.tView}function ti(t){return Ir.lFrame.contextLView=t,t[Da]}function ni(t){return Ir.lFrame.contextLView=null,t}function Dl(){let t=y_();for(;null!==t&&64===t.type;)t=t.parent;return t}function y_(){return Ir.lFrame.currentTNode}function vd(){const t=Ir.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}function ph(t,n){const e=Ir.lFrame;e.currentTNode=t,e.isParent=n}function hm(){return Ir.lFrame.isParent}function rf(){Ir.lFrame.isParent=!1}function pl(){const t=Ir.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Qh(){return Ir.lFrame.bindingIndex}function jh(){return Ir.lFrame.bindingIndex++}function Mu(t){const n=Ir.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function qA(t){Ir.lFrame.inI18n=t}function G0(t,n){const e=Ir.lFrame;e.bindingIndex=e.bindingRootIndex=t,Xf(n)}function Xf(t){Ir.lFrame.currentDirectiveIndex=t}function dm(){return Ir.lFrame.currentQueryIndex}function KA(t){Ir.lFrame.currentQueryIndex=t}function fm(t){const n=t[Oi];return 2===n.type?n.declTNode:1===n.type?t[jl]:null}function pu(t,n,e){if(e&vs.SkipSelf){let s=n,l=t;for(;!(s=s.parent,null!==s||e&vs.Host||(s=fm(l),null===s||(l=l[ch],10&s.type))););if(null===s)return!1;n=s,t=l}const i=Ir.lFrame=Bl();return i.currentTNode=n,i.lView=t,!0}function Yf(t){const n=Bl(),e=t[Oi];Ir.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function Bl(){const t=Ir.lFrame,n=null===t?null:t.child;return null===n?bd(t):n}function bd(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function w_(){const t=Ir.lFrame;return Ir.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const _=w_;function c(){const t=w_();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function w(){return Ir.lFrame.selectedIndex}function C(t){Ir.lFrame.selectedIndex=t}function I(){const t=Ir.lFrame;return Hh(t.tView,t.selectedIndex)}let J=!0;function te(){return J}function le(t){J=t}function Ae(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const l=t.data[e].type.prototype,{ngAfterContentInit:h,ngAfterContentChecked:m,ngAfterViewInit:b,ngAfterViewChecked:E,ngOnDestroy:M}=l;h&&(t.contentHooks??=[]).push(-e,h),m&&((t.contentHooks??=[]).push(e,m),(t.contentCheckHooks??=[]).push(e,m)),b&&(t.viewHooks??=[]).push(-e,b),E&&((t.viewHooks??=[]).push(e,E),(t.viewCheckHooks??=[]).push(e,E)),null!=M&&(t.destroyHooks??=[]).push(e,M)}}function se(t,n,e){xe(t,n,3,e)}function me(t,n,e,i){(3&t[gs])===e&&xe(t,n,e,i)}function Ie(t,n){let e=t[gs];(3&e)===n&&(e&=8191,e+=1,t[gs]=e)}function xe(t,n,e,i){const l=i??-1,h=n.length-1;let m=0;for(let b=void 0!==i?65535&t[OA]:0;b<h;b++)if("number"==typeof n[b+1]){if(m=n[b],null!=i&&m>=i)break}else n[b]<0&&(t[OA]+=65536),(m<l||-1==l)&&(ge(t,e,n,b),t[OA]=(4294901760&t[OA])+b+2),b++}function Be(t,n){Bs(4,t,n);const e=hu(null);try{n.call(t)}finally{hu(e),Bs(5,t,n)}}function ge(t,n,e,i){const s=e[i]<0,l=e[i+1],m=t[s?-e[i]:e[i]];s?t[gs]>>13<t[OA]>>16&&(3&t[gs])===n&&(t[gs]+=8192,Be(m,l)):Be(m,l)}const Me=-1;class He{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function St(t){return t!==Me}function Ze(t){return 32767&t}function An(t,n){let e=function gt(t){return t>>16}(t),i=n;for(;e>0;)i=i[ch],e--;return i}let Tn=!0;function Cn(t){const n=Tn;return Tn=t,n}const li=255,xi=5;let yi=0;const ci={};function Ki(t,n){const e=rr(t,n);if(-1!==e)return e;const i=n[Oi];i.firstCreatePass&&(t.injectorIndex=n.length,lr(i.data,t),lr(n,null),lr(i.blueprint,null));const s=kr(t,n),l=t.injectorIndex;if(St(s)){const h=Ze(s),m=An(s,n),b=m[Oi].data;for(let E=0;E<8;E++)n[l+E]=m[h+E]|b[h+E]}return n[l+8]=s,l}function lr(t,n){t.push(0,0,0,0,0,0,0,0,n)}function rr(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function kr(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,s=n;for(;null!==s;){if(i=Si(s),null===i)return Me;if(e++,s=s[ch],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return Me}function qs(t,n,e){!function gr(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Ad)&&(i=e[Ad]),null==i&&(i=e[Ad]=yi++);const s=i&li;n.data[t+(s>>xi)]|=1<<s}(t,n,e)}function Po(t,n,e){if(e&vs.Optional||void 0!==t)return t;zd()}function Dr(t,n,e,i){if(e&vs.Optional&&void 0===i&&(i=null),!(e&(vs.Self|vs.Host))){const s=t[gc],l=Pa(void 0);try{return s?s.get(n,i,e&vs.Optional):IA(n,i,e&vs.Optional)}finally{Pa(l)}}return Po(i,0,e)}function jr(t,n,e,i=vs.Default,s){if(null!==t){if(2048&n[gs]&&!(i&vs.Self)){const h=function $c(t,n,e,i,s){let l=t,h=n;for(;null!==l&&null!==h&&2048&h[gs]&&!(512&h[gs]);){const m=br(l,h,e,i|vs.Self,ci);if(m!==ci)return m;let b=l.parent;if(!b){const E=h[jg];if(E){const M=E.get(e,ci,i);if(M!==ci)return M}b=Si(h),h=h[ch]}l=b}return s}(t,n,e,i,ci);if(h!==ci)return h}const l=br(t,n,e,i,ci);if(l!==ci)return l}return Dr(n,e,i,s)}function br(t,n,e,i,s){const l=function za(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(Ad)?t[Ad]:void 0;return"number"==typeof n?n>=0?n&li:fa:n}(e);if("function"==typeof l){if(!pu(n,t,i))return i&vs.Host?Po(s,0,i):Dr(n,e,i,s);try{let h;if(h=l(i),null!=h||i&vs.Optional)return h;zd()}finally{_()}}else if("number"==typeof l){let h=null,m=rr(t,n),b=Me,E=i&vs.Host?n[ba][jl]:null;for((-1===m||i&vs.SkipSelf)&&(b=-1===m?kr(t,n):n[m+8],b!==Me&&bc(i,!1)?(h=n[Oi],m=Ze(b),n=An(b,n)):m=-1);-1!==m;){const M=n[Oi];if(gl(l,m,M.data)){const L=Xr(m,n,e,h,i,E);if(L!==ci)return L}b=n[m+8],b!==Me&&bc(i,n[Oi].data[m+8]===E)&&gl(l,m,n)?(h=M,m=Ze(b),n=An(b,n)):m=-1}}return s}function Xr(t,n,e,i,s,l){const h=n[Oi],m=h.data[t+8],M=eo(m,h,e,null==i?Jd(m)&&Tn:i!=h&&0!=(3&m.type),s&vs.Host&&l===m);return null!==M?zr(n,h,M,m):ci}function eo(t,n,e,i,s){const l=t.providerIndexes,h=n.data,m=1048575&l,b=t.directiveStart,M=l>>20,G=s?m+M:t.directiveEnd;for(let V=i?m:m+M;V<G;V++){const ne=h[V];if(V<b&&e===ne||V>=b&&ne.type===e)return V}if(s){const V=h[b];if(V&&yc(V)&&V.type===e)return b}return null}function zr(t,n,e,i){let s=t[e];const l=n.data;if(function Ge(t){return t instanceof He}(s)){const h=s;h.resolving&&function or(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new ln(-200,`Circular dependency in DI detected for ${t}${e}`)}(function Ts(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():kn(t)}(l[e]));const m=Cn(h.canSeeViewProviders);h.resolving=!0;const E=h.injectImpl?Pa(h.injectImpl):null;pu(t,i,vs.Default);try{s=t[e]=h.factory(void 0,l,t,i),n.firstCreatePass&&e>=i.directiveStart&&function ce(t,n,e){const{ngOnChanges:i,ngOnInit:s,ngDoCheck:l}=n.type.prototype;if(i){const h=A_(n);(e.preOrderHooks??=[]).push(t,h),(e.preOrderCheckHooks??=[]).push(t,h)}s&&(e.preOrderHooks??=[]).push(0-t,s),l&&((e.preOrderHooks??=[]).push(t,l),(e.preOrderCheckHooks??=[]).push(t,l))}(e,l[e],n)}finally{null!==E&&Pa(E),Cn(m),h.resolving=!1,_()}}return s}function gl(t,n,e){return!!(e[n+(t>>xi)]&1<<t)}function bc(t,n){return!(t&vs.Self||t&vs.Host&&n)}class oo{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return jr(this._tNode,this._lView,n,Nf(i),e)}}function fa(){return new oo(Dl(),Qn())}function Ms(t){return ih(()=>{const n=t.prototype.constructor,e=n[Ia]||ml(n),i=Object.prototype;let s=Object.getPrototypeOf(t.prototype).constructor;for(;s&&s!==i;){const l=s[Ia]||ml(s);if(l&&l!==e)return l;s=Object.getPrototypeOf(s)}return l=>new l})}function ml(t){return Qr(t)?()=>{const n=ml(Br(t));return n&&n()}:zc(t)}function Si(t){const n=t[Oi],e=n.type;return 2===e?n.declTNode:1===e?t[jl]:null}function _l(t){return function Fr(t,n){if("class"===n)return t.classes;if("style"===n)return t.styles;const e=t.attrs;if(e){const i=e.length;let s=0;for(;s<i;){const l=e[s];if(Uf(l))break;if(0===l)s+=2;else if("number"==typeof l)for(s++;s<i&&"string"==typeof e[s];)s++;else{if(l===n)return e[s+1];s+=2}}}return null}(Dl(),t)}const Va="__parameters__";function qc(t,n,e){return ih(()=>{const i=function Eo(t){return function(...e){if(t){const i=t(...e);for(const s in i)this[s]=i[s]}}}(n);function s(...l){if(this instanceof s)return i.apply(this,l),this;const h=new s(...l);return m.annotation=h,m;function m(b,E,M){const L=b.hasOwnProperty(Va)?b[Va]:Object.defineProperty(b,Va,{value:[]})[Va];for(;L.length<=M;)L.push(null);return(L[M]=L[M]||[]).push(h),b}}return e&&(s.prototype=Object.create(e.prototype)),s.prototype.ngMetadataName=t,s.annotationCls=s,s})}function pm(t,n){t.forEach(e=>Array.isArray(e)?pm(e,n):n(e))}function wb(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function mo(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function af(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}function ks(t,n,e){let i=Fl(t,n);return i>=0?t[1|i]=e:(i=~i,function E_(t,n,e,i){let s=t.length;if(s==n)t.push(e,i);else if(1===s)t.push(i,t[0]),t[0]=e;else{for(s--,t.push(t[s-1],t[s]);s>n;)t[s]=t[s-2],s--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function Gp(t,n){const e=Fl(t,n);if(e>=0)return t[1|e]}function Fl(t,n){return function wv(t,n,e){let i=0,s=t.length>>e;for(;s!==i;){const l=i+(s-i>>1),h=t[l<<e];if(n===h)return l<<e;h>n?s=l:i=l+1}return~(s<<e)}(t,n,1)}const Vo=nh(qc("Optional"),8),S_=nh(qc("SkipSelf"),4);function qh(t){return 128==(128&t.flags)}var gu=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(gu||{});const Kh=/^>|^->|<!--|-->|--!>|<!-$/g,ZA=/(<|>)/g,cf="\u200b$1\u200b";const YA=new Map;let WS=0;const xd="__ngContext__";function Pu(t,n){_c(n)?(t[xd]=n[Ip],function Jf(t){YA.set(t[Ip],t)}(n)):t[xd]=n}let Bb;function W0(t,n){return Bb(t,n)}function I_(t){const n=t[Wo];return Gl(n)?n[Wo]:n}function SC(t){return IC(t[Qf])}function TC(t){return IC(t[pc])}function IC(t){for(;null!==t&&!Gl(t);)t=t[pc];return t}function B_(t,n,e,i,s){if(null!=i){let l,h=!1;Gl(i)?l=i:_c(i)&&(h=!0,i=i[Zi]);const m=Hs(i);0===t&&null!==e?null==s?Ob(n,e,m):Kp(n,e,m,s||null,!0):1===t&&null!==e?Kp(n,e,m,s||null,!0):2===t?X0(n,m,h):3===t&&n.destroyNode(m),null!=l&&function LC(t,n,e,i,s){const l=e[mc];l!==Hs(e)&&B_(n,t,i,l,s);for(let m=Ya;m<e.length;m++){const b=e[m];Y0(b[Oi],b,t,n,i,l)}}(n,t,l,e,s)}}function Dv(t,n){return t.createText(n)}function DC(t,n,e){t.setValue(n,e)}function Mb(t,n){return t.createComment(function XA(t){return t.replace(Kh,n=>n.replace(ZA,cf))}(n))}function Bv(t,n,e){return t.createElement(n,e)}function iT(t,n){const e=t[Uc],i=e.indexOf(n);jA(n),e.splice(i,1)}function Fb(t,n){if(t.length<=Ya)return;const e=Ya+n,i=t[e];if(i){const s=i[Tp];null!==s&&s!==t&&iT(s,i),n>0&&(t[e-1][pc]=i[pc]);const l=mo(t,Ya+n);!function wF(t,n){Y0(t,n,n[Zr],2,null,null),n[Zi]=null,n[jl]=null}(i[Oi],i);const h=l[uh];null!==h&&h.detachView(l[Oi]),i[Wo]=null,i[pc]=null,i[gs]&=-129}return i}function MC(t,n){if(!(256&n[gs])){const e=n[Zr];n[Gf]&&tm(n[Gf]),n[$f]&&tm(n[$f]),e.destroyNode&&Y0(t,n,e,3,null,null),function CF(t){let n=t[Qf];if(!n)return FC(t[Oi],t);for(;n;){let e=null;if(_c(n))e=n[Qf];else{const i=n[Ya];i&&(e=i)}if(!e){for(;n&&!n[pc]&&n!==t;)_c(n)&&FC(n[Oi],n),n=n[Wo];null===n&&(n=t),_c(n)&&FC(n[Oi],n),e=n&&n[pc]}n=e}}(n)}}function FC(t,n){if(!(256&n[gs])){n[gs]&=-129,n[gs]|=256,function IF(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const s=n[e[i]];if(!(s instanceof He)){const l=e[i+1];if(Array.isArray(l))for(let h=0;h<l.length;h+=2){const m=s[l[h]],b=l[h+1];Bs(4,m,b);try{b.call(m)}finally{Bs(5,m,b)}}else{Bs(4,s,l);try{l.call(s)}finally{Bs(5,s,l)}}}}}(t,n),function TF(t,n){const e=t.cleanup,i=n[pd];if(null!==e)for(let l=0;l<e.length-1;l+=2)if("string"==typeof e[l]){const h=e[l+3];h>=0?i[h]():i[-h].unsubscribe(),l+=2}else e[l].call(i[e[l+1]]);null!==i&&(n[pd]=null);const s=n[Ph];if(null!==s){n[Ph]=null;for(let l=0;l<s.length;l++)(0,s[l])()}}(t,n),1===n[Oi].type&&n[Zr].destroy();const e=n[Tp];if(null!==e&&Gl(n[Wo])){e!==n[Wo]&&iT(e,n);const i=n[uh];null!==i&&i.detachView(t)}!function ZS(t){YA.delete(t[Ip])}(n)}}function Rb(t,n,e){return eA(t,n.parent,e)}function eA(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[Zi];{const{componentOffset:s}=i;if(s>-1){const{encapsulation:l}=t.data[i.directiveStart+s];if(l===Ac.None||l===Ac.Emulated)return null}return ql(i,e)}}function Kp(t,n,e,i,s){t.insertBefore(n,e,i,s)}function Ob(t,n,e){t.appendChild(n,e)}function Z0(t,n,e,i,s){null!==i?Kp(t,n,e,i,s):Ob(t,n,e)}function Mv(t,n){return t.parentNode(n)}function ta(t,n,e){return Fv(t,n,e)}function sT(t,n,e){return 40&t.type?ql(t,e):null}let OC,J0,Pb,Nb,Fv=sT;function kC(t,n){Fv=t,OC=n}function M_(t,n,e,i){const s=Rb(t,i,n),l=n[Zr],m=ta(i.parent||n[jl],i,n);if(null!=s)if(Array.isArray(e))for(let b=0;b<e.length;b++)Z0(l,s,e[b],m,!1);else Z0(l,s,e,m,!1);void 0!==OC&&OC(l,i,n,e,s)}function Rv(t,n){if(null!==n){const e=n.type;if(3&e)return ql(n,t);if(4&e)return NC(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return Rv(t,i);{const s=t[n.index];return Gl(s)?NC(-1,s):Hs(s)}}if(32&e)return W0(n,t)()||Hs(t[n.index]);{const i=PC(t,n);return null!==i?Array.isArray(i)?i[0]:Rv(I_(t[ba]),i):Rv(t,n.next)}}return null}function PC(t,n){return null!==n?t[ba][jl].projection[n.projection]:null}function NC(t,n){const e=Ya+t+1;if(e<n.length){const i=n[e],s=i[Oi].firstChild;if(null!==s)return Rv(i,s)}return n[mc]}function X0(t,n,e){const i=Mv(t,n);i&&function rT(t,n,e,i){t.removeChild(n,e,i)}(t,i,n,e)}function nA(t,n,e,i,s,l,h){for(;null!=e;){const m=i[e.index],b=e.type;if(h&&0===n&&(m&&Pu(Hs(m),i),e.flags|=2),32!=(32&e.flags))if(8&b)nA(t,n,e.child,i,s,l,!1),B_(n,t,s,m,l);else if(32&b){const E=W0(e,i);let M;for(;M=E();)B_(n,t,s,M,l);B_(n,t,s,m,l)}else 16&b?Ov(t,n,i,e,s,l):B_(n,t,s,m,l);e=h?e.projectionNext:e.next}}function Y0(t,n,e,i,s,l){nA(e,i,t.firstChild,n,s,l,!1)}function Ov(t,n,e,i,s,l){const h=e[ba],b=h[jl].projection[i.projection];if(Array.isArray(b))for(let E=0;E<b.length;E++)B_(n,t,s,b[E],l);else{let E=b;const M=h[Wo];qh(i)&&(E.flags|=128),nA(t,n,E,M,s,l,!0)}}function UC(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function Pv(t,n,e){const{mergedAttrs:i,classes:s,styles:l}=e;null!==i&&Kd(t,n,i),null!==s&&UC(t,n,s),null!==l&&function kb(t,n,e){t.setAttribute(n,"style",e)}(t,n,l)}function F_(t){return function Nv(){if(void 0===J0&&(J0=null,Uo.trustedTypes))try{J0=Uo.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return J0}()?.createHTML(t)||t}function ey(){if(void 0!==Pb)return Pb;if(typeof document<"u")return document;throw new ln(210,!1)}function HC(t){return function Lb(){if(void 0===Nb&&(Nb=null,Uo.trustedTypes))try{Nb=Uo.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Nb}()?.createScriptURL(t)||t}class cT{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Tu})`}}function gh(t){return t instanceof cT?t.changingThisBreaksApplicationSecurity:t}function mu(t,n){const e=function fT(t){return t instanceof cT&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${Tu})`)}return e===n}class RF{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(F_(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch{return null}}}class jC{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const e=this.inertDocument.createElement("template");return e.innerHTML=F_(n),e}}const pT=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Wp(t){return(t=String(t)).match(pT)?t:"unsafe:"+t}function Cd(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function Lv(...t){const n={};for(const e of t)for(const i in e)e.hasOwnProperty(i)&&(n[i]=!0);return n}const gT=Cd("area,br,col,hr,img,wbr"),mT=Cd("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),_T=Cd("rp,rt"),Uv=Lv(gT,Lv(mT,Cd("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Lv(_T,Cd("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Lv(_T,mT)),GC=Cd("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),il=Lv(GC,Cd("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Cd("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"));var mm=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(mm||{});function bT(t){const n=Hv();return n?n.sanitize(mm.URL,t)||"":mu(t,"URL")?gh(t):Wp(kn(t))}function Gb(t){const n=Hv();if(n)return HC(n.sanitize(mm.RESOURCE_URL,t)||"");if(mu(t,"ResourceURL"))return HC(gh(t));throw new ln(904,!1)}function Hv(){const t=Qn();return t&&t[lh].sanitizer}const Qv=new pi("ENVIRONMENT_INITIALIZER"),xT=new pi("INJECTOR",-1),jv=new pi("INJECTOR_DEF_TYPES");class ZC{get(n,e=hd){if(e===hd){const i=new Error(`NullInjectorError: No provider for ${Un(n)}!`);throw i.name="NullInjectorError",i}return e}}function ny(t){return{\u0275providers:t}}function iy(...t){return{\u0275providers:CT(0,t),\u0275fromNgModule:!0}}function CT(t,...n){const e=[],i=new Set;let s;const l=h=>{e.push(h)};return pm(n,h=>{const m=h;$b(m,l,[],i)&&(s||=[],s.push(m))}),void 0!==s&&ET(s,l),e}function ET(t,n){for(let e=0;e<t.length;e++){const{ngModule:i,providers:s}=t[e];qb(s,l=>{n(l,i)})}}function $b(t,n,e,i){if(!(t=Br(t)))return!1;let s=null,l=Ju(t);const h=!l&&Is(t);if(l||h){if(h&&!h.standalone)return!1;s=t}else{const b=t.ngModule;if(l=Ju(b),!l)return!1;s=b}const m=i.has(s);if(h){if(m)return!1;if(i.add(s),h.dependencies){const b="function"==typeof h.dependencies?h.dependencies():h.dependencies;for(const E of b)$b(E,n,e,i)}}else{if(!l)return!1;{if(null!=l.imports&&!m){let E;i.add(s);try{pm(l.imports,M=>{$b(M,n,e,i)&&(E||=[],E.push(M))})}finally{}void 0!==E&&ET(E,n)}if(!m){const E=zc(s)||(()=>new s);n({provide:s,useFactory:E,deps:Ys},s),n({provide:jv,useValue:s,multi:!0},s),n({provide:Qv,useValue:()=>Xt(s),multi:!0},s)}const b=l.providers;if(null!=b&&!m){const E=t;qb(b,M=>{n(M,E)})}}}return s!==t&&void 0!==t.providers}function qb(t,n){for(let e of t)Df(e)&&(e=e.\u0275providers),Array.isArray(e)?qb(e,n):n(e)}const NF=Ro({provide:String,useValue:Ro});function XC(t){return null!==t&&"object"==typeof t&&NF in t}function JA(t){return"function"==typeof t}const ry=new pi("Set Injector scope."),Gv={},TT={};let Zb;function Xb(){return void 0===Zb&&(Zb=new ZC),Zb}class Lu{}class O_ extends Lu{get destroyed(){return this._destroyed}constructor(n,e,i,s){super(),this.parent=e,this.source=i,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,JC(n,h=>this.processProvider(h)),this.records.set(xT,k_(void 0,this)),s.has("environment")&&this.records.set(Lu,k_(void 0,this));const l=this.records.get(ry);null!=l&&"string"==typeof l.value&&this.scopes.add(l.value),this.injectorDefTypes=new Set(this.get(jv.multi,Ys,vs.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const e of n)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const e=Nc(this),i=Pa(void 0);try{return n()}finally{Nc(e),Pa(i)}}get(n,e=hd,i=vs.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(Lf))return n[Lf](this);i=Nf(i);const l=Nc(this),h=Pa(void 0);try{if(!(i&vs.SkipSelf)){let b=this.records.get(n);if(void 0===b){const E=function _m(t){return"function"==typeof t||"object"==typeof t&&t instanceof pi}(n)&&jd(n);b=E&&this.injectableDefInScope(E)?k_(Yb(n),Gv):null,this.records.set(n,b)}if(null!=b)return this.hydrate(n,b)}return(i&vs.Self?Xb():this.parent).get(n,e=i&vs.Optional&&e===hd?null:e)}catch(m){if("NullInjectorError"===m.name){if((m[au]=m[au]||[]).unshift(Un(n)),l)throw m;return function M0(t,n,e,i){const s=t[au];throw n[wp]&&s.unshift(n[wp]),t.message=function F0(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let s=Un(n);if(Array.isArray(n))s=n.map(Un).join(" -> ");else if("object"==typeof n){let l=[];for(let h in n)if(n.hasOwnProperty(h)){let m=n[h];l.push(h+":"+("string"==typeof m?JSON.stringify(m):Un(m)))}s=`{${l.join(", ")}}`}return`${e}${i?"("+i+")":""}[${s}]: ${t.replace($d,"\n  ")}`}("\n"+t.message,s,e,i),t.ngTokenPath=s,t[au]=null,t}(m,n,"R3InjectorError",this.source)}throw m}finally{Pa(h),Nc(l)}}resolveInjectorInitializers(){const n=Nc(this),e=Pa(void 0);try{const s=this.get(Qv.multi,Ys,vs.Self);for(const l of s)l()}finally{Nc(n),Pa(e)}}toString(){const n=[],e=this.records;for(const i of e.keys())n.push(Un(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ln(205,!1)}processProvider(n){let e=JA(n=Br(n))?n:Br(n&&n.provide);const i=function DT(t){return XC(t)?k_(void 0,t.useValue):k_(YC(t),Gv)}(n);if(JA(n)||!0!==n.multi)this.records.get(e);else{let s=this.records.get(e);s||(s=k_(void 0,Gv,!0),s.factory=()=>th(s.multi),this.records.set(e,s)),e=n,s.multi.push(n)}this.records.set(e,i)}hydrate(n,e){return e.value===Gv&&(e.value=TT,e.value=e.factory()),"object"==typeof e.value&&e.value&&function MT(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=Br(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(n){const e=this._onDestroyHooks.indexOf(n);-1!==e&&this._onDestroyHooks.splice(e,1)}}function Yb(t){const n=jd(t),e=null!==n?n.factory:zc(t);if(null!==e)return e;if(t instanceof pi)throw new ln(204,!1);if(t instanceof Function)return function IT(t){const n=t.length;if(n>0)throw af(n,"?"),new ln(204,!1);const e=function i_(t){return t&&(t[kf]||t[ud])||null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new ln(204,!1)}function YC(t,n,e){let i;if(JA(t)){const s=Br(t);return zc(s)||Yb(s)}if(XC(t))i=()=>Br(t.useValue);else if(function Kb(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...th(t.deps||[]));else if(function ST(t){return!(!t||!t.useExisting)}(t))i=()=>Xt(Br(t.useExisting));else{const s=Br(t&&(t.useClass||t.provide));if(!function BT(t){return!!t.deps}(t))return zc(s)||Yb(s);i=()=>new s(...th(t.deps))}return i}function k_(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function JC(t,n){for(const e of t)Array.isArray(e)?JC(e,n):e&&Df(e)?JC(e.\u0275providers,n):n(e)}const Jb=new pi("AppId",{providedIn:"root",factory:()=>LF}),LF="ng",$v=new pi("Platform Initializer"),Uu=new pi("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),FT=new pi("AnimationModuleType"),RT=new pi("CSP nonce",{providedIn:"root",factory:()=>ey().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let e2=(t,n,e)=>null;function sw(t,n,e=!1){return e2(t,n,e)}class UT{}class zT{}class VT{resolveComponentFactory(n){throw function jF(t){const n=Error(`No component factory found for ${Un(t)}.`);return n.ngComponent=t,n}(n)}}let Yv=(()=>{class t{static#e=this.NULL=new VT}return t})();function HT(){return U_(Dl(),Qn())}function U_(t,n){return new ao(ql(t,n))}let ao=(()=>{class t{constructor(e){this.nativeElement=e}static#e=this.__NG_ELEMENT_ID__=HT}return t})();function QT(t){return t instanceof ao?t.nativeElement:t}class z_{}let Wh=(()=>{class t{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function GF(){const t=Qn(),e=Ja(Dl().index,t);return(_c(e)?e:t)[Zr]}()}return t})(),$F=(()=>{class t{static#e=this.\u0275prov=Pn({token:t,providedIn:"root",factory:()=>null})}return t})();class Jv{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const qF=new Jv("16.2.12"),n2={};function uy(t,n=null,e=null,i){const s=jT(t,n,e,i);return s.resolveInjectorInitializers(),s}function jT(t,n=null,e=null,i,s=new Set){const l=[e||Ys,iy(t)];return i=i||("object"==typeof t?void 0:Un(t)),new O_(l,n||Xb(),i||null,s)}let Zc=(()=>{class t{static#e=this.THROW_IF_NOT_FOUND=hd;static#t=this.NULL=new ZC;static create(e,i){if(Array.isArray(e))return uy({name:""},i,e,"");{const s=e.name??"";return uy({name:s},e.parent,e.providers,s)}}static#n=this.\u0275prov=Pn({token:t,providedIn:"any",factory:()=>Xt(xT)});static#i=this.__NG_ELEMENT_ID__=-1}return t})();function hy(t){return t.ngOriginalError}class no{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&hy(n);for(;e&&hy(e);)e=hy(e);return e||null}}function vm(t){return n=>{setTimeout(t,void 0,n)}}const vi=class Zp extends Li{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,i){let s=n,l=e||(()=>null),h=i;if(n&&"object"==typeof n){const b=n;s=b.next?.bind(b),l=b.error?.bind(b),h=b.complete?.bind(b)}this.__isAsync&&(l=vm(l),s&&(s=vm(s)),h&&(h=vm(h)));const m=super.subscribe({next:s,error:l,complete:h});return n instanceof Ai&&n.add(m),m}};function KT(...t){}class Wi{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new vi(!1),this.onMicrotaskEmpty=new vi(!1),this.onStable=new vi(!1),this.onError=new vi(!1),typeof Zone>"u")throw new ln(908,!1);Zone.assertZonePatched();const s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&e,s.shouldCoalesceRunChangeDetection=i,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function XF(){const t="function"==typeof Uo.requestAnimationFrame;let n=Uo[t?"requestAnimationFrame":"setTimeout"],e=Uo[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&e){const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i);const s=e[Zone.__symbol__("OriginalDelegate")];s&&(e=s)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function e5(t){const n=()=>{!function JF(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Uo,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,a2(t),t.isCheckStableRunning=!0,o2(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),a2(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,s,l,h,m)=>{if(function t5(t){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0].data?.__ignore_ng_zone__}(m))return e.invokeTask(s,l,h,m);try{return t1(t),e.invokeTask(s,l,h,m)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===l.type||t.shouldCoalesceRunChangeDetection)&&n(),V_(t)}},onInvoke:(e,i,s,l,h,m,b)=>{try{return t1(t),e.invoke(s,l,h,m,b)}finally{t.shouldCoalesceRunChangeDetection&&n(),V_(t)}},onHasTask:(e,i,s,l)=>{e.hasTask(s,l),i===s&&("microTask"==l.change?(t._hasPendingMicrotasks=l.microTask,a2(t),o2(t)):"macroTask"==l.change&&(t.hasPendingMacrotasks=l.macroTask))},onHandleError:(e,i,s,l)=>(e.handleError(s,l),t.runOutsideAngular(()=>t.onError.emit(l)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Wi.isInAngularZone())throw new ln(909,!1)}static assertNotInAngularZone(){if(Wi.isInAngularZone())throw new ln(909,!1)}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,s){const l=this._inner,h=l.scheduleEventTask("NgZoneEvent: "+s,n,YF,KT,KT);try{return l.runTask(h,e,i)}finally{l.cancelTask(h)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const YF={};function o2(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function a2(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function t1(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function V_(t){t._nesting--,o2(t)}class WT{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new vi,this.onMicrotaskEmpty=new vi,this.onStable=new vi,this.onError=new vi}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,s){return n.apply(e,i)}}const H_=new pi("",{providedIn:"root",factory:uw});function uw(){const t=In(Wi);let n=!0;return so(new Hr(s=>{n=t.isStable&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks,t.runOutsideAngular(()=>{s.next(n),s.complete()})}),new Hr(s=>{let l;t.runOutsideAngular(()=>{l=t.onStable.subscribe(()=>{Wi.assertNotInAngularZone(),queueMicrotask(()=>{!n&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks&&(n=!0,s.next(!0))})})});const h=t.onUnstable.subscribe(()=>{Wi.assertInAngularZone(),n&&(n=!1,t.runOutsideAngular(()=>{s.next(!1)}))});return()=>{l.unsubscribe(),h.unsubscribe()}}).pipe(gp()))}function Ed(t){return t instanceof Function?t():t}let dw=(()=>{class t{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=Pn({token:t,providedIn:"root",factory:()=>new t})}return t})();function n1(t){for(;t;){t[gs]|=64;const n=I_(t);if(c_(t)&&!n)return t;t=n}return null}const fw=new pi("",{providedIn:"root",factory:()=>!1});let s1=null;function mh(t,n){return t[n]??A2()}function Aw(t,n){const e=A2();e.producerNode?.length&&(t[n]=s1,e.lView=t,s1=dy())}const tI={...Zg,consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{n1(t.lView)},lView:null};function dy(){return Object.create(tI)}function A2(){return s1??=dy(),s1}const Cs={};function $e(t){pw(Js(),Qn(),w()+t,!1)}function pw(t,n,e,i){if(!i)if(3==(3&n[gs])){const l=t.preOrderCheckHooks;null!==l&&se(n,l,e)}else{const l=t.preOrderHooks;null!==l&&me(n,l,0,e)}C(e)}function Ve(t,n=vs.Default){const e=Qn();return null===e?Xt(t,n):jr(Dl(),e,Br(t),n)}function Q_(t,n,e,i,s,l,h,m,b,E,M){const L=n.blueprint.slice();return L[Zi]=s,L[gs]=140|i,(null!==E||t&&2048&t[gs])&&(L[gs]|=2048),fu(L),L[Wo]=L[ch]=t,L[Da]=e,L[lh]=h||t&&t[lh],L[Zr]=m||t&&t[Zr],L[gc]=b||t&&t[gc]||null,L[jl]=l,L[Ip]=function wC(){return WS++}(),L[Nh]=M,L[jg]=E,L[ba]=2==n.type?t[ba]:L,L}function j_(t,n,e,i,s){let l=t.data[n];if(null===l)l=fy(t,n,e,i,s),function $A(){return Ir.lFrame.inI18n}()&&(l.flags|=32);else if(64&l.type){l.type=e,l.value=i,l.attrs=s;const h=vd();l.injectorIndex=null===h?-1:h.injectorIndex}return ph(l,!0),l}function fy(t,n,e,i,s){const l=y_(),h=hm(),b=t.data[n]=function mw(t,n,e,i,s,l){let h=n?n.injectorIndex:-1,m=0;return Au()&&(m|=128),{type:e,index:i,insertBeforeIndex:null,injectorIndex:h,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:m,providerIndexes:0,value:s,attrs:l,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,h?l:l&&l.parent,e,n,i,s);return null===t.firstChild&&(t.firstChild=b),null!==l&&(h?null==l.child&&null!==b.parent&&(l.child=b):null===l.next&&(l.next=b,b.prev=l)),b}function bm(t,n,e,i){if(0===e)return-1;const s=n.length;for(let l=0;l<e;l++)n.push(i),t.blueprint.push(i),t.data.push(null);return s}function iI(t,n,e,i,s){const l=mh(n,Gf),h=w(),m=2&i;try{C(-1),m&&n.length>Ds&&pw(t,n,Ds,!1),Bs(m?2:0,s);const E=m?l:null,M=zh(E);try{null!==E&&(E.dirty=!1),e(i,s)}finally{Jg(E,M)}}finally{m&&null===n[Gf]&&Aw(n,Gf),C(h),Bs(m?3:1,s)}}function p2(t,n,e){if(PA(n)){const i=hu(null);try{const l=n.directiveEnd;for(let h=n.directiveStart;h<l;h++){const m=t.data[h];m.contentQueries&&m.contentQueries(1,e[h],h)}}finally{hu(i)}}}function g2(t,n,e){GA()&&(function yw(t,n,e,i){const s=e.directiveStart,l=e.directiveEnd;Jd(e)&&function dI(t,n,e){const i=ql(n,t),s=gw(e);let h=16;e.signals?h=4096:e.onPush&&(h=64);const m=$_(t,Q_(t,s,null,h,i,n,null,t[lh].rendererFactory.createRenderer(i,e),null,null,null));t[n.index]=m}(n,e,t.data[s+e.componentOffset]),t.firstCreatePass||Ki(e,n),Pu(i,n);const h=e.initialInputs;for(let m=s;m<l;m++){const b=t.data[m],E=zr(n,t,m,e);Pu(E,n),null!==h&&f5(0,m-s,E,b,0,h),yc(b)&&(Ja(e.index,n)[Da]=zr(n,t,m,e))}}(t,n,e,ql(e,n)),64==(64&e.flags)&&cI(t,n,e))}function wm(t,n,e=ql){const i=n.localNames;if(null!==i){let s=n.index+1;for(let l=0;l<i.length;l+=2){const h=i[l+1],m=-1===h?e(n,t):t[h];t[s++]=m}}}function gw(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=m2(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):n}function m2(t,n,e,i,s,l,h,m,b,E,M){const L=Ds+i,G=L+s,V=function rI(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:Cs);return e}(L,G),ne="function"==typeof E?E():E;return V[Oi]={type:t,blueprint:V,template:e,queries:null,viewQuery:m,declTNode:n,data:V.slice().fill(null,L),bindingStartIndex:L,expandoStartIndex:G,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof l?l():l,pipeRegistry:"function"==typeof h?h():h,firstChild:null,schemas:b,consts:ne,incompleteFirstPass:!1,ssrId:M}}let Ay=t=>null;function _w(t,n,e,i){for(let s in t)if(t.hasOwnProperty(s)){e=null===e?{}:e;const l=t[s];null===i?aI(e,n,s,l):i.hasOwnProperty(s)&&aI(e,n,i[s],l)}return e}function aI(t,n,e,i){t.hasOwnProperty(e)?t[e].push(n,i):t[e]=[n,i]}function Zh(t,n,e,i,s,l,h,m){const b=ql(n,e);let M,E=n.inputs;!m&&null!=E&&(M=E[i])?(b2(t,e,M,i,s),Jd(n)&&function c5(t,n){const e=Ja(n,t);16&e[gs]||(e[gs]|=64)}(e,n.index)):3&n.type&&(i=function o1(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),s=null!=h?h(s,n.value||"",i):s,l.setProperty(b,i,s))}function G_(t,n,e,i){if(GA()){const s=null===i?null:{"":-1},l=function gy(t,n){const e=t.directiveRegistry;let i=null,s=null;if(e)for(let l=0;l<e.length;l++){const h=e[l];if(xp(n,h.selectors,!1))if(i||(i=[]),yc(h))if(null!==h.findHostDirectiveDefs){const m=[];s=s||new Map,h.findHostDirectiveDefs(h,m,s),i.unshift(...m,h),my(t,n,m.length)}else i.unshift(h),my(t,n,0);else s=s||new Map,h.findHostDirectiveDefs?.(h,i,s),i.push(h)}return null===i?null:[i,s]}(t,e);let h,m;null===l?h=m=null:[h,m]=l,null!==h&&py(t,n,e,h,s,m),s&&function h5(t,n,e){if(n){const i=t.localNames=[];for(let s=0;s<n.length;s+=2){const l=e[n[s+1]];if(null==l)throw new ln(-301,!1);i.push(n[s],l)}}}(e,i,s)}e.mergedAttrs=Hl(e.mergedAttrs,e.attrs)}function py(t,n,e,i,s,l){for(let E=0;E<i.length;E++)qs(Ki(e,n),t,i[E].type);!function hI(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}(e,t.data.length,i.length);for(let E=0;E<i.length;E++){const M=i[E];M.providersResolver&&M.providersResolver(M)}let h=!1,m=!1,b=bm(t,n,i.length,null);for(let E=0;E<i.length;E++){const M=i[E];e.mergedAttrs=Hl(e.mergedAttrs,M.hostAttrs),d5(t,e,n,b,M),uI(b,M,s),null!==M.contentQueries&&(e.flags|=4),(null!==M.hostBindings||null!==M.hostAttrs||0!==M.hostVars)&&(e.flags|=64);const L=M.type.prototype;!h&&(L.ngOnChanges||L.ngOnInit||L.ngDoCheck)&&((t.preOrderHooks??=[]).push(e.index),h=!0),!m&&(L.ngOnChanges||L.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(e.index),m=!0),b++}!function lI(t,n,e){const s=n.directiveEnd,l=t.data,h=n.attrs,m=[];let b=null,E=null;for(let M=n.directiveStart;M<s;M++){const L=l[M],G=e?e.get(L):null,ne=G?G.outputs:null;b=_w(L.inputs,M,b,G?G.inputs:null),E=_w(L.outputs,M,E,ne);const re=null===b||null===h||Ql(n)?null:A5(b,M,h);m.push(re)}null!==b&&(b.hasOwnProperty("class")&&(n.flags|=8),b.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=m,n.inputs=b,n.outputs=E}(t,e,l)}function cI(t,n,e){const i=e.directiveStart,s=e.directiveEnd,l=e.index,h=function b_(){return Ir.lFrame.currentDirectiveIndex}();try{C(l);for(let m=i;m<s;m++){const b=t.data[m],E=n[m];Xf(m),(null!==b.hostBindings||0!==b.hostVars||null!==b.hostAttrs)&&u5(b,E)}}finally{C(-1),Xf(h)}}function u5(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function my(t,n,e){n.componentOffset=e,(t.components??=[]).push(n.index)}function uI(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;yc(n)&&(e[""]=t)}}function d5(t,n,e,i,s){t.data[i]=s;const l=s.factory||(s.factory=zc(s.type)),h=new He(l,yc(s),Ve);t.blueprint[i]=h,e[i]=h,function a1(t,n,e,i,s){const l=s.hostBindings;if(l){let h=t.hostBindingOpCodes;null===h&&(h=t.hostBindingOpCodes=[]);const m=~n.index;(function l1(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(h)!=m&&h.push(m),h.push(e,i,l)}}(t,n,i,bm(t,e,s.hostVars,Cs),s)}function vw(t,n,e,i,s,l,h){if(null==l)t.removeAttribute(n,s,e);else{const m=null==h?kn(l):h(l,i||"",s);t.setAttribute(n,s,m,e)}}function f5(t,n,e,i,s,l){const h=l[n];if(null!==h)for(let m=0;m<h.length;)y2(i,e,h[m++],h[m++],h[m++])}function y2(t,n,e,i,s){const l=hu(null);try{const h=t.inputTransforms;null!==h&&h.hasOwnProperty(i)&&(s=h[i].call(n,s)),null!==t.setInput?t.setInput(n,s,e,i):n[i]=s}finally{hu(l)}}function A5(t,n,e){let i=null,s=0;for(;s<e.length;){const l=e[s];if(0!==l)if(5!==l){if("number"==typeof l)break;if(t.hasOwnProperty(l)){null===i&&(i=[]);const h=t[l];for(let m=0;m<h.length;m+=2)if(h[m]===n){i.push(l,h[m+1],e[s+1]);break}}s+=2}else s+=2;else s+=4}return i}function fI(t,n,e,i){return[t,!0,!1,n,null,0,i,e,null,null,null]}function c1(t,n){const e=t.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const l=e[i+1];if(-1!==l){const h=t.data[l];KA(e[i]),h.contentQueries(2,n[l],l)}}}function $_(t,n){return t[Qf]?t[jf][pc]=n:t[Qf]=n,t[jf]=n,n}function _y(t,n,e){KA(0);const i=hu(null);try{n(t,e)}finally{hu(i)}}function AI(t){return t[pd]||(t[pd]=[])}function bw(t){return t.cleanup||(t.cleanup=[])}function u1(t,n){const e=t[gc],i=e?e.get(no,null):null;i&&i.handleError(n)}function b2(t,n,e,i,s){for(let l=0;l<e.length;){const h=e[l++],m=e[l++];y2(t.data[h],n[h],i,m,s)}}function sA(t,n,e){const i=Hc(n,t);DC(t[Zr],i,e)}function pI(t,n){const e=Ja(n,t),i=e[Oi];!function xw(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])}(i,e);const s=e[Zi];null!==s&&null===e[Nh]&&(e[Nh]=sw(s,e[gc])),w2(i,e,e[Da])}function w2(t,n,e){Yf(n);try{const i=t.viewQuery;null!==i&&_y(1,i,e);const s=t.template;null!==s&&iI(t,n,s,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&c1(t,n),t.staticViewQueries&&_y(2,t.viewQuery,e);const l=t.components;null!==l&&function p5(t,n){for(let e=0;e<n.length;e++)pI(t,n[e])}(n,l)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[gs]&=-5,c()}}let gI=(()=>{class t{constructor(){this.all=new Set,this.queue=new Map}create(e,i,s){const l=typeof Zone>"u"?null:Zone.current,h=function yv(t,n,e){const i=Object.create(H0);e&&(i.consumerAllowSignalWrites=!0),i.fn=t,i.schedule=n;const s=h=>{i.cleanupFn=h};return i.ref={notify:()=>vc(i),run:()=>{if(i.dirty=!1,i.hasRun&&!em(i))return;i.hasRun=!0;const h=zh(i);try{i.cleanupFn(),i.cleanupFn=V0,i.fn(s)}finally{Jg(i,h)}},cleanup:()=>i.cleanupFn()},i.ref}(e,E=>{this.all.has(E)&&this.queue.set(E,l)},s);let m;this.all.add(h),h.notify();const b=()=>{h.cleanup(),m?.(),this.all.delete(h),this.queue.delete(h)};return m=i?.onDestroy(b),{destroy:b}}flush(){if(0!==this.queue.size)for(const[e,i]of this.queue)this.queue.delete(e),i?i.run(()=>e.run()):e.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=Pn({token:t,providedIn:"root",factory:()=>new t})}return t})();function yy(t,n,e){let i=e?t.styles:null,s=e?t.classes:null,l=0;if(null!==n)for(let h=0;h<n.length;h++){const m=n[h];"number"==typeof m?l=m:1==l?s=Wr(s,m):2==l&&(i=Wr(i,m+": "+n[++h]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=s:t.classesWithoutHost=s}function q_(t,n,e,i,s=!1){for(;null!==e;){const l=n[e.index];null!==l&&i.push(Hs(l)),Gl(l)&&h1(l,i);const h=e.type;if(8&h)q_(t,n,e.child,i);else if(32&h){const m=W0(e,n);let b;for(;b=m();)i.push(b)}else if(16&h){const m=PC(n,e);if(Array.isArray(m))i.push(...m);else{const b=I_(n[ba]);q_(b[Oi],b,m,i,!0)}}e=s?e.projectionNext:e.next}return i}function h1(t,n){for(let e=Ya;e<t.length;e++){const i=t[e],s=i[Oi].firstChild;null!==s&&q_(i[Oi],i,s,n)}t[mc]!==t[Zi]&&n.push(t[mc])}function K_(t,n,e,i=!0){const s=n[lh],l=s.rendererFactory,h=s.afterRenderEventManager;l.begin?.(),h?.begin();try{x2(t,n,t.template,e)}catch(b){throw i&&u1(n,b),b}finally{l.end?.(),s.effectManager?.flush(),h?.end()}}function x2(t,n,e,i){const s=n[gs];if(256!=(256&s)){n[lh].effectManager?.flush(),Yf(n);try{fu(n),function v_(t){return Ir.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&iI(t,n,e,2,i);const h=3==(3&s);if(h){const E=t.preOrderCheckHooks;null!==E&&se(n,E,null)}else{const E=t.preOrderHooks;null!==E&&me(n,E,0,null),Ie(n,0)}if(function _I(t){for(let n=SC(t);null!==n;n=TC(n)){if(!n[gd])continue;const e=n[Uc];for(let i=0;i<e.length;i++){g_(e[i])}}}(n),mI(n,2),null!==t.contentQueries&&c1(t,n),h){const E=t.contentCheckHooks;null!==E&&se(n,E)}else{const E=t.contentHooks;null!==E&&me(n,E,1),Ie(n,1)}!function nI(t,n){const e=t.hostBindingOpCodes;if(null===e)return;const i=mh(n,$f);try{for(let s=0;s<e.length;s++){const l=e[s];if(l<0)C(~l);else{const h=l,m=e[++s],b=e[++s];G0(m,h),i.dirty=!1;const E=zh(i);try{b(2,n[h])}finally{Jg(i,E)}}}}finally{null===n[$f]&&Aw(n,$f),C(-1)}}(t,n);const m=t.components;null!==m&&C2(n,m,0);const b=t.viewQuery;if(null!==b&&_y(2,b,i),h){const E=t.viewCheckHooks;null!==E&&se(n,E)}else{const E=t.viewHooks;null!==E&&me(n,E,2),Ie(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[gs]&=-73,jA(n)}finally{c()}}}function mI(t,n){for(let e=SC(t);null!==e;e=TC(e))for(let i=Ya;i<e.length;i++)yI(e[i],n)}function _5(t,n,e){yI(Ja(n,t),e)}function yI(t,n){if(!function zp(t){return 128==(128&t[gs])}(t))return;const e=t[Oi],i=t[gs];if(80&i&&0===n||1024&i||2===n)x2(e,t,e.template,t[Da]);else if(t[Hf]>0){mI(t,1);const s=e.components;null!==s&&C2(t,s,1)}}function C2(t,n,e){for(let i=0;i<n.length;i++)_5(t,n[i],e)}class d1{get rootNodes(){const n=this._lView,e=n[Oi];return q_(e,n,e.firstChild,[])}constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Da]}set context(n){this._lView[Da]=n}get destroyed(){return 256==(256&this._lView[gs])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Wo];if(Gl(n)){const e=n[8],i=e?e.indexOf(this):-1;i>-1&&(Fb(n,i),mo(e,i))}this._attachedToViewContainer=!1}MC(this._lView[Oi],this._lView)}onDestroy(n){!function lm(t,n){if(256==(256&t[gs]))throw new ln(911,!1);null===t[Ph]&&(t[Ph]=[]),t[Ph].push(n)}(this._lView,n)}markForCheck(){n1(this._cdRefInjectingView||this._lView)}detach(){this._lView[gs]&=-129}reattach(){this._lView[gs]|=128}detectChanges(){K_(this._lView[Oi],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ln(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function xF(t,n){Y0(t,n,n[Zr],2,null,null)}(this._lView[Oi],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new ln(902,!1);this._appRef=n}}class y5 extends d1{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;K_(n[Oi],n,n[Da],!1)}checkNoChanges(){}get context(){return null}}class vI extends Yv{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=Is(n);return new vy(e,this.ngModule)}}function Ew(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class bI{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,i){i=Nf(i);const s=this.injector.get(n,n2,i);return s!==n2||e===n2?s:this.parentInjector.get(n,e,i)}}class vy extends zT{get inputs(){const n=this.componentDef,e=n.inputTransforms,i=Ew(n.inputs);if(null!==e)for(const s of i)e.hasOwnProperty(s.propName)&&(s.transform=e[s.propName]);return i}get outputs(){return Ew(this.componentDef.outputs)}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function o_(t){return t.map(Vg).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}create(n,e,i,s){let l=(s=s||this.ngModule)instanceof Lu?s:s?.injector;l&&null!==this.componentDef.getStandaloneInjector&&(l=this.componentDef.getStandaloneInjector(l)||l);const h=l?new bI(n,l):n,m=h.get(z_,null);if(null===m)throw new ln(407,!1);const L={rendererFactory:m,sanitizer:h.get($F,null),effectManager:h.get(gI,null),afterRenderEventManager:h.get(dw,null)},G=m.createRenderer(null,this.componentDef),V=this.componentDef.selectors[0][0]||"div",ne=i?function _2(t,n,e,i){const l=i.get(fw,!1)||e===Ac.ShadowDom,h=t.selectRootElement(n,l);return function l5(t){Ay(t)}(h),h}(G,i,this.componentDef.encapsulation,h):Bv(G,V,function v5(t){const n=t.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(V)),fe=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let he=null;null!==ne&&(he=sw(ne,h,!0));const Ne=m2(0,null,null,1,0,null,null,null,null,null,null),We=Q_(null,Ne,null,fe,null,null,L,G,h,null,he);let pt,Qt;Yf(We);try{const yt=this.componentDef;let Ye,un=null;yt.findHostDirectiveDefs?(Ye=[],un=new Map,yt.findHostDirectiveDefs(yt,Ye,un),Ye.push(yt)):Ye=[yt];const hn=function Em(t,n){const e=t[Oi],i=Ds;return t[i]=n,j_(e,i,2,"#host",null)}(We,ne),Ue=function wI(t,n,e,i,s,l,h){const m=s[Oi];!function xI(t,n,e,i){for(const s of t)n.mergedAttrs=Hl(n.mergedAttrs,s.hostAttrs);null!==n.mergedAttrs&&(yy(n,n.mergedAttrs,!0),null!==e&&Pv(i,e,n))}(i,t,n,h);let b=null;null!==n&&(b=sw(n,s[gc]));const E=l.rendererFactory.createRenderer(n,e);let M=16;e.signals?M=4096:e.onPush&&(M=64);const L=Q_(s,gw(e),null,M,s[t.index],t,l,E,null,null,b);return m.firstCreatePass&&my(m,t,i.length-1),$_(s,L),s[t.index]=L}(hn,ne,yt,Ye,We,L,G);Qt=Hh(Ne,Ds),ne&&function Tw(t,n,e,i){if(i)Kd(t,e,["ng-version",qF.full]);else{const{attrs:s,classes:l}=function O0(t){const n=[],e=[];let i=1,s=2;for(;i<t.length;){let l=t[i];if("string"==typeof l)2===s?""!==l&&n.push(l,t[++i]):8===s&&e.push(l);else{if(!va(s))break;s=l}i++}return{attrs:n,classes:e}}(n.selectors[0]);s&&Kd(t,e,s),l&&l.length>0&&UC(t,e,l.join(" "))}}(G,yt,ne,i),void 0!==e&&function E2(t,n,e){const i=t.projection=[];for(let s=0;s<n.length;s++){const l=e[s];i.push(null!=l?Array.from(l):null)}}(Qt,this.ngContentSelectors,e),pt=function CI(t,n,e,i,s,l){const h=Dl(),m=s[Oi],b=ql(h,s);py(m,s,h,e,null,i);for(let M=0;M<e.length;M++)Pu(zr(s,m,h.directiveStart+M,h),s);cI(m,s,h),b&&Pu(b,s);const E=zr(s,m,h.directiveStart+h.componentOffset,h);if(t[Da]=s[Da]=E,null!==l)for(const M of l)M(E,n);return p2(m,h,t),E}(Ue,yt,Ye,un,We,[EI]),w2(Ne,We,null)}finally{c()}return new Sw(this.componentType,pt,U_(Qt,We),We,Qt)}}class Sw extends UT{constructor(n,e,i,s,l){super(),this.location=i,this._rootLView=s,this._tNode=l,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new y5(s),this.componentType=n}setInput(n,e){const i=this._tNode.inputs;let s;if(null!==i&&(s=i[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),e))return;const l=this._rootLView;b2(l[Oi],l,s,n,e),this.previousInputValues.set(n,e),n1(Ja(this._tNode.index,l))}}get injector(){return new oo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function EI(){const t=Dl();Ae(Qn()[Oi],t)}function Ho(t){let n=function SI(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let s;if(yc(t))s=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new ln(903,!1);s=n.\u0275dir}if(s){if(e){i.push(s);const h=t;h.inputs=Iw(t.inputs),h.inputTransforms=Iw(t.inputTransforms),h.declaredInputs=Iw(t.declaredInputs),h.outputs=Iw(t.outputs);const m=s.hostBindings;m&&C5(t,m);const b=s.viewQuery,E=s.contentQueries;if(b&&w5(t,b),E&&x5(t,E),cd(t.inputs,s.inputs),cd(t.declaredInputs,s.declaredInputs),cd(t.outputs,s.outputs),null!==s.inputTransforms&&(null===h.inputTransforms&&(h.inputTransforms={}),cd(h.inputTransforms,s.inputTransforms)),yc(s)&&s.data.animation){const M=t.data;M.animation=(M.animation||[]).concat(s.data.animation)}}const l=s.features;if(l)for(let h=0;h<l.length;h++){const m=l[h];m&&m.ngInherit&&m(t),m===Ho&&(e=!1)}}n=Object.getPrototypeOf(n)}!function b5(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const s=t[i];s.hostVars=n+=s.hostVars,s.hostAttrs=Hl(s.hostAttrs,e=Hl(e,s.hostAttrs))}}(i)}function Iw(t){return t===Lc?{}:t===Ys?[]:t}function w5(t,n){const e=t.viewQuery;t.viewQuery=e?(i,s)=>{n(i,s),e(i,s)}:n}function x5(t,n){const e=t.contentQueries;t.contentQueries=e?(i,s,l)=>{n(i,s,l),e(i,s,l)}:n}function C5(t,n){const e=t.hostBindings;t.hostBindings=e?(i,s)=>{n(i,s),e(i,s)}:n}function f1(t){return n=>{n.findHostDirectiveDefs=DI,n.hostDirectives=(Array.isArray(t)?t:t()).map(e=>"function"==typeof e?{directive:Br(e),inputs:Lc,outputs:Lc}:{directive:Br(e.directive),inputs:Sm(e.inputs),outputs:Sm(e.outputs)})}}function DI(t,n,e){if(null!==t.hostDirectives)for(const i of t.hostDirectives){const s=dl(i.directive);by(s.declaredInputs,i.inputs),DI(s,n,e),e.set(s,i),n.push(s)}}function Sm(t){if(void 0===t||0===t.length)return Lc;const n={};for(let e=0;e<t.length;e+=2)n[t[e]]=t[e+1];return n}function by(t,n){for(const e in n)n.hasOwnProperty(e)&&(t[n[e]]=t[e])}function BI(t){const n=t.inputConfig,e={};for(const i in n)if(n.hasOwnProperty(i)){const s=n[i];Array.isArray(s)&&s[2]&&(e[i]=s[2])}t.inputTransforms=e}function W_(t){return!!I2(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function I2(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function hf(t,n,e){return t[n]=e}function zu(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function eg(t,n,e,i){const s=zu(t,n,e);return zu(t,n+1,i)||s}function To(t,n,e,i){const s=Qn();return zu(s,jh(),n)&&(Js(),function ep(t,n,e,i,s,l){const h=ql(t,n);vw(n[Zr],h,l,t.value,e,i,s)}(I(),s,t,n,e,i)),To}function En(t,n,e,i,s,l,h,m){const b=Qn(),E=Js(),M=t+Ds,L=E.firstCreatePass?function mr(t,n,e,i,s,l,h,m,b){const E=n.consts,M=j_(n,t,4,h||null,La(E,m));G_(n,e,M,La(E,b)),Ae(n,M);const L=M.tView=m2(2,M,i,s,l,n.directiveRegistry,n.pipeRegistry,null,n.schemas,E,null);return null!==n.queries&&(n.queries.template(n,M),L.queries=n.queries.embeddedTView(M)),M}(M,E,b,n,e,i,s,l,h):E.data[M];ph(L,!1);const G=jI(E,b,L,t);te()&&M_(E,b,G,L),Pu(G,b),$_(b,b[M]=fI(G,b,G,L)),_d(L)&&g2(E,b,L),null!=h&&wm(b,L,m)}let jI=function GI(t,n,e,i){return le(!0),n[Zr].createComment("")};function ws(t){return function Qc(t,n){return t[n]}(function Q0(){return Ir.lFrame.contextLView}(),Ds+t)}function st(t,n,e){const i=Qn();return zu(i,jh(),n)&&Zh(Js(),I(),i,t,n,i[Zr],e,!1),st}function P2(t,n,e,i,s){const h=s?"class":"style";b2(t,e,n.inputs[h],h,i)}function pe(t,n,e,i){const s=Qn(),l=Js(),h=Ds+t,m=s[Zr],b=l.firstCreatePass?function $I(t,n,e,i,s,l){const h=n.consts,b=j_(n,t,2,i,La(h,s));return G_(n,e,b,La(h,l)),null!==b.attrs&&yy(b,b.attrs,!1),null!==b.mergedAttrs&&yy(b,b.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,b),b}(h,l,s,n,e,i):l.data[h],E=N2(l,s,b,m,n,t);s[h]=E;const M=_d(b);return ph(b,!0),Pv(m,E,b),32!=(32&b.flags)&&te()&&M_(l,s,E,b),0===function nf(){return Ir.lFrame.elementDepthCount}()&&Pu(E,s),function um(){Ir.lFrame.elementDepthCount++}(),M&&(g2(l,s,b),p2(l,b,s)),null!==i&&wm(s,b),pe}function ye(){let t=Dl();hm()?rf():(t=t.parent,ph(t,!1));const n=t;(function Ua(t){return Ir.skipHydrationRootTNode===t})(n)&&function __(){Ir.skipHydrationRootTNode=null}(),function Qp(){Ir.lFrame.elementDepthCount--}();const e=Js();return e.firstCreatePass&&(Ae(e,t),PA(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function Pt(t){return 0!=(8&t.flags)}(n)&&P2(e,n,Qn(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function Rt(t){return 0!=(16&t.flags)}(n)&&P2(e,n,Qn(),n.stylesWithoutHost,!1),ye}function oi(t,n,e,i){return pe(t,n,e,i),ye(),oi}let N2=(t,n,e,i,s,l)=>(le(!0),Bv(i,s,function q(){return Ir.lFrame.currentNamespace}()));function Sy(t,n,e){const i=Qn(),s=Js(),l=t+Ds,h=s.firstCreatePass?function L5(t,n,e,i,s){const l=n.consts,h=La(l,i),m=j_(n,t,8,"ng-container",h);return null!==h&&yy(m,h,!0),G_(n,e,m,La(l,s)),null!==n.queries&&n.queries.elementStart(n,m),m}(l,s,i,n,e):s.data[l];ph(h,!0);const m=Ty(s,i,h,t);return i[l]=m,te()&&M_(s,i,m,h),Pu(m,i),_d(h)&&(g2(s,i,h),p2(s,h,i)),null!=e&&wm(i,h),Sy}function ga(){let t=Dl();const n=Js();return hm()?rf():(t=t.parent,ph(t,!1)),n.firstCreatePass&&(Ae(n,t),PA(t)&&n.queries.elementEnd(t)),ga}let Ty=(t,n,e,i)=>(le(!0),Mb(n[Zr],""));function xr(){return Qn()}function v1(t){return!!t&&"function"==typeof t.then}function kw(t){return!!t&&"function"==typeof t.subscribe}function Tt(t,n,e,i){const s=Qn(),l=Js(),h=Dl();return function df(t,n,e,i,s,l,h){const m=_d(i),E=t.firstCreatePass&&bw(t),M=n[Da],L=AI(n);let G=!0;if(3&i.type||h){const re=ql(i,n),de=h?h(re):re,fe=L.length,he=h?We=>h(Hs(We[i.index])):i.index;let Ne=null;if(!h&&m&&(Ne=function U5(t,n,e,i){const s=t.cleanup;if(null!=s)for(let l=0;l<s.length-1;l+=2){const h=s[l];if(h===e&&s[l+1]===i){const m=n[pd],b=s[l+2];return m.length>b?m[b]:null}"string"==typeof h&&(l+=2)}return null}(t,n,s,i.index)),null!==Ne)(Ne.__ngLastListenerFn__||Ne).__ngNextListenerFn__=l,Ne.__ngLastListenerFn__=l,G=!1;else{l=ZI(i,n,M,l,!1);const We=e.listen(de,s,l);L.push(l,We),E&&E.push(s,he,fe,fe+1)}}else l=ZI(i,n,M,l,!1);const V=i.outputs;let ne;if(G&&null!==V&&(ne=V[s])){const re=ne.length;if(re)for(let de=0;de<re;de+=2){const pt=n[ne[de]][ne[de+1]].subscribe(l),Qt=L.length;L.push(l,pt),E&&E.push(s,i.index,Qt,-(Qt+1))}}}(l,s,s[Zr],h,t,n,i),Tt}function WI(t,n,e,i){try{return Bs(6,n,e),!1!==e(i)}catch(s){return u1(t,s),!1}finally{Bs(7,n,e)}}function ZI(t,n,e,i,s){return function l(h){if(h===Function)return i;n1(t.componentOffset>-1?Ja(t.index,n):n);let b=WI(n,e,i,h),E=l.__ngNextListenerFn__;for(;E;)b=WI(n,e,E,h)&&b,E=E.__ngNextListenerFn__;return s&&!1===b&&h.preventDefault(),b}}function dn(t=1){return function d(t){return(Ir.lFrame.contextLView=function y(t,n){for(;t>0;)n=n[ch],t--;return n}(t,Ir.lFrame.contextLView))[Da]}(t)}function z5(t,n){let e=null;const i=function Cp(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(!(1&e))return n[e+1]}return null}(t);for(let s=0;s<n.length;s++){const l=n[s];if("*"!==l){if(null===i?xp(t,l,!0):s_(i,l))return s}else e=s}return e}function Nw(t){const n=Qn()[ba][jl];if(!n.projection){const i=n.projection=af(t?t.length:1,null),s=i.slice();let l=n.child;for(;null!==l;){const h=t?z5(l,t):0;null!==h&&(s[h]?s[h].projectionNext=l:i[h]=l,s[h]=l),l=l.next}}}function Lw(t,n=0,e){const i=Qn(),s=Js(),l=j_(s,Ds+t,16,null,e||null);null===l.projection&&(l.projection=n),rf(),(!i[Nh]||Au())&&32!=(32&l.flags)&&function oT(t,n,e){Ov(n[Zr],0,n,e,Rb(t,e,n),ta(e.parent||n[jl],e,n))}(s,i,l)}function o(t,n){return t<<17|n<<2}function r(t){return t>>17&32767}function f(t){return 2|t}function g(t){return(131068&t)>>2}function v(t,n){return-131069&t|n<<2}function S(t){return 1|t}function $(t,n,e,i,s){const l=t[e+1],h=null===n;let m=i?r(l):g(l),b=!1;for(;0!==m&&(!1===b||h);){const M=t[m+1];K(t[m],n)&&(b=!0,t[m+1]=i?S(M):f(M)),m=i?r(M):g(M)}b&&(t[e+1]=i?f(l):S(l))}function K(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&Fl(t,n)>=0}const X={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ie(t){return t.substring(X.key,X.keyEnd)}function Ce(t,n){const e=X.textEnd;return e===n?-1:(n=X.keyEnd=function rt(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,X.key=n,e),qe(t,n,e))}function qe(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function Dt(t,n){return function ri(t,n,e,i){const s=Qn(),l=Js(),h=Mu(2);l.firstUpdatePass&&Hi(l,t,h,i),n!==Cs&&zu(s,h,n)&&lo(l,l.data[w()],s,s[Zr],t,s[h+1]=function Fs(t,n){return null==t||""===t||("string"==typeof n?t+=n:"object"==typeof t&&(t=Un(gh(t)))),t}(n,e),i,h)}(t,n,null,!0),Dt}function Mn(t){!function Kn(t,n,e,i){const s=Js(),l=Mu(2);s.firstUpdatePass&&Hi(s,null,l,i);const h=Qn();if(e!==Cs&&zu(h,l,e)){const m=s.data[w()];if(ds(m,i)&&!bn(s,l)){let b=i?m.classesWithoutHost:m.stylesWithoutHost;null!==b&&(e=Wr(b,e||"")),P2(s,m,h,e,i)}else!function Ar(t,n,e,i,s,l,h,m){s===Cs&&(s=Ys);let b=0,E=0,M=0<s.length?s[0]:null,L=0<l.length?l[0]:null;for(;null!==M||null!==L;){const G=b<s.length?s[b+1]:void 0,V=E<l.length?l[E+1]:void 0;let re,ne=null;M===L?(b+=2,E+=2,G!==V&&(ne=L,re=V)):null===L||null!==M&&M<L?(b+=2,ne=M):(E+=2,ne=L,re=V),null!==ne&&lo(t,n,e,i,ne,re,h,m),M=b<s.length?s[b]:null,L=E<l.length?l[E]:null}}(s,m,h,h[Zr],h[l+1],h[l+1]=function Cr(t,n,e){if(null==e||""===e)return Ys;const i=[],s=gh(e);if(Array.isArray(s))for(let l=0;l<s.length;l++)t(i,s[l],!0);else if("object"==typeof s)for(const l in s)s.hasOwnProperty(l)&&t(i,l,s[l]);else"string"==typeof s&&n(i,s);return i}(t,n,e),i,l)}}(Yr,on,t,!0)}function on(t,n){for(let e=function be(t){return function Oe(t){X.key=0,X.keyEnd=0,X.value=0,X.valueEnd=0,X.textEnd=t.length}(t),Ce(t,qe(t,0,X.textEnd))}(n);e>=0;e=Ce(n,e))ks(t,ie(n),!0)}function bn(t,n){return n>=t.expandoStartIndex}function Hi(t,n,e,i){const s=t.data;if(null===s[e+1]){const l=s[w()],h=bn(t,e);ds(l,i)&&null===n&&!h&&(n=!1),n=function Ei(t,n,e,i){const s=function sf(t){const n=Ir.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let l=i?n.residualClasses:n.residualStyles;if(null===s)0===(i?n.classBindings:n.styleBindings)&&(e=zi(e=_r(null,t,n,e,i),n.attrs,i),l=null);else{const h=n.directiveStylingLast;if(-1===h||t[h]!==s)if(e=_r(s,t,n,e,i),null===l){let b=function hi(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==g(i))return t[r(i)]}(t,n,i);void 0!==b&&Array.isArray(b)&&(b=_r(null,t,n,b[1],i),b=zi(b,n.attrs,i),function xn(t,n,e,i){t[r(e?n.classBindings:n.styleBindings)]=i}(t,n,i,b))}else l=function ki(t,n,e){let i;const s=n.directiveEnd;for(let l=1+n.directiveStylingLast;l<s;l++)i=zi(i,t[l].hostAttrs,e);return zi(i,n.attrs,e)}(t,n,i)}return void 0!==l&&(i?n.residualClasses=l:n.residualStyles=l),e}(s,l,n,i),function O(t,n,e,i,s,l){let h=l?n.classBindings:n.styleBindings,m=r(h),b=g(h);t[i]=e;let M,E=!1;if(Array.isArray(e)?(M=e[1],(null===M||Fl(e,M)>0)&&(E=!0)):M=e,s)if(0!==b){const G=r(t[m+1]);t[i+1]=o(G,m),0!==G&&(t[G+1]=v(t[G+1],i)),t[m+1]=function u(t,n){return 131071&t|n<<17}(t[m+1],i)}else t[i+1]=o(m,0),0!==m&&(t[m+1]=v(t[m+1],i)),m=i;else t[i+1]=o(b,0),0===m?m=i:t[b+1]=v(t[b+1],i),b=i;E&&(t[i+1]=f(t[i+1])),$(t,M,i,!0),$(t,M,i,!1),function z(t,n,e,i,s){const l=s?t.residualClasses:t.residualStyles;null!=l&&"string"==typeof n&&Fl(l,n)>=0&&(e[i+1]=S(e[i+1]))}(n,M,t,i,l),h=o(m,b),l?n.classBindings=h:n.styleBindings=h}(s,l,n,e,h,i)}}function _r(t,n,e,i,s){let l=null;const h=e.directiveEnd;let m=e.directiveStylingLast;for(-1===m?m=e.directiveStart:m++;m<h&&(l=n[m],i=zi(i,l.hostAttrs,s),l!==t);)m++;return null!==t&&(e.directiveStylingLast=m),i}function zi(t,n,e){const i=e?1:2;let s=-1;if(null!==n)for(let l=0;l<n.length;l++){const h=n[l];"number"==typeof h?s=h:s===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),ks(t,h,!!e||n[++l]))}return void 0===t?null:t}function Yr(t,n,e){const i=String(n);""!==i&&!i.includes(" ")&&ks(t,i,e)}function lo(t,n,e,i,s,l,h,m){if(!(3&n.type))return;const b=t.data,E=b[m+1],M=function x(t){return 1==(1&t)}(E)?hs(b,n,e,s,g(E),h):void 0;ns(M)||(ns(l)||function a(t){return 2==(2&t)}(E)&&(l=hs(b,null,e,s,m,h)),function kv(t,n,e,i,s){if(n)s?t.addClass(e,i):t.removeClass(e,i);else{let l=-1===i.indexOf("-")?void 0:gu.DashCase;null==s?t.removeStyle(e,i,l):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),l|=gu.Important),t.setStyle(e,i,s,l))}}(i,h,Hc(w(),e),s,l))}function hs(t,n,e,i,s,l){const h=null===n;let m;for(;s>0;){const b=t[s],E=Array.isArray(b),M=E?b[1]:b,L=null===M;let G=e[s+1];G===Cs&&(G=L?Ys:void 0);let V=L?Gp(G,i):M===i?G:void 0;if(E&&!ns(V)&&(V=Gp(b,i)),ns(V)&&(m=V,h))return m;const ne=t[s+1];s=h?r(ne):g(ne)}if(null!==n){let b=l?n.residualClasses:n.residualStyles;null!=b&&(m=Gp(b,i))}return m}function ns(t){return void 0!==t}function ds(t,n){return 0!=(t.flags&(n?8:16))}function et(t,n=""){const e=Qn(),i=Js(),s=t+Ds,l=i.firstCreatePass?j_(i,s,1,n,null):i.data[s],h=Qs(i,e,l,n,t);e[s]=h,te()&&M_(i,e,h,l),ph(l,!1)}let Qs=(t,n,e,i,s)=>(le(!0),Dv(n[Zr],i));function wr(t){return Er("",t,""),wr}function Er(t,n,e){const i=Qn(),s=function Im(t,n,e,i){return zu(t,jh(),e)?n+kn(e)+i:Cs}(i,t,n,e);return s!==Cs&&sA(i,w(),s),Er}function ho(t,n,e,i,s){const l=Qn(),h=function Hu(t,n,e,i,s,l){const m=eg(t,Qh(),e,s);return Mu(2),m?n+kn(e)+i+kn(s)+l:Cs}(l,t,n,e,i,s);return h!==Cs&&sA(l,w(),h),ho}function np(t,n,e){const i=Qn();return zu(i,jh(),n)&&Zh(Js(),I(),i,t,n,i[Zr],e,!0),np}const w1=void 0;var $j=["en",[["a","p"],["AM","PM"],w1],[["AM","PM"],w1,w1],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],w1,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],w1,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",w1,"{1} 'at' {0}",w1],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Gj(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let qw={};function Td(t){const n=function qj(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=fL(n);if(e)return e;const i=n.split("-")[0];if(e=fL(i),e)return e;if("en"===i)return $j;throw new ln(701,!1)}function fL(t){return t in qw||(qw[t]=Uo.ng&&Uo.ng.common&&Uo.ng.common.locales&&Uo.ng.common.locales[t]),qw[t]}var rl=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(rl||{});const Kj=["zero","one","two","few","many"],Kw="en-US",oD={marker:"element"},aD={marker:"ICU"};var ff=function(t){return t[t.SHIFT=2]="SHIFT",t[t.APPEND_EAGERLY=1]="APPEND_EAGERLY",t[t.COMMENT=2]="COMMENT",t}(ff||{});let AL=Kw;function pL(t){(function Il(t,n){null==t&&qi(n,t,null,"!=")})(t,"Expected localeId to be defined"),"string"==typeof t&&(AL=t.toLowerCase().replace(/_/g,"-"))}function gL(t,n,e){const i=n.insertBeforeIndex,s=Array.isArray(i)?i[0]:i;return null===s?sT(t,0,e):Hs(e[s])}function mL(t,n,e,i,s){const l=n.insertBeforeIndex;if(Array.isArray(l)){let h=i,m=null;if(3&n.type||(m=h,h=s),null!==h&&-1===n.componentOffset)for(let b=1;b<l.length;b++)Kp(t,h,e[l[b]],m,!1)}}function _L(t,n){if(t.push(n),t.length>1)for(let e=t.length-2;e>=0;e--){const i=t[e];yL(i)||Yj(i,n)&&null===Jj(i)&&e7(i,n.index)}}function yL(t){return!(64&t.type)}function Yj(t,n){return yL(n)||t.index>n.index}function Jj(t){const n=t.insertBeforeIndex;return Array.isArray(n)?n[0]:n}function e7(t,n){const e=t.insertBeforeIndex;Array.isArray(e)?e[0]=n:(kC(gL,mL),t.insertBeforeIndex=n)}function q2(t,n){const e=t.data[n];return null===e||"string"==typeof e?null:e.hasOwnProperty("currentCaseLViewIndex")?e:e.value}function i7(t,n,e){const i=fy(t,e,64,null,null);return _L(n,i),i}function lD(t,n){const e=n[t.currentCaseLViewIndex];return null===e?e:e<0?~e:e}function vL(t){return t>>>17}function bL(t){return(131070&t)>>>1}let K2=0,W2=0;function xL(t,n,e,i){const s=e[Zr];let h,l=null;for(let m=0;m<n.length;m++){const b=n[m];if("string"==typeof b){const E=n[++m];null===e[E]&&(e[E]=Dv(s,b))}else if("number"==typeof b)switch(1&b){case 0:const E=vL(b);let M,L;if(null===l&&(l=E,h=Mv(s,i)),E===l?(M=i,L=h):(M=null,L=Hs(e[E])),null!==L){const re=bL(b);Kp(s,L,e[re],M,!1);const fe=q2(t,re);if(null!==fe&&"object"==typeof fe){const he=lD(fe,e);null!==he&&xL(t,fe.create[he],e,e[fe.anchorIdx])}}break;case 1:const V=n[++m],ne=n[++m];vw(s,Hc(b>>>1,e),null,null,V,ne,null)}else switch(b){case aD:const E=n[++m],M=n[++m];null===e[M]&&Pu(e[M]=Mb(s,E),e);break;case oD:const L=n[++m],G=n[++m];null===e[G]&&Pu(e[G]=Bv(s,L,null),e)}}}function CL(t,n,e,i,s){for(let l=0;l<e.length;l++){const h=e[l],m=e[++l];if(h&s){let b="";for(let E=l+1;E<=l+m;E++){const M=e[E];if("string"==typeof M)b+=M;else if("number"==typeof M)if(M<0)b+=kn(n[i-M]);else{const L=M>>>2;switch(3&M){case 1:const G=e[++E],V=e[++E],ne=t.data[L];"string"==typeof ne?vw(n[Zr],n[L],null,ne,G,b,V):Zh(t,ne,n,G,b,n[Zr],V,!1);break;case 0:const re=n[L];null!==re&&DC(n[Zr],re,b);break;case 2:l7(t,q2(t,L),n,b);break;case 3:EL(t,q2(t,L),i,n)}}}}else{const b=e[l+1];if(b>0&&3==(3&b)){const M=q2(t,b>>>2);n[M.currentCaseLViewIndex]<0&&EL(t,M,i,n)}}l+=m}}function EL(t,n,e,i){let s=i[n.currentCaseLViewIndex];if(null!==s){let l=K2;s<0&&(s=i[n.currentCaseLViewIndex]=~s,l=-1),CL(t,i,n.update[s],e,l)}}function l7(t,n,e,i){const s=function c7(t,n){let e=t.cases.indexOf(n);if(-1===e)switch(t.type){case 1:{const i=function Wj(t,n){const e=function dL(t){return Td(t)[rl.PluralCase]}(n)(parseInt(t,10)),i=Kj[e];return void 0!==i?i:"other"}(n,function Xj(){return AL}());e=t.cases.indexOf(i),-1===e&&"other"!==i&&(e=t.cases.indexOf("other"));break}case 0:e=t.cases.indexOf("other")}return-1===e?null:e}(n,i);if(lD(n,e)!==s&&(SL(t,n,e),e[n.currentCaseLViewIndex]=null===s?null:~s,null!==s)){const h=e[n.anchorIdx];h&&xL(t,n.create[s],e,h)}}function SL(t,n,e){let i=lD(n,e);if(null!==i){const s=n.remove[i];for(let l=0;l<s.length;l++){const h=s[l];if(h>0){const m=Hc(h,e);null!==m&&X0(e[Zr],m)}else SL(t,q2(t,~h),e)}}}function u7(){const t=[];let e,i,n=-1;function l(m,b){n=0;const E=lD(m,b);i=null!==E?m.remove[E]:Ys}function h(){if(n<i.length){const m=i[n++];return m>0?e[m]:(t.push(n,i),l(e[Oi].data[~m],e),h())}return 0===t.length?null:(i=t.pop(),n=t.pop(),h())}return function s(m,b){for(e=b;t.length;)t.pop();return l(m.value,b),h}}const cD=/\ufffd(\d+):?\d*\ufffd/gi,d7=/\ufffd(\d+)\ufffd/,IL=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,Z2="\ufffd",f7=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,A7=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,p7=/\uE500/g;function DL(t,n,e,i,s,l,h){const m=bm(t,i,1,null);let b=m<<ff.SHIFT,E=vd();n===E&&(E=null),null===E&&(b|=ff.APPEND_EAGERLY),h&&(b|=ff.COMMENT,function Pr(t){void 0===Bb&&(Bb=t())}(u7)),s.push(b,null===l?"":l);const M=fy(t,m,h?32:1,null===l?"":l,null);_L(e,M);const L=M.index;return ph(M,!1),null!==E&&n!==E&&function n7(t,n){let e=t.insertBeforeIndex;null===e?(kC(gL,mL),e=t.insertBeforeIndex=[null,n]):(function Oo(t,n,e){t!=n&&qi(e,t,n,"==")}(Array.isArray(e),!0,"Expecting array here"),e.push(n))}(E,L),M}function _7(t,n,e,i,s,l,h){const m=h.match(cD),b=DL(t,n,e,l,i,m?null:h,!1);m&&X2(s,h,b.index,null,0,null)}function X2(t,n,e,i,s,l){const h=t.length,m=h+1;t.push(null,null);const b=h+2,E=n.split(cD);let M=0;for(let L=0;L<E.length;L++){const G=E[L];if(1&L){const V=s+parseInt(G,10);t.push(-1-V),M|=BL(V)}else""!==G&&t.push(G)}return t.push(e<<2|(i?1:0)),i&&t.push(i,l),t[h]=M,t[m]=t.length-b,M}function BL(t){return 1<<Math.min(t,31)}function ML(t){let n,l,e="",i=0,s=!1;for(;null!==(n=f7.exec(t));)s?n[0]===`${Z2}/*${l}${Z2}`&&(i=n.index,s=!1):(e+=t.substring(i,n.index+n[0].length),l=n[1],s=!0);return e+=t.slice(i),e}function FL(t,n,e,i,s,l){let h=0;const m={type:s.type,currentCaseLViewIndex:bm(t,n,1,null),anchorIdx:l,cases:[],create:[],remove:[],update:[]};(function S7(t,n,e){t.push(BL(n.mainBinding),2,-1-n.mainBinding,e<<2|2)})(e,s,l),function t7(t,n,e){const i=t.data[n];null===i?t.data[n]=e:i.value=e}(t,l,m);const b=s.values;for(let E=0;E<b.length;E++){const M=b[E],L=[];for(let G=0;G<M.length;G++){const V=M[G];if("string"!=typeof V){const ne=L.push(V)-1;M[G]=`\x3c!--\ufffd${ne}\ufffd--\x3e`}}h=C7(t,m,n,e,i,s.cases[E],M.join(""),L)|h}h&&function T7(t,n,e){t.push(n,1,e<<2|3)}(e,h,l)}function x7(t){const n=[],e=[];let i=1,s=0;const l=V5(t=t.replace(IL,function(h,m,b){return i="select"===b?0:1,s=parseInt(m.slice(1),10),""}));for(let h=0;h<l.length;){let m=l[h++].trim();1===i&&(m=m.replace(/\s*(?:=)?(\w+)\s*/,"$1")),m.length&&n.push(m);const b=V5(l[h++]);n.length>e.length&&e.push(b)}return{type:i,mainBinding:s,cases:n,values:e}}function V5(t){if(!t)return[];let n=0;const e=[],i=[],s=/[{}]/g;let l;for(s.lastIndex=0;l=s.exec(t);){const m=l.index;if("}"==l[0]){if(e.pop(),0==e.length){const b=t.substring(n,m);IL.test(b)?i.push(x7(b)):i.push(b),n=m+1}}else{if(0==e.length){const b=t.substring(n,m);i.push(b),n=m+1}e.push("{")}}const h=t.substring(n);return i.push(h),i}function C7(t,n,e,i,s,l,h,m){const b=[],E=[],M=[];n.cases.push(l),n.create.push(b),n.remove.push(E),n.update.push(M);const G=function AT(t){const n=new jC(t);return function zb(){try{return!!(new window.DOMParser).parseFromString(F_(""),"text/html")}catch{return!1}}()?new RF(n):n}(ey()).getInertBodyElement(h),V=function R_(t){return"content"in t&&function $C(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}(G)||G;return V?RL(t,n,e,i,b,E,M,V,s,m,0):0}function RL(t,n,e,i,s,l,h,m,b,E,M){let L=0,G=m.firstChild;for(;G;){const V=bm(t,e,1,null);switch(G.nodeType){case Node.ELEMENT_NODE:const ne=G,re=ne.tagName.toLowerCase();if(Uv.hasOwnProperty(re)){H5(s,oD,re,b,V),t.data[V]=re;const Ne=ne.attributes;for(let We=0;We<Ne.length;We++){const pt=Ne.item(We),Qt=pt.name.toLowerCase();pt.value.match(cD)?il.hasOwnProperty(Qt)&&X2(h,pt.value,V,pt.name,0,GC[Qt]?Wp:null):I7(s,V,pt)}L=RL(t,n,e,i,s,l,h,G,V,E,M+1)|L,OL(l,V,M)}break;case Node.TEXT_NODE:const de=G.textContent||"",fe=de.match(cD);H5(s,null,fe?"":de,b,V),OL(l,V,M),fe&&(L=X2(h,de,V,null,0,null)|L);break;case Node.COMMENT_NODE:const he=d7.exec(G.textContent||"");if(he){const We=E[parseInt(he[1],10)];H5(s,aD,"",b,V),FL(t,e,i,b,We,V),E7(l,V,M)}}G=G.nextSibling}return L}function OL(t,n,e){0===e&&t.push(n)}function E7(t,n,e){0===e&&(t.push(~n),t.push(n))}function H5(t,n,e,i,s){null!==n&&t.push(n),t.push(e,s,function r7(t,n,e){return t|n<<17|e<<1}(0,i,s))}function I7(t,n,e){t.push(n<<1|1,e.name,e.value)}function PL(t,n,e=-1){const i=Js(),s=Qn(),l=Ds+t,h=La(i.consts,n),m=vd();i.firstCreatePass&&function m7(t,n,e,i,s,l){const h=vd(),m=[],b=[],E=[[]];s=function w7(t,n){if(function b7(t){return-1===t}(n))return ML(t);{const e=t.indexOf(`:${n}${Z2}`)+2+n.toString().length,i=t.search(new RegExp(`${Z2}\\/\\*\\d+:${n}${Z2}`));return ML(t.substring(e,i))}}(s,l);const M=function g7(t){return t.replace(p7," ")}(s).split(A7);for(let L=0;L<M.length;L++){let G=M[L];if(1&L){const V=47===G.charCodeAt(0),re=(G.charCodeAt(V?1:0),Ds+Number.parseInt(G.substring(V?2:1)));if(V)E.shift(),ph(vd(),!1);else{const de=i7(t,E[0],re);E.unshift([]),ph(de,!0)}}else{const V=V5(G);for(let ne=0;ne<V.length;ne++){let re=V[ne];if(1&ne){const de=re;if("object"!=typeof de)throw new Error(`Unable to parse ICU expression in "${s}" message.`);FL(t,e,b,n,de,DL(t,h,E[0],e,m,"",!0).index)}else""!==re&&_7(t,h,E[0],m,b,e,re)}}}t.data[i]={create:m,update:b}}(i,null===m?0:m.index,s,l,h,e),2===i.type?s[ba][gs]|=32:s[gs]|=32;const b=i.data[l],M=eA(i,m===s[jl]?null:m,s);(function a7(t,n,e,i){const s=t[Zr];for(let l=0;l<n.length;l++){const h=n[l++],m=n[l],E=(h&ff.APPEND_EAGERLY)===ff.APPEND_EAGERLY,M=h>>>ff.SHIFT;let L=t[M];null===L&&(L=t[M]=(h&ff.COMMENT)===ff.COMMENT?s.createComment(m):Dv(s,m)),E&&null!==e&&Kp(s,e,L,i,!1)}})(s,b.create,M,m&&8&m.type?s[m.index]:null),qA(!0)}function lA(t,n,e){PL(t,n,e),function NL(){qA(!1)}()}function uD(t){return function s7(t){t&&(K2|=1<<Math.min(W2,31)),W2++}(zu(Qn(),jh(),t)),uD}function Q5(t){!function o7(t,n,e){if(W2>0){const i=t.data[e];CL(t,n,Array.isArray(i)?i:i.update,Qh()-W2-1,K2)}K2=0,W2=0}(Js(),Qn(),t+Ds)}function j5(t,n,e,i,s){if(t=Br(t),Array.isArray(t))for(let l=0;l<t.length;l++)j5(t[l],n,e,i,s);else{const l=Js(),h=Qn(),m=Dl();let b=JA(t)?t:Br(t.provide);const E=YC(t),M=1048575&m.providerIndexes,L=m.directiveStart,G=m.providerIndexes>>20;if(JA(t)||!t.multi){const V=new He(E,s,Ve),ne=$5(b,n,s?M:M+G,L);-1===ne?(qs(Ki(m,h),l,b),G5(l,t,n.length),n.push(b),m.directiveStart++,m.directiveEnd++,s&&(m.providerIndexes+=1048576),e.push(V),h.push(V)):(e[ne]=V,h[ne]=V)}else{const V=$5(b,n,M+G,L),ne=$5(b,n,M,M+G),de=ne>=0&&e[ne];if(s&&!de||!s&&!(V>=0&&e[V])){qs(Ki(m,h),l,b);const fe=function Q7(t,n,e,i,s){const l=new He(t,e,Ve);return l.multi=[],l.index=n,l.componentProviders=0,LL(l,s,i&&!e),l}(s?H7:V7,e.length,s,i,E);!s&&de&&(e[ne].providerFactory=fe),G5(l,t,n.length,0),n.push(b),m.directiveStart++,m.directiveEnd++,s&&(m.providerIndexes+=1048576),e.push(fe),h.push(fe)}else G5(l,t,V>-1?V:ne,LL(e[s?ne:V],E,!s&&i));!s&&i&&de&&e[ne].componentProviders++}}}function G5(t,n,e,i){const s=JA(n),l=function Wb(t){return!!t.useClass}(n);if(s||l){const b=(l?Br(n.useClass):n).prototype.ngOnDestroy;if(b){const E=t.destroyHooks||(t.destroyHooks=[]);if(!s&&n.multi){const M=E.indexOf(e);-1===M?E.push(e,[i,b]):E[M+1].push(i,b)}else E.push(e,b)}}}function LL(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function $5(t,n,e,i){for(let s=e;s<i;s++)if(n[s]===t)return s;return-1}function V7(t,n,e,i){return q5(this.multi,[])}function H7(t,n,e,i){const s=this.multi;let l;if(this.providerFactory){const h=this.providerFactory.componentProviders,m=zr(e,e[Oi],this.providerFactory.index,i);l=m.slice(0,h),q5(s,l);for(let b=h;b<m.length;b++)l.push(m[b])}else l=[],q5(s,l);return l}function q5(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function Qo(t,n=[]){return e=>{e.providersResolver=(i,s)=>function z7(t,n,e){const i=Js();if(i.firstCreatePass){const s=yc(t);j5(e,i.data,i.blueprint,s,!0),j5(n,i.data,i.blueprint,s,!1)}}(i,s?s(t):t,n)}}class x1{}class UL{}class K5 extends x1{constructor(n,e,i){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new vI(this);const s=ra(n);this._bootstrapComponents=Ed(s.bootstrap),this._r3Injector=jT(n,e,[{provide:x1,useValue:this},{provide:Yv,useValue:this.componentFactoryResolver},...i],Un(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class W5 extends UL{constructor(n){super(),this.moduleType=n}create(n){return new K5(this.moduleType,n,[])}}class zL extends x1{constructor(n){super(),this.componentFactoryResolver=new vI(this),this.instance=null;const e=new O_([...n.providers,{provide:x1,useValue:this},{provide:Yv,useValue:this.componentFactoryResolver}],n.parent||Xb(),n.debugName,new Set(["environment"]));this.injector=e,n.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function Z5(t,n,e=null){return new zL({providers:t,parent:n,debugName:e,runEnvironmentInitializers:!0}).injector}let $7=(()=>{class t{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){const i=CT(0,e.type),s=i.length>0?Z5([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,s)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=Pn({token:t,providedIn:"environment",factory:()=>new t(Xt(Lu))})}return t})();function Af(t){t.getStandaloneInjector=n=>n.get($7).getOrCreateStandaloneInjector(t)}function Cc(t,n,e){const i=pl()+t,s=Qn();return s[i]===Cs?hf(s,i,e?n.call(e):n()):function Jp(t,n){return t[n]}(s,i)}function C1(t,n,e,i){return function qL(t,n,e,i,s,l){const h=n+e;return zu(t,h,s)?hf(t,h+1,l?i.call(l,s):i(s)):J2(t,h+1)}(Qn(),pl(),t,n,e,i)}function Y2(t,n,e,i,s){return function KL(t,n,e,i,s,l,h){const m=n+e;return eg(t,m,s,l)?hf(t,m+2,h?i.call(h,s,l):i(s,l)):J2(t,m+2)}(Qn(),pl(),t,n,e,i,s)}function Y5(t,n,e,i,s,l){return function WL(t,n,e,i,s,l,h,m){const b=n+e;return function Tm(t,n,e,i,s){const l=eg(t,n,e,i);return zu(t,n+2,s)||l}(t,b,s,l,h)?hf(t,b+3,m?i.call(m,s,l,h):i(s,l,h)):J2(t,b+3)}(Qn(),pl(),t,n,e,i,s,l)}function J2(t,n){const e=t[n];return e===Cs?void 0:e}function AG(){return this._results[Symbol.iterator]()}class J5{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new vi)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=J5.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=AG)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const i=this;i.dirty=!1;const s=function Ru(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function bb(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let s=t[i],l=n[i];if(e&&(s=e(s),l=e(l)),l!==s)return!1}return!0}(i._results,s,e))&&(i._results=s,i.length=s.length,i.last=s[this.length-1],i.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function gG(t,n,e,i=!0){const s=n[Oi];if(function EF(t,n,e,i){const s=Ya+i,l=e.length;i>0&&(e[s-1][pc]=n),i<l-Ya?(n[pc]=e[s],wb(e,Ya+i,n)):(e.push(n),n[pc]=null),n[Wo]=e;const h=n[Tp];null!==h&&e!==h&&function SF(t,n){const e=t[Uc];n[ba]!==n[Wo][Wo][ba]&&(t[gd]=!0),null===e?t[Uc]=[n]:e.push(n)}(h,n);const m=n[uh];null!==m&&m.insertView(t),n[gs]|=128}(s,n,t,e),i){const l=NC(e,t),h=n[Zr],m=Mv(h,t[mc]);null!==m&&function BC(t,n,e,i,s,l){i[Zi]=s,i[jl]=n,Y0(t,i,e,1,s,l)}(s,t[jl],h,n,m,l)}}let bl=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=yG}return t})();const mG=bl,_G=class extends mG{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,e){return this.createEmbeddedViewImpl(n,e)}createEmbeddedViewImpl(n,e,i){const s=function pG(t,n,e,i){const s=n.tView,m=Q_(t,s,e,4096&t[gs]?4096:16,null,n,null,null,null,i?.injector??null,i?.hydrationInfo??null);m[Tp]=t[n.index];const E=t[uh];return null!==E&&(m[uh]=E.createEmbeddedView(s)),w2(s,m,e),m}(this._declarationLView,this._declarationTContainer,n,{injector:e,hydrationInfo:i});return new d1(s)}};function yG(){return hD(Dl(),Qn())}function hD(t,n){return 4&t.type?new _G(n,t,U_(t,n)):null}let cA=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=EG}return t})();function EG(){return r3(Dl(),Qn())}const SG=cA,n3=class extends SG{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return U_(this._hostTNode,this._hostLView)}get injector(){return new oo(this._hostTNode,this._hostLView)}get parentInjector(){const n=kr(this._hostTNode,this._hostLView);if(St(n)){const e=An(n,this._hostLView),i=Ze(n);return new oo(e[Oi].data[i+8],e)}return new oo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=i3(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-Ya}createEmbeddedView(n,e,i){let s,l;"number"==typeof i?s=i:null!=i&&(s=i.index,l=i.injector);const m=n.createEmbeddedViewImpl(e||{},l,null);return this.insertImpl(m,s,false),m}createComponent(n,e,i,s,l){const h=n&&!function Aa(t){return"function"==typeof t}(n);let m;if(h)m=e;else{const re=e||{};m=re.index,i=re.injector,s=re.projectableNodes,l=re.environmentInjector||re.ngModuleRef}const b=h?n:new vy(Is(n)),E=i||this.parentInjector;if(!l&&null==b.ngModule){const de=(h?E:this.parentInjector).get(Lu,null);de&&(l=de)}Is(b.componentType??{});const V=b.create(E,s,null,l);return this.insertImpl(V.hostView,m,false),V}insert(n,e){return this.insertImpl(n,e,!1)}insertImpl(n,e,i){const s=n._lView;if(function p_(t){return Gl(t[Wo])}(s)){const b=this.indexOf(n);if(-1!==b)this.detach(b);else{const E=s[Wo],M=new n3(E,E[jl],E[Wo]);M.detach(M.indexOf(n))}}const h=this._adjustIndex(e),m=this._lContainer;return gG(m,s,h,!i),n.attachToViewContainerRef(),wb(eR(m),h,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=i3(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=Fb(this._lContainer,e);i&&(mo(eR(this._lContainer),e),MC(i[Oi],i))}detach(n){const e=this._adjustIndex(n,-1),i=Fb(this._lContainer,e);return i&&null!=mo(eR(this._lContainer),e)?new d1(i):null}_adjustIndex(n,e=0){return n??this.length+e}};function i3(t){return t[8]}function eR(t){return t[8]||(t[8]=[])}function r3(t,n){let e;const i=n[t.index];return Gl(i)?e=i:(e=fI(i,n,null,t),n[t.index]=e,$_(n,e)),s3(e,n,t,i),new n3(e,t,n)}let s3=function o3(t,n,e,i){if(t[mc])return;let s;s=8&e.type?Hs(i):function TG(t,n){const e=t[Zr],i=e.createComment(""),s=ql(n,t);return Kp(e,Mv(e,s),i,function RC(t,n){return t.nextSibling(n)}(e,s),!1),i}(n,e),t[mc]=s};class tR{constructor(n){this.queryList=n,this.matches=null}clone(){return new tR(this.queryList)}setDirty(){this.queryList.setDirty()}}class nR{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,s=[];for(let l=0;l<i;l++){const h=e.getByIndex(l);s.push(this.queries[h.indexInDeclarationView].clone())}return new nR(s)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==h3(n,e).matches&&this.queries[e].setDirty()}}class a3{constructor(n,e,i=null){this.predicate=n,this.flags=e,this.read=i}}class iR{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const s=null!==e?e.length:0,l=this.getByIndex(i).embeddedTView(n,s);l&&(l.indexInDeclarationView=i,null!==e?e.push(l):e=[l])}return null!==e?new iR(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class rR{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new rR(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let s=0;s<i.length;s++){const l=i[s];this.matchTNodeWithReadOption(n,e,BG(e,l)),this.matchTNodeWithReadOption(n,e,eo(e,n,l,!1,!1))}else i===bl?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,eo(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const s=this.metadata.read;if(null!==s)if(s===ao||s===cA||s===bl&&4&e.type)this.addMatch(e.index,-2);else{const l=eo(e,n,s,!1,!1);null!==l&&this.addMatch(e.index,l)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function BG(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function FG(t,n,e,i){return-1===e?function MG(t,n){return 11&t.type?U_(t,n):4&t.type?hD(t,n):null}(n,t):-2===e?function RG(t,n,e){return e===ao?U_(n,t):e===bl?hD(n,t):e===cA?r3(n,t):void 0}(t,n,i):zr(t,t[Oi],e,n)}function l3(t,n,e,i){const s=n[uh].queries[i];if(null===s.matches){const l=t.data,h=e.matches,m=[];for(let b=0;b<h.length;b+=2){const E=h[b];m.push(E<0?null:FG(n,l[E],h[b+1],e.metadata.read))}s.matches=m}return s.matches}function sR(t,n,e,i){const s=t.queries.getByIndex(e),l=s.matches;if(null!==l){const h=l3(t,n,s,e);for(let m=0;m<l.length;m+=2){const b=l[m];if(b>0)i.push(h[m/2]);else{const E=l[m+1],M=n[-b];for(let L=Ya;L<M.length;L++){const G=M[L];G[Tp]===G[Wo]&&sR(G[Oi],G,E,i)}if(null!==M[Uc]){const L=M[Uc];for(let G=0;G<L.length;G++){const V=L[G];sR(V[Oi],V,E,i)}}}}}return i}function is(t){const n=Qn(),e=Js(),i=dm();KA(i+1);const s=h3(e,i);if(t.dirty&&function am(t){return 4==(4&t[gs])}(n)===(2==(2&s.metadata.flags))){if(null===s.matches)t.reset([]);else{const l=s.crossesNgTemplate?sR(e,n,i,[]):l3(e,n,s,i);t.reset(l,QT),t.notifyOnChanges()}return!0}return!1}function wl(t,n,e){const i=Js();i.firstCreatePass&&(u3(i,new a3(t,n,e),-1),2==(2&n)&&(i.staticViewQueries=!0)),c3(i,Qn(),n)}function Qa(t,n,e,i){const s=Js();if(s.firstCreatePass){const l=Dl();u3(s,new a3(n,e,i),l.index),function kG(t,n){const e=t.contentQueries||(t.contentQueries=[]);n!==(e.length?e[e.length-1]:-1)&&e.push(t.queries.length-1,n)}(s,t),2==(2&e)&&(s.staticContentQueries=!0)}c3(s,Qn(),e)}function rs(){return function OG(t,n){return t[uh].queries[n].queryList}(Qn(),dm())}function c3(t,n,e){const i=new J5(4==(4&e));(function oI(t,n,e,i){const s=AI(n);s.push(e),t.firstCreatePass&&bw(t).push(i,s.length-1)})(t,n,i,i.destroy),null===n[uh]&&(n[uh]=new nR),n[uh].queries.push(new tR(i))}function u3(t,n,e){null===t.queries&&(t.queries=new iR),t.queries.track(new rR(n,e))}function h3(t,n){return t.queries.getByIndex(n)}function Zl(t,n){return hD(t,n)}const AD=new pi("Application Initializer");let hR=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i}),this.appInits=In(AD,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const e=[];for(const s of this.appInits){const l=s();if(v1(l))e.push(l);else if(kw(l)){const h=new Promise((m,b)=>{l.subscribe({complete:m,error:b})});e.push(h)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(s=>{this.reject(s)}),0===e.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),I3=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();const uA=new pi("LocaleId",{providedIn:"root",factory:()=>In(uA,vs.Optional|vs.SkipSelf)||function n9(){return typeof $localize<"u"&&$localize.locale||Kw}()});let pD=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Fi(!1)}add(){this.hasPendingTasks.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),e}remove(e){this.pendingTasks.delete(e),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class s9{constructor(n,e){this.ngModuleFactory=n,this.componentFactories=e}}let D3=(()=>{class t{compileModuleSync(e){return new W5(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const i=this.compileModuleSync(e),l=Ed(ra(e).declarations).reduce((h,m)=>{const b=Is(m);return b&&h.push(new vy(b)),h},[]);return new s9(i,l)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const R3=new pi(""),mD=new pi("");let gR,AR=(()=>{class t{constructor(e,i,s){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,gR||(function T9(t){gR=t}(s),s.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Wi.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,s){let l=-1;i&&i>0&&(l=setTimeout(()=>{this._callbacks=this._callbacks.filter(h=>h.timeoutId!==l),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:l,updateCb:s})}whenStable(e,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,s){return[]}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Wi),Xt(pR),Xt(mD))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})(),pR=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return gR?.findTestabilityInTree(this,e,i)??null}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})(),Dy=null;const O3=new pi("AllowMultipleToken"),mR=new pi("PlatformDestroyListeners"),_R=new pi("appBootstrapListener");class P3{constructor(n,e){this.name=n,this.token=e}}function L3(t,n,e=[]){const i=`Platform: ${n}`,s=new pi(i);return(l=[])=>{let h=yR();if(!h||h.injector.get(O3,!1)){const m=[...e,...l,{provide:s,useValue:!0}];t?t(m):function B9(t){if(Dy&&!Dy.get(O3,!1))throw new ln(400,!1);(function k3(){!function wi(t){LA=t}(()=>{throw new ln(600,!1)})})(),Dy=t;const n=t.get(z3);(function N3(t){t.get($v,null)?.forEach(e=>e())})(t)}(function U3(t=[],n){return Zc.create({name:n,providers:[{provide:ry,useValue:"platform"},{provide:mR,useValue:new Set([()=>Dy=null])},...t]})}(m,i))}return function F9(t){const n=yR();if(!n)throw new ln(401,!1);return n}()}}function yR(){return Dy?.get(z3)??null}let z3=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const s=function R9(t="zone.js",n){return"noop"===t?new WT:"zone.js"===t?new Wi(n):t}(i?.ngZone,function V3(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{const l=function G7(t,n,e){return new K5(t,n,e)}(e.moduleType,this.injector,function $3(t){return[{provide:Wi,useFactory:t},{provide:Qv,multi:!0,useFactory:()=>{const n=In(k9,{optional:!0});return()=>n.initialize()}},{provide:G3,useFactory:O9},{provide:H_,useFactory:uw}]}(()=>s)),h=l.injector.get(no,null);return s.runOutsideAngular(()=>{const m=s.onError.subscribe({next:b=>{h.handleError(b)}});l.onDestroy(()=>{_D(this._modules,l),m.unsubscribe()})}),function H3(t,n,e){try{const i=e();return v1(i)?i.catch(s=>{throw n.runOutsideAngular(()=>t.handleError(s)),s}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(h,s,()=>{const m=l.injector.get(hR);return m.runInitializers(),m.donePromise.then(()=>(pL(l.injector.get(uA,Kw)||Kw),this._moduleDoBootstrap(l),l))})})}bootstrapModule(e,i=[]){const s=Q3({},i);return function I9(t,n,e){const i=new W5(e);return Promise.resolve(i)}(0,0,e).then(l=>this.bootstrapModuleFactory(l,s))}_moduleDoBootstrap(e){const i=e.injector.get(Fm);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(s=>i.bootstrap(s));else{if(!e.instance.ngDoBootstrap)throw new ln(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ln(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(mR,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Zc))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();function Q3(t,n){return Array.isArray(n)?n.reduce(Q3,t):{...t,...n}}let Fm=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=In(G3),this.zoneIsStable=In(H_),this.componentTypes=[],this.components=[],this.isStable=In(pD).hasPendingTasks.pipe(cl(e=>e?Bi(!1):this.zoneIsStable),Tl(),gp()),this._injector=In(Lu)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,i){const s=e instanceof zT;if(!this._injector.get(hR).done)throw!s&&function oh(t){const n=Is(t)||dl(t)||fl(t);return null!==n&&n.standalone}(e),new ln(405,!1);let h;h=s?e:this._injector.get(Yv).resolveComponentFactory(e),this.componentTypes.push(h.componentType);const m=function D9(t){return t.isBoundToModule}(h)?void 0:this._injector.get(x1),E=h.create(Zc.NULL,[],i||h.selector,m),M=E.location.nativeElement,L=E.injector.get(R3,null);return L?.registerApplication(M),E.onDestroy(()=>{this.detachView(E.hostView),_D(this.components,E),L?.unregisterApplication(M)}),this._loadComponent(E),E}tick(){if(this._runningTick)throw new ln(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this.internalErrorHandler(e)}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;_D(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(_R,[]);i.push(...this._bootstrapListeners),i.forEach(s=>s(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>_D(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new ln(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function _D(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}const G3=new pi("",{providedIn:"root",factory:()=>In(no).handleError.bind(void 0)});function O9(){const t=In(Wi),n=In(no);return e=>t.runOutsideAngular(()=>n.handleError(e))}let k9=(()=>{class t{constructor(){this.zone=In(Wi),this.applicationRef=In(Fm)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();let gf=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=L9}return t})();function L9(t){return function U9(t,n,e){if(Jd(t)&&!e){const i=Ja(t.index,n);return new d1(i,i)}return 47&t.type?new d1(n[ba],n):null}(Dl(),Qn(),16==(16&t))}class Z3{constructor(){}supports(n){return W_(n)}create(n){return new G9(n)}}const j9=(t,n)=>n;class G9{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||j9}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,s=0,l=null;for(;e||i;){const h=!i||e&&e.currentIndex<Y3(i,s,l)?e:i,m=Y3(h,s,l),b=h.currentIndex;if(h===i)s--,i=i._nextRemoved;else if(e=e._next,null==h.previousIndex)s++;else{l||(l=[]);const E=m-s,M=b-s;if(E!=M){for(let G=0;G<E;G++){const V=G<l.length?l[G]:l[G]=0,ne=V+G;M<=ne&&ne<E&&(l[G]=V+1)}l[h.previousIndex]=M-E}}m!==b&&n(h,m,b)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!W_(n))throw new ln(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let s,l,h,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let m=0;m<this.length;m++)l=n[m],h=this._trackByFn(m,l),null!==e&&Object.is(e.trackById,h)?(i&&(e=this._verifyReinsertion(e,l,h,m)),Object.is(e.item,l)||this._addIdentityChange(e,l)):(e=this._mismatch(e,l,h,m),i=!0),e=e._next}else s=0,function S5(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Symbol.iterator]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,m=>{h=this._trackByFn(s,m),null!==e&&Object.is(e.trackById,h)?(i&&(e=this._verifyReinsertion(e,m,h,s)),Object.is(e.item,m)||this._addIdentityChange(e,m)):(e=this._mismatch(e,m,h,s),i=!0),e=e._next,s++}),this.length=s;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,s){let l;return null===n?l=this._itTail:(l=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,l,s)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,s))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,l,s)):n=this._addAfter(new $9(e,i),l,s),n}_verifyReinsertion(n,e,i,s){let l=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==l?n=this._reinsertAfter(l,n._prev,s):n.currentIndex!=s&&(n.currentIndex=s,this._addToMoves(n,s)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const s=n._prevRemoved,l=n._nextRemoved;return null===s?this._removalsHead=l:s._nextRemoved=l,null===l?this._removalsTail=s:l._prevRemoved=s,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const s=null===e?this._itHead:e._next;return n._next=s,n._prev=e,null===s?this._itTail=n:s._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new X3),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new X3),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class $9{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class q9{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class X3{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new q9,this.map.set(e,i)),i.add(n)}get(n,e){const s=this.map.get(n);return s?s.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Y3(t,n,e){const i=t.previousIndex;if(null===i)return i;let s=0;return e&&i<e.length&&(s=e[i]),i+n+s}class J3{constructor(){}supports(n){return n instanceof Map||I2(n)}create(){return new K9}}class K9{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||I2(n)))throw new ln(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,s)=>{if(e&&e.key===s)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const l=this._getOrCreateRecordForKey(s,i);e=this._insertBeforeOrAppend(e,l)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const s=this._records.get(n);this._maybeAddToChanges(s,e);const l=s._prev,h=s._next;return l&&(l._next=h),h&&(h._prev=l),s._next=null,s._prev=null,s}const i=new W9(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class W9{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function e4(){return new bD([new Z3])}let bD=(()=>{class t{static#e=this.\u0275prov=Pn({token:t,providedIn:"root",factory:e4});constructor(e){this.factories=e}static create(e,i){if(null!=i){const s=i.factories.slice();e=e.concat(s)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||e4()),deps:[[t,new S_,new Vo]]}}find(e){const i=this.factories.find(s=>s.supports(e));if(null!=i)return i;throw new ln(901,!1)}}return t})();function t4(){return new iE([new J3])}let iE=(()=>{class t{static#e=this.\u0275prov=Pn({token:t,providedIn:"root",factory:t4});constructor(e){this.factories=e}static create(e,i){if(i){const s=i.factories.slice();e=e.concat(s)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||t4()),deps:[[t,new S_,new Vo]]}}find(e){const i=this.factories.find(s=>s.supports(e));if(i)return i;throw new ln(901,!1)}}return t})();const Y9=L3(null,"core",[]);let J9=(()=>{class t{constructor(e){}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Fm))};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})();function Xw(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function ER(t,n){const e=Is(t),i=n.elementInjector||Xb();return new vy(e).create(i,n.projectableNodes,n.hostElement,n.environmentInjector)}let SR=null;function By(){return SR}class f${}const wa=new pi("DocumentToken");let TR=(()=>{class t{historyGo(e){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(){return In(p$)},providedIn:"platform"})}return t})();const A$=new pi("Location Initialized");let p$=(()=>{class t extends TR{constructor(){super(),this._doc=In(wa),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return By().getBaseHref(this._doc)}onPopState(e){const i=By().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){const i=By().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,i,s){this._history.pushState(e,i,s)}replaceState(e,i,s){this._history.replaceState(e,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(){return new t},providedIn:"platform"})}return t})();function IR(t,n){if(0==t.length)return n;if(0==n.length)return t;let e=0;return t.endsWith("/")&&e++,n.startsWith("/")&&e++,2==e?t+n.substring(1):1==e?t+n:t+"/"+n}function u4(t){const n=t.match(/#|\?|$/),e=n&&n.index||t.length;return t.slice(0,e-("/"===t[e-1]?1:0))+t.slice(e)}function s0(t){return t&&"?"!==t[0]?"?"+t:t}let S1=(()=>{class t{historyGo(e){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(){return In(d4)},providedIn:"root"})}return t})();const h4=new pi("appBaseHref");let d4=(()=>{class t extends S1{constructor(e,i){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??In(wa).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return IR(this._baseHref,e)}path(e=!1){const i=this._platformLocation.pathname+s0(this._platformLocation.search),s=this._platformLocation.hash;return s&&e?`${i}${s}`:i}pushState(e,i,s,l){const h=this.prepareExternalUrl(s+s0(l));this._platformLocation.pushState(e,i,h)}replaceState(e,i,s,l){const h=this.prepareExternalUrl(s+s0(l));this._platformLocation.replaceState(e,i,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(TR),Xt(h4,8))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),g$=(()=>{class t extends S1{constructor(e,i){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(e){const i=IR(this._baseHref,e);return i.length>0?"#"+i:i}pushState(e,i,s,l){let h=this.prepareExternalUrl(s+s0(l));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.pushState(e,i,h)}replaceState(e,i,s,l){let h=this.prepareExternalUrl(s+s0(l));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.replaceState(e,i,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(TR),Xt(h4,8))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})(),DR=(()=>{class t{constructor(e){this._subject=new vi,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const i=this._locationStrategy.getBaseHref();this._basePath=function y$(t){if(new RegExp("^(https?:)?//").test(t)){const[,e]=t.split(/\/\/[^\/]+/);return e}return t}(u4(f4(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+s0(i))}normalize(e){return t.stripTrailingSlash(function _$(t,n){if(!t||!n.startsWith(t))return n;const e=n.substring(t.length);return""===e||["/",";","?","#"].includes(e[0])?e:n}(this._basePath,f4(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,i="",s=null){this._locationStrategy.pushState(s,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+s0(i)),s)}replaceState(e,i="",s=null){this._locationStrategy.replaceState(s,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+s0(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(s=>s(e,i))}subscribe(e,i,s){return this._subject.subscribe({next:e,error:i,complete:s})}static#e=this.normalizeQueryParams=s0;static#t=this.joinWithSlash=IR;static#n=this.stripTrailingSlash=u4;static#i=this.\u0275fac=function(i){return new(i||t)(Xt(S1))};static#r=this.\u0275prov=Pn({token:t,factory:function(){return function m$(){return new DR(Xt(S1))}()},providedIn:"root"})}return t})();function f4(t){return t.replace(/\/index.html$/,"")}var xD=function(t){return t[t.Decimal=0]="Decimal",t[t.Percent=1]="Percent",t[t.Currency=2]="Currency",t[t.Scientific=3]="Scientific",t}(xD||{}),vu=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}(vu||{}),jo=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}(jo||{}),hA=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}(hA||{}),Ec=function(t){return t[t.Decimal=0]="Decimal",t[t.Group=1]="Group",t[t.List=2]="List",t[t.PercentSign=3]="PercentSign",t[t.PlusSign=4]="PlusSign",t[t.MinusSign=5]="MinusSign",t[t.Exponential=6]="Exponential",t[t.SuperscriptingExponent=7]="SuperscriptingExponent",t[t.PerMille=8]="PerMille",t[t.Infinity=9]="Infinity",t[t.NaN=10]="NaN",t[t.TimeSeparator=11]="TimeSeparator",t[t.CurrencyDecimal=12]="CurrencyDecimal",t[t.CurrencyGroup=13]="CurrencyGroup",t}(Ec||{});function p4(t,n,e){const i=Td(t),l=rp([i[rl.DayPeriodsFormat],i[rl.DayPeriodsStandalone]],n);return rp(l,e)}function g4(t,n,e){const i=Td(t),l=rp([i[rl.DaysFormat],i[rl.DaysStandalone]],n);return rp(l,e)}function BR(t,n,e){const i=Td(t),l=rp([i[rl.MonthsFormat],i[rl.MonthsStandalone]],n);return rp(l,e)}function CD(t,n){return rp(Td(t)[rl.DateFormat],n)}function ED(t,n){return rp(Td(t)[rl.TimeFormat],n)}function SD(t,n){return rp(Td(t)[rl.DateTimeFormat],n)}function ip(t,n){const e=Td(t),i=e[rl.NumberSymbols][n];if(typeof i>"u"){if(n===Ec.CurrencyDecimal)return e[rl.NumberSymbols][Ec.Decimal];if(n===Ec.CurrencyGroup)return e[rl.NumberSymbols][Ec.Group]}return i}function m4(t){if(!t[rl.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[rl.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function rp(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new Error("Locale data API: locale data undefined")}function FR(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const B$=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,rE={},M$=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var o0=function(t){return t[t.Short=0]="Short",t[t.ShortGMT=1]="ShortGMT",t[t.Long=2]="Long",t[t.Extended=3]="Extended",t}(o0||{}),sa=function(t){return t[t.FullYear=0]="FullYear",t[t.Month=1]="Month",t[t.Date=2]="Date",t[t.Hours=3]="Hours",t[t.Minutes=4]="Minutes",t[t.Seconds=5]="Seconds",t[t.FractionalSeconds=6]="FractionalSeconds",t[t.Day=7]="Day",t}(sa||{}),oa=function(t){return t[t.DayPeriods=0]="DayPeriods",t[t.Days=1]="Days",t[t.Months=2]="Months",t[t.Eras=3]="Eras",t}(oa||{});function TD(t,n,e,i){let s=function z$(t){if(v4(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[s,l=1,h=1]=t.split("-").map(m=>+m);return ID(s,l-1,h)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let i;if(i=t.match(B$))return function V$(t){const n=new Date(0);let e=0,i=0;const s=t[8]?n.setUTCFullYear:n.setFullYear,l=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),i=Number(t[9]+t[11])),s.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const h=Number(t[4]||0)-e,m=Number(t[5]||0)-i,b=Number(t[6]||0),E=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return l.call(n,h,m,b,E),n}(i)}const n=new Date(t);if(!v4(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=a0(e,n)||n;let m,h=[];for(;n;){if(m=M$.exec(n),!m){h.push(n);break}{h=h.concat(m.slice(1));const M=h.pop();if(!M)break;n=M}}let b=s.getTimezoneOffset();i&&(b=y4(i,b),s=function U$(t,n,e){const i=e?-1:1,s=t.getTimezoneOffset();return function L$(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,i*(y4(n,s)-s))}(s,i,!0));let E="";return h.forEach(M=>{const L=function N$(t){if(OR[t])return OR[t];let n;switch(t){case"G":case"GG":case"GGG":n=sl(oa.Eras,jo.Abbreviated);break;case"GGGG":n=sl(oa.Eras,jo.Wide);break;case"GGGGG":n=sl(oa.Eras,jo.Narrow);break;case"y":n=Yc(sa.FullYear,1,0,!1,!0);break;case"yy":n=Yc(sa.FullYear,2,0,!0,!0);break;case"yyy":n=Yc(sa.FullYear,3,0,!1,!0);break;case"yyyy":n=Yc(sa.FullYear,4,0,!1,!0);break;case"Y":n=FD(1);break;case"YY":n=FD(2,!0);break;case"YYY":n=FD(3);break;case"YYYY":n=FD(4);break;case"M":case"L":n=Yc(sa.Month,1,1);break;case"MM":case"LL":n=Yc(sa.Month,2,1);break;case"MMM":n=sl(oa.Months,jo.Abbreviated);break;case"MMMM":n=sl(oa.Months,jo.Wide);break;case"MMMMM":n=sl(oa.Months,jo.Narrow);break;case"LLL":n=sl(oa.Months,jo.Abbreviated,vu.Standalone);break;case"LLLL":n=sl(oa.Months,jo.Wide,vu.Standalone);break;case"LLLLL":n=sl(oa.Months,jo.Narrow,vu.Standalone);break;case"w":n=RR(1);break;case"ww":n=RR(2);break;case"W":n=RR(1,!0);break;case"d":n=Yc(sa.Date,1);break;case"dd":n=Yc(sa.Date,2);break;case"c":case"cc":n=Yc(sa.Day,1);break;case"ccc":n=sl(oa.Days,jo.Abbreviated,vu.Standalone);break;case"cccc":n=sl(oa.Days,jo.Wide,vu.Standalone);break;case"ccccc":n=sl(oa.Days,jo.Narrow,vu.Standalone);break;case"cccccc":n=sl(oa.Days,jo.Short,vu.Standalone);break;case"E":case"EE":case"EEE":n=sl(oa.Days,jo.Abbreviated);break;case"EEEE":n=sl(oa.Days,jo.Wide);break;case"EEEEE":n=sl(oa.Days,jo.Narrow);break;case"EEEEEE":n=sl(oa.Days,jo.Short);break;case"a":case"aa":case"aaa":n=sl(oa.DayPeriods,jo.Abbreviated);break;case"aaaa":n=sl(oa.DayPeriods,jo.Wide);break;case"aaaaa":n=sl(oa.DayPeriods,jo.Narrow);break;case"b":case"bb":case"bbb":n=sl(oa.DayPeriods,jo.Abbreviated,vu.Standalone,!0);break;case"bbbb":n=sl(oa.DayPeriods,jo.Wide,vu.Standalone,!0);break;case"bbbbb":n=sl(oa.DayPeriods,jo.Narrow,vu.Standalone,!0);break;case"B":case"BB":case"BBB":n=sl(oa.DayPeriods,jo.Abbreviated,vu.Format,!0);break;case"BBBB":n=sl(oa.DayPeriods,jo.Wide,vu.Format,!0);break;case"BBBBB":n=sl(oa.DayPeriods,jo.Narrow,vu.Format,!0);break;case"h":n=Yc(sa.Hours,1,-12);break;case"hh":n=Yc(sa.Hours,2,-12);break;case"H":n=Yc(sa.Hours,1);break;case"HH":n=Yc(sa.Hours,2);break;case"m":n=Yc(sa.Minutes,1);break;case"mm":n=Yc(sa.Minutes,2);break;case"s":n=Yc(sa.Seconds,1);break;case"ss":n=Yc(sa.Seconds,2);break;case"S":n=Yc(sa.FractionalSeconds,1);break;case"SS":n=Yc(sa.FractionalSeconds,2);break;case"SSS":n=Yc(sa.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=BD(o0.Short);break;case"ZZZZZ":n=BD(o0.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=BD(o0.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=BD(o0.Long);break;default:return null}return OR[t]=n,n}(M);E+=L?L(s,e,b):"''"===M?"'":M.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),E}function ID(t,n,e){const i=new Date(0);return i.setFullYear(t,n,e),i.setHours(0,0,0),i}function a0(t,n){const e=function b$(t){return Td(t)[rl.LocaleId]}(t);if(rE[e]=rE[e]||{},rE[e][n])return rE[e][n];let i="";switch(n){case"shortDate":i=CD(t,hA.Short);break;case"mediumDate":i=CD(t,hA.Medium);break;case"longDate":i=CD(t,hA.Long);break;case"fullDate":i=CD(t,hA.Full);break;case"shortTime":i=ED(t,hA.Short);break;case"mediumTime":i=ED(t,hA.Medium);break;case"longTime":i=ED(t,hA.Long);break;case"fullTime":i=ED(t,hA.Full);break;case"short":const s=a0(t,"shortTime"),l=a0(t,"shortDate");i=DD(SD(t,hA.Short),[s,l]);break;case"medium":const h=a0(t,"mediumTime"),m=a0(t,"mediumDate");i=DD(SD(t,hA.Medium),[h,m]);break;case"long":const b=a0(t,"longTime"),E=a0(t,"longDate");i=DD(SD(t,hA.Long),[b,E]);break;case"full":const M=a0(t,"fullTime"),L=a0(t,"fullDate");i=DD(SD(t,hA.Full),[M,L])}return i&&(rE[e][n]=i),i}function DD(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,i){return null!=n&&i in n?n[i]:e})),t}function sg(t,n,e="-",i,s){let l="";(t<0||s&&t<=0)&&(s?t=1-t:(t=-t,l=e));let h=String(t);for(;h.length<n;)h="0"+h;return i&&(h=h.slice(h.length-n)),l+h}function Yc(t,n,e=0,i=!1,s=!1){return function(l,h){let m=function R$(t,n){switch(t){case sa.FullYear:return n.getFullYear();case sa.Month:return n.getMonth();case sa.Date:return n.getDate();case sa.Hours:return n.getHours();case sa.Minutes:return n.getMinutes();case sa.Seconds:return n.getSeconds();case sa.FractionalSeconds:return n.getMilliseconds();case sa.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,l);if((e>0||m>-e)&&(m+=e),t===sa.Hours)0===m&&-12===e&&(m=12);else if(t===sa.FractionalSeconds)return function F$(t,n){return sg(t,3).substring(0,n)}(m,n);const b=ip(h,Ec.MinusSign);return sg(m,n,b,i,s)}}function sl(t,n,e=vu.Format,i=!1){return function(s,l){return function O$(t,n,e,i,s,l){switch(e){case oa.Months:return BR(n,s,i)[t.getMonth()];case oa.Days:return g4(n,s,i)[t.getDay()];case oa.DayPeriods:const h=t.getHours(),m=t.getMinutes();if(l){const E=function E$(t){const n=Td(t);return m4(n),(n[rl.ExtraData][2]||[]).map(i=>"string"==typeof i?FR(i):[FR(i[0]),FR(i[1])])}(n),M=function S$(t,n,e){const i=Td(t);m4(i);const l=rp([i[rl.ExtraData][0],i[rl.ExtraData][1]],n)||[];return rp(l,e)||[]}(n,s,i),L=E.findIndex(G=>{if(Array.isArray(G)){const[V,ne]=G,re=h>=V.hours&&m>=V.minutes,de=h<ne.hours||h===ne.hours&&m<ne.minutes;if(V.hours<ne.hours){if(re&&de)return!0}else if(re||de)return!0}else if(G.hours===h&&G.minutes===m)return!0;return!1});if(-1!==L)return M[L]}return p4(n,s,i)[h<12?0:1];case oa.Eras:return function w$(t,n){return rp(Td(t)[rl.Eras],n)}(n,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(s,l,t,n,e,i)}}function BD(t){return function(n,e,i){const s=-1*i,l=ip(e,Ec.MinusSign),h=s>0?Math.floor(s/60):Math.ceil(s/60);switch(t){case o0.Short:return(s>=0?"+":"")+sg(h,2,l)+sg(Math.abs(s%60),2,l);case o0.ShortGMT:return"GMT"+(s>=0?"+":"")+sg(h,1,l);case o0.Long:return"GMT"+(s>=0?"+":"")+sg(h,2,l)+":"+sg(Math.abs(s%60),2,l);case o0.Extended:return 0===i?"Z":(s>=0?"+":"")+sg(h,2,l)+":"+sg(Math.abs(s%60),2,l);default:throw new Error(`Unknown zone width "${t}"`)}}}const k$=0,MD=4;function _4(t){return ID(t.getFullYear(),t.getMonth(),t.getDate()+(MD-t.getDay()))}function RR(t,n=!1){return function(e,i){let s;if(n){const l=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,h=e.getDate();s=1+Math.floor((h+l)/7)}else{const l=_4(e),h=function P$(t){const n=ID(t,k$,1).getDay();return ID(t,0,1+(n<=MD?MD:MD+7)-n)}(l.getFullYear()),m=l.getTime()-h.getTime();s=1+Math.round(m/6048e5)}return sg(s,t,ip(i,Ec.MinusSign))}}function FD(t,n=!1){return function(e,i){return sg(_4(e).getFullYear(),t,ip(i,Ec.MinusSign),n)}}const OR={};function y4(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function v4(t){return t instanceof Date&&!isNaN(t.valueOf())}const H$=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function LR(t){const n=parseInt(t);if(isNaN(n))throw new Error("Invalid integer literal when parsing "+t);return n}function C4(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[s,l]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(s.trim()===n)return decodeURIComponent(l)}return null}const zR=/\s+/,E4=[];let VR=(()=>{class t{constructor(e,i,s,l){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=s,this._renderer=l,this.initialClasses=E4,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(zR):E4}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(zR):e}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const i of e)this._updateState(i,!0);else if(null!=e)for(const i of Object.keys(e))this._updateState(i,!!e[i]);this._applyStateDiff()}_updateState(e,i){const s=this.stateMap.get(e);void 0!==s?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const i=e[0],s=e[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(e,i){(e=e.trim()).length>0&&e.split(zR).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(bD),Ve(iE),Ve(ao),Ve(Wh))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return t})();class eq{constructor(n,e,i,s){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Pl=(()=>{class t{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,s){this._viewContainer=e,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((s,l,h)=>{if(null==s.previousIndex)i.createEmbeddedView(this._template,new eq(s.item,this._ngForOf,-1,-1),null===h?void 0:h);else if(null==h)i.remove(null===l?void 0:l);else if(null!==l){const m=i.get(l);i.move(m,h),T4(m,s)}});for(let s=0,l=i.length;s<l;s++){const m=i.get(s).context;m.index=s,m.count=l,m.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{T4(i.get(s.currentIndex),s)})}static ngTemplateContextGuard(e,i){return!0}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(cA),Ve(bl),Ve(bD))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return t})();function T4(t,n){t.context.$implicit=n.item}let Xh=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new tq,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){I4("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){I4("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(cA),Ve(bl))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return t})();class tq{constructor(){this.$implicit=null,this.ngIf=null}}function I4(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Un(n)}'.`)}let Jw=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:s,ngTemplateOutletContext:l,ngTemplateOutletInjector:h}=this;this._viewRef=i.createEmbeddedView(s,l,h?{injector:h}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(cA))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Zo]})}return t})();let ex=(()=>{class t{constructor(e){this._locale=e}transform(e,i,s){if(!function jR(t){return!(null==t||""===t||t!=t)}(e))return null;s=s||this._locale;try{return function K$(t,n,e){return function PR(t,n,e,i,s,l,h=!1){let m="",b=!1;if(isFinite(t)){let E=function Z$(t){let i,s,l,h,m,n=Math.abs(t)+"",e=0;for((s=n.indexOf("."))>-1&&(n=n.replace(".","")),(l=n.search(/e/i))>0?(s<0&&(s=l),s+=+n.slice(l+1),n=n.substring(0,l)):s<0&&(s=n.length),l=0;"0"===n.charAt(l);l++);if(l===(m=n.length))i=[0],s=1;else{for(m--;"0"===n.charAt(m);)m--;for(s-=l,i=[],h=0;l<=m;l++,h++)i[h]=Number(n.charAt(l))}return s>22&&(i=i.splice(0,21),e=s-1,s=1),{digits:i,exponent:e,integerLen:s}}(t);h&&(E=function W$(t){if(0===t.digits[0])return t;const n=t.digits.length-t.integerLen;return t.exponent?t.exponent+=2:(0===n?t.digits.push(0,0):1===n&&t.digits.push(0),t.integerLen+=2),t}(E));let M=n.minInt,L=n.minFrac,G=n.maxFrac;if(l){const he=l.match(H$);if(null===he)throw new Error(`${l} is not a valid digit info`);const Ne=he[1],We=he[3],pt=he[5];null!=Ne&&(M=LR(Ne)),null!=We&&(L=LR(We)),null!=pt?G=LR(pt):null!=We&&L>G&&(G=L)}!function X$(t,n,e){if(n>e)throw new Error(`The minimum number of digits after fraction (${n}) is higher than the maximum (${e}).`);let i=t.digits,s=i.length-t.integerLen;const l=Math.min(Math.max(n,s),e);let h=l+t.integerLen,m=i[h];if(h>0){i.splice(Math.max(t.integerLen,h));for(let L=h;L<i.length;L++)i[L]=0}else{s=Math.max(0,s),t.integerLen=1,i.length=Math.max(1,h=l+1),i[0]=0;for(let L=1;L<h;L++)i[L]=0}if(m>=5)if(h-1<0){for(let L=0;L>h;L--)i.unshift(0),t.integerLen++;i.unshift(1),t.integerLen++}else i[h-1]++;for(;s<Math.max(0,l);s++)i.push(0);let b=0!==l;const E=n+t.integerLen,M=i.reduceRight(function(L,G,V,ne){return ne[V]=(G+=L)<10?G:G-10,b&&(0===ne[V]&&V>=E?ne.pop():b=!1),G>=10?1:0},0);M&&(i.unshift(M),t.integerLen++)}(E,L,G);let V=E.digits,ne=E.integerLen;const re=E.exponent;let de=[];for(b=V.every(he=>!he);ne<M;ne++)V.unshift(0);for(;ne<0;ne++)V.unshift(0);ne>0?de=V.splice(ne,V.length):(de=V,V=[0]);const fe=[];for(V.length>=n.lgSize&&fe.unshift(V.splice(-n.lgSize,V.length).join(""));V.length>n.gSize;)fe.unshift(V.splice(-n.gSize,V.length).join(""));V.length&&fe.unshift(V.join("")),m=fe.join(ip(e,i)),de.length&&(m+=ip(e,s)+de.join("")),re&&(m+=ip(e,Ec.Exponential)+"+"+re)}else m=ip(e,Ec.Infinity);return m=t<0&&!b?n.negPre+m+n.negSuf:n.posPre+m+n.posSuf,m}(t,function NR(t,n="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=t.split(";"),s=i[0],l=i[1],h=-1!==s.indexOf(".")?s.split("."):[s.substring(0,s.lastIndexOf("0")+1),s.substring(s.lastIndexOf("0")+1)],m=h[0],b=h[1]||"";e.posPre=m.substring(0,m.indexOf("#"));for(let M=0;M<b.length;M++){const L=b.charAt(M);"0"===L?e.minFrac=e.maxFrac=M+1:"#"===L?e.maxFrac=M+1:e.posSuf+=L}const E=m.split(",");if(e.gSize=E[1]?E[1].length:0,e.lgSize=E[2]||E[1]?(E[2]||E[1]).length:0,l){const M=s.length-e.posPre.length-e.posSuf.length,L=l.indexOf("#");e.negPre=l.substring(0,L).replace(/'/g,""),e.negSuf=l.slice(L+M).replace(/'/g,"")}else e.negPre=n+e.posPre,e.negSuf=e.posSuf;return e}(function MR(t,n){return Td(t)[rl.NumberFormats][n]}(n,xD.Decimal),ip(n,Ec.MinusSign)),n,Ec.Group,Ec.Decimal,e)}(function GR(t){if("string"==typeof t&&!isNaN(Number(t)-parseFloat(t)))return Number(t);if("number"!=typeof t)throw new Error(`${t} is not a number`);return t}(e),s,i)}catch(l){throw function og(t,n){return new ln(2100,!1)}()}}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(uA,16))};static#t=this.\u0275pipe=hl({name:"number",type:t,pure:!0,standalone:!0})}return t})();let $R=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})();const M4="browser";function OD(t){return t===M4}function F4(t){return"server"===t}let Bq=(()=>{class t{static#e=this.\u0275prov=Pn({token:t,providedIn:"root",factory:()=>new Mq(Xt(wa),window)})}return t})();class Mq{constructor(n,e){this.document=n,this.window=e,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const e=function Fq(t,n){const e=t.getElementById(n)||t.getElementsByName(n)[0];if(e)return e;if("function"==typeof t.createTreeWalker&&t.body&&"function"==typeof t.body.attachShadow){const i=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let s=i.currentNode;for(;s;){const l=s.shadowRoot;if(l){const h=l.getElementById(n)||l.querySelector(`[name="${n}"]`);if(h)return h}s=i.nextNode()}}return null}(this.document,n);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(n){this.supportsScrolling()&&(this.window.history.scrollRestoration=n)}scrollToElement(n){const e=n.getBoundingClientRect(),i=e.left+this.window.pageXOffset,s=e.top+this.window.pageYOffset,l=this.offset();this.window.scrollTo(i-l[0],s-l[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class R4{}class tK extends f${constructor(){super(...arguments),this.supportsDOMEvents=!0}}class WR extends tK{static makeCurrent(){!function d$(t){SR||(SR=t)}(new WR)}onAndCancel(n,e,i){return n.addEventListener(e,i),()=>{n.removeEventListener(e,i)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function nK(){return aE=aE||document.querySelector("base"),aE?aE.getAttribute("href"):null}();return null==e?null:function iK(t){ND=ND||document.createElement("a"),ND.setAttribute("href",t);const n=ND.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){aE=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return C4(document.cookie,n)}}let ND,aE=null,sK=(()=>{class t{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();const ZR=new pi("EventManagerPlugins");let L4=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(s=>{s.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,s){return this._findPluginFor(i).addEventListener(e,i,s)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(l=>l.supports(e)),!i)throw new ln(5101,!1);return this._eventNameToPlugin.set(e,i),i}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(ZR),Xt(Wi))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();class U4{constructor(n){this._doc=n}}const XR="ng-app-id";let z4=(()=>{class t{constructor(e,i,s,l={}){this.doc=e,this.appId=i,this.nonce=s,this.platformId=l,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=F4(l),this.resetHostNodes()}addStyles(e){for(const i of e)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const e=this.styleNodesInDOM;e&&(e.forEach(i=>i.remove()),e.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.elements?.forEach(s=>s.remove()),i.delete(e)}collectServerRenderedStyles(){const e=this.doc.head?.querySelectorAll(`style[${XR}="${this.appId}"]`);if(e?.length){const i=new Map;return e.forEach(s=>{null!=s.textContent&&i.set(s.textContent,s)}),i}return null}changeUsageCount(e,i){const s=this.styleRef;if(s.has(e)){const l=s.get(e);return l.usage+=i,l.usage}return s.set(e,{usage:i,elements:[]}),i}getStyleElement(e,i){const s=this.styleNodesInDOM,l=s?.get(i);if(l?.parentNode===e)return s.delete(i),l.removeAttribute(XR),l;{const h=this.doc.createElement("style");return this.nonce&&h.setAttribute("nonce",this.nonce),h.textContent=i,this.platformIsServer&&h.setAttribute(XR,this.appId),h}}addStyleToHost(e,i){const s=this.getStyleElement(e,i);e.appendChild(s);const l=this.styleRef,h=l.get(i)?.elements;h?h.push(s):l.set(i,{elements:[s],usage:1})}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wa),Xt(Jb),Xt(RT,8),Xt(Uu))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();const YR={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},JR=/%COMP%/g,cK=new pi("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function H4(t,n){return n.map(e=>e.replace(JR,t))}let eO=(()=>{class t{constructor(e,i,s,l,h,m,b,E=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=l,this.doc=h,this.platformId=m,this.ngZone=b,this.nonce=E,this.rendererByCompId=new Map,this.platformIsServer=F4(m),this.defaultRenderer=new tO(e,h,b,this.platformIsServer)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Ac.ShadowDom&&(i={...i,encapsulation:Ac.Emulated});const s=this.getOrCreateRenderer(e,i);return s instanceof j4?s.applyToHost(e):s instanceof nO&&s.applyStyles(),s}getOrCreateRenderer(e,i){const s=this.rendererByCompId;let l=s.get(i.id);if(!l){const h=this.doc,m=this.ngZone,b=this.eventManager,E=this.sharedStylesHost,M=this.removeStylesOnCompDestroy,L=this.platformIsServer;switch(i.encapsulation){case Ac.Emulated:l=new j4(b,E,i,this.appId,M,h,m,L);break;case Ac.ShadowDom:return new fK(b,E,e,i,h,m,this.nonce,L);default:l=new nO(b,E,i,M,h,m,L)}s.set(i.id,l)}return l}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(L4),Xt(z4),Xt(Jb),Xt(cK),Xt(wa),Xt(Uu),Xt(Wi),Xt(RT))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();class tO{constructor(n,e,i,s){this.eventManager=n,this.doc=e,this.ngZone=i,this.platformIsServer=s,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?this.doc.createElementNS(YR[e]||e,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,e){(Q4(n)?n.content:n).appendChild(e)}insertBefore(n,e,i){n&&(Q4(n)?n.content:n).insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?this.doc.querySelector(n):n;if(!i)throw new ln(-5104,!1);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,s){if(s){e=s+":"+e;const l=YR[s];l?n.setAttributeNS(l,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const s=YR[i];s?n.removeAttributeNS(s,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,s){s&(gu.DashCase|gu.Important)?n.style.setProperty(e,i,s&gu.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&gu.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){n[e]=i}setValue(n,e){n.nodeValue=e}listen(n,e,i){if("string"==typeof n&&!(n=By().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${e}`);return this.eventManager.addEventListener(n,e,this.decoratePreventDefault(i))}decoratePreventDefault(n){return e=>{if("__ngUnwrap__"===e)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(e)):n(e))&&e.preventDefault()}}}function Q4(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class fK extends tO{constructor(n,e,i,s,l,h,m,b){super(n,l,h,b),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const E=H4(s.id,s.styles);for(const M of E){const L=document.createElement("style");m&&L.setAttribute("nonce",m),L.textContent=M,this.shadowRoot.appendChild(L)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class nO extends tO{constructor(n,e,i,s,l,h,m,b){super(n,l,h,m),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=s,this.styles=b?H4(b,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class j4 extends nO{constructor(n,e,i,s,l,h,m,b){const E=s+"-"+i.id;super(n,e,i,l,h,m,b,E),this.contentAttr=function uK(t){return"_ngcontent-%COMP%".replace(JR,t)}(E),this.hostAttr=function hK(t){return"_nghost-%COMP%".replace(JR,t)}(E)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}let AK=(()=>{class t extends U4{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,s){return e.addEventListener(i,s,!1),()=>this.removeEventListener(e,i,s)}removeEventListener(e,i,s){return e.removeEventListener(i,s)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wa))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();const G4=["alt","control","meta","shift"],pK={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},gK={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let mK=(()=>{class t extends U4{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,s){const l=t.parseEventName(i),h=t.eventCallback(l.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>By().onAndCancel(e,l.domEventName,h))}static parseEventName(e){const i=e.toLowerCase().split("."),s=i.shift();if(0===i.length||"keydown"!==s&&"keyup"!==s)return null;const l=t._normalizeKey(i.pop());let h="",m=i.indexOf("code");if(m>-1&&(i.splice(m,1),h="code."),G4.forEach(E=>{const M=i.indexOf(E);M>-1&&(i.splice(M,1),h+=E+".")}),h+=l,0!=i.length||0===l.length)return null;const b={};return b.domEventName=s,b.fullKey=h,b}static matchEventFullKeyCode(e,i){let s=pK[e.key]||e.key,l="";return i.indexOf("code.")>-1&&(s=e.code,l="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),G4.forEach(h=>{h!==s&&(0,gK[h])(e)&&(l+=h+".")}),l+=s,l===i)}static eventCallback(e,i,s){return l=>{t.matchEventFullKeyCode(l,e)&&s.runGuarded(()=>i(l))}}static _normalizeKey(e){return"esc"===e?"escape":e}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wa))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();const q4=[{provide:Uu,useValue:M4},{provide:$v,useValue:function _K(){WR.makeCurrent()},multi:!0},{provide:wa,useFactory:function vK(){return function MF(t){Pb=t}(document),document},deps:[]}],bK=L3(Y9,"browser",q4),wK=new pi(""),K4=[{provide:mD,useClass:class rK{addToWindow(n){Uo.getAngularTestability=(i,s=!0)=>{const l=n.findTestabilityInTree(i,s);if(null==l)throw new ln(5103,!1);return l},Uo.getAllAngularTestabilities=()=>n.getAllTestabilities(),Uo.getAllAngularRootElements=()=>n.getAllRootElements(),Uo.frameworkStabilizers||(Uo.frameworkStabilizers=[]),Uo.frameworkStabilizers.push(i=>{const s=Uo.getAllAngularTestabilities();let l=s.length,h=!1;const m=function(b){h=h||b,l--,0==l&&i(h)};s.forEach(b=>{b.whenStable(m)})})}findTestabilityInTree(n,e,i){return null==e?null:n.getTestability(e)??(i?By().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:R3,useClass:AR,deps:[Wi,pR,mD]},{provide:AR,useClass:AR,deps:[Wi,pR,mD]}],W4=[{provide:ry,useValue:"root"},{provide:no,useFactory:function yK(){return new no},deps:[]},{provide:ZR,useClass:AK,multi:!0,deps:[wa,Wi,Uu]},{provide:ZR,useClass:mK,multi:!0,deps:[wa]},eO,z4,L4,{provide:z_,useExisting:eO},{provide:R4,useClass:sK,deps:[]},[]];let Z4=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:Jb,useValue:e.appId}]}}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wK,12))};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({providers:[...W4,...K4],imports:[$R,J9]})}return t})(),X4=(()=>{class t{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wa))};static#t=this.\u0275prov=Pn({token:t,factory:function(i){let s=null;return s=i?new i:function CK(){return new X4(Xt(wa))}(),s},providedIn:"root"})}return t})();typeof window<"u"&&window;const{isArray:BK}=Array,{getPrototypeOf:MK,prototype:FK,keys:RK}=Object;function tU(t){if(1===t.length){const n=t[0];if(BK(n))return{args:n,keys:null};if(function OK(t){return t&&"object"==typeof t&&MK(t)===FK}(n)){const e=RK(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}const{isArray:kK}=Array;function rO(t){return Ht(n=>function PK(t,n){return kK(n)?t(...n):t(n)}(t,n))}function nU(t,n){return t.reduce((e,i,s)=>(e[i]=n[s],e),{})}function Rm(...t){const n=fc(t),e=ad(t),{args:i,keys:s}=tU(t);if(0===i.length)return Gs([],n);const l=new Hr(function NK(t,n,e=ir){return i=>{iU(n,()=>{const{length:s}=t,l=new Array(s);let h=s,m=s;for(let b=0;b<s;b++)iU(n,()=>{const E=Gs(t[b],n);let M=!1;E.subscribe(Kr(i,L=>{l[b]=L,M||(M=!0,m--),m||i.next(e(l.slice()))},()=>{--h||i.complete()}))},i)},i)}}(i,n,s?h=>nU(s,h):ir));return e?l.pipe(rO(e)):l}function iU(t,n,e){t?Jr(e,t,n):n()}const LD=Mo(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function tx(...t){return function LK(){return qo(1)}()(Gs(t,fc(t)))}function UD(t){return new Hr(n=>{gn(t()).subscribe(n)})}function l0(t,n){const e=qr(t)?t:()=>t,i=s=>s.error(e());return new Hr(n?s=>n.schedule(i,0,s):i)}function sO(){return Xs((t,n)=>{let e=null;t._refCount++;const i=Kr(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const s=t._connection,l=e;e=null,s&&(!l||s===l)&&s.unsubscribe(),n.unsubscribe()});t.subscribe(i),i.closed||(e=t.connect())})}class oO extends Hr{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,ru(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new Ai;const e=this.getSubject();n.add(this.source.subscribe(Kr(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=Ai.EMPTY)}return n}refCount(){return sO()(this)}}function Xo(t){return t<=0?()=>Fo:Xs((n,e)=>{let i=0;n.subscribe(Kr(e,s=>{++i<=t&&(e.next(s),t<=i&&e.complete())}))})}function T1(...t){const n=fc(t);return Xs((e,i)=>{(n?tx(t,e,n):tx(t,e)).subscribe(i)})}function Io(t,n){return Xs((e,i)=>{let s=0;e.subscribe(Kr(i,l=>t.call(n,l,s++)&&i.next(l)))})}function zD(t){return Xs((n,e)=>{let i=!1;n.subscribe(Kr(e,s=>{i=!0,e.next(s)},()=>{i||e.next(t),e.complete()}))})}function rU(t=UK){return Xs((n,e)=>{let i=!1;n.subscribe(Kr(e,s=>{i=!0,e.next(s)},()=>i?e.complete():e.error(t())))})}function UK(){return new LD}function Om(t,n){const e=arguments.length>=2;return i=>i.pipe(t?Io((s,l)=>t(s,l,i)):ir,Xo(1),e?zD(n):rU(()=>new LD))}function nx(t,n){return qr(n)?es(t,n,1):es(t,1)}function sc(t,n,e){const i=qr(t)||n||e?{next:t,error:n,complete:e}:t;return i?Xs((s,l)=>{var h;null===(h=i.subscribe)||void 0===h||h.call(i);let m=!0;s.subscribe(Kr(l,b=>{var E;null===(E=i.next)||void 0===E||E.call(i,b),l.next(b)},()=>{var b;m=!1,null===(b=i.complete)||void 0===b||b.call(i),l.complete()},b=>{var E;m=!1,null===(E=i.error)||void 0===E||E.call(i,b),l.error(b)},()=>{var b,E;m&&(null===(b=i.unsubscribe)||void 0===b||b.call(i)),null===(E=i.finalize)||void 0===E||E.call(i)}))}):ir}function sp(t){return Xs((n,e)=>{let l,i=null,s=!1;i=n.subscribe(Kr(e,void 0,void 0,h=>{l=gn(t(h,sp(t)(n))),i?(i.unsubscribe(),i=null,l.subscribe(e)):s=!0})),s&&(i.unsubscribe(),i=null,l.subscribe(e))})}function aO(t){return t<=0?()=>Fo:Xs((n,e)=>{let i=[];n.subscribe(Kr(e,s=>{i.push(s),t<i.length&&i.shift()},()=>{for(const s of i)e.next(s);e.complete()},void 0,()=>{i=null}))})}function sU(t){return Ht(()=>t)}function lE(t){return Xs((n,e)=>{try{n.subscribe(e)}finally{e.add(t)}})}function Ps(t){return Xs((n,e)=>{gn(t).subscribe(Kr(e,()=>e.complete(),Sa)),!e.closed&&n.subscribe(e)})}const Ks="primary",cE=Symbol("RouteTitle");class QK{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e[0]:e}return null}getAll(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function ix(t){return new QK(t)}function jK(t,n,e){const i=e.path.split("/");if(i.length>t.length||"full"===e.pathMatch&&(n.hasChildren()||i.length<t.length))return null;const s={};for(let l=0;l<i.length;l++){const h=i[l],m=t[l];if(h.startsWith(":"))s[h.substring(1)]=m;else if(h!==m.path)return null}return{consumed:t.slice(0,i.length),posParams:s}}function km(t,n){const e=t?Object.keys(t):void 0,i=n?Object.keys(n):void 0;if(!e||!i||e.length!=i.length)return!1;let s;for(let l=0;l<e.length;l++)if(s=e[l],!oU(t[s],n[s]))return!1;return!0}function oU(t,n){if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;const e=[...t].sort(),i=[...n].sort();return e.every((s,l)=>i[l]===s)}return t===n}function aU(t){return t.length>0?t[t.length-1]:null}function Fy(t){return function DK(t){return!!t&&(t instanceof Hr||qr(t.lift)&&qr(t.subscribe))}(t)?t:v1(t)?Gs(Promise.resolve(t)):Bi(t)}const $K={exact:function uU(t,n,e){if(!I1(t.segments,n.segments)||!VD(t.segments,n.segments,e)||t.numberOfChildren!==n.numberOfChildren)return!1;for(const i in n.children)if(!t.children[i]||!uU(t.children[i],n.children[i],e))return!1;return!0},subset:hU},lU={exact:function qK(t,n){return km(t,n)},subset:function KK(t,n){return Object.keys(n).length<=Object.keys(t).length&&Object.keys(n).every(e=>oU(t[e],n[e]))},ignored:()=>!0};function cU(t,n,e){return $K[e.paths](t.root,n.root,e.matrixParams)&&lU[e.queryParams](t.queryParams,n.queryParams)&&!("exact"===e.fragment&&t.fragment!==n.fragment)}function hU(t,n,e){return dU(t,n,n.segments,e)}function dU(t,n,e,i){if(t.segments.length>e.length){const s=t.segments.slice(0,e.length);return!(!I1(s,e)||n.hasChildren()||!VD(s,e,i))}if(t.segments.length===e.length){if(!I1(t.segments,e)||!VD(t.segments,e,i))return!1;for(const s in n.children)if(!t.children[s]||!hU(t.children[s],n.children[s],i))return!1;return!0}{const s=e.slice(0,t.segments.length),l=e.slice(t.segments.length);return!!(I1(t.segments,s)&&VD(t.segments,s,i)&&t.children[Ks])&&dU(t.children[Ks],n,l,i)}}function VD(t,n,e){return n.every((i,s)=>lU[e](t[s].parameters,i.parameters))}class rx{constructor(n=new xa([],{}),e={},i=null){this.root=n,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ix(this.queryParams)),this._queryParamMap}toString(){return XK.serialize(this)}}class xa{constructor(n,e){this.segments=n,this.children=e,this.parent=null,Object.values(e).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return HD(this)}}class uE{constructor(n,e){this.path=n,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=ix(this.parameters)),this._parameterMap}toString(){return pU(this)}}function I1(t,n){return t.length===n.length&&t.every((e,i)=>e.path===n[i].path)}let hE=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(){return new lO},providedIn:"root"})}return t})();class lO{parse(n){const e=new lW(n);return new rx(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(n){const e=`/${dE(n.root,!0)}`,i=function eW(t){const n=Object.keys(t).map(e=>{const i=t[e];return Array.isArray(i)?i.map(s=>`${QD(e)}=${QD(s)}`).join("&"):`${QD(e)}=${QD(i)}`}).filter(e=>!!e);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${e}${i}${"string"==typeof n.fragment?`#${function YK(t){return encodeURI(t)}(n.fragment)}`:""}`}}const XK=new lO;function HD(t){return t.segments.map(n=>pU(n)).join("/")}function dE(t,n){if(!t.hasChildren())return HD(t);if(n){const e=t.children[Ks]?dE(t.children[Ks],!1):"",i=[];return Object.entries(t.children).forEach(([s,l])=>{s!==Ks&&i.push(`${s}:${dE(l,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}{const e=function ZK(t,n){let e=[];return Object.entries(t.children).forEach(([i,s])=>{i===Ks&&(e=e.concat(n(s,i)))}),Object.entries(t.children).forEach(([i,s])=>{i!==Ks&&(e=e.concat(n(s,i)))}),e}(t,(i,s)=>s===Ks?[dE(t.children[Ks],!1)]:[`${s}:${dE(i,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[Ks]?`${HD(t)}/${e[0]}`:`${HD(t)}/(${e.join("//")})`}}function fU(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function QD(t){return fU(t).replace(/%3B/gi,";")}function cO(t){return fU(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function jD(t){return decodeURIComponent(t)}function AU(t){return jD(t.replace(/\+/g,"%20"))}function pU(t){return`${cO(t.path)}${function JK(t){return Object.keys(t).map(n=>`;${cO(n)}=${cO(t[n])}`).join("")}(t.parameters)}`}const tW=/^[^\/()?;#]+/;function uO(t){const n=t.match(tW);return n?n[0]:""}const nW=/^[^\/()?;=#]+/,rW=/^[^=?&#]+/,oW=/^[^&#]+/;class lW{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new xa([],{}):new xa([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(n.length>0||Object.keys(e).length>0)&&(i[Ks]=new xa(n,e)),i}parseSegment(){const n=uO(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new ln(4009,!1);return this.capture(n),new uE(jD(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const e=function iW(t){const n=t.match(nW);return n?n[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const s=uO(this.remaining);s&&(i=s,this.capture(i))}n[jD(e)]=jD(i)}parseQueryParam(n){const e=function sW(t){const n=t.match(rW);return n?n[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const h=function aW(t){const n=t.match(oW);return n?n[0]:""}(this.remaining);h&&(i=h,this.capture(i))}const s=AU(e),l=AU(i);if(n.hasOwnProperty(s)){let h=n[s];Array.isArray(h)||(h=[h],n[s]=h),h.push(l)}else n[s]=l}parseParens(n){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=uO(this.remaining),s=this.remaining[i.length];if("/"!==s&&")"!==s&&";"!==s)throw new ln(4010,!1);let l;i.indexOf(":")>-1?(l=i.slice(0,i.indexOf(":")),this.capture(l),this.capture(":")):n&&(l=Ks);const h=this.parseChildren();e[l]=1===Object.keys(h).length?h[Ks]:new xa([],h),this.consumeOptional("//")}return e}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new ln(4011,!1)}}function gU(t){return t.segments.length>0?new xa([],{[Ks]:t}):t}function mU(t){const n={};for(const i of Object.keys(t.children)){const l=mU(t.children[i]);if(i===Ks&&0===l.segments.length&&l.hasChildren())for(const[h,m]of Object.entries(l.children))n[h]=m;else(l.segments.length>0||l.hasChildren())&&(n[i]=l)}return function cW(t){if(1===t.numberOfChildren&&t.children[Ks]){const n=t.children[Ks];return new xa(t.segments.concat(n.segments),n.children)}return t}(new xa(t.segments,n))}function D1(t){return t instanceof rx}function _U(t){let n;const s=gU(function e(l){const h={};for(const b of l.children){const E=e(b);h[b.outlet]=E}const m=new xa(l.url,h);return l===t&&(n=m),m}(t.root));return n??s}function yU(t,n,e,i){let s=t;for(;s.parent;)s=s.parent;if(0===n.length)return hO(s,s,s,e,i);const l=function hW(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new bU(!0,0,t);let n=0,e=!1;const i=t.reduce((s,l,h)=>{if("object"==typeof l&&null!=l){if(l.outlets){const m={};return Object.entries(l.outlets).forEach(([b,E])=>{m[b]="string"==typeof E?E.split("/"):E}),[...s,{outlets:m}]}if(l.segmentPath)return[...s,l.segmentPath]}return"string"!=typeof l?[...s,l]:0===h?(l.split("/").forEach((m,b)=>{0==b&&"."===m||(0==b&&""===m?e=!0:".."===m?n++:""!=m&&s.push(m))}),s):[...s,l]},[]);return new bU(e,n,i)}(n);if(l.toRoot())return hO(s,s,new xa([],{}),e,i);const h=function dW(t,n,e){if(t.isAbsolute)return new $D(n,!0,0);if(!e)return new $D(n,!1,NaN);if(null===e.parent)return new $D(e,!0,0);const i=GD(t.commands[0])?0:1;return function fW(t,n,e){let i=t,s=n,l=e;for(;l>s;){if(l-=s,i=i.parent,!i)throw new ln(4005,!1);s=i.segments.length}return new $D(i,!1,s-l)}(e,e.segments.length-1+i,t.numberOfDoubleDots)}(l,s,t),m=h.processChildren?AE(h.segmentGroup,h.index,l.commands):wU(h.segmentGroup,h.index,l.commands);return hO(s,h.segmentGroup,m,e,i)}function GD(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function fE(t){return"object"==typeof t&&null!=t&&t.outlets}function hO(t,n,e,i,s){let h,l={};i&&Object.entries(i).forEach(([b,E])=>{l[b]=Array.isArray(E)?E.map(M=>`${M}`):`${E}`}),h=t===n?e:vU(t,n,e);const m=gU(mU(h));return new rx(m,l,s)}function vU(t,n,e){const i={};return Object.entries(t.children).forEach(([s,l])=>{i[s]=l===n?e:vU(l,n,e)}),new xa(t.segments,i)}class bU{constructor(n,e,i){if(this.isAbsolute=n,this.numberOfDoubleDots=e,this.commands=i,n&&i.length>0&&GD(i[0]))throw new ln(4003,!1);const s=i.find(fE);if(s&&s!==aU(i))throw new ln(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class $D{constructor(n,e,i){this.segmentGroup=n,this.processChildren=e,this.index=i}}function wU(t,n,e){if(t||(t=new xa([],{})),0===t.segments.length&&t.hasChildren())return AE(t,n,e);const i=function pW(t,n,e){let i=0,s=n;const l={match:!1,pathIndex:0,commandIndex:0};for(;s<t.segments.length;){if(i>=e.length)return l;const h=t.segments[s],m=e[i];if(fE(m))break;const b=`${m}`,E=i<e.length-1?e[i+1]:null;if(s>0&&void 0===b)break;if(b&&E&&"object"==typeof E&&void 0===E.outlets){if(!CU(b,E,h))return l;i+=2}else{if(!CU(b,{},h))return l;i++}s++}return{match:!0,pathIndex:s,commandIndex:i}}(t,n,e),s=e.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){const l=new xa(t.segments.slice(0,i.pathIndex),{});return l.children[Ks]=new xa(t.segments.slice(i.pathIndex),t.children),AE(l,0,s)}return i.match&&0===s.length?new xa(t.segments,{}):i.match&&!t.hasChildren()?dO(t,n,e):i.match?AE(t,0,s):dO(t,n,e)}function AE(t,n,e){if(0===e.length)return new xa(t.segments,{});{const i=function AW(t){return fE(t[0])?t[0].outlets:{[Ks]:t}}(e),s={};if(Object.keys(i).some(l=>l!==Ks)&&t.children[Ks]&&1===t.numberOfChildren&&0===t.children[Ks].segments.length){const l=AE(t.children[Ks],n,e);return new xa(t.segments,l.children)}return Object.entries(i).forEach(([l,h])=>{"string"==typeof h&&(h=[h]),null!==h&&(s[l]=wU(t.children[l],n,h))}),Object.entries(t.children).forEach(([l,h])=>{void 0===i[l]&&(s[l]=h)}),new xa(t.segments,s)}}function dO(t,n,e){const i=t.segments.slice(0,n);let s=0;for(;s<e.length;){const l=e[s];if(fE(l)){const b=gW(l.outlets);return new xa(i,b)}if(0===s&&GD(e[0])){i.push(new uE(t.segments[n].path,xU(e[0]))),s++;continue}const h=fE(l)?l.outlets[Ks]:`${l}`,m=s<e.length-1?e[s+1]:null;h&&m&&GD(m)?(i.push(new uE(h,xU(m))),s+=2):(i.push(new uE(h,{})),s++)}return new xa(i,{})}function gW(t){const n={};return Object.entries(t).forEach(([e,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(n[e]=dO(new xa([],{}),0,i))}),n}function xU(t){const n={};return Object.entries(t).forEach(([e,i])=>n[e]=`${i}`),n}function CU(t,n,e){return t==e.path&&km(n,e.parameters)}const pE="imperative";class Pm{constructor(n,e){this.id=n,this.url=e}}class qD extends Pm{constructor(n,e,i="imperative",s=null){super(n,e),this.type=0,this.navigationTrigger=i,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ry extends Pm{constructor(n,e,i){super(n,e),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class gE extends Pm{constructor(n,e,i,s){super(n,e),this.reason=i,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class sx extends Pm{constructor(n,e,i,s){super(n,e),this.reason=i,this.code=s,this.type=16}}class KD extends Pm{constructor(n,e,i,s){super(n,e),this.error=i,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class EU extends Pm{constructor(n,e,i,s){super(n,e),this.urlAfterRedirects=i,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class mW extends Pm{constructor(n,e,i,s){super(n,e),this.urlAfterRedirects=i,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _W extends Pm{constructor(n,e,i,s,l){super(n,e),this.urlAfterRedirects=i,this.state=s,this.shouldActivate=l,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class yW extends Pm{constructor(n,e,i,s){super(n,e),this.urlAfterRedirects=i,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class vW extends Pm{constructor(n,e,i,s){super(n,e),this.urlAfterRedirects=i,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class bW{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class wW{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class xW{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class CW{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class EW{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class SW{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class SU{constructor(n,e,i){this.routerEvent=n,this.position=e,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class fO{}class AO{constructor(n){this.url=n}}class TW{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new mE,this.attachRef=null}}let mE=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(e,i){const s=this.getOrCreateContext(e);s.outlet=i,this.contexts.set(e,s)}onChildOutletDestroyed(e){const i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new TW,this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class TU{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const e=this.pathFromRoot(n);return e.length>1?e[e.length-2]:null}children(n){const e=pO(n,this._root);return e?e.children.map(i=>i.value):[]}firstChild(n){const e=pO(n,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(n){const e=gO(n,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==n)}pathFromRoot(n){return gO(n,this._root).map(e=>e.value)}}function pO(t,n){if(t===n.value)return n;for(const e of n.children){const i=pO(t,e);if(i)return i}return null}function gO(t,n){if(t===n.value)return[n];for(const e of n.children){const i=gO(t,e);if(i.length)return i.unshift(n),i}return[]}class c0{constructor(n,e){this.value=n,this.children=e}toString(){return`TreeNode(${this.value})`}}function ox(t){const n={};return t&&t.children.forEach(e=>n[e.value.outlet]=e),n}class IU extends TU{constructor(n,e){super(n),this.snapshot=e,mO(this,n)}toString(){return this.snapshot.toString()}}function DU(t,n){const e=function IW(t,n){const h=new WD([],{},{},"",{},Ks,n,null,{});return new MU("",new c0(h,[]))}(0,n),i=new Fi([new uE("",{})]),s=new Fi({}),l=new Fi({}),h=new Fi({}),m=new Fi(""),b=new ax(i,s,h,m,l,Ks,n,e.root);return b.snapshot=e.root,new IU(new c0(b,[]),e)}class ax{constructor(n,e,i,s,l,h,m,b){this.urlSubject=n,this.paramsSubject=e,this.queryParamsSubject=i,this.fragmentSubject=s,this.dataSubject=l,this.outlet=h,this.component=m,this._futureSnapshot=b,this.title=this.dataSubject?.pipe(Ht(E=>E[cE]))??Bi(void 0),this.url=n,this.params=e,this.queryParams=i,this.fragment=s,this.data=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ht(n=>ix(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ht(n=>ix(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function BU(t,n="emptyOnly"){const e=t.pathFromRoot;let i=0;if("always"!==n)for(i=e.length-1;i>=1;){const s=e[i],l=e[i-1];if(s.routeConfig&&""===s.routeConfig.path)i--;else{if(l.component)break;i--}}return function DW(t){return t.reduce((n,e)=>({params:{...n.params,...e.params},data:{...n.data,...e.data},resolve:{...e.data,...n.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(i))}class WD{get title(){return this.data?.[cE]}constructor(n,e,i,s,l,h,m,b,E){this.url=n,this.params=e,this.queryParams=i,this.fragment=s,this.data=l,this.outlet=h,this.component=m,this.routeConfig=b,this._resolve=E}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ix(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ix(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class MU extends TU{constructor(n,e){super(e),this.url=n,mO(this,e)}toString(){return FU(this._root)}}function mO(t,n){n.value._routerState=t,n.children.forEach(e=>mO(t,e))}function FU(t){const n=t.children.length>0?` { ${t.children.map(FU).join(", ")} } `:"";return`${t.value}${n}`}function _O(t){if(t.snapshot){const n=t.snapshot,e=t._futureSnapshot;t.snapshot=e,km(n.queryParams,e.queryParams)||t.queryParamsSubject.next(e.queryParams),n.fragment!==e.fragment&&t.fragmentSubject.next(e.fragment),km(n.params,e.params)||t.paramsSubject.next(e.params),function GK(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!km(t[e],n[e]))return!1;return!0}(n.url,e.url)||t.urlSubject.next(e.url),km(n.data,e.data)||t.dataSubject.next(e.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function yO(t,n){const e=km(t.params,n.params)&&function WK(t,n){return I1(t,n)&&t.every((e,i)=>km(e.parameters,n[i].parameters))}(t.url,n.url);return e&&!(!t.parent!=!n.parent)&&(!t.parent||yO(t.parent,n.parent))}let vO=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ks,this.activateEvents=new vi,this.deactivateEvents=new vi,this.attachEvents=new vi,this.detachEvents=new vi,this.parentContexts=In(mE),this.location=In(cA),this.changeDetector=In(gf),this.environmentInjector=In(Lu),this.inputBinder=In(ZD,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(e){if(e.name){const{firstChange:i,previousValue:s}=e.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ln(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ln(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ln(4012,!1);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new ln(4013,!1);this._activatedRoute=e;const s=this.location,h=e.snapshot.component,m=this.parentContexts.getOrCreateContext(this.name).children,b=new BW(e,m,s.injector);this.activated=s.createComponent(h,{index:s.length,injector:b,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=Xn({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Zo]})}return t})();class BW{constructor(n,e,i){this.route=n,this.childContexts=e,this.parent=i}get(n,e){return n===ax?this.route:n===mE?this.childContexts:this.parent.get(n,e)}}const ZD=new pi("");let RU=(()=>{class t{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){const{activatedRoute:i}=e,s=Rm([i.queryParams,i.params,i.data]).pipe(cl(([l,h,m],b)=>(m={...l,...h,...m},0===b?Bi(m):Promise.resolve(m)))).subscribe(l=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(e);const h=function h$(t){const n=Is(t);if(!n)return null;const e=new vy(n);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}(i.component);if(h)for(const{templateName:m}of h.inputs)e.activatedComponentRef.setInput(m,l[m]);else this.unsubscribeFromRouteData(e)});this.outletDataSubscriptions.set(e,s)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();function _E(t,n,e){if(e&&t.shouldReuseRoute(n.value,e.value.snapshot)){const i=e.value;i._futureSnapshot=n.value;const s=function FW(t,n,e){return n.children.map(i=>{for(const s of e.children)if(t.shouldReuseRoute(i.value,s.value.snapshot))return _E(t,i,s);return _E(t,i)})}(t,n,e);return new c0(i,s)}{if(t.shouldAttach(n.value)){const l=t.retrieve(n.value);if(null!==l){const h=l.route;return h.value._futureSnapshot=n.value,h.children=n.children.map(m=>_E(t,m)),h}}const i=function RW(t){return new ax(new Fi(t.url),new Fi(t.params),new Fi(t.queryParams),new Fi(t.fragment),new Fi(t.data),t.outlet,t.component,t)}(n.value),s=n.children.map(l=>_E(t,l));return new c0(i,s)}}const bO="ngNavigationCancelingError";function OU(t,n){const{redirectTo:e,navigationBehaviorOptions:i}=D1(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,s=kU(!1,0,n);return s.url=e,s.navigationBehaviorOptions=i,s}function kU(t,n,e){const i=new Error("NavigationCancelingError: "+(t||""));return i[bO]=!0,i.cancellationCode=n,e&&(i.url=e),i}function PU(t){return t&&t[bO]}let NU=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=Mr({type:t,selectors:[["ng-component"]],standalone:!0,features:[Af],decls:1,vars:0,template:function(i,s){1&i&&oi(0,"router-outlet")},dependencies:[vO],encapsulation:2})}return t})();function wO(t){const n=t.children&&t.children.map(wO),e=n?{...t,children:n}:{...t};return!e.component&&!e.loadComponent&&(n||e.loadChildren)&&e.outlet&&e.outlet!==Ks&&(e.component=NU),e}function ag(t){return t.outlet||Ks}function yE(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let n=t.parent;n;n=n.parent){const e=n.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class VW{constructor(n,e,i,s,l){this.routeReuseStrategy=n,this.futureState=e,this.currState=i,this.forwardEvent=s,this.inputBindingEnabled=l}activate(n){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,n),_O(this.futureState.root),this.activateChildRoutes(e,i,n)}deactivateChildRoutes(n,e,i){const s=ox(e);n.children.forEach(l=>{const h=l.value.outlet;this.deactivateRoutes(l,s[h],i),delete s[h]}),Object.values(s).forEach(l=>{this.deactivateRouteAndItsChildren(l,i)})}deactivateRoutes(n,e,i){const s=n.value,l=e?e.value:null;if(s===l)if(s.component){const h=i.getContext(s.outlet);h&&this.deactivateChildRoutes(n,e,h.children)}else this.deactivateChildRoutes(n,e,i);else l&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(n,e){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,e):this.deactivateRouteAndOutlet(n,e)}detachAndStoreRouteSubtree(n,e){const i=e.getContext(n.value.outlet),s=i&&n.value.component?i.children:e,l=ox(n);for(const h of Object.keys(l))this.deactivateRouteAndItsChildren(l[h],s);if(i&&i.outlet){const h=i.outlet.detach(),m=i.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:h,route:n,contexts:m})}}deactivateRouteAndOutlet(n,e){const i=e.getContext(n.value.outlet),s=i&&n.value.component?i.children:e,l=ox(n);for(const h of Object.keys(l))this.deactivateRouteAndItsChildren(l[h],s);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(n,e,i){const s=ox(e);n.children.forEach(l=>{this.activateRoutes(l,s[l.value.outlet],i),this.forwardEvent(new SW(l.value.snapshot))}),n.children.length&&this.forwardEvent(new CW(n.value.snapshot))}activateRoutes(n,e,i){const s=n.value,l=e?e.value:null;if(_O(s),s===l)if(s.component){const h=i.getOrCreateContext(s.outlet);this.activateChildRoutes(n,e,h.children)}else this.activateChildRoutes(n,e,i);else if(s.component){const h=i.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const m=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),h.children.onOutletReAttached(m.contexts),h.attachRef=m.componentRef,h.route=m.route.value,h.outlet&&h.outlet.attach(m.componentRef,m.route.value),_O(m.route.value),this.activateChildRoutes(n,null,h.children)}else{const m=yE(s.snapshot);h.attachRef=null,h.route=s,h.injector=m,h.outlet&&h.outlet.activateWith(s,h.injector),this.activateChildRoutes(n,null,h.children)}}else this.activateChildRoutes(n,null,i)}}class LU{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class XD{constructor(n,e){this.component=n,this.route=e}}function HW(t,n,e){const i=t._root;return vE(i,n?n._root:null,e,[i.value])}function lx(t,n){const e=Symbol(),i=n.get(t,e);return i===e?"function"!=typeof t||function Or(t){return null!==jd(t)}(t)?n.get(t):t:i}function vE(t,n,e,i,s={canDeactivateChecks:[],canActivateChecks:[]}){const l=ox(n);return t.children.forEach(h=>{(function jW(t,n,e,i,s={canDeactivateChecks:[],canActivateChecks:[]}){const l=t.value,h=n?n.value:null,m=e?e.getContext(t.value.outlet):null;if(h&&l.routeConfig===h.routeConfig){const b=function GW(t,n,e){if("function"==typeof e)return e(t,n);switch(e){case"pathParamsChange":return!I1(t.url,n.url);case"pathParamsOrQueryParamsChange":return!I1(t.url,n.url)||!km(t.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!yO(t,n)||!km(t.queryParams,n.queryParams);default:return!yO(t,n)}}(h,l,l.routeConfig.runGuardsAndResolvers);b?s.canActivateChecks.push(new LU(i)):(l.data=h.data,l._resolvedData=h._resolvedData),vE(t,n,l.component?m?m.children:null:e,i,s),b&&m&&m.outlet&&m.outlet.isActivated&&s.canDeactivateChecks.push(new XD(m.outlet.component,h))}else h&&bE(n,m,s),s.canActivateChecks.push(new LU(i)),vE(t,null,l.component?m?m.children:null:e,i,s)})(h,l[h.value.outlet],e,i.concat([h.value]),s),delete l[h.value.outlet]}),Object.entries(l).forEach(([h,m])=>bE(m,e.getContext(h),s)),s}function bE(t,n,e){const i=ox(t),s=t.value;Object.entries(i).forEach(([l,h])=>{bE(h,s.component?n?n.children.getContext(l):null:n,e)}),e.canDeactivateChecks.push(new XD(s.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,s))}function wE(t){return"function"==typeof t}function UU(t){return t instanceof LD||"EmptyError"===t?.name}const YD=Symbol("INITIAL_VALUE");function cx(){return cl(t=>Rm(t.map(n=>n.pipe(Xo(1),T1(YD)))).pipe(Ht(n=>{for(const e of n)if(!0!==e){if(e===YD)return YD;if(!1===e||e instanceof rx)return e}return!0}),Io(n=>n!==YD),Xo(1)))}function zU(t){return function Od(...t){return Xu(t)}(sc(n=>{if(D1(n))throw OU(0,n)}),Ht(n=>!0===n))}class JD{constructor(n){this.segmentGroup=n||null}}class VU{constructor(n){this.urlTree=n}}function ux(t){return l0(new JD(t))}function HU(t){return l0(new VU(t))}class hZ{constructor(n,e){this.urlSerializer=n,this.urlTree=e}noMatchError(n){return new ln(4002,!1)}lineralizeSegments(n,e){let i=[],s=e.root;for(;;){if(i=i.concat(s.segments),0===s.numberOfChildren)return Bi(i);if(s.numberOfChildren>1||!s.children[Ks])return l0(new ln(4e3,!1));s=s.children[Ks]}}applyRedirectCommands(n,e,i){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),n,i)}applyRedirectCreateUrlTree(n,e,i,s){const l=this.createSegmentGroup(n,e.root,i,s);return new rx(l,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(n,e){const i={};return Object.entries(n).forEach(([s,l])=>{if("string"==typeof l&&l.startsWith(":")){const m=l.substring(1);i[s]=e[m]}else i[s]=l}),i}createSegmentGroup(n,e,i,s){const l=this.createSegments(n,e.segments,i,s);let h={};return Object.entries(e.children).forEach(([m,b])=>{h[m]=this.createSegmentGroup(n,b,i,s)}),new xa(l,h)}createSegments(n,e,i,s){return e.map(l=>l.path.startsWith(":")?this.findPosParam(n,l,s):this.findOrReturn(l,i))}findPosParam(n,e,i){const s=i[e.path.substring(1)];if(!s)throw new ln(4001,!1);return s}findOrReturn(n,e){let i=0;for(const s of e){if(s.path===n.path)return e.splice(i),s;i++}return n}}const xO={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function dZ(t,n,e,i,s){const l=CO(t,n,e);return l.matched?(i=function kW(t,n){return t.providers&&!t._injector&&(t._injector=Z5(t.providers,n,`Route: ${t.path}`)),t._injector??n}(n,i),function lZ(t,n,e,i){const s=n.canMatch;return s&&0!==s.length?Bi(s.map(h=>{const m=lx(h,t);return Fy(function XW(t){return t&&wE(t.canMatch)}(m)?m.canMatch(n,e):t.runInContext(()=>m(n,e)))})).pipe(cx(),zU()):Bi(!0)}(i,n,e).pipe(Ht(h=>!0===h?l:{...xO}))):Bi(l)}function CO(t,n,e){if(""===n.path)return"full"===n.pathMatch&&(t.hasChildren()||e.length>0)?{...xO}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const s=(n.matcher||jK)(e,t,n);if(!s)return{...xO};const l={};Object.entries(s.posParams??{}).forEach(([m,b])=>{l[m]=b.path});const h=s.consumed.length>0?{...l,...s.consumed[s.consumed.length-1].parameters}:l;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:h,positionalParamSegments:s.posParams??{}}}function QU(t,n,e,i){return e.length>0&&function pZ(t,n,e){return e.some(i=>eB(t,n,i)&&ag(i)!==Ks)}(t,e,i)?{segmentGroup:new xa(n,AZ(i,new xa(e,t.children))),slicedSegments:[]}:0===e.length&&function gZ(t,n,e){return e.some(i=>eB(t,n,i))}(t,e,i)?{segmentGroup:new xa(t.segments,fZ(t,0,e,i,t.children)),slicedSegments:e}:{segmentGroup:new xa(t.segments,t.children),slicedSegments:e}}function fZ(t,n,e,i,s){const l={};for(const h of i)if(eB(t,e,h)&&!s[ag(h)]){const m=new xa([],{});l[ag(h)]=m}return{...s,...l}}function AZ(t,n){const e={};e[Ks]=n;for(const i of t)if(""===i.path&&ag(i)!==Ks){const s=new xa([],{});e[ag(i)]=s}return e}function eB(t,n,e){return(!(t.hasChildren()||n.length>0)||"full"!==e.pathMatch)&&""===e.path}class vZ{constructor(n,e,i,s,l,h,m){this.injector=n,this.configLoader=e,this.rootComponentType=i,this.config=s,this.urlTree=l,this.paramsInheritanceStrategy=h,this.urlSerializer=m,this.allowRedirects=!0,this.applyRedirects=new hZ(this.urlSerializer,this.urlTree)}noMatchError(n){return new ln(4002,!1)}recognize(){const n=QU(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,Ks).pipe(sp(e=>{if(e instanceof VU)return this.allowRedirects=!1,this.urlTree=e.urlTree,this.match(e.urlTree);throw e instanceof JD?this.noMatchError(e):e}),Ht(e=>{const i=new WD([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Ks,this.rootComponentType,null,{}),s=new c0(i,e),l=new MU("",s),h=function uW(t,n,e=null,i=null){return yU(_U(t),n,e,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return h.queryParams=this.urlTree.queryParams,l.url=this.urlSerializer.serialize(h),this.inheritParamsAndData(l._root),{state:l,tree:h}}))}match(n){return this.processSegmentGroup(this.injector,this.config,n.root,Ks).pipe(sp(i=>{throw i instanceof JD?this.noMatchError(i):i}))}inheritParamsAndData(n){const e=n.value,i=BU(e,this.paramsInheritanceStrategy);e.params=Object.freeze(i.params),e.data=Object.freeze(i.data),n.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(n,e,i,s){return 0===i.segments.length&&i.hasChildren()?this.processChildren(n,e,i):this.processSegment(n,e,i,i.segments,s,!0)}processChildren(n,e,i){const s=[];for(const l of Object.keys(i.children))"primary"===l?s.unshift(l):s.push(l);return Gs(s).pipe(nx(l=>{const h=i.children[l],m=function UW(t,n){const e=t.filter(i=>ag(i)===n);return e.push(...t.filter(i=>ag(i)!==n)),e}(e,l);return this.processSegmentGroup(n,m,h,l)}),function VK(t,n){return Xs(function zK(t,n,e,i,s){return(l,h)=>{let m=e,b=n,E=0;l.subscribe(Kr(h,M=>{const L=E++;b=m?t(b,M,L):(m=!0,M),i&&h.next(b)},s&&(()=>{m&&h.next(b),h.complete()})))}}(t,n,arguments.length>=2,!0))}((l,h)=>(l.push(...h),l)),zD(null),function HK(t,n){const e=arguments.length>=2;return i=>i.pipe(t?Io((s,l)=>t(s,l,i)):ir,aO(1),e?zD(n):rU(()=>new LD))}(),es(l=>{if(null===l)return ux(i);const h=jU(l);return function bZ(t){t.sort((n,e)=>n.value.outlet===Ks?-1:e.value.outlet===Ks?1:n.value.outlet.localeCompare(e.value.outlet))}(h),Bi(h)}))}processSegment(n,e,i,s,l,h){return Gs(e).pipe(nx(m=>this.processSegmentAgainstRoute(m._injector??n,e,m,i,s,l,h).pipe(sp(b=>{if(b instanceof JD)return Bi(null);throw b}))),Om(m=>!!m),sp(m=>{if(UU(m))return function _Z(t,n,e){return 0===n.length&&!t.children[e]}(i,s,l)?Bi([]):ux(i);throw m}))}processSegmentAgainstRoute(n,e,i,s,l,h,m){return function mZ(t,n,e,i){return!!(ag(t)===i||i!==Ks&&eB(n,e,t))&&("**"===t.path||CO(n,t,e).matched)}(i,s,l,h)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(n,s,i,l,h,m):m&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,s,e,i,l,h):ux(s):ux(s)}expandSegmentAgainstRouteUsingRedirect(n,e,i,s,l,h){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,i,s,h):this.expandRegularSegmentAgainstRouteUsingRedirect(n,e,i,s,l,h)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,e,i,s){const l=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?HU(l):this.applyRedirects.lineralizeSegments(i,l).pipe(es(h=>{const m=new xa(h,{});return this.processSegment(n,e,m,h,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,e,i,s,l,h){const{matched:m,consumedSegments:b,remainingSegments:E,positionalParamSegments:M}=CO(e,s,l);if(!m)return ux(e);const L=this.applyRedirects.applyRedirectCommands(b,s.redirectTo,M);return s.redirectTo.startsWith("/")?HU(L):this.applyRedirects.lineralizeSegments(s,L).pipe(es(G=>this.processSegment(n,i,e,G.concat(E),h,!1)))}matchSegmentAgainstRoute(n,e,i,s,l,h){let m;if("**"===i.path){const b=s.length>0?aU(s).parameters:{};m=Bi({snapshot:new WD(s,b,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,GU(i),ag(i),i.component??i._loadedComponent??null,i,$U(i)),consumedSegments:[],remainingSegments:[]}),e.children={}}else m=dZ(e,i,s,n).pipe(Ht(({matched:b,consumedSegments:E,remainingSegments:M,parameters:L})=>b?{snapshot:new WD(E,L,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,GU(i),ag(i),i.component??i._loadedComponent??null,i,$U(i)),consumedSegments:E,remainingSegments:M}:null));return m.pipe(cl(b=>null===b?ux(e):this.getChildConfig(n=i._injector??n,i,s).pipe(cl(({routes:E})=>{const M=i._loadedInjector??n,{snapshot:L,consumedSegments:G,remainingSegments:V}=b,{segmentGroup:ne,slicedSegments:re}=QU(e,G,V,E);if(0===re.length&&ne.hasChildren())return this.processChildren(M,E,ne).pipe(Ht(fe=>null===fe?null:[new c0(L,fe)]));if(0===E.length&&0===re.length)return Bi([new c0(L,[])]);const de=ag(i)===l;return this.processSegment(M,E,ne,re,de?Ks:l,!0).pipe(Ht(fe=>[new c0(L,fe)]))}))))}getChildConfig(n,e,i){return e.children?Bi({routes:e.children,injector:n}):e.loadChildren?void 0!==e._loadedRoutes?Bi({routes:e._loadedRoutes,injector:e._loadedInjector}):function aZ(t,n,e,i){const s=n.canLoad;return void 0===s||0===s.length?Bi(!0):Bi(s.map(h=>{const m=lx(h,t);return Fy(function qW(t){return t&&wE(t.canLoad)}(m)?m.canLoad(n,e):t.runInContext(()=>m(n,e)))})).pipe(cx(),zU())}(n,e,i).pipe(es(s=>s?this.configLoader.loadChildren(n,e).pipe(sc(l=>{e._loadedRoutes=l.routes,e._loadedInjector=l.injector})):function uZ(t){return l0(kU(!1,3))}())):Bi({routes:[],injector:n})}}function wZ(t){const n=t.value.routeConfig;return n&&""===n.path}function jU(t){const n=[],e=new Set;for(const i of t){if(!wZ(i)){n.push(i);continue}const s=n.find(l=>i.value.routeConfig===l.value.routeConfig);void 0!==s?(s.children.push(...i.children),e.add(s)):n.push(i)}for(const i of e){const s=jU(i.children);n.push(new c0(i.value,s))}return n.filter(i=>!e.has(i))}function GU(t){return t.data||{}}function $U(t){return t.resolve||{}}function qU(t){return"string"==typeof t.title||null===t.title}function EO(t){return cl(n=>{const e=t(n);return e?Gs(e).pipe(Ht(()=>n)):Bi(n)})}const hx=new pi("ROUTES");let SO=(()=>{class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=In(D3)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Bi(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const i=Fy(e.loadComponent()).pipe(Ht(KU),sc(l=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=l}),lE(()=>{this.componentLoaders.delete(e)})),s=new oO(i,()=>new Li).pipe(sO());return this.componentLoaders.set(e,s),s}loadChildren(e,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Bi({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const l=function DZ(t,n,e,i){return Fy(t.loadChildren()).pipe(Ht(KU),es(s=>s instanceof UL||Array.isArray(s)?Bi(s):Gs(n.compileModuleAsync(s))),Ht(s=>{i&&i(t);let l,h,m=!1;return Array.isArray(s)?(h=s,!0):(l=s.create(e).injector,h=l.get(hx,[],{optional:!0,self:!0}).flat()),{routes:h.map(wO),injector:l}}))}(i,this.compiler,e,this.onLoadEndListener).pipe(lE(()=>{this.childrenLoaders.delete(i)})),h=new oO(l,()=>new Li).pipe(sO());return this.childrenLoaders.set(i,h),h}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function KU(t){return function BZ(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}let tB=(()=>{class t{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Li,this.transitionAbortSubject=new Li,this.configLoader=In(SO),this.environmentInjector=In(Lu),this.urlSerializer=In(hE),this.rootContexts=In(mE),this.inputBindingEnabled=null!==In(ZD,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Bi(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=s=>this.events.next(new wW(s)),this.configLoader.onLoadStartListener=s=>this.events.next(new bW(s))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:i})}setupNavigations(e,i,s){return this.transitions=new Fi({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:e.urlHandlingStrategy.extract(i),urlAfterRedirects:e.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:pE,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Io(l=>0!==l.id),Ht(l=>({...l,extractedUrl:e.urlHandlingStrategy.extract(l.rawUrl)})),cl(l=>{this.currentTransition=l;let h=!1,m=!1;return Bi(l).pipe(sc(b=>{this.currentNavigation={id:b.id,initialUrl:b.rawUrl,extractedUrl:b.extractedUrl,trigger:b.source,extras:b.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),cl(b=>{const E=b.currentBrowserUrl.toString(),M=!e.navigated||b.extractedUrl.toString()!==E||E!==b.currentUrlTree.toString();if(!M&&"reload"!==(b.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const G="";return this.events.next(new sx(b.id,this.urlSerializer.serialize(b.rawUrl),G,0)),b.resolve(null),Fo}if(e.urlHandlingStrategy.shouldProcessUrl(b.rawUrl))return Bi(b).pipe(cl(G=>{const V=this.transitions?.getValue();return this.events.next(new qD(G.id,this.urlSerializer.serialize(G.extractedUrl),G.source,G.restoredState)),V!==this.transitions?.getValue()?Fo:Promise.resolve(G)}),function xZ(t,n,e,i,s,l){return es(h=>function yZ(t,n,e,i,s,l,h="emptyOnly"){return new vZ(t,n,e,i,s,h,l).recognize()}(t,n,e,i,h.extractedUrl,s,l).pipe(Ht(({state:m,tree:b})=>({...h,targetSnapshot:m,urlAfterRedirects:b}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,e.paramsInheritanceStrategy),sc(G=>{l.targetSnapshot=G.targetSnapshot,l.urlAfterRedirects=G.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:G.urlAfterRedirects};const V=new EU(G.id,this.urlSerializer.serialize(G.extractedUrl),this.urlSerializer.serialize(G.urlAfterRedirects),G.targetSnapshot);this.events.next(V)}));if(M&&e.urlHandlingStrategy.shouldProcessUrl(b.currentRawUrl)){const{id:G,extractedUrl:V,source:ne,restoredState:re,extras:de}=b,fe=new qD(G,this.urlSerializer.serialize(V),ne,re);this.events.next(fe);const he=DU(0,this.rootComponentType).snapshot;return this.currentTransition=l={...b,targetSnapshot:he,urlAfterRedirects:V,extras:{...de,skipLocationChange:!1,replaceUrl:!1}},Bi(l)}{const G="";return this.events.next(new sx(b.id,this.urlSerializer.serialize(b.extractedUrl),G,1)),b.resolve(null),Fo}}),sc(b=>{const E=new mW(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot);this.events.next(E)}),Ht(b=>(this.currentTransition=l={...b,guards:HW(b.targetSnapshot,b.currentSnapshot,this.rootContexts)},l)),function JW(t,n){return es(e=>{const{targetSnapshot:i,currentSnapshot:s,guards:{canActivateChecks:l,canDeactivateChecks:h}}=e;return 0===h.length&&0===l.length?Bi({...e,guardsResult:!0}):function eZ(t,n,e,i){return Gs(t).pipe(es(s=>function oZ(t,n,e,i,s){const l=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return l&&0!==l.length?Bi(l.map(m=>{const b=yE(n)??s,E=lx(m,b);return Fy(function ZW(t){return t&&wE(t.canDeactivate)}(E)?E.canDeactivate(t,n,e,i):b.runInContext(()=>E(t,n,e,i))).pipe(Om())})).pipe(cx()):Bi(!0)}(s.component,s.route,e,n,i)),Om(s=>!0!==s,!0))}(h,i,s,t).pipe(es(m=>m&&function $W(t){return"boolean"==typeof t}(m)?function tZ(t,n,e,i){return Gs(n).pipe(nx(s=>tx(function iZ(t,n){return null!==t&&n&&n(new xW(t)),Bi(!0)}(s.route.parent,i),function nZ(t,n){return null!==t&&n&&n(new EW(t)),Bi(!0)}(s.route,i),function sZ(t,n,e){const i=n[n.length-1],l=n.slice(0,n.length-1).reverse().map(h=>function QW(t){const n=t.routeConfig?t.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:t,guards:n}:null}(h)).filter(h=>null!==h).map(h=>UD(()=>Bi(h.guards.map(b=>{const E=yE(h.node)??e,M=lx(b,E);return Fy(function WW(t){return t&&wE(t.canActivateChild)}(M)?M.canActivateChild(i,t):E.runInContext(()=>M(i,t))).pipe(Om())})).pipe(cx())));return Bi(l).pipe(cx())}(t,s.path,e),function rZ(t,n,e){const i=n.routeConfig?n.routeConfig.canActivate:null;if(!i||0===i.length)return Bi(!0);const s=i.map(l=>UD(()=>{const h=yE(n)??e,m=lx(l,h);return Fy(function KW(t){return t&&wE(t.canActivate)}(m)?m.canActivate(n,t):h.runInContext(()=>m(n,t))).pipe(Om())}));return Bi(s).pipe(cx())}(t,s.route,e))),Om(s=>!0!==s,!0))}(i,l,t,n):Bi(m)),Ht(m=>({...e,guardsResult:m})))})}(this.environmentInjector,b=>this.events.next(b)),sc(b=>{if(l.guardsResult=b.guardsResult,D1(b.guardsResult))throw OU(0,b.guardsResult);const E=new _W(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot,!!b.guardsResult);this.events.next(E)}),Io(b=>!!b.guardsResult||(this.cancelNavigationTransition(b,"",3),!1)),EO(b=>{if(b.guards.canActivateChecks.length)return Bi(b).pipe(sc(E=>{const M=new yW(E.id,this.urlSerializer.serialize(E.extractedUrl),this.urlSerializer.serialize(E.urlAfterRedirects),E.targetSnapshot);this.events.next(M)}),cl(E=>{let M=!1;return Bi(E).pipe(function CZ(t,n){return es(e=>{const{targetSnapshot:i,guards:{canActivateChecks:s}}=e;if(!s.length)return Bi(e);let l=0;return Gs(s).pipe(nx(h=>function EZ(t,n,e,i){const s=t.routeConfig,l=t._resolve;return void 0!==s?.title&&!qU(s)&&(l[cE]=s.title),function SZ(t,n,e,i){const s=function TZ(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}(t);if(0===s.length)return Bi({});const l={};return Gs(s).pipe(es(h=>function IZ(t,n,e,i){const s=yE(n)??i,l=lx(t,s);return Fy(l.resolve?l.resolve(n,e):s.runInContext(()=>l(n,e)))}(t[h],n,e,i).pipe(Om(),sc(m=>{l[h]=m}))),aO(1),sU(l),sp(h=>UU(h)?Fo:l0(h)))}(l,t,n,i).pipe(Ht(h=>(t._resolvedData=h,t.data=BU(t,e).resolve,s&&qU(s)&&(t.data[cE]=s.title),null)))}(h.route,i,t,n)),sc(()=>l++),aO(1),es(h=>l===s.length?Bi(e):Fo))})}(e.paramsInheritanceStrategy,this.environmentInjector),sc({next:()=>M=!0,complete:()=>{M||this.cancelNavigationTransition(E,"",2)}}))}),sc(E=>{const M=new vW(E.id,this.urlSerializer.serialize(E.extractedUrl),this.urlSerializer.serialize(E.urlAfterRedirects),E.targetSnapshot);this.events.next(M)}))}),EO(b=>{const E=M=>{const L=[];M.routeConfig?.loadComponent&&!M.routeConfig._loadedComponent&&L.push(this.configLoader.loadComponent(M.routeConfig).pipe(sc(G=>{M.component=G}),Ht(()=>{})));for(const G of M.children)L.push(...E(G));return L};return Rm(E(b.targetSnapshot.root)).pipe(zD(),Xo(1))}),EO(()=>this.afterPreactivation()),Ht(b=>{const E=function MW(t,n,e){const i=_E(t,n._root,e?e._root:void 0);return new IU(i,n)}(e.routeReuseStrategy,b.targetSnapshot,b.currentRouterState);return this.currentTransition=l={...b,targetRouterState:E},l}),sc(()=>{this.events.next(new fO)}),((t,n,e,i)=>Ht(s=>(new VW(n,s.targetRouterState,s.currentRouterState,e,i).activate(t),s)))(this.rootContexts,e.routeReuseStrategy,b=>this.events.next(b),this.inputBindingEnabled),Xo(1),sc({next:b=>{h=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ry(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects))),e.titleStrategy?.updateTitle(b.targetRouterState.snapshot),b.resolve(!0)},complete:()=>{h=!0}}),Ps(this.transitionAbortSubject.pipe(sc(b=>{throw b}))),lE(()=>{h||m||this.cancelNavigationTransition(l,"",1),this.currentNavigation?.id===l.id&&(this.currentNavigation=null)}),sp(b=>{if(m=!0,PU(b))this.events.next(new gE(l.id,this.urlSerializer.serialize(l.extractedUrl),b.message,b.cancellationCode)),function OW(t){return PU(t)&&D1(t.url)}(b)?this.events.next(new AO(b.url)):l.resolve(!1);else{this.events.next(new KD(l.id,this.urlSerializer.serialize(l.extractedUrl),b,l.targetSnapshot??void 0));try{l.resolve(e.errorHandler(b))}catch(E){l.reject(E)}}return Fo}))}))}cancelNavigationTransition(e,i,s){const l=new gE(e.id,this.urlSerializer.serialize(e.extractedUrl),i,s);this.events.next(l),e.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function WU(t){return t!==pE}let ZU=(()=>{class t{buildTitle(e){let i,s=e.root;for(;void 0!==s;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(l=>l.outlet===Ks);return i}getResolvedTitleForRoute(e){return e.data[cE]}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(){return In(MZ)},providedIn:"root"})}return t})(),MZ=(()=>{class t extends ZU{constructor(e){super(),this.title=e}updateTitle(e){const i=this.buildTitle(e);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(X4))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),FZ=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(){return In(OZ)},providedIn:"root"})}return t})();class RZ{shouldDetach(n){return!1}store(n,e){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,e){return n.routeConfig===e.routeConfig}}let OZ=(()=>{class t extends RZ{static#e=this.\u0275fac=function(){let e;return function(s){return(e||(e=Ms(t)))(s||t)}}();static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const nB=new pi("",{providedIn:"root",factory:()=>({})});let kZ=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(){return In(PZ)},providedIn:"root"})}return t})(),PZ=(()=>{class t{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var xE=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(xE||{});function XU(t,n){t.events.pipe(Io(e=>e instanceof Ry||e instanceof gE||e instanceof KD||e instanceof sx),Ht(e=>e instanceof Ry||e instanceof sx?xE.COMPLETE:e instanceof gE&&(0===e.code||1===e.code)?xE.REDIRECTING:xE.FAILED),Io(e=>e!==xE.REDIRECTING),Xo(1)).subscribe(()=>{n()})}function NZ(t){throw t}function LZ(t,n,e){return n.parse("/")}const UZ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},zZ={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Dd=(()=>{class t{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=In(I3),this.isNgZoneEnabled=!1,this._events=new Li,this.options=In(nB,{optional:!0})||{},this.pendingTasks=In(pD),this.errorHandler=this.options.errorHandler||NZ,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||LZ,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=In(kZ),this.routeReuseStrategy=In(FZ),this.titleStrategy=In(ZU),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=In(hx,{optional:!0})?.flat()??[],this.navigationTransitions=In(tB),this.urlSerializer=In(hE),this.location=In(DR),this.componentInputBindingEnabled=!!In(ZD,{optional:!0}),this.eventsSubscription=new Ai,this.isNgZoneEnabled=In(Wi)instanceof Wi&&Wi.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new rx,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=DU(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(e=>{this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const e=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:s}=this.navigationTransitions;if(null===s)return void(YU(i)&&this._events.next(i));if(i instanceof qD)WU(s.source)&&(this.browserUrlTree=s.extractedUrl);else if(i instanceof sx)this.rawUrlTree=s.rawUrl;else if(i instanceof EU){if("eager"===this.urlUpdateStrategy){if(!s.extras.skipLocationChange){const l=this.urlHandlingStrategy.merge(s.urlAfterRedirects,s.rawUrl);this.setBrowserUrl(l,s)}this.browserUrlTree=s.urlAfterRedirects}}else if(i instanceof fO)this.currentUrlTree=s.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(s.urlAfterRedirects,s.rawUrl),this.routerState=s.targetRouterState,"deferred"===this.urlUpdateStrategy&&(s.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,s),this.browserUrlTree=s.urlAfterRedirects);else if(i instanceof gE)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(s);else if(i instanceof AO){const l=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),h={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||WU(s.source)};this.scheduleNavigation(l,pE,null,h,{resolve:s.resolve,reject:s.reject,promise:s.promise})}i instanceof KD&&this.restoreHistory(s,!0),i instanceof Ry&&(this.navigated=!0),YU(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const e=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),pE,e)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const i="popstate"===e.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(e.url,i,e.state)},0)}))}navigateToSyncWithBrowser(e,i,s){const l={replaceUrl:!0},h=s?.navigationId?s:null;if(s){const b={...s};delete b.navigationId,delete b.\u0275routerPageId,0!==Object.keys(b).length&&(l.state=b)}const m=this.parseUrl(e);this.scheduleNavigation(m,i,h,l)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(wO),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,i={}){const{relativeTo:s,queryParams:l,fragment:h,queryParamsHandling:m,preserveFragment:b}=i,E=b?this.currentUrlTree.fragment:h;let L,M=null;switch(m){case"merge":M={...this.currentUrlTree.queryParams,...l};break;case"preserve":M=this.currentUrlTree.queryParams;break;default:M=l||null}null!==M&&(M=this.removeEmptyProps(M));try{L=_U(s?s.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof e[0]||!e[0].startsWith("/"))&&(e=[]),L=this.currentUrlTree.root}return yU(L,e,M,E??null)}navigateByUrl(e,i={skipLocationChange:!1}){const s=D1(e)?e:this.parseUrl(e),l=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(l,pE,null,i)}navigate(e,i={skipLocationChange:!1}){return function VZ(t){for(let n=0;n<t.length;n++)if(null==t[n])throw new ln(4008,!1)}(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let i;try{i=this.urlSerializer.parse(e)}catch(s){i=this.malformedUriErrorHandler(s,this.urlSerializer,e)}return i}isActive(e,i){let s;if(s=!0===i?{...UZ}:!1===i?{...zZ}:i,D1(e))return cU(this.currentUrlTree,e,s);const l=this.parseUrl(e);return cU(this.currentUrlTree,l,s)}removeEmptyProps(e){return Object.keys(e).reduce((i,s)=>{const l=e[s];return null!=l&&(i[s]=l),i},{})}scheduleNavigation(e,i,s,l,h){if(this.disposed)return Promise.resolve(!1);let m,b,E;h?(m=h.resolve,b=h.reject,E=h.promise):E=new Promise((L,G)=>{m=L,b=G});const M=this.pendingTasks.add();return XU(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(M))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:e,extras:l,resolve:m,reject:b,promise:E,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),E.catch(L=>Promise.reject(L))}setBrowserUrl(e,i){const s=this.urlSerializer.serialize(e);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){const h={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(s,"",h)}else{const l={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(s,"",l)}}restoreHistory(e,i=!1){if("computed"===this.canceledNavigationResolution){const l=this.currentPageId-this.browserPageId;0!==l?this.location.historyGo(l):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===l&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,i){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function YU(t){return!(t instanceof fO||t instanceof AO)}let iB=(()=>{class t{constructor(e,i,s,l,h,m){this.router=e,this.route=i,this.tabIndexAttribute=s,this.renderer=l,this.el=h,this.locationStrategy=m,this.href=null,this.commands=null,this.onChanges=new Li,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const b=h.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===b||"area"===b,this.isAnchorElement?this.subscription=e.events.subscribe(E=>{E instanceof Ry&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(e,i,s,l,h){return!!(null===this.urlTree||this.isAnchorElement&&(0!==e||i||s||l||h||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const e=null===this.href?null:function wT(t,n,e){return function kF(t,n){return"src"===n&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===n&&("base"===t||"link"===t)?Gb:bT}(n,e)(t)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",e)}applyAttributeValue(e,i){const s=this.renderer,l=this.el.nativeElement;null!==i?s.setAttribute(l,e,i):s.removeAttribute(l,e)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Dd),Ve(ax),_l("tabindex"),Ve(Wh),Ve(ao),Ve(S1))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){1&i&&Tt("click",function(h){return s.onClick(h.button,h.ctrlKey,h.shiftKey,h.altKey,h.metaKey)}),2&i&&To("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",Xw],skipLocationChange:["skipLocationChange","skipLocationChange",Xw],replaceUrl:["replaceUrl","replaceUrl",Xw],routerLink:"routerLink"},standalone:!0,features:[BI,Zo]})}return t})(),JU=(()=>{class t{get isActive(){return this._isActive}constructor(e,i,s,l,h){this.router=e,this.element=i,this.renderer=s,this.cdr=l,this.link=h,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new vi,this.routerEventsSubscription=e.events.subscribe(m=>{m instanceof Ry&&this.update()})}ngAfterContentInit(){Bi(this.links.changes,Bi(null)).pipe(qo()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const e=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=Gs(e).pipe(qo()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(e){const i=Array.isArray(e)?e:e.split(" ");this.classes=i.filter(s=>!!s)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{const e=this.hasActiveLinks();this._isActive!==e&&(this._isActive=e,this.cdr.markForCheck(),this.classes.forEach(i=>{e?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),e&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(e))})}isLinkActive(e){const i=function HZ(t){return!!t.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return s=>!!s.urlTree&&e.isActive(s.urlTree,i)}hasActiveLinks(){const e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Dd),Ve(ao),Ve(Wh),Ve(gf),Ve(iB,8))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(i,s,l){if(1&i&&Qa(l,iB,5),2&i){let h;is(h=rs())&&(s.links=h)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Zo]})}return t})();class e6{}let QZ=(()=>{class t{constructor(e,i,s,l,h){this.router=e,this.injector=s,this.preloadingStrategy=l,this.loader=h}setUpPreloading(){this.subscription=this.router.events.pipe(Io(e=>e instanceof Ry),nx(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,i){const s=[];for(const l of i){l.providers&&!l._injector&&(l._injector=Z5(l.providers,e,`Route: ${l.path}`));const h=l._injector??e,m=l._loadedInjector??h;(l.loadChildren&&!l._loadedRoutes&&void 0===l.canLoad||l.loadComponent&&!l._loadedComponent)&&s.push(this.preloadConfig(h,l)),(l.children||l._loadedRoutes)&&s.push(this.processRoutes(m,l.children??l._loadedRoutes))}return Gs(s).pipe(qo())}preloadConfig(e,i){return this.preloadingStrategy.preload(i,()=>{let s;s=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(e,i):Bi(null);const l=s.pipe(es(h=>null===h?Bi(void 0):(i._loadedRoutes=h.routes,i._loadedInjector=h.injector,this.processRoutes(h.injector??e,h.routes))));return i.loadComponent&&!i._loadedComponent?Gs([l,this.loader.loadComponent(i)]).pipe(qo()):l})}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Dd),Xt(D3),Xt(Lu),Xt(e6),Xt(SO))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const TO=new pi("");let t6=(()=>{class t{constructor(e,i,s,l,h={}){this.urlSerializer=e,this.transitions=i,this.viewportScroller=s,this.zone=l,this.options=h,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},h.scrollPositionRestoration=h.scrollPositionRestoration||"disabled",h.anchorScrolling=h.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof qD?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Ry?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof sx&&0===e.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof SU&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new SU(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){!function Yp(){throw new Error("invalid")}()};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();function u0(t,n){return{\u0275kind:t,\u0275providers:n}}function i6(){const t=In(Zc);return n=>{const e=t.get(Fm);if(n!==e.components[0])return;const i=t.get(Dd),s=t.get(r6);1===t.get(IO)&&i.initialNavigation(),t.get(s6,null,vs.Optional)?.setUpPreloading(),t.get(TO,null,vs.Optional)?.init(),i.resetRootComponentType(e.componentTypes[0]),s.closed||(s.next(),s.complete(),s.unsubscribe())}}const r6=new pi("",{factory:()=>new Li}),IO=new pi("",{providedIn:"root",factory:()=>1}),s6=new pi("");function qZ(t){return u0(0,[{provide:s6,useExisting:QZ},{provide:e6,useExisting:t}])}const o6=new pi("ROUTER_FORROOT_GUARD"),WZ=[DR,{provide:hE,useClass:lO},Dd,mE,{provide:ax,useFactory:function n6(t){return t.routerState.root},deps:[Dd]},SO,[]];function ZZ(){return new P3("Router",Dd)}let a6=(()=>{class t{constructor(e){}static forRoot(e,i){return{ngModule:t,providers:[WZ,[],{provide:hx,multi:!0,useValue:e},{provide:o6,useFactory:eX,deps:[[Dd,new Vo,new S_]]},{provide:nB,useValue:i||{}},i?.useHash?{provide:S1,useClass:g$}:{provide:S1,useClass:d4},{provide:TO,useFactory:()=>{const t=In(Bq),n=In(Wi),e=In(nB),i=In(tB),s=In(hE);return e.scrollOffset&&t.setOffset(e.scrollOffset),new t6(s,i,t,n,e)}},i?.preloadingStrategy?qZ(i.preloadingStrategy).\u0275providers:[],{provide:P3,multi:!0,useFactory:ZZ},i?.initialNavigation?tX(i):[],i?.bindToComponentInputs?u0(8,[RU,{provide:ZD,useExisting:RU}]).\u0275providers:[],[{provide:l6,useFactory:i6},{provide:_R,multi:!0,useExisting:l6}]]}}static forChild(e){return{ngModule:t,providers:[{provide:hx,multi:!0,useValue:e}]}}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(o6,8))};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})();function eX(t){return"guarded"}function tX(t){return["disabled"===t.initialNavigation?u0(3,[{provide:AD,multi:!0,useFactory:()=>{const n=In(Dd);return()=>{n.setUpLocationChangeListener()}}},{provide:IO,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?u0(2,[{provide:IO,useValue:0},{provide:AD,multi:!0,deps:[Zc],useFactory:n=>{const e=n.get(A$,Promise.resolve());return()=>e.then(()=>new Promise(i=>{const s=n.get(Dd),l=n.get(r6);XU(s,()=>{i(!0)}),n.get(tB).afterPreactivation=()=>(i(!0),l.closed?Bi(void 0):l),s.initialNavigation()}))}}]).\u0275providers:[]]}const l6=new pi(""),iX=["addListener","removeListener"],rX=["addEventListener","removeEventListener"],sX=["on","off"];function Ba(t,n,e,i){if(qr(e)&&(i=e,e=void 0),i)return Ba(t,n,e).pipe(rO(i));const[s,l]=function lX(t){return qr(t.addEventListener)&&qr(t.removeEventListener)}(t)?rX.map(h=>m=>t[h](n,m,e)):function oX(t){return qr(t.addListener)&&qr(t.removeListener)}(t)?iX.map(c6(t,n)):function aX(t){return qr(t.on)&&qr(t.off)}(t)?sX.map(c6(t,n)):[];if(!s&&Za(t))return es(h=>Ba(h,n,e))(gn(t));if(!s)throw new TypeError("Invalid event target");return new Hr(h=>{const m=(...b)=>h.next(1<b.length?b:b[0]);return s(m),()=>l(m)})}function c6(t,n){return e=>i=>t[e](n,i)}class cX extends Ai{constructor(n,e){super()}schedule(n,e=0){return this}}const rB={setInterval(t,n,...e){const{delegate:i}=rB;return i?.setInterval?i.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){const{delegate:n}=rB;return(n?.clearInterval||clearInterval)(t)},delegate:void 0};class DO extends cX{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var i;if(this.closed)return this;this.state=n;const s=this.id,l=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(l,s,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(l,this.id,e),this}requestAsyncId(n,e,i=0){return rB.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&rB.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let s,i=!1;try{this.work(n)}catch(l){i=!0,s=l||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,p(i,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}const u6={now:()=>(u6.delegate||Date).now(),delegate:void 0};class CE{constructor(n,e=CE.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,i){return new this.schedulerActionCtor(this,n).schedule(i,e)}}CE.now=u6.now;class BO extends CE{constructor(n,e=CE.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,i){for(;n=e.shift();)n.unsubscribe();throw i}}}const dx=new BO(DO),uX=dx;function h6(t){return t instanceof Date&&!isNaN(t)}function sB(t=0,n,e=uX){let i=-1;return null!=n&&(Su(n)?e=n:i=n),new Hr(s=>{let l=h6(t)?+t-e.now():t;l<0&&(l=0);let h=0;return e.schedule(function(){s.closed||(s.next(h++),0<=i?this.schedule(void 0,i):s.complete())},l)})}const{isArray:hX}=Array;function d6(t){return 1===t.length&&hX(t[0])?t[0]:t}function MO(...t){return 1===(t=d6(t)).length?gn(t[0]):new Hr(function dX(t){return n=>{let e=[];for(let i=0;e&&!n.closed&&i<t.length;i++)e.push(gn(t[i]).subscribe(Kr(n,s=>{if(e){for(let l=0;l<e.length;l++)l!==i&&e[l].unsubscribe();e=null}n.next(s)})))}}(t))}function FO(...t){const n=ad(t),e=d6(t);return e.length?new Hr(i=>{let s=e.map(()=>[]),l=e.map(()=>!1);i.add(()=>{s=l=null});for(let h=0;!i.closed&&h<e.length;h++)gn(e[h]).subscribe(Kr(i,m=>{if(s[h].push(m),s.every(b=>b.length)){const b=s.map(E=>E.shift());i.next(n?n(...b):b),s.some((E,M)=>!E.length&&l[M])&&i.complete()}},()=>{l[h]=!0,!s[h].length&&i.complete()}));return()=>{s=l=null}}):Fo}function RO(...t){const n=ad(t);return Xs((e,i)=>{const s=t.length,l=new Array(s);let h=t.map(()=>!1),m=!1;for(let b=0;b<s;b++)gn(t[b]).subscribe(Kr(i,E=>{l[b]=E,!m&&!h[b]&&(h[b]=!0,(m=h.every(ir))&&(h=null))},Sa));e.subscribe(Kr(i,b=>{if(m){const E=[b,...l];i.next(n?n(...E):E)}}))})}function f6(t,n){return n?e=>tx(n.pipe(Xo(1),function AX(){return Xs((t,n)=>{t.subscribe(Kr(n,Sa))})}()),e.pipe(f6(t))):es((e,i)=>gn(t(e,i)).pipe(Xo(1),sU(e)))}function EE(t,n=dx){const e=sB(t,n);return f6(()=>e)}let C6=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Wh),Ve(ao))};static#t=this.\u0275dir=Xn({type:t})}return t})(),B1=(()=>{class t extends C6{static#e=this.\u0275fac=function(){let e;return function(s){return(e||(e=Ms(t)))(s||t)}}();static#t=this.\u0275dir=Xn({type:t,features:[Ho]})}return t})();const dA=new pi("NgValueAccessor"),RX={provide:dA,useExisting:Nr(()=>LO),multi:!0};let LO=(()=>{class t extends B1{writeValue(e){this.setProperty("checked",e)}static#e=this.\u0275fac=function(){let e;return function(s){return(e||(e=Ms(t)))(s||t)}}();static#t=this.\u0275dir=Xn({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,s){1&i&&Tt("change",function(h){return s.onChange(h.target.checked)})("blur",function(){return s.onTouched()})},features:[Qo([RX]),Ho]})}return t})();const OX={provide:dA,useExisting:Nr(()=>oc),multi:!0},PX=new pi("CompositionEventMode");let oc=(()=>{class t extends C6{constructor(e,i,s){super(e,i),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function kX(){const t=By()?By().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Wh),Ve(ao),Ve(PX,8))};static#t=this.\u0275dir=Xn({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){1&i&&Tt("input",function(h){return s._handleInput(h.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(h){return s._compositionEnd(h.target.value)})},features:[Qo([OX]),Ho]})}return t})();const wh=new pi("NgValidators"),Py=new pi("NgAsyncValidators");function O6(t){return null!=t}function k6(t){return v1(t)?Gs(t):t}function P6(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function N6(t,n){return n.map(e=>e(t))}function L6(t){return t.map(n=>function LX(t){return!t.validate}(n)?n:e=>n.validate(e))}function UO(t){return null!=t?function U6(t){if(!t)return null;const n=t.filter(O6);return 0==n.length?null:function(e){return P6(N6(e,n))}}(L6(t)):null}function zO(t){return null!=t?function z6(t){if(!t)return null;const n=t.filter(O6);return 0==n.length?null:function(e){return function FX(...t){const n=ad(t),{args:e,keys:i}=tU(t),s=new Hr(l=>{const{length:h}=e;if(!h)return void l.complete();const m=new Array(h);let b=h,E=h;for(let M=0;M<h;M++){let L=!1;gn(e[M]).subscribe(Kr(l,G=>{L||(L=!0,E--),m[M]=G},()=>b--,void 0,()=>{(!b||!L)&&(E||l.next(i?nU(i,m):m),l.complete())}))}});return n?s.pipe(rO(n)):s}(N6(e,n).map(k6)).pipe(Ht(P6))}}(L6(t)):null}function V6(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function H6(t){return t._rawValidators}function Q6(t){return t._rawAsyncValidators}function VO(t){return t?Array.isArray(t)?t:[t]:[]}function uB(t,n){return Array.isArray(t)?t.includes(n):t===n}function j6(t,n){const e=VO(n);return VO(t).forEach(s=>{uB(e,s)||e.push(s)}),e}function G6(t,n){return VO(n).filter(e=>!uB(t,e))}class $6{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=UO(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=zO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class Bd extends $6{get formDirective(){return null}get path(){return null}}class Ny extends $6{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class q6{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Jc=(()=>{class t extends q6{constructor(e){super(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Ny,2))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){2&i&&Dt("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Ho]})}return t})(),Md=(()=>{class t extends q6{constructor(e){super(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Bd,10))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){2&i&&Dt("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Ho]})}return t})();const TE="VALID",dB="INVALID",Ax="PENDING",IE="DISABLED";function jO(t){return(fB(t)?t.validators:t)||null}function GO(t,n){return(fB(n)?n.asyncValidators:t)||null}function fB(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class X6{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===TE}get invalid(){return this.status===dB}get pending(){return this.status==Ax}get disabled(){return this.status===IE}get enabled(){return this.status!==IE}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(j6(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(j6(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(G6(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(G6(n,this._rawAsyncValidators))}hasValidator(n){return uB(this._rawValidators,n)}hasAsyncValidator(n){return uB(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=Ax,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=IE,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=TE,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===TE||this.status===Ax)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?IE:TE}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=Ax,this._hasOwnPendingAsyncValidator=!0;const e=k6(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,s)=>i&&i._find(s),this)}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new vi,this.statusChanges=new vi}_calculateStatus(){return this._allControlsDisabled()?IE:this.errors?dB:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ax)?Ax:this._anyControlsHaveStatus(dB)?dB:TE}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){fB(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function HX(t){return Array.isArray(t)?UO(t):t||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function QX(t){return Array.isArray(t)?zO(t):t||null}(this._rawAsyncValidators)}}class $O extends X6{constructor(n,e,i){super(jO(e),GO(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){(function Z6(t,n,e){t._forEachChild((i,s)=>{if(void 0===e[s])throw new ln(1002,"")})})(this,0,n),Object.keys(n).forEach(i=>{(function W6(t,n,e){const i=t.controls;if(!(n?Object.keys(i):i).length)throw new ln(1e3,"");if(!i[e])throw new ln(1001,"")})(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{const s=this.controls[i];s&&s.patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,s)=>{i.reset(n?n[s]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,s)=>((i.enabled||this.disabled)&&(e[s]=i.value),e))}_reduceChildren(n,e){let i=n;return this._forEachChild((s,l)=>{i=e(i,s,l)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}const M1=new pi("CallSetDisabledState",{providedIn:"root",factory:()=>DE}),DE="always";function BE(t,n,e=DE){qO(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||"always"===e)&&n.valueAccessor.setDisabledState?.(t.disabled),function $X(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Y6(t,n)})}(t,n),function KX(t,n){const e=(i,s)=>{n.valueAccessor.writeValue(i),s&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function qX(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Y6(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function GX(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function pB(t,n,e=!0){const i=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(i),n.valueAccessor.registerOnTouched(i)),function mB(t,n){let e=!1;if(null!==t){if(null!==n.validator){const s=H6(t);if(Array.isArray(s)&&s.length>0){const l=s.filter(h=>h!==n.validator);l.length!==s.length&&(e=!0,t.setValidators(l))}}if(null!==n.asyncValidator){const s=Q6(t);if(Array.isArray(s)&&s.length>0){const l=s.filter(h=>h!==n.asyncValidator);l.length!==s.length&&(e=!0,t.setAsyncValidators(l))}}}const i=()=>{};return gB(n._rawValidators,i),gB(n._rawAsyncValidators,i),e}(t,n),t&&(n._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function gB(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function qO(t,n){const e=H6(t);null!==n.validator?t.setValidators(V6(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=Q6(t);null!==n.asyncValidator?t.setAsyncValidators(V6(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const s=()=>t.updateValueAndValidity();gB(n._rawValidators,s),gB(n._rawAsyncValidators,s)}function Y6(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function WO(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}function ZO(t,n){if(!n)return null;let e,i,s;return Array.isArray(n),n.forEach(l=>{l.constructor===oc?e=l:function XX(t){return Object.getPrototypeOf(t.constructor)===B1}(l)?i=l:s=l}),s||i||e||null}const JX={provide:Bd,useExisting:Nr(()=>xh)},ME=(()=>Promise.resolve())();let xh=(()=>{class t extends Bd{constructor(e,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new vi,this.form=new $O({},UO(e),zO(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){ME.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),BE(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){ME.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){ME.then(()=>{const i=this._findContainer(e.path),s=new $O({});(function J6(t,n){qO(t,n)})(s,e),i.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){ME.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){ME.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function ez(t,n){t._syncPendingControls(),n.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(wh,10),Ve(Py,10),Ve(M1,8))};static#t=this.\u0275dir=Xn({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){1&i&&Tt("submit",function(h){return s.onSubmit(h)})("reset",function(){return s.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Qo([JX]),Ho]})}return t})();function tz(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function nz(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const F1=class extends X6{constructor(n=null,e,i){super(jO(e),GO(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),fB(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=nz(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){tz(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){tz(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){nz(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},nY={provide:Ny,useExisting:Nr(()=>Qu)},sz=(()=>Promise.resolve())();let Qu=(()=>{class t extends Ny{constructor(e,i,s,l,h,m){super(),this._changeDetectorRef=h,this.callSetDisabledState=m,this.control=new F1,this._registered=!1,this.name="",this.update=new vi,this._parent=e,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=ZO(0,l)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),WO(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){BE(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){sz.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,s=0!==i&&Xw(i);sz.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function AB(t,n){return[...n.path,t]}(e,this._parent):[e]}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Bd,9),Ve(wh,10),Ve(Py,10),Ve(dA,10),Ve(gf,8),Ve(M1,8))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Qo([nY]),Ho,Zo]})}return t})(),Fd=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=Xn({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return t})();const rY={provide:dA,useExisting:Nr(()=>XO),multi:!0};let az=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),sY=(()=>{class t{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:az})}return t})(),XO=(()=>{class t extends B1{constructor(e,i,s,l){super(e,i),this._registry=s,this._injector=l,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=In(M1,{optional:!0})??DE}ngOnInit(){this._control=this._injector.get(Ny),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}setDisabledState(e){(this.setDisabledStateFired||e||"whenDisabledForLegacyCode"===this.callSetDisabledState)&&this.setProperty("disabled",e),this.setDisabledStateFired=!0}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Wh),Ve(ao),Ve(sY),Ve(Zc))};static#t=this.\u0275dir=Xn({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(i,s){1&i&&Tt("change",function(){return s.onChange()})("blur",function(){return s.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Qo([rY]),Ho]})}return t})();const YO=new pi("NgModelWithFormControlWarning"),aY={provide:Ny,useExisting:Nr(()=>FE)};let FE=(()=>{class t extends Ny{set isDisabled(e){}static#e=this._ngModelWarningSentOnce=!1;constructor(e,i,s,l,h){super(),this._ngModelWarningConfig=l,this.callSetDisabledState=h,this.update=new vi,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(i),this.valueAccessor=ZO(0,s)}ngOnChanges(e){if(this._isControlChanged(e)){const i=e.form.previousValue;i&&pB(i,this,!1),BE(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}WO(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&pB(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}static#t=this.\u0275fac=function(i){return new(i||t)(Ve(wh,10),Ve(Py,10),Ve(dA,10),Ve(YO,8),Ve(M1,8))};static#n=this.\u0275dir=Xn({type:t,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Qo([aY]),Ho,Zo]})}return t})(),wz=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({imports:[az]})}return t})(),TY=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:M1,useValue:e.callSetDisabledState??DE}]}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({imports:[wz]})}return t})(),IY=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:YO,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:M1,useValue:e.callSetDisabledState??DE}]}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({imports:[wz]})}return t})();var DY={left:"right",right:"left",bottom:"top",top:"bottom"};function _B(t){return t.replace(/left|right|bottom|top/g,function(n){return DY[n]})}function Nm(t){return t.split("-")[0]}var BY={start:"end",end:"start"};function xz(t){return t.replace(/start|end/g,function(n){return BY[n]})}var fA="top",lg="bottom",cg="right",AA="left",sk="auto",RE=[fA,lg,cg,AA],px="start",OE="end",Cz="viewport",kE="popper",Ez=RE.reduce(function(t,n){return t.concat([n+"-"+px,n+"-"+OE])},[]),Sz=[].concat(RE,[sk]).reduce(function(t,n){return t.concat([n,n+"-"+px,n+"-"+OE])},[]),HY=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function pA(t){if(null==t)return window;if("[object Window]"!==t.toString()){var n=t.ownerDocument;return n&&n.defaultView||window}return t}function O1(t){return t instanceof pA(t).Element||t instanceof Element}function op(t){return t instanceof pA(t).HTMLElement||t instanceof HTMLElement}function ok(t){return!(typeof ShadowRoot>"u")&&(t instanceof pA(t).ShadowRoot||t instanceof ShadowRoot)}function Ly(t){return((O1(t)?t.ownerDocument:t.document)||window.document).documentElement}var k1=Math.max,yB=Math.min,gx=Math.round;function ak(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(n){return n.brand+"/"+n.version}).join(" "):navigator.userAgent}function Tz(){return!/^((?!chrome|android).)*safari/i.test(ak())}function mx(t,n,e){void 0===n&&(n=!1),void 0===e&&(e=!1);var i=t.getBoundingClientRect(),s=1,l=1;n&&op(t)&&(s=t.offsetWidth>0&&gx(i.width)/t.offsetWidth||1,l=t.offsetHeight>0&&gx(i.height)/t.offsetHeight||1);var m=(O1(t)?pA(t):window).visualViewport,b=!Tz()&&e,E=(i.left+(b&&m?m.offsetLeft:0))/s,M=(i.top+(b&&m?m.offsetTop:0))/l,L=i.width/s,G=i.height/l;return{width:L,height:G,top:M,right:E+L,bottom:M+G,left:E,x:E,y:M}}function lk(t){var n=pA(t);return{scrollLeft:n.pageXOffset,scrollTop:n.pageYOffset}}function ck(t){return mx(Ly(t)).left+lk(t).scrollLeft}function h0(t){return pA(t).getComputedStyle(t)}function Lm(t){return t?(t.nodeName||"").toLowerCase():null}function vB(t){return"html"===Lm(t)?t:t.assignedSlot||t.parentNode||(ok(t)?t.host:null)||Ly(t)}function uk(t){var n=h0(t);return/auto|scroll|overlay|hidden/.test(n.overflow+n.overflowY+n.overflowX)}function Iz(t){return["html","body","#document"].indexOf(Lm(t))>=0?t.ownerDocument.body:op(t)&&uk(t)?t:Iz(vB(t))}function PE(t,n){var e;void 0===n&&(n=[]);var i=Iz(t),s=i===(null==(e=t.ownerDocument)?void 0:e.body),l=pA(i),h=s?[l].concat(l.visualViewport||[],uk(i)?i:[]):i,m=n.concat(h);return s?m:m.concat(PE(vB(h)))}function GY(t){return["table","td","th"].indexOf(Lm(t))>=0}function Dz(t){return op(t)&&"fixed"!==h0(t).position?t.offsetParent:null}function NE(t){for(var n=pA(t),e=Dz(t);e&&GY(e)&&"static"===h0(e).position;)e=Dz(e);return e&&("html"===Lm(e)||"body"===Lm(e)&&"static"===h0(e).position)?n:e||function $Y(t){var n=/firefox/i.test(ak());if(/Trident/i.test(ak())&&op(t)&&"fixed"===h0(t).position)return null;var s=vB(t);for(ok(s)&&(s=s.host);op(s)&&["html","body"].indexOf(Lm(s))<0;){var l=h0(s);if("none"!==l.transform||"none"!==l.perspective||"paint"===l.contain||-1!==["transform","perspective"].indexOf(l.willChange)||n&&"filter"===l.willChange||n&&l.filter&&"none"!==l.filter)return s;s=s.parentNode}return null}(t)||n}function Bz(t,n){var e=n.getRootNode&&n.getRootNode();if(t.contains(n))return!0;if(e&&ok(e)){var i=n;do{if(i&&t.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function hk(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Mz(t,n,e){return n===Cz?hk(function QY(t,n){var e=pA(t),i=Ly(t),s=e.visualViewport,l=i.clientWidth,h=i.clientHeight,m=0,b=0;if(s){l=s.width,h=s.height;var E=Tz();(E||!E&&"fixed"===n)&&(m=s.offsetLeft,b=s.offsetTop)}return{width:l,height:h,x:m+ck(t),y:b}}(t,e)):O1(n)?function qY(t,n){var e=mx(t,!1,"fixed"===n);return e.top=e.top+t.clientTop,e.left=e.left+t.clientLeft,e.bottom=e.top+t.clientHeight,e.right=e.left+t.clientWidth,e.width=t.clientWidth,e.height=t.clientHeight,e.x=e.left,e.y=e.top,e}(n,e):hk(function jY(t){var n,e=Ly(t),i=lk(t),s=null==(n=t.ownerDocument)?void 0:n.body,l=k1(e.scrollWidth,e.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),h=k1(e.scrollHeight,e.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),m=-i.scrollLeft+ck(t),b=-i.scrollTop;return"rtl"===h0(s||e).direction&&(m+=k1(e.clientWidth,s?s.clientWidth:0)-l),{width:l,height:h,x:m,y:b}}(Ly(t)))}function _x(t){return t.split("-")[1]}function dk(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Fz(t){var b,n=t.reference,e=t.element,i=t.placement,s=i?Nm(i):null,l=i?_x(i):null,h=n.x+n.width/2-e.width/2,m=n.y+n.height/2-e.height/2;switch(s){case fA:b={x:h,y:n.y-e.height};break;case lg:b={x:h,y:n.y+n.height};break;case cg:b={x:n.x+n.width,y:m};break;case AA:b={x:n.x-e.width,y:m};break;default:b={x:n.x,y:n.y}}var E=s?dk(s):null;if(null!=E){var M="y"===E?"height":"width";switch(l){case px:b[E]=b[E]-(n[M]/2-e[M]/2);break;case OE:b[E]=b[E]+(n[M]/2-e[M]/2)}}return b}function Oz(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function kz(t,n){return n.reduce(function(e,i){return e[i]=t,e},{})}function fk(t,n){void 0===n&&(n={});var i=n.placement,s=void 0===i?t.placement:i,l=n.strategy,h=void 0===l?t.strategy:l,m=n.boundary,b=void 0===m?"clippingParents":m,E=n.rootBoundary,M=void 0===E?Cz:E,L=n.elementContext,G=void 0===L?kE:L,V=n.altBoundary,ne=void 0!==V&&V,re=n.padding,de=void 0===re?0:re,fe=Oz("number"!=typeof de?de:kz(de,RE)),Ne=t.rects.popper,We=t.elements[ne?G===kE?"reference":kE:G],pt=function WY(t,n,e,i){var s="clippingParents"===n?function KY(t){var n=PE(vB(t)),i=["absolute","fixed"].indexOf(h0(t).position)>=0&&op(t)?NE(t):t;return O1(i)?n.filter(function(s){return O1(s)&&Bz(s,i)&&"body"!==Lm(s)}):[]}(t):[].concat(n),l=[].concat(s,[e]),m=l.reduce(function(b,E){var M=Mz(t,E,i);return b.top=k1(M.top,b.top),b.right=yB(M.right,b.right),b.bottom=yB(M.bottom,b.bottom),b.left=k1(M.left,b.left),b},Mz(t,l[0],i));return m.width=m.right-m.left,m.height=m.bottom-m.top,m.x=m.left,m.y=m.top,m}(O1(We)?We:We.contextElement||Ly(t.elements.popper),b,M,h),Qt=mx(t.elements.reference),yt=Fz({reference:Qt,element:Ne,strategy:"absolute",placement:s}),Ye=hk(Object.assign({},Ne,yt)),un=G===kE?Ye:Qt,hn={top:pt.top-un.top+fe.top,bottom:un.bottom-pt.bottom+fe.bottom,left:pt.left-un.left+fe.left,right:un.right-pt.right+fe.right},Ue=t.modifiersData.offset;if(G===kE&&Ue){var ze=Ue[s];Object.keys(hn).forEach(function(ut){var lt=[cg,lg].indexOf(ut)>=0?1:-1,_n=[fA,lg].indexOf(ut)>=0?"y":"x";hn[ut]+=ze[_n]*lt})}return hn}const JY={name:"flip",enabled:!0,phase:"main",fn:function YY(t){var n=t.state,e=t.options,i=t.name;if(!n.modifiersData[i]._skip){for(var s=e.mainAxis,l=void 0===s||s,h=e.altAxis,m=void 0===h||h,b=e.fallbackPlacements,E=e.padding,M=e.boundary,L=e.rootBoundary,G=e.altBoundary,V=e.flipVariations,ne=void 0===V||V,re=e.allowedAutoPlacements,de=n.options.placement,fe=Nm(de),Ne=b||(fe!==de&&ne?function XY(t){if(Nm(t)===sk)return[];var n=_B(t);return[xz(t),n,xz(n)]}(de):[_B(de)]),We=[de].concat(Ne).reduce(function(Je,_t){return Je.concat(Nm(_t)===sk?function ZY(t,n){void 0===n&&(n={});var s=n.boundary,l=n.rootBoundary,h=n.padding,m=n.flipVariations,b=n.allowedAutoPlacements,E=void 0===b?Sz:b,M=_x(n.placement),L=M?m?Ez:Ez.filter(function(ne){return _x(ne)===M}):RE,G=L.filter(function(ne){return E.indexOf(ne)>=0});0===G.length&&(G=L);var V=G.reduce(function(ne,re){return ne[re]=fk(t,{placement:re,boundary:s,rootBoundary:l,padding:h})[Nm(re)],ne},{});return Object.keys(V).sort(function(ne,re){return V[ne]-V[re]})}(n,{placement:_t,boundary:M,rootBoundary:L,padding:E,flipVariations:ne,allowedAutoPlacements:re}):_t)},[]),pt=n.rects.reference,Qt=n.rects.popper,yt=new Map,Ye=!0,un=We[0],hn=0;hn<We.length;hn++){var Ue=We[hn],ze=Nm(Ue),ut=_x(Ue)===px,lt=[fA,lg].indexOf(ze)>=0,_n=lt?"width":"height",ft=fk(n,{placement:Ue,boundary:M,rootBoundary:L,altBoundary:G,padding:E}),Ot=lt?ut?cg:AA:ut?lg:fA;pt[_n]>Qt[_n]&&(Ot=_B(Ot));var wt=_B(Ot),Yt=[];if(l&&Yt.push(ft[ze]<=0),m&&Yt.push(ft[Ot]<=0,ft[wt]<=0),Yt.every(function(Je){return Je})){un=Ue,Ye=!1;break}yt.set(Ue,Yt)}if(Ye)for(var Ti=function(_t){var Nt=We.find(function(jt){var en=yt.get(jt);if(en)return en.slice(0,_t).every(function(sn){return sn})});if(Nt)return un=Nt,"break"},Se=ne?3:1;Se>0&&"break"!==Ti(Se);Se--);n.placement!==un&&(n.modifiersData[i]._skip=!0,n.placement=un,n.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function LE(t,n,e){return k1(t,yB(n,e))}function Ak(t){var n=mx(t),e=t.offsetWidth,i=t.offsetHeight;return Math.abs(n.width-e)<=1&&(e=n.width),Math.abs(n.height-i)<=1&&(i=n.height),{x:t.offsetLeft,y:t.offsetTop,width:e,height:i}}const iJ={name:"preventOverflow",enabled:!0,phase:"main",fn:function nJ(t){var n=t.state,e=t.options,i=t.name,s=e.mainAxis,l=void 0===s||s,h=e.altAxis,m=void 0!==h&&h,G=e.tether,V=void 0===G||G,ne=e.tetherOffset,re=void 0===ne?0:ne,de=fk(n,{boundary:e.boundary,rootBoundary:e.rootBoundary,padding:e.padding,altBoundary:e.altBoundary}),fe=Nm(n.placement),he=_x(n.placement),Ne=!he,We=dk(fe),pt=function eJ(t){return"x"===t?"y":"x"}(We),Qt=n.modifiersData.popperOffsets,yt=n.rects.reference,Ye=n.rects.popper,un="function"==typeof re?re(Object.assign({},n.rects,{placement:n.placement})):re,hn="number"==typeof un?{mainAxis:un,altAxis:un}:Object.assign({mainAxis:0,altAxis:0},un),Ue=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,ze={x:0,y:0};if(Qt){if(l){var ut,lt="y"===We?fA:AA,_n="y"===We?lg:cg,ft="y"===We?"height":"width",Ot=Qt[We],wt=Ot+de[lt],Yt=Ot-de[_n],pn=V?-Ye[ft]/2:0,Ti=he===px?yt[ft]:Ye[ft],Se=he===px?-Ye[ft]:-yt[ft],Xe=n.elements.arrow,Je=V&&Xe?Ak(Xe):{width:0,height:0},_t=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Nt=_t[lt],jt=_t[_n],en=LE(0,yt[ft],Je[ft]),sn=Ne?yt[ft]/2-pn-en-Nt-hn.mainAxis:Ti-en-Nt-hn.mainAxis,bi=Ne?-yt[ft]/2+pn+en+jt+hn.mainAxis:Se+en+jt+hn.mainAxis,di=n.elements.arrow&&NE(n.elements.arrow),Yi=di?"y"===We?di.clientTop||0:di.clientLeft||0:0,Ji=null!=(ut=Ue?.[We])?ut:0,Fn=Ot+bi-Ji,at=LE(V?yB(wt,Ot+sn-Ji-Yi):wt,Ot,V?k1(Yt,Fn):Yt);Qt[We]=at,ze[We]=at-Ot}if(m){var Rs,Ii=Qt[pt],Qi="y"===pt?"height":"width",Vi=Ii+de["x"===We?fA:AA],Rr=Ii-de["x"===We?lg:cg],xs=-1!==[fA,AA].indexOf(fe),zs=null!=(Rs=Ue?.[pt])?Rs:0,io=xs?Vi:Ii-yt[Qi]-Ye[Qi]-zs+hn.altAxis,Do=xs?Ii+yt[Qi]+Ye[Qi]-zs-hn.altAxis:Rr,aa=V&&xs?function tJ(t,n,e){var i=LE(t,n,e);return i>e?e:i}(io,Ii,Do):LE(V?io:Vi,Ii,V?Do:Rr);Qt[pt]=aa,ze[pt]=aa-Ii}n.modifiersData[i]=ze}},requiresIfExists:["offset"]},aJ={name:"arrow",enabled:!0,phase:"main",fn:function sJ(t){var n,e=t.state,i=t.name,s=t.options,l=e.elements.arrow,h=e.modifiersData.popperOffsets,m=Nm(e.placement),b=dk(m),M=[AA,cg].indexOf(m)>=0?"height":"width";if(l&&h){var L=function(n,e){return Oz("number"!=typeof(n="function"==typeof n?n(Object.assign({},e.rects,{placement:e.placement})):n)?n:kz(n,RE))}(s.padding,e),G=Ak(l),V="y"===b?fA:AA,ne="y"===b?lg:cg,re=e.rects.reference[M]+e.rects.reference[b]-h[b]-e.rects.popper[M],de=h[b]-e.rects.reference[b],fe=NE(l),he=fe?"y"===b?fe.clientHeight||0:fe.clientWidth||0:0,Qt=he/2-G[M]/2+(re/2-de/2),yt=LE(L[V],Qt,he-G[M]-L[ne]);e.modifiersData[i]=((n={})[b]=yt,n.centerOffset=yt-Qt,n)}},effect:function oJ(t){var n=t.state,i=t.options.element,s=void 0===i?"[data-popper-arrow]":i;null!=s&&("string"==typeof s&&!(s=n.elements.popper.querySelector(s))||Bz(n.elements.popper,s)&&(n.elements.arrow=s))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function hJ(t,n,e){void 0===e&&(e=!1);var i=op(n),s=op(n)&&function uJ(t){var n=t.getBoundingClientRect(),e=gx(n.width)/t.offsetWidth||1,i=gx(n.height)/t.offsetHeight||1;return 1!==e||1!==i}(n),l=Ly(n),h=mx(t,s,e),m={scrollLeft:0,scrollTop:0},b={x:0,y:0};return(i||!i&&!e)&&(("body"!==Lm(n)||uk(l))&&(m=function cJ(t){return t!==pA(t)&&op(t)?function lJ(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}(t):lk(t)}(n)),op(n)?((b=mx(n,!0)).x+=n.clientLeft,b.y+=n.clientTop):l&&(b.x=ck(l))),{x:h.left+m.scrollLeft-b.x,y:h.top+m.scrollTop-b.y,width:h.width,height:h.height}}function dJ(t){var n=new Map,e=new Set,i=[];function s(l){e.add(l.name),[].concat(l.requires||[],l.requiresIfExists||[]).forEach(function(m){if(!e.has(m)){var b=n.get(m);b&&s(b)}}),i.push(l)}return t.forEach(function(l){n.set(l.name,l)}),t.forEach(function(l){e.has(l.name)||s(l)}),i}function AJ(t){var n;return function(){return n||(n=new Promise(function(e){Promise.resolve().then(function(){n=void 0,e(t())})})),n}}var Pz={placement:"bottom",modifiers:[],strategy:"absolute"};function Nz(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return!n.some(function(i){return!(i&&"function"==typeof i.getBoundingClientRect)})}function gJ(t){void 0===t&&(t={});var e=t.defaultModifiers,i=void 0===e?[]:e,s=t.defaultOptions,l=void 0===s?Pz:s;return function(m,b,E){void 0===E&&(E=l);var M={placement:"bottom",orderedModifiers:[],options:Object.assign({},Pz,l),modifiersData:{},elements:{reference:m,popper:b},attributes:{},styles:{}},L=[],G=!1,V={state:M,setOptions:function(fe){var he="function"==typeof fe?fe(M.options):fe;re(),M.options=Object.assign({},l,M.options,he),M.scrollParents={reference:O1(m)?PE(m):m.contextElement?PE(m.contextElement):[],popper:PE(b)};var Ne=function fJ(t){var n=dJ(t);return HY.reduce(function(e,i){return e.concat(n.filter(function(s){return s.phase===i}))},[])}(function pJ(t){var n=t.reduce(function(e,i){var s=e[i.name];return e[i.name]=s?Object.assign({},s,i,{options:Object.assign({},s.options,i.options),data:Object.assign({},s.data,i.data)}):i,e},{});return Object.keys(n).map(function(e){return n[e]})}([].concat(i,M.options.modifiers)));return M.orderedModifiers=Ne.filter(function(We){return We.enabled}),function ne(){M.orderedModifiers.forEach(function(de){var he=de.options,We=de.effect;if("function"==typeof We){var pt=We({state:M,name:de.name,instance:V,options:void 0===he?{}:he});L.push(pt||function(){})}})}(),V.update()},forceUpdate:function(){if(!G){var fe=M.elements,he=fe.reference,Ne=fe.popper;if(Nz(he,Ne)){M.rects={reference:hJ(he,NE(Ne),"fixed"===M.options.strategy),popper:Ak(Ne)},M.reset=!1,M.placement=M.options.placement,M.orderedModifiers.forEach(function(hn){return M.modifiersData[hn.name]=Object.assign({},hn.data)});for(var We=0;We<M.orderedModifiers.length;We++)if(!0!==M.reset){var pt=M.orderedModifiers[We],Qt=pt.fn,yt=pt.options;"function"==typeof Qt&&(M=Qt({state:M,options:void 0===yt?{}:yt,name:pt.name,instance:V})||M)}else M.reset=!1,We=-1}}},update:AJ(function(){return new Promise(function(de){V.forceUpdate(),de(M)})}),destroy:function(){re(),G=!0}};if(!Nz(m,b))return V;function re(){L.forEach(function(de){return de()}),L=[]}return V.setOptions(E).then(function(de){!G&&E.onFirstUpdate&&E.onFirstUpdate(de)}),V}}var bB={passive:!0};const _J={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function mJ(t){var n=t.state,e=t.instance,i=t.options,s=i.scroll,l=void 0===s||s,h=i.resize,m=void 0===h||h,b=pA(n.elements.popper),E=[].concat(n.scrollParents.reference,n.scrollParents.popper);return l&&E.forEach(function(M){M.addEventListener("scroll",e.update,bB)}),m&&b.addEventListener("resize",e.update,bB),function(){l&&E.forEach(function(M){M.removeEventListener("scroll",e.update,bB)}),m&&b.removeEventListener("resize",e.update,bB)}},data:{}},vJ={name:"popperOffsets",enabled:!0,phase:"read",fn:function yJ(t){var n=t.state;n.modifiersData[t.name]=Fz({reference:n.rects.reference,element:n.rects.popper,strategy:"absolute",placement:n.placement})},data:{}};var bJ={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Lz(t){var n,e=t.popper,i=t.popperRect,s=t.placement,l=t.variation,h=t.offsets,m=t.position,b=t.gpuAcceleration,E=t.adaptive,M=t.roundOffsets,L=t.isFixed,G=h.x,V=void 0===G?0:G,ne=h.y,re=void 0===ne?0:ne,de="function"==typeof M?M({x:V,y:re}):{x:V,y:re};V=de.x,re=de.y;var fe=h.hasOwnProperty("x"),he=h.hasOwnProperty("y"),Ne=AA,We=fA,pt=window;if(E){var Qt=NE(e),yt="clientHeight",Ye="clientWidth";Qt===pA(e)&&"static"!==h0(Qt=Ly(e)).position&&"absolute"===m&&(yt="scrollHeight",Ye="scrollWidth"),(s===fA||(s===AA||s===cg)&&l===OE)&&(We=lg,re-=(L&&Qt===pt&&pt.visualViewport?pt.visualViewport.height:Qt[yt])-i.height,re*=b?1:-1),s!==AA&&(s!==fA&&s!==lg||l!==OE)||(Ne=cg,V-=(L&&Qt===pt&&pt.visualViewport?pt.visualViewport.width:Qt[Ye])-i.width,V*=b?1:-1)}var ut,Ue=Object.assign({position:m},E&&bJ),ze=!0===M?function wJ(t,n){var i=t.y,s=n.devicePixelRatio||1;return{x:gx(t.x*s)/s||0,y:gx(i*s)/s||0}}({x:V,y:re},pA(e)):{x:V,y:re};return V=ze.x,re=ze.y,Object.assign({},Ue,b?((ut={})[We]=he?"0":"",ut[Ne]=fe?"0":"",ut.transform=(pt.devicePixelRatio||1)<=1?"translate("+V+"px, "+re+"px)":"translate3d("+V+"px, "+re+"px, 0)",ut):((n={})[We]=he?re+"px":"",n[Ne]=fe?V+"px":"",n.transform="",n))}const CJ={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function xJ(t){var n=t.state,e=t.options,i=e.gpuAcceleration,s=void 0===i||i,l=e.adaptive,h=void 0===l||l,m=e.roundOffsets,b=void 0===m||m,E={placement:Nm(n.placement),variation:_x(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:s,isFixed:"fixed"===n.options.strategy};null!=n.modifiersData.popperOffsets&&(n.styles.popper=Object.assign({},n.styles.popper,Lz(Object.assign({},E,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:h,roundOffsets:b})))),null!=n.modifiersData.arrow&&(n.styles.arrow=Object.assign({},n.styles.arrow,Lz(Object.assign({},E,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:b})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})},data:{}};var TJ=[_J,vJ,CJ,{name:"applyStyles",enabled:!0,phase:"write",fn:function EJ(t){var n=t.state;Object.keys(n.elements).forEach(function(e){var i=n.styles[e]||{},s=n.attributes[e]||{},l=n.elements[e];!op(l)||!Lm(l)||(Object.assign(l.style,i),Object.keys(s).forEach(function(h){var m=s[h];!1===m?l.removeAttribute(h):l.setAttribute(h,!0===m?"":m)}))})},effect:function SJ(t){var n=t.state,e={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(n.elements.popper.style,e.popper),n.styles=e,n.elements.arrow&&Object.assign(n.elements.arrow.style,e.arrow),function(){Object.keys(n.elements).forEach(function(i){var s=n.elements[i],l=n.attributes[i]||{},m=Object.keys(n.styles.hasOwnProperty(i)?n.styles[i]:e[i]).reduce(function(b,E){return b[E]="",b},{});!op(s)||!Lm(s)||(Object.assign(s.style,m),Object.keys(l).forEach(function(b){s.removeAttribute(b)}))})}},requires:["computeStyles"]}],IJ=gJ({defaultModifiers:TJ});const MJ={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function BJ(t){var n=t.state,i=t.name,s=t.options.offset,l=void 0===s?[0,0]:s,h=Sz.reduce(function(M,L){return M[L]=function DJ(t,n,e){var i=Nm(t),s=[AA,fA].indexOf(i)>=0?-1:1,l="function"==typeof e?e(Object.assign({},n,{placement:t})):e,h=l[0],m=l[1];return h=h||0,m=(m||0)*s,[AA,cg].indexOf(i)>=0?{x:m,y:h}:{x:h,y:m}}(L,n.rects,l),M},{}),m=h[n.placement],E=m.y;null!=n.modifiersData.popperOffsets&&(n.modifiersData.popperOffsets.x+=m.x,n.modifiersData.popperOffsets.y+=E),n.modifiersData[i]=h}},UJ=["*"],VJ=["ngbDatepickerDayView",""],HJ=["month"],QJ=["year"];function jJ(t,n){if(1&t&&(pe(0,"option",5),et(1),ye()),2&t){const e=n.$implicit,i=dn();st("value",e),To("aria-label",i.i18n.getMonthFullName(e,i.date.year)),$e(1),wr(i.i18n.getMonthShortName(e,i.date.year))}}function GJ(t,n){if(1&t&&(pe(0,"option",5),et(1),ye()),2&t){const e=n.$implicit,i=dn();st("value",e),$e(1),wr(i.i18n.getYearNumerals(e))}}function $J(t,n){if(1&t){const e=xr();pe(0,"ngb-datepicker-navigation-select",7),Tt("select",function(s){return ti(e),ni(dn().select.emit(s))}),ye()}if(2&t){const e=dn();st("date",e.date)("disabled",e.disabled)("months",e.selectBoxes.months)("years",e.selectBoxes.years)}}function qJ(t,n){1&t&&oi(0,"div",11)}function KJ(t,n){1&t&&oi(0,"div",11)}function WJ(t,n){if(1&t&&(En(0,qJ,1,0,"div",9),pe(1,"div",10),et(2),ye(),En(3,KJ,1,0,"div",9)),2&t){const e=n.$implicit,i=n.index,s=dn(2);st("ngIf",i>0),$e(2),Er(" ",s.i18n.getMonthLabel(e.firstDate)," "),$e(1),st("ngIf",i!==s.months.length-1)}}function ZJ(t,n){1&t&&En(0,WJ,4,3,"ng-template",8),2&t&&st("ngForOf",dn().months)}function XJ(t,n){if(1&t&&(pe(0,"div",5),et(1),ye()),2&t){const e=dn(2);$e(1),wr(e.i18n.getWeekLabel())}}function YJ(t,n){if(1&t&&(pe(0,"div",6),et(1),ye()),2&t){const e=n.$implicit;$e(1),wr(e)}}function JJ(t,n){if(1&t&&(pe(0,"div",2),En(1,XJ,2,1,"div",3),En(2,YJ,2,1,"div",4),ye()),2&t){const e=dn();$e(1),st("ngIf",e.datepicker.showWeekNumbers),$e(1),st("ngForOf",e.viewModel.weekdays)}}function eee(t,n){if(1&t&&(pe(0,"div",11),et(1),ye()),2&t){const e=dn(2).$implicit,i=dn();$e(1),wr(i.i18n.getWeekNumerals(e.number))}}function tee(t,n){}function nee(t,n){if(1&t&&En(0,tee,0,0,"ng-template",14),2&t){const e=dn().$implicit;st("ngTemplateOutlet",dn(3).datepicker.dayTemplate)("ngTemplateOutletContext",e.context)}}function iee(t,n){if(1&t){const e=xr();pe(0,"div",12),Tt("click",function(s){const h=ti(e).$implicit;return dn(3).doSelect(h),ni(s.preventDefault())}),En(1,nee,1,2,"ng-template",13),ye()}if(2&t){const e=n.$implicit;Dt("disabled",e.context.disabled)("hidden",e.hidden)("ngb-dp-today",e.context.today),st("tabindex",e.tabindex),To("aria-label",e.ariaLabel),$e(1),st("ngIf",!e.hidden)}}function ree(t,n){if(1&t&&(pe(0,"div",8),En(1,eee,2,1,"div",9),En(2,iee,2,9,"div",10),ye()),2&t){const e=dn().$implicit,i=dn();$e(1),st("ngIf",i.datepicker.showWeekNumbers),$e(1),st("ngForOf",e.days)}}function see(t,n){1&t&&En(0,ree,3,2,"div",7),2&t&&st("ngIf",!n.$implicit.collapsed)}const oee=["defaultDayTemplate"],aee=["content"];function lee(t,n){if(1&t&&oi(0,"div",8),2&t){const i=n.currentMonth,s=n.selected,l=n.disabled,h=n.focused;st("date",n.date)("currentMonth",i)("selected",s)("disabled",l)("focused",h)}}function cee(t,n){if(1&t&&(pe(0,"div",13),et(1),ye()),2&t){const e=dn().$implicit,i=dn(2);$e(1),Er(" ",i.i18n.getMonthLabel(e.firstDate)," ")}}function uee(t,n){if(1&t&&(pe(0,"div",10),En(1,cee,2,1,"div",11),oi(2,"ngb-datepicker-month",12),ye()),2&t){const e=n.$implicit,i=dn(2);$e(1),st("ngIf","none"===i.navigation||i.displayMonths>1&&"select"===i.navigation),$e(1),st("month",e.firstDate)}}function hee(t,n){1&t&&En(0,uee,3,2,"div",9),2&t&&st("ngForOf",dn().model.months)}function dee(t,n){if(1&t){const e=xr();pe(0,"ngb-datepicker-navigation",14),Tt("navigate",function(s){return ti(e),ni(dn().onNavigateEvent(s))})("select",function(s){return ti(e),ni(dn().onNavigateDateSelect(s))}),ye()}if(2&t){const e=dn();st("date",e.model.firstDate)("months",e.model.months)("disabled",e.model.disabled)("showSelect","select"===e.model.navigation)("prevDisabled",e.model.prevDisabled)("nextDisabled",e.model.nextDisabled)("selectBoxes",e.model.selectBoxes)}}function fee(t,n){}function Aee(t,n){}const Uz=function(t){return{$implicit:t}},pee=["dialog"],gee=["ngbNavOutlet",""];function mee(t,n){}function _ee(t,n){if(1&t&&(pe(0,"div",2),En(1,mee,0,0,"ng-template",3),ye()),2&t){const e=dn().$implicit,i=dn();st("item",e)("nav",i.nav)("role",i.paneRole),$e(1),st("ngTemplateOutlet",(null==e.contentTpl?null:e.contentTpl.templateRef)||null)("ngTemplateOutletContext",C1(5,Uz,e.active||i.isPanelTransitioning(e)))}}function yee(t,n){if(1&t&&En(0,_ee,2,7,"div",1),2&t){const e=n.$implicit,i=dn();st("ngIf",e.isPanelInDom()||i.isPanelTransitioning(e))}}function vee(t,n){1&t&&(pe(0,"span",9),lA(1,10),ye())}function bee(t,n){1&t&&(pe(0,"span",9),lA(1,11),ye())}function wee(t,n){1&t&&(pe(0,"span",9),lA(1,12),ye())}function xee(t,n){1&t&&(pe(0,"span",9),lA(1,13),ye())}function Cee(t,n){1&t&&et(0,"...")}function Eee(t,n){1&t&&et(0),2&t&&wr(n.$implicit)}function See(t,n){}const Tee=function(t){return{disabled:!0,currentPage:t}};function Iee(t,n){if(1&t&&(pe(0,"a",18),En(1,See,0,0,"ng-template",8),ye()),2&t){const e=dn(2).$implicit,i=dn(),s=ws(9);$e(1),st("ngTemplateOutlet",(null==i.tplEllipsis?null:i.tplEllipsis.templateRef)||s)("ngTemplateOutletContext",C1(2,Tee,e))}}function Dee(t,n){}const Bee=function(t,n,e){return{disabled:t,$implicit:n,currentPage:e}};function Mee(t,n){if(1&t){const e=xr();pe(0,"a",19),Tt("click",function(s){ti(e);const l=dn().$implicit;return dn(2).selectPage(l),ni(s.preventDefault())}),En(1,Dee,0,0,"ng-template",8),ye()}if(2&t){const e=dn().$implicit,i=dn(),s=i.disabled,l=i.$implicit,h=dn(),m=ws(11);To("tabindex",s?"-1":null)("aria-disabled",s?"true":null),$e(1),st("ngTemplateOutlet",(null==h.tplNumber?null:h.tplNumber.templateRef)||m)("ngTemplateOutletContext",Y5(4,Bee,s,e,l))}}function Fee(t,n){if(1&t&&(pe(0,"li",15),En(1,Iee,2,4,"a",16),En(2,Mee,2,8,"a",17),ye()),2&t){const e=n.$implicit,i=dn(),s=i.$implicit,l=i.disabled,h=dn();Dt("active",e===s)("disabled",h.isEllipsis(e)||l),To("aria-current",e===s?"page":null),$e(1),st("ngIf",h.isEllipsis(e)),$e(1),st("ngIf",!h.isEllipsis(e))}}function Ree(t,n){1&t&&En(0,Fee,3,7,"li",14),2&t&&st("ngForOf",n.pages)}function Oee(t,n){}const pk=function(t,n){return{disabled:t,currentPage:n}};function kee(t,n){if(1&t){const e=xr();pe(0,"li",15)(1,"a",20),Tt("click",function(s){return ti(e),dn().selectPage(1),ni(s.preventDefault())}),En(2,Oee,0,0,"ng-template",8),ye()()}if(2&t){const e=dn(),i=ws(1);Dt("disabled",e.previousDisabled()),$e(1),To("tabindex",e.previousDisabled()?"-1":null)("aria-disabled",e.previousDisabled()?"true":null),$e(1),st("ngTemplateOutlet",(null==e.tplFirst?null:e.tplFirst.templateRef)||i)("ngTemplateOutletContext",Y2(6,pk,e.previousDisabled(),e.page))}}function Pee(t,n){}const Nee=function(t){return{disabled:t}};function Lee(t,n){if(1&t){const e=xr();pe(0,"li",15)(1,"a",21),Tt("click",function(s){ti(e);const l=dn();return l.selectPage(l.page-1),ni(s.preventDefault())}),En(2,Pee,0,0,"ng-template",8),ye()()}if(2&t){const e=dn(),i=ws(3);Dt("disabled",e.previousDisabled()),$e(1),To("tabindex",e.previousDisabled()?"-1":null)("aria-disabled",e.previousDisabled()?"true":null),$e(1),st("ngTemplateOutlet",(null==e.tplPrevious?null:e.tplPrevious.templateRef)||i)("ngTemplateOutletContext",C1(6,Nee,e.previousDisabled()))}}function Uee(t,n){}function zee(t,n){}function Vee(t,n){if(1&t){const e=xr();pe(0,"li",15)(1,"a",22),Tt("click",function(s){ti(e);const l=dn();return l.selectPage(l.page+1),ni(s.preventDefault())}),En(2,zee,0,0,"ng-template",8),ye()()}if(2&t){const e=dn(),i=ws(5);Dt("disabled",e.nextDisabled()),$e(1),To("tabindex",e.nextDisabled()?"-1":null)("aria-disabled",e.nextDisabled()?"true":null),$e(1),st("ngTemplateOutlet",(null==e.tplNext?null:e.tplNext.templateRef)||i)("ngTemplateOutletContext",Y2(6,pk,e.nextDisabled(),e.page))}}function Hee(t,n){}function Qee(t,n){if(1&t){const e=xr();pe(0,"li",15)(1,"a",23),Tt("click",function(s){ti(e);const l=dn();return l.selectPage(l.pageCount),ni(s.preventDefault())}),En(2,Hee,0,0,"ng-template",8),ye()()}if(2&t){const e=dn(),i=ws(7);Dt("disabled",e.nextDisabled()),$e(1),To("tabindex",e.nextDisabled()?"-1":null)("aria-disabled",e.nextDisabled()?"true":null),$e(1),st("ngTemplateOutlet",(null==e.tplLast?null:e.tplLast.templateRef)||i)("ngTemplateOutletContext",Y2(6,pk,e.nextDisabled(),e.page))}}const jee=function(t,n,e){return{$implicit:t,pages:n,disabled:e}};function Kee(t,n){if(1&t){const e=xr();pe(0,"button",11),Tt("click",function(){ti(e);const s=dn();return ni(s.changeHour(s.hourStep))}),oi(1,"span",12),pe(2,"span",13),lA(3,14),ye()()}if(2&t){const e=dn();Dt("btn-sm",e.isSmallSize)("btn-lg",e.isLargeSize)("disabled",e.disabled),st("disabled",e.disabled)}}function Wee(t,n){if(1&t){const e=xr();pe(0,"button",11),Tt("click",function(){ti(e);const s=dn();return ni(s.changeHour(-s.hourStep))}),oi(1,"span",15),pe(2,"span",13),lA(3,16),ye()()}if(2&t){const e=dn();Dt("btn-sm",e.isSmallSize)("btn-lg",e.isLargeSize)("disabled",e.disabled),st("disabled",e.disabled)}}function Zee(t,n){if(1&t){const e=xr();pe(0,"button",11),Tt("click",function(){ti(e);const s=dn();return ni(s.changeMinute(s.minuteStep))}),oi(1,"span",12),pe(2,"span",13),lA(3,17),ye()()}if(2&t){const e=dn();Dt("btn-sm",e.isSmallSize)("btn-lg",e.isLargeSize)("disabled",e.disabled),st("disabled",e.disabled)}}function Xee(t,n){if(1&t){const e=xr();pe(0,"button",11),Tt("click",function(){ti(e);const s=dn();return ni(s.changeMinute(-s.minuteStep))}),oi(1,"span",15),pe(2,"span",13),lA(3,18),ye()()}if(2&t){const e=dn();Dt("btn-sm",e.isSmallSize)("btn-lg",e.isLargeSize)("disabled",e.disabled),st("disabled",e.disabled)}}function Yee(t,n){1&t&&(pe(0,"div",5),et(1,":"),ye())}function Jee(t,n){if(1&t){const e=xr();pe(0,"button",11),Tt("click",function(){ti(e);const s=dn(2);return ni(s.changeSecond(s.secondStep))}),oi(1,"span",12),pe(2,"span",13),lA(3,21),ye()()}if(2&t){const e=dn(2);Dt("btn-sm",e.isSmallSize)("btn-lg",e.isLargeSize)("disabled",e.disabled),st("disabled",e.disabled)}}function ete(t,n){if(1&t){const e=xr();pe(0,"button",11),Tt("click",function(){ti(e);const s=dn(2);return ni(s.changeSecond(-s.secondStep))}),oi(1,"span",15),pe(2,"span",13),lA(3,22),ye()()}if(2&t){const e=dn(2);Dt("btn-sm",e.isSmallSize)("btn-lg",e.isLargeSize)("disabled",e.disabled),st("disabled",e.disabled)}}function tte(t,n){if(1&t){const e=xr();pe(0,"div",19),En(1,Jee,4,7,"button",3),pe(2,"input",20),Tt("change",function(s){return ti(e),ni(dn().updateSecond(s.target.value))})("blur",function(){return ti(e),ni(dn().handleBlur())})("input",function(s){return ti(e),ni(dn().formatInput(s.target))})("keydown.ArrowUp",function(s){ti(e);const l=dn();return l.changeSecond(l.secondStep),ni(s.preventDefault())})("keydown.ArrowDown",function(s){ti(e);const l=dn();return l.changeSecond(-l.secondStep),ni(s.preventDefault())}),ye(),En(3,ete,4,7,"button",3),ye()}if(2&t){const e=dn();$e(1),st("ngIf",e.spinners),$e(1),Dt("form-control-sm",e.isSmallSize)("form-control-lg",e.isLargeSize),st("value",e.formatMinSec(null==e.model?null:e.model.second))("readOnly",e.readonlyInputs)("disabled",e.disabled),$e(1),st("ngIf",e.spinners)}}function nte(t,n){1&t&&oi(0,"div",5)}function ite(t,n){if(1&t&&(Sy(0),lA(1,27),ga()),2&t){const e=dn(2);$e(1),uD(e.i18n.getAfternoonPeriod()),Q5(1)}}function rte(t,n){1&t&&lA(0,28),2&t&&(uD(dn(2).i18n.getMorningPeriod()),Q5(0))}function ste(t,n){if(1&t){const e=xr();pe(0,"div",23)(1,"button",24),Tt("click",function(){return ti(e),ni(dn().toggleMeridian())}),En(2,ite,2,1,"ng-container",25),En(3,rte,1,1,"ng-template",null,26,Zl),ye()()}if(2&t){const e=ws(4),i=dn();$e(1),Dt("btn-sm",i.isSmallSize)("btn-lg",i.isLargeSize)("disabled",i.disabled),st("disabled",i.disabled),$e(1),st("ngIf",i.model&&i.model.hour>=12)("ngIfElse",e)}}function ate(t,n){if(1&t&&(pe(0,"span"),et(1),ye()),2&t){const e=dn().$implicit;Mn(dn().highlightClass),$e(1),wr(e)}}function lte(t,n){1&t&&et(0),2&t&&wr(dn().$implicit)}function cte(t,n){if(1&t&&(En(0,ate,2,3,"span",1),En(1,lte,1,1,"ng-template",null,2,Zl)),2&t){const e=n.odd,i=ws(2);st("ngIf",e)("ngIfElse",i)}}function Ch(t){return parseInt(`${t}`,10)}function zz(t){return null!=t?`${t}`:""}function P1(t){return"string"==typeof t}function Sc(t){return!isNaN(Ch(t))}function Xl(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}function N1(t){return null!=t}function yx(t){return Sc(t)?`0${t}`.slice(-2):""}function vx(t){return(t||document.body).getBoundingClientRect()}function Hz(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Qz(t=document){const n=t?.activeElement;return n?n.shadowRoot?Qz(n.shadowRoot):n:null}const jz={animation:!0,transitionTimerDelayMs:5},mte=()=>{},{transitionTimerDelayMs:_te}=jz,UE=new Map,mf=(t,n,e,i)=>{let s=i.context||{};const l=UE.get(n);if(l)switch(i.runningTransition){case"continue":return Fo;case"stop":t.run(()=>l.transition$.complete()),s=Object.assign(l.context,s),UE.delete(n)}const h=e(n,i.animation,s)||mte;if(!i.animation||"none"===window.getComputedStyle(n).transitionProperty)return t.run(()=>h()),Bi(void 0).pipe(function pte(t){return n=>new Hr(e=>n.subscribe({next:h=>t.run(()=>e.next(h)),error:h=>t.run(()=>e.error(h)),complete:()=>t.run(()=>e.complete())}))}(t));const m=new Li,b=new Li,E=m.pipe(function fX(...t){return n=>tx(n,Bi(...t))}(!0));UE.set(n,{transition$:m,complete:()=>{b.next(),b.complete()},context:s});const M=function gte(t){const{transitionDelay:n,transitionDuration:e}=window.getComputedStyle(t);return 1e3*(parseFloat(n)+parseFloat(e))}(n);return t.runOutsideAngular(()=>{const L=Ba(n,"transitionend").pipe(Ps(E),Io(({target:V})=>V===n));MO(sB(M+_te).pipe(Ps(E)),L,b).pipe(Ps(E)).subscribe(()=>{UE.delete(n),t.run(()=>{h(),m.next(),m.complete()})})}),m.asObservable()};let wB=(()=>{class t{constructor(){this.animation=jz.animation}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Jz=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),e8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),i8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),r8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})();class bu{static from(n){return n instanceof bu?n:n?new bu(n.year,n.month,n.day):null}constructor(n,e,i){this.year=Xl(n)?n:null,this.month=Xl(e)?e:null,this.day=Xl(i)?i:null}equals(n){return null!=n&&this.year===n.year&&this.month===n.month&&this.day===n.day}before(n){return!!n&&(this.year===n.year?this.month===n.month?this.day!==n.day&&this.day<n.day:this.month<n.month:this.year<n.year)}after(n){return!!n&&(this.year===n.year?this.month===n.month?this.day!==n.day&&this.day>n.day:this.month>n.month:this.year>n.year)}}function bx(t,n){return!function Ite(t,n){return!t&&!n||!!t&&!!n&&t.equals(n)}(t,n)}function s8(t,n){return!(!t&&!n||t&&n&&t.year===n.year&&t.month===n.month)}function CB(t,n,e){return t&&n&&t.before(n)?n:t&&e&&t.after(e)?e:t||null}function vk(t,n){const{minDate:e,maxDate:i,disabled:s,markDisabled:l}=n;return!(null==t||s||l&&l(t,{year:t.year,month:t.month})||e&&t.before(e)||i&&t.after(i))}function o8(t){return new bu(t.getFullYear(),t.getMonth()+1,t.getDate())}function EB(t){const n=new Date(t.year,t.month-1,t.day,12);return isNaN(n.getTime())||n.setFullYear(t.year),n}let SB=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(){return function Nte(){return new Lte}()},providedIn:"root"})}return t})(),Lte=(()=>{class t extends SB{getDaysPerWeek(){return 7}getMonths(){return[1,2,3,4,5,6,7,8,9,10,11,12]}getWeeksPerMonth(){return 6}getNext(e,i="d",s=1){let l=EB(e),h=!0,m=l.getMonth();switch(i){case"y":l.setFullYear(l.getFullYear()+s);break;case"m":m+=s,l.setMonth(m),m%=12,m<0&&(m+=12);break;case"d":l.setDate(l.getDate()+s),h=!1;break;default:return e}return h&&l.getMonth()!==m&&l.setDate(0),o8(l)}getPrev(e,i="d",s=1){return this.getNext(e,i,-s)}getWeekday(e){let s=EB(e).getDay();return 0===s?7:s}getWeekNumber(e,i){7===i&&(i=0);const h=EB(e[(11-i)%7]);h.setDate(h.getDate()+4-(h.getDay()||7));const m=h.getTime();return h.setMonth(0),h.setDate(1),Math.floor(Math.round((m-h.getTime())/864e5)/7)+1}getToday(){return o8(new Date)}isValid(e){if(!(e&&Xl(e.year)&&Xl(e.month)&&Xl(e.day)&&0!==e.year))return!1;const i=EB(e);return!isNaN(i.getTime())&&i.getFullYear()===e.year&&i.getMonth()+1===e.month&&i.getDate()===e.day}static#e=this.\u0275fac=function(){let e;return function(s){return(e||(e=Ms(t)))(s||t)}}();static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})(),U1=(()=>{class t{getMonthLabel(e){return`${this.getMonthFullName(e.month,e.year)} ${this.getYearNumerals(e.year)}`}getDayNumerals(e){return`${e.day}`}getWeekNumerals(e){return`${e}`}getYearNumerals(e){return`${e}`}getWeekLabel(){return""}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(i){let s=null;return s=i?new i:function Ute(t){return new zte(t)}(Xt(uA)),s},providedIn:"root"})}return t})(),zte=(()=>{class t extends U1{constructor(e){super(),this._locale=e,this._monthsShort=BR(e,vu.Standalone,jo.Abbreviated),this._monthsFull=BR(e,vu.Standalone,jo.Wide)}getWeekdayLabel(e,i){const s=g4(this._locale,vu.Standalone,void 0===i?jo.Short:i);return s.map((h,m)=>s[(m+1)%7])[e-1]||""}getMonthShortName(e){return this._monthsShort[e-1]||""}getMonthFullName(e){return this._monthsFull[e-1]||""}getDayAriaLabel(e){return TD(new Date(e.year,e.month-1,e.day),"fullDate",this._locale)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(uA))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})(),bk=(()=>{class t{get model$(){return this._model$.pipe(Io(e=>e.months.length>0))}get dateSelect$(){return this._dateSelect$.pipe(Io(e=>null!==e))}set(e){let i=Object.keys(e).map(s=>this._VALIDATORS[s](e[s])).reduce((s,l)=>({...s,...l}),{});Object.keys(i).length>0&&this._nextState(i)}constructor(e,i){this._calendar=e,this._i18n=i,this._VALIDATORS={dayTemplateData:s=>{if(this._state.dayTemplateData!==s)return{dayTemplateData:s}},displayMonths:s=>{if(Xl(s=Ch(s))&&s>0&&this._state.displayMonths!==s)return{displayMonths:s}},disabled:s=>{if(this._state.disabled!==s)return{disabled:s}},firstDayOfWeek:s=>{if(Xl(s=Ch(s))&&s>=0&&this._state.firstDayOfWeek!==s)return{firstDayOfWeek:s}},focusVisible:s=>{if(this._state.focusVisible!==s&&!this._state.disabled)return{focusVisible:s}},markDisabled:s=>{if(this._state.markDisabled!==s)return{markDisabled:s}},maxDate:s=>{const l=this.toValidDate(s,null);if(bx(this._state.maxDate,l))return{maxDate:l}},minDate:s=>{const l=this.toValidDate(s,null);if(bx(this._state.minDate,l))return{minDate:l}},navigation:s=>{if(this._state.navigation!==s)return{navigation:s}},outsideDays:s=>{if(this._state.outsideDays!==s)return{outsideDays:s}},weekdays:s=>{const l=!0===s||!1===s?jo.Short:s,h=!0!==s&&!1!==s||s;if(this._state.weekdayWidth!==l||this._state.weekdaysVisible!==h)return{weekdayWidth:l,weekdaysVisible:h}}},this._model$=new Li,this._dateSelect$=new Li,this._state={dayTemplateData:null,markDisabled:null,maxDate:null,minDate:null,disabled:!1,displayMonths:1,firstDate:null,firstDayOfWeek:1,lastDate:null,focusDate:null,focusVisible:!1,months:[],navigation:"select",outsideDays:"visible",prevDisabled:!1,nextDisabled:!1,selectedDate:null,selectBoxes:{years:[],months:[]},weekdayWidth:jo.Short,weekdaysVisible:!0}}focus(e){const i=this.toValidDate(e,null);null!=i&&!this._state.disabled&&bx(this._state.focusDate,i)&&this._nextState({focusDate:e})}focusSelect(){vk(this._state.focusDate,this._state)&&this.select(this._state.focusDate,{emitEvent:!0})}open(e){const i=this.toValidDate(e,this._calendar.getToday());null!=i&&!this._state.disabled&&(!this._state.firstDate||s8(this._state.firstDate,i))&&this._nextState({firstDate:i})}select(e,i={}){const s=this.toValidDate(e,null);null!=s&&!this._state.disabled&&(bx(this._state.selectedDate,s)&&this._nextState({selectedDate:s}),i.emitEvent&&vk(s,this._state)&&this._dateSelect$.next(s))}toValidDate(e,i){const s=bu.from(e);return void 0===i&&(i=this._calendar.getToday()),this._calendar.isValid(s)?s:i}getMonth(e){for(let i of this._state.months)if(e.month===i.number&&e.year===i.year)return i;throw new Error(`month ${e.month} of year ${e.year} not found`)}_nextState(e){const i=this._updateState(e);this._patchContexts(i),this._state=i,this._model$.next(this._state)}_patchContexts(e){const{months:i,displayMonths:s,selectedDate:l,focusDate:h,focusVisible:m,disabled:b,outsideDays:E}=e;e.months.forEach(M=>{M.weeks.forEach(L=>{L.days.forEach(G=>{h&&(G.context.focused=h.equals(G.date)&&m),G.tabindex=!b&&h&&G.date.equals(h)&&h.month===M.number?0:-1,!0===b&&(G.context.disabled=!0),void 0!==l&&(G.context.selected=null!==l&&l.equals(G.date)),M.number!==G.date.month&&(G.hidden="hidden"===E||"collapsed"===E||s>1&&G.date.after(i[0].firstDate)&&G.date.before(i[s-1].lastDate))})})})}_updateState(e){const i=Object.assign({},this._state,e);let s=i.firstDate;if(("minDate"in e||"maxDate"in e)&&(function Dte(t,n){if(n&&t&&n.before(t))throw new Error(`'maxDate' ${n} should be greater than 'minDate' ${t}`)}(i.minDate,i.maxDate),i.focusDate=CB(i.focusDate,i.minDate,i.maxDate),i.firstDate=CB(i.firstDate,i.minDate,i.maxDate),s=i.focusDate),"disabled"in e&&(i.focusVisible=!1),"selectedDate"in e&&0===this._state.months.length&&(s=i.selectedDate),"focusVisible"in e||"focusDate"in e&&(i.focusDate=CB(i.focusDate,i.minDate,i.maxDate),s=i.focusDate,0!==i.months.length&&i.focusDate&&!i.focusDate.before(i.firstDate)&&!i.focusDate.after(i.lastDate)))return i;if("firstDate"in e&&(i.firstDate=CB(i.firstDate,i.minDate,i.maxDate),s=i.firstDate),s){const h=function Ote(t,n,e,i,s){const{displayMonths:l,months:h}=e,m=h.splice(0,h.length);return Array.from({length:l},(E,M)=>{const L=Object.assign(t.getNext(n,"m",M),{day:1});if(h[M]=null,!s){const G=m.findIndex(V=>V.firstDate.equals(L));-1!==G&&(h[M]=m.splice(G,1)[0])}return L}).forEach((E,M)=>{null===h[M]&&(h[M]=function kte(t,n,e,i,s={}){const{dayTemplateData:l,minDate:h,maxDate:m,firstDayOfWeek:b,markDisabled:E,outsideDays:M,weekdayWidth:L,weekdaysVisible:G}=e,V=t.getToday();s.firstDate=null,s.lastDate=null,s.number=n.month,s.year=n.year,s.weeks=s.weeks||[],s.weekdays=s.weekdays||[],n=function Pte(t,n,e){const i=t.getDaysPerWeek(),s=new bu(n.year,n.month,1),l=t.getWeekday(s)%i;return t.getPrev(s,"d",(i+l-e)%i)}(t,n,b),G||(s.weekdays.length=0);for(let ne=0;ne<t.getWeeksPerMonth();ne++){let re=s.weeks[ne];re||(re=s.weeks[ne]={number:0,days:[],collapsed:!0});const de=re.days;for(let fe=0;fe<t.getDaysPerWeek();fe++){0===ne&&G&&(s.weekdays[fe]=i.getWeekdayLabel(t.getWeekday(n),L));const he=new bu(n.year,n.month,n.day),Ne=t.getNext(he),We=i.getDayAriaLabel(he);let pt=!!(h&&he.before(h)||m&&he.after(m));!pt&&E&&(pt=E(he,{month:s.number,year:s.year}));let Qt=he.equals(V),yt=l?l(he,{month:s.number,year:s.year}):void 0;null===s.firstDate&&he.month===s.number&&(s.firstDate=he),he.month===s.number&&Ne.month!==s.number&&(s.lastDate=he);let Ye=de[fe];Ye||(Ye=de[fe]={}),Ye.date=he,Ye.context=Object.assign(Ye.context||{},{$implicit:he,date:he,data:yt,currentMonth:s.number,currentYear:s.year,disabled:pt,focused:!1,selected:!1,today:Qt}),Ye.tabindex=-1,Ye.ariaLabel=We,Ye.hidden=!1,n=Ne}re.number=t.getWeekNumber(de.map(fe=>fe.date),b),re.collapsed="collapsed"===M&&de[0].date.month!==s.number&&de[de.length-1].date.month!==s.number}return s}(t,E,e,i,m.shift()||{}))}),h}(this._calendar,s,i,this._i18n,"dayTemplateData"in e||"firstDayOfWeek"in e||"markDisabled"in e||"minDate"in e||"maxDate"in e||"disabled"in e||"outsideDays"in e||"weekdaysVisible"in e);i.months=h,i.firstDate=h[0].firstDate,i.lastDate=h[h.length-1].lastDate,"selectedDate"in e&&!vk(i.selectedDate,i)&&(i.selectedDate=null),"firstDate"in e&&(!i.focusDate||i.focusDate.before(i.firstDate)||i.focusDate.after(i.lastDate))&&(i.focusDate=s);const m=!this._state.firstDate||this._state.firstDate.year!==i.firstDate.year,b=!this._state.firstDate||this._state.firstDate.month!==i.firstDate.month;"select"===i.navigation?(("minDate"in e||"maxDate"in e||0===i.selectBoxes.years.length||m)&&(i.selectBoxes.years=function Mte(t,n,e){if(!t)return[];const i=n?Math.max(n.year,t.year-500):t.year-10,l=(e?Math.min(e.year,t.year+500):t.year+10)-i+1,h=Array(l);for(let m=0;m<l;m++)h[m]=i+m;return h}(i.firstDate,i.minDate,i.maxDate)),("minDate"in e||"maxDate"in e||0===i.selectBoxes.months.length||m)&&(i.selectBoxes.months=function Bte(t,n,e,i){if(!n)return[];let s=t.getMonths(n.year);if(e&&n.year===e.year){const l=s.findIndex(h=>h===e.month);s=s.slice(l)}if(i&&n.year===i.year){const l=s.findIndex(h=>h===i.month);s=s.slice(0,l+1)}return s}(this._calendar,i.firstDate,i.minDate,i.maxDate))):i.selectBoxes={years:[],months:[]},("arrows"===i.navigation||"select"===i.navigation)&&(b||m||"minDate"in e||"maxDate"in e||"disabled"in e)&&(i.prevDisabled=i.disabled||function Rte(t,n,e){const i=Object.assign(t.getPrev(n,"m"),{day:1});return null!=e&&(i.year===e.year&&i.month<e.month||i.year<e.year&&1===e.month)}(this._calendar,i.firstDate,i.minDate),i.nextDisabled=i.disabled||function Fte(t,n,e){const i=Object.assign(t.getNext(n,"m"),{day:1});return null!=e&&i.after(e)}(this._calendar,i.lastDate,i.maxDate))}return i}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(SB),Xt(U1))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();var TB=function(t){return t[t.PREV=0]="PREV",t[t.NEXT=1]="NEXT",t}(TB||{});let Vte=(()=>{class t{constructor(e){this.i18n=e}isMuted(){return!this.selected&&(this.date.month!==this.currentMonth||this.disabled)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(U1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["","ngbDatepickerDayView",""]],hostAttrs:[1,"btn-light"],hostVars:10,hostBindings:function(i,s){2&i&&Dt("bg-primary",s.selected)("text-white",s.selected)("text-muted",s.isMuted())("outside",s.isMuted())("active",s.focused)},inputs:{currentMonth:"currentMonth",date:"date",disabled:"disabled",focused:"focused",selected:"selected"},standalone:!0,features:[Af],attrs:VJ,decls:1,vars:1,template:function(i,s){1&i&&et(0),2&i&&wr(s.i18n.getDayNumerals(s.date))},styles:["[ngbDatepickerDayView]{text-align:center;width:2rem;height:2rem;line-height:2rem;border-radius:.25rem;background:transparent}[ngbDatepickerDayView]:hover:not(.bg-primary),[ngbDatepickerDayView].active:not(.bg-primary){background-color:var(--bs-btn-bg);outline:1px solid var(--bs-border-color)}[ngbDatepickerDayView].outside{opacity:.5}\n"],encapsulation:2,changeDetection:0})}return t})(),Hte=(()=>{class t{constructor(e,i){this.i18n=e,this._renderer=i,this.select=new vi,this._month=-1,this._year=-1}changeMonth(e){this.select.emit(new bu(this.date.year,Ch(e),1))}changeYear(e){this.select.emit(new bu(Ch(e),this.date.month,1))}ngAfterViewChecked(){this.date&&(this.date.month!==this._month&&(this._month=this.date.month,this._renderer.setProperty(this.monthSelect.nativeElement,"value",this._month)),this.date.year!==this._year&&(this._year=this.date.year,this._renderer.setProperty(this.yearSelect.nativeElement,"value",this._year)))}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(U1),Ve(Wh))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["ngb-datepicker-navigation-select"]],viewQuery:function(i,s){if(1&i&&(wl(HJ,7,ao),wl(QJ,7,ao)),2&i){let l;is(l=rs())&&(s.monthSelect=l.first),is(l=rs())&&(s.yearSelect=l.first)}},inputs:{date:"date",disabled:"disabled",months:"months",years:"years"},outputs:{select:"select"},standalone:!0,features:[Af],decls:6,vars:4,consts:function(){let e,i,s,l;return e=$localize`:@@ngb.datepicker.select-month:Select month`,i=$localize`:@@ngb.datepicker.select-month:Select month`,s=$localize`:@@ngb.datepicker.select-year:Select year`,l=$localize`:@@ngb.datepicker.select-year:Select year`,[["aria-label",e,"title",i,1,"form-select",3,"disabled","change"],["month",""],[3,"value",4,"ngFor","ngForOf"],["aria-label",s,"title",l,1,"form-select",3,"disabled","change"],["year",""],[3,"value"]]},template:function(i,s){1&i&&(pe(0,"select",0,1),Tt("change",function(h){return s.changeMonth(h.target.value)}),En(2,jJ,2,3,"option",2),ye(),pe(3,"select",3,4),Tt("change",function(h){return s.changeYear(h.target.value)}),En(5,GJ,2,2,"option",2),ye()),2&i&&(st("disabled",s.disabled),$e(2),st("ngForOf",s.months),$e(1),st("disabled",s.disabled),$e(2),st("ngForOf",s.years))},dependencies:[Pl],styles:["ngb-datepicker-navigation-select>.form-select{flex:1 1 auto;padding:0 .5rem;font-size:.875rem;height:1.85rem}ngb-datepicker-navigation-select>.form-select:focus{z-index:1}ngb-datepicker-navigation-select>.form-select::-ms-value{background-color:transparent!important}\n"],encapsulation:2,changeDetection:0})}return t})(),Qte=(()=>{class t{constructor(e){this.i18n=e,this.navigation=TB,this.months=[],this.navigate=new vi,this.select=new vi}onClickPrev(e){e.currentTarget.focus(),this.navigate.emit(this.navigation.PREV)}onClickNext(e){e.currentTarget.focus(),this.navigate.emit(this.navigation.NEXT)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(U1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["ngb-datepicker-navigation"]],inputs:{date:"date",disabled:"disabled",months:"months",showSelect:"showSelect",prevDisabled:"prevDisabled",nextDisabled:"nextDisabled",selectBoxes:"selectBoxes"},outputs:{navigate:"navigate",select:"select"},standalone:!0,features:[Af],decls:8,vars:4,consts:function(){let e,i,s,l;return e=$localize`:@@ngb.datepicker.previous-month:Previous month`,i=$localize`:@@ngb.datepicker.previous-month:Previous month`,s=$localize`:@@ngb.datepicker.next-month:Next month`,l=$localize`:@@ngb.datepicker.next-month:Next month`,[[1,"ngb-dp-arrow","ngb-dp-arrow-prev"],["type","button","aria-label",e,"title",i,1,"btn","btn-link","ngb-dp-arrow-btn",3,"disabled","click"],[1,"ngb-dp-navigation-chevron"],["class","ngb-dp-navigation-select",3,"date","disabled","months","years","select",4,"ngIf"],[4,"ngIf"],[1,"ngb-dp-arrow","ngb-dp-arrow-next"],["type","button","aria-label",s,"title",l,1,"btn","btn-link","ngb-dp-arrow-btn",3,"disabled","click"],[1,"ngb-dp-navigation-select",3,"date","disabled","months","years","select"],["ngFor","",3,"ngForOf"],["class","ngb-dp-arrow",4,"ngIf"],[1,"ngb-dp-month-name"],[1,"ngb-dp-arrow"]]},template:function(i,s){1&i&&(pe(0,"div",0)(1,"button",1),Tt("click",function(h){return s.onClickPrev(h)}),oi(2,"span",2),ye()(),En(3,$J,1,4,"ngb-datepicker-navigation-select",3),En(4,ZJ,1,1,null,4),pe(5,"div",5)(6,"button",6),Tt("click",function(h){return s.onClickNext(h)}),oi(7,"span",2),ye()()),2&i&&($e(1),st("disabled",s.prevDisabled),$e(2),st("ngIf",s.showSelect),$e(1),st("ngIf",!s.showSelect),$e(2),st("disabled",s.nextDisabled))},dependencies:[Xh,Pl,Hte],styles:["ngb-datepicker-navigation{display:flex;align-items:center}.ngb-dp-navigation-chevron{border-style:solid;border-width:.2em .2em 0 0;display:inline-block;width:.75em;height:.75em;margin-left:.25em;margin-right:.15em;transform:rotate(-135deg)}.ngb-dp-arrow{display:flex;flex:1 1 auto;padding-right:0;padding-left:0;margin:0;width:2rem;height:2rem}.ngb-dp-arrow-next{justify-content:flex-end}.ngb-dp-arrow-next .ngb-dp-navigation-chevron{transform:rotate(45deg);margin-left:.15em;margin-right:.25em}.ngb-dp-arrow-btn{padding:0 .25rem;margin:0 .5rem;border:none;background-color:transparent;z-index:1}.ngb-dp-arrow-btn:focus{outline-width:1px;outline-style:auto}@media all and (-ms-high-contrast: none),(-ms-high-contrast: active){.ngb-dp-arrow-btn:focus{outline-style:solid}}.ngb-dp-month-name{font-size:larger;height:2rem;line-height:2rem;text-align:center}.ngb-dp-navigation-select{display:flex;flex:1 1 9rem}\n"],encapsulation:2,changeDetection:0})}return t})();var ja=function(t){return t[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.ArrowLeft=37]="ArrowLeft",t[t.ArrowUp=38]="ArrowUp",t[t.ArrowRight=39]="ArrowRight",t[t.ArrowDown=40]="ArrowDown",t}(ja||{});let jte=(()=>{class t{processKey(e,i){const{state:s,calendar:l}=i;switch(e.which){case ja.PageUp:i.focusDate(l.getPrev(s.focusedDate,e.shiftKey?"y":"m",1));break;case ja.PageDown:i.focusDate(l.getNext(s.focusedDate,e.shiftKey?"y":"m",1));break;case ja.End:i.focusDate(e.shiftKey?s.maxDate:s.lastDate);break;case ja.Home:i.focusDate(e.shiftKey?s.minDate:s.firstDate);break;case ja.ArrowLeft:i.focusDate(l.getPrev(s.focusedDate,"d",1));break;case ja.ArrowUp:i.focusDate(l.getPrev(s.focusedDate,"d",l.getDaysPerWeek()));break;case ja.ArrowRight:i.focusDate(l.getNext(s.focusedDate,"d",1));break;case ja.ArrowDown:i.focusDate(l.getNext(s.focusedDate,"d",l.getDaysPerWeek()));break;case ja.Enter:case ja.Space:i.focusSelect();break;default:return}e.preventDefault(),e.stopPropagation()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),wk=(()=>{class t{constructor(){this.displayMonths=1,this.firstDayOfWeek=1,this.navigation="select",this.outsideDays="visible",this.showWeekNumbers=!1,this.weekdays=jo.Short}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),xk=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(){return function Gte(){return new $te}()},providedIn:"root"})}return t})(),$te=(()=>{class t extends xk{fromModel(e){return e&&Xl(e.year)&&Xl(e.month)&&Xl(e.day)?{year:e.year,month:e.month,day:e.day}:null}toModel(e){return e&&Xl(e.year)&&Xl(e.month)&&Xl(e.day)?{year:e.year,month:e.month,day:e.day}:null}static#e=this.\u0275fac=function(){let e;return function(s){return(e||(e=Ms(t)))(s||t)}}();static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})(),a8=(()=>{class t{constructor(e){this.templateRef=e}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(bl))};static#t=this.\u0275dir=Xn({type:t,selectors:[["ng-template","ngbDatepickerContent",""]],standalone:!0})}return t})(),l8=(()=>{class t{set month(e){this.viewModel=this._service.getMonth(e)}constructor(e,i,s,l){this.i18n=e,this.datepicker=i,this._keyboardService=s,this._service=l}onKeyDown(e){this._keyboardService.processKey(e,this.datepicker)}doSelect(e){!e.context.disabled&&!e.hidden&&this.datepicker.onDateSelect(e.date)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(U1),Ve(Nr(()=>Ck)),Ve(jte),Ve(bk))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["ngb-datepicker-month"]],hostAttrs:["role","grid"],hostBindings:function(i,s){1&i&&Tt("keydown",function(h){return s.onKeyDown(h)})},inputs:{month:"month"},standalone:!0,features:[Af],decls:2,vars:2,consts:[["class","ngb-dp-week ngb-dp-weekdays","role","row",4,"ngIf"],["ngFor","",3,"ngForOf"],["role","row",1,"ngb-dp-week","ngb-dp-weekdays"],["class","ngb-dp-weekday ngb-dp-showweek small",4,"ngIf"],["class","ngb-dp-weekday small","role","columnheader",4,"ngFor","ngForOf"],[1,"ngb-dp-weekday","ngb-dp-showweek","small"],["role","columnheader",1,"ngb-dp-weekday","small"],["class","ngb-dp-week","role","row",4,"ngIf"],["role","row",1,"ngb-dp-week"],["class","ngb-dp-week-number small text-muted",4,"ngIf"],["class","ngb-dp-day","role","gridcell",3,"disabled","tabindex","hidden","ngb-dp-today","click",4,"ngFor","ngForOf"],[1,"ngb-dp-week-number","small","text-muted"],["role","gridcell",1,"ngb-dp-day",3,"tabindex","click"],[3,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,s){1&i&&(En(0,JJ,3,2,"div",0),En(1,see,1,1,"ng-template",1)),2&i&&(st("ngIf",s.viewModel.weekdays.length>0),$e(1),st("ngForOf",s.viewModel.weeks))},dependencies:[Xh,Pl,Jw],styles:['ngb-datepicker-month{display:block}.ngb-dp-weekday,.ngb-dp-week-number{line-height:2rem;text-align:center;font-style:italic}.ngb-dp-weekday{color:var(--bs-info)}.ngb-dp-week{border-radius:.25rem;display:flex}.ngb-dp-weekdays{border-bottom:1px solid var(--bs-border-color);border-radius:0;background-color:var(--bs-light)}.ngb-dp-day,.ngb-dp-weekday,.ngb-dp-week-number{width:2rem;height:2rem}.ngb-dp-day{cursor:pointer}.ngb-dp-day.disabled,.ngb-dp-day.hidden{cursor:default;pointer-events:none}.ngb-dp-day[tabindex="0"]{z-index:1}\n'],encapsulation:2})}return t})(),Ck=(()=>{class t{constructor(e,i,s,l,h,m,b,E){this._service=e,this._calendar=i,this._i18n=s,this._elementRef=m,this._ngbDateAdapter=b,this._ngZone=E,this.injector=In(Zc),this._controlValue=null,this._destroyed$=new Li,this._publicState={},this.navigate=new vi,this.dateSelect=new vi,this.onChange=M=>{},this.onTouched=()=>{},["contentTemplate","dayTemplate","dayTemplateData","displayMonths","firstDayOfWeek","footerTemplate","markDisabled","minDate","maxDate","navigation","outsideDays","showWeekNumbers","startDate","weekdays"].forEach(M=>this[M]=l[M]),e.dateSelect$.pipe(Ps(this._destroyed$)).subscribe(M=>{this.dateSelect.emit(M)}),e.model$.pipe(Ps(this._destroyed$)).subscribe(M=>{const L=M.firstDate,G=this.model?this.model.firstDate:null;this._publicState={maxDate:M.maxDate,minDate:M.minDate,firstDate:M.firstDate,lastDate:M.lastDate,focusedDate:M.focusDate,months:M.months.map(fe=>fe.firstDate)};let V=!1;if(!L.equals(G)&&(this.navigate.emit({current:G?{year:G.year,month:G.month}:null,next:{year:L.year,month:L.month},preventDefault:()=>V=!0}),V&&null!==G))return void this._service.open(G);const ne=M.selectedDate,re=M.focusDate,de=this.model?this.model.focusDate:null;this.model=M,bx(ne,this._controlValue)&&(this._controlValue=ne,this.onTouched(),this.onChange(this._ngbDateAdapter.toModel(ne))),bx(re,de)&&de&&M.focusVisible&&this.focus(),h.markForCheck()})}get state(){return this._publicState}get calendar(){return this._calendar}get i18n(){return this._i18n}focusDate(e){this._service.focus(bu.from(e))}focusSelect(){this._service.focusSelect()}focus(){this._ngZone.onStable.asObservable().pipe(Xo(1)).subscribe(()=>{const e=this._elementRef.nativeElement.querySelector('div.ngb-dp-day[tabindex="0"]');e&&e.focus()})}navigateTo(e){this._service.open(bu.from(e?e.day?e:{...e,day:1}:null))}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{const e=Ba(this._contentEl.nativeElement,"focusin"),i=Ba(this._contentEl.nativeElement,"focusout"),{nativeElement:s}=this._elementRef;so(e,i).pipe(Io(l=>{const h=l.target,m=l.relatedTarget;return!(h?.classList.contains("ngb-dp-day")&&m?.classList.contains("ngb-dp-day")&&s.contains(h)&&s.contains(m))}),Ps(this._destroyed$)).subscribe(({type:l})=>this._ngZone.run(()=>this._service.set({focusVisible:"focusin"===l})))})}ngOnDestroy(){this._destroyed$.next()}ngOnInit(){if(void 0===this.model){const e={};["dayTemplateData","displayMonths","markDisabled","firstDayOfWeek","navigation","minDate","maxDate","outsideDays","weekdays"].forEach(i=>e[i]=this[i]),this._service.set(e),this.navigateTo(this.startDate)}this.dayTemplate||(this.dayTemplate=this._defaultDayTemplate)}ngOnChanges(e){const i={};if(["dayTemplateData","displayMonths","markDisabled","firstDayOfWeek","navigation","minDate","maxDate","outsideDays","weekdays"].filter(s=>s in e).forEach(s=>i[s]=this[s]),this._service.set(i),"startDate"in e){const{currentValue:s,previousValue:l}=e.startDate;s8(l,s)&&this.navigateTo(this.startDate)}}onDateSelect(e){this._service.focus(e),this._service.select(e,{emitEvent:!0})}onNavigateDateSelect(e){this._service.open(e)}onNavigateEvent(e){switch(e){case TB.PREV:this._service.open(this._calendar.getPrev(this.model.firstDate,"m",1));break;case TB.NEXT:this._service.open(this._calendar.getNext(this.model.firstDate,"m",1))}}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._service.set({disabled:e})}writeValue(e){this._controlValue=bu.from(this._ngbDateAdapter.fromModel(e)),this._service.select(this._controlValue)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(bk),Ve(SB),Ve(U1),Ve(wk),Ve(gf),Ve(ao),Ve(xk),Ve(Wi))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["ngb-datepicker"]],contentQueries:function(i,s,l){if(1&i&&Qa(l,a8,7),2&i){let h;is(h=rs())&&(s.contentTemplateFromContent=h.first)}},viewQuery:function(i,s){if(1&i&&(wl(oee,7),wl(aee,7)),2&i){let l;is(l=rs())&&(s._defaultDayTemplate=l.first),is(l=rs())&&(s._contentEl=l.first)}},hostVars:2,hostBindings:function(i,s){2&i&&Dt("disabled",s.model.disabled)},inputs:{contentTemplate:"contentTemplate",dayTemplate:"dayTemplate",dayTemplateData:"dayTemplateData",displayMonths:"displayMonths",firstDayOfWeek:"firstDayOfWeek",footerTemplate:"footerTemplate",markDisabled:"markDisabled",maxDate:"maxDate",minDate:"minDate",navigation:"navigation",outsideDays:"outsideDays",showWeekNumbers:"showWeekNumbers",startDate:"startDate",weekdays:"weekdays"},outputs:{navigate:"navigate",dateSelect:"dateSelect"},exportAs:["ngbDatepicker"],standalone:!0,features:[Qo([{provide:dA,useExisting:Nr(()=>t),multi:!0},bk]),Zo,Af],decls:10,vars:9,consts:[["defaultDayTemplate",""],["defaultContentTemplate",""],[1,"ngb-dp-header"],[3,"date","months","disabled","showSelect","prevDisabled","nextDisabled","selectBoxes","navigate","select",4,"ngIf"],[1,"ngb-dp-content"],["content",""],[3,"ngTemplateOutlet","ngTemplateOutletContext","ngTemplateOutletInjector"],[3,"ngTemplateOutlet"],["ngbDatepickerDayView","",3,"date","currentMonth","selected","disabled","focused"],["class","ngb-dp-month",4,"ngFor","ngForOf"],[1,"ngb-dp-month"],["class","ngb-dp-month-name",4,"ngIf"],[3,"month"],[1,"ngb-dp-month-name"],[3,"date","months","disabled","showSelect","prevDisabled","nextDisabled","selectBoxes","navigate","select"]],template:function(i,s){if(1&i&&(En(0,lee,1,5,"ng-template",null,0,Zl),En(2,hee,1,1,"ng-template",null,1,Zl),pe(4,"div",2),En(5,dee,1,7,"ngb-datepicker-navigation",3),ye(),pe(6,"div",4,5),En(8,fee,0,0,"ng-template",6),ye(),En(9,Aee,0,0,"ng-template",7)),2&i){const l=ws(3);$e(5),st("ngIf","none"!==s.navigation),$e(1),Dt("ngb-dp-months",!s.contentTemplate),$e(2),st("ngTemplateOutlet",s.contentTemplate||(null==s.contentTemplateFromContent?null:s.contentTemplateFromContent.templateRef)||l)("ngTemplateOutletContext",C1(7,Uz,s))("ngTemplateOutletInjector",s.injector),$e(1),st("ngTemplateOutlet",s.footerTemplate)}},dependencies:[Xh,Pl,Jw,Vte,l8,Qte],styles:["ngb-datepicker{border:1px solid var(--bs-border-color);border-radius:.25rem;display:inline-block}ngb-datepicker-month{pointer-events:auto}ngb-datepicker.dropdown-menu{padding:0}ngb-datepicker.disabled .ngb-dp-weekday,ngb-datepicker.disabled .ngb-dp-week-number,ngb-datepicker.disabled .ngb-dp-month-name{color:var(--bs-text-muted)}.ngb-dp-body{z-index:1055}.ngb-dp-header{border-bottom:0;border-radius:.25rem .25rem 0 0;padding-top:.25rem;background-color:var(--bs-light)}.ngb-dp-months{display:flex}.ngb-dp-month{pointer-events:none}.ngb-dp-month-name{font-size:larger;height:2rem;line-height:2rem;text-align:center;background-color:var(--bs-light)}.ngb-dp-month+.ngb-dp-month .ngb-dp-month-name,.ngb-dp-month+.ngb-dp-month .ngb-dp-week{padding-left:1rem}.ngb-dp-month:last-child .ngb-dp-week{padding-right:.25rem}.ngb-dp-month:first-child .ngb-dp-week{padding-left:.25rem}.ngb-dp-month .ngb-dp-week:last-child{padding-bottom:.25rem}\n"],encapsulation:2,changeDetection:0})}return t})();const IB=(t,n)=>!!n&&n.some(e=>e.contains(t)),c8=(t,n)=>!n||null!=function Ate(t,n){return!n||typeof t.closest>"u"?null:t.closest(n)}(t,n),qte=typeof navigator<"u"&&!!navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));function u8(t,n,e,i,s,l,h,m){e&&t.runOutsideAngular((t=>qte?()=>setTimeout(()=>t(),100):t)(()=>{const E=Ba(n,"keydown").pipe(Ps(s),Io(G=>G.which===ja.Escape),sc(G=>G.preventDefault())),M=Ba(n,"mousedown").pipe(Ht(G=>{const V=G.target;return 2!==G.button&&!IB(V,h)&&("inside"===e?IB(V,l)&&c8(V,m):"outside"===e?!IB(V,l):c8(V,m)||!IB(V,l))}),Ps(s)),L=Ba(n,"mouseup").pipe(RO(M),Io(([G,V])=>V),EE(0),Ps(s));MO([E.pipe(Ht(G=>0)),L.pipe(Ht(G=>1))]).subscribe(G=>t.run(()=>i(G)))}))}const h8=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function d8(t){const n=Array.from(t.querySelectorAll(h8)).filter(e=>-1!==e.tabIndex);return[n[0],n[n.length-1]]}const f8=(t,n,e,i=!1)=>{t.runOutsideAngular(()=>{const s=Ba(n,"focusin").pipe(Ps(e),Ht(l=>l.target));Ba(n,"keydown").pipe(Ps(e),Io(l=>l.which===ja.Tab),RO(s)).subscribe(([l,h])=>{const[m,b]=d8(n);(h===m||h===n)&&l.shiftKey&&(b.focus(),l.preventDefault()),h===b&&!l.shiftKey&&(m.focus(),l.preventDefault())}),i&&Ba(n,"click").pipe(Ps(e),RO(s),Ht(l=>l[1])).subscribe(l=>l.focus())})};let Wte=(()=>{class t{constructor(e){this._element=e.documentElement}isRTL(){return"rtl"===(this._element.getAttribute("dir")||"").toLowerCase()}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wa))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Zte=/\s+/,Xte=/  +/gi,Yte={top:["top"],bottom:["bottom"],start:["left","right"],left:["left"],end:["right","left"],right:["right"],"top-start":["top-start","top-end"],"top-left":["top-start"],"top-end":["top-end","top-start"],"top-right":["top-end"],"bottom-start":["bottom-start","bottom-end"],"bottom-left":["bottom-start"],"bottom-end":["bottom-end","bottom-start"],"bottom-right":["bottom-end"],"start-top":["left-start","right-start"],"left-top":["left-start"],"start-bottom":["left-end","right-end"],"left-bottom":["left-end"],"end-top":["right-start","left-start"],"right-top":["right-start"],"end-bottom":["right-end","left-end"],"right-bottom":["right-end"]},ene=/^left/,tne=/^right/,nne=/^start/,ine=/^end/;function A8({placement:t,baseClass:n},e){let i=Array.isArray(t)?t:t.split(Zte),l=i.findIndex(E=>"auto"===E);l>=0&&["top","bottom","start","end","top-start","top-end","bottom-start","bottom-end","start-top","start-bottom","end-top","end-bottom"].forEach(function(E){null==i.find(M=>-1!==M.search("^"+E))&&i.splice(l++,1,E)});const h=i.map(E=>function Jte(t,n){const[e,i]=Yte[t];return n&&i||e}(E,e.isRTL()));return{placement:h.shift(),modifiers:[{name:"bootstrapClasses",enabled:!!n,phase:"write",fn({state:E}){const M=new RegExp(n+"(-[a-z]+)*","gi"),L=E.elements.popper,G=E.placement;let V=L.className;V=V.replace(M,""),V+=` ${function rne(t,n){let[e,i]=n.split("-");const s=e.replace(ene,"start").replace(tne,"end");let l=[s];if(i){let h=i;("left"===e||"right"===e)&&(h=h.replace(nne,"top").replace(ine,"bottom")),l.push(`${s}-${h}`)}return t&&(l=l.map(h=>`${t}-${h}`)),l.join(" ")}(n,G)}`,V=V.trim().replace(Xte," "),L.className=V}},JY,iJ,aJ,{enabled:!0,name:"flip",options:{fallbackPlacements:h}},{enabled:!0,name:"preventOverflow",phase:"main",fn:function(){}}]}}function p8(t){return t}function g8(){const t=In(Wte);let n=null;return{createPopper(e){if(!n){let s=(e.updatePopperOptions||p8)(A8(e,t));n=IJ(e.hostElement,e.targetElement,s)}},update(){n&&n.update()},setOptions(e){if(n){let s=(e.updatePopperOptions||p8)(A8(e,t));n.setOptions(s)}},destroy(){n&&(n.destroy(),n=null)}}}let m8=(()=>{class t extends wk{constructor(){super(...arguments),this.autoClose=!0,this.placement=["bottom-start","bottom-end","top-start","top-end"],this.popperOptions=e=>e,this.restoreFocus=!0}static#e=this.\u0275fac=function(){let e;return function(s){return(e||(e=Ms(t)))(s||t)}}();static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function _8(t){return n=>(n.modifiers.push(MJ,{name:"offset",options:{offset:()=>t}}),n)}let y8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(){return function sne(){return new one}()},providedIn:"root"})}return t})(),one=(()=>{class t extends y8{parse(e){if(null!=e){const i=e.trim().split("-");if(1===i.length&&Sc(i[0]))return{year:Ch(i[0]),month:null,day:null};if(2===i.length&&Sc(i[0])&&Sc(i[1]))return{year:Ch(i[0]),month:Ch(i[1]),day:null};if(3===i.length&&Sc(i[0])&&Sc(i[1])&&Sc(i[2]))return{year:Ch(i[0]),month:Ch(i[1]),day:Ch(i[2])}}return null}format(e){return e?`${e.year}-${Sc(e.month)?yx(e.month):""}-${Sc(e.day)?yx(e.day):""}`:""}static#e=this.\u0275fac=function(){let e;return function(s){return(e||(e=Ms(t)))(s||t)}}();static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})(),Ek=(()=>{class t{get disabled(){return this._disabled}set disabled(e){this._disabled=""===e||e&&"false"!==e,this.isOpen()&&this._cRef.instance.setDisabledState(this._disabled)}constructor(e,i,s,l,h,m,b,E,M,L){this._parserFormatter=e,this._elRef=i,this._vcRef=s,this._renderer=l,this._ngZone=h,this._calendar=m,this._dateAdapter=b,this._document=E,this._changeDetector=M,this._cRef=null,this._disabled=!1,this._elWithFocus=null,this._model=null,this._destroyCloseHandlers$=new Li,this.dateSelect=new vi,this.navigate=new vi,this.closed=new vi,this._onChange=G=>{},this._onTouched=()=>{},this._validatorChange=()=>{},["autoClose","container","positionTarget","placement","popperOptions"].forEach(G=>this[G]=L[G]),this._positioning=g8()}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}registerOnValidatorChange(e){this._validatorChange=e}setDisabledState(e){this.disabled=e}validate(e){const{value:i}=e;if(null!=i){const s=this._fromDateStruct(this._dateAdapter.fromModel(i));if(!s)return{ngbDate:{invalid:i}};if(this.minDate&&s.before(bu.from(this.minDate)))return{ngbDate:{minDate:{minDate:this.minDate,actual:i}}};if(this.maxDate&&s.after(bu.from(this.maxDate)))return{ngbDate:{maxDate:{maxDate:this.maxDate,actual:i}}}}return null}writeValue(e){this._model=this._fromDateStruct(this._dateAdapter.fromModel(e)),this._writeModelValue(this._model)}manualDateChange(e,i=!1){const s=e!==this._inputValue;s&&(this._inputValue=e,this._model=this._fromDateStruct(this._parserFormatter.parse(e))),(s||!i)&&this._onChange(this._model?this._dateAdapter.toModel(this._model):""===e?null:e),i&&this._model&&this._writeModelValue(this._model)}isOpen(){return!!this._cRef}open(){if(!this.isOpen()){let e;if(this._cRef=this._vcRef.createComponent(Ck),this._applyPopupStyling(this._cRef.location.nativeElement),this._applyDatepickerInputs(this._cRef),this._subscribeForDatepickerOutputs(this._cRef.instance),this._cRef.instance.ngOnInit(),this._cRef.instance.writeValue(this._dateAdapter.toModel(this._model)),this._cRef.instance.registerOnChange(i=>{this.writeValue(i),this._onChange(i),this._onTouched()}),this._cRef.changeDetectorRef.detectChanges(),this._cRef.instance.setDisabledState(this.disabled),"body"===this.container&&this._document.querySelector(this.container).appendChild(this._cRef.location.nativeElement),this._elWithFocus=this._document.activeElement,f8(this._ngZone,this._cRef.location.nativeElement,this.closed,!0),setTimeout(()=>this._cRef?.instance.focus()),e=P1(this.positionTarget)?this._document.querySelector(this.positionTarget):this.positionTarget instanceof HTMLElement?this.positionTarget:this._elRef.nativeElement,this._ngZone.runOutsideAngular(()=>{this._cRef&&(this._positioning.createPopper({hostElement:e,targetElement:this._cRef.location.nativeElement,placement:this.placement,appendToBody:"body"===this.container,updatePopperOptions:i=>this.popperOptions(_8([0,2])(i))}),this._zoneSubscription=this._ngZone.onStable.subscribe(()=>this._positioning.update()))}),this.positionTarget&&!e)throw new Error("ngbDatepicker could not find element declared in [positionTarget] to position against.");this._setCloseHandlers()}}close(){if(this.isOpen()){this._vcRef.remove(this._vcRef.indexOf(this._cRef.hostView)),this._cRef=null,this._positioning.destroy(),this._zoneSubscription?.unsubscribe(),this._destroyCloseHandlers$.next(),this.closed.emit(),this._changeDetector.markForCheck();let e=this._elWithFocus;P1(this.restoreFocus)?e=this._document.querySelector(this.restoreFocus):void 0!==this.restoreFocus&&(e=this.restoreFocus),e&&e.focus?e.focus():this._document.body.focus()}}toggle(){this.isOpen()?this.close():this.open()}navigateTo(e){this.isOpen()&&this._cRef.instance.navigateTo(e)}onBlur(){this._onTouched()}onFocus(){this._elWithFocus=this._elRef.nativeElement}ngOnChanges(e){if((e.minDate||e.maxDate)&&(this._validatorChange(),this.isOpen()&&(e.minDate&&(this._cRef.instance.minDate=this.minDate),e.maxDate&&(this._cRef.instance.maxDate=this.maxDate),this._cRef.instance.ngOnChanges(e))),e.datepickerClass){const{currentValue:i,previousValue:s}=e.datepickerClass;this._applyPopupClass(i,s)}e.autoClose&&this.isOpen()&&this._setCloseHandlers()}ngOnDestroy(){this.close()}_applyDatepickerInputs(e){["contentTemplate","dayTemplate","dayTemplateData","displayMonths","firstDayOfWeek","footerTemplate","markDisabled","minDate","maxDate","navigation","outsideDays","showNavigation","showWeekNumbers","weekdays"].forEach(i=>{void 0!==this[i]&&e.setInput(i,this[i])}),e.setInput("startDate",this.startDate||this._model)}_applyPopupClass(e,i){const s=this._cRef?.location.nativeElement;s&&(e&&this._renderer.addClass(s,e),i&&this._renderer.removeClass(s,i))}_applyPopupStyling(e){this._renderer.addClass(e,"dropdown-menu"),this._renderer.addClass(e,"show"),"body"===this.container&&this._renderer.addClass(e,"ngb-dp-body"),this._applyPopupClass(this.datepickerClass)}_subscribeForDatepickerOutputs(e){e.navigate.subscribe(i=>this.navigate.emit(i)),e.dateSelect.subscribe(i=>{this.dateSelect.emit(i),(!0===this.autoClose||"inside"===this.autoClose)&&this.close()})}_writeModelValue(e){const i=this._parserFormatter.format(e);this._inputValue=i,this._renderer.setProperty(this._elRef.nativeElement,"value",i),this.isOpen()&&(this._cRef.instance.writeValue(this._dateAdapter.toModel(e)),this._onTouched())}_fromDateStruct(e){const i=e?new bu(e.year,e.month,e.day):null;return this._calendar.isValid(i)?i:null}_setCloseHandlers(){this._destroyCloseHandlers$.next(),u8(this._ngZone,this._document,this.autoClose,()=>this.close(),this._destroyCloseHandlers$,[],[this._elRef.nativeElement,this._cRef.location.nativeElement])}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(y8),Ve(ao),Ve(cA),Ve(Wh),Ve(Wi),Ve(SB),Ve(xk),Ve(wa),Ve(gf),Ve(m8))};static#t=this.\u0275dir=Xn({type:t,selectors:[["input","ngbDatepicker",""]],hostVars:1,hostBindings:function(i,s){1&i&&Tt("input",function(h){return s.manualDateChange(h.target.value)})("change",function(h){return s.manualDateChange(h.target.value,!0)})("focus",function(){return s.onFocus()})("blur",function(){return s.onBlur()}),2&i&&np("disabled",s.disabled)},inputs:{autoClose:"autoClose",contentTemplate:"contentTemplate",datepickerClass:"datepickerClass",dayTemplate:"dayTemplate",dayTemplateData:"dayTemplateData",displayMonths:"displayMonths",firstDayOfWeek:"firstDayOfWeek",footerTemplate:"footerTemplate",markDisabled:"markDisabled",minDate:"minDate",maxDate:"maxDate",navigation:"navigation",outsideDays:"outsideDays",placement:"placement",popperOptions:"popperOptions",restoreFocus:"restoreFocus",showWeekNumbers:"showWeekNumbers",startDate:"startDate",container:"container",positionTarget:"positionTarget",weekdays:"weekdays",disabled:"disabled"},outputs:{dateSelect:"dateSelect",navigate:"navigate",closed:"closed"},exportAs:["ngbDatepicker"],standalone:!0,features:[Qo([{provide:dA,useExisting:Nr(()=>t),multi:!0},{provide:wh,useExisting:Nr(()=>t),multi:!0},{provide:wk,useExisting:m8}]),Zo]})}return t})();new Date(1882,10,12),new Date(2174,10,25);let E8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),Ane=(()=>{class t{constructor(){this.autoClose=!0,this.placement=["bottom-start","bottom-end","top-start","top-end"],this.popperOptions=e=>e}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Dk=(()=>{class t{set disabled(e){this._disabled=""===e||!0===e,this._renderer.setProperty(this.elementRef.nativeElement,"disabled",this._disabled)}get disabled(){return this._disabled}constructor(e,i){this.elementRef=e,this._renderer=i,this._disabled=!1}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(ao),Ve(Wh))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngbDropdownItem",""]],hostAttrs:[1,"dropdown-item"],hostVars:3,hostBindings:function(i,s){2&i&&(np("tabIndex",s.disabled?-1:0),Dt("disabled",s.disabled))},inputs:{disabled:"disabled"},standalone:!0})}return t})(),Bk=(()=>{class t{constructor(e,i){this.dropdown=e,this.placement="bottom",this.isOpen=!1,this.nativeElement=i.nativeElement}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Nr(()=>QE)),Ve(ao))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngbDropdownMenu",""]],contentQueries:function(i,s,l){if(1&i&&Qa(l,Dk,4),2&i){let h;is(h=rs())&&(s.menuItems=h)}},hostVars:4,hostBindings:function(i,s){1&i&&Tt("keydown.ArrowUp",function(h){return s.dropdown.onKeyDown(h)})("keydown.ArrowDown",function(h){return s.dropdown.onKeyDown(h)})("keydown.Home",function(h){return s.dropdown.onKeyDown(h)})("keydown.End",function(h){return s.dropdown.onKeyDown(h)})("keydown.Enter",function(h){return s.dropdown.onKeyDown(h)})("keydown.Space",function(h){return s.dropdown.onKeyDown(h)})("keydown.Tab",function(h){return s.dropdown.onKeyDown(h)})("keydown.Shift.Tab",function(h){return s.dropdown.onKeyDown(h)}),2&i&&Dt("dropdown-menu",!0)("show",s.dropdown.isOpen())},standalone:!0})}return t})(),FB=(()=>{class t{constructor(e,i){this.dropdown=e,this.nativeElement=i.nativeElement}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Nr(()=>QE)),Ve(ao))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngbDropdownAnchor",""]],hostAttrs:[1,"dropdown-toggle"],hostVars:1,hostBindings:function(i,s){2&i&&To("aria-expanded",s.dropdown.isOpen())},standalone:!0})}return t})(),S8=(()=>{class t extends FB{constructor(e,i){super(e,i)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Nr(()=>QE)),Ve(ao))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngbDropdownToggle",""]],hostAttrs:[1,"dropdown-toggle"],hostVars:1,hostBindings:function(i,s){1&i&&Tt("click",function(){return s.dropdown.toggle()})("keydown.ArrowUp",function(h){return s.dropdown.onKeyDown(h)})("keydown.ArrowDown",function(h){return s.dropdown.onKeyDown(h)})("keydown.Home",function(h){return s.dropdown.onKeyDown(h)})("keydown.End",function(h){return s.dropdown.onKeyDown(h)})("keydown.Tab",function(h){return s.dropdown.onKeyDown(h)})("keydown.Shift.Tab",function(h){return s.dropdown.onKeyDown(h)}),2&i&&To("aria-expanded",s.dropdown.isOpen())},standalone:!0,features:[Qo([{provide:FB,useExisting:Nr(()=>t)}]),Ho]})}return t})(),QE=(()=>{class t{constructor(e,i,s,l,h,m){this._changeDetector=e,this._document=s,this._ngZone=l,this._elementRef=h,this._renderer=m,this._destroyCloseHandlers$=new Li,this._bodyContainer=null,this._open=!1,this.openChange=new vi,this.placement=i.placement,this.popperOptions=i.popperOptions,this.container=i.container,this.autoClose=i.autoClose,this._positioning=g8()}ngOnInit(){this.display||(this.display=this._elementRef.nativeElement.closest(".navbar")?"static":"dynamic")}ngAfterContentInit(){this._ngZone.onStable.pipe(Xo(1)).subscribe(()=>{this._applyPlacementClasses(),this._open&&this._setCloseHandlers()})}ngOnChanges(e){if(e.container&&this._open&&this._applyContainer(this.container),e.placement&&!e.placement.firstChange&&(this._positioning.setOptions({hostElement:this._anchor.nativeElement,targetElement:this._bodyContainer||this._menu.nativeElement,placement:this.placement,appendToBody:"body"===this.container}),this._applyPlacementClasses()),e.dropdownClass){const{currentValue:i,previousValue:s}=e.dropdownClass;this._applyCustomDropdownClass(i,s)}e.autoClose&&this._open&&(this.autoClose=e.autoClose.currentValue,this._setCloseHandlers())}isOpen(){return this._open}open(){this._open||(this._open=!0,this._applyContainer(this.container),this.openChange.emit(!0),this._setCloseHandlers(),this._anchor&&(this._anchor.nativeElement.focus(),"dynamic"===this.display&&this._ngZone.runOutsideAngular(()=>{this._positioning.createPopper({hostElement:this._anchor.nativeElement,targetElement:this._bodyContainer||this._menu.nativeElement,placement:this.placement,appendToBody:"body"===this.container,updatePopperOptions:e=>this.popperOptions(_8([0,2])(e))}),this._applyPlacementClasses(),this._zoneSubscription=this._ngZone.onStable.subscribe(()=>this._positionMenu())})))}_setCloseHandlers(){this._destroyCloseHandlers$.next(),u8(this._ngZone,this._document,this.autoClose,e=>{this.close(),0===e&&this._anchor.nativeElement.focus()},this._destroyCloseHandlers$,this._menu?[this._menu.nativeElement]:[],this._anchor?[this._anchor.nativeElement]:[],".dropdown-item,.dropdown-divider")}close(){this._open&&(this._open=!1,this._resetContainer(),this._positioning.destroy(),this._zoneSubscription?.unsubscribe(),this._destroyCloseHandlers$.next(),this.openChange.emit(!1),this._changeDetector.markForCheck())}toggle(){this.isOpen()?this.close():this.open()}ngOnDestroy(){this.close()}onKeyDown(e){const i=e.which,s=this._getMenuElements();let l=-1,h=null;const m=this._isEventFromToggle(e);if(!m&&s.length&&s.forEach((b,E)=>{b.contains(e.target)&&(h=b),b===Qz(this._document)&&(l=E)}),i!==ja.Space&&i!==ja.Enter){if(i!==ja.Tab){if(m||h){if(this.open(),s.length){switch(i){case ja.ArrowDown:l=Math.min(l+1,s.length-1);break;case ja.ArrowUp:if(this._isDropup()&&-1===l){l=s.length-1;break}l=Math.max(l-1,0);break;case ja.Home:l=0;break;case ja.End:l=s.length-1}s[l].focus()}e.preventDefault()}}else if(e.target&&this.isOpen()&&this.autoClose){if(this._anchor.nativeElement===e.target)return void("body"!==this.container||e.shiftKey?e.shiftKey&&this.close():(this._renderer.setAttribute(this._menu.nativeElement,"tabindex","0"),this._menu.nativeElement.focus(),this._renderer.removeAttribute(this._menu.nativeElement,"tabindex")));if("body"===this.container){const b=this._menu.nativeElement.querySelectorAll(h8);e.shiftKey&&e.target===b[0]?(this._anchor.nativeElement.focus(),e.preventDefault()):!e.shiftKey&&e.target===b[b.length-1]&&(this._anchor.nativeElement.focus(),this.close())}else Ba(e.target,"focusout").pipe(Xo(1)).subscribe(({relatedTarget:b})=>{this._elementRef.nativeElement.contains(b)||this.close()})}}else h&&(!0===this.autoClose||"inside"===this.autoClose)&&Ba(h,"click").pipe(Xo(1)).subscribe(()=>this.close())}_isDropup(){return this._elementRef.nativeElement.classList.contains("dropup")}_isEventFromToggle(e){return this._anchor.nativeElement.contains(e.target)}_getMenuElements(){const e=this._menu;return null==e?[]:e.menuItems.filter(i=>!i.disabled).map(i=>i.elementRef.nativeElement)}_positionMenu(){const e=this._menu;this.isOpen()&&e&&("dynamic"===this.display?(this._positioning.update(),this._applyPlacementClasses()):this._applyPlacementClasses(this._getFirstPlacement(this.placement)))}_getFirstPlacement(e){return Array.isArray(e)?e[0]:e.split(" ")[0]}_resetContainer(){const e=this._renderer;this._menu&&e.appendChild(this._elementRef.nativeElement,this._menu.nativeElement),this._bodyContainer&&(e.removeChild(this._document.body,this._bodyContainer),this._bodyContainer=null)}_applyContainer(e=null){if(this._resetContainer(),"body"===e){const i=this._renderer,s=this._menu.nativeElement,l=this._bodyContainer=this._bodyContainer||i.createElement("div");i.setStyle(l,"position","absolute"),i.setStyle(s,"position","static"),i.setStyle(l,"z-index","1055"),i.appendChild(l,s),i.appendChild(this._document.body,l)}this._applyCustomDropdownClass(this.dropdownClass)}_applyCustomDropdownClass(e,i){const s="body"===this.container?this._bodyContainer:this._elementRef.nativeElement;s&&(i&&this._renderer.removeClass(s,i),e&&this._renderer.addClass(s,e))}_applyPlacementClasses(e){const i=this._menu;if(i){e||(e=this._getFirstPlacement(this.placement));const s=this._renderer,l=this._elementRef.nativeElement;s.removeClass(l,"dropup"),s.removeClass(l,"dropdown");const{nativeElement:h}=i;"static"===this.display?(i.placement=null,s.setAttribute(h,"data-bs-popper","static")):(i.placement=e,s.removeAttribute(h,"data-bs-popper"));const m=-1!==e.search("^top")?"dropup":"dropdown";s.addClass(l,m);const b=this._bodyContainer;b&&(s.removeClass(b,"dropup"),s.removeClass(b,"dropdown"),s.addClass(b,m))}}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(gf),Ve(Ane),Ve(wa),Ve(Wi),Ve(ao),Ve(Wh))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngbDropdown",""]],contentQueries:function(i,s,l){if(1&i&&(Qa(l,Bk,5),Qa(l,FB,5)),2&i){let h;is(h=rs())&&(s._menu=h.first),is(h=rs())&&(s._anchor=h.first)}},hostVars:2,hostBindings:function(i,s){2&i&&Dt("show",s.isOpen())},inputs:{autoClose:"autoClose",dropdownClass:"dropdownClass",_open:["open","_open"],placement:"placement",popperOptions:"popperOptions",container:"container",display:"display"},outputs:{openChange:"openChange"},exportAs:["ngbDropdown"],standalone:!0,features:[Zo]})}return t})(),T8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})();class H1{constructor(n,e,i){this.nodes=n,this.viewRef=e,this.componentRef=i}}let pne=(()=>{class t{constructor(e,i){this._el=e,this._zone=i}ngOnInit(){this._zone.onStable.asObservable().pipe(Xo(1)).subscribe(()=>{mf(this._zone,this._el.nativeElement,(e,i)=>{i&&vx(e),e.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return mf(this._zone,this._el.nativeElement,({classList:e})=>e.remove("show"),{animation:this.animation,runningTransition:"stop"})}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(ao),Ve(Wi))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(i,s){2&i&&(Mn("modal-backdrop"+(s.backdropClass?" "+s.backdropClass:"")),Dt("show",!s.animation)("fade",s.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},standalone:!0,features:[Af],decls:0,vars:0,template:function(i,s){},encapsulation:2})}return t})();class I8{update(n){}close(n){}dismiss(n){}}const gne=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","fullscreen","keyboard","scrollable","size","windowClass","modalDialogClass"],mne=["animation","backdropClass"];class _ne{_applyWindowOptions(n,e){gne.forEach(i=>{N1(e[i])&&(n[i]=e[i])})}_applyBackdropOptions(n,e){mne.forEach(i=>{N1(e[i])&&(n[i]=e[i])})}update(n){this._applyWindowOptions(this._windowCmptRef.instance,n),this._backdropCmptRef&&this._backdropCmptRef.instance&&this._applyBackdropOptions(this._backdropCmptRef.instance,n)}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(Ps(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(Ps(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}constructor(n,e,i,s){this._windowCmptRef=n,this._contentRef=e,this._backdropCmptRef=i,this._beforeDismiss=s,this._closed=new Li,this._dismissed=new Li,this._hidden=new Li,n.instance.dismissEvent.subscribe(l=>{this.dismiss(l)}),this.result=new Promise((l,h)=>{this._resolve=l,this._reject=h}),this.result.then(null,()=>{})}close(n){this._windowCmptRef&&(this._closed.next(n),this._resolve(n),this._removeModalElements())}_dismiss(n){this._dismissed.next(n),this._reject(n),this._removeModalElements()}dismiss(n){if(this._windowCmptRef)if(this._beforeDismiss){const e=this._beforeDismiss();!function Vz(t){return t&&t.then}(e)?!1!==e&&this._dismiss(n):e.then(i=>{!1!==i&&this._dismiss(n)},()=>{})}else this._dismiss(n)}_removeModalElements(){const n=this._windowCmptRef.instance.hide(),e=this._backdropCmptRef?this._backdropCmptRef.instance.hide():Bi(void 0);n.subscribe(()=>{const{nativeElement:i}=this._windowCmptRef.location;i.parentNode.removeChild(i),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),e.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:i}=this._backdropCmptRef.location;i.parentNode.removeChild(i),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),FO(n,e).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var Yl=function(t){return t[t.BACKDROP_CLICK=0]="BACKDROP_CLICK",t[t.ESC=1]="ESC",t}(Yl||{});let yne=(()=>{class t{constructor(e,i,s){this._document=e,this._elRef=i,this._zone=s,this._closed$=new Li,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new vi,this.shown=new Li,this.hidden=new Li}get fullscreenClass(){return!0===this.fullscreen?" modal-fullscreen":P1(this.fullscreen)?` modal-fullscreen-${this.fullscreen}-down`:""}dismiss(e){this.dismissEvent.emit(e)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe(Xo(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:e}=this._elRef,i={animation:this.animation,runningTransition:"stop"},h=FO(mf(this._zone,e,()=>e.classList.remove("show"),i),mf(this._zone,this._dialogEl.nativeElement,()=>{},i));return h.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),h}_show(){const e={animation:this.animation,runningTransition:"continue"};FO(mf(this._zone,this._elRef.nativeElement,(l,h)=>{h&&vx(l),l.classList.add("show")},e),mf(this._zone,this._dialogEl.nativeElement,()=>{},e)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:e}=this._elRef;this._zone.runOutsideAngular(()=>{Ba(e,"keydown").pipe(Ps(this._closed$),Io(s=>s.which===ja.Escape)).subscribe(s=>{this.keyboard?requestAnimationFrame(()=>{s.defaultPrevented||this._zone.run(()=>this.dismiss(Yl.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let i=!1;Ba(this._dialogEl.nativeElement,"mousedown").pipe(Ps(this._closed$),sc(()=>i=!1),cl(()=>Ba(e,"mouseup").pipe(Ps(this._closed$),Xo(1))),Io(({target:s})=>e===s)).subscribe(()=>{i=!0}),Ba(e,"click").pipe(Ps(this._closed$)).subscribe(({target:s})=>{e===s&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!i&&this._zone.run(()=>this.dismiss(Yl.BACKDROP_CLICK))),i=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:e}=this._elRef;if(!e.contains(document.activeElement)){const i=e.querySelector("[ngbAutofocus]"),s=d8(e)[0];(i||s||e).focus()}}_restoreFocus(){const e=this._document.body,i=this._elWithFocus;let s;s=i&&i.focus&&e.contains(i)?i:e,this._zone.runOutsideAngular(()=>{setTimeout(()=>s.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&mf(this._zone,this._elRef.nativeElement,({classList:e})=>(e.add("modal-static"),()=>e.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(wa),Ve(ao),Ve(Wi))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["ngb-modal-window"]],viewQuery:function(i,s){if(1&i&&wl(pee,7),2&i){let l;is(l=rs())&&(s._dialogEl=l.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(i,s){2&i&&(To("aria-modal",!0)("aria-labelledby",s.ariaLabelledBy)("aria-describedby",s.ariaDescribedBy),Mn("modal d-block"+(s.windowClass?" "+s.windowClass:"")),Dt("fade",s.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",fullscreen:"fullscreen",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},standalone:!0,features:[Af],ngContentSelectors:UJ,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(i,s){1&i&&(Nw(),pe(0,"div",0,1)(2,"div",2),Lw(3),ye()()),2&i&&Mn("modal-dialog"+(s.size?" modal-"+s.size:"")+(s.centered?" modal-dialog-centered":"")+s.fullscreenClass+(s.scrollable?" modal-dialog-scrollable":"")+(s.modalDialogClass?" "+s.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2})}return t})(),vne=(()=>{class t{constructor(e){this._document=e}hide(){const e=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),i=this._document.body,s=i.style,{overflow:l,paddingRight:h}=s;if(e>0){const m=parseFloat(window.getComputedStyle(i).paddingRight);s.paddingRight=`${m+e}px`}return s.overflow="hidden",()=>{e>0&&(s.paddingRight=h),s.overflow=l}}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wa))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),bne=(()=>{class t{constructor(e,i,s,l,h,m,b){this._applicationRef=e,this._injector=i,this._environmentInjector=s,this._document=l,this._scrollBar=h,this._rendererFactory=m,this._ngZone=b,this._activeWindowCmptHasChanged=new Li,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._modalRefs=[],this._windowCmpts=[],this._activeInstances=new vi,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const E=this._windowCmpts[this._windowCmpts.length-1];f8(this._ngZone,E.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(E.location.nativeElement)}})}_restoreScrollBar(){const e=this._scrollBarRestoreFn;e&&(this._scrollBarRestoreFn=null,e())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(e,i,s){const l=s.container instanceof HTMLElement?s.container:N1(s.container)?this._document.querySelector(s.container):this._document.body,h=this._rendererFactory.createRenderer(null,null);if(!l)throw new Error(`The specified modal container "${s.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const m=new I8,b=(e=s.injector||e).get(Lu,null)||this._environmentInjector,E=this._getContentRef(e,b,i,m,s);let M=!1!==s.backdrop?this._attachBackdrop(l):void 0,L=this._attachWindowComponent(l,E.nodes),G=new _ne(L,E,M,s.beforeDismiss);return this._registerModalRef(G),this._registerWindowCmpt(L),G.hidden.pipe(Xo(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(h.removeClass(this._document.body,"modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),m.close=V=>{G.close(V)},m.dismiss=V=>{G.dismiss(V)},m.update=V=>{G.update(V)},G.update(s),1===this._modalRefs.length&&h.addClass(this._document.body,"modal-open"),M&&M.instance&&M.changeDetectorRef.detectChanges(),L.changeDetectorRef.detectChanges(),G}get activeInstances(){return this._activeInstances}dismissAll(e){this._modalRefs.forEach(i=>i.dismiss(e))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(e){let i=ER(pne,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector});return this._applicationRef.attachView(i.hostView),e.appendChild(i.location.nativeElement),i}_attachWindowComponent(e,i){let s=ER(yne,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector,projectableNodes:i});return this._applicationRef.attachView(s.hostView),e.appendChild(s.location.nativeElement),s}_getContentRef(e,i,s,l,h){return s?s instanceof bl?this._createFromTemplateRef(s,l):P1(s)?this._createFromString(s):this._createFromComponent(e,i,s,l,h):new H1([])}_createFromTemplateRef(e,i){const l=e.createEmbeddedView({$implicit:i,close(h){i.close(h)},dismiss(h){i.dismiss(h)}});return this._applicationRef.attachView(l),new H1([l.rootNodes],l)}_createFromString(e){const i=this._document.createTextNode(`${e}`);return new H1([[i]])}_createFromComponent(e,i,s,l,h){const b=ER(s,{environmentInjector:i,elementInjector:Zc.create({providers:[{provide:I8,useValue:l}],parent:e})}),E=b.location.nativeElement;return h.scrollable&&E.classList.add("component-host-scrollable"),this._applicationRef.attachView(b.hostView),new H1([[E]],b.hostView,b)}_setAriaHidden(e){const i=e.parentElement;i&&e!==this._document.body&&(Array.from(i.children).forEach(s=>{s!==e&&"SCRIPT"!==s.nodeName&&(this._ariaHiddenValues.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}),this._setAriaHidden(i))}_revertAriaHidden(){this._ariaHiddenValues.forEach((e,i)=>{e?i.setAttribute("aria-hidden",e):i.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(e){const i=()=>{const s=this._modalRefs.indexOf(e);s>-1&&(this._modalRefs.splice(s,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(e),this._activeInstances.emit(this._modalRefs),e.result.then(i,i)}_registerWindowCmpt(e){this._windowCmpts.push(e),this._activeWindowCmptHasChanged.next(),e.onDestroy(()=>{const i=this._windowCmpts.indexOf(e);i>-1&&(this._windowCmpts.splice(i,1),this._activeWindowCmptHasChanged.next())})}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Fm),Xt(Zc),Xt(Lu),Xt(wa),Xt(vne),Xt(z_),Xt(Wi))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),wne=(()=>{class t{constructor(e){this._ngbConfig=e,this.backdrop=!0,this.fullscreen=!1,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(e){this._animation=e}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wB))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),hg=(()=>{class t{constructor(e,i,s){this._injector=e,this._modalStack=i,this._config=s}open(e,i={}){const s={...this._config,animation:this._config.animation,...i};return this._modalStack.open(this._injector,e,s)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(e){this._modalStack.dismissAll(e)}hasOpenModals(){return this._modalStack.hasOpenModals()}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Zc),Xt(bne),Xt(wne))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),D8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({providers:[hg]})}return t})(),xne=(()=>{class t{constructor(e){this._ngbConfig=e,this.destroyOnHide=!0,this.orientation="horizontal",this.roles="tablist",this.keyboard=!1}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(e){this._animation=e}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wB))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const B8=t=>N1(t)&&""!==t;let Cne=0,Mk=(()=>{class t{constructor(e){this.templateRef=e}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(bl))};static#t=this.\u0275dir=Xn({type:t,selectors:[["ng-template","ngbNavContent",""]],standalone:!0})}return t})(),M8=(()=>{class t{constructor(e,i){this.role=e,this.nav=i}static#e=this.\u0275fac=function(i){return new(i||t)(_l("role"),Ve(Nr(()=>Q1)))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngbNavItem","",5,"ng-container"]],hostVars:1,hostBindings:function(i,s){2&i&&To("role",s.role?s.role:s.nav.roles?"presentation":void 0)},standalone:!0})}return t})(),xx=(()=>{class t{constructor(e,i){this._nav=e,this.elementRef=i,this.disabled=!1,this.shown=new vi,this.hidden=new vi}ngAfterContentChecked(){this.contentTpl=this.contentTpls.first}ngOnInit(){N1(this.domId)||(this.domId="ngb-nav-"+Cne++)}get active(){return this._nav.activeId===this.id}get id(){return B8(this._id)?this._id:this.domId}get panelDomId(){return`${this.domId}-panel`}isPanelInDom(){return(N1(this.destroyOnHide)?!this.destroyOnHide:!this._nav.destroyOnHide)||this.active}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Nr(()=>Q1)),Ve(ao))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngbNavItem",""]],contentQueries:function(i,s,l){if(1&i&&Qa(l,Mk,4),2&i){let h;is(h=rs())&&(s.contentTpls=h)}},hostVars:2,hostBindings:function(i,s){2&i&&Dt("nav-item",!0)},inputs:{destroyOnHide:"destroyOnHide",disabled:"disabled",domId:"domId",_id:["ngbNavItem","_id"]},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbNavItem"],standalone:!0})}return t})(),Q1=(()=>{class t{constructor(e,i,s,l){this.role=e,this._cd=s,this._document=l,this.activeIdChange=new vi,this.shown=new vi,this.hidden=new vi,this.destroy$=new Li,this.navItemChange$=new Li,this.navChange=new vi,this.animation=i.animation,this.destroyOnHide=i.destroyOnHide,this.orientation=i.orientation,this.roles=i.roles,this.keyboard=i.keyboard}click(e){e.disabled||this._updateActiveId(e.id)}onKeyDown(e){if("tablist"!==this.roles||!this.keyboard)return;const i=e.which,s=this.links.filter(m=>!m.navItem.disabled),{length:l}=s;let h=-1;if(s.forEach((m,b)=>{m.elRef.nativeElement===this._document.activeElement&&(h=b)}),l){switch(i){case ja.ArrowLeft:if("vertical"===this.orientation)return;h=(h-1+l)%l;break;case ja.ArrowRight:if("vertical"===this.orientation)return;h=(h+1)%l;break;case ja.ArrowDown:if("horizontal"===this.orientation)return;h=(h+1)%l;break;case ja.ArrowUp:if("horizontal"===this.orientation)return;h=(h-1+l)%l;break;case ja.Home:h=0;break;case ja.End:h=l-1}"changeWithArrows"===this.keyboard&&this.select(s[h].navItem.id),s[h].elRef.nativeElement.focus(),e.preventDefault()}}select(e){this._updateActiveId(e,!1)}ngAfterContentInit(){if(!N1(this.activeId)){const e=this.items.first?this.items.first.id:null;B8(e)&&(this._updateActiveId(e,!1),this._cd.detectChanges())}this.items.changes.pipe(Ps(this.destroy$)).subscribe(()=>this._notifyItemChanged(this.activeId))}ngOnChanges({activeId:e}){e&&!e.firstChange&&this._notifyItemChanged(e.currentValue)}ngOnDestroy(){this.destroy$.next()}_updateActiveId(e,i=!0){if(this.activeId!==e){let s=!1;i&&this.navChange.emit({activeId:this.activeId,nextId:e,preventDefault:()=>{s=!0}}),s||(this.activeId=e,this.activeIdChange.emit(e),this._notifyItemChanged(e))}}_notifyItemChanged(e){this.navItemChange$.next(this._getItemById(e))}_getItemById(e){return this.items&&this.items.find(i=>i.id===e)||null}static#e=this.\u0275fac=function(i){return new(i||t)(_l("role"),Ve(xne),Ve(gf),Ve(wa))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngbNav",""]],contentQueries:function(i,s,l){if(1&i&&(Qa(l,xx,4),Qa(l,jE,5)),2&i){let h;is(h=rs())&&(s.items=h),is(h=rs())&&(s.links=h)}},hostVars:6,hostBindings:function(i,s){1&i&&Tt("keydown.arrowLeft",function(h){return s.onKeyDown(h)})("keydown.arrowRight",function(h){return s.onKeyDown(h)})("keydown.arrowDown",function(h){return s.onKeyDown(h)})("keydown.arrowUp",function(h){return s.onKeyDown(h)})("keydown.Home",function(h){return s.onKeyDown(h)})("keydown.End",function(h){return s.onKeyDown(h)}),2&i&&(To("aria-orientation","vertical"===s.orientation&&"tablist"===s.roles?"vertical":void 0)("role",s.role?s.role:s.roles?"tablist":void 0),Dt("nav",!0)("flex-column","vertical"===s.orientation))},inputs:{activeId:"activeId",animation:"animation",destroyOnHide:"destroyOnHide",orientation:"orientation",roles:"roles",keyboard:"keyboard"},outputs:{activeIdChange:"activeIdChange",shown:"shown",hidden:"hidden",navChange:"navChange"},exportAs:["ngbNav"],standalone:!0,features:[Zo]})}return t})(),jE=(()=>{class t{constructor(e,i,s,l){this.role=e,this.navItem=i,this.nav=s,this.elRef=l}hasNavItemClass(){return this.navItem.elementRef.nativeElement.nodeType===Node.COMMENT_NODE}static#e=this.\u0275fac=function(i){return new(i||t)(_l("role"),Ve(xx),Ve(Q1),Ve(ao))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngbNavLink",""]],hostVars:14,hostBindings:function(i,s){2&i&&(np("id",s.navItem.domId),To("role",s.role?s.role:s.nav.roles?"tab":void 0)("tabindex",s.navItem.disabled?-1:void 0)("aria-controls",s.navItem.isPanelInDom()?s.navItem.panelDomId:null)("aria-selected",s.navItem.active)("aria-disabled",s.navItem.disabled),Dt("nav-link",!0)("nav-item",s.hasNavItemClass())("active",s.navItem.active)("disabled",s.navItem.disabled))},standalone:!0})}return t})(),F8=(()=>{class t{constructor(e,i){this.navItem=e,this.nav=i}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(xx),Ve(Q1))};static#t=this.\u0275dir=Xn({type:t,selectors:[["button","ngbNavLink",""]],hostAttrs:["type","button"],hostVars:1,hostBindings:function(i,s){1&i&&Tt("click",function(){return s.nav.click(s.navItem)}),2&i&&np("disabled",s.navItem.disabled)},standalone:!0,features:[f1([jE])]})}return t})();const Sne=({classList:t})=>(t.remove("show"),()=>t.remove("active")),Tne=(t,n)=>{n&&vx(t),t.classList.add("show")};let Fk=(()=>{class t{constructor(e){this.elRef=e}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(ao))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","ngbNavPane",""]],hostAttrs:[1,"tab-pane"],hostVars:5,hostBindings:function(i,s){2&i&&(np("id",s.item.panelDomId),To("role",s.role?s.role:s.nav.roles?"tabpanel":void 0)("aria-labelledby",s.item.domId),Dt("fade",s.nav.animation))},inputs:{item:"item",nav:"nav",role:"role"},standalone:!0})}return t})(),R8=(()=>{class t{constructor(e,i){this._cd=e,this._ngZone=i,this._activePane=null}isPanelTransitioning(e){return this._activePane?.item===e}ngAfterViewInit(){this._updateActivePane(),this.nav.navItemChange$.pipe(Ps(this.nav.destroy$),T1(this._activePane?.item||null),Tl(),function pX(t){return Io((n,e)=>t<=e)}(1)).subscribe(e=>{const i={animation:this.nav.animation,runningTransition:"stop"};this._cd.detectChanges(),this._activePane?mf(this._ngZone,this._activePane.elRef.nativeElement,Sne,i).subscribe(()=>{const s=this._activePane?.item;this._activePane=this._getPaneForItem(e),this._cd.markForCheck(),this._activePane&&(this._activePane.elRef.nativeElement.classList.add("active"),mf(this._ngZone,this._activePane.elRef.nativeElement,Tne,i).subscribe(()=>{e&&(e.shown.emit(),this.nav.shown.emit(e.id))})),s&&(s.hidden.emit(),this.nav.hidden.emit(s.id))}):this._updateActivePane()})}_updateActivePane(){this._activePane=this._getActivePane(),this._activePane?.elRef.nativeElement.classList.add("show"),this._activePane?.elRef.nativeElement.classList.add("active")}_getPaneForItem(e){return this._panes&&this._panes.find(i=>i.item===e)||null}_getActivePane(){return this._panes&&this._panes.find(e=>e.item.active)||null}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(gf),Ve(Wi))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["","ngbNavOutlet",""]],viewQuery:function(i,s){if(1&i&&wl(Fk,5),2&i){let l;is(l=rs())&&(s._panes=l)}},hostVars:2,hostBindings:function(i,s){2&i&&Dt("tab-content",!0)},inputs:{paneRole:"paneRole",nav:["ngbNavOutlet","nav"]},standalone:!0,features:[Af],attrs:gee,decls:1,vars:1,consts:[["ngFor","",3,"ngForOf"],["ngbNavPane","",3,"item","nav","role",4,"ngIf"],["ngbNavPane","",3,"item","nav","role"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,s){1&i&&En(0,yee,1,1,"ng-template",0),2&i&&st("ngForOf",s.nav.items)},dependencies:[Fk,Pl,Xh,Jw],encapsulation:2,changeDetection:0})}return t})(),O8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),Ine=(()=>{class t{constructor(){this.disabled=!1,this.boundaryLinks=!1,this.directionLinks=!0,this.ellipses=!0,this.maxSize=0,this.pageSize=10,this.rotate=!1}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),k8=(()=>{class t{constructor(e){this.templateRef=e}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(bl))};static#t=this.\u0275dir=Xn({type:t,selectors:[["ng-template","ngbPaginationEllipsis",""]],standalone:!0})}return t})(),P8=(()=>{class t{constructor(e){this.templateRef=e}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(bl))};static#t=this.\u0275dir=Xn({type:t,selectors:[["ng-template","ngbPaginationFirst",""]],standalone:!0})}return t})(),N8=(()=>{class t{constructor(e){this.templateRef=e}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(bl))};static#t=this.\u0275dir=Xn({type:t,selectors:[["ng-template","ngbPaginationLast",""]],standalone:!0})}return t})(),L8=(()=>{class t{constructor(e){this.templateRef=e}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(bl))};static#t=this.\u0275dir=Xn({type:t,selectors:[["ng-template","ngbPaginationNext",""]],standalone:!0})}return t})(),U8=(()=>{class t{constructor(e){this.templateRef=e}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(bl))};static#t=this.\u0275dir=Xn({type:t,selectors:[["ng-template","ngbPaginationNumber",""]],standalone:!0})}return t})(),z8=(()=>{class t{constructor(e){this.templateRef=e}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(bl))};static#t=this.\u0275dir=Xn({type:t,selectors:[["ng-template","ngbPaginationPrevious",""]],standalone:!0})}return t})(),V8=(()=>{class t{constructor(e){this.templateRef=e}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(bl))};static#t=this.\u0275dir=Xn({type:t,selectors:[["ng-template","ngbPaginationPages",""]],standalone:!0})}return t})(),Rk=(()=>{class t{constructor(e){this.pageCount=0,this.pages=[],this.page=1,this.pageChange=new vi(!0),this.disabled=e.disabled,this.boundaryLinks=e.boundaryLinks,this.directionLinks=e.directionLinks,this.ellipses=e.ellipses,this.maxSize=e.maxSize,this.pageSize=e.pageSize,this.rotate=e.rotate,this.size=e.size}hasPrevious(){return this.page>1}hasNext(){return this.page<this.pageCount}nextDisabled(){return!this.hasNext()||this.disabled}previousDisabled(){return!this.hasPrevious()||this.disabled}selectPage(e){this._updatePages(e)}ngOnChanges(e){this._updatePages(this.page)}isEllipsis(e){return-1===e}_applyEllipses(e,i){this.ellipses&&(e>0&&(e>2?this.pages.unshift(-1):2===e&&this.pages.unshift(2),this.pages.unshift(1)),i<this.pageCount&&(i<this.pageCount-2?this.pages.push(-1):i===this.pageCount-2&&this.pages.push(this.pageCount-1),this.pages.push(this.pageCount)))}_applyRotation(){let e=0,i=this.pageCount,s=Math.floor(this.maxSize/2);return this.page<=s?i=this.maxSize:this.pageCount-this.page<s?e=this.pageCount-this.maxSize:(e=this.page-s-1,i=this.page+(this.maxSize%2==0?s-1:s)),[e,i]}_applyPagination(){let i=(Math.ceil(this.page/this.maxSize)-1)*this.maxSize;return[i,i+this.maxSize]}_setPageInRange(e){const i=this.page;this.page=function dte(t,n,e=0){return Math.max(Math.min(t,n),e)}(e,this.pageCount,1),this.page!==i&&Sc(this.collectionSize)&&this.pageChange.emit(this.page)}_updatePages(e){this.pageCount=Math.ceil(this.collectionSize/this.pageSize),Sc(this.pageCount)||(this.pageCount=0),this.pages.length=0;for(let i=1;i<=this.pageCount;i++)this.pages.push(i);if(this._setPageInRange(e),this.maxSize>0&&this.pageCount>this.maxSize){let i=0,s=this.pageCount;[i,s]=this.rotate?this._applyRotation():this._applyPagination(),this.pages=this.pages.slice(i,s),this._applyEllipses(i,s)}}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Ine))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["ngb-pagination"]],contentQueries:function(i,s,l){if(1&i&&(Qa(l,k8,5),Qa(l,P8,5),Qa(l,N8,5),Qa(l,L8,5),Qa(l,U8,5),Qa(l,z8,5),Qa(l,V8,5)),2&i){let h;is(h=rs())&&(s.tplEllipsis=h.first),is(h=rs())&&(s.tplFirst=h.first),is(h=rs())&&(s.tplLast=h.first),is(h=rs())&&(s.tplNext=h.first),is(h=rs())&&(s.tplNumber=h.first),is(h=rs())&&(s.tplPrevious=h.first),is(h=rs())&&(s.tplPages=h.first)}},hostAttrs:["role","navigation"],inputs:{disabled:"disabled",boundaryLinks:"boundaryLinks",directionLinks:"directionLinks",ellipses:"ellipses",rotate:"rotate",collectionSize:"collectionSize",maxSize:"maxSize",page:"page",pageSize:"pageSize",size:"size"},outputs:{pageChange:"pageChange"},standalone:!0,features:[Zo,Af],decls:20,vars:12,consts:function(){let e,i,s,l,h,m,b,E;return e=$localize`:@@ngb.pagination.first:`,i=$localize`:@@ngb.pagination.previous:`,s=$localize`:@@ngb.pagination.next:`,l=$localize`:@@ngb.pagination.last:`,h=$localize`:@@ngb.pagination.first-aria:First`,m=$localize`:@@ngb.pagination.previous-aria:Previous`,b=$localize`:@@ngb.pagination.next-aria:Next`,E=$localize`:@@ngb.pagination.last-aria:Last`,[["first",""],["previous",""],["next",""],["last",""],["ellipsis",""],["defaultNumber",""],["defaultPages",""],["class","page-item",3,"disabled",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["aria-hidden","true"],e,i,s,l,["class","page-item",3,"active","disabled",4,"ngFor","ngForOf"],[1,"page-item"],["class","page-link","tabindex","-1","aria-disabled","true",4,"ngIf"],["class","page-link","href","",3,"click",4,"ngIf"],["tabindex","-1","aria-disabled","true",1,"page-link"],["href","",1,"page-link",3,"click"],["aria-label",h,"href","",1,"page-link",3,"click"],["aria-label",m,"href","",1,"page-link",3,"click"],["aria-label",b,"href","",1,"page-link",3,"click"],["aria-label",E,"href","",1,"page-link",3,"click"]]},template:function(i,s){if(1&i&&(En(0,vee,2,0,"ng-template",null,0,Zl),En(2,bee,2,0,"ng-template",null,1,Zl),En(4,wee,2,0,"ng-template",null,2,Zl),En(6,xee,2,0,"ng-template",null,3,Zl),En(8,Cee,1,0,"ng-template",null,4,Zl),En(10,Eee,1,1,"ng-template",null,5,Zl),En(12,Ree,1,1,"ng-template",null,6,Zl),pe(14,"ul"),En(15,kee,3,9,"li",7),En(16,Lee,3,8,"li",7),En(17,Uee,0,0,"ng-template",8),En(18,Vee,3,9,"li",7),En(19,Qee,3,9,"li",7),ye()),2&i){const l=ws(13);$e(14),Mn("pagination"+(s.size?" pagination-"+s.size:"")),$e(1),st("ngIf",s.boundaryLinks),$e(1),st("ngIf",s.directionLinks),$e(1),st("ngTemplateOutlet",(null==s.tplPages?null:s.tplPages.templateRef)||l)("ngTemplateOutletContext",Y5(8,jee,s.page,s.pages,s.disabled)),$e(1),st("ngIf",s.directionLinks),$e(1),st("ngIf",s.boundaryLinks)}},dependencies:[Xh,Pl,Jw],encapsulation:2,changeDetection:0})}return t})(),H8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),Q8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),j8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),G8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),$8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})();class q8{constructor(n,e,i){this.hour=Ch(n),this.minute=Ch(e),this.second=Ch(i)}changeHour(n=1){this.updateHour((isNaN(this.hour)?0:this.hour)+n)}updateHour(n){this.hour=Sc(n)?(n<0?24+n:n)%24:NaN}changeMinute(n=1){this.updateMinute((isNaN(this.minute)?0:this.minute)+n)}updateMinute(n){Sc(n)?(this.minute=n%60<0?60+n%60:n%60,this.changeHour(Math.floor(n/60))):this.minute=NaN}changeSecond(n=1){this.updateSecond((isNaN(this.second)?0:this.second)+n)}updateSecond(n){Sc(n)?(this.second=n<0?60+n%60:n%60,this.changeMinute(Math.floor(n/60))):this.second=NaN}isValid(n=!0){return Sc(this.hour)&&Sc(this.minute)&&(!n||Sc(this.second))}toString(){return`${this.hour||0}:${this.minute||0}:${this.second||0}`}}let Rne=(()=>{class t{constructor(){this.meridian=!1,this.spinners=!0,this.seconds=!1,this.hourStep=1,this.minuteStep=1,this.secondStep=1,this.disabled=!1,this.readonlyInputs=!1,this.size="medium"}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),K8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(){return function One(){return new kne}()},providedIn:"root"})}return t})(),kne=(()=>{class t extends K8{fromModel(e){return e&&Xl(e.hour)&&Xl(e.minute)?{hour:e.hour,minute:e.minute,second:Xl(e.second)?e.second:null}:null}toModel(e){return e&&Xl(e.hour)&&Xl(e.minute)?{hour:e.hour,minute:e.minute,second:Xl(e.second)?e.second:null}:null}static#e=this.\u0275fac=function(){let e;return function(s){return(e||(e=Ms(t)))(s||t)}}();static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})(),W8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:function(i){let s=null;return s=i?new i:function Pne(t){return new Nne(t)}(Xt(uA)),s},providedIn:"root"})}return t})(),Nne=(()=>{class t extends W8{constructor(e){super(),this._periods=p4(e,vu.Standalone,jo.Narrow)}getMorningPeriod(){return this._periods[0]}getAfternoonPeriod(){return this._periods[1]}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(uA))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();const Lne=/[^0-9]/g;let Une=(()=>{class t{set hourStep(e){this._hourStep=Xl(e)?e:this._config.hourStep}get hourStep(){return this._hourStep}set minuteStep(e){this._minuteStep=Xl(e)?e:this._config.minuteStep}get minuteStep(){return this._minuteStep}set secondStep(e){this._secondStep=Xl(e)?e:this._config.secondStep}get secondStep(){return this._secondStep}constructor(e,i,s,l){this._config=e,this._ngbTimeAdapter=i,this._cd=s,this.i18n=l,this.onChange=h=>{},this.onTouched=()=>{},this.meridian=e.meridian,this.spinners=e.spinners,this.seconds=e.seconds,this.hourStep=e.hourStep,this.minuteStep=e.minuteStep,this.secondStep=e.secondStep,this.disabled=e.disabled,this.readonlyInputs=e.readonlyInputs,this.size=e.size}writeValue(e){const i=this._ngbTimeAdapter.fromModel(e);this.model=i?new q8(i.hour,i.minute,i.second):new q8,!this.seconds&&(!i||!Sc(i.second))&&(this.model.second=0),this._cd.markForCheck()}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e}changeHour(e){this.model?.changeHour(e),this.propagateModelChange()}changeMinute(e){this.model?.changeMinute(e),this.propagateModelChange()}changeSecond(e){this.model?.changeSecond(e),this.propagateModelChange()}updateHour(e){const i=!!this.model&&this.model.hour>=12,s=Ch(e);this.model?.updateHour(this.meridian&&(i&&s<12||!i&&12===s)?s+12:s),this.propagateModelChange()}updateMinute(e){this.model?.updateMinute(Ch(e)),this.propagateModelChange()}updateSecond(e){this.model?.updateSecond(Ch(e)),this.propagateModelChange()}toggleMeridian(){this.meridian&&this.changeHour(12)}formatInput(e){e.value=e.value.replace(Lne,"")}formatHour(e){return Sc(e)?yx(this.meridian?e%12==0?12:e%12:e%24):yx(NaN)}formatMinSec(e){return yx(Sc(e)?e:NaN)}handleBlur(){this.onTouched()}get isSmallSize(){return"small"===this.size}get isLargeSize(){return"large"===this.size}ngOnChanges(e){e.seconds&&!this.seconds&&this.model&&!Sc(this.model.second)&&(this.model.second=0,this.propagateModelChange(!1))}propagateModelChange(e=!0){e&&this.onTouched(),this.model?.isValid(this.seconds)?this.onChange(this._ngbTimeAdapter.toModel({hour:this.model.hour,minute:this.model.minute,second:this.model.second})):this.onChange(this._ngbTimeAdapter.toModel(null))}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Rne),Ve(K8),Ve(gf),Ve(W8))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["ngb-timepicker"]],inputs:{meridian:"meridian",spinners:"spinners",seconds:"seconds",hourStep:"hourStep",minuteStep:"minuteStep",secondStep:"secondStep",readonlyInputs:"readonlyInputs",size:"size"},exportAs:["ngbTimepicker"],standalone:!0,features:[Qo([{provide:dA,useExisting:Nr(()=>t),multi:!0}]),Zo,Af],decls:16,vars:25,consts:function(){let e,i,s,l,h,m,b,E,M,L,G,V,ne,re;return e=$localize`:@@ngb.timepicker.HH:HH`,i=$localize`:@@ngb.timepicker.hours:Hours`,s=$localize`:@@ngb.timepicker.MM:MM`,l=$localize`:@@ngb.timepicker.minutes:Minutes`,h=$localize`:@@ngb.timepicker.increment-hours:Increment hours`,m=$localize`:@@ngb.timepicker.decrement-hours:Decrement hours`,b=$localize`:@@ngb.timepicker.increment-minutes:Increment minutes`,E=$localize`:@@ngb.timepicker.decrement-minutes:Decrement minutes`,M=$localize`:@@ngb.timepicker.SS:SS`,L=$localize`:@@ngb.timepicker.seconds:Seconds`,G=$localize`:@@ngb.timepicker.increment-seconds:Increment seconds`,V=$localize`:@@ngb.timepicker.decrement-seconds:Decrement seconds`,ne=$localize`:@@ngb.timepicker.PM:${"\ufffd0\ufffd"}:INTERPOLATION:`,re=$localize`:@@ngb.timepicker.AM:${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"disabled"],[1,"ngb-tp"],[1,"ngb-tp-input-container","ngb-tp-hour"],["tabindex","-1","type","button","class","btn btn-link",3,"btn-sm","btn-lg","disabled","click",4,"ngIf"],["type","text","maxlength","2","inputmode","numeric","placeholder",e,"aria-label",i,1,"ngb-tp-input","form-control",3,"value","readOnly","disabled","change","blur","input","keydown.ArrowUp","keydown.ArrowDown"],[1,"ngb-tp-spacer"],[1,"ngb-tp-input-container","ngb-tp-minute"],["type","text","maxlength","2","inputmode","numeric","placeholder",s,"aria-label",l,1,"ngb-tp-input","form-control",3,"value","readOnly","disabled","change","blur","input","keydown.ArrowUp","keydown.ArrowDown"],["class","ngb-tp-spacer",4,"ngIf"],["class","ngb-tp-input-container ngb-tp-second",4,"ngIf"],["class","ngb-tp-meridian",4,"ngIf"],["tabindex","-1","type","button",1,"btn","btn-link",3,"disabled","click"],[1,"chevron","ngb-tp-chevron"],[1,"visually-hidden"],h,[1,"chevron","ngb-tp-chevron","bottom"],m,b,E,[1,"ngb-tp-input-container","ngb-tp-second"],["type","text","maxlength","2","inputmode","numeric","placeholder",M,"aria-label",L,1,"ngb-tp-input","form-control",3,"value","readOnly","disabled","change","blur","input","keydown.ArrowUp","keydown.ArrowDown"],G,V,[1,"ngb-tp-meridian"],["type","button",1,"btn","btn-outline-primary",3,"disabled","click"],[4,"ngIf","ngIfElse"],["am",""],ne,re]},template:function(i,s){1&i&&(pe(0,"fieldset",0)(1,"div",1)(2,"div",2),En(3,Kee,4,7,"button",3),pe(4,"input",4),Tt("change",function(h){return s.updateHour(h.target.value)})("blur",function(){return s.handleBlur()})("input",function(h){return s.formatInput(h.target)})("keydown.ArrowUp",function(h){return s.changeHour(s.hourStep),h.preventDefault()})("keydown.ArrowDown",function(h){return s.changeHour(-s.hourStep),h.preventDefault()}),ye(),En(5,Wee,4,7,"button",3),ye(),pe(6,"div",5),et(7,":"),ye(),pe(8,"div",6),En(9,Zee,4,7,"button",3),pe(10,"input",7),Tt("change",function(h){return s.updateMinute(h.target.value)})("blur",function(){return s.handleBlur()})("input",function(h){return s.formatInput(h.target)})("keydown.ArrowUp",function(h){return s.changeMinute(s.minuteStep),h.preventDefault()})("keydown.ArrowDown",function(h){return s.changeMinute(-s.minuteStep),h.preventDefault()}),ye(),En(11,Xee,4,7,"button",3),ye(),En(12,Yee,2,0,"div",8),En(13,tte,4,9,"div",9),En(14,nte,1,0,"div",8),En(15,ste,5,9,"div",10),ye()()),2&i&&(Dt("disabled",s.disabled),st("disabled",s.disabled),$e(3),st("ngIf",s.spinners),$e(1),Dt("form-control-sm",s.isSmallSize)("form-control-lg",s.isLargeSize),st("value",s.formatHour(null==s.model?null:s.model.hour))("readOnly",s.readonlyInputs)("disabled",s.disabled),$e(1),st("ngIf",s.spinners),$e(4),st("ngIf",s.spinners),$e(1),Dt("form-control-sm",s.isSmallSize)("form-control-lg",s.isLargeSize),st("value",s.formatMinSec(null==s.model?null:s.model.minute))("readOnly",s.readonlyInputs)("disabled",s.disabled),$e(1),st("ngIf",s.spinners),$e(1),st("ngIf",s.seconds),$e(1),st("ngIf",s.seconds),$e(1),st("ngIf",s.meridian),$e(1),st("ngIf",s.meridian))},dependencies:[Xh],styles:['ngb-timepicker{font-size:1rem}.ngb-tp{display:flex;align-items:center}.ngb-tp-input-container{width:4em}.ngb-tp-chevron:before{border-style:solid;border-width:.29em .29em 0 0;content:"";display:inline-block;height:.69em;left:.05em;position:relative;top:.15em;transform:rotate(-45deg);vertical-align:middle;width:.69em}.ngb-tp-chevron.bottom:before{top:-.3em;transform:rotate(135deg)}.ngb-tp-input{text-align:center}.ngb-tp-hour,.ngb-tp-minute,.ngb-tp-second,.ngb-tp-meridian{display:flex;flex-direction:column;align-items:center;justify-content:space-around}.ngb-tp-spacer{width:1em;text-align:center}\n'],encapsulation:2})}return t})(),Z8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),X8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),Y8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),GE=(()=>{class t{constructor(){this.highlightClass="ngb-highlight",this.accentSensitive=!0}ngOnChanges(e){!this.accentSensitive&&!String.prototype.normalize&&(console.warn("The `accentSensitive` input in `ngb-highlight` cannot be set to `false` in a browser that does not implement the `String.normalize` function. You will have to include a polyfill in your application to use this feature in the current browser."),this.accentSensitive=!0);const i=zz(this.result),s=Array.isArray(this.term)?this.term:[this.term],l=E=>this.accentSensitive?E:Hz(E),h=s.map(E=>function fte(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(l(zz(E)))).filter(E=>E),m=this.accentSensitive?i:Hz(i),b=h.length?m.split(new RegExp(`(${h.join("|")})`,"gmi")):[i];if(this.accentSensitive)this.parts=b;else{let E=0;this.parts=b.map(M=>i.substring(E,E+=M.length))}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=Mr({type:t,selectors:[["ngb-highlight"]],inputs:{highlightClass:"highlightClass",result:"result",term:"term",accentSensitive:"accentSensitive"},standalone:!0,features:[Zo,Af],decls:1,vars:1,consts:[["ngFor","",3,"ngForOf"],[3,"class",4,"ngIf","ngIfElse"],["even",""]],template:function(i,s){1&i&&En(0,cte,3,2,"ng-template",0),2&i&&st("ngForOf",s.parts)},dependencies:[Xh,Pl],styles:[".ngb-highlight{font-weight:700}\n"],encapsulation:2,changeDetection:0})}return t})();new pi("live announcer delay",{providedIn:"root",factory:function zne(){return 100}});let Ok=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),J8=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})();const Hne=[Jz,e8,i8,r8,E8,T8,D8,O8,J8,H8,Q8,j8,G8,$8,Z8,X8,Y8,Ok];let Qne=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({imports:[Hne,Jz,e8,i8,r8,E8,T8,D8,O8,J8,H8,Q8,j8,G8,$8,Z8,X8,Y8,Ok]})}return t})();function Uy(t,n=dx){return Xs((e,i)=>{let s=null,l=null,h=null;const m=()=>{if(s){s.unsubscribe(),s=null;const E=l;l=null,i.next(E)}};function b(){const E=h+t,M=n.now();if(M<E)return s=this.schedule(void 0,E-M),void i.add(s);m()}e.subscribe(Kr(i,E=>{l=E,h=n.now(),s||(s=n.schedule(b,t),i.add(s))},()=>{m(),i.complete()},void 0,()=>{l=s=null}))})}let zy=(()=>{class t{constructor(){this.active="1"}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();class jne{}const xl_apiHost="http://localhost:3000";class Gne{constructor(){this.employee_number="",this.employee_name="",this.route_name=""}}class RB{}class OB{}class Eh{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(e=>{const i=e.indexOf(":");if(i>0){const s=e.slice(0,i),l=s.toLowerCase(),h=e.slice(i+1).trim();this.maybeSetNormalizedName(s,l),this.headers.has(l)?this.headers.get(l).push(h):this.headers.set(l,[h])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((e,i)=>{this.setHeaderEntries(i,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([e,i])=>{this.setHeaderEntries(e,i)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const e=this.headers.get(n.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,e){return this.clone({name:n,value:e,op:"a"})}set(n,e){return this.clone({name:n,value:e,op:"s"})}delete(n,e){return this.clone({name:n,value:e,op:"d"})}maybeSetNormalizedName(n,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,n)}init(){this.lazyInit&&(this.lazyInit instanceof Eh?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(e=>{this.headers.set(e,n.headers.get(e)),this.normalizedNames.set(e,n.normalizedNames.get(e))})}clone(n){const e=new Eh;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Eh?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([n]),e}applyUpdate(n){const e=n.name.toLowerCase();switch(n.op){case"a":case"s":let i=n.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(n.name,e);const s=("a"===n.op?this.headers.get(e):void 0)||[];s.push(...i),this.headers.set(e,s);break;case"d":const l=n.value;if(l){let h=this.headers.get(e);if(!h)return;h=h.filter(m=>-1===l.indexOf(m)),0===h.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,h)}else this.headers.delete(e),this.normalizedNames.delete(e)}}setHeaderEntries(n,e){const i=(Array.isArray(e)?e:[e]).map(l=>l.toString()),s=n.toLowerCase();this.headers.set(s,i),this.maybeSetNormalizedName(n,s)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>n(this.normalizedNames.get(e),this.headers.get(e)))}}class $ne{encodeKey(n){return eV(n)}encodeValue(n){return eV(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const Kne=/%(\d[a-f0-9])/gi,Wne={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function eV(t){return encodeURIComponent(t).replace(Kne,(n,e)=>Wne[e]??n)}function kB(t){return`${t}`}class gA{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new $ne,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function qne(t,n){const e=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(s=>{const l=s.indexOf("="),[h,m]=-1==l?[n.decodeKey(s),""]:[n.decodeKey(s.slice(0,l)),n.decodeValue(s.slice(l+1))],b=e.get(h)||[];b.push(m),e.set(h,b)}),e}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(e=>{const i=n.fromObject[e],s=Array.isArray(i)?i.map(kB):[kB(i)];this.map.set(e,s)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const e=this.map.get(n);return e?e[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,e){return this.clone({param:n,value:e,op:"a"})}appendAll(n){const e=[];return Object.keys(n).forEach(i=>{const s=n[i];Array.isArray(s)?s.forEach(l=>{e.push({param:i,value:l,op:"a"})}):e.push({param:i,value:s,op:"a"})}),this.clone(e)}set(n,e){return this.clone({param:n,value:e,op:"s"})}delete(n,e){return this.clone({param:n,value:e,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const e=this.encoder.encodeKey(n);return this.map.get(n).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const e=new gA({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(n),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const e=("a"===n.op?this.map.get(n.param):void 0)||[];e.push(kB(n.value)),this.map.set(n.param,e);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let i=this.map.get(n.param)||[];const s=i.indexOf(kB(n.value));-1!==s&&i.splice(s,1),i.length>0?this.map.set(n.param,i):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class Zne{constructor(){this.map=new Map}set(n,e){return this.map.set(n,e),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function tV(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function nV(t){return typeof Blob<"u"&&t instanceof Blob}function iV(t){return typeof FormData<"u"&&t instanceof FormData}class $E{constructor(n,e,i,s){let l;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function Xne(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==i?i:null,l=s):l=i,l&&(this.reportProgress=!!l.reportProgress,this.withCredentials=!!l.withCredentials,l.responseType&&(this.responseType=l.responseType),l.headers&&(this.headers=l.headers),l.context&&(this.context=l.context),l.params&&(this.params=l.params)),this.headers||(this.headers=new Eh),this.context||(this.context=new Zne),this.params){const h=this.params.toString();if(0===h.length)this.urlWithParams=e;else{const m=e.indexOf("?");this.urlWithParams=e+(-1===m?"?":m<e.length-1?"&":"")+h}}else this.params=new gA,this.urlWithParams=e}serializeBody(){return null===this.body?null:tV(this.body)||nV(this.body)||iV(this.body)||function Yne(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof gA?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||iV(this.body)?null:nV(this.body)?this.body.type||null:tV(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof gA?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const e=n.method||this.method,i=n.url||this.url,s=n.responseType||this.responseType,l=void 0!==n.body?n.body:this.body,h=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,m=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let b=n.headers||this.headers,E=n.params||this.params;const M=n.context??this.context;return void 0!==n.setHeaders&&(b=Object.keys(n.setHeaders).reduce((L,G)=>L.set(G,n.setHeaders[G]),b)),n.setParams&&(E=Object.keys(n.setParams).reduce((L,G)=>L.set(G,n.setParams[G]),E)),new $E(e,i,l,{params:E,headers:b,context:M,reportProgress:m,responseType:s,withCredentials:h})}}var Cx=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(Cx||{});class kk{constructor(n,e=200,i="OK"){this.headers=n.headers||new Eh,this.status=void 0!==n.status?n.status:e,this.statusText=n.statusText||i,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class Pk extends kk{constructor(n={}){super(n),this.type=Cx.ResponseHeader}clone(n={}){return new Pk({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class Ex extends kk{constructor(n={}){super(n),this.type=Cx.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new Ex({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class rV extends kk{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function Nk(t,n){return{body:n,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let dg=(()=>{class t{constructor(e){this.handler=e}request(e,i,s={}){let l;if(e instanceof $E)l=e;else{let b,E;b=s.headers instanceof Eh?s.headers:new Eh(s.headers),s.params&&(E=s.params instanceof gA?s.params:new gA({fromObject:s.params})),l=new $E(e,i,void 0!==s.body?s.body:null,{headers:b,context:s.context,params:E,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const h=Bi(l).pipe(nx(b=>this.handler.handle(b)));if(e instanceof $E||"events"===s.observe)return h;const m=h.pipe(Io(b=>b instanceof Ex));switch(s.observe||"body"){case"body":switch(l.responseType){case"arraybuffer":return m.pipe(Ht(b=>{if(null!==b.body&&!(b.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return b.body}));case"blob":return m.pipe(Ht(b=>{if(null!==b.body&&!(b.body instanceof Blob))throw new Error("Response is not a Blob.");return b.body}));case"text":return m.pipe(Ht(b=>{if(null!==b.body&&"string"!=typeof b.body)throw new Error("Response is not a string.");return b.body}));default:return m.pipe(Ht(b=>b.body))}case"response":return m;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:(new gA).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,s={}){return this.request("PATCH",e,Nk(s,i))}post(e,i,s={}){return this.request("POST",e,Nk(s,i))}put(e,i,s={}){return this.request("PUT",e,Nk(s,i))}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(RB))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();function aV(t,n){return n(t)}function eie(t,n){return(e,i)=>n.intercept(e,{handle:s=>t(s,i)})}const lV=new pi(""),qE=new pi(""),cV=new pi("");function nie(){let t=null;return(n,e)=>{null===t&&(t=(In(lV,{optional:!0})??[]).reduceRight(eie,aV));const i=In(pD),s=i.add();return t(n,e).pipe(lE(()=>i.remove(s)))}}let uV=(()=>{class t extends RB{constructor(e,i){super(),this.backend=e,this.injector=i,this.chain=null,this.pendingTasks=In(pD)}handle(e){if(null===this.chain){const s=Array.from(new Set([...this.injector.get(qE),...this.injector.get(cV,[])]));this.chain=s.reduceRight((l,h)=>function tie(t,n,e){return(i,s)=>e.runInContext(()=>n(i,l=>t(l,s)))}(l,h,this.injector),aV)}const i=this.pendingTasks.add();return this.chain(e,s=>this.backend.handle(s)).pipe(lE(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(OB),Xt(Lu))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();const oie=/^\)\]\}',?\n/;let dV=(()=>{class t{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new ln(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?Gs(i.\u0275loadImpl()):Bi(null)).pipe(cl(()=>new Hr(l=>{const h=i.build();if(h.open(e.method,e.urlWithParams),e.withCredentials&&(h.withCredentials=!0),e.headers.forEach((re,de)=>h.setRequestHeader(re,de.join(","))),e.headers.has("Accept")||h.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const re=e.detectContentTypeHeader();null!==re&&h.setRequestHeader("Content-Type",re)}if(e.responseType){const re=e.responseType.toLowerCase();h.responseType="json"!==re?re:"text"}const m=e.serializeBody();let b=null;const E=()=>{if(null!==b)return b;const re=h.statusText||"OK",de=new Eh(h.getAllResponseHeaders()),fe=function aie(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(h)||e.url;return b=new Pk({headers:de,status:h.status,statusText:re,url:fe}),b},M=()=>{let{headers:re,status:de,statusText:fe,url:he}=E(),Ne=null;204!==de&&(Ne=typeof h.response>"u"?h.responseText:h.response),0===de&&(de=Ne?200:0);let We=de>=200&&de<300;if("json"===e.responseType&&"string"==typeof Ne){const pt=Ne;Ne=Ne.replace(oie,"");try{Ne=""!==Ne?JSON.parse(Ne):null}catch(Qt){Ne=pt,We&&(We=!1,Ne={error:Qt,text:Ne})}}We?(l.next(new Ex({body:Ne,headers:re,status:de,statusText:fe,url:he||void 0})),l.complete()):l.error(new rV({error:Ne,headers:re,status:de,statusText:fe,url:he||void 0}))},L=re=>{const{url:de}=E(),fe=new rV({error:re,status:h.status||0,statusText:h.statusText||"Unknown Error",url:de||void 0});l.error(fe)};let G=!1;const V=re=>{G||(l.next(E()),G=!0);let de={type:Cx.DownloadProgress,loaded:re.loaded};re.lengthComputable&&(de.total=re.total),"text"===e.responseType&&h.responseText&&(de.partialText=h.responseText),l.next(de)},ne=re=>{let de={type:Cx.UploadProgress,loaded:re.loaded};re.lengthComputable&&(de.total=re.total),l.next(de)};return h.addEventListener("load",M),h.addEventListener("error",L),h.addEventListener("timeout",L),h.addEventListener("abort",L),e.reportProgress&&(h.addEventListener("progress",V),null!==m&&h.upload&&h.upload.addEventListener("progress",ne)),h.send(m),l.next({type:Cx.Sent}),()=>{h.removeEventListener("error",L),h.removeEventListener("abort",L),h.removeEventListener("load",M),h.removeEventListener("timeout",L),e.reportProgress&&(h.removeEventListener("progress",V),null!==m&&h.upload&&h.upload.removeEventListener("progress",ne)),h.readyState!==h.DONE&&h.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(R4))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();const Lk=new pi("XSRF_ENABLED"),fV=new pi("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),AV=new pi("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class pV{}let uie=(()=>{class t{constructor(e,i,s){this.doc=e,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=C4(e,this.cookieName),this.lastCookieString=e),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wa),Xt(Uu),Xt(fV))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();function hie(t,n){const e=t.url.toLowerCase();if(!In(Lk)||"GET"===t.method||"HEAD"===t.method||e.startsWith("http://")||e.startsWith("https://"))return n(t);const i=In(pV).getToken(),s=In(AV);return null!=i&&!t.headers.has(s)&&(t=t.clone({headers:t.headers.set(s,i)})),n(t)}var Vy=function(t){return t[t.Interceptors=0]="Interceptors",t[t.LegacyInterceptors=1]="LegacyInterceptors",t[t.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",t[t.NoXsrfProtection=3]="NoXsrfProtection",t[t.JsonpSupport=4]="JsonpSupport",t[t.RequestsMadeViaParent=5]="RequestsMadeViaParent",t[t.Fetch=6]="Fetch",t}(Vy||{});function die(...t){const n=[dg,dV,uV,{provide:RB,useExisting:uV},{provide:OB,useExisting:dV},{provide:qE,useValue:hie,multi:!0},{provide:Lk,useValue:!0},{provide:pV,useClass:uie}];for(const e of t)n.push(...e.\u0275providers);return ny(n)}const gV=new pi("LEGACY_INTERCEPTOR_FN");function fie(){return function j1(t,n){return{\u0275kind:t,\u0275providers:n}}(Vy.LegacyInterceptors,[{provide:gV,useFactory:nie},{provide:qE,useExisting:gV,multi:!0}])}let Aie=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({providers:[die(fie())]})}return t})();const mV=["*"];class fg{_clearListeners(){for(const n of this._listeners)n.remove();this._listeners=[]}constructor(n){this._ngZone=n,this._pending=[],this._listeners=[],this._targetStream=new Fi(void 0)}getLazyEmitter(n){return this._targetStream.pipe(cl(e=>{const i=new Hr(s=>{if(!e)return void this._pending.push({observable:i,observer:s});const l=e.addListener(n,h=>{this._ngZone.run(()=>s.next(h))});if(l)return this._listeners.push(l),()=>l.remove();s.complete()});return i}))}setTarget(n){const e=this._targetStream.value;n!==e&&(e&&(this._clearListeners(),this._pending=[]),this._targetStream.next(n),this._pending.forEach(i=>i.observable.subscribe(i.observer)),this._pending=[])}destroy(){this._clearListeners(),this._pending=[],this._targetStream.complete()}}const KE={center:{lat:37.421995,lng:-122.084092},zoom:17,mapTypeId:"roadmap"};let Yh=(()=>{class t{set center(e){this._center=e}set zoom(e){this._zoom=e}set options(e){this._options=e||KE}constructor(e,i,s){if(this._elementRef=e,this._ngZone=i,this._eventManager=new fg(In(Wi)),this.height="500px",this.width="500px",this._options=KE,this.mapInitialized=new vi,this.authFailure=new vi,this.boundsChanged=this._eventManager.getLazyEmitter("bounds_changed"),this.centerChanged=this._eventManager.getLazyEmitter("center_changed"),this.mapClick=this._eventManager.getLazyEmitter("click"),this.mapDblclick=this._eventManager.getLazyEmitter("dblclick"),this.mapDrag=this._eventManager.getLazyEmitter("drag"),this.mapDragend=this._eventManager.getLazyEmitter("dragend"),this.mapDragstart=this._eventManager.getLazyEmitter("dragstart"),this.headingChanged=this._eventManager.getLazyEmitter("heading_changed"),this.idle=this._eventManager.getLazyEmitter("idle"),this.maptypeidChanged=this._eventManager.getLazyEmitter("maptypeid_changed"),this.mapMousemove=this._eventManager.getLazyEmitter("mousemove"),this.mapMouseout=this._eventManager.getLazyEmitter("mouseout"),this.mapMouseover=this._eventManager.getLazyEmitter("mouseover"),this.projectionChanged=this._eventManager.getLazyEmitter("projection_changed"),this.mapRightclick=this._eventManager.getLazyEmitter("rightclick"),this.tilesloaded=this._eventManager.getLazyEmitter("tilesloaded"),this.tiltChanged=this._eventManager.getLazyEmitter("tilt_changed"),this.zoomChanged=this._eventManager.getLazyEmitter("zoom_changed"),this._isBrowser=OD(s),this._isBrowser){const l=window;this._existingAuthFailureCallback=l.gm_authFailure,l.gm_authFailure=()=>{this._existingAuthFailureCallback&&this._existingAuthFailureCallback(),this.authFailure.emit()}}}ngOnChanges(e){(e.height||e.width)&&this._setSize();const i=this.googleMap;i&&(e.options&&i.setOptions(this._combineOptions()),e.center&&this._center&&i.setCenter(this._center),e.zoom&&null!=this._zoom&&i.setZoom(this._zoom),e.mapTypeId&&this.mapTypeId&&i.setMapTypeId(this.mapTypeId))}ngOnInit(){this._isBrowser&&(this._mapEl=this._elementRef.nativeElement.querySelector(".map-container"),this._setSize(),this._ngZone.runOutsideAngular(()=>{this.googleMap=new google.maps.Map(this._mapEl,this._combineOptions())}),this._eventManager.setTarget(this.googleMap),this.mapInitialized.emit(this.googleMap))}ngOnDestroy(){this._eventManager.destroy(),this._isBrowser&&(window.gm_authFailure=this._existingAuthFailureCallback)}fitBounds(e,i){this._assertInitialized(),this.googleMap.fitBounds(e,i)}panBy(e,i){this._assertInitialized(),this.googleMap.panBy(e,i)}panTo(e){this._assertInitialized(),this.googleMap.panTo(e)}panToBounds(e,i){this._assertInitialized(),this.googleMap.panToBounds(e,i)}getBounds(){return this._assertInitialized(),this.googleMap.getBounds()||null}getCenter(){return this._assertInitialized(),this.googleMap.getCenter()}getClickableIcons(){return this._assertInitialized(),this.googleMap.getClickableIcons()}getHeading(){return this._assertInitialized(),this.googleMap.getHeading()}getMapTypeId(){return this._assertInitialized(),this.googleMap.getMapTypeId()}getProjection(){return this._assertInitialized(),this.googleMap.getProjection()||null}getStreetView(){return this._assertInitialized(),this.googleMap.getStreetView()}getTilt(){return this._assertInitialized(),this.googleMap.getTilt()}getZoom(){return this._assertInitialized(),this.googleMap.getZoom()}get controls(){return this._assertInitialized(),this.googleMap.controls}get data(){return this._assertInitialized(),this.googleMap.data}get mapTypes(){return this._assertInitialized(),this.googleMap.mapTypes}get overlayMapTypes(){return this._assertInitialized(),this.googleMap.overlayMapTypes}_setSize(){if(this._mapEl){const e=this._mapEl.style;e.height=null===this.height?"":vV(this.height)||"500px",e.width=null===this.width?"":vV(this.width)||"500px"}}_combineOptions(){const e=this._options||{};return{...e,center:this._center||e.center||KE.center,zoom:this._zoom??e.zoom??KE.zoom,mapTypeId:this.mapTypeId||e.mapTypeId||KE.mapTypeId}}_assertInitialized(){}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(ao),Ve(Wi),Ve(Uu))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["google-map"]],inputs:{height:"height",width:"width",mapTypeId:"mapTypeId",center:"center",zoom:"zoom",options:"options"},outputs:{mapInitialized:"mapInitialized",authFailure:"authFailure",boundsChanged:"boundsChanged",centerChanged:"centerChanged",mapClick:"mapClick",mapDblclick:"mapDblclick",mapDrag:"mapDrag",mapDragend:"mapDragend",mapDragstart:"mapDragstart",headingChanged:"headingChanged",idle:"idle",maptypeidChanged:"maptypeidChanged",mapMousemove:"mapMousemove",mapMouseout:"mapMouseout",mapMouseover:"mapMouseover",projectionChanged:"projectionChanged",mapRightclick:"mapRightclick",tilesloaded:"tilesloaded",tiltChanged:"tiltChanged",zoomChanged:"zoomChanged"},exportAs:["googleMap"],features:[Zo],ngContentSelectors:mV,decls:2,vars:0,consts:[[1,"map-container"]],template:function(i,s){1&i&&(Nw(),oi(0,"div",0),Lw(1))},encapsulation:2,changeDetection:0})}return t})();const vie=/([A-Za-z%]+)$/;function vV(t){return null==t?"":vie.test(t)?t:`${t}px`}let bV=(()=>{class t{set directions(e){this._directions=e}set options(e){this._options=e}constructor(e,i){this._googleMap=e,this._ngZone=i,this._eventManager=new fg(In(Wi)),this.directionsChanged=this._eventManager.getLazyEmitter("directions_changed")}ngOnInit(){this._googleMap._isBrowser&&(this._ngZone.runOutsideAngular(()=>{this.directionsRenderer=new google.maps.DirectionsRenderer(this._combineOptions())}),this._assertInitialized(),this.directionsRenderer.setMap(this._googleMap.googleMap),this._eventManager.setTarget(this.directionsRenderer))}ngOnChanges(e){this.directionsRenderer&&(e.options&&this.directionsRenderer.setOptions(this._combineOptions()),e.directions&&void 0!==this._directions&&this.directionsRenderer.setDirections(this._directions))}ngOnDestroy(){this._eventManager.destroy(),this.directionsRenderer&&this.directionsRenderer.setMap(null)}getDirections(){return this._assertInitialized(),this.directionsRenderer.getDirections()}getPanel(){return this._assertInitialized(),this.directionsRenderer.getPanel()}getRouteIndex(){return this._assertInitialized(),this.directionsRenderer.getRouteIndex()}_combineOptions(){const e=this._options||{};return{...e,directions:this._directions||e.directions,map:this._googleMap.googleMap}}_assertInitialized(){}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Yh),Ve(Wi))};static#t=this.\u0275dir=Xn({type:t,selectors:[["map-directions-renderer"]],inputs:{directions:"directions",options:"options"},outputs:{directionsChanged:"directionsChanged"},exportAs:["mapDirectionsRenderer"],features:[Zo]})}return t})();const Sie={position:{lat:37.421995,lng:-122.084092}};let NB=(()=>{class t{set title(e){this._title=e}set position(e){this._position=e}set label(e){this._label=e}set clickable(e){this._clickable=e}set options(e){this._options=e}set icon(e){this._icon=e}set visible(e){this._visible=e}constructor(e,i){this._googleMap=e,this._ngZone=i,this._eventManager=new fg(In(Wi)),this.animationChanged=this._eventManager.getLazyEmitter("animation_changed"),this.mapClick=this._eventManager.getLazyEmitter("click"),this.clickableChanged=this._eventManager.getLazyEmitter("clickable_changed"),this.cursorChanged=this._eventManager.getLazyEmitter("cursor_changed"),this.mapDblclick=this._eventManager.getLazyEmitter("dblclick"),this.mapDrag=this._eventManager.getLazyEmitter("drag"),this.mapDragend=this._eventManager.getLazyEmitter("dragend"),this.draggableChanged=this._eventManager.getLazyEmitter("draggable_changed"),this.mapDragstart=this._eventManager.getLazyEmitter("dragstart"),this.flatChanged=this._eventManager.getLazyEmitter("flat_changed"),this.iconChanged=this._eventManager.getLazyEmitter("icon_changed"),this.mapMousedown=this._eventManager.getLazyEmitter("mousedown"),this.mapMouseout=this._eventManager.getLazyEmitter("mouseout"),this.mapMouseover=this._eventManager.getLazyEmitter("mouseover"),this.mapMouseup=this._eventManager.getLazyEmitter("mouseup"),this.positionChanged=this._eventManager.getLazyEmitter("position_changed"),this.mapRightclick=this._eventManager.getLazyEmitter("rightclick"),this.shapeChanged=this._eventManager.getLazyEmitter("shape_changed"),this.titleChanged=this._eventManager.getLazyEmitter("title_changed"),this.visibleChanged=this._eventManager.getLazyEmitter("visible_changed"),this.zindexChanged=this._eventManager.getLazyEmitter("zindex_changed")}ngOnInit(){this._googleMap._isBrowser&&(this._ngZone.runOutsideAngular(()=>{this.marker=new google.maps.Marker(this._combineOptions())}),this._assertInitialized(),this.marker.setMap(this._googleMap.googleMap),this._eventManager.setTarget(this.marker))}ngOnChanges(e){const{marker:i,_title:s,_position:l,_label:h,_clickable:m,_icon:b,_visible:E}=this;i&&(e.options&&i.setOptions(this._combineOptions()),e.title&&void 0!==s&&i.setTitle(s),e.position&&l&&i.setPosition(l),e.label&&void 0!==h&&i.setLabel(h),e.clickable&&void 0!==m&&i.setClickable(m),e.icon&&b&&i.setIcon(b),e.visible&&void 0!==E&&i.setVisible(E))}ngOnDestroy(){this._eventManager.destroy(),this.marker&&this.marker.setMap(null)}getAnimation(){return this._assertInitialized(),this.marker.getAnimation()||null}getClickable(){return this._assertInitialized(),this.marker.getClickable()}getCursor(){return this._assertInitialized(),this.marker.getCursor()||null}getDraggable(){return this._assertInitialized(),!!this.marker.getDraggable()}getIcon(){return this._assertInitialized(),this.marker.getIcon()||null}getLabel(){return this._assertInitialized(),this.marker.getLabel()||null}getOpacity(){return this._assertInitialized(),this.marker.getOpacity()||null}getPosition(){return this._assertInitialized(),this.marker.getPosition()||null}getShape(){return this._assertInitialized(),this.marker.getShape()||null}getTitle(){return this._assertInitialized(),this.marker.getTitle()||null}getVisible(){return this._assertInitialized(),this.marker.getVisible()}getZIndex(){return this._assertInitialized(),this.marker.getZIndex()||null}getAnchor(){return this._assertInitialized(),this.marker}_combineOptions(){const e=this._options||Sie;return{...e,title:this._title||e.title,position:this._position||e.position,label:this._label||e.label,clickable:this._clickable??e.clickable,map:this._googleMap.googleMap,icon:this._icon||e.icon,visible:this._visible??e.visible}}_assertInitialized(){}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Yh),Ve(Wi))};static#t=this.\u0275dir=Xn({type:t,selectors:[["map-marker"]],inputs:{title:"title",position:"position",label:"label",clickable:"clickable",options:"options",icon:"icon",visible:"visible"},outputs:{animationChanged:"animationChanged",mapClick:"mapClick",clickableChanged:"clickableChanged",cursorChanged:"cursorChanged",mapDblclick:"mapDblclick",mapDrag:"mapDrag",mapDragend:"mapDragend",draggableChanged:"draggableChanged",mapDragstart:"mapDragstart",flatChanged:"flatChanged",iconChanged:"iconChanged",mapMousedown:"mapMousedown",mapMouseout:"mapMouseout",mapMouseover:"mapMouseover",mapMouseup:"mapMouseup",positionChanged:"positionChanged",mapRightclick:"mapRightclick",shapeChanged:"shapeChanged",titleChanged:"titleChanged",visibleChanged:"visibleChanged",zindexChanged:"zindexChanged"},exportAs:["mapMarker"],features:[Zo]})}return t})(),wV=(()=>{class t{set options(e){this._options.next(e||{})}set path(e){this._path.next(e)}constructor(e,i){this._map=e,this._ngZone=i,this._eventManager=new fg(In(Wi)),this._options=new Fi({}),this._path=new Fi(void 0),this._destroyed=new Li,this.polylineClick=this._eventManager.getLazyEmitter("click"),this.polylineDblclick=this._eventManager.getLazyEmitter("dblclick"),this.polylineDrag=this._eventManager.getLazyEmitter("drag"),this.polylineDragend=this._eventManager.getLazyEmitter("dragend"),this.polylineDragstart=this._eventManager.getLazyEmitter("dragstart"),this.polylineMousedown=this._eventManager.getLazyEmitter("mousedown"),this.polylineMousemove=this._eventManager.getLazyEmitter("mousemove"),this.polylineMouseout=this._eventManager.getLazyEmitter("mouseout"),this.polylineMouseover=this._eventManager.getLazyEmitter("mouseover"),this.polylineMouseup=this._eventManager.getLazyEmitter("mouseup"),this.polylineRightclick=this._eventManager.getLazyEmitter("rightclick")}ngOnInit(){this._map._isBrowser&&(this._combineOptions().pipe(Xo(1)).subscribe(e=>{this._ngZone.runOutsideAngular(()=>this.polyline=new google.maps.Polyline(e)),this._assertInitialized(),this.polyline.setMap(this._map.googleMap),this._eventManager.setTarget(this.polyline)}),this._watchForOptionsChanges(),this._watchForPathChanges())}ngOnDestroy(){this._eventManager.destroy(),this._destroyed.next(),this._destroyed.complete(),this.polyline&&this.polyline.setMap(null)}getDraggable(){return this._assertInitialized(),this.polyline.getDraggable()}getEditable(){return this._assertInitialized(),this.polyline.getEditable()}getPath(){return this._assertInitialized(),this.polyline.getPath()}getVisible(){return this._assertInitialized(),this.polyline.getVisible()}_combineOptions(){return Rm([this._options,this._path]).pipe(Ht(([e,i])=>({...e,path:i||e.path})))}_watchForOptionsChanges(){this._options.pipe(Ps(this._destroyed)).subscribe(e=>{this._assertInitialized(),this.polyline.setOptions(e)})}_watchForPathChanges(){this._path.pipe(Ps(this._destroyed)).subscribe(e=>{e&&(this._assertInitialized(),this.polyline.setPath(e))})}_assertInitialized(){}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Yh),Ve(Wi))};static#t=this.\u0275dir=Xn({type:t,selectors:[["map-polyline"]],inputs:{options:"options",path:"path"},outputs:{polylineClick:"polylineClick",polylineDblclick:"polylineDblclick",polylineDrag:"polylineDrag",polylineDragend:"polylineDragend",polylineDragstart:"polylineDragstart",polylineMousedown:"polylineMousedown",polylineMousemove:"polylineMousemove",polylineMouseout:"polylineMouseout",polylineMouseover:"polylineMouseover",polylineMouseup:"polylineMouseup",polylineRightclick:"polylineRightclick"},exportAs:["mapPolyline"]})}return t})(),kie=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})(),xV=(()=>{class t{constructor(e){this._ngZone=e}route(e){return new Hr(i=>{this._directionsService||(this._directionsService=new google.maps.DirectionsService),this._directionsService.route(e,(s,l)=>{this._ngZone.run(()=>{i.next({result:s||void 0,status:l}),i.complete()})})})}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Wi))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Pie=(()=>{class t{constructor(e){this._ngZone=e}geocode(e){return new Hr(i=>{this._geocoder||(this._geocoder=new google.maps.Geocoder),this._geocoder.geocode(e,(s,l)=>{this._ngZone.run(()=>{i.next({results:s||[],status:l}),i.complete()})})})}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Wi))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Um=Zs(5861);class WE{constructor(){this.marker_type="station",this.course=1}}let G1=(()=>{class t{constructor(e){this.httpClient=e,this.markerStationPositions=[],this.markerStationPositionsByRute=[],this.stationMarkerOptionsList=[],this.selected_station=new WE,this.stations_list=[],this.stations_list_route=[],this.stations_sequence_list=[],this.check_in={hour:8,minute:0},this.onStationsReady=new vi}getStations(){this.httpClient.get("http://localhost:3000/stations").pipe(Ht(e=>e)).pipe(Ht(e=>e)).subscribe(e=>{this.stations_list=e,e.forEach(i=>{let s=this.getLatLngFromStationRow(i);this.markerStationPositions.push({lat:s[0],lng:s[1]}),this.stationMarkerOptionsList.push("station"==i.marker_type?{title:i.station_name,icon:"https://maps.gstatic.com/mapfiles/ms2/micons/bus.png",draggable:!1}:{title:i.station_name,icon:"http://maps.gstatic.com/mapfiles/ms2/micons/flag.png",draggable:!1})})})}getStationsSequenceByRoute(e){this.httpClient.get("http://localhost:3000/stations/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.stations_sequence_list=i,this.stationMarkerOptionsList=[],this.markerStationPositionsByRute=[],i.forEach(s=>{let l=this.getLatLngFromStationRow(s);this.markerStationPositionsByRute.push({lat:l[0],lng:l[1]}),this.stationMarkerOptionsList.push("station"==s.marker_type?{title:s.station_name,icon:"https://maps.gstatic.com/mapfiles/ms2/micons/bus.png",draggable:!1}:{title:s.station_name+s.station_id,icon:"http://maps.gstatic.com/mapfiles/ms2/micons/flag.png",draggable:!1})}),this.calculateRouteLong(),this.onStationsReady.emit(!0)})}getStationsByRoute(e){this.httpClient.get("http://localhost:3000/stations/byRoute/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.stations_list_route=i})}calculateRouteLong(){let e={lat:0,lng:0},i={lat:0,lng:0},s=0;this.markerStationPositionsByRute.forEach((l,h)=>{if(0==e.lat)e=l;else{0==i.lat&&(i=l);let m=this.haversine_distance(e,i);s+=m,e=i,i={lat:0,lng:0}}}),this.route_long=s,console.log(s)}haversine_distance(e,i){var l=e.lat*(Math.PI/180),h=i.lat*(Math.PI/180),m=h-l,b=(i.lng-e.lng)*(Math.PI/180);return 12742.14*Math.asin(Math.sqrt(Math.sin(m/2)*Math.sin(m/2)+Math.cos(l)*Math.cos(h)*Math.sin(b/2)*Math.sin(b/2)))}calculateDistanceToOffice(){}saveStation(e){return e.active=1,e.check_in=this.check_in.hour.toString().padStart(2,"00")+":"+this.check_in.minute.toString().padStart(2,"00"),this.httpClient.post("http://localhost:3000/stations/",e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.stations_list.push(i[0])})}updateStation(e){let i=e.station_id;return this.httpClient.put("http://localhost:3000/stations/"+i,e).pipe(Ht(s=>s)).pipe(Ht(s=>s)).subscribe(s=>{console.log(s),this.stations_list.forEach(l=>{l.station_id==i&&(l.station_name=s.station_name,l.location=s.location,l.marker_type=s.marker_type,l.course=s.course)})})}deleteStation(e){return this.httpClient.delete("http://localhost:3000/stations/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.stations_list=i,this.setStationMarkers(this.stations_list)})}getLatLngFromStationRow(e){let i=e.location.split(",",2);return i[0]=parseFloat(i[0]),i[1]=parseFloat(i[1]),i}getStationByIndex(e){return this.stations_list[e]}setStationMarkers(e){this.markerStationPositions=[],this.stationMarkerOptionsList=[],e.forEach(i=>{let s=this.getLatLngFromStationRow(i);this.markerStationPositions.push({lat:s[0],lng:s[1]}),this.stationMarkerOptionsList.push({title:i.station_name,icon:"https://maps.gstatic.com/mapfiles/ms2/micons/bus.png",draggable:!0})})}updateStationSequence(e){var i=this;return(0,Um.Z)(function*(){return yield i.stations_sequence_list.forEach((l,h)=>{l.new_sequence=h+1}),i.httpClient.put("http://localhost:3000/stations/sequence/"+e,i.stations_sequence_list).pipe(Ht(l=>l)).pipe(Ht(l=>l)).subscribe(l=>{console.log(l),i.stations_sequence_list=[],i.stations_sequence_list=l})})()}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(dg))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),ZE=(()=>{class t{constructor(e,i,s){this.httpClient=e,this.mapDirectionsService=i,this.station_service=s,this.officeMarkerOptions=[],this.markerOfficePositions=[]}getOffice(){this.httpClient.get(xl_apiHost+"/office").pipe(Ht(e=>e)).pipe(Ht(e=>e)).subscribe(e=>{this.office=e[0];let i=this.getLatLngFromPlaceRow(this.office);this.office_lat_lng=i,this.markerOfficePositions.push({lat:i[0],lng:i[1]}),this.officeMarkerOptions.push({title:this.office.office_name,icon:"http://maps.gstatic.com/mapfiles/ms2/micons/rangerstation.png",draggable:!0})})}getLatLngFromPlaceRow(e){let i=e.location.split(",",2);return i[0]=parseFloat(i[0]),i[1]=parseFloat(i[1]),i}getEmployeeDistanceToOffice(e){let i=this.getLatLngFromPlaceRow(e);const s={destination:{lat:this.office_lat_lng[0],lng:this.office_lat_lng[1]},origin:{lat:i[0],lng:i[1]},travelMode:google.maps.TravelMode.DRIVING},{DirectionsService:h}=google.maps,b=new h;return new Promise((E,M)=>{const{DirectionsStatus:V}=google.maps;b.route(s,(ne,re)=>{if(re===V.OK&&null!=ne){let de=ne.routes[0].legs[0].distance?.value;return E(de)}return M(new Error(re))})})}lastStationToOffice(){new google.maps.DirectionsRenderer;var i=this.station_service.markerStationPositionsByRute[this.station_service.markerStationPositionsByRute.length-1];const s={destination:{lat:this.office_lat_lng[0],lng:this.office_lat_lng[1]},origin:{lat:i.lat,lng:i.lng},travelMode:google.maps.TravelMode.DRIVING},{DirectionsService:h}=google.maps,b=new h;return new Promise((E,M)=>{const{DirectionsStatus:V}=google.maps;b.route(s,(ne,re)=>re===V.OK&&null!=ne?E(ne):M(new Error(re)))})}twoStationsPath(e,i){new google.maps.DirectionsRenderer;const h={destination:e,origin:i,travelMode:google.maps.TravelMode.DRIVING},{DirectionsService:b}=google.maps,M=new b;return new Promise((L,G)=>{const{DirectionsStatus:re}=google.maps;M.route(h,(de,fe)=>fe===re.OK&&null!=de?L(de):G(new Error(fe)))})}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(dg),Xt(xV),Xt(G1))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Hy=(()=>{class t{constructor(e,i,s){this.httpClient=e,this.geocoder=i,this.office_service=s,this.selected_employee=new zy,this.employee_list=[],this.employee_list_page=[],this.employee_list_latlng=[],this.calculating_geocode=!1,this.pageSize=10,this.employee_info=new Gne}getGeocoder(){this.calculating_geocode=!0,this.geocoder.geocode({address:this.selected_employee.street_name+" "+this.selected_employee.outdoor_number+" "+this.selected_employee.neighborhood+" "+this.selected_employee.city}).subscribe(({results:e})=>{this.selected_employee.location=e[0].geometry.location.lat()+","+e[0].geometry.location.lng(),this.selected_employee.place_id=e[0].place_id,this.office_service.getEmployeeDistanceToOffice(this.selected_employee).then(i=>{this.selected_employee.office_distance=i,this.calculating_geocode=!1}),console.log(e)})}getLatLngFromPlaceRow(e){let i=e.location.split(",",2);return i[0]=parseFloat(i[0]),i[1]=parseFloat(i[1]),i}getEmployees(){this.httpClient.get(xl_apiHost+"/employees").pipe(Ht(e=>e)).pipe(Ht(e=>e)).subscribe(e=>{this.employee_list=e,e.length>this.pageSize&&(this.employee_list_page=e.slice(0,this.pageSize))})}saveEmployee(e){return this.httpClient.post(xl_apiHost+"/employees",e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.employee_list.push(i[0])})}updateEmployee(e){let i=e.employee_id;return this.httpClient.put(xl_apiHost+"/employees/"+i,e).pipe(Ht(s=>s)).pipe(Ht(s=>s)).subscribe(s=>{console.log(s),this.employee_list.forEach(l=>{l.employee_id==i&&(l.employee_number=s.employee_number,l.name=s.name,l.last_name=s.last_name,l.mother_lastname=s.mother_lastname,l.street_name=s.street_name,l.interior_number=s.interior_number,l.outdoor_number=s.outdoor_number,l.vehicle_id=s.vehicle_id,l.vehicle_status=s.vehicle_status,l.neighborhood=s.neighborhood,l.personal_mail=s.personal_mail,l.company_mail=s.company_mail,l.location=s.location,l.place_id=s.place_id,l.office_distance=s.office_distance)})})}deleteEmployee(e){return this.httpClient.delete("http://localhost:3000/employees/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.employee_list=i})}getEmployeesLatLng(){return this.httpClient.get("http://localhost:3000/employees/employeesLatLng").pipe(Ht(e=>e)).pipe(Ht(e=>e))}getEmployeInfoVehicleByUser(e){return this.httpClient.get("http://localhost:3000/employees/employeeInfo/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.employee_info=i[0]})}getEmployeeVehicleByNumber(e){return this.httpClient.get(xl_apiHost+"/employees/empoyeeVehicleByNumber/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i))}findDetailToBoarding(e){return this.httpClient.get(xl_apiHost+"/tours/tourBoarding/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i))}getPassengerInfoVehicleByUser(e){return this.httpClient.get("http://localhost:3000/employees/getPassengerIngo/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.employee_info=i[0]})}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(dg),Xt(Pie),Xt(ZE))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class $1{constructor(){this.vehicle_status=1,this.private_company=1,this.active="1"}}class CV{constructor(){this.vehicle_issue_id=0}}let Sx=(()=>{class t{constructor(e){this.httpClient=e,this.selected_vehicle=new $1,this.selected_model="",this.selected_vehicle_plate="",this.vehicles_list=[],this.vehicles_list_route=[],this.vehicles_list_page=[],this.pageSize=10,this.available_vehicles_list=[]}getVehicles(){return this.httpClient.get("http://localhost:3000/vehicles").pipe(Ht(e=>e)).pipe(Ht(e=>e)).subscribe(e=>{this.vehicles_list=e,e.length>this.pageSize&&(this.vehicles_list_page=e.slice(0,this.pageSize))})}getVehiclesByRoute(e){return this.httpClient.get("http://localhost:3000/vehicles/byRoute/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.vehicles_list_route=i})}getVehiclesAvailables(){return this.available_vehicles_list=[],this.httpClient.get("http://localhost:3000/vehicles/availables").pipe(Ht(e=>e)).pipe(Ht(e=>e)).subscribe(e=>{this.available_vehicles_list.push({vehicle_id:0,licence_plate:"00000",serial_number:"0000000",vehicle_status:1,private_company:1,model_id:0,route_id:0,active:""}),e.forEach(i=>{this.available_vehicles_list.push(i)})})}saveVehicle(e){return e.active="1",this.httpClient.post("http://localhost:3000/vehicles",e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.vehicles_list.push(i[0])})}updateVehicle(e){var i=e.vehicle_id;return this.httpClient.put("http://localhost:3000/vehicles/"+i,e).pipe(Ht(s=>s)).pipe(Ht(s=>s)).subscribe(s=>{console.log(s),this.vehicles_list.forEach(l=>{l.vehicle_id==i&&(l.serial_number=s.serial_number,l.licence_plate=s.licence_plate,l.vehicle_status=s.vehicle_status,l.private_company=s.private_company,l.model_id=s.model_id,l.route_id=s.route_id)})})}deleteVehicle(e){return this.httpClient.delete("http://localhost:3000/vehicles/"+e).subscribe(i=>{console.log(i)})}setVehicleFromList(e){let i=this.vehicles_list.find(s=>s.vehicle_id==e.vehicle_id);this.selected_vehicle_plate=null!=i?i.licence_plate:""}setEmployeeInVehicle(e){return this.httpClient.post(xl_apiHost+"/vehicles/vehicleEmployee",e)}getVehicleEmployee(e){return this.httpClient.get(xl_apiHost+"/vehicles/vehicleEmployee/"+e)}removeVehicleEmployeeTour(e){return this.httpClient.post(xl_apiHost+"/vehicles/removeVehicleEmployee",e)}openIssue(e){this.httpClient.post(xl_apiHost+"/vehicles/issue/",e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.open_issue=i})}getOpenIssue(e){return this.httpClient.get(xl_apiHost+"/vehicles/issue/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i))}closeIssue(e,i){this.httpClient.delete(xl_apiHost+"/vehicles/issue/"+e+"/"+i).pipe(Ht(s=>s)).pipe(Ht(s=>s)).subscribe(s=>{this.open_issue=0!=s.length?s:new CV,alert("La incidencia se cerro con exito")})}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(dg))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),q1=(()=>{class t{constructor(e){this.httpClient=e}getUser(e,i){return this.httpClient.get(xl_apiHost+"/user/"+e+"/"+i)}createUser(e,i){this.httpClient.post(xl_apiHost+"/user/"+i,e).pipe(Ht(s=>s)).pipe(Ht(s=>s)).subscribe(s=>{console.log("Succes:"+s)})}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(dg))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Nie=["vehicle_search"],Lie=["vehicleSearchList"];function Uie(t,n){if(1&t){const e=xr();pe(0,"div",3)(1,"h4",4),et(2,"Profile update"),ye(),pe(3,"button",5),Tt("click",function(){return ni(ti(e).$implicit.dismiss("Cross click"))}),ye()(),pe(4,"div",6)(5,"div",7),oi(6,"app-employee-form"),ye()(),pe(7,"div",8)(8,"button",9),Tt("click",function(){return ni(ti(e).$implicit.close("Save click"))}),et(9,"Save"),ye()()}if(2&t){const e=dn();$e(8),st("disabled",e.employe_service.calculating_geocode)}}function zie(t,n){if(1&t){const e=xr();pe(0,"div",3)(1,"h4",4),et(2,"Profile update"),ye(),pe(3,"button",5),Tt("click",function(){return ni(ti(e).$implicit.dismiss("Cross click"))}),ye()(),pe(4,"div",6)(5,"div",7)(6,"form",null,10)(8,"div",11)(9,"div",12)(10,"label",13),et(11,"Usuario"),ye()(),pe(12,"div",14)(13,"div",15)(14,"input",16,17),Tt("ngModelChange",function(s){return ti(e),ni(dn().user_service.selected_employee_usser.user_name=s)}),ye()()()(),pe(16,"div",11)(17,"div",12)(18,"label",18),et(19,"Contrase\xf1a"),ye()(),pe(20,"div",14)(21,"div",15)(22,"input",19,20),Tt("ngModelChange",function(s){return ti(e),ni(dn().user_service.selected_employee_usser.password=s)}),ye()()()(),pe(24,"div",11)(25,"div",21)(26,"div",22)(27,"input",23,24),Tt("ngModelChange",function(s){return ti(e),ni(dn().user_service.selected_employee_usser.typer_id=s)}),ye(),pe(29,"label",25),et(30," Administrador "),ye()()(),pe(31,"div",21)(32,"div",22)(33,"input",26,27),Tt("ngModelChange",function(s){return ti(e),ni(dn().user_service.selected_employee_usser.typer_id=s)}),ye(),pe(35,"label",28),et(36," Conductor "),ye()()(),pe(37,"div",21)(38,"div",22)(39,"input",29,30),Tt("ngModelChange",function(s){return ti(e),ni(dn().user_service.selected_employee_usser.typer_id=s)}),ye(),pe(41,"label",31),et(42," Pasajero "),ye()()()()()()(),pe(43,"div",8)(44,"button",9),Tt("click",function(){return ni(ti(e).$implicit.close("Save click"))}),et(45,"Save"),ye()()}if(2&t){const e=dn();$e(14),st("ngModel",e.user_service.selected_employee_usser.user_name),$e(8),st("ngModel",e.user_service.selected_employee_usser.password),$e(5),st("ngModel",e.user_service.selected_employee_usser.typer_id),$e(6),st("ngModel",e.user_service.selected_employee_usser.typer_id),$e(6),st("ngModel",e.user_service.selected_employee_usser.typer_id),$e(5),st("disabled",e.employe_service.calculating_geocode)}}let EV=(()=>{class t{constructor(e,i,s){this.employe_service=e,this.vehicle_service=i,this.user_service=s,this.employees=[],this.employee=new zy,this.modalService=In(hg),this.closeResult="",this.selected_vehicle="",this.available_vehicle_list=[]}ngOnInit(){this.employe_service.getEmployees(),this.vehicle_service.getVehicles(),this.vehicle_service.getVehiclesAvailables()}ngAfterViewInit(){this.setInputVehicleEvent()}saveEmployee(){this.employe_service.saveEmployee(this.employee),this.resetForm()}setInputVehicleEvent(){Ba(this.vehicle_search.nativeElement,"keydown").pipe(Ht(e=>e),Uy(500),Tl()).subscribe(e=>{let i=e.target.value;i.trim().length>0?(this.setListStyle(this.vehicleSearchList),"Tab"==e.key||"Enter"==e.key?this.vehicle_service.available_vehicles_list.length>0?this.selectVehicle(this.vehicle_service.available_vehicles_list[0]):this.inputVehicle(i):(1==e.key.length||"Backspace"==e.key)&&(this.inputVehicle(i),this.removeStyle(this.vehicleSearchList,this.vehicle_search))):this.removeStyle(this.vehicleSearchList,this.vehicle_search)})}onSubmit(e){null==e.value.employee_id?this.employe_service.saveEmployee(e.value):this.employe_service.updateEmployee(e.value),this.resetForm()}resetForm(e){e?.reset(),this.employe_service.selected_employee=new zy}getDismissReason(e){switch(e){case Yl.ESC:return"by pressing ESC";case Yl.BACKDROP_CLICK:return"by clicking on a backdrop";default:return`with: ${e}`}}onEdit(e){this.employe_service.selected_employee=Object.assign({},e),this.vehicle_service.setVehicleFromList(e)}open(e,i){null!=i?this.onEdit(i):this.employe_service.selected_employee=new zy,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`,null==(i=this.employe_service.selected_employee).employee_id?this.employe_service.saveEmployee(i):this.employe_service.updateEmployee(i),this.resetEmployee()},s=>{this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}editUser(){}openUser(e,i){i.user_id?this.editUser():this.user_service.selected_employee_usser=new jne,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`,this.user_service.createUser(this.user_service.selected_employee_usser,i.employee_id)},s=>{this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}onDelete(e){confirm("Desea eliminar a este empleado?")&&this.employe_service.deleteEmployee(e.employee_id)}isTourDetail(){}resetEmployee(){this.employe_service.selected_employee=new zy}setListStyle(e){e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer;width: 305px; max-height: 150px; margin-bottom: 10px;  overflow:scroll;  -webkit-overflow-scrolling: touch;",e.nativeElement.hidden=!1}removeStyle(e,i){""==i.nativeElement.value&&(e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer; ",e.nativeElement.hidden=!0)}selectVehicle(e){this.vehicle_service.selected_vehicle_plate=e.licence_plate,this.employe_service.selected_employee.vehicle_id=e.vehicle_id,this.vehicleSearchList.nativeElement.hidden=!0}inputVehicle(e){this.available_vehicle_list=this.vehicle_service.available_vehicles_list.filter(i=>i.licence_plate.toUpperCase().includes(e.toUpperCase()))}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Hy),Ve(Sx),Ve(q1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-cat-employees"]],viewQuery:function(i,s){if(1&i&&(wl(Nie,5),wl(Lie,5)),2&i){let l;is(l=rs())&&(s.vehicle_search=l.first),is(l=rs())&&(s.vehicleSearchList=l.first)}},decls:5,vars:0,consts:[[3,"onAddClick","onUpdateClick","onRemoveClick","onUserClick"],["employee_content",""],["user_content",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"container",2,"margin-top","60px"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"disabled","click"],["userForm","ngForm"],[1,"row","form_row"],[1,"col-3"],["for","user_name"],[1,"col-9"],[1,"form-group"],["id","user_name","type","text","name","name","placeholder","Usuario","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],["for","password"],["id","password","type","text","name","password","placeholder","Contrase\xf1a","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["password","ngModel"],[1,"col-4"],[1,"form-check"],["type","radio","name","typeRadios","id","type_user1","value","1","checked","",1,"form-check-input",3,"ngModel","ngModelChange"],["type_user1","ngModel"],["for","typeRadio1",1,"form-check-label"],["type","radio","name","typeRadios","id","type_user2","value","2",1,"form-check-input",3,"ngModel","ngModelChange"],["type_user2","ngModel"],["for","typeRadio2",1,"form-check-label"],["type","radio","name","typeRadios","id","type_user3","value","3",1,"form-check-input",3,"ngModel","ngModelChange"],["type_user3","ngModel"],["for","typeRadio3",1,"form-check-label"]],template:function(i,s){if(1&i){const l=xr();pe(0,"app-employe-list",0),Tt("onAddClick",function(){ti(l);const m=ws(2);return ni(s.open(m))})("onUpdateClick",function(m){ti(l);const b=ws(2);return ni(s.open(b,m))})("onRemoveClick",function(m){return s.onDelete(m)})("onUserClick",function(m){ti(l);const b=ws(4);return ni(s.openUser(b,m))}),ye(),En(1,Uie,10,1,"ng-template",null,1,Zl),En(3,zie,46,6,"ng-template",null,2,Zl)}},styles:[".form_row[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"]})}return t})();class K1{}let W1=(()=>{class t{constructor(e){this.httpClient=e,this.selected_model=new K1,this.models_list=[]}getModels(){this.httpClient.get("http://localhost:3000/models").pipe(Ht(e=>e)).pipe(Ht(e=>e)).subscribe(e=>{this.models_list=e})}getModelById(e){return this.httpClient.get("http://localhost:3000/models/modelById/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i))}saveModel(e){return e.active=1,this.httpClient.post("http://localhost:3000/models",e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.models_list.push(i[0])})}updateModel(e){let i=e.model_id;return this.httpClient.put("http://localhost:3000/models/"+i,e).pipe(Ht(s=>s)).pipe(Ht(s=>s)).subscribe(s=>{console.log(s),this.models_list.forEach(l=>{l.model_id==i&&(l.model_name=s.model_name,l.model_year=s.model_year,l.pasenger_capability=s.pasenger_capability,l.performance=s.performance)})})}deleteModel(e){return this.httpClient.delete("http://localhost:3000/models/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.models_list=i})}getModelByID(e){let i=this.models_list.find(s=>s.model_id==e);if(null!=i)return i}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(dg))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Vie(t,n){if(1&t){const e=xr();pe(0,"tr")(1,"td"),oi(2,"ngb-highlight",12),ye(),pe(3,"td"),et(4),ye(),pe(5,"td"),et(6),ye(),pe(7,"td")(8,"a",13),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().emitUpdate(l))}),oi(9,"i",14),ye(),pe(10,"a",15),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().emitRemove(l))}),oi(11,"i",16),ye()()()}if(2&t){const e=n.$implicit,i=dn();$e(2),st("result",e.model_name)("term",i.filter.value),$e(2),wr(e.model_year),$e(2),wr(e.pasenger_capability)}}let Qie=(()=>{class t{constructor(e,i){this.model_service=i,this.onAddModelClick=new vi,this.onUpdateModelClick=new vi,this.onRemoveModelClick=new vi,this.modalService=In(hg),this.closeResult="",this.filter=new F1("",{nonNullable:!0}),this.totalItems=0,this.page=1,this.pageSize=4,this.showPagination=!0,this.models_=this.filter.valueChanges.pipe(T1(""),Ht(s=>function Hie(t,n){return this.models.filter(e=>{const i=t.toLowerCase();return e.model_name.toLowerCase().includes(i)||n.transform(e.model_year).includes(i)})}(s,e))),this.totalItems=this.model_service.models_list.length}ngOnInit(){this.model_service.getModels()}onEdit(e){this.model_service.selected_model=Object.assign({},e)}onDelete(e){confirm("Are you sure you want to delete it?")&&this.model_service.deleteModel(e)}refreshEmployees(){this.model_service.models_list=this.model_service.models_list.map((e,i)=>({id:i+1,...e})).slice((this.page-1)*this.pageSize,(this.page-1)*this.pageSize+this.pageSize)}open(e,i){null!=i?this.onEdit(i):this.model_service.selected_model=new K1,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`,null==(i=this.model_service.selected_model).model_id?this.model_service.saveModel(i):this.model_service.updateModel(i),this.resetList()},s=>{this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}resetList(){this.model_service.selected_model=new K1}getDismissReason(e){switch(e){case Yl.ESC:return"by pressing ESC";case Yl.BACKDROP_CLICK:return"by clicking on a backdrop";default:return`with: ${e}`}}emitAdd(){this.onAddModelClick.emit("new")}emitUpdate(e){this.onUpdateModelClick.emit(e)}emitRemove(e){this.onRemoveModelClick.emit(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(ex),Ve(W1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-models-list"]],inputs:{models:"models"},outputs:{onAddModelClick:"onAddModelClick",onUpdateModelClick:"onUpdateModelClick",onRemoveModelClick:"onRemoveModelClick"},decls:25,vars:2,consts:[[1,"container",2,"margin-top","60px"],[1,"mb-3","row"],["for","table-filtering-search",1,"col-xs-3","col-sm-auto","col-form-label"],[1,"col-xs-3","col-sm-auto"],["id","table-filtering-search","type","text",1,"form-control",3,"formControl"],[1,"col-2"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus-circle"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],["colspan","5",2,"text-align","center"],[3,"result","term"],[1,"btn","btn-secondary","text-white",3,"click"],[1,"far","fa-edit"],[1,"btn","btn-danger","text-white",3,"click"],[1,"fas","fa-trash-alt"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"form")(2,"div",1)(3,"label",2),et(4,"Full text search:"),ye(),pe(5,"div",3),oi(6,"input",4),ye(),pe(7,"div",5)(8,"button",6),Tt("click",function(){return s.emitAdd()}),oi(9,"i",7),et(10,"Nuevo "),ye()()()(),pe(11,"table",8)(12,"thead")(13,"tr")(14,"th",9),et(15,"Nombre"),ye(),pe(16,"th",9),et(17,"A\xf1o"),ye(),pe(18,"th",9),et(19," Capacidad de pasajeros "),ye()()(),pe(20,"tbody"),En(21,Vie,12,4,"tr",10),pe(22,"tr")(23,"td",11),et(24,"Lista de Modelos"),ye()()()()()),2&i&&($e(6),st("formControl",s.filter),$e(15),st("ngForOf",s.model_service.models_list))},dependencies:[Pl,GE,Fd,oc,Jc,Md,xh,FE],styles:[".my-control[_ngcontent-%COMP%]{margin-bottom:10px}"]})}return t})(),jie=(()=>{class t{constructor(e){this.models_service=e}ngOnInit(){this.models_service.getModels()}onSubmit(e){null==e.value.vehicle_id?this.models_service.saveModel(e.value):this.models_service.updateModel(e.value)}resetForm(e){e?.reset(),this.models_service.selected_model=new K1}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(W1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-model-form"]],outputs:{modelsForm:"modelsForm"},decls:37,vars:5,consts:[[1,"container",2,"margin-top","60px"],[3,"ngSubmit"],["modelForm","ngForm"],["type","hidden","name","model_id",3,"ngModel","ngModelChange"],["model_id","ngModel"],[1,"row","form_row"],[1,"col-3"],["for","model_name"],[1,"col-9"],[1,"form-group"],["id","model_name","type","text","name","model_name","placeholder","Modelo","autocomplete","of",1,"form-control","my-controll",3,"ngModel","ngModelChange"],["model_name","ngModel"],["for","model_year"],["id","model_year","type","text","name","model_year","placeholder","A\xf1o","autocomplete","of",1,"form-control","my-controll",3,"ngModel","ngModelChange"],["model_year","ngModel"],["for","performance"],["id","performance","type","text","name","performance","placeholder","Rendimiento","autocomplete","of",1,"form-control","my-controll",3,"ngModel","ngModelChange"],["performance","ngModel"],["for","pasenger_capability"],["id","pasenger_capability","type","text","name","pasenger_capability","placeholder","Capacidad de Pasajeros","autocomplete","of",1,"form-control","my-controll",3,"ngModel","ngModelChange"],["pasenger_capability","ngModel"]],template:function(i,s){if(1&i){const l=xr();pe(0,"div",0)(1,"form",1,2),Tt("ngSubmit",function(){ti(l);const m=ws(2);return ni(s.onSubmit(m))}),pe(3,"input",3,4),Tt("ngModelChange",function(m){return s.models_service.selected_model.model_id=m}),ye(),pe(5,"div",5)(6,"div",6)(7,"label",7),et(8,"Modelo"),ye()(),pe(9,"div",8)(10,"div",9)(11,"input",10,11),Tt("ngModelChange",function(m){return s.models_service.selected_model.model_name=m}),ye()()()(),pe(13,"div",5)(14,"div",6)(15,"label",12),et(16,"A\xf1o"),ye()(),pe(17,"div",8)(18,"div",9)(19,"input",13,14),Tt("ngModelChange",function(m){return s.models_service.selected_model.model_year=m}),ye()()()(),pe(21,"div",5)(22,"div",6)(23,"label",15),et(24,"Rendimiento"),ye()(),pe(25,"div",8)(26,"div",9)(27,"input",16,17),Tt("ngModelChange",function(m){return s.models_service.selected_model.performance=m}),ye()()()(),pe(29,"div",5)(30,"div",6)(31,"label",18),et(32,"Capacidad Pasajeros"),ye()(),pe(33,"div",8)(34,"div",9)(35,"input",19,20),Tt("ngModelChange",function(m){return s.models_service.selected_model.pasenger_capability=m}),ye()()()()()()}2&i&&($e(3),st("ngModel",s.models_service.selected_model.model_id),$e(8),st("ngModel",s.models_service.selected_model.model_name),$e(8),st("ngModel",s.models_service.selected_model.model_year),$e(8),st("ngModel",s.models_service.selected_model.performance),$e(8),st("ngModel",s.models_service.selected_model.pasenger_capability))},dependencies:[Fd,oc,Jc,Md,Qu,xh],styles:[".form_row[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"]})}return t})();function Gie(t,n){if(1&t){const e=xr();pe(0,"div",2)(1,"h4",3),et(2,"Modelos"),ye(),pe(3,"button",4),Tt("click",function(){return ni(ti(e).$implicit.dismiss("Cross click"))}),ye()(),pe(4,"div",5)(5,"div",6),oi(6,"app-model-form"),ye()(),pe(7,"div",7)(8,"button",8),Tt("click",function(){return ni(ti(e).$implicit.close("Save click"))}),et(9,"Guardar"),ye()()}}let $ie=(()=>{class t{constructor(e){this.models_service=e,this.modalService=In(hg),this.closeResult=""}ngOnInit(){this.models_service.getModels()}onSubmit(e){null==e.value.vehicle_id?this.models_service.saveModel(e.value):this.models_service.updateModel(e.value)}resetForm(e){e?.reset(),this.models_service.selected_model=new K1}onDelete(e){confirm("Are you sure you want to delete it?")&&this.models_service.deleteModel(e.model_id)}onEdit(e){this.models_service.selected_model=Object.assign({},e)}test(e){console.log(e)}open(e,i){null!=i?this.onEdit(i):this.models_service.selected_model=new K1,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`,null==(i=this.models_service.selected_model).model_id?this.models_service.saveModel(i):this.models_service.updateModel(i),this.resetModel()},s=>{this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}resetModel(){this.models_service.selected_model=new K1}getDismissReason(e){switch(e){case Yl.ESC:return"by pressing ESC";case Yl.BACKDROP_CLICK:return"by clicking on a backdrop";default:return`with: ${e}`}}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(W1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-cat-models"]],outputs:{modelsForm:"modelsForm"},decls:3,vars:0,consts:[[3,"onAddModelClick","onUpdateModelClick","onRemoveModelClick"],["content",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"container",2,"margin-top","60px"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"]],template:function(i,s){if(1&i){const l=xr();pe(0,"app-models-list",0),Tt("onAddModelClick",function(){ti(l);const m=ws(2);return ni(s.open(m))})("onUpdateModelClick",function(m){ti(l);const b=ws(2);return ni(s.open(b,m))})("onRemoveModelClick",function(m){return s.onDelete(m)}),ye(),En(1,Gie,10,0,"ng-template",null,1,Zl)}},dependencies:[Qie,jie],styles:[".my-controll[_ngcontent-%COMP%]{margin-bottom:10px}.form_row[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"]})}return t})();class XE{}let d0=(()=>{class t{constructor(e){this.httpClient=e,this.selected_route=new XE,this.route_list=[],this.route_selected=[]}getRoutes(){this.httpClient.get("http://localhost:3000/routes").pipe(Ht(e=>e)).pipe(Ht(e=>e)).subscribe(e=>{this.route_selected=[],this.route_list=e,this.route_list.forEach(i=>{this.route_selected.push({route_id:i.route_id,route_name:i.route_name,selected:!1})})})}_getRoutes(){return this.httpClient.get("http://localhost:3000/routes").pipe(Ht(e=>e)).pipe(Ht(e=>e))}saveRoutes(e){return e.active=1,this.httpClient.post("http://localhost:3000/routes",e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.route_list.push(i[0])})}updateRoute(e){let i=e.route_id;return this.httpClient.put("http://localhost:3000/routes/"+i,e).pipe(Ht(s=>s)).pipe(Ht(s=>s)).subscribe(s=>{console.log(s),this.route_list.forEach(l=>{l.route_id==i&&(l.route_name=s.route_name)})})}deleteRoute(e){return this.httpClient.delete("http://localhost:3000/routes/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.route_list=i})}getRouteByID(e){let i=this.route_list.find(s=>s.route_id==e);if(null!=i)return i}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(dg))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function qie(t,n){if(1&t){const e=xr();pe(0,"tr")(1,"td"),oi(2,"ngb-highlight",12),ye(),pe(3,"td"),oi(4,"ngb-highlight",12),ye(),pe(5,"td")(6,"a",13),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().emitUpdate(l))}),oi(7,"i",14),ye(),pe(8,"a",15),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().emitRemove(l))}),oi(9,"i",16),ye()()()}if(2&t){const e=n.$implicit,i=dn();$e(2),st("result",e.route_id.toString().padStart(4,"0000"))("term",i.filter.value),$e(2),st("result",e.route_name)("term",i.filter.value)}}let Kie=(()=>{class t{constructor(e,i){this.route_service=i,this.modalService=In(hg),this.closeResult="",this.filter=new F1("",{nonNullable:!0}),this.onAddClick=new vi,this.onUpdateClick=new vi,this.onRemoveClick=new vi}ngOnInit(){this.route_service.getRoutes()}open(e,i){null!=i?this.onEdit(i):this.route_service.selected_route=new XE,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`,null==(i=this.route_service.selected_route).route_id?this.route_service.saveRoutes(i):this.route_service.updateRoute(i),this.resetList()},s=>{this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}onEdit(e){this.route_service.selected_route=Object.assign({},e)}onDelete(e){confirm("Are you sure you want to delete it?")&&this.route_service.deleteRoute(e)}resetList(){this.route_service.selected_route=new XE}getDismissReason(e){switch(e){case Yl.ESC:return"by pressing ESC";case Yl.BACKDROP_CLICK:return"by clicking on a backdrop";default:return`with: ${e}`}}emitAdd(){this.onAddClick.emit("new")}emitUpdate(e){this.onUpdateClick.emit(e)}emitRemove(e){this.onRemoveClick.emit(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(ex),Ve(d0))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-routes-list"]],inputs:{models:"models"},outputs:{onAddClick:"onAddClick",onUpdateClick:"onUpdateClick",onRemoveClick:"onRemoveClick"},decls:23,vars:2,consts:[[1,"container",2,"margin-top","60px"],[1,"mb-3","row"],["for","table-filtering-search",1,"col-xs-3","col-sm-auto","col-form-label"],[1,"col-xs-3","col-sm-auto"],["id","table-filtering-search","type","text",1,"form-control",3,"formControl"],[1,"col-2"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus-circle"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],["colspan","5",2,"text-align","center"],[3,"result","term"],[1,"btn","btn-secondary","text-white",3,"click"],[1,"far","fa-edit"],[1,"btn","btn-danger","text-white",3,"click"],[1,"fas","fa-trash-alt"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"form")(2,"div",1)(3,"label",2),et(4,"Full text search:"),ye(),pe(5,"div",3),oi(6,"input",4),ye(),pe(7,"div",5)(8,"button",6),Tt("click",function(){return s.emitAdd()}),oi(9,"i",7),et(10,"Nuevo "),ye()()()(),pe(11,"table",8)(12,"thead")(13,"tr")(14,"th",9),et(15,"Folio"),ye(),pe(16,"th",9),et(17,"Nombre"),ye()()(),pe(18,"tbody"),En(19,qie,10,4,"tr",10),pe(20,"tr")(21,"td",11),et(22,"Lista de Rutas"),ye()()()()()),2&i&&($e(6),st("formControl",s.filter),$e(13),st("ngForOf",s.route_service.route_list))},dependencies:[Pl,GE,Fd,oc,Jc,Md,xh,FE]})}return t})(),Wie=(()=>{class t{constructor(e){this.route_service=e}onDelete(e){confirm("Are you sure you want to delete it?")&&this.route_service.deleteRoute(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(d0))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-route-form"]],decls:13,vars:2,consts:[[1,"container",2,"margin-top","60px"],["routesForm","ngForm"],["type","hidden","name","model_id",3,"ngModel","ngModelChange"],["model_id","ngModel"],[1,"row"],[1,"col-3"],["for","route_name"],[1,"col-9"],[1,"form-group"],["id","route_name","type","text","name","route_name","placeholder","Ruta","autocomplete","off",1,"form-control","my-controll",3,"ngModel","ngModelChange"],["route_name","ngModel"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"form",null,1)(3,"input",2,3),Tt("ngModelChange",function(h){return s.route_service.selected_route.route_id=h}),ye(),pe(5,"div",4)(6,"div",5)(7,"label",6),et(8,"Ruta"),ye()(),pe(9,"div",7)(10,"div",8)(11,"input",9,10),Tt("ngModelChange",function(h){return s.route_service.selected_route.route_name=h}),ye()()()()()()),2&i&&($e(3),st("ngModel",s.route_service.selected_route.route_id),$e(8),st("ngModel",s.route_service.selected_route.route_name))},dependencies:[Fd,oc,Jc,Md,Qu,xh]})}return t})();function Zie(t,n){if(1&t){const e=xr();pe(0,"div",2)(1,"h4",3),et(2,"Profile update"),ye(),pe(3,"button",4),Tt("click",function(){return ni(ti(e).$implicit.dismiss("Cross click"))}),ye()(),pe(4,"div",5)(5,"div",6),oi(6,"app-route-form"),ye()(),pe(7,"div",7)(8,"button",8),Tt("click",function(){return ni(ti(e).$implicit.close("Save click"))}),et(9,"Save"),ye()()}}let Xie=(()=>{class t{constructor(e){this.route_service=e,this.modalService=In(hg),this.closeResult=""}ngOnInit(){throw new Error("Method not implemented.")}onSubmit(e){null==e.value.vehicle_id?this.route_service.saveRoutes(e.value):this.route_service.updateRoute(e.value)}resetForm(e){e?.reset(),this.route_service.selected_route=new XE}onEdit(e){this.route_service.selected_route=Object.assign({},e)}open(e,i){null!=i?this.onEdit(i):this.route_service.selected_route=new XE,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`,null==(i=this.route_service.selected_route).route_id?this.route_service.saveRoutes(i):this.route_service.updateRoute(i)},s=>{this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}getDismissReason(e){switch(e){case Yl.ESC:return"by pressing ESC";case Yl.BACKDROP_CLICK:return"by clicking on a backdrop";default:return`with: ${e}`}}onDelete(e){confirm("Are you sure you want to delete it?")&&this.route_service.deleteRoute(e.route_id)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(d0))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-cat-routes"]],decls:3,vars:0,consts:[[3,"onAddClick","onUpdateClick","onRemoveClick"],["content",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"container",2,"margin-top","60px"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"]],template:function(i,s){if(1&i){const l=xr();pe(0,"app-routes-list",0),Tt("onAddClick",function(){ti(l);const m=ws(2);return ni(s.open(m))})("onUpdateClick",function(m){ti(l);const b=ws(2);return ni(s.open(b,m))})("onRemoveClick",function(m){return s.onDelete(m)}),ye(),En(1,Zie,10,0,"ng-template",null,1,Zl)}},dependencies:[Kie,Wie]})}return t})();function Yie(t,n){1&t&&(pe(0,"td"),et(1," Activo "),ye())}function Jie(t,n){1&t&&(pe(0,"td"),et(1," Descando "),ye())}function ere(t,n){1&t&&(pe(0,"td"),et(1," Compartido "),ye())}function tre(t,n){1&t&&(pe(0,"td"),et(1," Individual "),ye())}function nre(t,n){if(1&t){const e=xr();pe(0,"tr")(1,"td"),oi(2,"ngb-highlight",16),ye(),pe(3,"td"),oi(4,"ngb-highlight",16),ye(),En(5,Yie,2,0,"td",17),En(6,Jie,2,0,"td",17),En(7,ere,2,0,"td",17),En(8,tre,2,0,"td",17),pe(9,"td")(10,"a",18),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().emitUpdate(l))}),oi(11,"i",19),ye(),pe(12,"a",20),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().emitRemove(l))}),oi(13,"i",21),ye(),pe(14,"a",18),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().emitIssue(l))}),oi(15,"i",22),ye()()()}if(2&t){const e=n.$implicit,i=dn();$e(2),st("result",e.serial_number)("term",i.filter.value),$e(2),st("result",e.licence_plate)("term",i.filter.value),$e(1),st("ngIf",1==e.vehicle_status),$e(1),st("ngIf",2==e.vehicle_status),$e(1),st("ngIf",0!=e.route_id),$e(1),st("ngIf",0==e.route_id)}}let ire=(()=>{class t{constructor(e,i,s){this.vehicle_service=i,this.models_service=s,this.modalService=In(hg),this.closeResult="",this.vehicles_=[],this.vehicle=new $1,this.onAddClick=new vi,this.onUpdateClick=new vi,this.onRemoveClick=new vi,this.onIssueClick=new vi,this.filter=new F1("",{nonNullable:!0}),this.page=1,this.vehicle_service.getVehicles(),this.models_service.getModels()}onDelete(e){confirm("Are you sure you want to delete it?")&&this.vehicle_service.deleteVehicle(e)}onEdit(e){this.vehicle_service.selected_vehicle=e,this.vehicle_service.selected_model=this.models_service.getModelByID(e.model_id)}open(e,i){null!=i?this.onEdit(i):this.vehicle_service.selected_vehicle=new $1,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`,console.log(this.vehicle_service.selected_vehicle),this.vehicle_service.saveVehicle(this.vehicle_service.selected_vehicle)},s=>{this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}getDismissReason(e){switch(e){case Yl.ESC:return"by pressing ESC";case Yl.BACKDROP_CLICK:return"by clicking on a backdrop";default:return`with: ${e}`}}emitAdd(){this.onAddClick.emit("new")}emitUpdate(e){this.onUpdateClick.emit(e)}emitRemove(e){this.onRemoveClick.emit(e)}emitIssue(e){this.onIssueClick.emit(e)}filterTable(){if(console.log(this.search),this.page=1,""!=this.search){let e=this.vehicle_service.vehicles_list.filter(i=>i.licence_plate.toUpperCase().includes(this.search.toUpperCase()));this.vehicle_service.vehicles_list_page=e.slice((this.page-1)*this.vehicle_service.pageSize,(this.page-1)*this.vehicle_service.pageSize+this.vehicle_service.pageSize)}else this.refreshVehicles()}refreshVehicles(){this.vehicle_service.vehicles_list_page=this.vehicle_service.vehicles_list.slice((this.page-1)*this.vehicle_service.pageSize,(this.page-1)*this.vehicle_service.pageSize+this.vehicle_service.pageSize)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(ex),Ve(Sx),Ve(W1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-vehicles-list"]],inputs:{vehicles:"vehicles",content:"content"},outputs:{onAddClick:"onAddClick",onUpdateClick:"onUpdateClick",onRemoveClick:"onRemoveClick",onIssueClick:"onIssueClick"},decls:33,vars:5,consts:[[1,"container",2,"margin-top","60px"],[1,"mb-3","row"],["for","table-filtering-search",1,"col-xs-3","col-sm-auto","col-form-label"],[1,"col-xs-3","col-sm-auto"],["id","filter_search","type","text","name","filter_search",1,"form-control",3,"ngModel","ngModelChange"],["filter_search","ngModel"],[1,"col-2"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],[1,"fas","fa-plus-circle"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],["colspan","3",2,"text-align","center"],[1,"d-flex","justify-content-between","p-2"],[3,"collectionSize","page","pageSize","pageChange"],[3,"result","term"],[4,"ngIf"],[1,"btn","btn-secondary","text-white",3,"click"],[1,"far","fa-edit"],[1,"btn","btn-danger","text-white",3,"click"],[1,"fas","fa-trash-alt"],[1,"fas","fa-exclamation-triangle"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"form")(2,"div",1)(3,"label",2),et(4,"Full text search:"),ye(),pe(5,"div",3)(6,"input",4,5),Tt("ngModelChange",function(h){return s.search=h}),ye()(),pe(8,"div",6)(9,"button",7),Tt("click",function(){return s.filterTable()}),oi(10,"i",8),ye()(),pe(11,"div",6)(12,"button",7),Tt("click",function(){return s.emitAdd()}),oi(13,"i",9),et(14,"Nuevo "),ye()()()(),pe(15,"table",10)(16,"thead")(17,"tr")(18,"th",11),et(19,"Serie"),ye(),pe(20,"th",11),et(21," Placas de circulacion "),ye(),pe(22,"th",11),et(23,"Estado"),ye(),pe(24,"th",11),et(25,"Tipo Uso"),ye()()(),pe(26,"tbody"),En(27,nre,16,8,"tr",12),pe(28,"tr")(29,"td",13),et(30,"Lista de Vehiculos"),ye()()()(),pe(31,"div",14)(32,"ngb-pagination",15),Tt("pageChange",function(h){return s.page=h})("pageChange",function(){return s.refreshVehicles()}),ye()()()),2&i&&($e(6),st("ngModel",s.search),$e(21),st("ngForOf",s.vehicle_service.vehicles_list_page),$e(5),st("collectionSize",s.vehicle_service.vehicles_list.length)("page",s.page)("pageSize",10))},dependencies:[Pl,Xh,Rk,GE,Fd,oc,Jc,Md,Qu,xh]})}return t})();const rre=["model_search"],sre=["modelSearchList"],ore=["route_search"],are=["routeSearchList"];function lre(t,n){if(1&t){const e=xr();pe(0,"li",33),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().selectModel(l))}),pe(1,"span"),et(2),ye()()}if(2&t){const e=n.$implicit;$e(2),ho("",e.model_name," - ",e.model_year,"")}}function cre(t,n){if(1&t){const e=xr();pe(0,"li",33),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().selectRoute(l))}),pe(1,"span"),et(2),ye()()}if(2&t){const e=n.$implicit;$e(2),wr(e.route_name)}}let ure=(()=>{class t{constructor(e,i,s){this.vehicle_service=e,this.models_service=i,this.routes_service=s,this.vehicles=[],this.vehicle=new $1,this.model_select_list=[],this.route_select_list=[],this.selected_route="",this.selected_model="",this.vehicle_status="1"}ngAfterViewInit(){this.setInputModelEvent(),this.setInputRouteEvent()}ngOnInit(){this.models_service.getModels(),this.selectModel(this.models_service.getModelByID(this.vehicle_service.selected_vehicle.model_id)),this.routes_service.getRoutes(),this.selectRoute(this.routes_service.getRouteByID(this.vehicle_service.selected_vehicle.route_id))}setInputModelEvent(){Ba(this.model_search.nativeElement,"keydown").pipe(Ht(e=>e),Uy(500),Tl()).subscribe(e=>{let i=e.target.value;i.trim().length>0?(this.setListStyle(this.modelSearchList),"Tab"==e.key||"Enter"==e.key?this.models_service.models_list.length>0?this.selectModel(this.models_service.models_list[0]):this.inputModel(i):(1==e.key.length||"Backspace"==e.key)&&(this.inputModel(i),this.removeStyle(this.modelSearchList,this.model_search))):this.removeStyle(this.modelSearchList,this.model_search)})}setInputRouteEvent(){Ba(this.route_search.nativeElement,"keydown").pipe(Ht(e=>e),Uy(500),Tl()).subscribe(e=>{let i=e.target.value;i.trim().length>0?(this.setListStyle(this.routeSearchList),"Tab"==e.key||"Enter"==e.key?this.models_service.models_list.length>0?this.selectRoute(this.routes_service.route_list[0]):this.inputRoute(i):(1==e.key.length||"Backspace"==e.key)&&(this.inputRoute(i),this.removeStyle(this.modelSearchList,this.model_search))):this.removeStyle(this.modelSearchList,this.model_search)})}inputModel(e){this.model_select_list=this.models_service.models_list.filter(i=>i.model_name.toUpperCase().includes(e.toUpperCase()))}inputRoute(e){this.route_select_list=this.routes_service.route_list.filter(i=>i.route_name.toUpperCase().includes(e.toUpperCase()))}selectModel(e){this.vehicle_service.selected_vehicle.model_id=e.model_id,this.vehicle_service.selected_model=e.model_name,this.selected_model=e.model_name,this.modelSearchList&&(this.modelSearchList.nativeElement.hidden=!0)}selectRoute(e){this.vehicle_service.selected_vehicle.route_id=e.route_id,this.selected_route=e.route_name,this.routeSearchList&&(this.routeSearchList.nativeElement.hidden=!0)}setListStyle(e){e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer;width: 305px; max-height: 150px; margin-bottom: 10px;  overflow:scroll;  -webkit-overflow-scrolling: touch;",e.nativeElement.hidden=!1}removeStyle(e,i){""==i.nativeElement.value&&(e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer; ",e.nativeElement.hidden=!0)}isActive(){return 1==this.vehicle_service.selected_vehicle.vehicle_status}onChangeType(e){this.vehicle_service.selected_vehicle.vehicle_status=e.srcElement.defaultValue,2==e.srcElement.defaultValue&&(this.selected_route="",this.vehicle_service.selected_vehicle.route_id=0)}isPrivate(){return 1==this.vehicle_service.selected_vehicle.private_company}onChangePrivate(e){this.vehicle_service.selected_vehicle.private_company=e.srcElement.defaultValue}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Sx),Ve(W1),Ve(d0))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-vehicles-form"]],viewQuery:function(i,s){if(1&i&&(wl(rre,5),wl(sre,5),wl(ore,5),wl(are,5)),2&i){let l;is(l=rs())&&(s.model_search=l.first),is(l=rs())&&(s.modelSearchList=l.first),is(l=rs())&&(s.route_search=l.first),is(l=rs())&&(s.routeSearchList=l.first)}},decls:59,vars:12,consts:[[1,"container",2,"margin-top","60px"],["vehicleForm","ngForm"],["type","hidden","name","vehicle_id",3,"ngModel","ngModelChange"],["vehicle_id","ngModel"],[1,"row","form_row"],[1,"col-3"],["for","serial_number"],[1,"col-5"],[1,"form-group"],["id","serial_number","type","text","name","serial_number","placeholder","Numero de Serie","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["serial_number","ngModel"],[1,"col-4"],[1,"form-check"],["type","radio","name","statusRadios","id","vehicle_status1","value","1",1,"form-check-input",3,"checked","change"],["for","exampleRadios1",1,"form-check-label"],["type","radio","name","statusRadios","id","vehicle_status2","value","2",1,"form-check-input",3,"checked","change"],["for","exampleRadios2",1,"form-check-label"],["for","licence_plate"],[1,"col-9"],["id","licence_plate","type","text","name","licence_plate","placeholder","Placas de circulaci\xf3n","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["licence_plate","ngModel"],["for","model_search"],["id","model_search","type","text","name","model_search","placeholder","Modelo","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["model_search",""],[1,"list-group",2,"position","absolute","z-index","999","cursor","pointer"],["modelSearchList",""],["class","list-group-item",3,"click",4,"ngFor","ngForOf"],["for","route_search"],["id","route_search","type","text","name","route_search","placeholder","Ruta","autocomplete","off",1,"form-control",3,"ngModel","disabled","ngModelChange"],["route_search",""],["routeSearchList",""],["type","radio","name","exampleRadios","id","private_company1","value","1",1,"form-check-input",3,"checked","change"],["type","radio","name","exampleRadios","id","private_company2","value","2",1,"form-check-input",3,"checked","change"],[1,"list-group-item",3,"click"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"form",null,1)(3,"input",2,3),Tt("ngModelChange",function(h){return s.vehicle_service.selected_vehicle.vehicle_id=h}),ye(),pe(5,"div",4)(6,"div",5)(7,"label",6),et(8,"Numero de Serie"),ye()(),pe(9,"div",7)(10,"div",8)(11,"input",9,10),Tt("ngModelChange",function(h){return s.vehicle_service.selected_vehicle.serial_number=h}),ye()()(),pe(13,"div",11)(14,"div",12)(15,"input",13),Tt("change",function(h){return s.onChangeType(h)}),ye(),pe(16,"label",14),et(17," Activo "),ye()(),pe(18,"div",12)(19,"input",15),Tt("change",function(h){return s.onChangeType(h)}),ye(),pe(20,"label",16),et(21," En Espera "),ye()()()(),pe(22,"div",4)(23,"div",5)(24,"label",17),et(25,"Placas de circulaci\xf3n "),ye()(),pe(26,"div",18)(27,"div",8)(28,"input",19,20),Tt("ngModelChange",function(h){return s.vehicle_service.selected_vehicle.licence_plate=h}),ye()()()(),pe(30,"div",4)(31,"div",5)(32,"label",21),et(33,"Modelo"),ye()(),pe(34,"div",18)(35,"input",22,23),Tt("ngModelChange",function(h){return s.selected_model=h}),ye(),pe(37,"ul",24,25),En(39,lre,3,2,"li",26),ye()()(),pe(40,"div",4)(41,"div",5)(42,"label",27),et(43,"Ruta"),ye()(),pe(44,"div",7)(45,"input",28,29),Tt("ngModelChange",function(h){return s.selected_route=h}),ye(),pe(47,"ul",24,30),En(49,cre,3,1,"li",26),ye()(),pe(50,"div",11)(51,"div",12)(52,"input",31),Tt("change",function(h){return s.onChangePrivate(h)}),ye(),pe(53,"label",14),et(54," Particular "),ye()(),pe(55,"div",12)(56,"input",32),Tt("change",function(h){return s.onChangePrivate(h)}),ye(),pe(57,"label",16),et(58," Compa\xf1ia "),ye()()()()()()),2&i&&($e(3),st("ngModel",s.vehicle_service.selected_vehicle.vehicle_id),$e(8),st("ngModel",s.vehicle_service.selected_vehicle.serial_number),$e(4),st("checked",s.isActive()),$e(4),st("checked",!s.isActive()),$e(9),st("ngModel",s.vehicle_service.selected_vehicle.licence_plate),$e(7),st("ngModel",s.selected_model),$e(4),st("ngForOf",s.model_select_list),$e(6),st("ngModel",s.selected_route)("disabled",!s.isActive()),$e(4),st("ngForOf",s.route_select_list),$e(3),st("checked",s.isPrivate()),$e(4),st("checked",!s.isPrivate()))},dependencies:[Pl,Fd,oc,Jc,Md,Qu,xh],styles:[".form_row[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"]})}return t})();const hre=["model_search"],dre=["modelSearchList"],fre=["route_search"],Are=["routeSearchList"];function pre(t,n){if(1&t){const e=xr();pe(0,"div",3)(1,"h4",4),et(2,"Datos del vehiculo"),ye(),pe(3,"button",5),Tt("click",function(){return ni(ti(e).$implicit.dismiss("Cross click"))}),ye()(),pe(4,"div",6)(5,"div",7),oi(6,"app-vehicles-form"),ye()(),pe(7,"div",8)(8,"button",9),Tt("click",function(){return ni(ti(e).$implicit.close("Save click"))}),et(9,"Save"),ye()()}}function gre(t,n){if(1&t){const e=xr();pe(0,"div",10)(1,"div",15)(2,"input",16,17),Tt("ngModelChange",function(s){return ti(e),ni(dn(2).statusCheck=s)}),ye(),pe(4,"label",18),et(5," Cerrar "),ye()()()}if(2&t){const e=dn(2);$e(2),st("ngModel",e.statusCheck)}}function mre(t,n){if(1&t){const e=xr();pe(0,"div",3)(1,"h4",4),et(2,"Datos del vehiculo"),ye(),pe(3,"button",5),Tt("click",function(){return ni(ti(e).$implicit.dismiss("Cross click"))}),ye()(),pe(4,"div",6)(5,"div",7)(6,"div",10)(7,"label",11),et(8,"Descripci\xf3n:"),ye(),pe(9,"textarea",12,13),Tt("ngModelChange",function(s){return ti(e),ni(dn().vehicle_service.open_issue.description=s)}),ye()(),En(11,gre,6,1,"div",14),ye()(),pe(12,"div",8)(13,"button",9),Tt("click",function(){return ni(ti(e).$implicit.close("Save click"))}),et(14,"Save"),ye()()}if(2&t){const e=dn();$e(9),st("ngModel",e.vehicle_service.open_issue.description),$e(2),st("ngIf",0!=e.vehicle_service.open_issue.vehicle_issue_id)}}let _re=(()=>{class t{constructor(e,i,s){this.vehicle_service=e,this.models_service=i,this.routes_service=s,this.vehicles=[],this.vehicle=new $1,this.model_select_list=[],this.route_select_list=[],this.modalService=In(hg),this.closeResult="",this.selected_route="",this.vehicle_status="1",this.statusCheck=!1}ngAfterViewInit(){}ngOnInit(){this.vehicle_service.getVehicles(),this.models_service.getModels(),this.routes_service.getRoutes()}setListStyle(e){e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer;width: 305px; max-height: 150px; margin-bottom: 10px;  overflow:scroll;  -webkit-overflow-scrolling: touch;",e.nativeElement.hidden=!1}removeStyle(e,i){""==i.nativeElement.value&&(e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer; ",e.nativeElement.hidden=!0)}inputModel(e){this.model_select_list=this.models_service.models_list.filter(i=>i.model_name.toUpperCase().includes(e.toUpperCase()))}inputRoute(e){this.route_select_list=this.routes_service.route_list.filter(i=>i.route_name.toUpperCase().includes(e.toUpperCase()))}onSubmit(e){null==e.value.vehicle_id&&this.vehicle_service.saveVehicle(e.value)}selectModel(e){this.vehicle_service.selected_vehicle.model_id=e.model_id,this.vehicle_service.selected_model=e.model_name,this.modelSearchList.nativeElement.hidden=!0}selectRoute(e){this.vehicle_service.selected_vehicle.route_id=e.route_id,this.selected_route=e.route_name,this.routeSearchList.nativeElement.hidden=!0}resetForm(e){e?.reset(),this.vehicle_service.selected_vehicle=new $1}onEdit(e){this.vehicle_service.selected_vehicle=Object.assign({},e)}open(e,i){null!=i?this.onEdit(i):this.vehicle_service.selected_vehicle=new $1,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`,null==(i=this.vehicle_service.selected_vehicle).vehicle_id?this.vehicle_service.saveVehicle(i):this.vehicle_service.updateVehicle(i)},s=>{this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}openIssue(e,i){this.vehicle_service.getOpenIssue(i.vehicle_id).subscribe(s=>{this.vehicle_service.open_issue=s.length>0?s[0]:new CV}),this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`,0==this.vehicle_service.open_issue.vehicle_issue_id?(this.vehicle_service.open_issue.vehicle_id=i.vehicle_id,this.vehicle_service.openIssue(this.vehicle_service.open_issue)):1==this.statusCheck&&this.vehicle_service.closeIssue(i.vehicle_id,this.vehicle_service.open_issue.vehicle_issue_id)},s=>{this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}getDismissReason(e){switch(e){case Yl.ESC:return"by pressing ESC";case Yl.BACKDROP_CLICK:return"by clicking on a backdrop";default:return`with: ${e}`}}onDelete(e){confirm("Are you sure you want to delete it?")&&this.vehicle_service.deleteVehicle(e.vehicle_id)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Sx),Ve(W1),Ve(d0))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-cat-vehicles"]],viewQuery:function(i,s){if(1&i&&(wl(hre,5),wl(dre,5),wl(fre,5),wl(Are,5)),2&i){let l;is(l=rs())&&(s.model_search=l.first),is(l=rs())&&(s.modelSearchList=l.first),is(l=rs())&&(s.route_search=l.first),is(l=rs())&&(s.routeSearchList=l.first)}},decls:5,vars:0,consts:[[3,"onAddClick","onUpdateClick","onRemoveClick","onIssueClick"],["content",""],["content_issue",""],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"container",2,"margin-top","60px"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"row"],["for","description"],["cols","2","rows","5","id","description","name","description","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["description","ngModel"],["class","row",4,"ngIf"],[1,"form-check"],["type","checkbox","value","","id","status","name","status",1,"form-check-input",3,"ngModel","ngModelChange"],["status","ngModel"],["for","status",1,"form-check-label"]],template:function(i,s){if(1&i){const l=xr();pe(0,"app-vehicles-list",0),Tt("onAddClick",function(){ti(l);const m=ws(2);return ni(s.open(m))})("onUpdateClick",function(m){ti(l);const b=ws(2);return ni(s.open(b,m))})("onRemoveClick",function(m){return s.onDelete(m)})("onIssueClick",function(m){ti(l);const b=ws(4);return ni(s.openIssue(b,m))}),ye(),En(1,pre,10,0,"ng-template",null,1,Zl),En(3,mre,15,2,"ng-template",null,2,Zl)}},dependencies:[Xh,oc,LO,Jc,Qu,ire,ure],styles:[".form_row[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"]})}return t})(),yre=(()=>{class t{constructor(e,i){this.employee_service=e,this.user_service=i}ngOnInit(){1==this.user_service.userType||2==this.user_service.userType?this.employee_service.getEmployeInfoVehicleByUser(this.user_service.current_usser.user_id):this.employee_service.getPassengerInfoVehicleByUser(this.user_service.current_usser.user_id)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Hy),Ve(q1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-home"]],decls:5,vars:0,consts:[[1,"container"],[1,"row"],[1,"col-3"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"div",1),et(2,"Catalogos "),pe(3,"div",2),et(4," Modelos "),ye()()())}})}return t})();const vre=Mo(t=>function(e=null){t(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e});function wre(t){throw new vre(t)}class SV{validateSignature(n){return Promise.resolve(null)}validateAtHash(n){return Promise.resolve(!0)}}class TV{}class zk{}let xre=(()=>{class t extends zk{now(){return Date.now()}new(){return new Date}static#e=this.\u0275fac=function(){let e;return function(s){return(e||(e=Ms(t)))(s||t)}}();static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();class IV{}class DV{}let Cre=(()=>{class t{constructor(){this.data=new Map}getItem(e){return this.data.get(e)}removeItem(e){this.data.delete(e)}setItem(e,i){this.data.set(e,i)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();class Vk{constructor(n){this.type=n}}class mA extends Vk{constructor(n,e=null){super(n),this.info=e}}class f0 extends Vk{constructor(n,e=null){super(n),this.info=e}}class Tc extends Vk{constructor(n,e,i=null){super(n),this.reason=e,this.params=i}}function BV(t){const n=t.replace(/-/g,"+").replace(/_/g,"/");return decodeURIComponent(atob(n).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function Hk(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}class LB{constructor(n){this.clientId="",this.redirectUri="",this.postLogoutRedirectUri="",this.redirectUriAsPostLogoutRedirectUriFallback=!0,this.loginUrl="",this.scope="openid profile",this.resource="",this.rngUrl="",this.oidc=!0,this.requestAccessToken=!0,this.options=null,this.issuer="",this.logoutUrl="",this.clearHashAfterLogin=!0,this.tokenEndpoint=null,this.revocationEndpoint=null,this.customTokenParameters=[],this.userinfoEndpoint=null,this.responseType="",this.showDebugInformation=!1,this.silentRefreshRedirectUri="",this.silentRefreshMessagePrefix="",this.silentRefreshShowIFrame=!1,this.siletRefreshTimeout=2e4,this.silentRefreshTimeout=2e4,this.dummyClientSecret="",this.requireHttps="remoteOnly",this.strictDiscoveryDocumentValidation=!0,this.jwks=null,this.customQueryParams=null,this.silentRefreshIFrameName="angular-oauth-oidc-silent-refresh-iframe",this.timeoutFactor=.75,this.sessionChecksEnabled=!1,this.sessionCheckIntervall=3e3,this.sessionCheckIFrameUrl=null,this.sessionCheckIFrameName="angular-oauth-oidc-check-session-iframe",this.disableAtHashCheck=!1,this.skipSubjectCheck=!1,this.useIdTokenHintForSilentRefresh=!1,this.skipIssuerCheck=!1,this.nonceStateSeparator=";",this.useHttpBasicAuth=!1,this.decreaseExpirationBySec=0,this.waitForTokenInMsec=0,this.disablePKCE=!1,this.preserveRequestedRoute=!1,this.disableIdTokenTimer=!1,this.checkOrigin=!1,this.openUri=e=>{location.href=e},n&&Object.assign(this,n)}}class YE{encodeKey(n){return encodeURIComponent(n)}encodeValue(n){return encodeURIComponent(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}class MV{}let FV=(()=>{class t{getHashFragmentParams(e){let i=e||window.location.hash;if(i=decodeURIComponent(i),0!==i.indexOf("#"))return{};const s=i.indexOf("?");return i=i.substr(s>-1?s+1:1),this.parseQueryString(i)}parseQueryString(e){const i={};let s,l,h,m,b,E;if(null===e)return i;const M=e.split("&");for(let L=0;L<M.length;L++)s=M[L],l=s.indexOf("="),-1===l?(h=s,m=null):(h=s.substr(0,l),m=s.substr(l+1)),b=decodeURIComponent(h),E=decodeURIComponent(m),"/"===b.substr(0,1)&&(b=b.substr(1)),i[b]=E;return i}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();const Sre=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function Qk(t,n,e,i,s){let l,h,m,b,E,M,L,G,V,ne,re,de,fe;for(;s>=64;){for(l=n[0],h=n[1],m=n[2],b=n[3],E=n[4],M=n[5],L=n[6],G=n[7],ne=0;ne<16;ne++)re=i+4*ne,t[ne]=(255&e[re])<<24|(255&e[re+1])<<16|(255&e[re+2])<<8|255&e[re+3];for(ne=16;ne<64;ne++)V=t[ne-2],de=(V>>>17|V<<15)^(V>>>19|V<<13)^V>>>10,V=t[ne-15],fe=(V>>>7|V<<25)^(V>>>18|V<<14)^V>>>3,t[ne]=(de+t[ne-7]|0)+(fe+t[ne-16]|0);for(ne=0;ne<64;ne++)de=(((E>>>6|E<<26)^(E>>>11|E<<21)^(E>>>25|E<<7))+(E&M^~E&L)|0)+(G+(Sre[ne]+t[ne]|0)|0)|0,fe=((l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10))+(l&h^l&m^h&m)|0,G=L,L=M,M=E,E=b+de|0,b=m,m=h,h=l,l=de+fe|0;n[0]+=l,n[1]+=h,n[2]+=m,n[3]+=b,n[4]+=E,n[5]+=M,n[6]+=L,n[7]+=G,i+=64,s-=64}return i}class UB{constructor(){this.digestLength=32,this.blockSize=64,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}reset(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this}clean(){for(let n=0;n<this.buffer.length;n++)this.buffer[n]=0;for(let n=0;n<this.temp.length;n++)this.temp[n]=0;this.reset()}update(n,e=n.length){if(this.finished)throw new Error("SHA256: can't update because hash was finished.");let i=0;if(this.bytesHashed+=e,this.bufferLength>0){for(;this.bufferLength<64&&e>0;)this.buffer[this.bufferLength++]=n[i++],e--;64===this.bufferLength&&(Qk(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(e>=64&&(i=Qk(this.temp,this.state,n,i,e),e%=64);e>0;)this.buffer[this.bufferLength++]=n[i++],e--;return this}finish(n){if(!this.finished){const e=this.bytesHashed,i=this.bufferLength,s=e/536870912|0,l=e<<3,h=e%64<56?64:128;this.buffer[i]=128;for(let m=i+1;m<h-8;m++)this.buffer[m]=0;this.buffer[h-8]=s>>>24&255,this.buffer[h-7]=s>>>16&255,this.buffer[h-6]=s>>>8&255,this.buffer[h-5]=s>>>0&255,this.buffer[h-4]=l>>>24&255,this.buffer[h-3]=l>>>16&255,this.buffer[h-2]=l>>>8&255,this.buffer[h-1]=l>>>0&255,Qk(this.temp,this.state,this.buffer,0,h),this.finished=!0}for(let e=0;e<8;e++)n[4*e+0]=this.state[e]>>>24&255,n[4*e+1]=this.state[e]>>>16&255,n[4*e+2]=this.state[e]>>>8&255,n[4*e+3]=this.state[e]>>>0&255;return this}digest(){const n=new Uint8Array(this.digestLength);return this.finish(n),n}_saveState(n){for(let e=0;e<this.state.length;e++)n[e]=this.state[e]}_restoreState(n,e){for(let i=0;i<this.state.length;i++)this.state[i]=n[i];this.bytesHashed=e,this.finished=!1,this.bufferLength=0}}new Uint8Array(32);class OV{}let Rre=(()=>{class t{calcHash(e,i){return(0,Um.Z)(function*(){return function Fre(t){const n=[];for(let e=0;e<t.length;e++)n.push(String.fromCharCode(t[e]));return n.join("")}(function Tre(t){const n=(new UB).update(t),e=n.digest();return n.clean(),e}(function Mre(t){if("string"!=typeof t)throw new TypeError("expected string");const n=t,e=new Uint8Array(n.length);for(let i=0;i<n.length;i++)e[i]=n.charCodeAt(i);return e}(e)))})()}toHashString2(e){let i="";for(const s of e)i+=String.fromCharCode(s);return i}toHashString(e){const i=new Uint8Array(e);let s="";for(const l of i)s+=String.fromCharCode(l);return s}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})(),Gk=(()=>{class t extends LB{constructor(e,i,s,l,h,m,b,E,M,L){super(),this.ngZone=e,this.http=i,this.config=h,this.urlHelper=m,this.logger=b,this.crypto=E,this.dateTimeService=L,this.discoveryDocumentLoaded=!1,this.state="",this.eventsSubject=new Li,this.discoveryDocumentLoadedSubject=new Li,this.grantTypesSupported=[],this.inImplicitFlow=!1,this.saveNoncesInLocalStorage=!1,this.debug("angular-oauth2-oidc v10"),this.document=M,h||(h={}),this.discoveryDocumentLoaded$=this.discoveryDocumentLoadedSubject.asObservable(),this.events=this.eventsSubject.asObservable(),l&&(this.tokenValidationHandler=l),h&&this.configure(h);try{s?this.setStorage(s):typeof sessionStorage<"u"&&this.setStorage(sessionStorage)}catch(G){console.error("No OAuthStorage provided and cannot access default (sessionStorage).Consider providing a custom OAuthStorage implementation in your module.",G)}if(this.checkLocalStorageAccessable()){const G=window?.navigator?.userAgent;(G?.includes("MSIE ")||G?.includes("Trident"))&&(this.saveNoncesInLocalStorage=!0)}this.setupRefreshTimer()}checkLocalStorageAccessable(){if(typeof window>"u")return!1;const e="test";try{return!(typeof window.localStorage>"u"||(localStorage.setItem(e,e),localStorage.removeItem(e),0))}catch{return!1}}configure(e){Object.assign(this,new LB,e),this.config=Object.assign({},new LB,e),this.sessionChecksEnabled&&this.setupSessionCheck(),this.configChanged()}configChanged(){this.setupRefreshTimer()}restartSessionChecksIfStillLoggedIn(){this.hasValidIdToken()&&this.initSessionCheck()}restartRefreshTimerIfStillLoggedIn(){this.setupExpirationTimers()}setupSessionCheck(){this.events.pipe(Io(e=>"token_received"===e.type)).subscribe(()=>{this.initSessionCheck()})}setupAutomaticSilentRefresh(e={},i,s=!0){let l=!0;this.clearAutomaticRefreshTimer(),this.automaticRefreshSubscription=this.events.pipe(sc(h=>{"token_received"===h.type?l=!0:"logout"===h.type&&(l=!1)}),Io(h=>"token_expires"===h.type&&(null==i||"any"===i||h.info===i)),Uy(1e3)).subscribe(()=>{l&&this.refreshInternal(e,s).catch(()=>{this.debug("Automatic silent refresh did not work")})}),this.restartRefreshTimerIfStillLoggedIn()}refreshInternal(e,i){return this.useSilentRefresh||"code"!==this.responseType?this.silentRefresh(e,i):this.refreshToken()}loadDiscoveryDocumentAndTryLogin(e=null){return this.loadDiscoveryDocument().then(()=>this.tryLogin(e))}loadDiscoveryDocumentAndLogin(e=null){return this.loadDiscoveryDocumentAndTryLogin(e=e||{}).then(()=>!(!this.hasValidIdToken()||!this.hasValidAccessToken())||(this.initLoginFlow("string"==typeof e.state?e.state:""),!1))}debug(...e){this.showDebugInformation&&this.logger.debug(...e)}validateUrlFromDiscoveryDocument(e){const i=[],s=this.validateUrlForHttps(e),l=this.validateUrlAgainstIssuer(e);return s||i.push("https for all urls required. Also for urls received by discovery."),l||i.push("Every url in discovery document has to start with the issuer url.Also see property strictDiscoveryDocumentValidation."),i}validateUrlForHttps(e){if(!e)return!0;const i=e.toLowerCase();return!(!1!==this.requireHttps&&(!i.match(/^http:\/\/localhost($|[:/])/)&&!i.match(/^http:\/\/localhost($|[:/])/)||"remoteOnly"!==this.requireHttps))||i.startsWith("https://")}assertUrlNotNullAndCorrectProtocol(e,i){if(!e)throw new Error(`'${i}' should not be null`);if(!this.validateUrlForHttps(e))throw new Error(`'${i}' must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).`)}validateUrlAgainstIssuer(e){return!this.strictDiscoveryDocumentValidation||!e||e.toLowerCase().startsWith(this.issuer.toLowerCase())}setupRefreshTimer(){typeof window>"u"?this.debug("timer not supported on this plattform"):((this.hasValidIdToken()||this.hasValidAccessToken())&&(this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.setupExpirationTimers()),this.tokenReceivedSubscription&&this.tokenReceivedSubscription.unsubscribe(),this.tokenReceivedSubscription=this.events.pipe(Io(e=>"token_received"===e.type)).subscribe(()=>{this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.setupExpirationTimers()}))}setupExpirationTimers(){this.hasValidAccessToken()&&this.setupAccessTokenTimer(),!this.disableIdTokenTimer&&this.hasValidIdToken()&&this.setupIdTokenTimer()}setupAccessTokenTimer(){const e=this.getAccessTokenExpiration(),i=this.getAccessTokenStoredAt(),s=this.calcTimeout(i,e);this.ngZone.runOutsideAngular(()=>{this.accessTokenTimeoutSubscription=Bi(new f0("token_expires","access_token")).pipe(EE(s)).subscribe(l=>{this.ngZone.run(()=>{this.eventsSubject.next(l)})})})}setupIdTokenTimer(){const e=this.getIdTokenExpiration(),i=this.getIdTokenStoredAt(),s=this.calcTimeout(i,e);this.ngZone.runOutsideAngular(()=>{this.idTokenTimeoutSubscription=Bi(new f0("token_expires","id_token")).pipe(EE(s)).subscribe(l=>{this.ngZone.run(()=>{this.eventsSubject.next(l)})})})}stopAutomaticRefresh(){this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.clearAutomaticRefreshTimer()}clearAccessTokenTimer(){this.accessTokenTimeoutSubscription&&this.accessTokenTimeoutSubscription.unsubscribe()}clearIdTokenTimer(){this.idTokenTimeoutSubscription&&this.idTokenTimeoutSubscription.unsubscribe()}clearAutomaticRefreshTimer(){this.automaticRefreshSubscription&&this.automaticRefreshSubscription.unsubscribe()}calcTimeout(e,i){const s=this.dateTimeService.now(),h=Math.max(0,(i-e)*this.timeoutFactor-(s-e)),m=2147483647;return h>m?m:h}setStorage(e){this._storage=e,this.configChanged()}loadDiscoveryDocument(e=null){return new Promise((i,s)=>{e||((e=this.issuer||"").endsWith("/")||(e+="/"),e+=".well-known/openid-configuration"),this.validateUrlForHttps(e)?this.http.get(e).subscribe(l=>{if(!this.validateDiscoveryDocument(l))return this.eventsSubject.next(new Tc("discovery_document_validation_error",null)),void s("discovery_document_validation_error");this.loginUrl=l.authorization_endpoint,this.logoutUrl=l.end_session_endpoint||this.logoutUrl,this.grantTypesSupported=l.grant_types_supported,this.issuer=l.issuer,this.tokenEndpoint=l.token_endpoint,this.userinfoEndpoint=l.userinfo_endpoint||this.userinfoEndpoint,this.jwksUri=l.jwks_uri,this.sessionCheckIFrameUrl=l.check_session_iframe||this.sessionCheckIFrameUrl,this.discoveryDocumentLoaded=!0,this.discoveryDocumentLoadedSubject.next(l),this.revocationEndpoint=l.revocation_endpoint||this.revocationEndpoint,this.sessionChecksEnabled&&this.restartSessionChecksIfStillLoggedIn(),this.loadJwks().then(h=>{const b=new mA("discovery_document_loaded",{discoveryDocument:l,jwks:h});this.eventsSubject.next(b),i(b)}).catch(h=>{this.eventsSubject.next(new Tc("discovery_document_load_error",h)),s(h)})},l=>{this.logger.error("error loading discovery document",l),this.eventsSubject.next(new Tc("discovery_document_load_error",l)),s(l)}):s("issuer  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).")})}loadJwks(){return new Promise((e,i)=>{this.jwksUri?this.http.get(this.jwksUri).subscribe(s=>{this.jwks=s,e(s)},s=>{this.logger.error("error loading jwks",s),this.eventsSubject.next(new Tc("jwks_load_error",s)),i(s)}):e(null)})}validateDiscoveryDocument(e){let i;return this.skipIssuerCheck||e.issuer===this.issuer?(i=this.validateUrlFromDiscoveryDocument(e.authorization_endpoint),i.length>0?(this.logger.error("error validating authorization_endpoint in discovery document",i),!1):(i=this.validateUrlFromDiscoveryDocument(e.end_session_endpoint),i.length>0?(this.logger.error("error validating end_session_endpoint in discovery document",i),!1):(i=this.validateUrlFromDiscoveryDocument(e.token_endpoint),i.length>0&&this.logger.error("error validating token_endpoint in discovery document",i),i=this.validateUrlFromDiscoveryDocument(e.revocation_endpoint),i.length>0&&this.logger.error("error validating revocation_endpoint in discovery document",i),i=this.validateUrlFromDiscoveryDocument(e.userinfo_endpoint),i.length>0?(this.logger.error("error validating userinfo_endpoint in discovery document",i),!1):(i=this.validateUrlFromDiscoveryDocument(e.jwks_uri),i.length>0?(this.logger.error("error validating jwks_uri in discovery document",i),!1):(this.sessionChecksEnabled&&!e.check_session_iframe&&this.logger.warn("sessionChecksEnabled is activated but discovery document does not contain a check_session_iframe field"),!0))))):(this.logger.error("invalid issuer in discovery document","expected: "+this.issuer,"current: "+e.issuer),!1)}fetchTokenUsingPasswordFlowAndLoadUserProfile(e,i,s=new Eh){return this.fetchTokenUsingPasswordFlow(e,i,s).then(()=>this.loadUserProfile())}loadUserProfile(){if(!this.hasValidAccessToken())throw new Error("Can not load User Profile without access_token");if(!this.validateUrlForHttps(this.userinfoEndpoint))throw new Error("userinfoEndpoint must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");return new Promise((e,i)=>{const s=(new Eh).set("Authorization","Bearer "+this.getAccessToken());this.http.get(this.userinfoEndpoint,{headers:s,observe:"response",responseType:"text"}).subscribe(l=>{if(this.debug("userinfo received",JSON.stringify(l)),l.headers.get("content-type").startsWith("application/json")){let h=JSON.parse(l.body);const m=this.getIdentityClaims()||{};if(!this.skipSubjectCheck&&this.oidc&&(!m.sub||h.sub!==m.sub))return void i("if property oidc is true, the received user-id (sub) has to be the user-id of the user that has logged in with oidc.\nif you are not using oidc but just oauth2 password flow set oidc to false");h=Object.assign({},m,h),this._storage.setItem("id_token_claims_obj",JSON.stringify(h)),this.eventsSubject.next(new mA("user_profile_loaded")),e({info:h})}else this.debug("userinfo is not JSON, treating it as JWE/JWS"),this.eventsSubject.next(new mA("user_profile_loaded")),e(JSON.parse(l.body))},l=>{this.logger.error("error loading user info",l),this.eventsSubject.next(new Tc("user_profile_load_error",l)),i(l)})})}fetchTokenUsingPasswordFlow(e,i,s=new Eh){return this.fetchTokenUsingGrant("password",{username:e,password:i},s)}fetchTokenUsingGrant(e,i,s=new Eh){this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint");let l=new gA({encoder:new YE}).set("grant_type",e).set("scope",this.scope);if(this.useHttpBasicAuth){const h=btoa(`${this.clientId}:${this.dummyClientSecret}`);s=s.set("Authorization","Basic "+h)}if(this.useHttpBasicAuth||(l=l.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(l=l.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const h of Object.getOwnPropertyNames(this.customQueryParams))l=l.set(h,this.customQueryParams[h]);for(const h of Object.keys(i))l=l.set(h,i[h]);return s=s.set("Content-Type","application/x-www-form-urlencoded"),new Promise((h,m)=>{this.http.post(this.tokenEndpoint,l,{headers:s}).subscribe(b=>{this.debug("tokenResponse",b),this.storeAccessTokenResponse(b.access_token,b.refresh_token,b.expires_in||this.fallbackAccessTokenExpirationTimeInSec,b.scope,this.extractRecognizedCustomParameters(b)),this.oidc&&b.id_token&&this.processIdToken(b.id_token,b.access_token).then(E=>{this.storeIdToken(E),h(b)}),this.eventsSubject.next(new mA("token_received")),h(b)},b=>{this.logger.error("Error performing ${grantType} flow",b),this.eventsSubject.next(new Tc("token_error",b)),m(b)})})}refreshToken(){return this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint"),new Promise((e,i)=>{let s=new gA({encoder:new YE}).set("grant_type","refresh_token").set("scope",this.scope).set("refresh_token",this._storage.getItem("refresh_token")),l=(new Eh).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const h=btoa(`${this.clientId}:${this.dummyClientSecret}`);l=l.set("Authorization","Basic "+h)}if(this.useHttpBasicAuth||(s=s.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(s=s.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const h of Object.getOwnPropertyNames(this.customQueryParams))s=s.set(h,this.customQueryParams[h]);this.http.post(this.tokenEndpoint,s,{headers:l}).pipe(cl(h=>this.oidc&&h.id_token?Gs(this.processIdToken(h.id_token,h.access_token,!0)).pipe(sc(m=>this.storeIdToken(m)),Ht(()=>h)):Bi(h))).subscribe(h=>{this.debug("refresh tokenResponse",h),this.storeAccessTokenResponse(h.access_token,h.refresh_token,h.expires_in||this.fallbackAccessTokenExpirationTimeInSec,h.scope,this.extractRecognizedCustomParameters(h)),this.eventsSubject.next(new mA("token_received")),this.eventsSubject.next(new mA("token_refreshed")),e(h)},h=>{this.logger.error("Error refreshing token",h),this.eventsSubject.next(new Tc("token_refresh_error",h)),i(h)})})}removeSilentRefreshEventListener(){this.silentRefreshPostMessageEventListener&&(window.removeEventListener("message",this.silentRefreshPostMessageEventListener),this.silentRefreshPostMessageEventListener=null)}setupSilentRefreshEventListener(){this.removeSilentRefreshEventListener(),this.silentRefreshPostMessageEventListener=e=>{const i=this.processMessageEventMessage(e);this.checkOrigin&&e.origin!==location.origin&&console.error("wrong origin requested silent refresh!"),this.tryLogin({customHashFragment:i,preventClearHashAfterLogin:!0,customRedirectUri:this.silentRefreshRedirectUri||this.redirectUri}).catch(s=>this.debug("tryLogin during silent refresh failed",s))},window.addEventListener("message",this.silentRefreshPostMessageEventListener)}silentRefresh(e={},i=!0){const s=this.getIdentityClaims()||{};if(this.useIdTokenHintForSilentRefresh&&this.hasValidIdToken()&&(e.id_token_hint=this.getIdToken()),!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(typeof this.document>"u")throw new Error("silent refresh is not supported on this platform");const l=this.document.getElementById(this.silentRefreshIFrameName);l&&this.document.body.removeChild(l),this.silentRefreshSubject=s.sub;const h=this.document.createElement("iframe");return h.id=this.silentRefreshIFrameName,this.setupSilentRefreshEventListener(),this.createLoginUrl(null,null,this.silentRefreshRedirectUri||this.redirectUri,i,e).then(L=>{h.setAttribute("src",L),this.silentRefreshShowIFrame||(h.style.display="none"),this.document.body.appendChild(h)}),MO([this.events.pipe(Io(L=>L instanceof Tc),Om()),this.events.pipe(Io(L=>"token_received"===L.type),Om()),Bi(new Tc("silent_refresh_timeout",null)).pipe(EE(this.silentRefreshTimeout))]).pipe(Ht(L=>{if(L instanceof Tc)throw"silent_refresh_timeout"===L.type||(L=new Tc("silent_refresh_error",L)),this.eventsSubject.next(L),L;return"token_received"===L.type&&(L=new mA("silently_refreshed"),this.eventsSubject.next(L)),L})).toPromise()}initImplicitFlowInPopup(e){return this.initLoginFlowInPopup(e)}initLoginFlowInPopup(e){return e=e||{},this.createLoginUrl(null,null,this.silentRefreshRedirectUri,!1,{display:"popup"}).then(i=>new Promise((s,l)=>{let b,m=null;e.windowRef?e.windowRef&&!e.windowRef.closed&&(m=e.windowRef,m.location.href=i):m=window.open(i,"ngx-oauth2-oidc-login",this.calculatePopupFeatures(e));const E=ne=>{this.tryLogin({customHashFragment:ne,preventClearHashAfterLogin:!0,customRedirectUri:this.silentRefreshRedirectUri}).then(()=>{L(),s(!0)},re=>{L(),l(re)})};m?b=window.setInterval(()=>{(!m||m.closed)&&(L(),l(new Tc("popup_closed",{})))},500):l(new Tc("popup_blocked",{}));const L=()=>{window.clearInterval(b),window.removeEventListener("storage",V),window.removeEventListener("message",G),null!==m&&m.close(),m=null},G=ne=>{const re=this.processMessageEventMessage(ne);re&&null!==re?(window.removeEventListener("storage",V),E(re)):console.log("false event firing")},V=ne=>{"auth_hash"===ne.key&&(window.removeEventListener("message",G),E(ne.newValue))};window.addEventListener("message",G),window.addEventListener("storage",V)}))}calculatePopupFeatures(e){const i=e.height||470,s=e.width||500,l=window.screenLeft+(window.outerWidth-s)/2;return`location=no,toolbar=no,width=${s},height=${i},top=${window.screenTop+(window.outerHeight-i)/2},left=${l}`}processMessageEventMessage(e){let i="#";if(this.silentRefreshMessagePrefix&&(i+=this.silentRefreshMessagePrefix),!e||!e.data||"string"!=typeof e.data)return;const s=e.data;return s.startsWith(i)?"#"+s.substr(i.length):void 0}canPerformSessionCheck(){return!(!this.sessionChecksEnabled||(this.sessionCheckIFrameUrl?this.getSessionState()?typeof this.document>"u":(console.warn("sessionChecksEnabled is activated but there is no session_state"),1):(console.warn("sessionChecksEnabled is activated but there is no sessionCheckIFrameUrl"),1)))}setupSessionCheckEventListener(){this.removeSessionCheckEventListener(),this.sessionCheckEventListener=e=>{const i=e.origin.toLowerCase(),s=this.issuer.toLowerCase();if(this.debug("sessionCheckEventListener"),s.startsWith(i)){switch(e.data){case"unchanged":this.ngZone.run(()=>{this.handleSessionUnchanged()});break;case"changed":this.ngZone.run(()=>{this.handleSessionChange()});break;case"error":this.ngZone.run(()=>{this.handleSessionError()})}this.debug("got info from session check inframe",e)}else this.debug("sessionCheckEventListener","wrong origin",i,"expected",s,"event",e)},this.ngZone.runOutsideAngular(()=>{window.addEventListener("message",this.sessionCheckEventListener)})}handleSessionUnchanged(){this.debug("session check","session unchanged"),this.eventsSubject.next(new f0("session_unchanged"))}handleSessionChange(){this.eventsSubject.next(new f0("session_changed")),this.stopSessionCheckTimer(),this.useSilentRefresh||"code"!==this.responseType?this.silentRefreshRedirectUri?(this.silentRefresh().catch(()=>this.debug("silent refresh failed after session changed")),this.waitForSilentRefreshAfterSessionChange()):(this.eventsSubject.next(new f0("session_terminated")),this.logOut(!0)):this.refreshToken().then(()=>{this.debug("token refresh after session change worked")}).catch(()=>{this.debug("token refresh did not work after session changed"),this.eventsSubject.next(new f0("session_terminated")),this.logOut(!0)})}waitForSilentRefreshAfterSessionChange(){this.events.pipe(Io(e=>"silently_refreshed"===e.type||"silent_refresh_timeout"===e.type||"silent_refresh_error"===e.type),Om()).subscribe(e=>{"silently_refreshed"!==e.type&&(this.debug("silent refresh did not work after session changed"),this.eventsSubject.next(new f0("session_terminated")),this.logOut(!0))})}handleSessionError(){this.stopSessionCheckTimer(),this.eventsSubject.next(new f0("session_error"))}removeSessionCheckEventListener(){this.sessionCheckEventListener&&(window.removeEventListener("message",this.sessionCheckEventListener),this.sessionCheckEventListener=null)}initSessionCheck(){if(!this.canPerformSessionCheck())return;const e=this.document.getElementById(this.sessionCheckIFrameName);e&&this.document.body.removeChild(e);const i=this.document.createElement("iframe");i.id=this.sessionCheckIFrameName,this.setupSessionCheckEventListener(),i.setAttribute("src",this.sessionCheckIFrameUrl),i.style.display="none",this.document.body.appendChild(i),this.startSessionCheckTimer()}startSessionCheckTimer(){this.stopSessionCheckTimer(),this.ngZone.runOutsideAngular(()=>{this.sessionCheckTimer=setInterval(this.checkSession.bind(this),this.sessionCheckIntervall)})}stopSessionCheckTimer(){this.sessionCheckTimer&&(clearInterval(this.sessionCheckTimer),this.sessionCheckTimer=null)}checkSession(){const e=this.document.getElementById(this.sessionCheckIFrameName);e||this.logger.warn("checkSession did not find iframe",this.sessionCheckIFrameName);const i=this.getSessionState();i||this.stopSessionCheckTimer(),e.contentWindow.postMessage(this.clientId+" "+i,this.issuer)}createLoginUrl(e="",i="",s="",l=!1,h={}){var m=this;return(0,Um.Z)(function*(){const b=m;let E;E=s||m.redirectUri;const M=yield m.createAndSaveNonce();if(e=e?M+m.config.nonceStateSeparator+encodeURIComponent(e):M,!m.requestAccessToken&&!m.oidc)throw new Error("Either requestAccessToken or oidc or both must be true");m.responseType=m.config.responseType?m.config.responseType:m.oidc&&m.requestAccessToken?"id_token token":m.oidc&&!m.requestAccessToken?"id_token":"token";const L=b.loginUrl.indexOf("?")>-1?"&":"?";let G=b.scope;m.oidc&&!G.match(/(^|\s)openid($|\s)/)&&(G="openid "+G);let V=b.loginUrl+L+"response_type="+encodeURIComponent(b.responseType)+"&client_id="+encodeURIComponent(b.clientId)+"&state="+encodeURIComponent(e)+"&redirect_uri="+encodeURIComponent(E)+"&scope="+encodeURIComponent(G);if(m.responseType.includes("code")&&!m.disablePKCE){const[ne,re]=yield m.createChallangeVerifierPairForPKCE();m.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.setItem("PKCE_verifier",re):m._storage.setItem("PKCE_verifier",re),V+="&code_challenge="+ne,V+="&code_challenge_method=S256"}i&&(V+="&login_hint="+encodeURIComponent(i)),b.resource&&(V+="&resource="+encodeURIComponent(b.resource)),b.oidc&&(V+="&nonce="+encodeURIComponent(M)),l&&(V+="&prompt=none");for(const ne of Object.keys(h))V+="&"+encodeURIComponent(ne)+"="+encodeURIComponent(h[ne]);if(m.customQueryParams)for(const ne of Object.getOwnPropertyNames(m.customQueryParams))V+="&"+ne+"="+encodeURIComponent(m.customQueryParams[ne]);return V})()}initImplicitFlowInternal(e="",i=""){if(this.inImplicitFlow)return;if(this.inImplicitFlow=!0,!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");let s={},l=null;"string"==typeof i?l=i:"object"==typeof i&&(s=i),this.createLoginUrl(e,l,null,!1,s).then(this.config.openUri).catch(h=>{console.error("Error in initImplicitFlow",h),this.inImplicitFlow=!1})}initImplicitFlow(e="",i=""){""!==this.loginUrl?this.initImplicitFlowInternal(e,i):this.events.pipe(Io(s=>"discovery_document_loaded"===s.type)).subscribe(()=>this.initImplicitFlowInternal(e,i))}resetImplicitFlow(){this.inImplicitFlow=!1}callOnTokenReceivedIfExists(e){const i=this;if(e.onTokenReceived){const s={idClaims:i.getIdentityClaims(),idToken:i.getIdToken(),accessToken:i.getAccessToken(),state:i.state};e.onTokenReceived(s)}}storeAccessTokenResponse(e,i,s,l,h){if(this._storage.setItem("access_token",e),l&&!Array.isArray(l)?this._storage.setItem("granted_scopes",JSON.stringify(l.split(" "))):l&&Array.isArray(l)&&this._storage.setItem("granted_scopes",JSON.stringify(l)),this._storage.setItem("access_token_stored_at",""+this.dateTimeService.now()),s){const m=1e3*s,E=this.dateTimeService.new().getTime()+m;this._storage.setItem("expires_at",""+E)}i&&this._storage.setItem("refresh_token",i),h&&h.forEach((m,b)=>{this._storage.setItem(b,m)})}tryLogin(e=null){return"code"===this.config.responseType?this.tryLoginCodeFlow(e).then(()=>!0):this.tryLoginImplicitFlow(e)}parseQueryString(e){return e&&0!==e.length?("?"===e.charAt(0)&&(e=e.substr(1)),this.urlHelper.parseQueryString(e)):{}}tryLoginCodeFlow(e=null){var i=this;return(0,Um.Z)(function*(){const s=(e=e||{}).customHashFragment?e.customHashFragment.substring(1):window.location.search,l=i.getCodePartsFromUrl(s),h=l.code,m=l.state,b=l.session_state;if(!e.preventClearHashAfterLogin){const L=location.origin+location.pathname+location.search.replace(/code=[^&$]*/,"").replace(/scope=[^&$]*/,"").replace(/state=[^&$]*/,"").replace(/session_state=[^&$]*/,"").replace(/^\?&/,"?").replace(/&$/,"").replace(/^\?$/,"").replace(/&+/g,"&").replace(/\?&/,"?").replace(/\?$/,"")+location.hash;history.replaceState(null,window.name,L)}const[E,M]=i.parseState(m);if(i.state=M,l.error){i.debug("error trying to login"),i.handleLoginError(e,l);const L=new Tc("code_error",{},l);return i.eventsSubject.next(L),Promise.reject(L)}if(!e.disableNonceCheck){if(!E)return i.saveRequestedRoute(),Promise.resolve();if(!e.disableOAuth2StateCheck&&!i.validateNonce(E)){const G=new Tc("invalid_nonce_in_state",null);return i.eventsSubject.next(G),Promise.reject(G)}}return i.storeSessionState(b),h&&(yield i.getTokenFromCode(h,e),i.restoreRequestedRoute()),Promise.resolve()})()}saveRequestedRoute(){this.config.preserveRequestedRoute&&this._storage.setItem("requested_route",window.location.pathname+window.location.search)}restoreRequestedRoute(){const e=this._storage.getItem("requested_route");e&&history.replaceState(null,"",window.location.origin+e)}getCodePartsFromUrl(e){return e&&0!==e.length?("?"===e.charAt(0)&&(e=e.substr(1)),this.urlHelper.parseQueryString(e)):this.urlHelper.getHashFragmentParams()}getTokenFromCode(e,i){let s=new gA({encoder:new YE}).set("grant_type","authorization_code").set("code",e).set("redirect_uri",i.customRedirectUri||this.redirectUri);if(!this.disablePKCE){let l;l=this.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.getItem("PKCE_verifier"):this._storage.getItem("PKCE_verifier"),l?s=s.set("code_verifier",l):console.warn("No PKCE verifier found in oauth storage!")}return this.fetchAndProcessToken(s,i)}fetchAndProcessToken(e,i){i=i||{},this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint");let s=(new Eh).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const l=btoa(`${this.clientId}:${this.dummyClientSecret}`);s=s.set("Authorization","Basic "+l)}return this.useHttpBasicAuth||(e=e.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(e=e.set("client_secret",this.dummyClientSecret)),new Promise((l,h)=>{if(this.customQueryParams)for(const m of Object.getOwnPropertyNames(this.customQueryParams))e=e.set(m,this.customQueryParams[m]);this.http.post(this.tokenEndpoint,e,{headers:s}).subscribe(m=>{this.debug("refresh tokenResponse",m),this.storeAccessTokenResponse(m.access_token,m.refresh_token,m.expires_in||this.fallbackAccessTokenExpirationTimeInSec,m.scope,this.extractRecognizedCustomParameters(m)),this.oidc&&m.id_token?this.processIdToken(m.id_token,m.access_token,i.disableNonceCheck).then(b=>{this.storeIdToken(b),this.eventsSubject.next(new mA("token_received")),this.eventsSubject.next(new mA("token_refreshed")),l(m)}).catch(b=>{this.eventsSubject.next(new Tc("token_validation_error",b)),console.error("Error validating tokens"),console.error(b),h(b)}):(this.eventsSubject.next(new mA("token_received")),this.eventsSubject.next(new mA("token_refreshed")),l(m))},m=>{console.error("Error getting token",m),this.eventsSubject.next(new Tc("token_refresh_error",m)),h(m)})})}tryLoginImplicitFlow(e=null){let i;i=(e=e||{}).customHashFragment?this.urlHelper.getHashFragmentParams(e.customHashFragment):this.urlHelper.getHashFragmentParams(),this.debug("parsed url",i);const s=i.state,[l,h]=this.parseState(s);if(this.state=h,i.error){this.debug("error trying to login"),this.handleLoginError(e,i);const L=new Tc("token_error",{},i);return this.eventsSubject.next(L),Promise.reject(L)}const m=i.access_token,b=i.id_token,E=i.session_state,M=i.scope;if(!this.requestAccessToken&&!this.oidc)return Promise.reject("Either requestAccessToken or oidc (or both) must be true.");if(this.requestAccessToken&&!m||this.requestAccessToken&&!e.disableOAuth2StateCheck&&!s||this.oidc&&!b)return Promise.resolve(!1);if(this.sessionChecksEnabled&&!E&&this.logger.warn("session checks (Session Status Change Notification) were activated in the configuration but the id_token does not contain a session_state claim"),this.requestAccessToken&&!e.disableNonceCheck&&!this.validateNonce(l)){const G=new Tc("invalid_nonce_in_state",null);return this.eventsSubject.next(G),Promise.reject(G)}return this.requestAccessToken&&this.storeAccessTokenResponse(m,null,i.expires_in||this.fallbackAccessTokenExpirationTimeInSec,M),this.oidc?this.processIdToken(b,m,e.disableNonceCheck).then(L=>e.validationHandler?e.validationHandler({accessToken:m,idClaims:L.idTokenClaims,idToken:L.idToken,state:s}).then(()=>L):L).then(L=>(this.storeIdToken(L),this.storeSessionState(E),this.clearHashAfterLogin&&!e.preventClearHashAfterLogin&&this.clearLocationHash(),this.eventsSubject.next(new mA("token_received")),this.callOnTokenReceivedIfExists(e),this.inImplicitFlow=!1,!0)).catch(L=>(this.eventsSubject.next(new Tc("token_validation_error",L)),this.logger.error("Error validating tokens"),this.logger.error(L),Promise.reject(L))):(this.eventsSubject.next(new mA("token_received")),this.clearHashAfterLogin&&!e.preventClearHashAfterLogin&&this.clearLocationHash(),this.callOnTokenReceivedIfExists(e),Promise.resolve(!0))}parseState(e){let i=e,s="";if(e){const l=e.indexOf(this.config.nonceStateSeparator);l>-1&&(i=e.substr(0,l),s=e.substr(l+this.config.nonceStateSeparator.length))}return[i,s]}validateNonce(e){let i;return i=this.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.getItem("nonce"):this._storage.getItem("nonce"),i===e||(console.error("Validating access_token failed, wrong state/nonce.",i,e),!1)}storeIdToken(e){this._storage.setItem("id_token",e.idToken),this._storage.setItem("id_token_claims_obj",e.idTokenClaimsJson),this._storage.setItem("id_token_expires_at",""+e.idTokenExpiresAt),this._storage.setItem("id_token_stored_at",""+this.dateTimeService.now())}storeSessionState(e){this._storage.setItem("session_state",e)}getSessionState(){return this._storage.getItem("session_state")}handleLoginError(e,i){e.onLoginError&&e.onLoginError(i),this.clearHashAfterLogin&&!e.preventClearHashAfterLogin&&this.clearLocationHash()}getClockSkewInMsec(e=6e5){return this.clockSkewInSec||0===this.clockSkewInSec?1e3*this.clockSkewInSec:e}processIdToken(e,i,s=!1){const l=e.split("."),m=BV(this.padBase64(l[0])),b=JSON.parse(m),M=BV(this.padBase64(l[1])),L=JSON.parse(M);let G;if(G=this.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.getItem("nonce"):this._storage.getItem("nonce"),Array.isArray(L.aud)){if(L.aud.every(he=>he!==this.clientId)){const he="Wrong audience: "+L.aud.join(",");return this.logger.warn(he),Promise.reject(he)}}else if(L.aud!==this.clientId){const he="Wrong audience: "+L.aud;return this.logger.warn(he),Promise.reject(he)}if(!L.sub){const he="No sub claim in id_token";return this.logger.warn(he),Promise.reject(he)}if(this.sessionChecksEnabled&&this.silentRefreshSubject&&this.silentRefreshSubject!==L.sub){const he=`After refreshing, we got an id_token for another user (sub). Expected sub: ${this.silentRefreshSubject}, received sub: ${L.sub}`;return this.logger.warn(he),Promise.reject(he)}if(!L.iat){const he="No iat claim in id_token";return this.logger.warn(he),Promise.reject(he)}if(!this.skipIssuerCheck&&L.iss!==this.issuer){const he="Wrong issuer: "+L.iss;return this.logger.warn(he),Promise.reject(he)}if(!s&&L.nonce!==G){const he="Wrong nonce: "+L.nonce;return this.logger.warn(he),Promise.reject(he)}if(Object.prototype.hasOwnProperty.call(this,"responseType")&&("code"===this.responseType||"id_token"===this.responseType)&&(this.disableAtHashCheck=!0),!this.disableAtHashCheck&&this.requestAccessToken&&!L.at_hash){const he="An at_hash is needed!";return this.logger.warn(he),Promise.reject(he)}const V=this.dateTimeService.now(),ne=1e3*L.iat,re=1e3*L.exp,de=this.getClockSkewInMsec();if(ne-de>=V||re+de-this.decreaseExpirationBySec<=V){const he="Token has expired";return console.error(he),console.error({now:V,issuedAtMSec:ne,expiresAtMSec:re}),Promise.reject(he)}const fe={accessToken:i,idToken:e,jwks:this.jwks,idTokenClaims:L,idTokenHeader:b,loadKeys:()=>this.loadJwks()};return this.disableAtHashCheck?this.checkSignature(fe).then(()=>({idToken:e,idTokenClaims:L,idTokenClaimsJson:M,idTokenHeader:b,idTokenHeaderJson:m,idTokenExpiresAt:re})):this.checkAtHash(fe).then(he=>{if(!this.disableAtHashCheck&&this.requestAccessToken&&!he){const Ne="Wrong at_hash";return this.logger.warn(Ne),Promise.reject(Ne)}return this.checkSignature(fe).then(()=>{const We={idToken:e,idTokenClaims:L,idTokenClaimsJson:M,idTokenHeader:b,idTokenHeaderJson:m,idTokenExpiresAt:re};return this.disableAtHashCheck?We:this.checkAtHash(fe).then(pt=>{if(this.requestAccessToken&&!pt){const Qt="Wrong at_hash";return this.logger.warn(Qt),Promise.reject(Qt)}return We})})})}getIdentityClaims(){const e=this._storage.getItem("id_token_claims_obj");return e?JSON.parse(e):null}getGrantedScopes(){const e=this._storage.getItem("granted_scopes");return e?JSON.parse(e):null}getIdToken(){return this._storage?this._storage.getItem("id_token"):null}padBase64(e){for(;e.length%4!=0;)e+="=";return e}getAccessToken(){return this._storage?this._storage.getItem("access_token"):null}getRefreshToken(){return this._storage?this._storage.getItem("refresh_token"):null}getAccessTokenExpiration(){return this._storage.getItem("expires_at")?parseInt(this._storage.getItem("expires_at"),10):null}getAccessTokenStoredAt(){return parseInt(this._storage.getItem("access_token_stored_at"),10)}getIdTokenStoredAt(){return parseInt(this._storage.getItem("id_token_stored_at"),10)}getIdTokenExpiration(){return this._storage.getItem("id_token_expires_at")?parseInt(this._storage.getItem("id_token_expires_at"),10):null}hasValidAccessToken(){if(this.getAccessToken()){const e=this._storage.getItem("expires_at"),i=this.dateTimeService.new();return!(e&&parseInt(e,10)-this.decreaseExpirationBySec<i.getTime()-this.getClockSkewInMsec())}return!1}hasValidIdToken(){if(this.getIdToken()){const e=this._storage.getItem("id_token_expires_at"),i=this.dateTimeService.new();return!(e&&parseInt(e,10)-this.decreaseExpirationBySec<i.getTime()-this.getClockSkewInMsec())}return!1}getCustomTokenResponseProperty(e){return this._storage&&this.config.customTokenParameters&&this.config.customTokenParameters.indexOf(e)>=0&&null!==this._storage.getItem(e)?JSON.parse(this._storage.getItem(e)):null}authorizationHeader(){return"Bearer "+this.getAccessToken()}logOut(e={},i=""){let s=!1;"boolean"==typeof e&&(s=e,e={});const l=this.getIdToken();if(this._storage.removeItem("access_token"),this._storage.removeItem("id_token"),this._storage.removeItem("refresh_token"),this.saveNoncesInLocalStorage?(localStorage.removeItem("nonce"),localStorage.removeItem("PKCE_verifier")):(this._storage.removeItem("nonce"),this._storage.removeItem("PKCE_verifier")),this._storage.removeItem("expires_at"),this._storage.removeItem("id_token_claims_obj"),this._storage.removeItem("id_token_expires_at"),this._storage.removeItem("id_token_stored_at"),this._storage.removeItem("access_token_stored_at"),this._storage.removeItem("granted_scopes"),this._storage.removeItem("session_state"),this.config.customTokenParameters&&this.config.customTokenParameters.forEach(m=>this._storage.removeItem(m)),this.silentRefreshSubject=null,this.eventsSubject.next(new f0("logout")),!this.logoutUrl||s)return;let h;if(!this.validateUrlForHttps(this.logoutUrl))throw new Error("logoutUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(this.logoutUrl.indexOf("{{")>-1)h=this.logoutUrl.replace(/\{\{id_token\}\}/,encodeURIComponent(l)).replace(/\{\{client_id\}\}/,encodeURIComponent(this.clientId));else{let m=new gA({encoder:new YE});l&&(m=m.set("id_token_hint",l));const b=this.postLogoutRedirectUri||this.redirectUriAsPostLogoutRedirectUriFallback&&this.redirectUri||"";b&&(m=m.set("post_logout_redirect_uri",b),i&&(m=m.set("state",i)));for(const E in e)m=m.set(E,e[E]);h=this.logoutUrl+(this.logoutUrl.indexOf("?")>-1?"&":"?")+m.toString()}this.config.openUri(h)}createAndSaveNonce(){const e=this;return this.createNonce().then(function(i){return e.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.setItem("nonce",i):e._storage.setItem("nonce",i),i})}ngOnDestroy(){this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.removeSilentRefreshEventListener();const e=this.document.getElementById(this.silentRefreshIFrameName);e&&e.remove(),this.stopSessionCheckTimer(),this.removeSessionCheckEventListener();const i=this.document.getElementById(this.sessionCheckIFrameName);i&&i.remove()}createNonce(){return new Promise(e=>{if(this.rngUrl)throw new Error("createNonce with rng-web-api has not been implemented so far");const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";let s=45,l="";const h=typeof self>"u"?null:self.crypto||self.msCrypto;if(h){let m=new Uint8Array(s);h.getRandomValues(m),m.map||(m.map=Array.prototype.map),m=m.map(b=>i.charCodeAt(b%66)),l=String.fromCharCode.apply(null,m)}else for(;0<s--;)l+=i[66*Math.random()|0];e(Hk(l))})}checkAtHash(e){var i=this;return(0,Um.Z)(function*(){return i.tokenValidationHandler?i.tokenValidationHandler.validateAtHash(e):(i.logger.warn("No tokenValidationHandler configured. Cannot check at_hash."),!0)})()}checkSignature(e){return this.tokenValidationHandler?this.tokenValidationHandler.validateSignature(e):(this.logger.warn("No tokenValidationHandler configured. Cannot check signature."),Promise.resolve(null))}initLoginFlow(e="",i={}){return"code"===this.responseType?this.initCodeFlow(e,i):this.initImplicitFlow(e,i)}initCodeFlow(e="",i={}){""!==this.loginUrl?this.initCodeFlowInternal(e,i):this.events.pipe(Io(s=>"discovery_document_loaded"===s.type)).subscribe(()=>this.initCodeFlowInternal(e,i))}initCodeFlowInternal(e="",i={}){if(!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");let s={},l=null;"string"==typeof i?l=i:"object"==typeof i&&(s=i),this.createLoginUrl(e,l,null,!1,s).then(this.config.openUri).catch(h=>{console.error("Error in initAuthorizationCodeFlow"),console.error(h)})}createChallangeVerifierPairForPKCE(){var e=this;return(0,Um.Z)(function*(){if(!e.crypto)throw new Error("PKCE support for code flow needs a CryptoHander. Did you import the OAuthModule using forRoot() ?");const i=yield e.createNonce();return[Hk(yield e.crypto.calcHash(i,"sha-256")),i]})()}extractRecognizedCustomParameters(e){const i=new Map;return this.config.customTokenParameters&&this.config.customTokenParameters.forEach(s=>{e[s]&&i.set(s,JSON.stringify(e[s]))}),i}revokeTokenAndLogout(e={},i=!1){const s=this.revocationEndpoint,l=this.getAccessToken(),h=this.getRefreshToken();if(!l)return Promise.resolve();let m=new gA({encoder:new YE}),b=(new Eh).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const E=btoa(`${this.clientId}:${this.dummyClientSecret}`);b=b.set("Authorization","Basic "+E)}if(this.useHttpBasicAuth||(m=m.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(m=m.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const E of Object.getOwnPropertyNames(this.customQueryParams))m=m.set(E,this.customQueryParams[E]);return new Promise((E,M)=>{let L,G;if(l){const V=m.set("token",l).set("token_type_hint","access_token");L=this.http.post(s,V,{headers:b})}else L=Bi(null);if(h){const V=m.set("token",h).set("token_type_hint","refresh_token");G=this.http.post(s,V,{headers:b})}else G=Bi(null);i&&(L=L.pipe(sp(V=>0===V.status?Bi(null):l0(V))),G=G.pipe(sp(V=>0===V.status?Bi(null):l0(V)))),Rm([L,G]).subscribe(V=>{this.logOut(e),E(V),this.logger.info("Token successfully revoked")},V=>{this.logger.error("Error revoking token",V),this.eventsSubject.next(new Tc("token_revoke_error",V)),M(V)})})}clearLocationHash(){""!=location.hash&&(location.hash="")}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Wi),Xt(dg),Xt(DV,8),Xt(MV,8),Xt(LB,8),Xt(FV),Xt(IV),Xt(OV,8),Xt(wa),Xt(zk))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();class kV{}class Ore{handleError(n){return l0(n)}}let kre=(()=>{class t{constructor(e,i,s){this.oAuthService=e,this.errorHandler=i,this.moduleConfig=s}checkUrl(e){return this.moduleConfig.resourceServer.customUrlValidation?this.moduleConfig.resourceServer.customUrlValidation(e):!this.moduleConfig.resourceServer.allowedUrls||!!this.moduleConfig.resourceServer.allowedUrls.find(i=>e.toLowerCase().startsWith(i.toLowerCase()))}intercept(e,i){const s=e.url.toLowerCase();return this.moduleConfig&&this.moduleConfig.resourceServer&&this.checkUrl(s)?this.moduleConfig.resourceServer.sendAccessToken?so(Bi(this.oAuthService.getAccessToken()).pipe(Io(h=>!!h)),this.oAuthService.events.pipe(Io(h=>"token_received"===h.type),function bre(t,n){const{first:e,each:i,with:s=wre,scheduler:l=n??dx,meta:h=null}=h6(t)?{first:t}:"number"==typeof t?{each:t}:t;if(null==e&&null==i)throw new TypeError("No timeout provided.");return Xs((m,b)=>{let E,M,L=null,G=0;const V=ne=>{M=Jr(b,l,()=>{try{E.unsubscribe(),gn(s({meta:h,lastValue:L,seen:G})).subscribe(b)}catch(re){b.error(re)}},ne)};E=m.subscribe(Kr(b,ne=>{M?.unsubscribe(),G++,b.next(L=ne),i>0&&V(i)},void 0,void 0,()=>{M?.closed||M?.unsubscribe(),L=null})),!G&&V(null!=e?"number"==typeof e?e:+e-l.now():i)})}(this.oAuthService.waitForTokenInMsec||0),sp(()=>Bi(null)),Ht(()=>this.oAuthService.getAccessToken()))).pipe(Xo(1),es(h=>{if(h){const b=e.headers.set("Authorization","Bearer "+h);e=e.clone({headers:b})}return i.handle(e).pipe(sp(m=>this.errorHandler.handleError(m)))})):i.handle(e).pipe(sp(h=>this.errorHandler.handleError(h))):i.handle(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Gk),Xt(kV),Xt(TV,8))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();function Pre(){return console}function Nre(){return typeof sessionStorage<"u"?sessionStorage:new Cre}function Lre(t=null,n=SV){return ny([Gk,FV,{provide:IV,useFactory:Pre},{provide:DV,useFactory:Nre},{provide:MV,useClass:n},{provide:OV,useClass:Rre},{provide:kV,useClass:Ore},{provide:TV,useValue:t},{provide:lV,useClass:kre,multi:!0},{provide:zk,useClass:xre}])}let Ure=(()=>{class t{static forRoot(e=null,i=SV){return{ngModule:t,providers:[Lre(e,i)]}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({imports:[$R]})}return t})();new pi("AUTH_CONFIG");let Vre=(()=>{class t{constructor(e){this.oauthService=e,this.initLogin()}initLogin(){const e={issuer:"https://accounts.google.com",strictDiscoveryDocumentValidation:!1,clientId:"425568120623-hsu7kde4jjfesk9tucokejfvlm91t9q8.apps.googleusercontent.com",redirectUri:window.location.origin+"/home",scope:"openid profile email"};this.oauthService.configure(e),this.oauthService.setupAutomaticSilentRefresh(),this.oauthService.loadDiscoveryDocumentAndTryLogin()}login(){this.oauthService.initLoginFlow()}logout(){this.oauthService.logOut()}getProfile(){return this.oauthService.getIdentityClaims()}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Gk))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Hre=(()=>{class t{constructor(e,i,s){this.authGoogleService=e,this.user_service=i,this.router=s}login(){this.authGoogleService.login()}userLogin(){this.user_service.getUser(this.user,this.password).pipe(Ht(e=>e)).pipe(Ht(e=>e)).subscribe(e=>{e.length>0&&(this.user_service.current_usser=e[0],this.user_service.isAuthenticated=!0,this.user_service.userType=this.user_service.current_usser.typer_id,this.router.navigate(["home"]))})}onSubmit(){this.user_service.getUser(this.user,this.password)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Vre),Ve(q1),Ve(Dd))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-login"]],decls:30,vars:2,consts:[[1,"text-center","card","container","col-md-3"],[1,"mt-5","mb-5"],["src","https://getbootstrap.com/docs/5.0/assets/brand/bootstrap-logo.svg","alt","","width","72","height","57",1,"mb-4"],[1,"h3","mb-3","fw-normal"],[1,"form-floating"],["type","text","id","floatingInput","placeholder","name@example.com","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["for","floatingInput"],[1,"form-floating","mt-1"],["type","password","id","floatingPassword","placeholder","Password","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["for","floatingPassword"],[1,"checkbox","mb-3"],["type","checkbox","value","remember-me"],[1,"w-100","btn","btn-lg","btn-primary",3,"click"],[1,"or-container"],[1,"line-separator"],[1,"or-label"],[1,"row"],[1,"btn","btn-lg","btn-google","btn-block","text-uppercase","btn-outline",3,"click"],["src","https://img.icons8.com/color/22/000000/google-logo.png"]],template:function(i,s){1&i&&(oi(0,"br")(1,"h1"),pe(2,"div",0)(3,"div",1),oi(4,"img",2),pe(5,"h1",3),et(6,"Log In"),ye(),pe(7,"div",4)(8,"input",5),Tt("ngModelChange",function(h){return s.user=h}),ye(),pe(9,"label",6),et(10,"Email address"),ye()(),pe(11,"div",7)(12,"input",8),Tt("ngModelChange",function(h){return s.password=h}),ye(),pe(13,"label",9),et(14,"Password"),ye()(),pe(15,"div",10)(16,"label"),oi(17,"input",11),et(18," Remember me "),ye()(),pe(19,"button",12),Tt("click",function(){return s.userLogin()}),et(20,"Sign in"),ye(),pe(21,"div",13),oi(22,"div",14),pe(23,"div",15),et(24,"or"),ye(),oi(25,"div",14),ye(),pe(26,"div",16)(27,"button",17),Tt("click",function(){return s.login()}),oi(28,"img",18),et(29," Sing in Google "),ye()()()()),2&i&&($e(8),st("ngModel",s.user),$e(4),st("ngModel",s.password))},dependencies:[oc,Jc,Qu],styles:["container[_ngcontent-%COMP%]{margin-top:7%!important}.login-block[_ngcontent-%COMP%]{margin:30px auto;min-height:93.6vh}.login-block[_ngcontent-%COMP%]   .auth-box[_ngcontent-%COMP%]{margin:20px auto 0;max-width:450px!important}.card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 0 5px #2b2b2b1a,0 11px 6px -7px #2b2b2b1a;border:none;margin-bottom:30px;transition:all .3s ease-in-out;background-color:#fff}.card[_ngcontent-%COMP%]   .card-block[_ngcontent-%COMP%]{padding:1.25rem}.btn[_ngcontent-%COMP%]{border-radius:2px;text-transform:capitalize;font-size:15px;padding:10px 19px;cursor:pointer}.btn-md[_ngcontent-%COMP%]{padding:10px 16px;font-size:15px;line-height:23px}.btn-google[_ngcontent-%COMP%]{color:#545454;background-color:#fff;box-shadow:0 1px 3px 1px #ddd;border-radius:5px}.or-container[_ngcontent-%COMP%]{align-items:center;color:#ccc;display:flex;margin:25px 0}.line-separator[_ngcontent-%COMP%]{background-color:#ccc;flex-grow:5;height:1px}.or-label[_ngcontent-%COMP%]{flex-grow:1;margin:0 15px;text-align:center}.row[_ngcontent-%COMP%]{margin:1%}.btn-google[_ngcontent-%COMP%]:hover{background-color:#c23b33;border-color:#c23b33;color:#fff}"]})}return t})();function Qy(t){return null!=t&&"false"!=`${t}`}function PV(t,n=0){return function Qre(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):n}function _f(t){return t instanceof ao?t.nativeElement:t}const JE={schedule(t){let n=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:i}=JE;i&&(n=i.requestAnimationFrame,e=i.cancelAnimationFrame);const s=n(l=>{e=void 0,t(l)});return new Ai(()=>e?.(s))},requestAnimationFrame(...t){const{delegate:n}=JE;return(n?.requestAnimationFrame||requestAnimationFrame)(...t)},cancelAnimationFrame(...t){const{delegate:n}=JE;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...t)},delegate:void 0},NV=new class $re extends BO{flush(n){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let s;n=n||i.shift();do{if(s=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===e&&i.shift());if(this._active=!1,s){for(;(n=i[0])&&n.id===e&&i.shift();)n.unsubscribe();throw s}}}(class Gre extends DO{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,i=0){return null!==i&&i>0?super.requestAsyncId(n,e,i):(n.actions.push(this),n._scheduled||(n._scheduled=JE.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,e,i=0){var s;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,e,i);const{actions:l}=n;null!=e&&(null===(s=l[l.length-1])||void 0===s?void 0:s.id)!==e&&(JE.cancelAnimationFrame(e),n._scheduled=void 0)}});let $k,qre=1;const zB={};function LV(t){return t in zB&&(delete zB[t],!0)}const Kre={setImmediate(t){const n=qre++;return zB[n]=!0,$k||($k=Promise.resolve()),$k.then(()=>LV(n)&&t()),n},clearImmediate(t){LV(t)}},{setImmediate:Wre,clearImmediate:Zre}=Kre,VB={setImmediate(...t){const{delegate:n}=VB;return(n?.setImmediate||Wre)(...t)},clearImmediate(t){const{delegate:n}=VB;return(n?.clearImmediate||Zre)(t)},delegate:void 0};new class Yre extends BO{flush(n){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let s;n=n||i.shift();do{if(s=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===e&&i.shift());if(this._active=!1,s){for(;(n=i[0])&&n.id===e&&i.shift();)n.unsubscribe();throw s}}}(class Xre extends DO{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}requestAsyncId(n,e,i=0){return null!==i&&i>0?super.requestAsyncId(n,e,i):(n.actions.push(this),n._scheduled||(n._scheduled=VB.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,e,i=0){var s;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,e,i);const{actions:l}=n;null!=e&&(null===(s=l[l.length-1])||void 0===s?void 0:s.id)!==e&&(VB.clearImmediate(e),n._scheduled===e&&(n._scheduled=void 0))}});function UV(t,n=dx){return function ese(t){return Xs((n,e)=>{let i=!1,s=null,l=null,h=!1;const m=()=>{if(l?.unsubscribe(),l=null,i){i=!1;const E=s;s=null,e.next(E)}h&&e.complete()},b=()=>{l=null,h&&e.complete()};n.subscribe(Kr(e,E=>{i=!0,s=E,l||gn(t(E)).subscribe(l=Kr(e,m,b))},()=>{h=!0,(!i||!l||l.closed)&&e.complete()}))})}(()=>sB(t,n))}let qk;try{qk=typeof Intl<"u"&&Intl.v8BreakIterator}catch{qk=!1}let eS,HB,Z1,Kk,zV=(()=>{class t{constructor(e){this._platformId=e,this.isBrowser=this._platformId?OD(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!qk)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Uu))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function tS(t){return function tse(){if(null==eS&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>eS=!0}))}finally{eS=eS||!1}return eS}()?t:!!t.capture}function nS(){if("object"!=typeof document||!document)return 0;if(null==HB){const t=document.createElement("div"),n=t.style;t.dir="rtl",n.width="1px",n.overflow="auto",n.visibility="hidden",n.pointerEvents="none",n.position="absolute";const e=document.createElement("div"),i=e.style;i.width="2px",i.height="1px",t.appendChild(e),document.body.appendChild(t),HB=0,0===t.scrollLeft&&(t.scrollLeft=1,HB=0===t.scrollLeft?1:2),t.remove()}return HB}function HV(t){if(function ise(){if(null==Kk){const t=typeof document<"u"?document.head:null;Kk=!(!t||!t.createShadowRoot&&!t.attachShadow)}return Kk}()){const n=t.getRootNode?t.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}function QB(t){return t.composedPath?t.composedPath()[0]:t.target}const rse=new pi("cdk-dir-doc",{providedIn:"root",factory:function sse(){return In(wa)}}),ose=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Wk=(()=>{class t{constructor(e){this.value="ltr",this.change=new vi,e&&(this.value=function ase(t){const n=t?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?ose.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(rse,8))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),QV=(()=>{class t{constructor(e,i,s){this._ngZone=e,this._platform=i,this._scrolled=new Li,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=s}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const i=this.scrollContainers.get(e);i&&(i.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new Hr(i=>{this._globalSubscription||this._addGlobalListener();const s=e>0?this._scrolled.pipe(UV(e)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{s.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Bi()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(e,i){const s=this.getAncestorScrollContainers(e);return this.scrolled(i).pipe(Io(l=>!l||s.indexOf(l)>-1))}getAncestorScrollContainers(e){const i=[];return this.scrollContainers.forEach((s,l)=>{this._scrollableContainsElement(l,e)&&i.push(l)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,i){let s=_f(i),l=e.getElementRef().nativeElement;do{if(s==l)return!0}while(s=s.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Ba(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Wi),Xt(zV),Xt(wa,8))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),cse=(()=>{class t{constructor(e,i,s,l){this.elementRef=e,this.scrollDispatcher=i,this.ngZone=s,this.dir=l,this._destroyed=new Li,this._elementScrolled=new Hr(h=>this.ngZone.runOutsideAngular(()=>Ba(this.elementRef.nativeElement,"scroll").pipe(Ps(this._destroyed)).subscribe(h)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){const i=this.elementRef.nativeElement,s=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=s?e.end:e.start),null==e.right&&(e.right=s?e.start:e.end),null!=e.bottom&&(e.top=i.scrollHeight-i.clientHeight-e.bottom),s&&0!=nS()?(null!=e.left&&(e.right=i.scrollWidth-i.clientWidth-e.left),2==nS()?e.left=e.right:1==nS()&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=i.scrollWidth-i.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){const i=this.elementRef.nativeElement;!function nse(){if(null==Z1){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Z1=!1,Z1;if("scrollBehavior"in document.documentElement.style)Z1=!0;else{const t=Element.prototype.scrollTo;Z1=!!t&&!/\{\s*\[native code\]\s*\}/.test(t.toString())}}return Z1}()?(null!=e.top&&(i.scrollTop=e.top),null!=e.left&&(i.scrollLeft=e.left)):i.scrollTo(e)}measureScrollOffset(e){const i="left",s="right",l=this.elementRef.nativeElement;if("top"==e)return l.scrollTop;if("bottom"==e)return l.scrollHeight-l.clientHeight-l.scrollTop;const h=this.dir&&"rtl"==this.dir.value;return"start"==e?e=h?s:i:"end"==e&&(e=h?i:s),h&&2==nS()?e==i?l.scrollWidth-l.clientWidth-l.scrollLeft:l.scrollLeft:h&&1==nS()?e==i?l.scrollLeft+l.scrollWidth-l.clientWidth:-l.scrollLeft:e==i?l.scrollLeft:l.scrollWidth-l.clientWidth-l.scrollLeft}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(ao),Ve(QV),Ve(Wi),Ve(Wk,8))};static#t=this.\u0275dir=Xn({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0})}return t})(),hse=(()=>{class t{constructor(e,i,s){this._platform=e,this._change=new Li,this._changeListener=l=>{this._change.next(l)},this._document=s,i.runOutsideAngular(()=>{if(e.isBrowser){const l=this._getWindow();l.addEventListener("resize",this._changeListener),l.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:i,height:s}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+s,right:e.left+i,height:s,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,i=this._getWindow(),s=e.documentElement,l=s.getBoundingClientRect();return{top:-l.top||e.body.scrollTop||i.scrollY||s.scrollTop||0,left:-l.left||e.body.scrollLeft||i.scrollX||s.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(UV(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(zV),Xt(Wi),Xt(wa,8))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),dse=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({})}return t})();function Zk(t,n,e){for(let i in n)if(n.hasOwnProperty(i)){const s=n[i];s?t.setProperty(i,s,e?.has(i)?"important":""):t.removeProperty(i)}return t}function Ix(t,n){const e=n?"":"none";Zk(t.style,{"touch-action":n?"":"none","-webkit-user-drag":n?"":"none","-webkit-tap-highlight-color":n?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function qV(t,n,e){Zk(t.style,{position:n?"":"fixed",top:n?"":"0",opacity:n?"":"0",left:n?"":"-999em"},e)}function jB(t,n){return n&&"none"!=n?t+" "+n:t}function KV(t){const n=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*n}function Xk(t,n){return t.getPropertyValue(n).split(",").map(i=>i.trim())}function Yk(t){const n=t.getBoundingClientRect();return{top:n.top,right:n.right,bottom:n.bottom,left:n.left,width:n.width,height:n.height,x:n.x,y:n.y}}function Jk(t,n,e){const{top:i,bottom:s,left:l,right:h}=t;return e>=i&&e<=s&&n>=l&&n<=h}function iS(t,n,e){t.top+=n,t.bottom=t.top+t.height,t.left+=e,t.right=t.left+t.width}function WV(t,n,e,i){const{top:s,right:l,bottom:h,left:m,width:b,height:E}=t,M=b*n,L=E*n;return i>s-L&&i<h+L&&e>m-M&&e<l+M}class ZV{constructor(n){this._document=n,this.positions=new Map}clear(){this.positions.clear()}cache(n){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),n.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:Yk(e)})})}handleScroll(n){const e=QB(n),i=this.positions.get(e);if(!i)return null;const s=i.scrollPosition;let l,h;if(e===this._document){const E=this.getViewportScrollPosition();l=E.top,h=E.left}else l=e.scrollTop,h=e.scrollLeft;const m=s.top-l,b=s.left-h;return this.positions.forEach((E,M)=>{E.clientRect&&e!==M&&e.contains(M)&&iS(E.clientRect,m,b)}),s.top=l,s.left=h,{top:m,left:b}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function XV(t){const n=t.cloneNode(!0),e=n.querySelectorAll("[id]"),i=t.nodeName.toLowerCase();n.removeAttribute("id");for(let s=0;s<e.length;s++)e[s].removeAttribute("id");return"canvas"===i?eH(t,n):("input"===i||"select"===i||"textarea"===i)&&JV(t,n),YV("canvas",t,n,eH),YV("input, textarea, select",t,n,JV),n}function YV(t,n,e,i){const s=n.querySelectorAll(t);if(s.length){const l=e.querySelectorAll(t);for(let h=0;h<s.length;h++)i(s[h],l[h])}}let Bse=0;function JV(t,n){"file"!==n.type&&(n.value=t.value),"radio"===n.type&&n.name&&(n.name=`mat-clone-${n.name}-${Bse++}`)}function eH(t,n){const e=n.getContext("2d");if(e)try{e.drawImage(t,0,0)}catch{}}const tH=tS({passive:!0}),GB=tS({passive:!1}),eP=new Set(["position"]);class Fse{get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(n){const e=Qy(n);e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(i=>Ix(i,e)))}constructor(n,e,i,s,l,h){this._config=e,this._document=i,this._ngZone=s,this._viewportRuler=l,this._dragDropRegistry=h,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new Li,this._pointerMoveSubscription=Ai.EMPTY,this._pointerUpSubscription=Ai.EMPTY,this._scrollSubscription=Ai.EMPTY,this._resizeSubscription=Ai.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new Li,this.started=new Li,this.released=new Li,this.ended=new Li,this.entered=new Li,this.exited=new Li,this.dropped=new Li,this.moved=this._moveEvents,this._pointerDown=m=>{if(this.beforeStarted.next(),this._handles.length){const b=this._getTargetHandle(m);b&&!this._disabledHandles.has(b)&&!this.disabled&&this._initializeDragSequence(b,m)}else this.disabled||this._initializeDragSequence(this._rootElement,m)},this._pointerMove=m=>{const b=this._getPointerPositionOnPage(m);if(!this._hasStartedDragging){if(Math.abs(b.x-this._pickupPositionOnPage.x)+Math.abs(b.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const V=Date.now()>=this._dragStartTime+this._getDragStartDelay(m),ne=this._dropContainer;if(!V)return void this._endDragSequence(m);(!ne||!ne.isDragging()&&!ne.isReceiving())&&(m.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(m)))}return}m.preventDefault();const E=this._getConstrainedPointerPosition(b);if(this._hasMoved=!0,this._lastKnownPointerPosition=b,this._updatePointerDirectionDelta(E),this._dropContainer)this._updateActiveDropContainer(E,b);else{const M=this.constrainPosition?this._initialClientRect:this._pickupPositionOnPage,L=this._activeTransform;L.x=E.x-M.x+this._passiveTransform.x,L.y=E.y-M.y+this._passiveTransform.y,this._applyRootElementTransform(L.x,L.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:E,event:m,distance:this._getDragDistance(E),delta:this._pointerDirectionDelta})})},this._pointerUp=m=>{this._endDragSequence(m)},this._nativeDragStart=m=>{if(this._handles.length){const b=this._getTargetHandle(m);b&&!this._disabledHandles.has(b)&&!this.disabled&&m.preventDefault()}else this.disabled||m.preventDefault()},this.withRootElement(n).withParent(e.parentDragRef||null),this._parentPositions=new ZV(i),h.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(n){this._handles=n.map(i=>_f(i)),this._handles.forEach(i=>Ix(i,this.disabled)),this._toggleNativeDragInteractions();const e=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&e.add(i)}),this._disabledHandles=e,this}withPreviewTemplate(n){return this._previewTemplate=n,this}withPlaceholderTemplate(n){return this._placeholderTemplate=n,this}withRootElement(n){const e=_f(n);return e!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this._pointerDown,GB),e.addEventListener("touchstart",this._pointerDown,tH),e.addEventListener("dragstart",this._nativeDragStart,GB)}),this._initialTransform=void 0,this._rootElement=e),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(n){return this._boundaryElement=n?_f(n):null,this._resizeSubscription.unsubscribe(),n&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(n){return this._parentDragRef=n,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(n){!this._disabledHandles.has(n)&&this._handles.indexOf(n)>-1&&(this._disabledHandles.add(n),Ix(n,!0))}enableHandle(n){this._disabledHandles.has(n)&&(this._disabledHandles.delete(n),Ix(n,this.disabled))}withDirection(n){return this._direction=n,this}_withDropContainer(n){this._dropContainer=n}getFreeDragPosition(){const n=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:n.x,y:n.y}}setFreeDragPosition(n){return this._activeTransform={x:0,y:0},this._passiveTransform.x=n.x,this._passiveTransform.y=n.y,this._dropContainer||this._applyRootElementTransform(n.x,n.y),this}withPreviewContainer(n){return this._previewContainer=n,this}_sortFromLastPointerPosition(){const n=this._lastKnownPointerPosition;n&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(n),n)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview?.remove(),this._previewRef?.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(n){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this,event:n}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(n),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const e=this._getPointerPositionOnPage(n);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:n})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(n){rS(n)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const e=this._dropContainer;if(e){const i=this._rootElement,s=i.parentNode,l=this._placeholder=this._createPlaceholderElement(),h=this._anchor=this._anchor||this._document.createComment(""),m=this._getShadowRoot();s.insertBefore(h,i),this._initialTransform=i.style.transform||"",this._preview=this._createPreviewElement(),qV(i,!1,eP),this._document.body.appendChild(s.replaceChild(l,i)),this._getPreviewInsertionPoint(s,m).appendChild(this._preview),this.started.next({source:this,event:n}),e.start(),this._initialContainer=e,this._initialIndex=e.getItemIndex(this)}else this.started.next({source:this,event:n}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(e?e.getScrollableParents():[])}_initializeDragSequence(n,e){this._parentDragRef&&e.stopPropagation();const i=this.isDragging(),s=rS(e),l=!s&&0!==e.button,h=this._rootElement,m=QB(e),b=!s&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),E=s?function Sse(t){const n=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}(e):function Ese(t){return 0===t.buttons||0===t.detail}(e);if(m&&m.draggable&&"mousedown"===e.type&&e.preventDefault(),i||l||b||E)return;if(this._handles.length){const G=h.style;this._rootElementTapHighlight=G.webkitTapHighlightColor||"",G.webkitTapHighlightColor="transparent"}this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._initialClientRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(G=>this._updateOnScroll(G)),this._boundaryElement&&(this._boundaryRect=Yk(this._boundaryElement));const M=this._previewTemplate;this._pickupPositionInElement=M&&M.template&&!M.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialClientRect,n,e);const L=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:L.x,y:L.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(n){qV(this._rootElement,!0,eP),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialClientRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const e=this._dropContainer,i=e.getItemIndex(this),s=this._getPointerPositionOnPage(n),l=this._getDragDistance(s),h=e._isOverContainer(s.x,s.y);this.ended.next({source:this,distance:l,dropPoint:s,event:n}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:h,distance:l,dropPoint:s,event:n}),e.drop(this,i,this._initialIndex,this._initialContainer,h,l,s,n),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:n,y:e},{x:i,y:s}){let l=this._initialContainer._getSiblingContainerFromPosition(this,n,e);!l&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,e)&&(l=this._initialContainer),l&&l!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=l,this._dropContainer.enter(this,n,e,l===this._initialContainer&&l.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:l,currentIndex:l.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,s),this._dropContainer._sortItem(this,n,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(n,e):this._applyPreviewTransform(n-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_createPreviewElement(){const n=this._previewTemplate,e=this.previewClass,i=n?n.template:null;let s;if(i&&n){const l=n.matchSize?this._initialClientRect:null,h=n.viewContainer.createEmbeddedView(i,n.context);h.detectChanges(),s=iH(h,this._document),this._previewRef=h,n.matchSize?rH(s,l):s.style.transform=$B(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else s=XV(this._rootElement),rH(s,this._initialClientRect),this._initialTransform&&(s.style.transform=this._initialTransform);return Zk(s.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},eP),Ix(s,!1),s.classList.add("cdk-drag-preview"),s.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(l=>s.classList.add(l)):s.classList.add(e)),s}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const n=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(n.left,n.top);const e=function Dse(t){const n=getComputedStyle(t),e=Xk(n,"transition-property"),i=e.find(m=>"transform"===m||"all"===m);if(!i)return 0;const s=e.indexOf(i),l=Xk(n,"transition-duration"),h=Xk(n,"transition-delay");return KV(l[s])+KV(h[s])}(this._preview);return 0===e?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{const s=h=>{(!h||QB(h)===this._preview&&"transform"===h.propertyName)&&(this._preview?.removeEventListener("transitionend",s),i(),clearTimeout(l))},l=setTimeout(s,1.5*e);this._preview.addEventListener("transitionend",s)}))}_createPlaceholderElement(){const n=this._placeholderTemplate,e=n?n.template:null;let i;return e?(this._placeholderRef=n.viewContainer.createEmbeddedView(e,n.context),this._placeholderRef.detectChanges(),i=iH(this._placeholderRef,this._document)):i=XV(this._rootElement),i.style.pointerEvents="none",i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(n,e,i){const s=e===this._rootElement?null:e,l=s?s.getBoundingClientRect():n,h=rS(i)?i.targetTouches[0]:i,m=this._getViewportScrollPosition();return{x:l.left-n.left+(h.pageX-l.left-m.left),y:l.top-n.top+(h.pageY-l.top-m.top)}}_getPointerPositionOnPage(n){const e=this._getViewportScrollPosition(),i=rS(n)?n.touches[0]||n.changedTouches[0]||{pageX:0,pageY:0}:n,s=i.pageX-e.left,l=i.pageY-e.top;if(this._ownerSVGElement){const h=this._ownerSVGElement.getScreenCTM();if(h){const m=this._ownerSVGElement.createSVGPoint();return m.x=s,m.y=l,m.matrixTransform(h.inverse())}}return{x:s,y:l}}_getConstrainedPointerPosition(n){const e=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:s}=this.constrainPosition?this.constrainPosition(n,this,this._initialClientRect,this._pickupPositionInElement):n;if("x"===this.lockAxis||"x"===e?s=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):("y"===this.lockAxis||"y"===e)&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){const{x:l,y:h}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,m=this._boundaryRect,{width:b,height:E}=this._getPreviewRect(),M=m.top+h,L=m.bottom-(E-h);i=nH(i,m.left+l,m.right-(b-l)),s=nH(s,M,L)}return{x:i,y:s}}_updatePointerDirectionDelta(n){const{x:e,y:i}=n,s=this._pointerDirectionDelta,l=this._pointerPositionAtLastDirectionChange,h=Math.abs(e-l.x),m=Math.abs(i-l.y);return h>this._config.pointerDirectionChangeThreshold&&(s.x=e>l.x?1:-1,l.x=e),m>this._config.pointerDirectionChangeThreshold&&(s.y=i>l.y?1:-1,l.y=i),s}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const n=this._handles.length>0||!this.isDragging();n!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=n,Ix(this._rootElement,n))}_removeRootElementListeners(n){n.removeEventListener("mousedown",this._pointerDown,GB),n.removeEventListener("touchstart",this._pointerDown,tH),n.removeEventListener("dragstart",this._nativeDragStart,GB)}_applyRootElementTransform(n,e){const i=$B(n,e),s=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=s.transform&&"none"!=s.transform?s.transform:""),s.transform=jB(i,this._initialTransform)}_applyPreviewTransform(n,e){const i=this._previewTemplate?.template?void 0:this._initialTransform,s=$B(n,e);this._preview.style.transform=jB(s,i)}_getDragDistance(n){const e=this._pickupPositionOnPage;return e?{x:n.x-e.x,y:n.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:n,y:e}=this._passiveTransform;if(0===n&&0===e||this.isDragging()||!this._boundaryElement)return;const i=this._rootElement.getBoundingClientRect(),s=this._boundaryElement.getBoundingClientRect();if(0===s.width&&0===s.height||0===i.width&&0===i.height)return;const l=s.left-i.left,h=i.right-s.right,m=s.top-i.top,b=i.bottom-s.bottom;s.width>i.width?(l>0&&(n+=l),h>0&&(n-=h)):n=0,s.height>i.height?(m>0&&(e+=m),b>0&&(e-=b)):e=0,(n!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:n})}_getDragStartDelay(n){const e=this.dragStartDelay;return"number"==typeof e?e:rS(n)?e.touch:e?e.mouse:0}_updateOnScroll(n){const e=this._parentPositions.handleScroll(n);if(e){const i=QB(n);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&iS(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=HV(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(n,e){const i=this._previewContainer||"global";if("parent"===i)return n;if("global"===i){const s=this._document;return e||s.fullscreenElement||s.webkitFullscreenElement||s.mozFullScreenElement||s.msFullscreenElement||s.body}return _f(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialClientRect),this._previewRect}_getTargetHandle(n){return this._handles.find(e=>n.target&&(n.target===e||e.contains(n.target)))}}function $B(t,n){return`translate3d(${Math.round(t)}px, ${Math.round(n)}px, 0)`}function nH(t,n,e){return Math.max(n,Math.min(e,t))}function rS(t){return"t"===t.type[0]}function iH(t,n){const e=t.rootNodes;if(1===e.length&&e[0].nodeType===n.ELEMENT_NODE)return e[0];const i=n.createElement("div");return e.forEach(s=>i.appendChild(s)),i}function rH(t,n){t.style.width=`${n.width}px`,t.style.height=`${n.height}px`,t.style.transform=$B(n.left,n.top)}function tP(t,n,e){const i=sS(n,t.length-1),s=sS(e,t.length-1);if(i===s)return;const l=t[i],h=s<i?-1:1;for(let m=i;m!==s;m+=h)t[m]=t[m+h];t[s]=l}function sS(t,n){return Math.max(0,Math.min(n,t))}class Rse{constructor(n,e){this._element=n,this._dragDropRegistry=e,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(n){this.withItems(n)}sort(n,e,i,s){const l=this._itemPositions,h=this._getItemIndexFromPointerPosition(n,e,i,s);if(-1===h&&l.length>0)return null;const m="horizontal"===this.orientation,b=l.findIndex(de=>de.drag===n),E=l[h],L=E.clientRect,G=b>h?1:-1,V=this._getItemOffsetPx(l[b].clientRect,L,G),ne=this._getSiblingOffsetPx(b,l,G),re=l.slice();return tP(l,b,h),l.forEach((de,fe)=>{if(re[fe]===de)return;const he=de.drag===n,Ne=he?V:ne,We=he?n.getPlaceholderElement():de.drag.getRootElement();de.offset+=Ne,m?(We.style.transform=jB(`translate3d(${Math.round(de.offset)}px, 0, 0)`,de.initialTransform),iS(de.clientRect,0,Ne)):(We.style.transform=jB(`translate3d(0, ${Math.round(de.offset)}px, 0)`,de.initialTransform),iS(de.clientRect,Ne,0))}),this._previousSwap.overlaps=Jk(L,e,i),this._previousSwap.drag=E.drag,this._previousSwap.delta=m?s.x:s.y,{previousIndex:b,currentIndex:h}}enter(n,e,i,s){const l=null==s||s<0?this._getItemIndexFromPointerPosition(n,e,i):s,h=this._activeDraggables,m=h.indexOf(n),b=n.getPlaceholderElement();let E=h[l];if(E===n&&(E=h[l+1]),!E&&(null==l||-1===l||l<h.length-1)&&this._shouldEnterAsFirstChild(e,i)&&(E=h[0]),m>-1&&h.splice(m,1),E&&!this._dragDropRegistry.isDragging(E)){const M=E.getRootElement();M.parentElement.insertBefore(b,M),h.splice(l,0,n)}else _f(this._element).appendChild(b),h.push(n);b.style.transform="",this._cacheItemPositions()}withItems(n){this._activeDraggables=n.slice(),this._cacheItemPositions()}withSortPredicate(n){this._sortPredicate=n}reset(){this._activeDraggables.forEach(n=>{const e=n.getRootElement();if(e){const i=this._itemPositions.find(s=>s.drag===n)?.initialTransform;e.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(n){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(i=>i.drag===n)}updateOnScroll(n,e){this._itemPositions.forEach(({clientRect:i})=>{iS(i,n,e)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}_cacheItemPositions(){const n="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(e=>{const i=e.getVisibleElement();return{drag:e,offset:0,initialTransform:i.style.transform||"",clientRect:Yk(i)}}).sort((e,i)=>n?e.clientRect.left-i.clientRect.left:e.clientRect.top-i.clientRect.top)}_getItemOffsetPx(n,e,i){const s="horizontal"===this.orientation;let l=s?e.left-n.left:e.top-n.top;return-1===i&&(l+=s?e.width-n.width:e.height-n.height),l}_getSiblingOffsetPx(n,e,i){const s="horizontal"===this.orientation,l=e[n].clientRect,h=e[n+-1*i];let m=l[s?"width":"height"]*i;if(h){const b=s?"left":"top",E=s?"right":"bottom";-1===i?m-=h.clientRect[b]-l[E]:m+=l[b]-h.clientRect[E]}return m}_shouldEnterAsFirstChild(n,e){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,s="horizontal"===this.orientation;if(i[0].drag!==this._activeDraggables[0]){const h=i[i.length-1].clientRect;return s?n>=h.right:e>=h.bottom}{const h=i[0].clientRect;return s?n<=h.left:e<=h.top}}_getItemIndexFromPointerPosition(n,e,i,s){const l="horizontal"===this.orientation,h=this._itemPositions.findIndex(({drag:m,clientRect:b})=>m!==n&&((!s||m!==this._previousSwap.drag||!this._previousSwap.overlaps||(l?s.x:s.y)!==this._previousSwap.delta)&&(l?e>=Math.floor(b.left)&&e<Math.floor(b.right):i>=Math.floor(b.top)&&i<Math.floor(b.bottom))));return-1!==h&&this._sortPredicate(h,n)?h:-1}}class Ose{constructor(n,e,i,s,l){this._dragDropRegistry=e,this._ngZone=s,this._viewportRuler=l,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new Li,this.entered=new Li,this.exited=new Li,this.dropped=new Li,this.sorted=new Li,this.receivingStarted=new Li,this.receivingStopped=new Li,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=Ai.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new Li,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function Ise(t=0,n=dx){return t<0&&(t=0),sB(t,t,n)}(0,NV).pipe(Ps(this._stopScrollTimers)).subscribe(()=>{const h=this._scrollNode,m=this.autoScrollStep;1===this._verticalScrollDirection?h.scrollBy(0,-m):2===this._verticalScrollDirection&&h.scrollBy(0,m),1===this._horizontalScrollDirection?h.scrollBy(-m,0):2===this._horizontalScrollDirection&&h.scrollBy(m,0)})},this.element=_f(n),this._document=i,this.withScrollableParents([this.element]),e.registerDropContainer(this),this._parentPositions=new ZV(i),this._sortStrategy=new Rse(this.element,e),this._sortStrategy.withSortPredicate((h,m)=>this.sortPredicate(h,m,this))}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(n,e,i,s){this._draggingStarted(),null==s&&this.sortingDisabled&&(s=this._draggables.indexOf(n)),this._sortStrategy.enter(n,e,i,s),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:n,container:this,currentIndex:this.getItemIndex(n)})}exit(n){this._reset(),this.exited.next({item:n,container:this})}drop(n,e,i,s,l,h,m,b={}){this._reset(),this.dropped.next({item:n,currentIndex:e,previousIndex:i,container:this,previousContainer:s,isPointerOverContainer:l,distance:h,dropPoint:m,event:b})}withItems(n){const e=this._draggables;return this._draggables=n,n.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(e.filter(s=>s.isDragging()).every(s=>-1===n.indexOf(s))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(n){return this._sortStrategy.direction=n,this}connectedTo(n){return this._siblings=n.slice(),this}withOrientation(n){return this._sortStrategy.orientation=n,this}withScrollableParents(n){const e=_f(this.element);return this._scrollableElements=-1===n.indexOf(e)?[e,...n]:n.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(n){return this._isDragging?this._sortStrategy.getItemIndex(n):this._draggables.indexOf(n)}isReceiving(){return this._activeSiblings.size>0}_sortItem(n,e,i,s){if(this.sortingDisabled||!this._clientRect||!WV(this._clientRect,.05,e,i))return;const l=this._sortStrategy.sort(n,e,i,s);l&&this.sorted.next({previousIndex:l.previousIndex,currentIndex:l.currentIndex,container:this,item:n})}_startScrollingIfNecessary(n,e){if(this.autoScrollDisabled)return;let i,s=0,l=0;if(this._parentPositions.positions.forEach((h,m)=>{m===this._document||!h.clientRect||i||WV(h.clientRect,.05,n,e)&&([s,l]=function kse(t,n,e,i){const s=aH(n,i),l=lH(n,e);let h=0,m=0;if(s){const b=t.scrollTop;1===s?b>0&&(h=1):t.scrollHeight-b>t.clientHeight&&(h=2)}if(l){const b=t.scrollLeft;1===l?b>0&&(m=1):t.scrollWidth-b>t.clientWidth&&(m=2)}return[h,m]}(m,h.clientRect,n,e),(s||l)&&(i=m))}),!s&&!l){const{width:h,height:m}=this._viewportRuler.getViewportSize(),b={width:h,height:m,top:0,right:h,bottom:m,left:0};s=aH(b,e),l=lH(b,n),i=window}i&&(s!==this._verticalScrollDirection||l!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=s,this._horizontalScrollDirection=l,this._scrollNode=i,(s||l)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const n=_f(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=n.msScrollSnapType||n.scrollSnapType||"",n.scrollSnapType=n.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const n=_f(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(n).clientRect}_reset(){this._isDragging=!1;const n=_f(this.element).style;n.scrollSnapType=n.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(n,e){return null!=this._clientRect&&Jk(this._clientRect,n,e)}_getSiblingContainerFromPosition(n,e,i){return this._siblings.find(s=>s._canReceive(n,e,i))}_canReceive(n,e,i){if(!this._clientRect||!Jk(this._clientRect,e,i)||!this.enterPredicate(n,this))return!1;const s=this._getShadowRoot().elementFromPoint(e,i);if(!s)return!1;const l=_f(this.element);return s===l||l.contains(s)}_startReceiving(n,e){const i=this._activeSiblings;!i.has(n)&&e.every(s=>this.enterPredicate(s,this)||this._draggables.indexOf(s)>-1)&&(i.add(n),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:n,receiver:this,items:e}))}_stopReceiving(n){this._activeSiblings.delete(n),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:n,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(n=>{if(this.isDragging()){const e=this._parentPositions.handleScroll(n);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const n=HV(_f(this.element));this._cachedShadowRoot=n||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const n=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,n))}}function aH(t,n){const{top:e,bottom:i,height:s}=t,l=.05*s;return n>=e-l&&n<=e+l?1:n>=i-l&&n<=i+l?2:0}function lH(t,n){const{left:e,right:i,width:s}=t,l=.05*s;return n>=e-l&&n<=e+l?1:n>=i-l&&n<=i+l?2:0}const qB=tS({passive:!1,capture:!0});let Pse=(()=>{class t{constructor(e,i){this._ngZone=e,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=s=>s.isDragging(),this.pointerMove=new Li,this.pointerUp=new Li,this.scroll=new Li,this._preventDefaultWhileDragging=s=>{this._activeDragInstances.length>0&&s.preventDefault()},this._persistentTouchmoveListener=s=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&s.preventDefault(),this.pointerMove.next(s))},this._document=i}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,qB)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,qB)}startDragging(e,i){if(!(this._activeDragInstances.indexOf(e)>-1)&&(this._activeDragInstances.push(e),1===this._activeDragInstances.length)){const s=i.type.startsWith("touch");this._globalListeners.set(s?"touchend":"mouseup",{handler:l=>this.pointerUp.next(l),options:!0}).set("scroll",{handler:l=>this.scroll.next(l),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:qB}),s||this._globalListeners.set("mousemove",{handler:l=>this.pointerMove.next(l),options:qB}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((l,h)=>{this._document.addEventListener(h,l.handler,l.options)})})}}stopDragging(e){const i=this._activeDragInstances.indexOf(e);i>-1&&(this._activeDragInstances.splice(i,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(e){return this._activeDragInstances.indexOf(e)>-1}scrolled(e){const i=[this.scroll];return e&&e!==this._document&&i.push(new Hr(s=>this._ngZone.runOutsideAngular(()=>{const h=m=>{this._activeDragInstances.length&&s.next(m)};return e.addEventListener("scroll",h,!0),()=>{e.removeEventListener("scroll",h,!0)}}))),so(...i)}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((e,i)=>{this._document.removeEventListener(i,e.handler,e.options)}),this._globalListeners.clear()}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(Wi),Xt(wa))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Nse={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let nP=(()=>{class t{constructor(e,i,s,l){this._document=e,this._ngZone=i,this._viewportRuler=s,this._dragDropRegistry=l}createDrag(e,i=Nse){return new Fse(e,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(e){return new Ose(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wa),Xt(Wi),Xt(hse),Xt(Pse))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const iP=new pi("CDK_DRAG_PARENT"),rP=new pi("CdkDragHandle"),cH=new pi("CdkDragPlaceholder"),uH=new pi("CdkDragPreview"),hH=new pi("CDK_DRAG_CONFIG"),dH=new pi("CdkDropList");let fH=(()=>{class t{static#e=this._dragInstances=[];get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(e){this._disabled=Qy(e),this._dragRef.disabled=this._disabled}constructor(e,i,s,l,h,m,b,E,M,L,G){this.element=e,this.dropContainer=i,this._ngZone=l,this._viewContainerRef=h,this._dir=b,this._changeDetectorRef=M,this._selfHandle=L,this._parentDrag=G,this._destroyed=new Li,this.started=new vi,this.released=new vi,this.ended=new vi,this.entered=new vi,this.exited=new vi,this.dropped=new vi,this.moved=new Hr(V=>{const ne=this._dragRef.moved.pipe(Ht(re=>({source:this,pointerPosition:re.pointerPosition,event:re.event,delta:re.delta,distance:re.distance}))).subscribe(V);return()=>{ne.unsubscribe()}}),this._dragRef=E.createDrag(e,{dragStartThreshold:m&&null!=m.dragStartThreshold?m.dragStartThreshold:5,pointerDirectionChangeThreshold:m&&null!=m.pointerDirectionChangeThreshold?m.pointerDirectionChangeThreshold:5,zIndex:m?.zIndex}),this._dragRef.data=this,t._dragInstances.push(this),m&&this._assignDefaults(m),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Xo(1),Ps(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(e){const i=e.rootElementSelector,s=e.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),s&&!s.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const e=t._dragInstances.indexOf(this);e>-1&&t._dragInstances.splice(e,1),this._ngZone.runOutsideAngular(()=>{this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_updateRootElement(){const e=this.element.nativeElement;let i=e;this.rootElementSelector&&(i=void 0!==e.closest?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||e)}_getBoundaryElement(){const e=this.boundaryElement;return e?"string"==typeof e?this.element.nativeElement.closest(e):_f(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){const i=this._dir,s=this.dragStartDelay,l=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,h=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.dragStartDelay="object"==typeof s&&s?s:PV(s),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(l).withPreviewTemplate(h).withPreviewContainer(this.previewContainer||"global"),i&&e.withDirection(i.value)}}),e.beforeStarted.pipe(Xo(1)).subscribe(()=>{if(this._parentDrag)return void e.withParent(this._parentDrag._dragRef);let i=this.element.nativeElement.parentElement;for(;i;){if(i.classList.contains("cdk-drag")){e.withParent(t._dragInstances.find(s=>s.element.nativeElement===i)?._dragRef||null);break}i=i.parentElement}})}_handleEvents(e){e.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),e.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(e){const{lockAxis:i,dragStartDelay:s,constrainPosition:l,previewClass:h,boundaryElement:m,draggingDisabled:b,rootElementSelector:E,previewContainer:M}=e;this.disabled=b??!1,this.dragStartDelay=s||0,i&&(this.lockAxis=i),l&&(this.constrainPosition=l),h&&(this.previewClass=h),m&&(this.boundaryElement=m),E&&(this.rootElementSelector=E),M&&(this.previewContainer=M)}_setupHandlesListener(){this._handles.changes.pipe(T1(this._handles),sc(e=>{const i=e.filter(s=>s._parentDrag===this).map(s=>s.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),cl(e=>so(...e.map(i=>i._stateChanges.pipe(T1(i))))),Ps(this._destroyed)).subscribe(e=>{const i=this._dragRef,s=e.element.nativeElement;e.disabled?i.disableHandle(s):i.enableHandle(s)})}static#t=this.\u0275fac=function(i){return new(i||t)(Ve(ao),Ve(dH,12),Ve(wa),Ve(Wi),Ve(cA),Ve(hH,8),Ve(Wk,8),Ve(nP),Ve(gf),Ve(rP,10),Ve(iP,12))};static#n=this.\u0275dir=Xn({type:t,selectors:[["","cdkDrag",""]],contentQueries:function(i,s,l){if(1&i&&(Qa(l,uH,5),Qa(l,cH,5),Qa(l,rP,5)),2&i){let h;is(h=rs())&&(s._previewTemplate=h.first),is(h=rs())&&(s._placeholderTemplate=h.first),is(h=rs())&&(s._handles=h)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,s){2&i&&Dt("cdk-drag-disabled",s.disabled)("cdk-drag-dragging",s._dragRef.isDragging())},inputs:{data:["cdkDragData","data"],lockAxis:["cdkDragLockAxis","lockAxis"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],boundaryElement:["cdkDragBoundary","boundaryElement"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"],disabled:["cdkDragDisabled","disabled"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],previewContainer:["cdkDragPreviewContainer","previewContainer"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[Qo([{provide:iP,useExisting:t}]),Zo]})}return t})();const sP=new pi("CdkDropListGroup");let Qse=0,AH=(()=>{class t{static#e=this._dropLists=[];get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=Qy(e)}constructor(e,i,s,l,h,m,b){this.element=e,this._changeDetectorRef=s,this._scrollDispatcher=l,this._dir=h,this._group=m,this._destroyed=new Li,this.connectedTo=[],this.id="cdk-drop-list-"+Qse++,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new vi,this.entered=new vi,this.exited=new vi,this.sorted=new vi,this._unsortedItems=new Set,this._dropListRef=i.createDropList(e),this._dropListRef.data=this,b&&this._assignDefaults(b),this._dropListRef.enterPredicate=(E,M)=>this.enterPredicate(E.data,M.data),this._dropListRef.sortPredicate=(E,M,L)=>this.sortPredicate(E,M.data,L.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),t._dropLists.push(this),m&&m._items.add(this)}addItem(e){this._unsortedItems.add(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(e){this._unsortedItems.delete(e),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((e,i)=>e._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const e=t._dropLists.indexOf(this);e>-1&&t._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(T1(this._dir.value),Ps(this._destroyed)).subscribe(i=>e.withDirection(i)),e.beforeStarted.subscribe(()=>{const i=function jre(t){return Array.isArray(t)?t:[t]}(this.connectedTo).map(s=>"string"==typeof s?t._dropLists.find(h=>h.id===s):s);if(this._group&&this._group._items.forEach(s=>{-1===i.indexOf(s)&&i.push(s)}),!this._scrollableParentsResolved){const s=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(l=>l.getElementRef().nativeElement);this._dropListRef.withScrollableParents(s),this._scrollableParentsResolved=!0}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=Qy(this.sortingDisabled),e.autoScrollDisabled=Qy(this.autoScrollDisabled),e.autoScrollStep=PV(this.autoScrollStep,2),e.connectedTo(i.filter(s=>s&&s!==this).map(s=>s._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),so(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){const{lockAxis:i,draggingDisabled:s,sortingDisabled:l,listAutoScrollDisabled:h,listOrientation:m}=e;this.disabled=s??!1,this.sortingDisabled=l??!1,this.autoScrollDisabled=h??!1,this.orientation=m||"vertical",i&&(this.lockAxis=i)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(e=>e._dragRef))}static#t=this.\u0275fac=function(i){return new(i||t)(Ve(ao),Ve(nP),Ve(gf),Ve(QV),Ve(Wk,8),Ve(sP,12),Ve(hH,8))};static#n=this.\u0275dir=Xn({type:t,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(i,s){2&i&&(To("id",s.id),Dt("cdk-drop-list-disabled",s.disabled)("cdk-drop-list-dragging",s._dropListRef.isDragging())("cdk-drop-list-receiving",s._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],data:["cdkDropListData","data"],orientation:["cdkDropListOrientation","orientation"],id:"id",lockAxis:["cdkDropListLockAxis","lockAxis"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],sortPredicate:["cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],autoScrollStep:["cdkDropListAutoScrollStep","autoScrollStep"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],standalone:!0,features:[Qo([{provide:sP,useValue:void 0},{provide:dH,useExisting:t}])]})}return t})(),jse=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({providers:[nP],imports:[dse]})}return t})();var Dx=Zs(2574);let Gse=(()=>{class t{constructor(){this.mapbox=Dx,this.style="mapbox://styles/mapbox/streets-v11",this.lat=23.240233839876034,this.lng=-106.3982591990835,this.zoom=15,this.mapbox.accessToken="pk.eyJ1IjoiZW1tYW51ZWw4OSIsImEiOiJjbHUyMmQ2emYwZ2lzMmp0Z2d1ZmZlMHhuIn0.94uy3X09yt6AQrArEw4bvg"}buildMap(){this.map=new Dx.Map({container:"map",style:this.style,zoom:this.zoom,center:[this.lng,this.lat]}),this.map.addControl(new Dx.NavigationControl),this.map.addControl(new Dx.AttributionControl({customAttribution:"Map design by me"})),new Dx.Marker({color:"#FFFFFF",draggable:!0}).setLngLat([this.lng,this.lat]).addTo(this.map),this.map.on("click",s=>{console.log(`A dblclick event has occurred at ${s.lngLat}`),this.addMarker(this,s.lngLat.lng,s.lngLat.lat)})}addMarker(e,i,s){new Dx.Marker({color:"#FFFFFF",draggable:!0}).setLngLat([this.lng,this.lat]).addTo(e.map)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function $se(t,n){if(1&t&&(pe(0,"td"),oi(1,"ngb-highlight",10),ye()),2&t){const e=dn().$implicit,i=dn();$e(1),st("result",e.station_name)("term",i.filter.value)}}function qse(t,n){if(1&t){const e=xr();pe(0,"td")(1,"a",11),Tt("click",function(){ti(e);const s=dn().$implicit;return ni(dn().emitUpdate(s))}),oi(2,"i",12),ye(),pe(3,"a",13),Tt("click",function(){ti(e);const s=dn().$implicit;return ni(dn().emitRemove(s))}),oi(4,"i",14),ye(),pe(5,"a",11),Tt("click",function(){ti(e);const s=dn().$implicit;return ni(dn().emitEmployes(s))}),oi(6,"i",15),ye()()}}function Kse(t,n){if(1&t&&(pe(0,"tr"),En(1,$se,2,2,"td",9),En(2,qse,7,0,"td",9),ye()),2&t){const e=n.$implicit;$e(1),st("ngIf","station"==e.marker_type),$e(1),st("ngIf","station"==e.marker_type)}}let Wse=(()=>{class t{constructor(e){this.station_service=e,this.onUpdateClick=new vi,this.onRemoveClick=new vi,this.onEmployees=new vi,this.filter=new F1("",{nonNullable:!0}),this.stations_list_route=[]}emitUpdate(e){this.onUpdateClick.emit(e)}emitRemove(e){this.onRemoveClick.emit(e)}emitEmployes(e){this.onEmployees.emit(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(G1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-stations-list"]],inputs:{route_id:"route_id"},outputs:{onUpdateClick:"onUpdateClick",onRemoveClick:"onRemoveClick",onEmployees:"onEmployees"},decls:17,vars:2,consts:[[1,"container","complement-list",2,"margin-top","60px"],[1,"mb-3","row"],["for","table-filtering-search",1,"col-xs-3","col-sm-auto","col-form-label"],[1,"col-xs-3","col-sm-auto"],["id","table-filtering-search","type","text",1,"form-control",3,"formControl"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],["colspan","5",2,"text-align","center"],[4,"ngIf"],[3,"result","term"],[1,"btn","btn-secondary","text-white",3,"click"],[1,"far","fa-edit"],[1,"btn","btn-danger","text-white",3,"click"],[1,"fas","fa-trash-alt"],[1,"fas","fa-users"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"form")(2,"div",1)(3,"label",2),et(4,"Full text search:"),ye(),pe(5,"div",3),oi(6,"input",4),ye()()(),pe(7,"table",5)(8,"thead")(9,"tr")(10,"th",6),et(11,"Nombre Estaci\xf3n"),ye()()(),pe(12,"tbody"),En(13,Kse,3,2,"tr",7),pe(14,"tr")(15,"td",8),et(16,"Lista de Modelos"),ye()()()()()),2&i&&($e(6),st("formControl",s.filter),$e(7),st("ngForOf",s.station_service.stations_list_route))},dependencies:[Pl,Xh,GE,Fd,oc,Jc,Md,xh,FE],styles:[".complement-list[_ngcontent-%COMP%]{max-height:800px;overflow-x:hidden;overflow-y:scroll}"]})}return t})();const Zse=["route_search"],Xse=["routeSelectList"];function Yse(t,n){if(1&t){const e=xr();pe(0,"li",29),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().selectRoutes(l))}),pe(1,"span"),et(2),ye()()}if(2&t){const e=n.$implicit;$e(2),Er("",e.route_name," ")}}let Jse=(()=>{class t{constructor(e,i){this.station_service=e,this.route_service=i,this.check=!0,this.route_select_list=[],this.active=1}ngOnInit(){this.route_service._getRoutes().subscribe(e=>{this.route_service.route_selected=[],this.route_service.route_list=e,this.route_service.route_list.forEach(l=>{this.route_service.route_selected.push({route_id:l.route_id,route_name:l.route_name,selected:!1})});let i,s=this.station_service.selected_station;i=e.filter(l=>l.route_id==s.route_id)[0],this.selectRoutes(i)}),this.station_service.check_in.hour=Number.parseInt(this.station_service.selected_station.check_in.split(":")[0]),this.station_service.check_in.minute=Number.parseInt(this.station_service.selected_station.check_in.split(":")[1])}ngAfterViewInit(){this.setInputRoutesEvent()}setInputRoutesEvent(){Ba(this.route_search.nativeElement,"keydown").pipe(Ht(e=>e),Uy(500),Tl()).subscribe(e=>{let i=e.target.value;i.trim().length>0?(this.setListStyle(this.routeSelectList),"Tab"==e.key||"Enter"==e.key?this.route_service.route_list.length>0?this.selectRoutes(this.route_service.route_list[0]):this.inputRoute(i):(1==e.key.length||"Backspace"==e.key)&&(this.inputRoute(i),this.removeStyle(this.routeSelectList,this.route_search))):this.removeStyle(this.routeSelectList,this.route_search)})}setListStyle(e){e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer;width: 305px; max-height: 150px; margin-bottom: 10px;  overflow:scroll;  -webkit-overflow-scrolling: touch;",e.nativeElement.hidden=!1}removeStyle(e,i){""==i.nativeElement.value&&(e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer; ",e.nativeElement.hidden=!0)}selectRoutes(e){this.station_service.selected_station.routes=[],this.station_service.selected_station.routes.push(e),this.selected_route=e.route_name,"marker"==this.station_service.selected_station.marker_type&&(this.station_service.selected_station.station_name="MRRID-"+e.route_id),this.routeSelectList&&(this.routeSelectList.nativeElement.hidden=!0)}inputRoute(e){this.route_select_list=this.route_service.route_list.filter(i=>i.route_name.toUpperCase().includes(e.toUpperCase()))}setRouteSelectValue(e,i){this.route_service.route_selected.forEach(s=>{s.route_id==e&&(s.selected=!i)})}getIfSelected(e){return!0}isStation(){return"station"==this.station_service.selected_station.marker_type}isUpdate(){return 0!=this.station_service.selected_station.station_id||null!=this.station_service.selected_station.station_id}onChangeStationType(e){this.station_service.selected_station.marker_type=e.srcElement.defaultValue,"marker"==e.srcElement.defaultValue&&(this.station_service.selected_station.station_name="MR")}isCompanyCourse(){return 1==this.station_service.selected_station.course}onChangeStationCourse(e){this.station_service.selected_station.course=e.srcElement.defaultValue}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(G1),Ve(d0))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-station-form"]],viewQuery:function(i,s){if(1&i&&(wl(Zse,5),wl(Xse,5)),2&i){let l;is(l=rs())&&(s.route_search=l.first),is(l=rs())&&(s.routeSelectList=l.first)}},decls:48,vars:12,consts:[["stationForm","ngForm"],["type","hidden","name","station_id",3,"ngModel","ngModelChange"],["station_id","ngModel"],[1,"row"],[1,"col-3"],["for","station_name"],[1,"col-9"],[1,"form-group"],["id","station_name","type","text","name","station_name","placeholder","Nombre de Estaci\xf3n","autocomplete","off",1,"form-control","my-controll",3,"ngModel","disabled","ngModelChange"],["station_name","ngModel"],["for","route_search"],[1,"col-9",2,"margin-bottom","50px","margin-top","10px"],["id","route_search","type","text","name","route_search","autocomplete","off",1,"form-control",3,"ngModel","disabled","ngModelChange"],["route_search",""],[1,"list-group",2,"position","absolute","z-index","999","cursor","pointer"],["routeSelectList",""],["class","list-group-item",3,"click",4,"ngFor","ngForOf"],["for","check_in"],[1,"col-5"],["id","check_in","name","check_in",3,"ngModel","disabled","ngModelChange"],["check_in","ngModel"],[1,"col-6"],[1,"form-check"],["type","radio","name","typeStationRadios","id","station","value","station",1,"form-check-input",3,"checked","change"],["for","exampleRadios1",1,"form-check-label"],["type","radio","name","typeStationRadios","id","marker","value","marker",1,"form-check-input",3,"checked","change"],["for","exampleRadios2",1,"form-check-label"],["type","radio","name","coursetationRadios","id","company","value","1",1,"form-check-input",3,"checked","change"],["type","radio","name","courseStationRadios","id","home","value","2",1,"form-check-input",3,"checked","change"],[1,"list-group-item",3,"click"]],template:function(i,s){1&i&&(pe(0,"form",null,0)(2,"input",1,2),Tt("ngModelChange",function(h){return s.station_service.selected_station.station_id=h}),ye(),pe(4,"div",3)(5,"div",4)(6,"label",5),et(7,"Estaci\xf3n"),ye()(),pe(8,"div",6)(9,"div",7)(10,"input",8,9),Tt("ngModelChange",function(h){return s.station_service.selected_station.station_name=h}),ye()()()(),pe(12,"div",3)(13,"div",4)(14,"label",10),et(15,"Ruta(s)"),ye()(),pe(16,"div",11)(17,"input",12,13),Tt("ngModelChange",function(h){return s.selected_route=h}),ye(),pe(19,"ul",14,15),En(21,Yse,3,1,"li",16),ye()()(),oi(22,"div",3),pe(23,"div",4)(24,"label",17),et(25,"Check In"),ye()(),pe(26,"div",18)(27,"ngb-timepicker",19,20),Tt("ngModelChange",function(h){return s.station_service.check_in=h}),ye()(),pe(29,"div",3)(30,"div",21)(31,"div",22)(32,"input",23),Tt("change",function(h){return s.onChangeStationType(h)}),ye(),pe(33,"label",24),et(34," Estacion "),ye()(),pe(35,"div",22)(36,"input",25),Tt("change",function(h){return s.onChangeStationType(h)}),ye(),pe(37,"label",26),et(38," Marcador "),ye()()(),pe(39,"div",21)(40,"div",22)(41,"input",27),Tt("change",function(h){return s.onChangeStationCourse(h)}),ye(),pe(42,"label",24),et(43," Rumbo Empresa "),ye()(),pe(44,"div",22)(45,"input",28),Tt("change",function(h){return s.onChangeStationCourse(h)}),ye(),pe(46,"label",26),et(47," Rumbo Casa "),ye()()()()()),2&i&&($e(2),st("ngModel",s.station_service.selected_station.station_id),$e(8),st("ngModel",s.station_service.selected_station.station_name)("disabled",!s.isStation()),$e(7),st("ngModel",s.selected_route)("disabled",s.isUpdate()),$e(4),st("ngForOf",s.route_select_list),$e(6),st("ngModel",s.station_service.check_in)("disabled",!s.isStation()),$e(5),st("checked",s.isStation()),$e(4),st("checked",!s.isStation()),$e(5),st("checked",s.isCompanyCourse()),$e(4),st("checked",!s.isCompanyCourse()))},dependencies:[Pl,Une,Fd,oc,Jc,Md,Qu,xh]})}return t})();const eoe=["route_search"],toe=["routeSelectList"];function noe(t,n){if(1&t){const e=xr();pe(0,"li",15),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().selectRoute(l))}),pe(1,"span"),et(2),ye()()}if(2&t){const e=n.$implicit;$e(2),Er("",e.route_name," ")}}function ioe(t,n){if(1&t){const e=xr();pe(0,"map-marker",20),Tt("mapDragend",function(s){const h=ti(e).index;return ni(dn(2).updateStation(s,h))}),ye()}if(2&t){const e=n.$implicit,i=n.index,s=dn(2);st("position",e)("options",s.getStationOption(i))}}function roe(t,n){if(1&t){const e=xr();pe(0,"google-map",16),Tt("mapClick",function(s){return ti(e),ni(dn().open(s))})("mapMousemove",function(s){return ti(e),ni(dn().move(s))}),oi(1,"span"),En(2,ioe,1,2,"map-marker",17),oi(3,"map-polyline",18)(4,"map-directions-renderer",19),ye()}if(2&t){const e=dn();st("center",e.center)("zoom",e.zoom),$e(2),st("ngForOf",e.station_service.markerStationPositionsByRute),$e(1),st("path",e.vertices),$e(1),st("directions",e.directionsResults)}}function soe(t,n){if(1&t&&(pe(0,"div",21),et(1),ye()),2&t){const e=n.$implicit;$e(1),wr(e.station_name)}}let ooe=(()=>{class t{constructor(e,i,s,l){this.route_service=e,this.station_service=i,this.mapDirectionsService=s,this.office_service=l,this.tour_mode=!1,this.tour_plan_mode=!1,this.route_list=[],this.stations_by_route_list=[],this.pathDirectionsResults=[],this.center={lat:23.24459112928423,lng:-106.39800170731318},this.zoom=13,this.vertices=[]}moveMap(e){null!=e.latLng&&(this.center=e.latLng.toJSON())}move(e){null!=e.latLng&&(this.display=e.latLng.toJSON())}ngOnInit(){this.route_service.getRoutes(),this.selected_route=""}initValues(){this.selected_route="",this.station_service.stations_list=[],this.station_service.markerStationPositionsByRute=[]}drop(e){tP(this.station_service.stations_sequence_list,e.previousIndex,e.currentIndex),this.station_service.updateStationSequence(this.route_service.selected_route.route_id)}ngAfterViewInit(){this.setInputRoutesEvent()}directionToOfice(){var e=this.station_service.markerStationPositions[this.station_service.markerStationPositions.length-1];const i={destination:{lat:this.office_service.office_lat_lng[0],lng:this.office_service.office_lat_lng[1]},origin:{lat:e.lat,lng:e.lng},travelMode:google.maps.TravelMode.DRIVING};this.directionsResults$=this.mapDirectionsService.route(i).pipe(Ht(s=>s.result)),this.directionsResults$.subscribe(s=>{this.directionsResults=s})}setInputRoutesEvent(){Ba(this.route_search.nativeElement,"keydown").pipe(Ht(e=>e),Uy(500),Tl()).subscribe(e=>{let i=e.target.value;i.trim().length>0?(this.setListStyle(this.routeSelectList),"Tab"==e.key||"Enter"==e.key?this.route_service.route_list.length>0?this.selectRoute(this.route_service.route_list[0]):this.inputRoute(i):(1==e.key.length||"Backspace"==e.key)&&(this.inputRoute(i),this.removeStyle(this.routeSelectList,this.route_search))):this.removeStyle(this.routeSelectList,this.route_search)})}setListStyle(e){e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer;width: 305px; max-height: 150px; margin-bottom: 10px;  overflow:scroll;  -webkit-overflow-scrolling: touch;",e.nativeElement.hidden=!1}removeStyle(e,i){""==i.nativeElement.value&&(e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer; ",e.nativeElement.hidden=!0)}getStationOption(e){return this.station_service.stationMarkerOptionsList[e]}updateStation(e,i){console.log(e)}inputRoute(e){this.route_list=this.route_service.route_list.filter(i=>i.route_name.toUpperCase().includes(e.toUpperCase()))}selectRoute(e){var i=this;return(0,Um.Z)(function*(){i.route_service.selected_route=e,i.selected_route=e.route_name,i.station_service.getStationsSequenceByRoute(e.route_id),i.station_service.getStationsByRoute(e.route_id),i.showDistanceToOfice(),i.routeSelectList.nativeElement.hidden=!0,console.log(e)})()}showDistanceToOfice(){this.station_service.onStationsReady.subscribe(e=>{1==e&&(this.vertices=this.station_service.markerStationPositionsByRute,this.office_service.lastStationToOffice().then(i=>{this.directionsResults=i,this.calculateRouteDirection()}))})}calculateRouteDirection(){let e={lat:0,lng:0},i={lat:0,lng:0},s=0;this.station_service.markerStationPositionsByRute.forEach((l,h)=>{if(0==e.lat)e=l;else{0==i.lat&&(i=l),this.office_service.twoStationsPath(e,i).then(b=>{this.pathDirectionsResults.push(b),this.calculateTotalDistanceRoute(b)});let m=this.haversine_distance(e,i);s+=m,e=i,i={lat:0,lng:0}}}),console.log(s)}haversine_distance(e,i){var l=e.lat*(Math.PI/180),h=i.lat*(Math.PI/180),m=h-l,b=(i.lng-e.lng)*(Math.PI/180);return 12742.14*Math.asin(Math.sqrt(Math.sin(m/2)*Math.sin(m/2)+Math.cos(l)*Math.cos(h)*Math.sin(b/2)*Math.sin(b/2)))}calculateTotalDistanceToOfice(){let e;e=this.directionsResults.routes[0].legs[0].distance?.value/1e3,this.station_service.route_long=this.station_service.route_long+e}calculateTotalDistanceRoute(e){let i;i=e.routes[0].legs[0].distance?.value/1e3,this.station_service.route_long=this.station_service.route_long+i}open(e){}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(d0),Ve(G1),Ve(xV),Ve(ZE))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-station-sequence"]],viewQuery:function(i,s){if(1&i&&(wl(eoe,5),wl(toe,5)),2&i){let l;is(l=rs())&&(s.route_search=l.first),is(l=rs())&&(s.routeSelectList=l.first)}},inputs:{tour_mode:"tour_mode",tour_plan_mode:"tour_plan_mode"},decls:22,vars:9,consts:[[1,"row",2,"margin-left","50px"],[1,"col-4"],["for","route_search"],["id","route_search","type","text","name","route_search","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["route_search",""],[1,"list-group",2,"position","absolute","z-index","999","cursor","pointer"],["routeSelectList",""],["class","list-group-item",3,"click",4,"ngFor","ngForOf"],[1,"col-2"],[1,"row"],[1,"col-md-8",2,"margin-top","30px"],["id","map","height","700px","width","1100px",3,"center","zoom","mapClick","mapMousemove",4,"ngIf"],["cdkScrollable","",1,"col-md-3"],["cdkDropList","",1,"example-list",3,"cdkDropListAutoScrollDisabled","cdkDropListAutoScrollStep","cdkDropListDropped"],["class","example-box","cdkDrag","",4,"ngFor","ngForOf"],[1,"list-group-item",3,"click"],["id","map","height","700px","width","1100px",3,"center","zoom","mapClick","mapMousemove"],[3,"position","options","mapDragend",4,"ngFor","ngForOf"],[3,"path"],[3,"directions"],[3,"position","options","mapDragend"],["cdkDrag","",1,"example-box"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"div",1)(2,"label",2),et(3,"Ruta"),ye(),pe(4,"input",3,4),Tt("ngModelChange",function(h){return s.selected_route=h}),ye(),pe(6,"ul",5,6),En(8,noe,3,1,"li",7),ye()(),pe(9,"div",8)(10,"label"),et(11),ye()()(),pe(12,"div",9)(13,"div",10),En(14,roe,5,5,"google-map",11),pe(15,"div"),et(16),ye(),pe(17,"div"),et(18),ye()(),pe(19,"div",12)(20,"div",13),Tt("cdkDropListDropped",function(h){return s.drop(h)}),En(21,soe,2,1,"div",14),ye()()()),2&i&&($e(4),st("ngModel",s.selected_route),$e(4),st("ngForOf",s.route_list),$e(3),Er("Largo de la ruta",s.station_service.route_long,""),$e(3),st("ngIf",""!=s.selected_route),$e(2),Er("Latitude: ",null==s.display?null:s.display.lat,""),$e(2),Er("Longitude: ",null==s.display?null:s.display.lng,""),$e(2),st("cdkDropListAutoScrollDisabled",!1)("cdkDropListAutoScrollStep",35),$e(1),st("ngForOf",s.station_service.stations_sequence_list))},dependencies:[Pl,Xh,oc,Jc,Qu,Yh,bV,NB,wV,cse,AH,fH],styles:[".example-list[_ngcontent-%COMP%]{width:500px;max-width:100%;border:solid 1px #ccc;min-height:60px;display:block;background:white;border-radius:4px;overflow:hidden;max-height:700px;overflow-x:hidden;overflow-y:scroll;width:100%;border:1px solid}.example-box[_ngcontent-%COMP%]{padding:20px 10px;border-bottom:solid 1px #ccc;color:#000000de;display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;cursor:move;background:white;font-size:14px}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .example-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]})}return t})();function aoe(t,n){if(1&t){const e=xr();pe(0,"button",15),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().select(l))}),et(1),ye()}if(2&t){const e=n.$implicit;$e(1),wr(e.licence_plate)}}function loe(t,n){if(1&t){const e=xr();pe(0,"tr")(1,"td"),et(2),ye(),pe(3,"td"),et(4),ye(),pe(5,"td")(6,"a",16),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().removeEmployee(l))}),oi(7,"i",17),ye()()()}if(2&t){const e=n.$implicit;$e(2),wr(e.employee_number),$e(2),wr(e.name)}}let coe=(()=>{class t{constructor(e,i,s,l){this.vehicle_service=e,this.station_service=i,this.employee_service=s,this.model_service=l,this.selected_vehicle="Seleccioone el Veh\xedculo",this.employee_vehicle_list=[]}ngOnInit(){this.vehicle_service.getVehiclesByRoute(this.route_id)}select(e){this.selected_vehicle=e.licence_plate,this.selected_vehicle_id=e.vehicle_id,this.model_service.getModelById(e.model_id).subscribe(i=>{this.selected_vehicle_model=i[0]}),this.vehicle_service.getVehicleEmployee(this.selected_vehicle_id).subscribe(i=>{this.employee_vehicle_list=i})}addEmplpyee(){this.employee_vehicle_list.length==this.selected_vehicle_model.pasenger_capability&&alert("Se ha alcanzado el maximo de pasajeros"),this.employee_service.getEmployeeVehicleByNumber(this.employee_number).subscribe(e=>{0!=e.length?this.vehicle_service.setEmployeeInVehicle({employee_id:e[0].employee_id,vehicle_id:this.selected_vehicle_id,station_id:this.station_service.selected_station.station_id}).subscribe(l=>{let h=l[0];this.employee_vehicle_list.push({employee_number:h.employee_number,name:h.name,employee_id:h.employee_id,vehicle_id:h.vehicle_id,station_id:h.station_id})}):alert("No se encontro el empleado")})}removeEmployee(e){this.vehicle_service.removeVehicleEmployeeTour({employee_id:e.employee_id,vehicle_id:e.vehicle_id,station_id:e.station_id}).subscribe(s=>{this.employee_vehicle_list=s})}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Sx),Ve(G1),Ve(Hy),Ve(W1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-vehicle-employees"]],inputs:{route_id:"route_id"},decls:28,vars:5,consts:[[1,"row"],[1,"col-4"],["ngbDropdown","",1,"d-inline-block"],["type","button","id","dropdownBasic1","ngbDropdownToggle","",1,"btn","btn-outline-primary",3,"value"],["ngbDropdownMenu","","aria-labelledby","dropdownBasic1"],["ngbDropdownItem","",3,"click",4,"ngFor","ngForOf"],[1,"form-group"],["id","employee_num","type","text","name","employee_num","placeholder","Numero de Empleado","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["employee_num","ngModel"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus-circle"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],["colspan","5",2,"text-align","center"],["ngbDropdownItem","",3,"click"],[1,"btn","btn-danger","text-white",3,"click"],[1,"fas","fa-trash-alt"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),et(4),ye(),pe(5,"div",4),En(6,aoe,2,1,"button",5),ye()()(),pe(7,"div",1)(8,"div",6)(9,"input",7,8),Tt("ngModelChange",function(h){return s.employee_number=h}),ye()()(),pe(11,"div",1)(12,"button",9),Tt("click",function(){return s.addEmplpyee()}),oi(13,"i",10),et(14,"Agregar. "),ye()()(),pe(15,"div",0)(16,"table",11)(17,"thead")(18,"tr")(19,"th",12),et(20,"Numero"),ye(),pe(21,"th",12),et(22,"Empleado"),ye()()(),pe(23,"tbody"),En(24,loe,8,2,"tr",13),pe(25,"tr")(26,"td",14),et(27,"Recorrido en proceso"),ye()()()()()),2&i&&($e(3),st("value",s.vehicle),$e(1),Er(" ",s.selected_vehicle," "),$e(2),st("ngForOf",s.vehicle_service.vehicles_list_route),$e(3),st("ngModel",s.employee_number),$e(15),st("ngForOf",s.employee_vehicle_list))},dependencies:[Pl,QE,S8,Bk,Dk,oc,Jc,Qu]})}return t})();const uoe=["route_search"],hoe=["routeSelectList"];function doe(t,n){if(1&t){const e=xr();pe(0,"div",9)(1,"h4",10),et(2,"Profile update"),ye(),pe(3,"button",11),Tt("click",function(){return ni(ti(e).$implicit.dismiss("Cross click"))}),ye()(),pe(4,"div",12)(5,"div",13),oi(6,"app-vehicle-employees",14),ye()(),pe(7,"div",15)(8,"button",16),Tt("click",function(){return ni(ti(e).$implicit.close("Save click"))}),et(9,"Save"),ye()()}if(2&t){const e=dn();$e(6),st("route_id",e.route_service.selected_route.route_id)}}function foe(t,n){if(1&t){const e=xr();pe(0,"div",9)(1,"h4",10),et(2,"Profile update"),ye(),pe(3,"button",11),Tt("click",function(){return ni(ti(e).$implicit.dismiss("Cross click"))}),ye()(),pe(4,"div",12)(5,"div",13),oi(6,"app-station-form"),ye()(),pe(7,"div",15)(8,"button",16),Tt("click",function(){return ni(ti(e).$implicit.close("Save click"))}),et(9,"Save"),ye()()}}function Aoe(t,n){if(1&t){const e=xr();pe(0,"li",34),Tt("click",function(){const l=ti(e).$implicit;return ni(dn(2).selectRoute(l))}),pe(1,"span"),et(2),ye()()}if(2&t){const e=n.$implicit;$e(2),Er("",e.route_name," ")}}function poe(t,n){if(1&t&&(pe(0,"map-marker",35),Tt("clickable",function(){return!0}),ye()),2&t){const e=n.$implicit,i=n.index,s=dn(2);st("position",e)("options",s.getOption(i))}}function goe(t,n){if(1&t){const e=xr();pe(0,"map-marker",36),Tt("mapClick",function(s){const h=ti(e).index;return ni(dn(2).updateStation(s,h))}),ye()}if(2&t){const e=n.$implicit,i=n.index,s=dn(2);st("position",e)("options",s.getStationOption(i))}}function moe(t,n){if(1&t&&oi(0,"map-marker",37),2&t){const e=n.$implicit,i=dn(2);st("position",e)("options",i.office_service.officeMarkerOptions[0])}}function _oe(t,n){1&t&&oi(0,"map-marker",38),2&t&&st("position",n.$implicit)}function yoe(t,n){if(1&t){const e=xr();pe(0,"div",17)(1,"div",18)(2,"label",19),et(3,"Ruta"),ye(),pe(4,"input",20,21),Tt("ngModelChange",function(s){return ti(e),ni(dn().selected_route=s)}),ye(),pe(6,"ul",22,23),En(8,Aoe,3,1,"li",24),ye()(),pe(9,"div",25)(10,"label"),et(11),ye()()(),pe(12,"div",17)(13,"div",26)(14,"google-map",27),Tt("mapClick",function(s){ti(e);const l=dn(),h=ws(3);return ni(l.open(h,s))})("mapMousemove",function(s){return ti(e),ni(dn().move(s))}),oi(15,"span"),En(16,poe,1,2,"map-marker",28),En(17,goe,1,2,"map-marker",29),En(18,moe,1,2,"map-marker",30),En(19,_oe,1,1,"map-marker",31),ye(),pe(20,"div"),et(21),ye(),pe(22,"div"),et(23),ye()(),pe(24,"div",18)(25,"div",32)(26,"app-stations-list",33),Tt("onUpdateClick",function(s){ti(e);const l=dn(),h=ws(3);return ni(l.open(h,s))})("onRemoveClick",function(s){return ti(e),ni(dn().onDelete(s))})("onEmployees",function(s){ti(e);const l=dn(),h=ws(1);return ni(l.openEmployee(h,s))}),ye()()()()}if(2&t){const e=dn();$e(4),st("ngModel",e.selected_route),$e(4),st("ngForOf",e.route_select_list),$e(3),Er("Largo de la ruta",e.station_service.route_long,""),$e(3),st("center",e.center)("zoom",e.zoom),$e(2),st("ngForOf",e.markerPositions),$e(1),st("ngForOf",e.station_service.markerStationPositionsByRute),$e(1),st("ngForOf",e.office_service.markerOfficePositions),$e(1),st("ngForOf",e.userMarker),$e(2),Er("Latitude: ",null==e.display?null:e.display.lat,""),$e(2),Er("Longitude: ",null==e.display?null:e.display.lng,""),$e(3),st("route_id",e.route_service.selected_route.route_id)}}function voe(t,n){1&t&&(pe(0,"div",39),oi(1,"app-station-sequence",40),ye()),2&t&&($e(1),st("tour_mode",!1))}let boe=(()=>{class t{constructor(e,i,s,l,h){this.map=e,this.employeService=i,this.station_service=s,this.route_service=l,this.office_service=h,this.modalService=In(hg),this.closeResult="",this.active=1,this.route_select_list=[],this.marker={position:{lat:this.usr_lat,lng:this.usr_lng}},this.markerPositions=[],this.userMarker=[],this.employeemarkerOptionsList=[],this.route_list=[],this.vertices=[{lat:23.240236893957295,lng:-106.42255317943847},{lat:23.245666382372292,lng:-106.42126859910378},{lat:23.249705568555097,lng:-106.420326573525},{lat:23.249207234017806,lng:-106.42383775977319}],this.movies=["Episode I - The Phantom Menace","Episode II - Attack of the Clones","Episode III - Revenge of the Sith","Episode IV - A New Hope","Episode V - The Empire Strikes Back","Episode VI - Return of the Jedi","Episode VII - The Force Awakens","Episode VIII - The Last Jedi","Episode IX \u2013 The Rise of Skywalker"],this.center={lat:23.24459112928423,lng:-106.39800170731318},this.zoom=13}drop(e){tP(this.movies,e.previousIndex,e.currentIndex)}ngOnInit(){this.initValues(),this.getEmployeeLatLng(),this.station_service.getStations(),this.office_service.getOffice(),this.route_service.getRoutes(),navigator.geolocation&&this.getUserLocation(),this.setInputRoutesEvent()}initValues(){this.station_service.markerStationPositionsByRute=[]}getUserLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{this.usr_lat=e.coords.latitude,this.usr_lng=e.coords.longitude,this.userMarker.push({lat:this.usr_lat,lng:this.usr_lng})}):console.log("User not allow")}ngAfterViewInit(){this.setInputRoutesEvent()}setInputRoutesEvent(){Ba(this.route_search.nativeElement,"keydown").pipe(Ht(e=>e),Uy(500),Tl()).subscribe(e=>{let i=e.target.value;i.trim().length>0?(this.setListStyle(this.routeSelectList),"Tab"==e.key||"Enter"==e.key?this.route_service.route_list.length>0?this.selectRoute(this.route_service.route_list[0]):this.inputRoute(i):(1==e.key.length||"Backspace"==e.key)&&(this.inputRoute(i),this.removeStyle(this.routeSelectList,this.route_search))):this.removeStyle(this.routeSelectList,this.route_search)})}setListStyle(e){e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer;width: 305px; max-height: 150px; margin-bottom: 10px;  overflow:scroll;  -webkit-overflow-scrolling: touch;",e.nativeElement.hidden=!1}selectRoute(e){this.route_service.selected_route=e,this.selected_route=e.route_name,this.station_service.getStationsSequenceByRoute(e.route_id),this.station_service.getStationsByRoute(e.route_id),this.route_select_list=[],this.routeSelectList.nativeElement.hidden=!0,console.log(e)}removeStyle(e,i){""==i.nativeElement.value&&(e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer; ",e.nativeElement.hidden=!0)}moveMap(e){null!=e.latLng&&(this.center=e.latLng.toJSON())}move(e){null!=e.latLng&&(this.display=e.latLng.toJSON())}addMarker(e,i){var s=this;return(0,Um.Z)(function*(){null!=e.latLng&&s.station_service.markerStationPositions.push(e.latLng.toJSON()),s.station_service.saveStation(i),s.refreshStationForm()})()}routeAsociation(e){var i=this;return(0,Um.Z)(function*(){e.routes=[],yield i.route_service.route_selected.filter(h=>1==h.selected).forEach(h=>{e.routes.push(i.route_service.route_list.filter(m=>m.route_id==h.route_id)[0])})})()}refreshStationForm(){this.station_service.selected_station=new WE}getOption(e){return this.employeemarkerOptionsList[e]}getStationOption(e){return this.station_service.stationMarkerOptionsList[e]}getEmployeeLatLng(){this.employeService.getEmployeesLatLng().subscribe(e=>{e.forEach(i=>{let s=this.getLatLngFromEmployeeRow(i);this.markerPositions.push({lat:s[0],lng:s[1]}),this.employeemarkerOptionsList.push({title:i.name+" "+i.last_name,icon:"http://maps.gstatic.com/mapfiles/ms2/micons/homegardenbusiness.png",draggable:!1})})})}getLatLngFromEmployeeRow(e){let i=e.location.split(",",2);return i[0]=parseFloat(i[0]),i[1]=parseFloat(i[1]),i}openEmployee(e,i){i.station_name&&(this.station_service.selected_station=i),this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`},s=>{this.refreshStationForm(),this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}open(e,i){this.station_service.selected_station=i.station_name?i:new WE,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`,i.latLng&&(this.station_service.selected_station.location=i.latLng.toString().replace("(","").replace(")","")),this.addMarker(i,this.station_service.selected_station)},s=>{this.refreshStationForm(),this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}updateStation(e,i){console.log(e)}onDelete(e){confirm("Are you sure you want to delete it?")&&this.station_service.deleteStation(e.station_id)}selectRoutes(e){this.station_service.getStationsByRoute(e.route_id),console.log(e)}inputRoute(e){this.route_select_list=this.route_service.route_list.filter(i=>i.route_name.toUpperCase().includes(e.toUpperCase()))}getDismissReason(e){switch(e){case Yl.ESC:return"by pressing ESC";case Yl.BACKDROP_CLICK:return"by clicking on a backdrop";default:return`with: ${e}`}}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Gse),Ve(Hy),Ve(G1),Ve(d0),Ve(ZE))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-stations"]],viewQuery:function(i,s){if(1&i&&(wl(uoe,5),wl(hoe,5)),2&i){let l;is(l=rs())&&(s.route_search=l.first),is(l=rs())&&(s.routeSelectList=l.first)}},decls:17,vars:5,consts:[["content_employees",""],["content",""],["ngbNav","",1,"nav-tabs",2,"margin-left","50px",3,"activeId","activeIdChange","click"],["nav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],["ngbNavContent","","navChange","setInputRoutesEvent()"],[1,"mt-2",3,"ngbNavOutlet"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"container",2,"margin-top","60px"],[3,"route_id"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[1,"row",2,"margin-left","50px"],[1,"col-4"],["for","route_search"],["id","route_search","type","text","name","route_search","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["route_search",""],[1,"list-group",2,"position","absolute","z-index","999","cursor","pointer"],["routeSelectList",""],["class","list-group-item",3,"click",4,"ngFor","ngForOf"],[1,"col-2"],[1,"col-8",2,"margin-top","30px"],["id","map","height","700px","width","1100px",3,"center","zoom","mapClick","mapMousemove"],[3,"position","options","clickable",4,"ngFor","ngForOf"],[3,"position","options","mapClick",4,"ngFor","ngForOf"],[3,"position","options",4,"ngFor","ngForOf"],[3,"position",4,"ngFor","ngForOf"],[1,"example-list",2,"margin-top","30px"],[3,"route_id","onUpdateClick","onRemoveClick","onEmployees"],[1,"list-group-item",3,"click"],[3,"position","options","clickable"],[3,"position","options","mapClick"],[3,"position","options"],[3,"position"],[2,"margin-left","50px"],[3,"tour_mode"]],template:function(i,s){if(1&i&&(En(0,doe,10,1,"ng-template",null,0,Zl),En(2,foe,10,0,"ng-template",null,1,Zl),pe(4,"ul",2,3),Tt("activeIdChange",function(h){return s.active=h})("click",function(){return s.ngOnInit()}),pe(6,"li",4)(7,"button",5),et(8,"Estaciones"),ye(),En(9,yoe,27,12,"ng-template",6),ye(),pe(10,"li",4)(11,"button",5),et(12,"Estaciones-Rutas"),ye(),En(13,voe,2,1,"ng-template",7),ye()(),oi(14,"div",8),pe(15,"pre"),et(16),ye()),2&i){const l=ws(5);$e(4),st("activeId",s.active),$e(2),st("ngbNavItem",1),$e(4),st("ngbNavItem",2),$e(4),st("ngbNavOutlet",l),$e(2),Er("Active: ",s.active,"")}},dependencies:[Pl,Mk,Q1,xx,M8,F8,jE,R8,oc,Jc,Qu,Yh,NB,Wse,Jse,ooe,coe],styles:[".map-container[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute}#map[_ngcontent-%COMP%]{height:100%}.example-list[_ngcontent-%COMP%]{width:500px;max-width:100%;border:solid 1px #ccc;min-height:60px;display:block;background:white;border-radius:4px;overflow:hidden}.example-box[_ngcontent-%COMP%]{padding:20px 10px;border-bottom:solid 1px #ccc;color:#000000de;display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;cursor:move;background:white;font-size:14px}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .example-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]})}return t})(),KB=(()=>{class t{constructor(e,i){this.user_service=e,this.router=i}canActivate(){return!!this.user_service.isAuthenticated||(this.router.navigate(["/login"]),!1)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(q1),Xt(Dd))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),oS=(()=>{class t{constructor(e,i){this.user_service=e,this.router=i}canActivate(){return!(!this.user_service.isAuthenticated||1!=this.user_service.userType)||(this.router.navigate(["/login"]),!1)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(q1),Xt(Dd))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class pH{}class gH{}let woe=(()=>{class t{constructor(e){this.httpClient=e,this.tour_list=[],this.employee_tour_list=[],this.tour_detail=[]}startTour(e){return this.httpClient.post(xl_apiHost+"/tours",e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.current_tour=i[0],this.tour_list.push(i[0])})}endTour(e){return this.httpClient.put(xl_apiHost+"/tours",e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.current_tour=i[0],this.tour_list.forEach(s=>{s.end_date_time=i[0].end_date_time,s.tour_lenght=i[0].tour_lenght})})}addEmployee(e,i,s){this.httpClient.get(xl_apiHost+"/employees/empoyeeByNumber/"+e+"/"+s).pipe(Ht(l=>l)).pipe(Ht(l=>l)).subscribe(l=>{if(l.message="ok"){let h=l.data[0];this.employee_tour_list.push(h);let m=new gH;m.employee_id=h.employee_id,m.tour_id=i,this.httpClient.post(xl_apiHost+"/tourDetail",m).pipe(Ht(b=>b)).pipe(Ht(b=>b)).subscribe(b=>{this.tour_detail.push(b[0])})}})}removeEmployee(e){this.httpClient.post(xl_apiHost+"/tours/tour_detail/",e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.tour_detail=i})}getOpenTour(e){this.current_tour=new pH,this.tour_detail=[],this.httpClient.get(xl_apiHost+"/tours/openTour/"+e).pipe(Ht(i=>i)).pipe(Ht(i=>i)).subscribe(i=>{this.current_tour=i.tour,i.detail.forEach(s=>{let l=new zy;l.employee_number=s.employee_number,l.employee_id=s.employee_id,l.name=s.name,l.last_name=s.last_name,this.employee_tour_list.push(l);let h=new gH;h.tour_detail_id=s.tour_detail_id,h.employee_id=s.employee_id,h.tour_id=s.tour_id,this.tour_detail.push(h)}),this.tour_list.push(i.tour)})}confirmTour(e){return this.httpClient.put(xl_apiHost+"/tours/confirmTour/"+e,null)}confirmExternalTour(e){return this.httpClient.put(xl_apiHost+"/externalTours/"+e,null)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(dg))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function xoe(t,n){if(1&t){const e=xr();pe(0,"div",7)(1,"h4",8),et(2,"Tour"),ye(),pe(3,"button",9),Tt("click",function(){return ni(ti(e).$implicit.dismiss("Cross click"))}),ye()(),pe(4,"div",10)(5,"div",2)(6,"form",null,11)(8,"div",12)(9,"div",13)(10,"label",14),et(11,"Kilometraje"),ye()(),pe(12,"div",15)(13,"div",16)(14,"input",17,18),Tt("ngModelChange",function(s){return ti(e),ni(dn()._odometer=s)}),ye()()()()()()(),pe(16,"div",19)(17,"button",20),Tt("click",function(){return ni(ti(e).$implicit.close("Save click"))}),et(18,"Save"),ye()()}if(2&t){const e=dn();$e(14),st("ngModel",e._odometer)}}function Coe(t,n){if(1&t){const e=xr();pe(0,"div",7)(1,"h4",8),et(2,"Tour"),ye(),pe(3,"button",9),Tt("click",function(){return ni(ti(e).$implicit.dismiss("Cross click"))}),ye()(),pe(4,"div",10)(5,"div",2)(6,"form",null,11)(8,"div",12)(9,"div",13)(10,"label",14),et(11,"Numero de Empleado"),ye()(),pe(12,"div",15)(13,"div",16)(14,"input",21,22),Tt("ngModelChange",function(s){return ti(e),ni(dn().employee_number=s)}),ye()()()()()()(),pe(16,"div",19)(17,"button",20),Tt("click",function(){return ni(ti(e).$implicit.close("Save click"))}),et(18,"Save"),ye()()}if(2&t){const e=dn();$e(14),st("ngModel",e.employee_number)}}function Eoe(t,n){if(1&t){const e=xr();pe(0,"form")(1,"div",23)(2,"div",24)(3,"button",25),Tt("click",function(){ti(e);const s=dn(),l=ws(1);return ni(s.startTour(l))}),oi(4,"i",26),et(5,"Nuevo "),ye()()()()}}function Soe(t,n){if(1&t){const e=xr();pe(0,"table",27)(1,"thead")(2,"tr")(3,"th",28),et(4,"Hora Inicio"),ye(),pe(5,"th",28),et(6,"Hora Fin"),ye()()(),pe(7,"tbody")(8,"tr")(9,"td"),et(10),ye(),pe(11,"td"),et(12),ye(),pe(13,"td")(14,"a",29),Tt("click",function(){ti(e);const s=dn(),l=ws(1);return ni(s.endTour(l))}),oi(15,"i",30),ye()()(),pe(16,"tr")(17,"td",31),et(18,"Lista de empleados"),ye()()()()}if(2&t){const e=dn();$e(10),wr(e.tour_service.current_tour.start_date_time),$e(2),wr(e.tour_service.current_tour.end_date_time)}}function Toe(t,n){if(1&t){const e=xr();pe(0,"div",24)(1,"button",25),Tt("click",function(){ti(e);const s=dn(),l=ws(3);return ni(s.AddEmployee(l))}),oi(2,"i",32),et(3,"Subir Empleado "),ye()()}}function Ioe(t,n){if(1&t){const e=xr();pe(0,"tr")(1,"td"),et(2),ye(),pe(3,"td"),et(4),ye(),pe(5,"td")(6,"a",29),Tt("click",function(){const l=ti(e).$implicit;return ni(dn(2).removeEmployee(l))}),oi(7,"i",34),ye()()()}if(2&t){const e=n.$implicit,i=dn(2);$e(2),wr(i.getEmployeeNumber(e.employee_id)),$e(2),wr(i.getEmployeeName(e.employee_id))}}function Doe(t,n){if(1&t&&(pe(0,"table",27)(1,"thead")(2,"tr")(3,"th",28),et(4,"Numero"),ye(),pe(5,"th",28),et(6,"Empleado"),ye()()(),pe(7,"tbody"),En(8,Ioe,8,2,"tr",33),pe(9,"tr")(10,"td",31),et(11,"Recorrido en proceso"),ye()()()()),2&t){const e=dn();$e(8),st("ngForOf",e.tour_service.tour_detail)}}function Boe(t,n){if(1&t){const e=xr();pe(0,"div",35)(1,"form")(2,"div",23)(3,"div",24)(4,"button",36),Tt("click",function(){return ti(e),ni(dn().boarding())}),oi(5,"i",37),et(6,"Abordar "),ye()()()(),pe(7,"form")(8,"div",23)(9,"div",24)(10,"button",36),Tt("click",function(){return ti(e),ni(dn().boardingExternal())}),oi(11,"i",38),et(12,"Abordar Ruta Externa "),ye()()()()()}if(2&t){const e=dn();$e(4),st("disabled",!e.isReadyToConfirm()),$e(6),st("disabled",!e.isExternalAvailable())}}let Moe=(()=>{class t{constructor(e,i,s,l,h,m){this.routes_service=e,this.employee_service=i,this.tour_service=s,this.station_service=l,this.office_service=h,this.user_service=m,this.modalService=In(hg),this.closeResult="",this.active=1,this.markerPositions=[],this.employeemarkerOptionsList=[],this.userMarker=[],this.center={lat:23.24459112928423,lng:-106.39800170731318},this.zoom=13,this.tour_detail_to_boarding=!1,this.external_tour_available=!1,navigator}ngOnDestroy(){clearInterval(this.interval)}ngOnInit(){3==this.user_service.userType?this.interval=setInterval(()=>{this.employee_service.findDetailToBoarding(this.employee_service.employee_info.employee_id).subscribe(e=>{e.detail.length>0?(this.tour_detail=e.detail[0],0==e.detail.veicle_route_id?this.external_tour_available=!1:""!=this.tour_detail.confirmation_date_time?(this.tour_detail_to_boarding=!1,this.external_tour_available=!1):(this.tour_detail_to_boarding=!0,this.external_tour_available=!1)):this.external_tour_available=!0})},3e3):2==this.user_service.userType&&(this.station_service.getStationsByRoute(this.employee_service.employee_info.route_id),this.tour_service.getOpenTour(this.employee_service.employee_info.vehicle_route_id))}isReadyToConfirm(){return this.tour_detail_to_boarding}selectRoute(e){}startTour(e){this.tour_service.current_tour=new pH,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(i=>{let l=TD(new Date,"dd-MM-yyyy hh:mm:ss a","en-US","+0530");this.tour_service.current_tour.start_date_time=l,this.tour_service.current_tour.start_odometer=this._odometer,this.tour_service.current_tour.veicle_route_id=this.employee_service.employee_info.vehicle_route_id,this.tour_service.startTour(this.tour_service.current_tour)},i=>{this.closeResult=`Dismissed ${this.getDismissReason(i)}`})}boarding(){confirm("Desea confirmar el abordaje?")&&this.tour_service.confirmTour(this.tour_detail.tour_detail_id).subscribe(e=>{e&&(this.tour_detail_to_boarding=!1,alert("Abordaje confirmado con \xe9xito"))})}boardingExternal(){confirm("Desea abordar un veh\xedculo externo?")&&this.tour_service.confirmExternalTour(this.tour_detail.tour_detail_id).subscribe(e=>{e&&(this.external_tour_available=!1,alert("Abordaje confirmado con \xe9xito"))})}isExternalAvailable(){return this.external_tour_available}AddEmployee(e){this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(i=>{this.tour_service.addEmployee(this.employee_number,this.tour_service.current_tour.tour_id,this.employee_service.employee_info.vehicle_id)},i=>{this.closeResult=`Dismissed ${this.getDismissReason(i)}`})}endTour(e){this._odometer=0,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(i=>{TD(new Date,"dd-MM-yyyy hh:mm:ss a","en-US","+0530"),this.tour_service.current_tour.end_odometer=this._odometer,this.tour_service.current_tour.tour_lenght=this.tour_service.current_tour.end_odometer-this.tour_service.current_tour.start_odometer,this.tour_service.endTour(this.tour_service.current_tour)},i=>{this.closeResult=`Dismissed ${this.getDismissReason(i)}`})}getDismissReason(e){switch(e){case Yl.ESC:return"by pressing ESC";case Yl.BACKDROP_CLICK:return"by clicking on a backdrop";default:return`with: ${e}`}}getEmployeeNumber(e){return this.tour_service.employee_tour_list.find(s=>s.employee_id==e)?.employee_number}getEmployeeName(e){let i=this.tour_service.employee_tour_list.find(l=>l.employee_id==e)?.name,s=this.tour_service.employee_tour_list.find(l=>l.employee_id==e)?.last_name;return i+" "+s}getEmployeeLatLng(){this.employee_service.getEmployeesLatLng().subscribe(e=>{e.forEach(i=>{let s=this.getLatLngFromEmployeeRow(i);this.markerPositions.push({lat:s[0],lng:s[1]}),this.employeemarkerOptionsList.push({title:i.name+" "+i.last_name,icon:"http://maps.gstatic.com/mapfiles/ms2/micons/homegardenbusiness.png",draggable:!1})})})}getLatLngFromEmployeeRow(e){let i=e.location.split(",",2);return i[0]=parseFloat(i[0]),i[1]=parseFloat(i[1]),i}open(e,i){this.station_service.selected_station=i.station_name?i:new WE,this.modalService.open(e,{ariaLabelledBy:"modal-basic-title",size:"lg",backdrop:"static",windowClass:"my-class"}).result.then(s=>{this.closeResult=`Closed with: ${s}`,i.latLng&&(this.station_service.selected_station.location=i.latLng.toString().replace("(","").replace(")","")),this.addMarker(i,this.station_service.selected_station)},s=>{this.refreshStationForm(),this.closeResult=`Dismissed ${this.getDismissReason(s)}`})}refreshStationForm(){this.station_service.selected_station=new WE}addMarker(e,i){var s=this;return(0,Um.Z)(function*(){null!=e.latLng&&s.station_service.markerStationPositions.push(e.latLng.toJSON()),s.station_service.saveStation(i),s.refreshStationForm()})()}getOption(e){return this.employeemarkerOptionsList[e]}getStationOption(e){return this.station_service.stationMarkerOptionsList[e]}removeEmployee(e){}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(d0),Ve(Hy),Ve(woe),Ve(G1),Ve(ZE),Ve(q1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-tours"]],decls:10,vars:5,consts:[["content",""],["content_employee",""],[1,"container",2,"margin-top","60px"],[4,"ngIf"],["class","table table-striped",4,"ngIf"],["class","col-2",4,"ngIf"],["class","row",4,"ngIf"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["userForm","ngForm"],[1,"row","form_row"],[1,"col-3"],["for","odometer"],[1,"col-9"],[1,"form-group"],["id","odometer","type","text","name","odometer","placeholder","Kilometraje","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["odometer","ngModel"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],["id","employee_num","type","text","name","employee_num","placeholder","Numero de Empleado","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["employee_num","ngModel"],[1,"mb-3","row"],[1,"col-2"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus-circle"],[1,"table","table-striped"],["scope","col"],[1,"btn","btn-danger","text-white",3,"click"],[1,"fa","fa-stop-circle"],["colspan","5",2,"text-align","center"],[1,"fa","fa-users"],[4,"ngFor","ngForOf"],[1,"fas","fa-trash-alt"],[1,"row"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fas","fa-car"],[1,"fas","fa","fa-bus"]],template:function(i,s){1&i&&(En(0,xoe,19,1,"ng-template",null,0,Zl),En(2,Coe,19,1,"ng-template",null,1,Zl),pe(4,"div",2),En(5,Eoe,6,0,"form",3),En(6,Soe,19,2,"table",4),En(7,Toe,4,0,"div",5),En(8,Doe,12,1,"table",4),En(9,Boe,13,2,"div",6),ye()),2&i&&($e(5),st("ngIf",2==s.user_service.userType),$e(1),st("ngIf",s.tour_service.current_tour&&2==s.user_service.userType),$e(1),st("ngIf",2==s.user_service.userType),$e(1),st("ngIf",s.tour_service.employee_tour_list&&2==s.user_service.userType),$e(1),st("ngIf",3==s.user_service.userType))},dependencies:[Pl,Xh,Fd,oc,Jc,Md,Qu,xh],styles:[".example-list[_ngcontent-%COMP%]{width:500px;max-width:100%;border:solid 1px #ccc;min-height:60px;display:block;background:white;border-radius:4px;overflow:hidden;max-height:700px;overflow-x:hidden;overflow-y:scroll;width:100%;border:1px solid}.example-box[_ngcontent-%COMP%]{padding:20px 10px;border-bottom:solid 1px #ccc;color:#000000de;display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;cursor:move;background:white;font-size:14px}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .example-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]})}return t})();var Ga=Zs(1002),Ma=Uint8Array,ju=Uint16Array,jy=Uint32Array,Bx=new Ma([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Mx=new Ma([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),aS=new Ma([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_H=function(t,n){for(var e=new ju(31),i=0;i<31;++i)e[i]=n+=1<<t[i-1];var s=new jy(e[30]);for(i=1;i<30;++i)for(var l=e[i];l<e[i+1];++l)s[l]=l-e[i]<<5|i;return[e,s]},yH=_H(Bx,2),oP=yH[0],WB=yH[1];oP[28]=258,WB[258]=28;for(var vH=_H(Mx,0),bH=vH[0],aP=vH[1],lS=new ju(32768),Cl=0;Cl<32768;++Cl){var Gy=(43690&Cl)>>>1|(21845&Cl)<<1;lS[Cl]=((65280&(Gy=(61680&(Gy=(52428&Gy)>>>2|(13107&Gy)<<2))>>>4|(3855&Gy)<<4))>>>8|(255&Gy)<<8)>>>1}var ap=function(t,n,e){for(var i=t.length,s=0,l=new ju(n);s<i;++s)++l[t[s]-1];var m,h=new ju(n);for(s=0;s<n;++s)h[s]=h[s-1]+l[s-1]<<1;if(e){m=new ju(1<<n);var b=15-n;for(s=0;s<i;++s)if(t[s])for(var E=s<<4|t[s],M=n-t[s],L=h[t[s]-1]++<<M,G=L|(1<<M)-1;L<=G;++L)m[lS[L]>>>b]=E}else for(m=new ju(i),s=0;s<i;++s)m[s]=lS[h[t[s]-1]++]>>>15-t[s];return m},A0=new Ma(288);for(Cl=0;Cl<144;++Cl)A0[Cl]=8;for(Cl=144;Cl<256;++Cl)A0[Cl]=9;for(Cl=256;Cl<280;++Cl)A0[Cl]=7;for(Cl=280;Cl<288;++Cl)A0[Cl]=8;var Fx=new Ma(32);for(Cl=0;Cl<32;++Cl)Fx[Cl]=5;var wH=ap(A0,9,0),xH=ap(A0,9,1),CH=ap(Fx,5,0),EH=ap(Fx,5,1),ZB=function(t){for(var n=t[0],e=1;e<t.length;++e)t[e]>n&&(n=t[e]);return n},lp=function(t,n,e){var i=n/8>>0;return(t[i]|t[i+1]<<8)>>>(7&n)&e},XB=function(t,n){var e=n/8>>0;return(t[e]|t[e+1]<<8|t[e+2]<<16)>>>(7&n)},cS=function(t){return(t/8>>0)+(7&t&&1)},X1=function(t,n,e){(null==n||n<0)&&(n=0),(null==e||e>t.length)&&(e=t.length);var i=new(t instanceof ju?ju:t instanceof jy?jy:Ma)(e-n);return i.set(t.subarray(n,e)),i},zm=function(t,n,e){var i=n/8>>0;t[i]|=e<<=7&n,t[i+1]|=e>>>8},Rx=function(t,n,e){var i=n/8>>0;t[i]|=e<<=7&n,t[i+1]|=e>>>8,t[i+2]|=e>>>16},JB=function(t,n){for(var e=[],i=0;i<t.length;++i)t[i]&&e.push({s:i,f:t[i]});var s=e.length,l=e.slice();if(!s)return[new Ma(0),0];if(1==s){var h=new Ma(e[0].s+1);return h[e[0].s]=1,[h,1]}e.sort(function(pt,Qt){return pt.f-Qt.f}),e.push({s:-1,f:25001});var m=e[0],b=e[1],E=0,M=1,L=2;for(e[0]={s:-1,f:m.f+b.f,l:m,r:b};M!=s-1;)m=e[e[E].f<e[L].f?E++:L++],b=e[E!=M&&e[E].f<e[L].f?E++:L++],e[M++]={s:-1,f:m.f+b.f,l:m,r:b};var G=l[0].s;for(i=1;i<s;++i)l[i].s>G&&(G=l[i].s);var V=new ju(G+1),ne=eM(e[M-1],V,0);if(ne>n){i=0;var re=0,de=ne-n,fe=1<<de;for(l.sort(function(Qt,yt){return V[yt.s]-V[Qt.s]||Qt.f-yt.f});i<s;++i){var he=l[i].s;if(!(V[he]>n))break;re+=fe-(1<<ne-V[he]),V[he]=n}for(re>>>=de;re>0;){var Ne=l[i].s;V[Ne]<n?re-=1<<n-V[Ne]++-1:++i}for(;i>=0&&re;--i){var We=l[i].s;V[We]==n&&(--V[We],++re)}ne=n}return[new Ma(V),ne]},eM=function(t,n,e){return-1==t.s?Math.max(eM(t.l,n,e+1),eM(t.r,n,e+1)):n[t.s]=e},lP=function(t){for(var n=t.length;n&&!t[--n];);for(var e=new ju(++n),i=0,s=t[0],l=1,h=function(b){e[i++]=b},m=1;m<=n;++m)if(t[m]==s&&m!=n)++l;else{if(!s&&l>2){for(;l>138;l-=138)h(32754);l>2&&(h(l>10?l-11<<5|28690:l-3<<5|12305),l=0)}else if(l>3){for(h(s),--l;l>6;l-=6)h(8304);l>2&&(h(l-3<<5|8208),l=0)}for(;l--;)h(s);l=1,s=t[m]}return[e.subarray(0,i),n]},Ox=function(t,n){for(var e=0,i=0;i<n.length;++i)e+=t[i]*n[i];return e},uS=function(t,n,e){var i=e.length,s=cS(n+2);t[s]=255&i,t[s+1]=i>>>8,t[s+2]=255^t[s],t[s+3]=255^t[s+1];for(var l=0;l<i;++l)t[s+l+4]=e[l];return 8*(s+4+i)},cP=function(t,n,e,i,s,l,h,m,b,E,M){zm(n,M++,e),++s[256];for(var L=JB(s,15),G=L[0],V=L[1],ne=JB(l,15),re=ne[0],de=ne[1],fe=lP(G),he=fe[0],Ne=fe[1],We=lP(re),pt=We[0],Qt=We[1],yt=new ju(19),Ye=0;Ye<he.length;++Ye)yt[31&he[Ye]]++;for(Ye=0;Ye<pt.length;++Ye)yt[31&pt[Ye]]++;for(var un=JB(yt,7),hn=un[0],Ue=un[1],ze=19;ze>4&&!hn[aS[ze-1]];--ze);var ft,Ot,wt,Yt,ut=E+5<<3,lt=Ox(s,A0)+Ox(l,Fx)+h,_n=Ox(s,G)+Ox(l,re)+h+14+3*ze+Ox(yt,hn)+(2*yt[16]+3*yt[17]+7*yt[18]);if(ut<=lt&&ut<=_n)return uS(n,M,t.subarray(b,b+E));if(zm(n,M,1+(_n<lt)),M+=2,_n<lt){ft=ap(G,V,0),Ot=G,wt=ap(re,de,0),Yt=re;var pn=ap(hn,Ue,0);for(zm(n,M,Ne-257),zm(n,M+5,Qt-1),zm(n,M+10,ze-4),M+=14,Ye=0;Ye<ze;++Ye)zm(n,M+3*Ye,hn[aS[Ye]]);M+=3*ze;for(var Ti=[he,pt],Se=0;Se<2;++Se){var Xe=Ti[Se];for(Ye=0;Ye<Xe.length;++Ye)zm(n,M,pn[Je=31&Xe[Ye]]),M+=hn[Je],Je>15&&(zm(n,M,Xe[Ye]>>>5&127),M+=Xe[Ye]>>>12)}}else ft=wH,Ot=A0,wt=CH,Yt=Fx;for(Ye=0;Ye<m;++Ye)if(i[Ye]>255){var Je;Rx(n,M,ft[257+(Je=i[Ye]>>>18&31)]),M+=Ot[Je+257],Je>7&&(zm(n,M,i[Ye]>>>23&31),M+=Bx[Je]);var _t=31&i[Ye];Rx(n,M,wt[_t]),M+=Yt[_t],_t>3&&(Rx(n,M,i[Ye]>>>5&8191),M+=Mx[_t])}else Rx(n,M,ft[i[Ye]]),M+=Ot[i[Ye]];return Rx(n,M,ft[256]),M+Ot[256]},SH=new jy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),TH=new Ma(0),nM=function(t,n,e,i,s){return function(t,n,e,i,s,l){var h=t.length,m=new Ma(i+h+5*(1+Math.floor(h/7e3))+s),b=m.subarray(i,m.length-s),E=0;if(!n||h<8)for(var M=0;M<=h;M+=65535){var L=M+65535;L<h?E=uS(b,E,t.subarray(M,L)):(b[M]=l,E=uS(b,E,t.subarray(M,h)))}else{for(var G=SH[n-1],V=G>>>13,ne=8191&G,re=(1<<e)-1,de=new ju(32768),fe=new ju(re+1),he=Math.ceil(e/3),Ne=2*he,We=function(ss){return(t[ss]^t[ss+1]<<he^t[ss+2]<<Ne)&re},pt=new jy(25e3),Qt=new ju(288),yt=new ju(32),Ye=0,un=0,hn=(M=0,0),Ue=0,ze=0;M<h;++M){var ut=We(M),lt=32767&M,_n=fe[ut];if(de[lt]=_n,fe[ut]=lt,Ue<=M){var ft=h-M;if((Ye>7e3||hn>24576)&&ft>423){E=cP(t,b,0,pt,Qt,yt,un,hn,ze,M-ze,E),hn=Ye=un=0,ze=M;for(var Ot=0;Ot<286;++Ot)Qt[Ot]=0;for(Ot=0;Ot<30;++Ot)yt[Ot]=0}var wt=2,Yt=0,pn=ne,Ti=lt-_n&32767;if(ft>2&&ut==We(M-Ti))for(var Se=Math.min(V,ft)-1,Xe=Math.min(32767,M),Je=Math.min(258,ft);Ti<=Xe&&--pn&&lt!=_n;){if(t[M+wt]==t[M+wt-Ti]){for(var _t=0;_t<Je&&t[M+_t]==t[M+_t-Ti];++_t);if(_t>wt){if(wt=_t,Yt=Ti,_t>Se)break;var Nt=Math.min(Ti,_t-2),jt=0;for(Ot=0;Ot<Nt;++Ot){var en=M-Ti+Ot+32768&32767,bi=en-de[en]+32768&32767;bi>jt&&(jt=bi,_n=en)}}}Ti+=(lt=_n)-(_n=de[lt])+32768&32767}if(Yt){pt[hn++]=268435456|WB[wt]<<18|aP[Yt];var di=31&WB[wt],Yi=31&aP[Yt];un+=Bx[di]+Mx[Yi],++Qt[257+di],++yt[Yi],Ue=M+wt,++Ye}else pt[hn++]=t[M],++Qt[t[M]]}}E=cP(t,b,l,pt,Qt,yt,un,hn,ze,M-ze,E),l||(E=uS(b,E,TH))}return X1(m,0,i+cS(E)+s)}(t,null==n.level?6:n.level,null==n.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+n.mem,e,i,!s)};function dS(t,n){void 0===n&&(n={});var e=function(){var t=1,n=0;return{p:function(e){for(var i=t,s=n,l=e.length,h=0;h!=l;){for(var m=Math.min(h+5552,l);h<m;++h)s+=i+=e[h];i%=65521,s%=65521}t=i,n=s},d:function(){return(t>>>8<<16|(255&n)<<8|n>>>8)+2*((255&t)<<23)}}}();e.p(t);var i=nM(t,n,2,4);return function(t,n){var e=n.level,i=0==e?0:e<6?1:9==e?3:2;t[0]=120,t[1]=i<<6|(i?32-2*i:1)}(i,n),function(t,n,e){for(;e;++n)t[n]=e,e>>>=8}(i,i.length-4,e.d()),i}function sM(t,n){return function(t,n,e){var i=t.length,s=!n||e,l=!e||e.i;e||(e={}),n||(n=new Ma(3*i));var h=function(Nt){var jt=n.length;if(Nt>jt){var en=new Ma(Math.max(2*jt,Nt));en.set(n),n=en}},m=e.f||0,b=e.p||0,E=e.b||0,M=e.l,L=e.d,G=e.m,V=e.n,ne=8*i;do{if(!M){e.f=m=lp(t,b,1);var re=lp(t,b+1,3);if(b+=3,!re){var fe=t[(de=cS(b)+4)-4]|t[de-3]<<8,he=de+fe;if(he>i){if(l)throw"unexpected EOF";break}s&&h(E+fe),n.set(t.subarray(de,he),E),e.b=E+=fe,e.p=b=8*he;continue}if(1==re)M=xH,L=EH,G=9,V=5;else{if(2!=re)throw"invalid block type";var Ne=lp(t,b,31)+257,We=lp(t,b+10,15)+4,pt=Ne+lp(t,b+5,31)+1;b+=14;for(var Qt=new Ma(pt),yt=new Ma(19),Ye=0;Ye<We;++Ye)yt[aS[Ye]]=lp(t,b+3*Ye,7);b+=3*We;var un=ZB(yt),hn=(1<<un)-1;if(!l&&b+pt*(un+7)>ne)break;var Ue=ap(yt,un,1);for(Ye=0;Ye<pt;){var de,ze=Ue[lp(t,b,hn)];if(b+=15&ze,(de=ze>>>4)<16)Qt[Ye++]=de;else{var ut=0,lt=0;for(16==de?(lt=3+lp(t,b,3),b+=2,ut=Qt[Ye-1]):17==de?(lt=3+lp(t,b,7),b+=3):18==de&&(lt=11+lp(t,b,127),b+=7);lt--;)Qt[Ye++]=ut}}var _n=Qt.subarray(0,Ne),ft=Qt.subarray(Ne);G=ZB(_n),V=ZB(ft),M=ap(_n,G,1),L=ap(ft,V,1)}if(b>ne)throw"unexpected EOF"}s&&h(E+131072);for(var Ot=(1<<G)-1,wt=(1<<V)-1,Yt=G+V+18;l||b+Yt<ne;){var pn=(ut=M[XB(t,b)&Ot])>>>4;if((b+=15&ut)>ne)throw"unexpected EOF";if(!ut)throw"invalid length/literal";if(pn<256)n[E++]=pn;else{if(256==pn){M=null;break}var Ti=pn-254;pn>264&&(Ti=lp(t,b,(1<<(Se=Bx[Ye=pn-257]))-1)+oP[Ye],b+=Se);var Xe=L[XB(t,b)&wt],Je=Xe>>>4;if(!Xe)throw"invalid distance";if(b+=15&Xe,ft=bH[Je],Je>3){var Se=Mx[Je];ft+=XB(t,b)&(1<<Se)-1,b+=Se}if(b>ne)throw"unexpected EOF";s&&h(E+131072);for(var _t=E+Ti;E<_t;E+=4)n[E]=n[E-ft],n[E+1]=n[E+1-ft],n[E+2]=n[E+2-ft],n[E+3]=n[E+3-ft];E=_t}}e.l=M,e.p=b,e.b=E,M&&(m=1,e.m=G,e.d=L,e.n=V)}while(!m);return E==n.length?n:X1(n,0,E)}((function(t){if(8!=(15&t[0])||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(32&t[1])throw"invalid zlib data: preset dictionaries not supported"}(t),t.subarray(2,-4)),n)}var ms=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function pP(){ms.console&&"function"==typeof ms.console.log&&ms.console.log.apply(ms.console,arguments)}var $a={log:pP,warn:function(t){ms.console&&("function"==typeof ms.console.warn?ms.console.warn.apply(ms.console,arguments):pP.call(null,arguments))},error:function(t){ms.console&&("function"==typeof ms.console.error?ms.console.error.apply(ms.console,arguments):pP(t))}};function gP(t,n,e){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){Y1(i.response,n,e)},i.onerror=function(){$a.error("could not download file")},i.send()}function $H(t){var n=new XMLHttpRequest;n.open("HEAD",t,!1);try{n.send()}catch{}return n.status>=200&&n.status<=299}function aM(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var fS,mP,Y1=ms.saveAs||("object"!==(typeof window>"u"?"undefined":(0,Ga.Z)(window))||window!==ms?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,n,e){var i=ms.URL||ms.webkitURL,s=document.createElement("a");s.download=n=n||t.name||"download",s.rel="noopener","string"==typeof t?(s.href=t,s.origin!==location.origin?$H(s.href)?gP(t,n,e):aM(s,s.target="_blank"):aM(s)):(s.href=i.createObjectURL(t),setTimeout(function(){i.revokeObjectURL(s.href)},4e4),setTimeout(function(){aM(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,n,e){if(n=n||t.name||"download","string"==typeof t)if($H(t))gP(t,n,e);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout(function(){aM(i)})}else navigator.msSaveOrOpenBlob((s=t,void 0===(l=e)?l={autoBom:!1}:"object"!==(0,Ga.Z)(l)&&($a.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob([String.fromCharCode(65279),s],{type:s.type}):s),n);var s,l}:function(t,n,e,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return gP(t,n,e);var s="application/octet-stream"===t.type,l=/constructor/i.test(ms.HTMLElement)||ms.safari,h=/CriOS\/[\d]+/.test(navigator.userAgent);if((h||s&&l)&&"object"===(typeof FileReader>"u"?"undefined":(0,Ga.Z)(FileReader))){var m=new FileReader;m.onloadend=function(){var M=m.result;M=h?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=M:location=M,i=null},m.readAsDataURL(t)}else{var b=ms.URL||ms.webkitURL,E=b.createObjectURL(t);i?i.location=E:location.href=E,i=null,setTimeout(function(){b.revokeObjectURL(E)},4e4)}});function qH(t){var n;t=t||"",this.ok=!1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(m){return[parseInt(m[1]),parseInt(m[2]),parseInt(m[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(m){return[parseInt(m[1],16),parseInt(m[2],16),parseInt(m[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(m){return[parseInt(m[1]+m[1],16),parseInt(m[2]+m[2],16),parseInt(m[3]+m[3],16)]}}],i=0;i<e.length;i++){var l=e[i].process,h=e[i].re.exec(t);h&&(n=l(h),this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var m=this.r.toString(16),b=this.g.toString(16),E=this.b.toString(16);return 1==m.length&&(m="0"+m),1==b.length&&(b="0"+b),1==E.length&&(E="0"+E),"#"+m+b+E}}function _P(t,n){var e=t[0],i=t[1],s=t[2],l=t[3];e=Jh(e,i,s,l,n[0],7,-680876936),l=Jh(l,e,i,s,n[1],12,-389564586),s=Jh(s,l,e,i,n[2],17,606105819),i=Jh(i,s,l,e,n[3],22,-1044525330),e=Jh(e,i,s,l,n[4],7,-176418897),l=Jh(l,e,i,s,n[5],12,1200080426),s=Jh(s,l,e,i,n[6],17,-1473231341),i=Jh(i,s,l,e,n[7],22,-45705983),e=Jh(e,i,s,l,n[8],7,1770035416),l=Jh(l,e,i,s,n[9],12,-1958414417),s=Jh(s,l,e,i,n[10],17,-42063),i=Jh(i,s,l,e,n[11],22,-1990404162),e=Jh(e,i,s,l,n[12],7,1804603682),l=Jh(l,e,i,s,n[13],12,-40341101),s=Jh(s,l,e,i,n[14],17,-1502002290),e=ed(e,i=Jh(i,s,l,e,n[15],22,1236535329),s,l,n[1],5,-165796510),l=ed(l,e,i,s,n[6],9,-1069501632),s=ed(s,l,e,i,n[11],14,643717713),i=ed(i,s,l,e,n[0],20,-373897302),e=ed(e,i,s,l,n[5],5,-701558691),l=ed(l,e,i,s,n[10],9,38016083),s=ed(s,l,e,i,n[15],14,-660478335),i=ed(i,s,l,e,n[4],20,-405537848),e=ed(e,i,s,l,n[9],5,568446438),l=ed(l,e,i,s,n[14],9,-1019803690),s=ed(s,l,e,i,n[3],14,-187363961),i=ed(i,s,l,e,n[8],20,1163531501),e=ed(e,i,s,l,n[13],5,-1444681467),l=ed(l,e,i,s,n[2],9,-51403784),s=ed(s,l,e,i,n[7],14,1735328473),e=td(e,i=ed(i,s,l,e,n[12],20,-1926607734),s,l,n[5],4,-378558),l=td(l,e,i,s,n[8],11,-2022574463),s=td(s,l,e,i,n[11],16,1839030562),i=td(i,s,l,e,n[14],23,-35309556),e=td(e,i,s,l,n[1],4,-1530992060),l=td(l,e,i,s,n[4],11,1272893353),s=td(s,l,e,i,n[7],16,-155497632),i=td(i,s,l,e,n[10],23,-1094730640),e=td(e,i,s,l,n[13],4,681279174),l=td(l,e,i,s,n[0],11,-358537222),s=td(s,l,e,i,n[3],16,-722521979),i=td(i,s,l,e,n[6],23,76029189),e=td(e,i,s,l,n[9],4,-640364487),l=td(l,e,i,s,n[12],11,-421815835),s=td(s,l,e,i,n[15],16,530742520),e=nd(e,i=td(i,s,l,e,n[2],23,-995338651),s,l,n[0],6,-198630844),l=nd(l,e,i,s,n[7],10,1126891415),s=nd(s,l,e,i,n[14],15,-1416354905),i=nd(i,s,l,e,n[5],21,-57434055),e=nd(e,i,s,l,n[12],6,1700485571),l=nd(l,e,i,s,n[3],10,-1894986606),s=nd(s,l,e,i,n[10],15,-1051523),i=nd(i,s,l,e,n[1],21,-2054922799),e=nd(e,i,s,l,n[8],6,1873313359),l=nd(l,e,i,s,n[15],10,-30611744),s=nd(s,l,e,i,n[6],15,-1560198380),i=nd(i,s,l,e,n[13],21,1309151649),e=nd(e,i,s,l,n[4],6,-145523070),l=nd(l,e,i,s,n[11],10,-1120210379),s=nd(s,l,e,i,n[2],15,718787259),i=nd(i,s,l,e,n[9],21,-343485551),t[0]=qy(e,t[0]),t[1]=qy(i,t[1]),t[2]=qy(s,t[2]),t[3]=qy(l,t[3])}function lM(t,n,e,i,s,l){return n=qy(qy(n,t),qy(i,l)),qy(n<<s|n>>>32-s,e)}function Jh(t,n,e,i,s,l,h){return lM(n&e|~n&i,t,n,s,l,h)}function ed(t,n,e,i,s,l,h){return lM(n&i|e&~i,t,n,s,l,h)}function td(t,n,e,i,s,l,h){return lM(n^e^i,t,n,s,l,h)}function nd(t,n,e,i,s,l,h){return lM(e^(n|~i),t,n,s,l,h)}function KH(t){var n,e=t.length,i=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=t.length;n+=64)_P(i,Qoe(t.substring(n-64,n)));t=t.substring(n-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<t.length;n++)s[n>>2]|=t.charCodeAt(n)<<(n%4<<3);if(s[n>>2]|=128<<(n%4<<3),n>55)for(_P(i,s),n=0;n<16;n++)s[n]=0;return s[14]=8*e,_P(i,s),i}function Qoe(t){var n,e=[];for(n=0;n<64;n+=4)e[n>>2]=t.charCodeAt(n)+(t.charCodeAt(n+1)<<8)+(t.charCodeAt(n+2)<<16)+(t.charCodeAt(n+3)<<24);return e}fS=ms.atob.bind(ms),mP=ms.btoa.bind(ms);var WH="0123456789abcdef".split("");function joe(t){for(var n="",e=0;e<4;e++)n+=WH[t>>8*e+4&15]+WH[t>>8*e&15];return n}function Goe(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function yP(t){return KH(t).map(Goe).join("")}var $oe="5d41402abc4b2a76b9719d911017c592"!=function(t){for(var n=0;n<t.length;n++)t[n]=joe(t[n]);return t.join("")}(KH("hello"));function qy(t,n){if($oe){var e=(65535&t)+(65535&n);return(t>>16)+(n>>16)+(e>>16)<<16|65535&e}return t+n&4294967295}function vP(t,n){var e,i,s;if(t!==e){for(var h=(s=t,new Array(1+(256/t.length>>0)+1).join(s)),m=[],b=0;b<256;b++)m[b]=b;var E=0;for(b=0;b<256;b++){var M=m[b];E=(E+M+h.charCodeAt(b))%256,m[b]=m[E],m[E]=M}e=t,i=m}else m=i;var L=n.length,G=0,V=0,ne="";for(b=0;b<L;b++)V=(V+(M=m[G=(G+1)%256]))%256,m[G]=m[V],m[V]=M,h=m[(m[G]+m[V])%256],ne+=String.fromCharCode(n.charCodeAt(b)^h);return ne}var ZH={print:4,modify:8,copy:16,"annot-forms":32};function Px(t,n,e,i){this.v=1,this.r=2;var s=192;t.forEach(function(m){if(void 0!==ZH.perm)throw new Error("Invalid permission: "+m);s+=ZH[m]}),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var l=(n+this.padding).substr(0,32),h=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(l,h),this.P=-(1+(255^s)),this.encryptionKey=yP(l+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(i)).substr(0,5),this.U=vP(this.encryptionKey,this.padding)}function Nx(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var n="",e=t.length,i=0;i<e;i++){var s=t.charCodeAt(i);n+=s<33||35===s||37===s||40===s||41===s||47===s||60===s||62===s||91===s||93===s||123===s||125===s||s>126?"#"+("0"+s.toString(16)).slice(-2):t[i]}return n}function XH(t){if("object"!==(0,Ga.Z)(t))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var n={};this.subscribe=function(e,i,s){if(s=s||!1,"string"!=typeof e||"function"!=typeof i||"boolean"!=typeof s)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");n.hasOwnProperty(e)||(n[e]={});var l=Math.random().toString(35);return n[e][l]=[i,!!s],l},this.unsubscribe=function(e){for(var i in n)if(n[i][e])return delete n[i][e],0===Object.keys(n[i]).length&&delete n[i],!0;return!1},this.publish=function(e){if(n.hasOwnProperty(e)){var i=Array.prototype.slice.call(arguments,1),s=[];for(var l in n[e]){var h=n[e][l];try{h[0].apply(t,i)}catch(m){ms.console&&$a.error("jsPDF PubSub Error",m.message,m)}h[1]&&s.push(l)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return n}}function cM(t){if(!(this instanceof cM))return new cM(t);var n="opacity,stroke-opacity".split(",");for(var e in t)t.hasOwnProperty(e)&&n.indexOf(e)>=0&&(this[e]=t[e]);this.id="",this.objectNumber=-1}function YH(t,n){this.gState=t,this.matrix=n,this.id="",this.objectNumber=-1}function J1(t,n,e,i,s){if(!(this instanceof J1))return new J1(t,n,e,i,s);this.type="axial"===t?2:3,this.coords=n,this.colors=e,YH.call(this,i,s)}function Lx(t,n,e,i,s){if(!(this instanceof Lx))return new Lx(t,n,e,i,s);this.boundingBox=t,this.xStep=n,this.yStep=e,this.stream="",this.cloneIndex=0,YH.call(this,i,s)}function fs(t){var n,e="string"==typeof arguments[0]?arguments[0]:"p",i=arguments[1],s=arguments[2],l=arguments[3],h=[],m=1,b=16,E="S",M=null;"object"===(0,Ga.Z)(t=t||{})&&(e=t.orientation,i=t.unit||i,s=t.format||s,l=t.compress||t.compressPdf||l,null!==(M=t.encryption||null)&&(M.userPassword=M.userPassword||"",M.ownerPassword=M.ownerPassword||"",M.userPermissions=M.userPermissions||[]),m="number"==typeof t.userUnit?Math.abs(t.userUnit):1,void 0!==t.precision&&(n=t.precision),void 0!==t.floatPrecision&&(b=t.floatPrecision),E=t.defaultPathOperation||"S"),h=t.filters||(!0===l?["FlateEncode"]:h),i=i||"mm",e=(""+(e||"P")).toLowerCase();var L=t.putOnlyUsedFonts||!1,G={},V={internal:{},__private__:{}};V.__private__.PubSub=XH;var ne="1.3",re=V.__private__.getPdfVersion=function(){return ne};V.__private__.setPdfVersion=function(W){ne=W};var de={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};V.__private__.getPageFormats=function(){return de};var fe=V.__private__.getPageFormat=function(W){return de[W]};s=s||"a4";var Ne="compat";function We(){this.saveGraphicsState(),at(new As(er,0,0,-er,0,nv()*er).toString()+" cm"),this.setFontSize(this.getFontSize()/er),E="n",Ne="advanced"}function pt(){this.restoreGraphicsState(),E="S",Ne="compat"}var Qt=V.__private__.combineFontStyleAndFontWeight=function(W,we){if("bold"==W&&"normal"==we||"bold"==W&&400==we||"normal"==W&&"italic"==we||"bold"==W&&"italic"==we)throw new Error("Invalid Combination of fontweight and fontstyle");return we&&(W=400==we||"normal"===we?"italic"===W?"italic":"normal":700!=we&&"bold"!==we||"normal"!==W?(700==we?"bold":we)+""+W:"bold"),W};V.advancedAPI=function(W){var we="compat"===Ne;return we&&We.call(this),"function"!=typeof W||(W(this),we&&pt.call(this)),this},V.compatAPI=function(W){var we="advanced"===Ne;return we&&pt.call(this),"function"!=typeof W||(W(this),we&&We.call(this)),this},V.isAdvancedAPI=function(){return"advanced"===Ne};var yt,Ye=function(W){if("advanced"!==Ne)throw new Error(W+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},un=V.roundToPrecision=V.__private__.roundToPrecision=function(W,we){var it=n||we;if(isNaN(W)||isNaN(it))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return W.toFixed(it).replace(/0+$/,"")};yt=V.hpf=V.__private__.hpf="number"==typeof b?function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.hpf");return un(W,b)}:"smart"===b?function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.hpf");return un(W,W>-1&&W<1?16:5)}:function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.hpf");return un(W,16)};var hn=V.f2=V.__private__.f2=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.f2");return un(W,2)},Ue=V.__private__.f3=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.f3");return un(W,3)},ze=V.scale=V.__private__.scale=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.scale");return"compat"===Ne?W*er:"advanced"===Ne?W:void 0},lt=function(W){return ze(function(W){return"compat"===Ne?nv()-W:"advanced"===Ne?W:void 0}(W))};V.__private__.setPrecision=V.setPrecision=function(W){"number"==typeof parseInt(W,10)&&(n=parseInt(W,10))};var _n,ft="00000000000000000000000000000000",Ot=V.__private__.getFileId=function(){return ft},wt=V.__private__.setFileId=function(W){return ft=void 0!==W&&/^[a-fA-F0-9]{32}$/.test(W)?W.toUpperCase():ft.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==M&&(rd=new Px(M.userPermissions,M.userPassword,M.ownerPassword,ft)),ft};V.setFileId=function(W){return wt(W),this},V.getFileId=function(){return Ot()};var Yt=V.__private__.convertDateToPDFDate=function(W){var we=W.getTimezoneOffset(),it=we<0?"+":"-",vt=Math.floor(Math.abs(we/60)),qt=Math.abs(we%60),Dn=[it,Je(vt),"'",Je(qt),"'"].join("");return["D:",W.getFullYear(),Je(W.getMonth()+1),Je(W.getDate()),Je(W.getHours()),Je(W.getMinutes()),Je(W.getSeconds()),Dn].join("")},pn=V.__private__.convertPDFDateToDate=function(W){var we=parseInt(W.substr(2,4),10),it=parseInt(W.substr(6,2),10)-1,vt=parseInt(W.substr(8,2),10),qt=parseInt(W.substr(10,2),10),Dn=parseInt(W.substr(12,2),10),fi=parseInt(W.substr(14,2),10);return new Date(we,it,vt,qt,Dn,fi,0)},Ti=V.__private__.setCreationDate=function(W){var we;if(void 0===W&&(W=new Date),W instanceof Date)we=Yt(W);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(W))throw new Error("Invalid argument passed to jsPDF.setCreationDate");we=W}return _n=we},Se=V.__private__.getCreationDate=function(W){var we=_n;return"jsDate"===W&&(we=pn(_n)),we};V.setCreationDate=function(W){return Ti(W),this},V.getCreationDate=function(W){return Se(W)};var Xe,Je=V.__private__.padd2=function(W){return("0"+parseInt(W)).slice(-2)},_t=V.__private__.padd2Hex=function(W){return("00"+(W=W.toString())).substr(W.length)},Nt=0,jt=[],en=[],sn=0,bi=[],di=[],Yi=!1,Ji=en;V.__private__.setCustomOutputDestination=function(W){Yi=!0,Ji=W};var Fn=function(W){Yi||(Ji=W)};V.__private__.resetCustomOutputDestination=function(){Yi=!1,Ji=en};var at=V.__private__.out=function(W){return W=W.toString(),sn+=W.length+1,Ji.push(W),Ji},Rs=V.__private__.write=function(W){return at(1===arguments.length?W.toString():Array.prototype.join.call(arguments," "))},yr=V.__private__.getArrayBuffer=function(W){for(var we=W.length,it=new ArrayBuffer(we),vt=new Uint8Array(it);we--;)vt[we]=W.charCodeAt(we);return it},mi=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];V.__private__.getStandardFonts=function(){return mi};var Ii=t.fontSize||16;V.__private__.setFontSize=V.setFontSize=function(W){return Ii="advanced"===Ne?W/er:W,this};var Qi,Vi=V.__private__.getFontSize=V.getFontSize=function(){return"compat"===Ne?Ii:Ii*er},Rr=t.R2L||!1;V.__private__.setR2L=V.setR2L=function(W){return Rr=W,this},V.__private__.getR2L=V.getR2L=function(){return Rr};var xs,zs=V.__private__.setZoomMode=function(W){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(W))Qi=W;else if(isNaN(W)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(W))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+W+'" is not recognized.');Qi=W}else Qi=parseInt(W,10)};V.__private__.getZoomMode=function(){return Qi};var io,Do=V.__private__.setPageMode=function(W){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(W))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+W+'" is not recognized.');xs=W};V.__private__.getPageMode=function(){return xs};var aa=V.__private__.setLayoutMode=function(W){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(W))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+W+'" is not recognized.');io=W};V.__private__.getLayoutMode=function(){return io},V.__private__.setDisplayMode=V.setDisplayMode=function(W,we,it){return zs(W),aa(we),Do(it),this};var Es={title:"",subject:"",author:"",keywords:"",creator:""};V.__private__.getDocumentProperty=function(W){if(-1===Object.keys(Es).indexOf(W))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Es[W]},V.__private__.getDocumentProperties=function(){return Es},V.__private__.setDocumentProperties=V.setProperties=V.setDocumentProperties=function(W){for(var we in Es)Es.hasOwnProperty(we)&&W[we]&&(Es[we]=W[we]);return this},V.__private__.setDocumentProperty=function(W,we){if(-1===Object.keys(Es).indexOf(W))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Es[W]=we};var yo,er,id,na,yg,qa={},Ll={},Gm=[],_a={},ob={},lc={},vg={},m0=null,cc=0,Vs=[],ya=new XH(V),ab=t.hotfixes||[],Sh={},$m={},qm=[],As=function W(we,it,vt,qt,Dn,fi){if(!(this instanceof W))return new W(we,it,vt,qt,Dn,fi);isNaN(we)&&(we=1),isNaN(it)&&(it=0),isNaN(vt)&&(vt=0),isNaN(qt)&&(qt=1),isNaN(Dn)&&(Dn=0),isNaN(fi)&&(fi=0),this._matrix=[we,it,vt,qt,Dn,fi]};Object.defineProperty(As.prototype,"sx",{get:function(){return this._matrix[0]},set:function(W){this._matrix[0]=W}}),Object.defineProperty(As.prototype,"shy",{get:function(){return this._matrix[1]},set:function(W){this._matrix[1]=W}}),Object.defineProperty(As.prototype,"shx",{get:function(){return this._matrix[2]},set:function(W){this._matrix[2]=W}}),Object.defineProperty(As.prototype,"sy",{get:function(){return this._matrix[3]},set:function(W){this._matrix[3]=W}}),Object.defineProperty(As.prototype,"tx",{get:function(){return this._matrix[4]},set:function(W){this._matrix[4]=W}}),Object.defineProperty(As.prototype,"ty",{get:function(){return this._matrix[5]},set:function(W){this._matrix[5]=W}}),Object.defineProperty(As.prototype,"a",{get:function(){return this._matrix[0]},set:function(W){this._matrix[0]=W}}),Object.defineProperty(As.prototype,"b",{get:function(){return this._matrix[1]},set:function(W){this._matrix[1]=W}}),Object.defineProperty(As.prototype,"c",{get:function(){return this._matrix[2]},set:function(W){this._matrix[2]=W}}),Object.defineProperty(As.prototype,"d",{get:function(){return this._matrix[3]},set:function(W){this._matrix[3]=W}}),Object.defineProperty(As.prototype,"e",{get:function(){return this._matrix[4]},set:function(W){this._matrix[4]=W}}),Object.defineProperty(As.prototype,"f",{get:function(){return this._matrix[5]},set:function(W){this._matrix[5]=W}}),Object.defineProperty(As.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(As.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(As.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(As.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),As.prototype.join=function(W){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(yt).join(W)},As.prototype.multiply=function(W){return new As(W.sx*this.sx+W.shy*this.shx,W.sx*this.shy+W.shy*this.sy,W.shx*this.sx+W.sy*this.shx,W.shx*this.shy+W.sy*this.sy,W.tx*this.sx+W.ty*this.shx+this.tx,W.tx*this.shy+W.ty*this.sy+this.ty)},As.prototype.decompose=function(){var W=this.sx,we=this.shy,it=this.shx,vt=this.sy,qt=this.tx,Dn=this.ty,fi=Math.sqrt(W*W+we*we),nr=(W/=fi)*it+(we/=fi)*vt;it-=W*nr,vt-=we*nr;var $r=Math.sqrt(it*it+vt*vt);return nr/=$r,W*(vt/=$r)<we*(it/=$r)&&(W=-W,we=-we,nr=-nr,fi=-fi),{scale:new As(fi,0,0,$r,0,0),translate:new As(1,0,0,1,qt,Dn),rotate:new As(W,we,-we,W,0,0),skew:new As(1,0,nr,1,0,0)}},As.prototype.toString=function(W){return this.join(" ")},As.prototype.inversed=function(){var W=this.sx,we=this.shy,it=this.shx,vt=this.sy,qt=this.tx,Dn=this.ty,fi=1/(W*vt-we*it),nr=vt*fi,$r=-we*fi,js=-it*fi,co=W*fi;return new As(nr,$r,js,co,-nr*qt-js*Dn,-$r*qt-co*Dn)},As.prototype.applyToPoint=function(W){return new sC(W.x*this.sx+W.y*this.shx+this.tx,W.x*this.shy+W.y*this.sy+this.ty)},As.prototype.applyToRectangle=function(W){var we=this.applyToPoint(W),it=this.applyToPoint(new sC(W.x+W.w,W.y+W.h));return new BS(we.x,we.y,it.x-we.x,it.y-we.y)},As.prototype.clone=function(){return new As(this.sx,this.shy,this.shx,this.sy,this.tx,this.ty)},V.Matrix=As;var bg=V.matrixMult=function(W,we){return we.multiply(W)},Km=new As(1,0,0,1,0,0);V.unitMatrix=V.identityMatrix=Km;var vf=function(W,we){if(!ob[W]){var it=(we instanceof J1?"Sh":"P")+(Object.keys(_a).length+1).toString(10);we.id=it,ob[W]=it,_a[it]=we,ya.publish("addPattern",we)}};V.ShadingPattern=J1,V.TilingPattern=Lx,V.addShadingPattern=function(W,we){return Ye("addShadingPattern()"),vf(W,we),this},V.beginTilingPattern=function(W){Ye("beginTilingPattern()"),YM(W.boundingBox[0],W.boundingBox[1],W.boundingBox[2]-W.boundingBox[0],W.boundingBox[3]-W.boundingBox[1],W.matrix)},V.endTilingPattern=function(W,we){Ye("endTilingPattern()"),we.stream=di[Xe].join("\n"),vf(W,we),ya.publish("endTilingPattern",we),qm.pop().restore()};var W,wu=V.__private__.newObject=function(){var W=eu();return vA(W,!0),W},eu=V.__private__.newObjectDeferred=function(){return Nt++,jt[Nt]=function(){return sn},Nt},vA=function(W,we){return we="boolean"==typeof we&&we,jt[W]=sn,we&&at(W+" 0 obj"),W},$x=V.__private__.newAdditionalObject=function(){var W={objId:eu(),content:""};return bi.push(W),W},_0=eu(),wg=eu(),xg=V.__private__.decodeColorString=function(W){var we=W.split(" ");if(2!==we.length||"g"!==we[1]&&"G"!==we[1])5===we.length&&("k"===we[4]||"K"===we[4])&&(we=[(1-we[0])*(1-we[3]),(1-we[1])*(1-we[3]),(1-we[2])*(1-we[3]),"r"]);else{var it=parseFloat(we[0]);we=[it,it,it,"r"]}for(var vt="#",qt=0;qt<3;qt++)vt+=("0"+Math.floor(255*parseFloat(we[qt])).toString(16)).slice(-2);return vt},Cg=V.__private__.encodeColorString=function(W){var we;"string"==typeof W&&(W={ch1:W});var it=W.ch1,vt=W.ch2,qt=W.ch3,Dn=W.ch4,fi="draw"===W.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof it&&"#"!==it.charAt(0)){var nr=new qH(it);if(nr.ok)it=nr.toHex();else if(!/^\d*\.?\d*$/.test(it))throw new Error('Invalid color "'+it+'" passed to jsPDF.encodeColorString.')}if("string"==typeof it&&/^#[0-9A-Fa-f]{3}$/.test(it)&&(it="#"+it[1]+it[1]+it[2]+it[2]+it[3]+it[3]),"string"==typeof it&&/^#[0-9A-Fa-f]{6}$/.test(it)){var $r=parseInt(it.substr(1),16);it=$r>>16&255,vt=$r>>8&255,qt=255&$r}if(void 0===vt||void 0===Dn&&it===vt&&vt===qt)we="string"==typeof it?it+" "+fi[0]:2===W.precision?hn(it/255)+" "+fi[0]:Ue(it/255)+" "+fi[0];else if(void 0===Dn||"object"===(0,Ga.Z)(Dn)){if(Dn&&!isNaN(Dn.a)&&0===Dn.a)return["1.","1.","1.",fi[1]].join(" ");we="string"==typeof it?[it,vt,qt,fi[1]].join(" "):2===W.precision?[hn(it/255),hn(vt/255),hn(qt/255),fi[1]].join(" "):[Ue(it/255),Ue(vt/255),Ue(qt/255),fi[1]].join(" ")}else we="string"==typeof it?[it,vt,qt,Dn,fi[2]].join(" "):2===W.precision?[hn(it),hn(vt),hn(qt),hn(Dn),fi[2]].join(" "):[Ue(it),Ue(vt),Ue(qt),Ue(Dn),fi[2]].join(" ");return we},Wm=V.__private__.getFilters=function(){return h},up=V.__private__.putStream=function(W){var we=(W=W||{}).data||"",it=W.filters||Wm(),vt=W.alreadyAppliedFilters||[],qt=W.addLength1||!1,Dn=we.length,fi=W.objectId,nr=function(sd){return sd};if(null!==M&&void 0===fi)throw new Error("ObjectId must be passed to putStream for file encryption");null!==M&&(nr=rd.encryptor(fi,0));var $r={};!0===it&&(it=["FlateEncode"]);var js=W.additionalKeyValues||[],co=($r=void 0!==fs.API.processDataByFilters?fs.API.processDataByFilters(we,it):{data:we,reverseChain:[]}).reverseChain+(Array.isArray(vt)?vt.join(" "):vt.toString());if(0!==$r.data.length&&(js.push({key:"Length",value:$r.data.length}),!0===qt&&js.push({key:"Length1",value:Dn})),0!=co.length)if(co.split("/").length-1==1)js.push({key:"Filter",value:co});else{js.push({key:"Filter",value:"["+co+"]"});for(var Go=0;Go<js.length;Go+=1)if("DecodeParms"===js[Go].key){for(var Jl=[],uc=0;uc<$r.reverseChain.split("/").length-1;uc+=1)Jl.push("null");Jl.push(js[Go].value),js[Go].value="["+Jl.join(" ")+"]"}}at("<<");for(var tu=0;tu<js.length;tu++)at("/"+js[tu].key+" "+js[tu].value);at(">>"),0!==$r.data.length&&(at("stream"),at(nr($r.data)),at("endstream"))},Zm=V.__private__.putPage=function(W){var we=W.number,it=W.data,vt=W.objId,qt=W.contentsObjId;vA(vt,!0),at("<</Type /Page"),at("/Parent "+W.rootDictionaryObjId+" 0 R"),at("/Resources "+W.resourceDictionaryObjId+" 0 R"),at("/MediaBox ["+parseFloat(yt(W.mediaBox.bottomLeftX))+" "+parseFloat(yt(W.mediaBox.bottomLeftY))+" "+yt(W.mediaBox.topRightX)+" "+yt(W.mediaBox.topRightY)+"]"),null!==W.cropBox&&at("/CropBox ["+yt(W.cropBox.bottomLeftX)+" "+yt(W.cropBox.bottomLeftY)+" "+yt(W.cropBox.topRightX)+" "+yt(W.cropBox.topRightY)+"]"),null!==W.bleedBox&&at("/BleedBox ["+yt(W.bleedBox.bottomLeftX)+" "+yt(W.bleedBox.bottomLeftY)+" "+yt(W.bleedBox.topRightX)+" "+yt(W.bleedBox.topRightY)+"]"),null!==W.trimBox&&at("/TrimBox ["+yt(W.trimBox.bottomLeftX)+" "+yt(W.trimBox.bottomLeftY)+" "+yt(W.trimBox.topRightX)+" "+yt(W.trimBox.topRightY)+"]"),null!==W.artBox&&at("/ArtBox ["+yt(W.artBox.bottomLeftX)+" "+yt(W.artBox.bottomLeftY)+" "+yt(W.artBox.topRightX)+" "+yt(W.artBox.topRightY)+"]"),"number"==typeof W.userUnit&&1!==W.userUnit&&at("/UserUnit "+W.userUnit),ya.publish("putPage",{objId:vt,pageContext:Vs[we],pageNumber:we,page:it}),at("/Contents "+qt+" 0 R"),at(">>"),at("endobj");var Dn=it.join("\n");return"advanced"===Ne&&(Dn+="\nQ"),vA(qt,!0),up({data:Dn,filters:Wm(),objectId:qt}),at("endobj"),vt},lb=V.__private__.putPages=function(){var W,we,it=[];for(W=1;W<=cc;W++)Vs[W].objId=eu(),Vs[W].contentsObjId=eu();for(W=1;W<=cc;W++)it.push(Zm({number:W,data:di[W],objId:Vs[W].objId,contentsObjId:Vs[W].contentsObjId,mediaBox:Vs[W].mediaBox,cropBox:Vs[W].cropBox,bleedBox:Vs[W].bleedBox,trimBox:Vs[W].trimBox,artBox:Vs[W].artBox,userUnit:Vs[W].userUnit,rootDictionaryObjId:_0,resourceDictionaryObjId:wg}));vA(_0,!0),at("<</Type /Pages");var vt="/Kids [";for(we=0;we<cc;we++)vt+=it[we]+" 0 R ";at(vt+"]"),at("/Count "+cc),at(">>"),at("endobj"),ya.publish("postPutPages")},qx=function(W){ya.publish("putFont",{font:W,out:at,newObject:wu,putStream:up}),!0!==W.isAlreadyPutted&&(W.objectNumber=wu(),at("<<"),at("/Type /Font"),at("/BaseFont /"+Nx(W.postScriptName)),at("/Subtype /Type1"),"string"==typeof W.encoding&&at("/Encoding /"+W.encoding),at("/FirstChar 32"),at("/LastChar 255"),at(">>"),at("endobj"))},Wx=function(W){W.objectNumber=wu();var we=[];we.push({key:"Type",value:"/XObject"}),we.push({key:"Subtype",value:"/Form"}),we.push({key:"BBox",value:"["+[yt(W.x),yt(W.y),yt(W.x+W.width),yt(W.y+W.height)].join(" ")+"]"}),we.push({key:"Matrix",value:"["+W.matrix.toString()+"]"});var it=W.pages[1].join("\n");up({data:it,additionalKeyValues:we,objectId:W.objectNumber}),at("endobj")},tN=function(W,we){we||(we=21);var it=wu(),vt=function(W,we){var it,vt=[],qt=1/(we-1);for(it=0;it<1;it+=qt)vt.push(it);vt.push(1),0!=W[0].offset&&W.unshift({offset:0,color:W[0].color}),1!=W[W.length-1].offset&&W.push({offset:1,color:W[W.length-1].color});for(var nr="",$r=0,js=0;js<vt.length;js++){for(it=vt[js];it>W[$r+1].offset;)$r++;var co=W[$r].offset,Go=(it-co)/(W[$r+1].offset-co),Jl=W[$r].color,uc=W[$r+1].color;nr+=_t(Math.round((1-Go)*Jl[0]+Go*uc[0]).toString(16))+_t(Math.round((1-Go)*Jl[1]+Go*uc[1]).toString(16))+_t(Math.round((1-Go)*Jl[2]+Go*uc[2]).toString(16))}return nr.trim()}(W.colors,we),qt=[];qt.push({key:"FunctionType",value:"0"}),qt.push({key:"Domain",value:"[0.0 1.0]"}),qt.push({key:"Size",value:"["+we+"]"}),qt.push({key:"BitsPerSample",value:"8"}),qt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),up({data:vt,additionalKeyValues:qt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:it}),at("endobj"),W.objectNumber=wu(),at("<< /ShadingType "+W.type),at("/ColorSpace /DeviceRGB");var Dn="/Coords ["+yt(parseFloat(W.coords[0]))+" "+yt(parseFloat(W.coords[1]))+" ";Dn+=2===W.type?yt(parseFloat(W.coords[2]))+" "+yt(parseFloat(W.coords[3])):yt(parseFloat(W.coords[2]))+" "+yt(parseFloat(W.coords[3]))+" "+yt(parseFloat(W.coords[4]))+" "+yt(parseFloat(W.coords[5])),at(Dn+="]"),W.matrix&&at("/Matrix ["+W.matrix.toString()+"]"),at("/Function "+it+" 0 R"),at("/Extend [true true]"),at(">>"),at("endobj")},nN=function(W,we){var it=eu(),vt=wu();we.push({resourcesOid:it,objectOid:vt}),W.objectNumber=vt;var qt=[];qt.push({key:"Type",value:"/Pattern"}),qt.push({key:"PatternType",value:"1"}),qt.push({key:"PaintType",value:"1"}),qt.push({key:"TilingType",value:"1"}),qt.push({key:"BBox",value:"["+W.boundingBox.map(yt).join(" ")+"]"}),qt.push({key:"XStep",value:yt(W.xStep)}),qt.push({key:"YStep",value:yt(W.yStep)}),qt.push({key:"Resources",value:it+" 0 R"}),W.matrix&&qt.push({key:"Matrix",value:"["+W.matrix.toString()+"]"}),up({data:W.stream,additionalKeyValues:qt,objectId:W.objectNumber}),at("endobj")},kM=function(W){for(var we in W.objectNumber=wu(),at("<<"),W)switch(we){case"opacity":at("/ca "+hn(W[we]));break;case"stroke-opacity":at("/CA "+hn(W[we]))}at(">>"),at("endobj")},Mc=function(W){vA(W.resourcesOid,!0),at("<<"),at("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var W in at("/Font <<"),qa)qa.hasOwnProperty(W)&&(!1===L||!0===L&&G.hasOwnProperty(W))&&at("/"+W+" "+qa[W].objectNumber+" 0 R");at(">>")}(),function(){if(Object.keys(_a).length>0){for(var W in at("/Shading <<"),_a)_a.hasOwnProperty(W)&&_a[W]instanceof J1&&_a[W].objectNumber>=0&&at("/"+W+" "+_a[W].objectNumber+" 0 R");ya.publish("putShadingPatternDict"),at(">>")}}(),function(W){if(Object.keys(_a).length>0){for(var we in at("/Pattern <<"),_a)_a.hasOwnProperty(we)&&_a[we]instanceof V.TilingPattern&&_a[we].objectNumber>=0&&_a[we].objectNumber<W&&at("/"+we+" "+_a[we].objectNumber+" 0 R");ya.publish("putTilingPatternDict"),at(">>")}}(W.objectOid),function(){if(Object.keys(lc).length>0){var W;for(W in at("/ExtGState <<"),lc)lc.hasOwnProperty(W)&&lc[W].objectNumber>=0&&at("/"+W+" "+lc[W].objectNumber+" 0 R");ya.publish("putGStateDict"),at(">>")}}(),function(){for(var W in at("/XObject <<"),Sh)Sh.hasOwnProperty(W)&&Sh[W].objectNumber>=0&&at("/"+W+" "+Sh[W].objectNumber+" 0 R");ya.publish("putXobjectDict"),at(">>")}(),at(">>"),at("endobj")},UM=function(W){Ll[W.fontName]=Ll[W.fontName]||{},Ll[W.fontName][W.fontStyle]=W.id},bS=function(W,we,it,vt,qt){var Dn={id:"F"+(Object.keys(qa).length+1).toString(10),postScriptName:W,fontName:we,fontStyle:it,encoding:vt,isStandardFont:qt||!1,metadata:{}};return ya.publish("addFont",{font:Dn,instance:this}),qa[Dn.id]=Dn,UM(Dn),Dn.id},bf=V.__private__.pdfEscape=V.pdfEscape=function(W,we){return function(W,we){var it,vt,qt,Dn,fi,nr,$r,js,co;if(qt=(we=we||{}).sourceEncoding||"Unicode",fi=we.outputEncoding,(we.autoencode||fi)&&qa[yo].metadata&&qa[yo].metadata[qt]&&qa[yo].metadata[qt].encoding&&(Dn=qa[yo].metadata[qt].encoding,!fi&&qa[yo].encoding&&(fi=qa[yo].encoding),!fi&&Dn.codePages&&(fi=Dn.codePages[0]),"string"==typeof fi&&(fi=Dn[fi]),fi)){for($r=!1,nr=[],it=0,vt=W.length;it<vt;it++)(js=fi[W.charCodeAt(it)])?nr.push(String.fromCharCode(js)):nr.push(W[it]),nr[it].charCodeAt(0)>>8&&($r=!0);W=nr.join("")}for(it=W.length;void 0===$r&&0!==it;)W.charCodeAt(it-1)>>8&&($r=!0),it--;if(!$r)return W;for(nr=we.noBOM?[]:[254,255],it=0,vt=W.length;it<vt;it++){if((co=(js=W.charCodeAt(it))>>8)>>8)throw new Error("Character at position "+it+" of string '"+W+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");nr.push(co),nr.push(js-(co<<8))}return String.fromCharCode.apply(void 0,nr)}(W,we).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},wS=V.__private__.beginPage=function(W){di[++cc]=[],Vs[cc]={objId:0,contentsObjId:0,userUnit:Number(m),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(W[0]),topRightY:Number(W[1])}},VM(cc),Fn(di[Xe])},zM=function(W,we){var it,vt,qt;switch(e=we||e,"string"==typeof W&&(it=fe(W.toLowerCase()),Array.isArray(it)&&(vt=it[0],qt=it[1])),Array.isArray(W)&&(vt=W[0]*er,qt=W[1]*er),isNaN(vt)&&(vt=s[0],qt=s[1]),(vt>14400||qt>14400)&&($a.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),vt=Math.min(14400,vt),qt=Math.min(14400,qt)),s=[vt,qt],e.substr(0,1)){case"l":qt>vt&&(s=[qt,vt]);break;case"p":vt>qt&&(s=[qt,vt])}wS(s),qM(SS),at(Sg),0!==IS&&at(IS+" J"),0!==DS&&at(DS+" j"),ya.publish("addPage",{pageNumber:cc})},lN=function(W){W>0&&W<=cc&&(di.splice(W,1),Vs.splice(W,1),cc--,Xe>cc&&(Xe=cc),this.setPage(Xe))},VM=function(W){W>0&&W<=cc&&(Xe=W)},cN=V.__private__.getNumberOfPages=V.getNumberOfPages=function(){return di.length-1},HM=function(W,we,it){var vt,qt=void 0;return it=it||{},we=void 0!==we?we:qa[yo].fontStyle,vt=(W=void 0!==W?W:qa[yo].fontName).toLowerCase(),void 0!==Ll[vt]&&void 0!==Ll[vt][we]?qt=Ll[vt][we]:void 0!==Ll[W]&&void 0!==Ll[W][we]?qt=Ll[W][we]:!1===it.disableWarning&&$a.warn("Unable to look up font label for font '"+W+"', '"+we+"'. Refer to getFontList() for available fonts."),qt||it.noFallback||null==(qt=Ll.times[we])&&(qt=Ll.times.normal),qt},uN=V.__private__.putInfo=function(){var W=wu(),we=function(vt){return vt};for(var it in null!==M&&(we=rd.encryptor(W,0)),at("<<"),at("/Producer ("+bf(we("jsPDF "+fs.version))+")"),Es)Es.hasOwnProperty(it)&&Es[it]&&at("/"+it.substr(0,1).toUpperCase()+it.substr(1)+" ("+bf(we(Es[it]))+")");at("/CreationDate ("+bf(we(_n))+")"),at(">>"),at("endobj")},xS=V.__private__.putCatalog=function(W){var we=(W=W||{}).rootDictionaryObjId||_0;switch(wu(),at("<<"),at("/Type /Catalog"),at("/Pages "+we+" 0 R"),Qi||(Qi="fullwidth"),Qi){case"fullwidth":at("/OpenAction [3 0 R /FitH null]");break;case"fullheight":at("/OpenAction [3 0 R /FitV null]");break;case"fullpage":at("/OpenAction [3 0 R /Fit]");break;case"original":at("/OpenAction [3 0 R /XYZ null null 1]");break;default:var it=""+Qi;"%"===it.substr(it.length-1)&&(Qi=parseInt(Qi)/100),"number"==typeof Qi&&at("/OpenAction [3 0 R /XYZ null null "+hn(Qi)+"]")}switch(io||(io="continuous"),io){case"continuous":at("/PageLayout /OneColumn");break;case"single":at("/PageLayout /SinglePage");break;case"two":case"twoleft":at("/PageLayout /TwoColumnLeft");break;case"tworight":at("/PageLayout /TwoColumnRight")}xs&&at("/PageMode /"+xs),ya.publish("putCatalog"),at(">>"),at("endobj")},hN=V.__private__.putTrailer=function(){at("trailer"),at("<<"),at("/Size "+(Nt+1)),at("/Root "+Nt+" 0 R"),at("/Info "+(Nt-1)+" 0 R"),null!==M&&at("/Encrypt "+rd.oid+" 0 R"),at("/ID [ <"+ft+"> <"+ft+"> ]"),at(">>")},dN=V.__private__.putHeader=function(){at("%PDF-"+ne),at("%\xba\xdf\xac\xe0")},fN=V.__private__.putXRef=function(){var W="0000000000";at("xref"),at("0 "+(Nt+1)),at("0000000000 65535 f ");for(var we=1;we<=Nt;we++)at("function"==typeof jt[we]?(W+jt[we]()).slice(-10)+" 00000 n ":void 0!==jt[we]?(W+jt[we]).slice(-10)+" 00000 n ":"0000000000 00000 n ")},y0=V.__private__.buildDocument=function(){Nt=0,sn=0,en=[],jt=[],bi=[],_0=eu(),wg=eu(),Fn(en),ya.publish("buildDocument"),dN(),lb(),function(){ya.publish("putAdditionalObjects");for(var W=0;W<bi.length;W++){var we=bi[W];vA(we.objId,!0),at(we.content),at("endobj")}ya.publish("postPutAdditionalObjects")}(),function(){var W=[];(function(){for(var W in qa)qa.hasOwnProperty(W)&&(!1===L||!0===L&&G.hasOwnProperty(W))&&qx(qa[W])})(),function(){var W;for(W in lc)lc.hasOwnProperty(W)&&kM(lc[W])}(),function(){for(var W in Sh)Sh.hasOwnProperty(W)&&Wx(Sh[W])}(),function(W){var we;for(we in _a)_a.hasOwnProperty(we)&&(_a[we]instanceof J1?tN(_a[we]):_a[we]instanceof Lx&&nN(_a[we],W))}(W),ya.publish("putResources"),W.forEach(Mc),Mc({resourcesOid:wg,objectOid:Number.MAX_SAFE_INTEGER}),ya.publish("postPutResources")}(),null!==M&&(rd.oid=wu(),at("<<"),at("/Filter /Standard"),at("/V "+rd.v),at("/R "+rd.r),at("/U <"+rd.toHexString(rd.U)+">"),at("/O <"+rd.toHexString(rd.O)+">"),at("/P "+rd.P),at(">>"),at("endobj")),uN(),xS();var W=sn;return fN(),hN(),at("startxref"),at(""+W),at("%%EOF"),Fn(di[Xe]),en.join("\n")},eC=V.__private__.getBlob=function(W){return new Blob([yr(W)],{type:"application/pdf"})},tC=V.output=V.__private__.output=((W=function(W,we){switch("string"==typeof(we=we||{})?we={filename:we}:we.filename=we.filename||"generated.pdf",W){case void 0:return y0();case"save":V.save(we.filename);break;case"arraybuffer":return yr(y0());case"blob":return eC(y0());case"bloburi":case"bloburl":if(void 0!==ms.URL&&"function"==typeof ms.URL.createObjectURL)return ms.URL&&ms.URL.createObjectURL(eC(y0()))||void 0;$a.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var it="",vt=y0();try{it=mP(vt)}catch{it=mP(unescape(encodeURIComponent(vt)))}return"data:application/pdf;filename="+we.filename+";base64,"+it;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(ms)){var qt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Dn=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';we.pdfObjectUrl&&(qt=we.pdfObjectUrl,Dn="");var fi='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+qt+'"'+Dn+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(we)+");<\/script></body></html>",nr=ms.open();return null!==nr&&nr.document.write(fi),nr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(ms)){var $r='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(we.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+we.filename+'" width="500px" height="400px" /></body></html>',js=ms.open();if(null!==js){js.document.write($r);var co=this;js.document.documentElement.querySelector("#pdfViewer").onload=function(){js.document.title=we.filename,js.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(co.output("bloburl"))}}return js}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(ms))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Go='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",we)+'"></iframe></body></html>',Jl=ms.open();if(null!==Jl&&(Jl.document.write(Go),Jl.document.title=we.filename),Jl||typeof safari>"u")return Jl;break;case"datauri":case"dataurl":return ms.document.location.href=this.output("datauristring",we);default:return null}}).foo=function(){try{return W.apply(this,arguments)}catch(vt){var we=vt.stack||"";~we.indexOf(" at ")&&(we=we.split(" at ")[1]);var it="Error in function "+we.split("\n")[0].split("<")[0]+": "+vt.message;if(!ms.console)throw new Error(it);ms.console.error(it,vt),ms.alert&&alert(it)}},W.foo.bar=W,W.foo),QM=function(W){return!0===Array.isArray(ab)&&ab.indexOf(W)>-1};switch(i){case"pt":er=1;break;case"mm":er=72/25.4;break;case"cm":er=72/2.54;break;case"in":er=72;break;case"px":er=1==QM("px_scaling")?.75:96/72;break;case"pc":case"em":er=12;break;case"ex":er=6;break;default:if("number"!=typeof i)throw new Error("Invalid unit: "+i);er=i}var rd=null;Ti(),wt();var jM=V.__private__.getPageInfo=V.getPageInfo=function(W){if(isNaN(W)||W%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Vs[W].objId,pageNumber:W,pageContext:Vs[W]}},Ns=V.__private__.getPageInfoByObjId=function(W){if(isNaN(W)||W%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var we in Vs)if(Vs[we].objId===W)break;return jM(we)},pN=V.__private__.getCurrentPageInfo=V.getCurrentPageInfo=function(){return{objId:Vs[Xe].objId,pageNumber:Xe,pageContext:Vs[Xe]}};V.addPage=function(){return zM.apply(this,arguments),this},V.setPage=function(){return VM.apply(this,arguments),Fn.call(this,di[Xe]),this},V.insertPage=function(W){return this.addPage(),this.movePage(Xe,W),this},V.movePage=function(W,we){var it,vt;if(W>we){it=di[W],vt=Vs[W];for(var qt=W;qt>we;qt--)di[qt]=di[qt-1],Vs[qt]=Vs[qt-1];di[we]=it,Vs[we]=vt,this.setPage(we)}else if(W<we){it=di[W],vt=Vs[W];for(var Dn=W;Dn<we;Dn++)di[Dn]=di[Dn+1],Vs[Dn]=Vs[Dn+1];di[we]=it,Vs[we]=vt,this.setPage(we)}return this},V.deletePage=function(){return lN.apply(this,arguments),this},V.__private__.text=V.text=function(W,we,it,vt,qt){var Dn,fi,nr,$r,js,co,Go,Jl,uc,tu=(vt=vt||{}).scope||this;if("number"==typeof W&&"number"==typeof we&&("string"==typeof it||Array.isArray(it))){var sd=it;it=we,we=W,W=sd}if(arguments[3]instanceof As?(Ye("The transform parameter of text() with a Matrix value"),uc=qt):(nr=arguments[4],$r=arguments[5],"object"===(0,Ga.Z)(Go=arguments[3])&&null!==Go||("string"==typeof nr&&($r=nr,nr=null),"string"==typeof Go&&($r=Go,Go=null),"number"==typeof Go&&(nr=Go,Go=null),vt={flags:Go,angle:nr,align:$r})),isNaN(we)||isNaN(it)||null==W)throw new Error("Invalid arguments passed to jsPDF.text");if(0===W.length)return tu;var Tg,Ku="",bA="number"==typeof vt.lineHeightFactor?vt.lineHeightFactor:ub,b0=tu.internal.scaleFactor;function JM(ol){return ol=ol.split("\t").join(Array(vt.TabLen||9).join(" ")),bf(ol,Go)}function OS(ol){for(var al,Fc=ol.concat(),xu=[],E0=Fc.length;E0--;)"string"==typeof(al=Fc.shift())?xu.push(al):Array.isArray(ol)&&(1===al.length||void 0===al[1]&&void 0===al[2])?xu.push(al[0]):xu.push([al[0],al[1],al[2]]);return xu}function kS(ol,al){var Fc;if("string"==typeof ol)Fc=al(ol)[0];else if(Array.isArray(ol)){for(var xu,E0,av=ol.concat(),pC=[],tF=av.length;tF--;)"string"==typeof(xu=av.shift())?pC.push(al(xu)[0]):Array.isArray(xu)&&"string"==typeof xu[0]&&(E0=al(xu[0],xu[1],xu[2]),pC.push([E0[0],E0[1],E0[2]]));Fc=pC}return Fc}var aC=!1,PS=!0;if("string"==typeof W)aC=!0;else if(Array.isArray(W)){var NS=W.concat();fi=[];for(var lC,wf=NS.length;wf--;)("string"!=typeof(lC=NS.shift())||Array.isArray(lC)&&"string"!=typeof lC[0])&&(PS=!1);aC=PS}if(!1===aC)throw new Error('Type of text must be string or Array. "'+W+'" is not recognized.');"string"==typeof W&&(W=W.match(/[\r?\n]/)?W.split(/\r\n|\r|\n/g):[W]);var cC=Ii/tu.internal.scaleFactor,uC=cC*(bA-1);switch(vt.baseline){case"bottom":it-=uC;break;case"top":it+=cC-uC;break;case"hanging":it+=cC-2*uC;break;case"middle":it+=cC/2-uC}if((co=vt.maxWidth||0)>0&&("string"==typeof W?W=tu.splitTextToSize(W,co):"[object Array]"===Object.prototype.toString.call(W)&&(W=W.reduce(function(ol,al){return ol.concat(tu.splitTextToSize(al,co))},[]))),ya.publish("preProcessText",Dn={text:W,x:we,y:it,options:vt,mutex:{pdfEscape:bf,activeFontKey:yo,fonts:qa,activeFontSize:Ii}}),W=Dn.text,nr=(vt=Dn.options).angle,uc instanceof As||!nr||"number"!=typeof nr)nr&&nr instanceof As&&(uc=nr);else{nr*=Math.PI/180,0===vt.rotationDirection&&(nr=-nr),"advanced"===Ne&&(nr=-nr);var hC=Math.cos(nr),LS=Math.sin(nr);uc=new As(hC,LS,-LS,hC,0,0)}"advanced"!==Ne||uc||(uc=Km),void 0!==(js=vt.charSpace||rC)&&(Ku+=yt(ze(js))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(Jl=vt.horizontalScale)&&(Ku+=yt(100*Jl)+" Tz\n");var xf=-1,EN=void 0!==vt.renderingMode?vt.renderingMode:vt.stroke,US=tu.internal.getCurrentPageInfo().pageContext;switch(EN){case 0:case!1:case"fill":xf=0;break;case 1:case!0:case"stroke":xf=1;break;case 2:case"fillThenStroke":xf=2;break;case 3:case"invisible":xf=3;break;case 4:case"fillAndAddForClipping":xf=4;break;case 5:case"strokeAndAddPathForClipping":xf=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":xf=6;break;case 7:case"addToPathForClipping":xf=7}-1!==xf?Ku+=xf+" Tr\n":-1!==(void 0!==US.usedRenderingMode?US.usedRenderingMode:-1)&&(Ku+="0 Tr\n"),-1!==xf&&(US.usedRenderingMode=xf),$r=vt.align||"left";var Ig,zS=Ii*bA,SN=tu.internal.pageSize.getWidth(),TN=qa[yo];js=vt.charSpace||rC,co=vt.maxWidth||0,Go=Object.assign({autoencode:!0,noBOM:!0},vt.flags);var iv=[];if("[object Array]"===Object.prototype.toString.call(W)){var hp;fi=OS(W),"left"!==$r&&(Ig=fi.map(function(ol){return tu.getStringUnitWidth(ol,{font:TN,charSpace:js,fontSize:Ii,doKerning:!1})*Ii/b0}));var Dg,rv=0;if("right"===$r){we-=Ig[0],W=[],wf=fi.length;for(var Ym=0;Ym<wf;Ym++)0===Ym?(Dg=v0(we),hp=ev(it)):(Dg=ze(rv-Ig[Ym]),hp=-zS),W.push([fi[Ym],Dg,hp]),rv=Ig[Ym]}else if("center"===$r){we-=Ig[0]/2,W=[],wf=fi.length;for(var w0=0;w0<wf;w0++)0===w0?(Dg=v0(we),hp=ev(it)):(Dg=ze((rv-Ig[w0])/2),hp=-zS),W.push([fi[w0],Dg,hp]),rv=Ig[w0]}else if("left"===$r){W=[],wf=fi.length;for(var dC=0;dC<wf;dC++)W.push(fi[dC])}else{if("justify"!==$r)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');W=[],wf=fi.length,co=0!==co?co:SN;for(var Bg=0;Bg<wf;Bg++)hp=0===Bg?ev(it):-zS,Dg=0===Bg?v0(we):0,iv.push(Bg<wf-1?yt(ze((co-Ig[Bg])/(fi[Bg].split(" ").length-1))):0),W.push([fi[Bg],Dg,hp])}}!0===("boolean"==typeof vt.R2L?vt.R2L:Rr)&&(W=kS(W,function(ol,al,Fc){return[ol.split("").reverse().join(""),al,Fc]})),ya.publish("postProcessText",Dn={text:W,x:we,y:it,options:vt,mutex:{pdfEscape:bf,activeFontKey:yo,fonts:qa,activeFontSize:Ii}}),W=Dn.text,Tg=Dn.mutex.isHex||!1;var VS=qa[yo].encoding;"WinAnsiEncoding"!==VS&&"StandardEncoding"!==VS||(W=kS(W,function(ol,al,Fc){return[JM(ol),al,Fc]})),fi=OS(W),W=[];for(var sv,Mg,x0,Ab=Array.isArray(fi[0])?1:0,ov="",HS=function(ol,al,Fc){var xu="";return Fc instanceof As?(Fc="number"==typeof vt.angle?bg(Fc,new As(1,0,0,1,ol,al)):bg(new As(1,0,0,1,ol,al),Fc),"advanced"===Ne&&(Fc=bg(new As(1,0,0,-1,0,0),Fc)),xu=Fc.join(" ")+" Tm\n"):xu=yt(ol)+" "+yt(al)+" Td\n",xu},dp=0;dp<fi.length;dp++){switch(ov="",Ab){case 1:x0=(Tg?"<":"(")+fi[dp][0]+(Tg?">":")"),sv=parseFloat(fi[dp][1]),Mg=parseFloat(fi[dp][2]);break;case 0:x0=(Tg?"<":"(")+fi[dp]+(Tg?">":")"),sv=v0(we),Mg=ev(it)}void 0!==iv&&void 0!==iv[dp]&&(ov=iv[dp]+" Tw\n"),0===dp?W.push(ov+HS(sv,Mg,uc)+x0):0===Ab?W.push(ov+x0):1===Ab&&W.push(ov+HS(sv,Mg,uc)+x0)}W=W.join(0===Ab?" Tj\nT* ":" Tj\n"),W+=" Tj\n";var C0="BT\n/";return C0+=yo+" "+Ii+" Tf\n",C0+=yt(Ii*bA)+" TL\n",C0+=hb+"\n",C0+=Ku,C0+=W,at(C0+="ET"),G[yo]=!0,tu};var gN=V.__private__.clip=V.clip=function(W){return at("evenodd"===W?"W*":"W"),this};V.clipEvenOdd=function(){return gN("evenodd")},V.__private__.discardPath=V.discardPath=function(){return at("n"),this};var Xm=V.__private__.isValidStyle=function(W){var we=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(W)&&(we=!0),we};V.__private__.setDefaultPathOperation=V.setDefaultPathOperation=function(W){return Xm(W)&&(E=W),this};var GM=V.__private__.getStyle=V.getStyle=function(W){var we=E;switch(W){case"D":case"S":we="S";break;case"F":we="f";break;case"FD":case"DF":we="B";break;case"f":case"f*":case"B":case"B*":we=W}return we},$M=V.close=function(){return at("h"),this};V.stroke=function(){return at("S"),this},V.fill=function(W){return nC("f",W),this},V.fillEvenOdd=function(W){return nC("f*",W),this},V.fillStroke=function(W){return nC("B",W),this},V.fillStrokeEvenOdd=function(W){return nC("B*",W),this};var nC=function(W,we){"object"===(0,Ga.Z)(we)?_N(we,W):at(W)},CS=function(W){null===W||"advanced"===Ne&&void 0===W||(W=GM(W),at(W))};function mN(W,we,it,vt,qt){var Dn=new Lx(we||this.boundingBox,it||this.xStep,vt||this.yStep,this.gState,qt||this.matrix);Dn.stream=this.stream;var fi=W+"$$"+this.cloneIndex+++"$$";return vf(fi,Dn),Dn}var _N=function(W,we){var it=ob[W.key],vt=_a[it];if(vt instanceof J1)at("q"),at(yN(we)),vt.gState&&V.setGState(vt.gState),at(W.matrix.toString()+" cm"),at("/"+it+" sh"),at("Q");else if(vt instanceof Lx){var qt=new As(1,0,0,-1,0,nv());W.matrix&&(qt=qt.multiply(W.matrix||Km),it=mN.call(vt,W.key,W.boundingBox,W.xStep,W.yStep,qt).id),at("q"),at("/Pattern cs"),at("/"+it+" scn"),vt.gState&&V.setGState(vt.gState),at(we),at("Q")}},yN=function(W){switch(W){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},ES=V.moveTo=function(W,we){return at(yt(ze(W))+" "+yt(lt(we))+" m"),this},cb=V.lineTo=function(W,we){return at(yt(ze(W))+" "+yt(lt(we))+" l"),this},Jy=V.curveTo=function(W,we,it,vt,qt,Dn){return at([yt(ze(W)),yt(lt(we)),yt(ze(it)),yt(lt(vt)),yt(ze(qt)),yt(lt(Dn)),"c"].join(" ")),this};V.__private__.line=V.line=function(W,we,it,vt,qt){if(isNaN(W)||isNaN(we)||isNaN(it)||isNaN(vt)||!Xm(qt))throw new Error("Invalid arguments passed to jsPDF.line");return"compat"===Ne?this.lines([[it-W,vt-we]],W,we,[1,1],qt||"S"):this.lines([[it-W,vt-we]],W,we,[1,1]).stroke()},V.__private__.lines=V.lines=function(W,we,it,vt,qt,Dn){var fi,nr,$r,js,co,sd,Ku,Tg;if("number"==typeof W&&(Tg=it,it=we,we=W,W=Tg),vt=vt||[1,1],Dn=Dn||!1,isNaN(we)||isNaN(it)||!Array.isArray(W)||!Array.isArray(vt)||!Xm(qt)||"boolean"!=typeof Dn)throw new Error("Invalid arguments passed to jsPDF.lines");for(ES(we,it),fi=vt[0],nr=vt[1],js=W.length,sd=we,Ku=it,$r=0;$r<js;$r++)2===(co=W[$r]).length?cb(sd=co[0]*fi+sd,Ku=co[1]*nr+Ku):Jy(co[0]*fi+sd,co[1]*nr+Ku,co[2]*fi+sd,co[3]*nr+Ku,sd=co[4]*fi+sd,Ku=co[5]*nr+Ku);return Dn&&$M(),CS(qt),this},V.path=function(W){for(var we=0;we<W.length;we++){var it=W[we],vt=it.c;switch(it.op){case"m":ES(vt[0],vt[1]);break;case"l":cb(vt[0],vt[1]);break;case"c":Jy.apply(this,vt);break;case"h":$M()}}return this},V.__private__.rect=V.rect=function(W,we,it,vt,qt){if(isNaN(W)||isNaN(we)||isNaN(it)||isNaN(vt)||!Xm(qt))throw new Error("Invalid arguments passed to jsPDF.rect");return"compat"===Ne&&(vt=-vt),at([yt(ze(W)),yt(lt(we)),yt(ze(it)),yt(ze(vt)),"re"].join(" ")),CS(qt),this},V.__private__.triangle=V.triangle=function(W,we,it,vt,qt,Dn,fi){if(isNaN(W)||isNaN(we)||isNaN(it)||isNaN(vt)||isNaN(qt)||isNaN(Dn)||!Xm(fi))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[it-W,vt-we],[qt-it,Dn-vt],[W-qt,we-Dn]],W,we,[1,1],fi,!0),this},V.__private__.roundedRect=V.roundedRect=function(W,we,it,vt,qt,Dn,fi){if(isNaN(W)||isNaN(we)||isNaN(it)||isNaN(vt)||isNaN(qt)||isNaN(Dn)||!Xm(fi))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var nr=4/3*(Math.SQRT2-1);return qt=Math.min(qt,.5*it),Dn=Math.min(Dn,.5*vt),this.lines([[it-2*qt,0],[qt*nr,0,qt,Dn-Dn*nr,qt,Dn],[0,vt-2*Dn],[0,Dn*nr,-qt*nr,Dn,-qt,Dn],[2*qt-it,0],[-qt*nr,0,-qt,-Dn*nr,-qt,-Dn],[0,2*Dn-vt],[0,-Dn*nr,qt*nr,-Dn,qt,-Dn]],W+qt,we,[1,1],fi,!0),this},V.__private__.ellipse=V.ellipse=function(W,we,it,vt,qt){if(isNaN(W)||isNaN(we)||isNaN(it)||isNaN(vt)||!Xm(qt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Dn=4/3*(Math.SQRT2-1)*it,fi=4/3*(Math.SQRT2-1)*vt;return ES(W+it,we),Jy(W+it,we-fi,W+Dn,we-vt,W,we-vt),Jy(W-Dn,we-vt,W-it,we-fi,W-it,we),Jy(W-it,we+fi,W-Dn,we+vt,W,we+vt),Jy(W+Dn,we+vt,W+it,we+fi,W+it,we),CS(qt),this},V.__private__.circle=V.circle=function(W,we,it,vt){if(isNaN(W)||isNaN(we)||isNaN(it)||!Xm(vt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(W,we,it,it,vt)},V.setFont=function(W,we,it){return it&&(we=Qt(we,it)),yo=HM(W,we,{disableWarning:!1}),this};var vN=V.__private__.getFont=V.getFont=function(){return qa[HM.apply(V,arguments)]};V.__private__.getFontList=V.getFontList=function(){var W,we,it={};for(W in Ll)if(Ll.hasOwnProperty(W))for(we in it[W]=[],Ll[W])Ll[W].hasOwnProperty(we)&&it[W].push(we);return it},V.addFont=function(W,we,it,vt,qt){var Dn=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==Dn.indexOf(arguments[3])?qt=arguments[3]:arguments[3]&&-1==Dn.indexOf(arguments[3])&&(it=Qt(it,vt)),bS.call(this,W,we,it,qt=qt||"Identity-H")};var ub,SS=t.lineWidth||.200025,iC=V.__private__.getLineWidth=V.getLineWidth=function(){return SS},qM=V.__private__.setLineWidth=V.setLineWidth=function(W){return SS=W,at(yt(ze(W))+" w"),this};V.__private__.setLineDash=fs.API.setLineDash=fs.API.setLineDashPattern=function(W,we){if(W=W||[],we=we||0,isNaN(we)||!Array.isArray(W))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return W=W.map(function(it){return yt(ze(it))}).join(" "),we=yt(ze(we)),at("["+W+"] "+we+" d"),this};var KM=V.__private__.getLineHeight=V.getLineHeight=function(){return Ii*ub};V.__private__.getLineHeight=V.getLineHeight=function(){return Ii*ub};var WM=V.__private__.setLineHeightFactor=V.setLineHeightFactor=function(W){return"number"==typeof(W=W||1.15)&&(ub=W),this},ZM=V.__private__.getLineHeightFactor=V.getLineHeightFactor=function(){return ub};WM(t.lineHeight);var v0=V.__private__.getHorizontalCoordinate=function(W){return ze(W)},ev=V.__private__.getVerticalCoordinate=function(W){return"advanced"===Ne?W:Vs[Xe].mediaBox.topRightY-Vs[Xe].mediaBox.bottomLeftY-ze(W)},bN=V.__private__.getHorizontalCoordinateString=V.getHorizontalCoordinateString=function(W){return yt(v0(W))},tv=V.__private__.getVerticalCoordinateString=V.getVerticalCoordinateString=function(W){return yt(ev(W))},Sg=t.strokeColor||"0 G";V.__private__.getStrokeColor=V.getDrawColor=function(){return xg(Sg)},V.__private__.setStrokeColor=V.setDrawColor=function(W,we,it,vt){return Sg=Cg({ch1:W,ch2:we,ch3:it,ch4:vt,pdfColorType:"draw",precision:2}),at(Sg),this};var TS=t.fillColor||"0 g";V.__private__.getFillColor=V.getFillColor=function(){return xg(TS)},V.__private__.setFillColor=V.setFillColor=function(W,we,it,vt){return TS=Cg({ch1:W,ch2:we,ch3:it,ch4:vt,pdfColorType:"fill",precision:2}),at(TS),this};var hb=t.textColor||"0 g",wN=V.__private__.getTextColor=V.getTextColor=function(){return xg(hb)};V.__private__.setTextColor=V.setTextColor=function(W,we,it,vt){return hb=Cg({ch1:W,ch2:we,ch3:it,ch4:vt,pdfColorType:"text",precision:3}),this};var rC=t.charSpace,xN=V.__private__.getCharSpace=V.getCharSpace=function(){return parseFloat(rC||0)};V.__private__.setCharSpace=V.setCharSpace=function(W){if(isNaN(W))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return rC=W,this};var IS=0;V.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},V.__private__.setLineCap=V.setLineCap=function(W){var we=V.CapJoinStyles[W];if(void 0===we)throw new Error("Line cap style of '"+W+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return IS=we,at(we+" J"),this};var DS=0;V.__private__.setLineJoin=V.setLineJoin=function(W){var we=V.CapJoinStyles[W];if(void 0===we)throw new Error("Line join style of '"+W+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return DS=we,at(we+" j"),this},V.__private__.setLineMiterLimit=V.__private__.setMiterLimit=V.setLineMiterLimit=V.setMiterLimit=function(W){if(W=W||0,isNaN(W))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return at(yt(ze(W))+" M"),this},V.GState=cM,V.setGState=function(W){(W="string"==typeof W?lc[vg[W]]:XM(null,W)).equals(m0)||(at("/"+W.id+" gs"),m0=W)};var XM=function(W,we){if(!W||!vg[W]){var it=!1;for(var vt in lc)if(lc.hasOwnProperty(vt)&&lc[vt].equals(we)){it=!0;break}if(it)we=lc[vt];else{var qt="GS"+(Object.keys(lc).length+1).toString(10);lc[qt]=we,we.id=qt}return W&&(vg[W]=we.id),ya.publish("addGState",we),we}};V.addGState=function(W,we){return XM(W,we),this},V.saveGraphicsState=function(){return at("q"),Gm.push({key:yo,size:Ii,color:hb}),this},V.restoreGraphicsState=function(){at("Q");var W=Gm.pop();return yo=W.key,Ii=W.size,hb=W.color,m0=null,this},V.setCurrentTransformationMatrix=function(W){return at(W.toString()+" cm"),this},V.comment=function(W){return at("#"+W),this};var sC=function(W,we){var it=W||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return it},set:function(Dn){isNaN(Dn)||(it=parseFloat(Dn))}});var vt=we||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return vt},set:function(Dn){isNaN(Dn)||(vt=parseFloat(Dn))}});var qt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return qt},set:function(Dn){qt=Dn.toString()}}),this},BS=function(W,we,it,vt){sC.call(this,W,we),this.type="rect";var qt=it||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return qt},set:function(fi){isNaN(fi)||(qt=parseFloat(fi))}});var Dn=vt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Dn},set:function(fi){isNaN(fi)||(Dn=parseFloat(fi))}}),this},MS=function(){this.page=cc,this.currentPage=Xe,this.pages=di.slice(0),this.pagesContext=Vs.slice(0),this.x=id,this.y=na,this.matrix=yg,this.width=db(Xe),this.height=nv(Xe),this.outputDestination=Ji,this.id="",this.objectNumber=-1};MS.prototype.restore=function(){cc=this.page,Vs=this.pagesContext,di=this.pages,id=this.x,na=this.y,yg=this.matrix,FS(Xe=this.currentPage,this.width),RS(Xe,this.height),Ji=this.outputDestination};var YM=function(W,we,it,vt,qt){qm.push(new MS),cc=Xe=0,di=[],id=W,na=we,yg=qt,wS([it,vt])};for(var oC in V.beginFormObject=function(W,we,it,vt,qt){return YM(W,we,it,vt,qt),this},V.endFormObject=function(W){return function(W){if($m[W])qm.pop().restore();else{var we=new MS,it="Xo"+(Object.keys(Sh).length+1).toString(10);we.id=it,$m[W]=it,Sh[it]=we,ya.publish("addFormObject",we),qm.pop().restore()}}(W),this},V.doFormObject=function(W,we){var it=Sh[$m[W]];return at("q"),at(we.toString()+" cm"),at("/"+it.id+" Do"),at("Q"),this},V.getFormObject=function(W){var we=Sh[$m[W]];return{x:we.x,y:we.y,width:we.width,height:we.height,matrix:we.matrix}},V.save=function(W,we){return W=W||"generated.pdf",(we=we||{}).returnPromise=we.returnPromise||!1,!1===we.returnPromise?(Y1(eC(y0()),W),"function"==typeof Y1.unload&&ms.setTimeout&&setTimeout(Y1.unload,911),this):new Promise(function(it,vt){try{var qt=Y1(eC(y0()),W);"function"==typeof Y1.unload&&ms.setTimeout&&setTimeout(Y1.unload,911),it(qt)}catch(Dn){vt(Dn.message)}})},fs.API)fs.API.hasOwnProperty(oC)&&("events"===oC&&fs.API.events.length?function(W,we){var vt,qt;for(qt=we.length-1;-1!==qt;qt--)W.subscribe.apply(W,[we[qt][0]].concat("function"==typeof(vt=we[qt][1])?[vt]:vt))}(ya,fs.API.events):V[oC]=fs.API[oC]);var db=V.getPageWidth=function(W){return(Vs[W=W||Xe].mediaBox.topRightX-Vs[W].mediaBox.bottomLeftX)/er},FS=V.setPageWidth=function(W,we){Vs[W].mediaBox.topRightX=we*er+Vs[W].mediaBox.bottomLeftX},nv=V.getPageHeight=function(W){return(Vs[W=W||Xe].mediaBox.topRightY-Vs[W].mediaBox.bottomLeftY)/er},RS=V.setPageHeight=function(W,we){Vs[W].mediaBox.topRightY=we*er+Vs[W].mediaBox.bottomLeftY};return V.internal={pdfEscape:bf,getStyle:GM,getFont:vN,getFontSize:Vi,getCharSpace:xN,getTextColor:wN,getLineHeight:KM,getLineHeightFactor:ZM,getLineWidth:iC,write:Rs,getHorizontalCoordinate:v0,getVerticalCoordinate:ev,getCoordinateString:bN,getVerticalCoordinateString:tv,collections:{},newObject:wu,newAdditionalObject:$x,newObjectDeferred:eu,newObjectDeferredBegin:vA,getFilters:Wm,putStream:up,events:ya,scaleFactor:er,pageSize:{getWidth:function(){return db(Xe)},setWidth:function(W){FS(Xe,W)},getHeight:function(){return nv(Xe)},setHeight:function(W){RS(Xe,W)}},encryptionOptions:M,encryption:rd,getEncryptor:function(W){return null!==M?rd.encryptor(W,0):function(we){return we}},output:tC,getNumberOfPages:cN,pages:di,out:at,f2:hn,f3:Ue,getPageInfo:jM,getPageInfoByObjId:Ns,getCurrentPageInfo:pN,getPDFVersion:re,Point:sC,Rectangle:BS,Matrix:As,hasHotfix:QM},Object.defineProperty(V.internal.pageSize,"width",{get:function(){return db(Xe)},set:function(W){FS(Xe,W)},enumerable:!0,configurable:!0}),Object.defineProperty(V.internal.pageSize,"height",{get:function(){return nv(Xe)},set:function(W){RS(Xe,W)},enumerable:!0,configurable:!0}),function(W){for(var we=0,it=mi.length;we<it;we++){var vt=bS.call(this,W[we][0],W[we][1],W[we][2],mi[we][3],!0);!1===L&&(G[vt]=!0);var qt=W[we][0].split("-");UM({id:vt,fontName:qt[0],fontStyle:qt[1]||""})}ya.publish("addFonts",{fonts:qa,dictionary:Ll})}.call(V,mi),yo="F1",zM(s,e),ya.publish("initialized"),V}Px.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},Px.prototype.toHexString=function(t){return t.split("").map(function(n){return("0"+(255&n.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Px.prototype.hexToBytes=function(t){for(var n=[],e=0;e<t.length;e+=2)n.push(String.fromCharCode(parseInt(t.substr(e,2),16)));return n.join("")},Px.prototype.processOwnerPassword=function(t,n){return vP(yP(n).substr(0,5),t)},Px.prototype.encryptor=function(t,n){var e=yP(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&n,n>>8&255)).substr(0,10);return function(i){return vP(e,i)}},cM.prototype.equals=function(t){var n,e="id,objectNumber,equals";if(!t||(0,Ga.Z)(t)!==(0,Ga.Z)(this))return!1;var i=0;for(n in this)if(!(e.indexOf(n)>=0)){if(this.hasOwnProperty(n)&&!t.hasOwnProperty(n)||this[n]!==t[n])return!1;i++}for(n in t)t.hasOwnProperty(n)&&e.indexOf(n)<0&&i--;return 0===i},fs.API={events:[]},fs.version="2.5.1";var ac=fs.API,bP=1,eb=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ux=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Us=function(t){return t.toFixed(2)},Ky=function(t){return t.toFixed(5)};ac.__acroform__={};var yf=function(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t},JH=function(t){return t*bP},Vm=function(t){var n=new tQ,e=pr.internal.getHeight(t)||0,i=pr.internal.getWidth(t)||0;return n.BBox=[0,0,Number(Us(i)),Number(Us(e))],n},qoe=ac.__acroform__.setBit=function(t,n){if(t=t||0,n=n||0,isNaN(t)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<n},Koe=ac.__acroform__.clearBit=function(t,n){if(t=t||0,n=n||0,isNaN(t)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<n)},Woe=ac.__acroform__.getBit=function(t,n){if(isNaN(t)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<n?1:0},Ic=ac.__acroform__.getBitForPdf=function(t,n){if(isNaN(t)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Woe(t,n-1)},Dc=ac.__acroform__.setBitForPdf=function(t,n){if(isNaN(t)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return qoe(t,n-1)},Bc=ac.__acroform__.clearBitForPdf=function(t,n){if(isNaN(t)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Koe(t,n-1)},Zoe=ac.__acroform__.calculateCoordinates=function(t,n){var e=n.internal.getHorizontalCoordinate,i=n.internal.getVerticalCoordinate,s=t[0],l=t[1],h=t[2],m=t[3],b={};return b.lowerLeft_X=e(s)||0,b.lowerLeft_Y=i(l+m)||0,b.upperRight_X=e(s+h)||0,b.upperRight_Y=i(l)||0,[Number(Us(b.lowerLeft_X)),Number(Us(b.lowerLeft_Y)),Number(Us(b.upperRight_X)),Number(Us(b.upperRight_Y))]},Xoe=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var n=[],i=wP(t,t._V||t.DV),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;n.push("/Tx BMC"),n.push("q"),n.push("BT"),n.push(t.scope.__private__.encodeColorString(t.color)),n.push("/"+s+" "+Us(i.fontSize)+" Tf"),n.push("1 0 0 1 0 0 Tm"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC");var l=Vm(t);return l.scope=t.scope,l.stream=n.join("\n"),l}},wP=function(t,n){var e=0===t.fontSize?t.maxFontSize:t.fontSize,i={text:"",fontSize:""},s=(n=")"==(n="("==n.substr(0,1)?n.substr(1):n).substr(n.length-1)?n.substr(0,n.length-1):n).split(" ");s=s.map(t.multiline?function(Ue){return Ue.split("\n")}:function(Ue){return[Ue]});var l=e,h=pr.internal.getHeight(t)||0;h=h<0?-h:h;var Ue,m=pr.internal.getWidth(t)||0;m=m<0?-m:m,l++;e:for(;l>0;){n="",l--;var E,M,L=uM("3",t,l).height,G=t.multiline?h-l:(h-L)/2,V=G+=2,ne=0,re=0,de=0;if(l<=0){n="(...) Tj\n",n+="% Width of Text: "+uM(n,t,l=12).width+", FieldWidth:"+m+"\n";break}for(var fe="",he=0,Ne=0;Ne<s.length;Ne++)if(s.hasOwnProperty(Ne)){var We=!1;if(1!==s[Ne].length&&de!==s[Ne].length-1){if((L+2)*(he+2)+2>h)continue e;fe+=s[Ne][de],We=!0,re=Ne,Ne--}else{fe=" "==(fe+=s[Ne][de]+" ").substr(fe.length-1)?fe.substr(0,fe.length-1):fe;var pt=parseInt(Ne),Qt=(Ue=pt)+1<s.length&&uM(fe+" "+s[Ue+1][0],t,l).width<=m-4,yt=Ne>=s.length-1;if(Qt&&!yt){fe+=" ",de=0;continue}if(Qt||yt){if(yt)re=pt;else if(t.multiline&&(L+2)*(he+2)+2>h)continue e}else{if(!t.multiline||(L+2)*(he+2)+2>h)continue e;re=pt}}for(var Ye="",un=ne;un<=re;un++){var hn=s[un];if(t.multiline){if(un===re){Ye+=hn[de]+" ",de=(de+1)%hn.length;continue}if(un===ne){Ye+=hn[hn.length-1]+" ";continue}}Ye+=hn[0]+" "}switch(Ye=" "==Ye.substr(Ye.length-1)?Ye.substr(0,Ye.length-1):Ye,M=uM(Ye,t,l).width,t.textAlign){case"right":E=m-M-2;break;case"center":E=(m-M)/2;break;default:E=2}n+=Us(E)+" "+Us(V)+" Td\n",n+="("+eb(Ye)+") Tj\n",n+=-Us(E)+" 0 Td\n",V=-(l+2),M=0,ne=We?re:re+1,he++,fe=""}break}return i.text=n,i.fontSize=l,i},uM=function(t,n,e){var i=n.scope.internal.getFont(n.fontName,n.fontStyle),s=n.scope.getStringUnitWidth(t,{font:i,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:n.scope.getStringUnitWidth("3",{font:i,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:s}},Yoe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Joe=function(t,n){var e={type:"reference",object:t};void 0===n.internal.getPageInfo(t.page).pageContext.annotations.find(function(i){return i.type===e.type&&i.object===e.object})&&n.internal.getPageInfo(t.page).pageContext.annotations.push(e)},eQ=ac.__acroform__.arrayToPdfArray=function(t,n,e){var i=function(h){return h};if(Array.isArray(t)){for(var s="[",l=0;l<t.length;l++)switch(0!==l&&(s+=" "),(0,Ga.Z)(t[l])){case"boolean":case"number":case"object":s+=t[l].toString();break;case"string":"/"!==t[l].substr(0,1)?(void 0!==n&&e&&(i=e.internal.getEncryptor(n)),s+="("+eb(i(t[l].toString()))+")"):s+=t[l].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},xP=function(t,n,e){var i=function(s){return s};return void 0!==n&&e&&(i=e.internal.getEncryptor(n)),(t=t||"").toString(),"("+eb(i(t))+")"},Hm=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Hm.prototype.toString=function(){return this.objId+" 0 R"},Hm.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Hm.prototype.getKeyValueListForStream=function(){var t=[],n=Object.getOwnPropertyNames(this).filter(function(l){return"content"!=l&&"appearanceStreamContent"!=l&&"scope"!=l&&"objId"!=l&&"_"!=l.substring(0,1)});for(var e in n)if(!1===Object.getOwnPropertyDescriptor(this,n[e]).configurable){var i=n[e],s=this[i];s&&(Array.isArray(s)?t.push({key:i,value:eQ(s,this.objId,this.scope)}):s instanceof Hm?(s.scope=this.scope,t.push({key:i,value:s.objId+" 0 R"})):"function"!=typeof s&&t.push({key:i,value:s}))}return t};var tQ=function(){Hm.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,n=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){t=e.trim()},get:function(){return t||null}})};yf(tQ,Hm);var nQ=function(){Hm.call(this);var t,n=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return n.length>0?n:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return n}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var e=function(i){return i};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+eb(e(t))+")"}},set:function(e){t=e}})};yf(nQ,Hm);var pg=function t(){Hm.call(this);var n=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return n},set:function(fe){if(isNaN(fe))throw new Error('Invalid value "'+fe+'" for attribute F supplied.');n=fe}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ic(n,3)},set:function(fe){this.F=fe?Dc(n,3):Bc(n,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(fe){if(isNaN(fe))throw new Error('Invalid value "'+fe+'" for attribute Ff supplied.');e=fe}});var i=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==i.length)return i},set:function(fe){i=void 0!==fe?fe:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[0])?0:i[0]},set:function(fe){i[0]=fe}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[1])?0:i[1]},set:function(fe){i[1]=fe}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[2])?0:i[2]},set:function(fe){i[2]=fe}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!i||isNaN(i[3])?0:i[3]},set:function(fe){i[3]=fe}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(fe){switch(fe){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=fe;break;default:throw new Error('Invalid value "'+fe+'" for attribute FT supplied.')}}});var l=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!l||l.length<1){if(this instanceof fM)return;l="FieldObject"+t.FieldNum++}var fe=function(he){return he};return this.scope&&(fe=this.scope.internal.getEncryptor(this.objId)),"("+eb(fe(l))+")"},set:function(fe){l=fe.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return l},set:function(fe){l=fe}});var h="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return h},set:function(fe){h=fe}});var m="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return m},set:function(fe){m=fe}});var b=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return b},set:function(fe){b=fe}});var E=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===E?50/bP:E},set:function(fe){E=fe}});var M="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return M},set:function(fe){M=fe}});var L="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!L||this instanceof fM||this instanceof tb))return xP(L,this.objId,this.scope)},set:function(fe){fe=fe.toString(),L=fe}});var G=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(G)return this instanceof qu?G:xP(G,this.objId,this.scope)},set:function(fe){fe=fe.toString(),G=this instanceof qu?fe:"("===fe.substr(0,1)?Ux(fe.substr(1,fe.length-2)):Ux(fe)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof qu?Ux(G.substr(1,G.length-1)):G},set:function(fe){fe=fe.toString(),G=this instanceof qu?"/"+fe:fe}});var V=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(V)return V},set:function(fe){this.V=fe}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(V)return this instanceof qu?V:xP(V,this.objId,this.scope)},set:function(fe){fe=fe.toString(),V=this instanceof qu?fe:"("===fe.substr(0,1)?Ux(fe.substr(1,fe.length-2)):Ux(fe)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof qu?Ux(V.substr(1,V.length-1)):V},set:function(fe){fe=fe.toString(),V=this instanceof qu?"/"+fe:fe}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var ne,re=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return re},set:function(fe){re=fe=!!fe}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(ne)return ne},set:function(fe){ne=fe}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,1)},set:function(fe){this.Ff=fe?Dc(this.Ff,1):Bc(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,2)},set:function(fe){this.Ff=fe?Dc(this.Ff,2):Bc(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,3)},set:function(fe){this.Ff=fe?Dc(this.Ff,3):Bc(this.Ff,3)}});var de=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==de)return de},set:function(fe){if(-1===[0,1,2].indexOf(fe))throw new Error('Invalid value "'+fe+'" for attribute Q supplied.');de=fe}}),Object.defineProperty(this,"textAlign",{get:function(){var fe;switch(de){case 0:default:fe="left";break;case 1:fe="center";break;case 2:fe="right"}return fe},configurable:!0,enumerable:!0,set:function(fe){switch(fe){case"right":case 2:de=2;break;case"center":case 1:de=1;break;default:de=0}}})};yf(pg,Hm);var zx=function(){pg.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){t=e}});var n=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return eQ(n,this.objId,this.scope)},set:function(e){var i,s;s=[],"string"==typeof(i=e)&&(s=function(l,h,m){m||(m=1);for(var b,E=[];b=h.exec(l);)E.push(b[m]);return E}(i,/\((.*?)\)/g)),n=s}}),this.getOptions=function(){return n},this.setOptions=function(e){n=e,this.sort&&n.sort()},this.addOption=function(e){e=(e=e||"").toString(),n.push(e),this.sort&&n.sort()},this.removeOption=function(e,i){for(i=i||!1,e=(e=e||"").toString();-1!==n.indexOf(e)&&(n.splice(n.indexOf(e),1),!1!==i););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,18)},set:function(e){this.Ff=e?Dc(this.Ff,18):Bc(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,19)},set:function(e){!0===this.combo&&(this.Ff=e?Dc(this.Ff,19):Bc(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,20)},set:function(e){e?(this.Ff=Dc(this.Ff,20),n.sort()):this.Ff=Bc(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,22)},set:function(e){this.Ff=e?Dc(this.Ff,22):Bc(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,23)},set:function(e){this.Ff=e?Dc(this.Ff,23):Bc(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,27)},set:function(e){this.Ff=e?Dc(this.Ff,27):Bc(this.Ff,27)}}),this.hasAppearanceStream=!1};yf(zx,pg);var Vx=function(){zx.call(this),this.fontName="helvetica",this.combo=!1};yf(Vx,zx);var Hx=function(){Vx.call(this),this.combo=!0};yf(Hx,Vx);var hM=function(){Hx.call(this),this.edit=!0};yf(hM,Hx);var qu=function(){pg.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,15)},set:function(e){this.Ff=e?Dc(this.Ff,15):Bc(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,16)},set:function(e){this.Ff=e?Dc(this.Ff,16):Bc(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,17)},set:function(e){this.Ff=e?Dc(this.Ff,17):Bc(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,26)},set:function(e){this.Ff=e?Dc(this.Ff,26):Bc(this.Ff,26)}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(l){return l};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(n).length){var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+eb(e(n[i]))+")");return s.push(">>"),s.join("\n")}},set:function(e){"object"===(0,Ga.Z)(e)&&(n=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(e){"string"==typeof e&&(n.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(e){t="/"+e}})};yf(qu,pg);var dM=function(){qu.call(this),this.pushButton=!0};yf(dM,qu);var Qx=function(){qu.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=void 0!==n?n:[]}})};yf(Qx,qu);var fM=function(){var t,n;pg.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return n},set:function(s){n=s}});var e,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(m){return m};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var l,h=[];for(l in h.push("<<"),i)h.push("/"+l+" ("+eb(s(i[l]))+")");return h.push(">>"),h.join("\n")},set:function(s){"object"===(0,Ga.Z)(s)&&(i=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(s){"string"==typeof s&&(i.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(s){e="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=pr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};yf(fM,pg),Qx.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var n in this.Kids)if(this.Kids.hasOwnProperty(n)){var e=this.Kids[n];e.appearanceStreamContent=t.createAppearanceStream(e.optionName),e.caption=t.getCA()}},Qx.prototype.createOption=function(t){var n=new fM;return n.Parent=this,n.optionName=t,this.Kids.push(n),nae.call(this.scope,n),n};var AM=function(){qu.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=pr.CheckBox.createAppearanceStream()};yf(AM,qu);var tb=function(){pg.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,13)},set:function(n){this.Ff=n?Dc(this.Ff,13):Bc(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,21)},set:function(n){this.Ff=n?Dc(this.Ff,21):Bc(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,23)},set:function(n){this.Ff=n?Dc(this.Ff,23):Bc(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,24)},set:function(n){this.Ff=n?Dc(this.Ff,24):Bc(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,25)},set:function(n){this.Ff=n?Dc(this.Ff,25):Bc(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,26)},set:function(n){this.Ff=n?Dc(this.Ff,26):Bc(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(n){Number.isInteger(n)&&(t=n)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};yf(tb,pg);var pM=function(){tb.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ic(this.Ff,14)},set:function(t){this.Ff=t?Dc(this.Ff,14):Bc(this.Ff,14)}}),this.password=!0};yf(pM,tb);var pr={CheckBox:{createAppearanceStream:function(){return{N:{On:pr.CheckBox.YesNormal},D:{On:pr.CheckBox.YesPushDown,Off:pr.CheckBox.OffPushDown}}},YesPushDown:function(t){var n=Vm(t);n.scope=t.scope;var e=[],i=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),l=wP(t,t.caption);return e.push("0.749023 g"),e.push("0 0 "+Us(pr.internal.getWidth(t))+" "+Us(pr.internal.getHeight(t))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+i+" "+Us(l.fontSize)+" Tf "+s),e.push("BT"),e.push(l.text),e.push("ET"),e.push("Q"),e.push("EMC"),n.stream=e.join("\n"),n},YesNormal:function(t){var n=Vm(t);n.scope=t.scope;var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),s=[],l=pr.internal.getHeight(t),h=pr.internal.getWidth(t),m=wP(t,t.caption);return s.push("1 g"),s.push("0 0 "+Us(h)+" "+Us(l)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Us(h-1)+" "+Us(l-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+e+" "+Us(m.fontSize)+" Tf "+i),s.push(m.text),s.push("ET"),s.push("Q"),n.stream=s.join("\n"),n},OffPushDown:function(t){var n=Vm(t);n.scope=t.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Us(pr.internal.getWidth(t))+" "+Us(pr.internal.getHeight(t))+" re"),e.push("f"),n.stream=e.join("\n"),n}},RadioButton:{Circle:{createAppearanceStream:function(t){var n={D:{Off:pr.RadioButton.Circle.OffPushDown},N:{}};return n.N[t]=pr.RadioButton.Circle.YesNormal,n.D[t]=pr.RadioButton.Circle.YesPushDown,n},getCA:function(){return"l"},YesNormal:function(t){var n=Vm(t);n.scope=t.scope;var e=[],i=pr.internal.getWidth(t)<=pr.internal.getHeight(t)?pr.internal.getWidth(t)/4:pr.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var l=Number((i*pr.internal.Bezier_C).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+Ky(pr.internal.getWidth(t)/2)+" "+Ky(pr.internal.getHeight(t)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+l+" "+l+" "+i+" 0 "+i+" c"),e.push("-"+l+" "+i+" -"+i+" "+l+" -"+i+" 0 c"),e.push("-"+i+" -"+l+" -"+l+" -"+i+" 0 -"+i+" c"),e.push(l+" -"+i+" "+i+" -"+l+" "+i+" 0 c"),e.push("f"),e.push("Q"),n.stream=e.join("\n"),n},YesPushDown:function(t){var n=Vm(t);n.scope=t.scope;var e=[],i=pr.internal.getWidth(t)<=pr.internal.getHeight(t)?pr.internal.getWidth(t)/4:pr.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var s=Number((2*i).toFixed(5)),l=Number((s*pr.internal.Bezier_C).toFixed(5)),h=Number((i*pr.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Ky(pr.internal.getWidth(t)/2)+" "+Ky(pr.internal.getHeight(t)/2)+" cm"),e.push(s+" 0 m"),e.push(s+" "+l+" "+l+" "+s+" 0 "+s+" c"),e.push("-"+l+" "+s+" -"+s+" "+l+" -"+s+" 0 c"),e.push("-"+s+" -"+l+" -"+l+" -"+s+" 0 -"+s+" c"),e.push(l+" -"+s+" "+s+" -"+l+" "+s+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+Ky(pr.internal.getWidth(t)/2)+" "+Ky(pr.internal.getHeight(t)/2)+" cm"),e.push(i+" 0 m"),e.push(i+" "+h+" "+h+" "+i+" 0 "+i+" c"),e.push("-"+h+" "+i+" -"+i+" "+h+" -"+i+" 0 c"),e.push("-"+i+" -"+h+" -"+h+" -"+i+" 0 -"+i+" c"),e.push(h+" -"+i+" "+i+" -"+h+" "+i+" 0 c"),e.push("f"),e.push("Q"),n.stream=e.join("\n"),n},OffPushDown:function(t){var n=Vm(t);n.scope=t.scope;var e=[],i=pr.internal.getWidth(t)<=pr.internal.getHeight(t)?pr.internal.getWidth(t)/4:pr.internal.getHeight(t)/4;i=Number((.9*i).toFixed(5));var s=Number((2*i).toFixed(5)),l=Number((s*pr.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Ky(pr.internal.getWidth(t)/2)+" "+Ky(pr.internal.getHeight(t)/2)+" cm"),e.push(s+" 0 m"),e.push(s+" "+l+" "+l+" "+s+" 0 "+s+" c"),e.push("-"+l+" "+s+" -"+s+" "+l+" -"+s+" 0 c"),e.push("-"+s+" -"+l+" -"+l+" -"+s+" 0 -"+s+" c"),e.push(l+" -"+s+" "+s+" -"+l+" "+s+" 0 c"),e.push("f"),e.push("Q"),n.stream=e.join("\n"),n}},Cross:{createAppearanceStream:function(t){var n={D:{Off:pr.RadioButton.Cross.OffPushDown},N:{}};return n.N[t]=pr.RadioButton.Cross.YesNormal,n.D[t]=pr.RadioButton.Cross.YesPushDown,n},getCA:function(){return"8"},YesNormal:function(t){var n=Vm(t);n.scope=t.scope;var e=[],i=pr.internal.calculateCross(t);return e.push("q"),e.push("1 1 "+Us(pr.internal.getWidth(t)-2)+" "+Us(pr.internal.getHeight(t)-2)+" re"),e.push("W"),e.push("n"),e.push(Us(i.x1.x)+" "+Us(i.x1.y)+" m"),e.push(Us(i.x2.x)+" "+Us(i.x2.y)+" l"),e.push(Us(i.x4.x)+" "+Us(i.x4.y)+" m"),e.push(Us(i.x3.x)+" "+Us(i.x3.y)+" l"),e.push("s"),e.push("Q"),n.stream=e.join("\n"),n},YesPushDown:function(t){var n=Vm(t);n.scope=t.scope;var e=pr.internal.calculateCross(t),i=[];return i.push("0.749023 g"),i.push("0 0 "+Us(pr.internal.getWidth(t))+" "+Us(pr.internal.getHeight(t))+" re"),i.push("f"),i.push("q"),i.push("1 1 "+Us(pr.internal.getWidth(t)-2)+" "+Us(pr.internal.getHeight(t)-2)+" re"),i.push("W"),i.push("n"),i.push(Us(e.x1.x)+" "+Us(e.x1.y)+" m"),i.push(Us(e.x2.x)+" "+Us(e.x2.y)+" l"),i.push(Us(e.x4.x)+" "+Us(e.x4.y)+" m"),i.push(Us(e.x3.x)+" "+Us(e.x3.y)+" l"),i.push("s"),i.push("Q"),n.stream=i.join("\n"),n},OffPushDown:function(t){var n=Vm(t);n.scope=t.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Us(pr.internal.getWidth(t))+" "+Us(pr.internal.getHeight(t))+" re"),e.push("f"),n.stream=e.join("\n"),n}}},createDefaultAppearanceStream:function(t){var n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,e=t.scope.__private__.encodeColorString(t.color);return"/"+n+" "+t.fontSize+" Tf "+e}};pr.internal={Bezier_C:.551915024494,calculateCross:function(t){var n=pr.internal.getWidth(t),e=pr.internal.getHeight(t),i=Math.min(n,e);return{x1:{x:(n-i)/2,y:(e-i)/2+i},x2:{x:(n-i)/2+i,y:(e-i)/2},x3:{x:(n-i)/2,y:(e-i)/2},x4:{x:(n-i)/2+i,y:(e-i)/2+i}}}},pr.internal.getWidth=function(t){var n=0;return"object"===(0,Ga.Z)(t)&&(n=JH(t.Rect[2])),n},pr.internal.getHeight=function(t){var n=0;return"object"===(0,Ga.Z)(t)&&(n=JH(t.Rect[3])),n};var t,n,nae=ac.addField=function(t){if(function(t,n){if(n.scope=t,void 0!==t.internal&&(void 0===t.internal.acroformPlugin||!1===t.internal.acroformPlugin.isInitialized)){if(pg.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(Yoe)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");bP=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new nQ,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){var e;(e=t).internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0}),t.internal.events.subscribe("buildDocument",function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var i=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in i)if(i.hasOwnProperty(s)){var l=i[s];l.objId=void 0,l.hasAnnotation&&Joe(l,e)}}(t)}),t.internal.events.subscribe("putCatalog",function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(t)}),t.internal.events.subscribe("postPutPages",function(e){!function(i,s){var l=!i;for(var h in i||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),i=i||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(i.hasOwnProperty(h)){var m=i[h],b=[],E=m.Rect;if(m.Rect&&(m.Rect=Zoe(m.Rect,s)),s.internal.newObjectDeferredBegin(m.objId,!0),m.DA=pr.createDefaultAppearanceStream(m),"object"===(0,Ga.Z)(m)&&"function"==typeof m.getKeyValueListForStream&&(b=m.getKeyValueListForStream()),m.Rect=E,m.hasAppearanceStream&&!m.appearanceStreamContent){var M=Xoe(m);b.push({key:"AP",value:"<</N "+M+">>"}),s.internal.acroformPlugin.xForms.push(M)}if(m.appearanceStreamContent){var L="";for(var G in m.appearanceStreamContent)if(m.appearanceStreamContent.hasOwnProperty(G)){var V=m.appearanceStreamContent[G];if(L+="/"+G+" ",L+="<<",Object.keys(V).length>=1||Array.isArray(V)){for(var h in V)if(V.hasOwnProperty(h)){var ne=V[h];"function"==typeof ne&&(ne=ne.call(s,m)),L+="/"+h+" "+ne+" ",s.internal.acroformPlugin.xForms.indexOf(ne)>=0||s.internal.acroformPlugin.xForms.push(ne)}}else"function"==typeof(ne=V)&&(ne=ne.call(s,m)),L+="/"+h+" "+ne,s.internal.acroformPlugin.xForms.indexOf(ne)>=0||s.internal.acroformPlugin.xForms.push(ne);L+=">>"}b.push({key:"AP",value:"<<\n"+L+">>"})}s.internal.putStream({additionalKeyValues:b,objectId:m.objId}),s.internal.out("endobj")}l&&function(t,n){for(var e in t)if(t.hasOwnProperty(e)){var i=e,s=t[e];n.internal.newObjectDeferredBegin(s.objId,!0),"object"===(0,Ga.Z)(s)&&"function"==typeof s.putStream&&s.putStream(),delete t[i]}}(s.internal.acroformPlugin.xForms,s)}(e,t)}),t.internal.acroformPlugin.isInitialized=!0}}(this,t),!(t instanceof pg))throw new Error("Invalid argument passed to jsPDF.addField.");var n;return(n=t).scope.internal.acroformPlugin.printedOut&&(n.scope.internal.acroformPlugin.printedOut=!1,n.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),n.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(n),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};function iQ(t){return t.reduce(function(n,e,i){return n[e]=i,n},{})}ac.AcroFormChoiceField=zx,ac.AcroFormListBox=Vx,ac.AcroFormComboBox=Hx,ac.AcroFormEditBox=hM,ac.AcroFormButton=qu,ac.AcroFormPushButton=dM,ac.AcroFormRadioButton=Qx,ac.AcroFormCheckBox=AM,ac.AcroFormTextField=tb,ac.AcroFormPasswordField=pM,ac.AcroFormAppearance=pr,ac.AcroForm={ChoiceField:zx,ListBox:Vx,ComboBox:Hx,EditBox:hM,Button:qu,PushButton:dM,RadioButton:Qx,CheckBox:AM,TextField:tb,PasswordField:pM,Appearance:pr},fs.AcroForm={ChoiceField:zx,ListBox:Vx,ComboBox:Hx,EditBox:hM,Button:qu,PushButton:dM,RadioButton:Qx,CheckBox:AM,TextField:tb,PasswordField:pM,Appearance:pr},function(t){t.__addimage__={};var n="UNKNOWN",e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=t.__addimage__.getImageFileTypeByImageData=function(Ue,ze){var ut,lt,_n,ft,Ot,wt=n;if("RGBA"===(ze=ze||n)||void 0!==Ue.data&&Ue.data instanceof Uint8ClampedArray&&"height"in Ue&&"width"in Ue)return"RGBA";if(Qt(Ue))for(Ot in e)for(_n=e[Ot],ut=0;ut<_n.length;ut+=1){for(ft=!0,lt=0;lt<_n[ut].length;lt+=1)if(void 0!==_n[ut][lt]&&_n[ut][lt]!==Ue[lt]){ft=!1;break}if(!0===ft){wt=Ot;break}}else for(Ot in e)for(_n=e[Ot],ut=0;ut<_n.length;ut+=1){for(ft=!0,lt=0;lt<_n[ut].length;lt+=1)if(void 0!==_n[ut][lt]&&_n[ut][lt]!==Ue.charCodeAt(lt)){ft=!1;break}if(!0===ft){wt=Ot;break}}return wt===n&&ze!==n&&(wt=ze),wt},s=function Ue(ze){for(var ut=this.internal.write,lt=this.internal.putStream,_n=(0,this.internal.getFilters)();-1!==_n.indexOf("FlateEncode");)_n.splice(_n.indexOf("FlateEncode"),1);ze.objectId=this.internal.newObject();var ft=[];if(ft.push({key:"Type",value:"/XObject"}),ft.push({key:"Subtype",value:"/Image"}),ft.push({key:"Width",value:ze.width}),ft.push({key:"Height",value:ze.height}),ze.colorSpace===de.INDEXED?ft.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(ze.palette.length/3-1)+" "+("sMask"in ze&&void 0!==ze.sMask?ze.objectId+2:ze.objectId+1)+" 0 R]"}):(ft.push({key:"ColorSpace",value:"/"+ze.colorSpace}),ze.colorSpace===de.DEVICE_CMYK&&ft.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ft.push({key:"BitsPerComponent",value:ze.bitsPerComponent}),"decodeParameters"in ze&&void 0!==ze.decodeParameters&&ft.push({key:"DecodeParms",value:"<<"+ze.decodeParameters+">>"}),"transparency"in ze&&Array.isArray(ze.transparency)){for(var Ot="",wt=0,Yt=ze.transparency.length;wt<Yt;wt++)Ot+=ze.transparency[wt]+" "+ze.transparency[wt]+" ";ft.push({key:"Mask",value:"["+Ot+"]"})}if(void 0!==ze.sMask&&ft.push({key:"SMask",value:ze.objectId+1+" 0 R"}),lt({data:ze.data,additionalKeyValues:ft,alreadyAppliedFilters:void 0!==ze.filter?["/"+ze.filter]:void 0,objectId:ze.objectId}),ut("endobj"),"sMask"in ze&&void 0!==ze.sMask){var Se={width:ze.width,height:ze.height,colorSpace:"DeviceGray",bitsPerComponent:ze.bitsPerComponent,decodeParameters:"/Predictor "+ze.predictor+" /Colors 1 /BitsPerComponent "+ze.bitsPerComponent+" /Columns "+ze.width,data:ze.sMask};"filter"in ze&&(Se.filter=ze.filter),Ue.call(this,Se)}if(ze.colorSpace===de.INDEXED){var Xe=this.internal.newObject();lt({data:Ye(new Uint8Array(ze.palette)),objectId:Xe}),ut("endobj")}},l=function(){var Ue=this.internal.collections.addImage_images;for(var ze in Ue)s.call(this,Ue[ze])},h=function(){var Ue,ze=this.internal.collections.addImage_images,ut=this.internal.write;for(var lt in ze)ut("/I"+(Ue=ze[lt]).index,Ue.objectId,"0","R")},m=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",h))},b=function(){var Ue=this.internal.collections.addImage_images;return m.call(this),Ue},E=function(){return Object.keys(this.internal.collections.addImage_images).length},M=function(Ue){return"function"==typeof t["process"+Ue.toUpperCase()]},L=function(Ue){return"object"===(0,Ga.Z)(Ue)&&1===Ue.nodeType},G=function(Ue,ze){if("IMG"===Ue.nodeName&&Ue.hasAttribute("src")){var ut=""+Ue.getAttribute("src");if(0===ut.indexOf("data:image/"))return fS(unescape(ut).split("base64,").pop());var lt=t.loadFile(ut,!0);if(void 0!==lt)return lt}if("CANVAS"===Ue.nodeName){if(0===Ue.width||0===Ue.height)throw new Error("Given canvas must have data. Canvas width: "+Ue.width+", height: "+Ue.height);var _n;switch(ze){case"PNG":_n="image/png";break;case"WEBP":_n="image/webp";break;default:_n="image/jpeg"}return fS(Ue.toDataURL(_n,1).split("base64,").pop())}},V=function(Ue){var ze=this.internal.collections.addImage_images;if(ze)for(var ut in ze)if(Ue===ze[ut].alias)return ze[ut]},ne=function(Ue,ze,ut){return Ue||ze||(Ue=-96,ze=-96),Ue<0&&(Ue=-1*ut.width*72/Ue/this.internal.scaleFactor),ze<0&&(ze=-1*ut.height*72/ze/this.internal.scaleFactor),0===Ue&&(Ue=ze*ut.width/ut.height),0===ze&&(ze=Ue*ut.height/ut.width),[Ue,ze]},re=function(Ue,ze,ut,lt,_n,ft){var Ot=ne.call(this,ut,lt,_n),wt=this.internal.getCoordinateString,Yt=this.internal.getVerticalCoordinateString,pn=b.call(this);if(ut=Ot[0],lt=Ot[1],pn[_n.index]=_n,ft){ft*=Math.PI/180;var Ti=Math.cos(ft),Se=Math.sin(ft),Xe=function(_t){return _t.toFixed(4)},Je=[Xe(Ti),Xe(Se),Xe(-1*Se),Xe(Ti),0,0,"cm"]}this.internal.write("q"),ft?(this.internal.write([1,"0","0",1,wt(Ue),Yt(ze+lt),"cm"].join(" ")),this.internal.write(Je.join(" ")),this.internal.write([wt(ut),"0","0",wt(lt),"0","0","cm"].join(" "))):this.internal.write([wt(ut),"0","0",wt(lt),wt(Ue),Yt(ze+lt),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+_n.index+" Do"),this.internal.write("Q")},de=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var fe=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},he=t.__addimage__.sHashCode=function(Ue){var ze,ut,lt=0;if("string"==typeof Ue)for(ut=Ue.length,ze=0;ze<ut;ze++)lt=(lt<<5)-lt+Ue.charCodeAt(ze),lt|=0;else if(Qt(Ue))for(ut=Ue.byteLength/2,ze=0;ze<ut;ze++)lt=(lt<<5)-lt+Ue[ze],lt|=0;return lt},Ne=t.__addimage__.validateStringAsBase64=function(Ue){(Ue=Ue||"").toString().trim();var ze=!0;return 0===Ue.length&&(ze=!1),Ue.length%4!=0&&(ze=!1),!1===/^[A-Za-z0-9+/]+$/.test(Ue.substr(0,Ue.length-2))&&(ze=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(Ue.substr(-2))&&(ze=!1),ze},We=t.__addimage__.extractImageFromDataUrl=function(Ue){var ze=(Ue=Ue||"").split("base64,"),ut=null;if(2===ze.length){var lt=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(ze[0]);Array.isArray(lt)&&(ut={mimeType:lt[1],charset:lt[2],data:ze[1]})}return ut},pt=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(Ue){return pt()&&Ue instanceof ArrayBuffer};var Qt=t.__addimage__.isArrayBufferView=function(Ue){return pt()&&typeof Uint32Array<"u"&&(Ue instanceof Int8Array||Ue instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&Ue instanceof Uint8ClampedArray||Ue instanceof Int16Array||Ue instanceof Uint16Array||Ue instanceof Int32Array||Ue instanceof Uint32Array||Ue instanceof Float32Array||Ue instanceof Float64Array)},yt=t.__addimage__.binaryStringToUint8Array=function(Ue){for(var ze=Ue.length,ut=new Uint8Array(ze),lt=0;lt<ze;lt++)ut[lt]=Ue.charCodeAt(lt);return ut},Ye=t.__addimage__.arrayBufferToBinaryString=function(Ue){for(var ze="",ut=Qt(Ue)?Ue:new Uint8Array(Ue),lt=0;lt<ut.length;lt+=8192)ze+=String.fromCharCode.apply(null,ut.subarray(lt,lt+8192));return ze};t.addImage=function(){var Ue,ze,ut,lt,_n,ft,Ot,wt,Yt;if("number"==typeof arguments[1]?(ze=n,ut=arguments[1],lt=arguments[2],_n=arguments[3],ft=arguments[4],Ot=arguments[5],wt=arguments[6],Yt=arguments[7]):(ze=arguments[1],ut=arguments[2],lt=arguments[3],_n=arguments[4],ft=arguments[5],Ot=arguments[6],wt=arguments[7],Yt=arguments[8]),"object"===(0,Ga.Z)(Ue=arguments[0])&&!L(Ue)&&"imageData"in Ue){var pn=Ue;Ue=pn.imageData,ze=pn.format||ze||n,ut=pn.x||ut||0,lt=pn.y||lt||0,_n=pn.w||pn.width||_n,ft=pn.h||pn.height||ft,Ot=pn.alias||Ot,wt=pn.compression||wt,Yt=pn.rotation||pn.angle||Yt}var Ti=this.internal.getFilters();if(void 0===wt&&-1!==Ti.indexOf("FlateEncode")&&(wt="SLOW"),isNaN(ut)||isNaN(lt))throw new Error("Invalid coordinates passed to jsPDF.addImage");m.call(this);var Se=un.call(this,Ue,ze,Ot,wt);return re.call(this,ut,lt,_n,ft,Se,Yt),this};var un=function(Ue,ze,ut,lt){var _n,ft,Ot,Yt;if("string"==typeof Ue&&i(Ue)===n){Ue=unescape(Ue);var wt=hn(Ue,!1);(""!==wt||void 0!==(wt=t.loadFile(Ue,!0)))&&(Ue=wt)}if(L(Ue)&&(Ue=G(Ue,ze)),ze=i(Ue,ze),!M(ze))throw new Error("addImage does not support files of type '"+ze+"', please ensure that a plugin for '"+ze+"' support is added.");if((null==(Ot=ut)||0===Ot.length)&&(ut="string"==typeof(Yt=Ue)||Qt(Yt)?he(Yt):Qt(Yt.data)?he(Yt.data):null),(_n=V.call(this,ut))||(pt()&&(Ue instanceof Uint8Array||"RGBA"===ze||(ft=Ue,Ue=yt(Ue))),_n=this["process"+ze.toUpperCase()](Ue,E.call(this),ut,function(Yt){return Yt&&"string"==typeof Yt&&(Yt=Yt.toUpperCase()),Yt in t.image_compression?Yt:fe.NONE}(lt),ft)),!_n)throw new Error("An unknown error occurred whilst processing the image.");return _n},hn=t.__addimage__.convertBase64ToBinaryString=function(Ue,ze){var ut;ze="boolean"!=typeof ze||ze;var lt,_n="";if("string"==typeof Ue){lt=null!==(ut=We(Ue))?ut.data:Ue;try{_n=fS(lt)}catch(ft){if(ze)throw Ne(lt)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ft.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return _n};t.getImageProperties=function(Ue){var ze,ut,lt="";if(L(Ue)&&(Ue=G(Ue)),"string"==typeof Ue&&i(Ue)===n&&(""===(lt=hn(Ue,!1))&&(lt=t.loadFile(Ue)||""),Ue=lt),ut=i(Ue),!M(ut))throw new Error("addImage does not support files of type '"+ut+"', please ensure that a plugin for '"+ut+"' support is added.");if(!pt()||Ue instanceof Uint8Array||(Ue=yt(Ue)),!(ze=this["process"+ut.toUpperCase()](Ue)))throw new Error("An unknown error occurred whilst processing the image");return ze.fileType=ut,ze}}(fs.API),
/**
         * @license
         * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
t=fs.API,n=function(e){if(void 0!==e&&""!=e)return!0},fs.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(e){for(var i,s,l,h=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString,b=this.internal.getPageInfoByObjId(e.objId),E=e.pageContext.annotations,M=!1,L=0;L<E.length&&!M;L++)switch((i=E[L]).type){case"link":(n(i.options.url)||n(i.options.pageNumber))&&(M=!0);break;case"reference":case"text":case"freetext":M=!0}if(0!=M){this.internal.write("/Annots [");for(var G=0;G<E.length;G++){i=E[G];var V=this.internal.pdfEscape,ne=this.internal.getEncryptor(e.objId);switch(i.type){case"reference":this.internal.write(" "+i.object.objId+" 0 R ");break;case"text":var re=this.internal.newAdditionalObject(),de=this.internal.newAdditionalObject(),fe=this.internal.getEncryptor(re.objId),he=i.title||"Note";l="<</Type /Annot /Subtype /Text "+(s="/Rect ["+h(i.bounds.x)+" "+m(i.bounds.y+i.bounds.h)+" "+h(i.bounds.x+i.bounds.w)+" "+m(i.bounds.y)+"] ")+"/Contents ("+V(fe(i.contents))+")",l+=" /Popup "+de.objId+" 0 R",l+=" /P "+b.objId+" 0 R",l+=" /T ("+V(fe(he))+") >>",re.content=l;var Ne=re.objId+" 0 R";l="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+h(i.bounds.x+30)+" "+m(i.bounds.y+i.bounds.h)+" "+h(i.bounds.x+i.bounds.w+30)+" "+m(i.bounds.y)+"] ")+" /Parent "+Ne,i.open&&(l+=" /Open true"),de.content=l+=" >>",this.internal.write(re.objId,"0 R",de.objId,"0 R");break;case"freetext":s="/Rect ["+h(i.bounds.x)+" "+m(i.bounds.y)+" "+h(i.bounds.x+i.bounds.w)+" "+m(i.bounds.y+i.bounds.h)+"] ";var We=i.color||"#000000";l="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+V(ne(i.contents))+")",l+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+We+")",l+=" /Border [0 0 0]",this.internal.write(l+=" >>");break;case"link":if(i.options.name){var pt=this.annotations._nameMap[i.options.name];i.options.pageNumber=pt.page,i.options.top=pt.y}else i.options.top||(i.options.top=0);if(s="/Rect ["+i.finalBounds.x+" "+i.finalBounds.y+" "+i.finalBounds.w+" "+i.finalBounds.h+"] ",l="",i.options.url)l="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+V(ne(i.options.url))+") >>";else if(i.options.pageNumber)switch(l="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(i.options.pageNumber).objId+" 0 R",i.options.magFactor=i.options.magFactor||"XYZ",i.options.magFactor){case"Fit":l+=" /Fit]";break;case"FitH":l+=" /FitH "+i.options.top+"]";break;case"FitV":i.options.left=i.options.left||0,l+=" /FitV "+i.options.left+"]";break;default:var Qt=m(i.options.top);i.options.left=i.options.left||0,void 0===i.options.zoom&&(i.options.zoom=0),l+=" /XYZ "+i.options.left+" "+Qt+" "+i.options.zoom+"]"}""!=l&&this.internal.write(l+=" >>")}}this.internal.write("]")}}]),t.createAnnotation=function(e){var i=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":i.pageContext.annotations.push(e)}},t.link=function(e,i,s,l,h){var m=this.internal.getCurrentPageInfo(),b=this.internal.getCoordinateString,E=this.internal.getVerticalCoordinateString;m.pageContext.annotations.push({finalBounds:{x:b(e),y:E(i),w:b(e+s),h:E(i+l)},options:h,type:"link"})},t.textWithLink=function(e,i,s,l){var h,m,b=this.getTextWidth(e),E=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==l.maxWidth){var M=this.splitTextToSize(e,m=l.maxWidth).length;h=Math.ceil(E*M)}else m=b,h=E;return this.text(e,i,s,l),"center"===l.align&&(i-=b/2),"right"===l.align&&(i-=b),this.link(i,(s+=.2*E)-E,m,h,l),b},t.getTextWidth=function(e){var i=this.internal.getFontSize();return this.getStringUnitWidth(e)*i/this.internal.scaleFactor},
/**
         * @license
         * Copyright (c) 2017 Aras Abbasi
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(t){var n={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},i={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var l=t.__arabicParser__.isInArabicSubstitutionA=function(re){return void 0!==n[re.charCodeAt(0)]},h=t.__arabicParser__.isArabicLetter=function(re){return"string"==typeof re&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(re)},m=t.__arabicParser__.isArabicEndLetter=function(re){return h(re)&&l(re)&&n[re.charCodeAt(0)].length<=2},b=t.__arabicParser__.isArabicAlfLetter=function(re){return h(re)&&s.indexOf(re.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(re){return h(re)&&l(re)&&n[re.charCodeAt(0)].length>=1};var E=t.__arabicParser__.arabicLetterHasFinalForm=function(re){return h(re)&&l(re)&&n[re.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(re){return h(re)&&l(re)&&n[re.charCodeAt(0)].length>=3};var M=t.__arabicParser__.arabicLetterHasMedialForm=function(re){return h(re)&&l(re)&&4==n[re.charCodeAt(0)].length},L=t.__arabicParser__.resolveLigatures=function(re){var de=0,fe=e,he="",Ne=0;for(de=0;de<re.length;de+=1)void 0!==fe[re.charCodeAt(de)]?(Ne++,"number"==typeof(fe=fe[re.charCodeAt(de)])&&(he+=String.fromCharCode(fe),fe=e,Ne=0),de===re.length-1&&(fe=e,he+=re.charAt(de-(Ne-1)),de-=Ne-1,Ne=0)):(fe=e,he+=re.charAt(de-Ne),de-=Ne,Ne=0);return he};t.__arabicParser__.isArabicDiacritic=function(re){return void 0!==re&&void 0!==i[re.charCodeAt(0)]};var G=t.__arabicParser__.getCorrectForm=function(re,de,fe){return h(re)?!1===l(re)?-1:!E(re)||!h(de)&&!h(fe)||!h(fe)&&m(de)||m(re)&&!h(de)||m(re)&&b(de)||m(re)&&m(de)?0:M(re)&&h(de)&&!m(de)&&h(fe)&&E(fe)?3:m(re)||!h(fe)?1:2:-1},V=function(re){var de=0,fe=0,he=0,Ne="",We="",pt="",Qt=(re=re||"").split("\\s+"),yt=[];for(de=0;de<Qt.length;de+=1){for(yt.push(""),fe=0;fe<Qt[de].length;fe+=1)We=Qt[de][fe-1],pt=Qt[de][fe+1],h(Ne=Qt[de][fe])?(he=G(Ne,We,pt),yt[de]+=-1!==he?String.fromCharCode(n[Ne.charCodeAt(0)][he]):Ne):yt[de]+=Ne;yt[de]=L(yt[de])}return yt.join(" ")},ne=t.__arabicParser__.processArabic=t.processArabic=function(){var re,de="string"==typeof arguments[0]?arguments[0]:arguments[0].text,fe=[];if(Array.isArray(de)){var he=0;for(fe=[],he=0;he<de.length;he+=1)Array.isArray(de[he])?fe.push([V(de[he][0]),de[he][1],de[he][2]]):fe.push([V(de[he])]);re=fe}else re=V(de);return"string"==typeof arguments[0]?re:(arguments[0].text=re,arguments[0])};t.events.push(["preProcessText",ne])}(fs.API),fs.API.autoPrint=function(t){var n;return"javascript"===((t=t||{}).variant=t.variant||"non-conform",t.variant)?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+n+" 0 R")})),this},
/**
         * @license
         * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(t){var n=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(m){e=m}});var i=150;Object.defineProperty(this,"width",{get:function(){return i},set:function(m){i=isNaN(m)||!1===Number.isInteger(m)||m<0?150:m,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=i+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(m){s=isNaN(m)||!1===Number.isInteger(m)||m<0?300:m,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var l=[];Object.defineProperty(this,"childNodes",{get:function(){return l},set:function(m){l=m}});var h={};Object.defineProperty(this,"style",{get:function(){return h},set:function(m){h=m}}),Object.defineProperty(this,"parentNode",{})};n.prototype.getContext=function(e,i){var s;if("2d"!==(e=e||"2d"))return null;for(s in i)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=i[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},n.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new n,this.canvas.pdf=this}])}(fs.API),function(t){var n={left:0,top:0,bottom:0,right:0},e=!1,i=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},n),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new l,this.internal.__cell__.pages=1},l=function(){var b=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return b},set:function(re){b=re}});var E=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return E},set:function(re){E=re}});var M=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return M},set:function(re){M=re}});var L=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return L},set:function(re){L=re}});var G=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return G},set:function(re){G=re}});var V=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return V},set:function(re){V=re}});var ne=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return ne},set:function(re){ne=re}}),this};l.prototype.clone=function(){return new l(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},l.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(b){return i.call(this),this.internal.__cell__.headerFunction="function"==typeof b?b:void 0,this},t.getTextDimensions=function(b,E){i.call(this);var M=(E=E||{}).fontSize||this.getFontSize(),L=E.font||this.getFont(),G=E.scaleFactor||this.internal.scaleFactor,V=0,ne=0,re=0,de=this;if(!Array.isArray(b)&&"string"!=typeof b){if("number"!=typeof b)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");b=String(b)}var fe=E.maxWidth;fe>0?"string"==typeof b?b=this.splitTextToSize(b,fe):"[object Array]"===Object.prototype.toString.call(b)&&(b=b.reduce(function(Ne,We){return Ne.concat(de.splitTextToSize(We,fe))},[])):b=Array.isArray(b)?b:[b];for(var he=0;he<b.length;he++)V<(re=this.getStringUnitWidth(b[he],{font:L})*M)&&(V=re);return 0!==V&&(ne=b.length),{w:V/=G,h:Math.max((ne*M*this.getLineHeightFactor()-M*(this.getLineHeightFactor()-1))/G,0)}},t.cellAddPage=function(){i.call(this),this.addPage();var b=this.internal.__cell__.margins||n;return this.internal.__cell__.lastCell=new l(b.left,b.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var h=t.cell=function(){var b;b=arguments[0]instanceof l?arguments[0]:new l(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),i.call(this);var E=this.internal.__cell__.lastCell,M=this.internal.__cell__.padding,L=this.internal.__cell__.margins||n,G=this.internal.__cell__.tableHeaderRow,V=this.internal.__cell__.printHeaders;return void 0!==E.lineNumber&&(E.lineNumber===b.lineNumber?(b.x=(E.x||0)+(E.width||0),b.y=E.y||0):E.y+E.height+b.height+L.bottom>this.getPageHeight()?(this.cellAddPage(),b.y=L.top,V&&G&&(this.printHeaderRow(b.lineNumber,!0),b.y+=G[0].height)):b.y=E.y+E.height||b.y),void 0!==b.text[0]&&(this.rect(b.x,b.y,b.width,b.height,!0===e?"FD":void 0),"right"===b.align?this.text(b.text,b.x+b.width-M,b.y+M,{align:"right",baseline:"top"}):"center"===b.align?this.text(b.text,b.x+b.width/2,b.y+M,{align:"center",baseline:"top",maxWidth:b.width-M-M}):this.text(b.text,b.x+M,b.y+M,{align:"left",baseline:"top",maxWidth:b.width-M-M})),this.internal.__cell__.lastCell=b,this};t.table=function(b,E,M,L,G){if(i.call(this),!M)throw new Error("No data for PDF table.");var V,ne,re,de,fe=[],he=[],Ne=[],We={},pt={},Qt=[],yt=[],Ye=(G=G||{}).autoSize||!1,un=!1!==G.printHeaders,hn=G.css&&void 0!==G.css["font-size"]?16*G.css["font-size"]:G.fontSize||12,Ue=G.margins||Object.assign({width:this.getPageWidth()},n),ze="number"==typeof G.padding?G.padding:3,ut=G.headerBackgroundColor||"#c8c8c8",lt=G.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=un,this.internal.__cell__.margins=Ue,this.internal.__cell__.table_font_size=hn,this.internal.__cell__.padding=ze,this.internal.__cell__.headerBackgroundColor=ut,this.internal.__cell__.headerTextColor=lt,this.setFontSize(hn),null==L)he=fe=Object.keys(M[0]),Ne=fe.map(function(){return"left"});else if(Array.isArray(L)&&"object"===(0,Ga.Z)(L[0]))for(fe=L.map(function(pn){return pn.name}),he=L.map(function(pn){return pn.prompt||pn.name||""}),Ne=L.map(function(pn){return pn.align||"left"}),V=0;V<L.length;V+=1)pt[L[V].name]=L[V].width*(19.049976/25.4);else Array.isArray(L)&&"string"==typeof L[0]&&(he=fe=L,Ne=fe.map(function(){return"left"}));if(Ye||Array.isArray(L)&&"string"==typeof L[0])for(V=0;V<fe.length;V+=1){for(We[de=fe[V]]=M.map(function(pn){return pn[de]}),this.setFont(void 0,"bold"),Qt.push(this.getTextDimensions(he[V],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),ne=We[de],this.setFont(void 0,"normal"),re=0;re<ne.length;re+=1)Qt.push(this.getTextDimensions(ne[re],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);pt[de]=Math.max.apply(null,Qt)+ze+ze,Qt=[]}if(un){var _n={};for(V=0;V<fe.length;V+=1)_n[fe[V]]={},_n[fe[V]].text=he[V],_n[fe[V]].align=Ne[V];var ft=m.call(this,_n,pt);yt=fe.map(function(pn){return new l(b,E,pt[pn],ft,_n[pn].text,void 0,_n[pn].align)}),this.setTableHeaderRow(yt),this.printHeaderRow(1,!1)}var Ot=L.reduce(function(pn,Ti){return pn[Ti.name]=Ti.align,pn},{});for(V=0;V<M.length;V+=1){"rowStart"in G&&G.rowStart instanceof Function&&G.rowStart({row:V,data:M[V]},this);var wt=m.call(this,M[V],pt);for(re=0;re<fe.length;re+=1){var Yt=M[V][fe[re]];"cellStart"in G&&G.cellStart instanceof Function&&G.cellStart({row:V,col:re,data:Yt},this),h.call(this,new l(b,E,pt[fe[re]],wt,Yt,V+2,Ot[fe[re]]))}}return this.internal.__cell__.table_x=b,this.internal.__cell__.table_y=E,this};var m=function(b,E){var M=this.internal.__cell__.padding,L=this.internal.__cell__.table_font_size,G=this.internal.scaleFactor;return Object.keys(b).map(function(V){var ne=b[V];return this.splitTextToSize(ne.hasOwnProperty("text")?ne.text:ne,E[V]-M-M)},this).map(function(V){return this.getLineHeightFactor()*V.length*L/G+M+M},this).reduce(function(V,ne){return Math.max(V,ne)},0)};t.setTableHeaderRow=function(b){i.call(this),this.internal.__cell__.tableHeaderRow=b},t.printHeaderRow=function(b,E){if(i.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var M;if(e=!0,"function"==typeof this.internal.__cell__.headerFunction){var L=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new l(L[0],L[1],L[2],L[3],void 0,-1)}this.setFont(void 0,"bold");for(var G=[],V=0;V<this.internal.__cell__.tableHeaderRow.length;V+=1){M=this.internal.__cell__.tableHeaderRow[V].clone(),E&&(M.y=this.internal.__cell__.margins.top||0,G.push(M)),M.lineNumber=b;var ne=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),h.call(this,M),this.setTextColor(ne)}G.length>0&&this.setTableHeaderRow(G),this.setFont(void 0,"normal"),e=!1}}(fs.API);var rQ={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},sQ=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],CP=iQ(sQ),oQ=[100,200,300,400,500,600,700,800,900],iae=iQ(oQ);function EP(t){var l,n=t.family.replace(/"|'/g,"").toLowerCase(),e=rQ[l=(l=t.style)||"normal"]?l:"normal",i=function(l){return l?"number"==typeof l?l>=100&&l<=900&&l%100==0?l:400:/^\d00$/.test(l)?parseInt(l):"bold"===l?700:400:400}(t.weight),s=function(l){return"number"==typeof CP[l=l||"normal"]?l:"normal"}(t.stretch);return{family:n,style:e,weight:i,stretch:s,src:t.src||[],ref:t.ref||{name:n,style:[s,e,i].join(" ")}}}function aQ(t,n,e,i){var s;for(s=e;s>=0&&s<n.length;s+=i)if(t[n[s]])return t[n[s]];for(s=e;s>=0&&s<n.length;s-=i)if(t[n[s]])return t[n[s]]}var rae={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},lQ={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function cQ(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function uQ(t){return t.trimLeft()}function oae(t,n){for(var e=0;e<t.length;){if(t.charAt(e)===n)return[t.substring(0,e),t.substring(e+1)];e+=1}return null}function aae(t){var n=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===n?null:[n[0],t.substring(n[0].length)]}var gM,hQ,dQ,SP=["times"];(function(t){var n,e,i,s,l,h,m,b,E,M=function(Se){return this.isStrokeTransparent=(Se=Se||{}).isStrokeTransparent||!1,this.strokeOpacity=Se.strokeOpacity||1,this.strokeStyle=Se.strokeStyle||"#000000",this.fillStyle=Se.fillStyle||"#000000",this.isFillTransparent=Se.isFillTransparent||!1,this.fillOpacity=Se.fillOpacity||1,this.font=Se.font||"10px sans-serif",this.textBaseline=Se.textBaseline||"alphabetic",this.textAlign=Se.textAlign||"left",this.lineWidth=Se.lineWidth||1,this.lineJoin=Se.lineJoin||"miter",this.lineCap=Se.lineCap||"butt",this.path=Se.path||[],this.transform=void 0!==Se.transform?Se.transform.clone():new b,this.globalCompositeOperation=Se.globalCompositeOperation||"normal",this.globalAlpha=Se.globalAlpha||1,this.clip_path=Se.clip_path||[],this.currentPoint=Se.currentPoint||new h,this.miterLimit=Se.miterLimit||10,this.lastPoint=Se.lastPoint||new h,this.lineDashOffset=Se.lineDashOffset||0,this.lineDash=Se.lineDash||[],this.margin=Se.margin||[0,0,0,0],this.prevPageLastElemOffset=Se.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof Se.ignoreClearRect||Se.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new L(this),n=this.internal.f2,e=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,l=this.internal.getVerticalCoordinate,h=this.internal.Point,m=this.internal.Rectangle,b=this.internal.Matrix,E=new M}]);var L=function(Se){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Xe=Se;Object.defineProperty(this,"pdf",{get:function(){return Xe}});var Je=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Je},set:function(Fn){Je=!!Fn}});var _t=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return _t},set:function(Fn){_t=!!Fn}});var Nt=0;Object.defineProperty(this,"posX",{get:function(){return Nt},set:function(Fn){isNaN(Fn)||(Nt=Fn)}});var jt=0;Object.defineProperty(this,"posY",{get:function(){return jt},set:function(Fn){isNaN(Fn)||(jt=Fn)}}),Object.defineProperty(this,"margin",{get:function(){return E.margin},set:function(Fn){var at;"number"==typeof Fn?at=[Fn,Fn,Fn,Fn]:((at=new Array(4))[0]=Fn[0],at[1]=Fn.length>=2?Fn[1]:at[0],at[2]=Fn.length>=3?Fn[2]:at[0],at[3]=Fn.length>=4?Fn[3]:at[1]),E.margin=at}});var en=!1;Object.defineProperty(this,"autoPaging",{get:function(){return en},set:function(Fn){en=Fn}});var sn=0;Object.defineProperty(this,"lastBreak",{get:function(){return sn},set:function(Fn){sn=Fn}});var bi=[];Object.defineProperty(this,"pageBreaks",{get:function(){return bi},set:function(Fn){bi=Fn}}),Object.defineProperty(this,"ctx",{get:function(){return E},set:function(Fn){Fn instanceof M&&(E=Fn)}}),Object.defineProperty(this,"path",{get:function(){return E.path},set:function(Fn){E.path=Fn}});var di=[];Object.defineProperty(this,"ctxStack",{get:function(){return di},set:function(Fn){di=Fn}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Fn){var at;at=G(Fn),this.ctx.fillStyle=at.style,this.ctx.isFillTransparent=0===at.a,this.ctx.fillOpacity=at.a,this.pdf.setFillColor(at.r,at.g,at.b,{a:at.a}),this.pdf.setTextColor(at.r,at.g,at.b,{a:at.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Fn){var at=G(Fn);this.ctx.strokeStyle=at.style,this.ctx.isStrokeTransparent=0===at.a,this.ctx.strokeOpacity=at.a,0===at.a?this.pdf.setDrawColor(255,255,255):this.pdf.setDrawColor(at.r,at.g,at.b)}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Fn){-1!==["butt","round","square"].indexOf(Fn)&&(this.ctx.lineCap=Fn,this.pdf.setLineCap(Fn))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Fn){isNaN(Fn)||(this.ctx.lineWidth=Fn,this.pdf.setLineWidth(Fn))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Fn){-1!==["bevel","round","miter"].indexOf(Fn)&&(this.ctx.lineJoin=Fn,this.pdf.setLineJoin(Fn))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Fn){isNaN(Fn)||(this.ctx.miterLimit=Fn,this.pdf.setMiterLimit(Fn))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Fn){this.ctx.textBaseline=Fn}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Fn){-1!==["right","end","center","left","start"].indexOf(Fn)&&(this.ctx.textAlign=Fn)}});var Yi=null,ss=null;Object.defineProperty(this,"fontFaces",{get:function(){return ss},set:function(Fn){Yi=null,ss=Fn}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Fn){var at;if(this.ctx.font=Fn,null!==(at=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Fn))){var Rs=at[1],yr=at[3],mi=at[4],Ii=at[6],Qi=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(mi)[2];mi=Math.floor("px"===Qi?parseFloat(mi)*this.pdf.internal.scaleFactor:"em"===Qi?parseFloat(mi)*this.pdf.getFontSize():parseFloat(mi)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(mi);var Vi=function(Es){var yo,er,id=[],na=Es.trim();if(""===na)return SP;if(na in lQ)return[lQ[na]];for(;""!==na;){switch(er=null,yo=(na=uQ(na)).charAt(0)){case'"':case"'":er=oae(na.substring(1),yo);break;default:er=aae(na)}if(null===er||(id.push(er[0]),""!==(na=uQ(er[1]))&&","!==na.charAt(0)))return SP;na=na.replace(/^,/,"")}return id}(Ii);if(this.fontFaces){var Rr=function sae(t,n,e){for(var i=(e=e||{}).defaultFontFamily||"times",s=Object.assign({},rae,e.genericFontFamilies||{}),l=null,h=null,m=0;m<n.length;++m)if(s[(l=EP(n[m])).family]&&(l.family=s[l.family]),t.hasOwnProperty(l.family)){h=t[l.family];break}if(!(h=h||t[i]))throw new Error("Could not find a font-family for the rule '"+cQ(l)+"' and default family '"+i+"'.");if(h=function(b,E){if(E[b])return E[b];var M=CP[b],G=aQ(E,sQ,M,M<=CP.normal?-1:1);if(!G)throw new Error("Could not find a matching font-stretch value for "+b);return G}(l.stretch,h),h=function(b,E){if(E[b])return E[b];for(var M=rQ[b],L=0;L<M.length;++L)if(E[M[L]])return E[M[L]];throw new Error("Could not find a matching font-style for "+b)}(l.style,h),!(h=function(b,E){if(E[b])return E[b];if(400===b&&E[500])return E[500];if(500===b&&E[400])return E[400];var L=aQ(E,oQ,iae[b],b<400?-1:1);if(!L)throw new Error("Could not find a matching font-weight for value "+b);return L}(l.weight,h)))throw new Error("Failed to resolve a font for the rule '"+cQ(l)+"'.");return h}(function Ji(Fn,at){if(null===Yi){var Rs=(yr=Fn.getFontList(),mi=[],Object.keys(yr).forEach(function(Ii){yr[Ii].forEach(function(Qi){var Vi=null;switch(Qi){case"bold":Vi={family:Ii,weight:"bold"};break;case"italic":Vi={family:Ii,style:"italic"};break;case"bolditalic":Vi={family:Ii,weight:"bold",style:"italic"};break;case"":case"normal":Vi={family:Ii}}null!==Vi&&(Vi.ref={name:Ii,style:Qi},mi.push(Vi))})}),mi);Yi=function(yr){for(var mi={},Ii=0;Ii<yr.length;++Ii){var Qi=EP(yr[Ii]),Vi=Qi.family,Rr=Qi.stretch,xs=Qi.style,zs=Qi.weight;mi[Vi]=mi[Vi]||{},mi[Vi][Rr]=mi[Vi][Rr]||{},mi[Vi][Rr][xs]=mi[Vi][Rr][xs]||{},mi[Vi][Rr][xs][zs]=Qi}return mi}(Rs.concat(at))}var yr,mi;return Yi}(this.pdf,this.fontFaces),Vi.map(function(Es){return{family:Es,stretch:"normal",weight:yr,style:Rs}}));this.pdf.setFont(Rr.ref.name,Rr.ref.style)}else{var xs="";("bold"===yr||parseInt(yr,10)>=700||"bold"===Rs)&&(xs="bold"),"italic"===Rs&&(xs+="italic"),0===xs.length&&(xs="normal");for(var zs="",io={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Do=0;Do<Vi.length;Do++){if(void 0!==this.pdf.internal.getFont(Vi[Do],xs,{noFallback:!0,disableWarning:!0})){zs=Vi[Do];break}if("bolditalic"===xs&&void 0!==this.pdf.internal.getFont(Vi[Do],"bold",{noFallback:!0,disableWarning:!0}))zs=Vi[Do],xs="bold";else if(void 0!==this.pdf.internal.getFont(Vi[Do],"normal",{noFallback:!0,disableWarning:!0})){zs=Vi[Do],xs="normal";break}}if(""===zs)for(var aa=0;aa<Vi.length;aa++)if(io[Vi[aa]]){zs=io[Vi[aa]];break}this.pdf.setFont(zs=""===zs?"Times":zs,xs)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Fn){this.ctx.globalCompositeOperation=Fn}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Fn){this.ctx.globalAlpha=Fn}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Fn){this.ctx.lineDashOffset=Fn,Ti.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Fn){this.ctx.lineDash=Fn,Ti.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Fn){this.ctx.ignoreClearRect=!!Fn}})};L.prototype.setLineDash=function(Se){this.lineDash=Se},L.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},L.prototype.fill=function(){We.call(this,"fill",!1)},L.prototype.stroke=function(){We.call(this,"stroke",!1)},L.prototype.beginPath=function(){this.path=[{type:"begin"}]},L.prototype.moveTo=function(Se,Xe){if(isNaN(Se)||isNaN(Xe))throw $a.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Je=this.ctx.transform.applyToPoint(new h(Se,Xe));this.path.push({type:"mt",x:Je.x,y:Je.y}),this.ctx.lastPoint=new h(Se,Xe)},L.prototype.closePath=function(){var Se=new h(0,0),Xe=0;for(Xe=this.path.length-1;-1!==Xe;Xe--)if("begin"===this.path[Xe].type&&"object"===(0,Ga.Z)(this.path[Xe+1])&&"number"==typeof this.path[Xe+1].x){Se=new h(this.path[Xe+1].x,this.path[Xe+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new h(Se.x,Se.y)},L.prototype.lineTo=function(Se,Xe){if(isNaN(Se)||isNaN(Xe))throw $a.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Je=this.ctx.transform.applyToPoint(new h(Se,Xe));this.path.push({type:"lt",x:Je.x,y:Je.y}),this.ctx.lastPoint=new h(Je.x,Je.y)},L.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),We.call(this,null,!0)},L.prototype.quadraticCurveTo=function(Se,Xe,Je,_t){if(isNaN(Je)||isNaN(_t)||isNaN(Se)||isNaN(Xe))throw $a.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Nt=this.ctx.transform.applyToPoint(new h(Je,_t)),jt=this.ctx.transform.applyToPoint(new h(Se,Xe));this.path.push({type:"qct",x1:jt.x,y1:jt.y,x:Nt.x,y:Nt.y}),this.ctx.lastPoint=new h(Nt.x,Nt.y)},L.prototype.bezierCurveTo=function(Se,Xe,Je,_t,Nt,jt){if(isNaN(Nt)||isNaN(jt)||isNaN(Se)||isNaN(Xe)||isNaN(Je)||isNaN(_t))throw $a.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var en=this.ctx.transform.applyToPoint(new h(Nt,jt)),sn=this.ctx.transform.applyToPoint(new h(Se,Xe)),bi=this.ctx.transform.applyToPoint(new h(Je,_t));this.path.push({type:"bct",x1:sn.x,y1:sn.y,x2:bi.x,y2:bi.y,x:en.x,y:en.y}),this.ctx.lastPoint=new h(en.x,en.y)},L.prototype.arc=function(Se,Xe,Je,_t,Nt,jt){if(isNaN(Se)||isNaN(Xe)||isNaN(Je)||isNaN(_t)||isNaN(Nt))throw $a.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(jt=!!jt,!this.ctx.transform.isIdentity){var en=this.ctx.transform.applyToPoint(new h(Se,Xe));Se=en.x,Xe=en.y;var sn=this.ctx.transform.applyToPoint(new h(0,Je)),bi=this.ctx.transform.applyToPoint(new h(0,0));Je=Math.sqrt(Math.pow(sn.x-bi.x,2)+Math.pow(sn.y-bi.y,2))}Math.abs(Nt-_t)>=2*Math.PI&&(_t=0,Nt=2*Math.PI),this.path.push({type:"arc",x:Se,y:Xe,radius:Je,startAngle:_t,endAngle:Nt,counterclockwise:jt})},L.prototype.arcTo=function(Se,Xe,Je,_t,Nt){throw new Error("arcTo not implemented.")},L.prototype.rect=function(Se,Xe,Je,_t){if(isNaN(Se)||isNaN(Xe)||isNaN(Je)||isNaN(_t))throw $a.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(Se,Xe),this.lineTo(Se+Je,Xe),this.lineTo(Se+Je,Xe+_t),this.lineTo(Se,Xe+_t),this.lineTo(Se,Xe),this.lineTo(Se+Je,Xe),this.lineTo(Se,Xe)},L.prototype.fillRect=function(Se,Xe,Je,_t){if(isNaN(Se)||isNaN(Xe)||isNaN(Je)||isNaN(_t))throw $a.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!V.call(this)){var Nt={};"butt"!==this.lineCap&&(Nt.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(Nt.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(Se,Xe,Je,_t),this.fill(),Nt.hasOwnProperty("lineCap")&&(this.lineCap=Nt.lineCap),Nt.hasOwnProperty("lineJoin")&&(this.lineJoin=Nt.lineJoin)}},L.prototype.strokeRect=function(Se,Xe,Je,_t){if(isNaN(Se)||isNaN(Xe)||isNaN(Je)||isNaN(_t))throw $a.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");ne.call(this)||(this.beginPath(),this.rect(Se,Xe,Je,_t),this.stroke())},L.prototype.clearRect=function(Se,Xe,Je,_t){if(isNaN(Se)||isNaN(Xe)||isNaN(Je)||isNaN(_t))throw $a.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(Se,Xe,Je,_t))},L.prototype.save=function(Se){Se="boolean"!=typeof Se||Se;for(var Xe=this.pdf.internal.getCurrentPageInfo().pageNumber,Je=0;Je<this.pdf.internal.getNumberOfPages();Je++)this.pdf.setPage(Je+1),this.pdf.internal.out("q");if(this.pdf.setPage(Xe),Se){this.ctx.fontSize=this.pdf.internal.getFontSize();var _t=new M(this.ctx);this.ctxStack.push(this.ctx),this.ctx=_t}},L.prototype.restore=function(Se){Se="boolean"!=typeof Se||Se;for(var Xe=this.pdf.internal.getCurrentPageInfo().pageNumber,Je=0;Je<this.pdf.internal.getNumberOfPages();Je++)this.pdf.setPage(Je+1),this.pdf.internal.out("Q");this.pdf.setPage(Xe),Se&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},L.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var G=function(Se){var Xe,Je,_t,Nt;if(!0===Se.isCanvasGradient&&(Se=Se.getColor()),!Se)return{r:0,g:0,b:0,a:0,style:Se};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(Se))Xe=0,Je=0,_t=0,Nt=0;else{var jt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(Se);if(null!==jt)Xe=parseInt(jt[1]),Je=parseInt(jt[2]),_t=parseInt(jt[3]),Nt=1;else if(null!==(jt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(Se)))Xe=parseInt(jt[1]),Je=parseInt(jt[2]),_t=parseInt(jt[3]),Nt=parseFloat(jt[4]);else{if(Nt=1,"string"==typeof Se&&"#"!==Se.charAt(0)){var en=new qH(Se);Se=en.ok?en.toHex():"#000000"}4===Se.length?(Xe=Se.substring(1,2),Xe+=Xe,Je=Se.substring(2,3),Je+=Je,_t=Se.substring(3,4),_t+=_t):(Xe=Se.substring(1,3),Je=Se.substring(3,5),_t=Se.substring(5,7)),Xe=parseInt(Xe,16),Je=parseInt(Je,16),_t=parseInt(_t,16)}}return{r:Xe,g:Je,b:_t,a:Nt,style:Se}},V=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},ne=function(){return!(!this.ctx.isStrokeTransparent&&0!=this.globalAlpha)};L.prototype.fillText=function(Se,Xe,Je,_t){if(isNaN(Xe)||isNaN(Je)||"string"!=typeof Se)throw $a.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(_t=isNaN(_t)?void 0:_t,!V.call(this)){var Nt=wt(this.ctx.transform.rotation);ze.call(this,{text:Se,x:Xe,y:Je,scale:this.ctx.transform.scaleX,angle:Nt,align:this.textAlign,maxWidth:_t})}},L.prototype.strokeText=function(Se,Xe,Je,_t){if(isNaN(Xe)||isNaN(Je)||"string"!=typeof Se)throw $a.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!ne.call(this)){_t=isNaN(_t)?void 0:_t;var Nt=wt(this.ctx.transform.rotation);ze.call(this,{text:Se,x:Xe,y:Je,scale:this.ctx.transform.scaleX,renderingMode:"stroke",angle:Nt,align:this.textAlign,maxWidth:_t})}},L.prototype.measureText=function(Se){if("string"!=typeof Se)throw $a.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Xe=this.pdf,Je=this.pdf.internal.scaleFactor,_t=Xe.internal.getFontSize(),Nt=Xe.getStringUnitWidth(Se)*_t/Xe.internal.scaleFactor;return new function(en){var sn=(en=en||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return sn}}),this}({width:Nt*=Math.round(96*Je/72*1e4)/1e4})},L.prototype.scale=function(Se,Xe){if(isNaN(Se)||isNaN(Xe))throw $a.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Je=new b(Se,0,0,Xe,0,0);this.ctx.transform=this.ctx.transform.multiply(Je)},L.prototype.rotate=function(Se){if(isNaN(Se))throw $a.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Xe=new b(Math.cos(Se),Math.sin(Se),-Math.sin(Se),Math.cos(Se),0,0);this.ctx.transform=this.ctx.transform.multiply(Xe)},L.prototype.translate=function(Se,Xe){if(isNaN(Se)||isNaN(Xe))throw $a.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Je=new b(1,0,0,1,Se,Xe);this.ctx.transform=this.ctx.transform.multiply(Je)},L.prototype.transform=function(Se,Xe,Je,_t,Nt,jt){if(isNaN(Se)||isNaN(Xe)||isNaN(Je)||isNaN(_t)||isNaN(Nt)||isNaN(jt))throw $a.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var en=new b(Se,Xe,Je,_t,Nt,jt);this.ctx.transform=this.ctx.transform.multiply(en)},L.prototype.setTransform=function(Se,Xe,Je,_t,Nt,jt){Se=isNaN(Se)?1:Se,Xe=isNaN(Xe)?0:Xe,Je=isNaN(Je)?0:Je,_t=isNaN(_t)?1:_t,Nt=isNaN(Nt)?0:Nt,jt=isNaN(jt)?0:jt,this.ctx.transform=new b(Se,Xe,Je,_t,Nt,jt)};var re=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};L.prototype.drawImage=function(Se,Xe,Je,_t,Nt,jt,en,sn,bi){var di=this.pdf.getImageProperties(Se),Yi=1,Ji=1,ss=1,Fn=1;void 0!==_t&&void 0!==sn&&(ss=sn/_t,Fn=bi/Nt,Yi=di.width/_t*sn/_t,Ji=di.height/Nt*bi/Nt),void 0===jt&&(jt=Xe,en=Je,Xe=0,Je=0),void 0!==_t&&void 0===sn&&(sn=_t,bi=Nt),void 0===_t&&void 0===sn&&(sn=di.width,bi=di.height);for(var at,Rs=this.ctx.transform.decompose(),yr=wt(Rs.rotate.shx),mi=new b,Ii=(mi=(mi=(mi=mi.multiply(Rs.translate)).multiply(Rs.skew)).multiply(Rs.scale)).applyToRectangle(new m(jt-Xe*ss,en-Je*Fn,_t*Yi,Nt*Ji)),Qi=de.call(this,Ii),Vi=[],Rr=0;Rr<Qi.length;Rr+=1)-1===Vi.indexOf(Qi[Rr])&&Vi.push(Qi[Rr]);if(Ne(Vi),this.autoPaging)for(var xs=Vi[0],zs=Vi[Vi.length-1],io=xs;io<zs+1;io++){this.pdf.setPage(io);var Do=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],aa=1===io?this.posY+this.margin[0]:this.margin[0],yo=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],er=1===io?0:this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2]+(io-2)*yo;if(0!==this.ctx.clip_path.length){var id=this.path;at=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=he(at,this.posX+this.margin[3],-er+aa+this.ctx.prevPageLastElemOffset),pt.call(this,"fill",!0),this.path=id}var na=JSON.parse(JSON.stringify(Ii));na=he([na],this.posX+this.margin[3],-er+aa+this.ctx.prevPageLastElemOffset)[0];var yg=(io>xs||io<zs)&&re.call(this);yg&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Do,yo,null).clip().discardPath()),this.pdf.addImage(Se,"JPEG",na.x,na.y,na.w,na.h,null,null,yr),yg&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(Se,"JPEG",Ii.x,Ii.y,Ii.w,Ii.h,null,null,yr)};var de=function(Se,Xe,Je){var _t=[];Xe=Xe||this.pdf.internal.pageSize.width,Je=Je||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Nt=this.posY+this.ctx.prevPageLastElemOffset;switch(Se.type){default:case"mt":case"lt":_t.push(Math.floor((Se.y+Nt)/Je)+1);break;case"arc":_t.push(Math.floor((Se.y+Nt-Se.radius)/Je)+1),_t.push(Math.floor((Se.y+Nt+Se.radius)/Je)+1);break;case"qct":var jt=Yt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Se.x1,Se.y1,Se.x,Se.y);_t.push(Math.floor((jt.y+Nt)/Je)+1),_t.push(Math.floor((jt.y+jt.h+Nt)/Je)+1);break;case"bct":var en=pn(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Se.x1,Se.y1,Se.x2,Se.y2,Se.x,Se.y);_t.push(Math.floor((en.y+Nt)/Je)+1),_t.push(Math.floor((en.y+en.h+Nt)/Je)+1);break;case"rect":_t.push(Math.floor((Se.y+Nt)/Je)+1),_t.push(Math.floor((Se.y+Se.h+Nt)/Je)+1)}for(var sn=0;sn<_t.length;sn+=1)for(;this.pdf.internal.getNumberOfPages()<_t[sn];)fe.call(this);return _t},fe=function(){var Se=this.fillStyle,Xe=this.strokeStyle,Je=this.font,_t=this.lineCap,Nt=this.lineWidth,jt=this.lineJoin;this.pdf.addPage(),this.fillStyle=Se,this.strokeStyle=Xe,this.font=Je,this.lineCap=_t,this.lineWidth=Nt,this.lineJoin=jt},he=function(Se,Xe,Je){for(var _t=0;_t<Se.length;_t++)switch(Se[_t].type){case"bct":Se[_t].x2+=Xe,Se[_t].y2+=Je;case"qct":Se[_t].x1+=Xe,Se[_t].y1+=Je;default:Se[_t].x+=Xe,Se[_t].y+=Je}return Se},Ne=function(Se){return Se.sort(function(Xe,Je){return Xe-Je})},We=function(Se,Xe){for(var Je,_t,Nt=this.fillStyle,jt=this.strokeStyle,en=this.lineCap,sn=this.lineWidth,bi=Math.abs(sn*this.ctx.transform.scaleX),di=this.lineJoin,Yi=JSON.parse(JSON.stringify(this.path)),Ji=JSON.parse(JSON.stringify(this.path)),ss=[],Fn=0;Fn<Ji.length;Fn++)if(void 0!==Ji[Fn].x)for(var at=de.call(this,Ji[Fn]),Rs=0;Rs<at.length;Rs+=1)-1===ss.indexOf(at[Rs])&&ss.push(at[Rs]);for(var yr=0;yr<ss.length;yr++)for(;this.pdf.internal.getNumberOfPages()<ss[yr];)fe.call(this);if(Ne(ss),this.autoPaging)for(var mi=ss[0],Ii=ss[ss.length-1],Qi=mi;Qi<Ii+1;Qi++){this.pdf.setPage(Qi),this.fillStyle=Nt,this.strokeStyle=jt,this.lineCap=en,this.lineWidth=bi,this.lineJoin=di;var Vi=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Rr=1===Qi?this.posY+this.margin[0]:this.margin[0],zs=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],io=1===Qi?0:this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2]+(Qi-2)*zs;if(0!==this.ctx.clip_path.length){var Do=this.path;Je=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=he(Je,this.posX+this.margin[3],-io+Rr+this.ctx.prevPageLastElemOffset),pt.call(this,Se,!0),this.path=Do}if(_t=JSON.parse(JSON.stringify(Yi)),this.path=he(_t,this.posX+this.margin[3],-io+Rr+this.ctx.prevPageLastElemOffset),!1===Xe||0===Qi){var aa=(Qi>mi||Qi<Ii)&&re.call(this);aa&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Vi,zs,null).clip().discardPath()),pt.call(this,Se,Xe),aa&&this.pdf.restoreGraphicsState()}this.lineWidth=sn}else this.lineWidth=bi,pt.call(this,Se,Xe),this.lineWidth=sn;this.path=Yi},pt=function(Se,Xe){if(("stroke"!==Se||Xe||!ne.call(this))&&("stroke"===Se||Xe||!V.call(this))){for(var Je,_t,Nt=[],jt=this.path,en=0;en<jt.length;en++){var sn=jt[en];switch(sn.type){case"begin":Nt.push({begin:!0});break;case"close":Nt.push({close:!0});break;case"mt":Nt.push({start:sn,deltas:[],abs:[]});break;case"lt":var bi=Nt.length;if(jt[en-1]&&!isNaN(jt[en-1].x)&&(Je=[sn.x-jt[en-1].x,sn.y-jt[en-1].y],bi>0))for(;bi>=0;bi--)if(!0!==Nt[bi-1].close&&!0!==Nt[bi-1].begin){Nt[bi-1].deltas.push(Je),Nt[bi-1].abs.push(sn);break}break;case"bct":Nt[Nt.length-1].deltas.push(Je=[sn.x1-jt[en-1].x,sn.y1-jt[en-1].y,sn.x2-jt[en-1].x,sn.y2-jt[en-1].y,sn.x-jt[en-1].x,sn.y-jt[en-1].y]);break;case"qct":Nt[Nt.length-1].deltas.push(Je=[jt[en-1].x+2/3*(sn.x1-jt[en-1].x)-jt[en-1].x,jt[en-1].y+2/3*(sn.y1-jt[en-1].y)-jt[en-1].y,sn.x+2/3*(sn.x1-sn.x)-jt[en-1].x,sn.y+2/3*(sn.y1-sn.y)-jt[en-1].y,sn.x-jt[en-1].x,sn.y-jt[en-1].y]);break;case"arc":Nt.push({deltas:[],abs:[],arc:!0}),Array.isArray(Nt[Nt.length-1].abs)&&Nt[Nt.length-1].abs.push(sn)}}_t=Xe?null:"stroke"===Se?"stroke":"fill";for(var Rs=!1,yr=0;yr<Nt.length;yr++)if(Nt[yr].arc)for(var mi=Nt[yr].abs,Ii=0;Ii<mi.length;Ii++){var Qi=mi[Ii];"arc"===Qi.type?Ye.call(this,Qi.x,Qi.y,Qi.radius,Qi.startAngle,Qi.endAngle,Qi.counterclockwise,void 0,Xe,!Rs):ut.call(this,Qi.x,Qi.y),Rs=!0}else!0===Nt[yr].close?(this.pdf.internal.out("h"),Rs=!1):!0!==Nt[yr].begin&&(lt.call(this,Nt[yr].deltas,Nt[yr].start.x,Nt[yr].start.y),Rs=!0);_t&&un.call(this,_t),Xe&&hn.call(this)}},Qt=function(Se){var Xe=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Je=Xe*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return Se-Je;case"top":return Se+Xe-Je;case"hanging":return Se+Xe-2*Je;case"middle":return Se+Xe/2-Je;default:return Se}},yt=function(Se){return Se+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};L.prototype.createLinearGradient=function(){var Se=function(){};return Se.colorStops=[],Se.addColorStop=function(Xe,Je){this.colorStops.push([Xe,Je])},Se.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},Se.isCanvasGradient=!0,Se},L.prototype.createPattern=function(){return this.createLinearGradient()},L.prototype.createRadialGradient=function(){return this.createLinearGradient()};var Ye=function(Se,Xe,Je,_t,Nt,jt,en,sn,bi){for(var di=ft.call(this,Je,_t,Nt,jt),Yi=0;Yi<di.length;Yi++){var Ji=di[Yi];0===Yi&&(bi?Ue.call(this,Ji.x1+Se,Ji.y1+Xe):ut.call(this,Ji.x1+Se,Ji.y1+Xe)),_n.call(this,Se,Xe,Ji.x2,Ji.y2,Ji.x3,Ji.y3,Ji.x4,Ji.y4)}sn?hn.call(this):un.call(this,en)},un=function(Se){switch(Se){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},hn=function(){this.pdf.clip(),this.pdf.discardPath()},Ue=function(Se,Xe){this.pdf.internal.out(e(Se)+" "+i(Xe)+" m")},ze=function(Se){var Xe;switch(Se.align){case"right":case"end":Xe="right";break;case"center":Xe="center";break;default:Xe="left"}var Je=this.pdf.getTextDimensions(Se.text),_t=Qt.call(this,Se.y),Nt=yt.call(this,_t)-Je.h,jt=this.ctx.transform.applyToPoint(new h(Se.x,_t)),en=this.ctx.transform.decompose(),sn=new b;sn=(sn=(sn=sn.multiply(en.translate)).multiply(en.skew)).multiply(en.scale);for(var bi,di,Yi,Ji=this.ctx.transform.applyToRectangle(new m(Se.x,_t,Je.w,Je.h)),ss=sn.applyToRectangle(new m(Se.x,Nt,Je.w,Je.h)),Fn=de.call(this,ss),at=[],Rs=0;Rs<Fn.length;Rs+=1)-1===at.indexOf(Fn[Rs])&&at.push(Fn[Rs]);if(Ne(at),this.autoPaging)for(var yr=at[0],mi=at[at.length-1],Ii=yr;Ii<mi+1;Ii++){this.pdf.setPage(Ii);var Qi=1===Ii?this.posY+this.margin[0]:this.margin[0],Rr=this.pdf.internal.pageSize.height-this.margin[2],xs=Rr-this.margin[0],zs=this.pdf.internal.pageSize.width-this.margin[1],io=zs-this.margin[3],Do=1===Ii?0:this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2]+(Ii-2)*xs;if(0!==this.ctx.clip_path.length){var aa=this.path;bi=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=he(bi,this.posX+this.margin[3],-1*Do+Qi),pt.call(this,"fill",!0),this.path=aa}var Es=he([JSON.parse(JSON.stringify(ss))],this.posX+this.margin[3],-Do+Qi+this.ctx.prevPageLastElemOffset)[0];Se.scale>=.01&&(di=this.pdf.internal.getFontSize(),this.pdf.setFontSize(di*Se.scale),this.lineWidth=(Yi=this.lineWidth)*Se.scale);var yo="text"!==this.autoPaging;if(yo||Es.y+Es.h<=Rr){if(yo||Es.y>=Qi&&Es.x<=zs){var er=yo?Se.text:this.pdf.splitTextToSize(Se.text,Se.maxWidth||zs-Es.x)[0],id=he([JSON.parse(JSON.stringify(Ji))],this.posX+this.margin[3],-Do+Qi+this.ctx.prevPageLastElemOffset)[0],na=yo&&(Ii>yr||Ii<mi)&&re.call(this);na&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],io,xs,null).clip().discardPath()),this.pdf.text(er,id.x,id.y,{angle:Se.angle,align:Xe,renderingMode:Se.renderingMode}),na&&this.pdf.restoreGraphicsState()}}else Es.y<Rr&&(this.ctx.prevPageLastElemOffset+=Rr-Es.y);Se.scale>=.01&&(this.pdf.setFontSize(di),this.lineWidth=Yi)}else Se.scale>=.01&&(di=this.pdf.internal.getFontSize(),this.pdf.setFontSize(di*Se.scale),this.lineWidth=(Yi=this.lineWidth)*Se.scale),this.pdf.text(Se.text,jt.x+this.posX,jt.y+this.posY,{angle:Se.angle,align:Xe,renderingMode:Se.renderingMode,maxWidth:Se.maxWidth}),Se.scale>=.01&&(this.pdf.setFontSize(di),this.lineWidth=Yi)},ut=function(Se,Xe,Je,_t){_t=_t||0,this.pdf.internal.out(e(Se+(Je=Je||0))+" "+i(Xe+_t)+" l")},lt=function(Se,Xe,Je){return this.pdf.lines(Se,Xe,Je,null,null)},_n=function(Se,Xe,Je,_t,Nt,jt,en,sn){this.pdf.internal.out([n(s(Je+Se)),n(l(_t+Xe)),n(s(Nt+Se)),n(l(jt+Xe)),n(s(en+Se)),n(l(sn+Xe)),"c"].join(" "))},ft=function(Se,Xe,Je,_t){for(var Nt=2*Math.PI,jt=Math.PI/2;Xe>Je;)Xe-=Nt;var en=Math.abs(Je-Xe);en<Nt&&_t&&(en=Nt-en);for(var sn=[],bi=_t?-1:1,di=Xe;en>1e-5;){var Yi=di+bi*Math.min(en,jt);sn.push(Ot.call(this,Se,di,Yi)),en-=Math.abs(Yi-di),di=Yi}return sn},Ot=function(Se,Xe,Je){var _t=(Je-Xe)/2,Nt=Se*Math.cos(_t),jt=Se*Math.sin(_t),en=Nt,sn=-jt,bi=en*en+sn*sn,di=bi+en*Nt+sn*jt,Yi=4/3*(Math.sqrt(2*bi*di)-di)/(en*jt-sn*Nt),Ji=en-Yi*sn,ss=sn+Yi*en,Fn=Ji,at=-ss,Rs=_t+Xe,yr=Math.cos(Rs),mi=Math.sin(Rs);return{x1:Se*Math.cos(Xe),y1:Se*Math.sin(Xe),x2:Ji*yr-ss*mi,y2:Ji*mi+ss*yr,x3:Fn*yr-at*mi,y3:Fn*mi+at*yr,x4:Se*Math.cos(Je),y4:Se*Math.sin(Je)}},wt=function(Se){return 180*Se/Math.PI},Yt=function(Se,Xe,Je,_t,Nt,jt){var en=Se+.5*(Je-Se),sn=Xe+.5*(_t-Xe),bi=Nt+.5*(Je-Nt),di=jt+.5*(_t-jt),Yi=Math.min(Se,Nt,en,bi),Ji=Math.max(Se,Nt,en,bi),ss=Math.min(Xe,jt,sn,di),Fn=Math.max(Xe,jt,sn,di);return new m(Yi,ss,Ji-Yi,Fn-ss)},pn=function(Se,Xe,Je,_t,Nt,jt,en,sn){var bi,di,Yi,Ji,ss,Fn,at,Rs,yr,mi,Ii,Qi,Vi,Rr,xs=Je-Se,zs=_t-Xe,io=Nt-Je,Do=jt-_t,aa=en-Nt,Es=sn-jt;for(di=0;di<41;di++)yr=(at=(Yi=Se+(bi=di/40)*xs)+bi*((ss=Je+bi*io)-Yi))+bi*(ss+bi*(Nt+bi*aa-ss)-at),mi=(Rs=(Ji=Xe+bi*zs)+bi*((Fn=_t+bi*Do)-Ji))+bi*(Fn+bi*(jt+bi*Es-Fn)-Rs),0==di?(Ii=yr,Qi=mi,Vi=yr,Rr=mi):(Ii=Math.min(Ii,yr),Qi=Math.min(Qi,mi),Vi=Math.max(Vi,yr),Rr=Math.max(Rr,mi));return new m(Math.round(Ii),Math.round(Qi),Math.round(Vi-Ii),Math.round(Rr-Qi))},Ti=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var Je=JSON.stringify({lineDash:this.ctx.lineDash,lineDashOffset:this.ctx.lineDashOffset});this.prevLineDash!==Je&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Je)}}})(fs.API),
/**
         * @license
         * jsPDF filters PlugIn
         * Copyright (c) 2014 Aras Abbasi
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(t){var n=function(l){var h,m,b,E,M,L,G,V,ne,re;for(/[^\x00-\xFF]/.test(l),m=[],b=0,E=(l+=h="\0\0\0\0".slice(l.length%4||4)).length;E>b;b+=4)0!==(M=(l.charCodeAt(b)<<24)+(l.charCodeAt(b+1)<<16)+(l.charCodeAt(b+2)<<8)+l.charCodeAt(b+3))?(L=(M=((M=((M=((M=(M-(re=M%85))/85)-(ne=M%85))/85)-(V=M%85))/85)-(G=M%85))/85)%85,m.push(L+33,G+33,V+33,ne+33,re+33)):m.push(122);return function(de,fe){for(var he=fe;he>0;he--)de.pop()}(m,h.length),String.fromCharCode.apply(String,m)+"~>"},e=function(l){var h,m,b,E,M,L=String,G="length",V=255,ne="charCodeAt",re="slice",de="replace";for(l[re](-2),l=l[re](0,-2)[de](/\s/g,"")[de]("z","!!!!!"),b=[],E=0,M=(l+=h="uuuuu"[re](l[G]%5||5))[G];M>E;E+=5)m=52200625*(l[ne](E)-33)+614125*(l[ne](E+1)-33)+7225*(l[ne](E+2)-33)+85*(l[ne](E+3)-33)+(l[ne](E+4)-33),b.push(V&m>>24,V&m>>16,V&m>>8,V&m);return function(fe,he){for(var Ne=he;Ne>0;Ne--)fe.pop()}(b,h[G]),L.fromCharCode.apply(L,b)},i=function(l){var h=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(l=l.replace(/\s/g,"")).indexOf(">")&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),!1===h.test(l))return"";for(var m="",b=0;b<l.length;b+=2)m+=String.fromCharCode("0x"+(l[b]+l[b+1]));return m},s=function(l){for(var h=new Uint8Array(l.length),m=l.length;m--;)h[m]=l.charCodeAt(m);return(h=dS(h)).reduce(function(b,E){return b+String.fromCharCode(E)},"")};t.processDataByFilters=function(l,h){var m=0,b=l||"",E=[];for("string"==typeof(h=h||[])&&(h=[h]),m=0;m<h.length;m+=1)switch(h[m]){case"ASCII85Decode":case"/ASCII85Decode":b=e(b),E.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":b=n(b),E.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":b=i(b),E.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":b=b.split("").map(function(M){return("0"+M.charCodeAt().toString(16)).slice(-2)}).join("")+">",E.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":b=s(b),E.push("/FlateDecode");break;default:throw new Error('The filter: "'+h[m]+'" is not implemented')}return{data:b,reverseChain:E.reverse().join(" ")}}}(fs.API),
/**
         * @license
         * jsPDF fileloading PlugIn
         * Copyright (c) 2018 Aras Abbasi (aras.abbasi@gmail.com)
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(t){t.loadFile=function(n,e,i){return function(s,l,h){l=!1!==l,h="function"==typeof h?h:function(){};var m=void 0;try{m=function(b,E,M){var L=new XMLHttpRequest,G=0,V=function(ne){var re=ne.length,de=[],fe=String.fromCharCode;for(G=0;G<re;G+=1)de.push(fe(255&ne.charCodeAt(G)));return de.join("")};if(L.open("GET",b,!E),L.overrideMimeType("text/plain; charset=x-user-defined"),!1===E&&(L.onload=function(){M(200===L.status?V(this.responseText):void 0)}),L.send(null),E&&200===L.status)return V(L.responseText)}(s,l,h)}catch{}return m}(n,e,i)},t.loadImageFile=t.loadFile}(fs.API),function(t){function n(){return(ms.html2canvas?Promise.resolve(ms.html2canvas):Promise.resolve().then(Zs.t.bind(Zs,4456,23))).catch(function(h){return Promise.reject(new Error("Could not load html2canvas: "+h))}).then(function(h){return h.default?h.default:h})}function e(){return(ms.DOMPurify?Promise.resolve(ms.DOMPurify):Zs.e(896).then(Zs.t.bind(Zs,896,23))).catch(function(h){return Promise.reject(new Error("Could not load dompurify: "+h))}).then(function(h){return h.default?h.default:h})}var i=function(h){var m=(0,Ga.Z)(h);return"undefined"===m?"undefined":"string"===m||h instanceof String?"string":"number"===m||h instanceof Number?"number":"function"===m||h instanceof Function?"function":h&&h.constructor===Array?"array":h&&1===h.nodeType?"element":"object"===m?"object":"unknown"},s=function(h,m){var b=document.createElement(h);for(var E in m.className&&(b.className=m.className),m.innerHTML&&m.dompurify&&(b.innerHTML=m.dompurify.sanitize(m.innerHTML)),m.style)b.style[E]=m.style[E];return b},l=function h(m){var b=Object.assign(h.convert(Promise.resolve()),JSON.parse(JSON.stringify(h.template))),E=h.convert(Promise.resolve(),b);return(E=E.setProgress(1,h,1,[h])).set(m)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(h,m){return h.__proto__=m||l.prototype,h},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(h,m){return this.then(function(){switch(m=m||function(b){switch(i(b)){case"string":return"string";case"element":return"canvas"===b.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(h)){case"string":return this.then(e).then(function(b){return this.set({src:s("div",{innerHTML:h,dompurify:b})})});case"element":return this.set({src:h});case"canvas":return this.set({canvas:h});case"img":return this.set({img:h});default:return this.error("Unknown source type.")}})},l.prototype.to=function(h){switch(h){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var h={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},m=function b(E,M){for(var L=3===E.nodeType?document.createTextNode(E.nodeValue):E.cloneNode(!1),G=E.firstChild;G;G=G.nextSibling)!0!==M&&1===G.nodeType&&"SCRIPT"===G.nodeName||L.appendChild(b(G,M));return 1===E.nodeType&&("CANVAS"===E.nodeName?(L.width=E.width,L.height=E.height,L.getContext("2d").drawImage(E,0,0)):"TEXTAREA"!==E.nodeName&&"SELECT"!==E.nodeName||(L.value=E.value),L.addEventListener("load",function(){L.scrollTop=E.scrollTop,L.scrollLeft=E.scrollLeft},!0)),L}(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===m.tagName&&(h.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:h}),this.prop.container.appendChild(m),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){return this.thenList([function(){return document.body.contains(this.prop.container)||this.toContainer()}]).then(n).then(function(m){var b=Object.assign({},this.opt.html2canvas);return delete b.onrendered,m(this.prop.container,b)}).then(function(m){(this.opt.html2canvas.onrendered||function(){})(m),this.prop.canvas=m,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){return this.thenList([function(){return document.body.contains(this.prop.container)||this.toContainer()}]).then(n).then(function(m){var b=this.opt.jsPDF,E=this.opt.fontFaces,M="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,L=Object.assign({async:!0,allowTaint:!0,scale:M,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete L.onrendered,b.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,b.context2d.posX=this.opt.x,b.context2d.posY=this.opt.y,b.context2d.margin=this.opt.margin,b.context2d.fontFaces=E,E)for(var G=0;G<E.length;++G){var V=E[G],ne=V.src.find(function(re){return"truetype"===re.format});ne&&b.addFont(ne.url,V.ref.name,V.ref.style)}return L.windowHeight=L.windowHeight||0,L.windowHeight=0==L.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):L.windowHeight,b.context2d.save(!0),m(this.prop.container,L)}).then(function(m){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(m),this.prop.canvas=m,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var h=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=h})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(h,m,b){return"img"===(b=b||"pdf").toLowerCase()||"image"===b.toLowerCase()?this.outputImg(h,m):this.outputPdf(h,m)},l.prototype.outputPdf=function(h,m){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(h,m)})},l.prototype.outputImg=function(h){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(h){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+h+'" is not supported.'}})},l.prototype.save=function(h){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(h?{filename:h}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(h){if("object"!==i(h))return this;var m=Object.keys(h||{}).map(function(b){if(b in l.template.prop)return function(){this.prop[b]=h[b]};switch(b){case"margin":return this.setMargin.bind(this,h.margin);case"jsPDF":return function(){return this.opt.jsPDF=h.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,h.pageSize);default:return function(){this.opt[b]=h[b]}}},this);return this.then(function(){return this.thenList(m)})},l.prototype.get=function(h,m){return this.then(function(){var b=h in l.template.prop?this.prop[h]:this.opt[h];return m?m(b):b})},l.prototype.setMargin=function(h){return this.then(function(){switch(i(h)){case"number":h=[h,h,h,h];case"array":if(2===h.length&&(h=[h[0],h[1],h[0],h[1]]),4===h.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=h}).then(this.setPageSize)},l.prototype.setPageSize=function(h){function m(b,E){return Math.floor(b*E/72*96)}return this.then(function(){(h=h||fs.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(h.inner={width:h.width-this.opt.margin[1]-this.opt.margin[3],height:h.height-this.opt.margin[0]-this.opt.margin[2]},h.inner.px={width:m(h.inner.width,h.k),height:m(h.inner.height,h.k)},h.inner.ratio=h.inner.height/h.inner.width),this.prop.pageSize=h})},l.prototype.setProgress=function(h,m,b,E){return null!=h&&(this.progress.val=h),null!=m&&(this.progress.state=m),null!=b&&(this.progress.n=b),null!=E&&(this.progress.stack=E),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(h,m,b,E){return this.setProgress(h?this.progress.val+h:null,m||null,b?this.progress.n+b:null,E?this.progress.stack.concat(E):null)},l.prototype.then=function(h,m){var b=this;return this.thenCore(h,m,function(E,M){return b.updateProgress(null,null,1,[E]),Promise.prototype.then.call(this,function(L){return b.updateProgress(null,E),L}).then(E,M).then(function(L){return b.updateProgress(1),L})})},l.prototype.thenCore=function(h,m,b){b=b||Promise.prototype.then,h&&(h=h.bind(this)),m&&(m=m.bind(this));var E=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?this:l.convert(Object.assign({},this),Promise.prototype),M=b.call(E,h,m);return l.convert(M,this.__proto__)},l.prototype.thenExternal=function(h,m){return Promise.prototype.then.call(this,h,m)},l.prototype.thenList=function(h){var m=this;return h.forEach(function(b){m=m.thenCore(b)}),m},l.prototype.catch=function(h){h&&(h=h.bind(this));var m=Promise.prototype.catch.call(this,h);return l.convert(m,this)},l.prototype.catchExternal=function(h){return Promise.prototype.catch.call(this,h)},l.prototype.error=function(h){return this.then(function(){throw new Error(h)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,fs.getPageSize=function(h,m,b){if("object"===(0,Ga.Z)(h)){var E=h;h=E.orientation,m=E.unit||m,b=E.format||b}m=m||"mm",b=b||"a4",h=(""+(h||"P")).toLowerCase();var M,L=(""+b).toLowerCase(),G={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(m){case"pt":M=1;break;case"mm":M=72/25.4;break;case"cm":M=72/2.54;break;case"in":M=72;break;case"px":M=.75;break;case"pc":case"em":M=12;break;case"ex":M=6;break;default:throw"Invalid unit: "+m}var V,ne=0,re=0;if(G.hasOwnProperty(L))ne=G[L][1]/M,re=G[L][0]/M;else try{ne=b[1],re=b[0]}catch{throw new Error("Invalid format: "+b)}if("p"===h||"portrait"===h)h="p",re>ne&&(V=re,re=ne,ne=V);else{if("l"!==h&&"landscape"!==h)throw"Invalid orientation: "+h;h="l",ne>re&&(V=re,re=ne,ne=V)}return{width:re,height:ne,unit:m,k:M,orientation:h}},t.html=function(h,m){(m=m||{}).callback=m.callback||function(){},m.html2canvas=m.html2canvas||{},m.html2canvas.canvas=m.html2canvas.canvas||this.canvas,m.jsPDF=m.jsPDF||this,m.fontFaces=m.fontFaces?m.fontFaces.map(EP):null;var b=new l(m);return m.worker?b:b.from(h).doCallback()}}(fs.API),fs.API.addJS=function(t){return dQ=t,this.internal.events.subscribe("postPutResources",function(){gM=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(gM+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),hQ=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+dQ+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==gM&&void 0!==hQ&&this.internal.out("/Names <</JavaScript "+gM+" 0 R>>")}),this},
/**
         * @license
         * Copyright (c) 2014 Steven Spungin (TwelveTone LLC)  steven@twelvetone.tv
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(t){var n;t.events.push(["postPutResources",function(){var e=this,i=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=e.outline.render().split(/\r\n/),l=0;l<s.length;l++){var h=s[l],m=i.exec(h);null!=m&&e.internal.newObjectDeferredBegin(m[1],!1),e.internal.write(h)}if(this.outline.createNamedDestinations){var E=this.internal.pages.length,M=[];for(l=0;l<E;l++){var L=e.internal.newObject();M.push(L);var G=e.internal.getPageInfo(l+1);e.internal.write("<< /D["+G.objId+" 0 R /XYZ null null null]>> endobj")}var V=e.internal.newObject();for(e.internal.write("<< /Names [ "),l=0;l<M.length;l++)e.internal.write("(page_"+(l+1)+")"+M[l]+" 0 R");e.internal.write(" ] >>","endobj"),n=e.internal.newObject(),e.internal.write("<< /Dests "+V+" 0 R"),e.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+n+" 0 R"))}]),t.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(i,s,l){var h={title:s,options:l,children:[]};return null==i&&(i=this.root),i.children.push(h),h},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(i){i.id=e.internal.newObjectDeferred();for(var s=0;s<i.children.length;s++)this.genIds_r(i.children[s])},e.outline.renderRoot=function(i){this.objStart(i),this.line("/Type /Outlines"),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1]))),this.line("/Count "+this.count_r({count:0},i)),this.objEnd()},e.outline.renderItems=function(i){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,l=0;l<i.children.length;l++){var h=i.children[l];this.objStart(h),this.line("/Title "+this.makeString(h.title)),this.line("/Parent "+this.makeRef(i)),l>0&&this.line("/Prev "+this.makeRef(i.children[l-1])),l<i.children.length-1&&this.line("/Next "+this.makeRef(i.children[l+1])),h.children.length>0&&(this.line("/First "+this.makeRef(h.children[0])),this.line("/Last "+this.makeRef(h.children[h.children.length-1])));var m=this.count=this.count_r({count:0},h);if(m>0&&this.line("/Count "+m),h.options&&h.options.pageNumber){var b=e.internal.getPageInfo(h.options.pageNumber);this.line("/Dest ["+b.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var E=0;E<i.children.length;E++)this.renderItems(i.children[E])},e.outline.line=function(i){this.ctx.val+=i+"\r\n"},e.outline.makeRef=function(i){return i.id+" 0 R"},e.outline.makeString=function(i){return"("+e.internal.pdfEscape(i)+")"},e.outline.objStart=function(i){this.ctx.val+="\r\n"+i.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(i,s){for(var l=0;l<s.children.length;l++)i.count++,this.count_r(i,s.children[l]);return i.count}}])}(fs.API),
/**
         * @license
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(t){var n=[192,193,194,195,196,197,198,199];t.processJPEG=function(e,i,s,l,h,m){var b,E=this.decode.DCT_DECODE,M=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=this.__addimage__.isArrayBuffer(e=h||e)?new Uint8Array(e):e,(b=function(L){for(var G,V=256*L.charCodeAt(4)+L.charCodeAt(5),ne=L.length,re={width:0,height:0,numcomponents:1},de=4;de<ne;de+=2){if(-1!==n.indexOf(L.charCodeAt((de+=V)+1))){G=256*L.charCodeAt(de+5)+L.charCodeAt(de+6),re={width:256*L.charCodeAt(de+7)+L.charCodeAt(de+8),height:G,numcomponents:L.charCodeAt(de+9)};break}V=256*L.charCodeAt(de+2)+L.charCodeAt(de+3)}return re}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:m=this.color_spaces.DEVICE_GRAY;break;case 4:m=this.color_spaces.DEVICE_CMYK;break;case 3:m=this.color_spaces.DEVICE_RGB}M={data:e,width:b.width,height:b.height,colorSpace:m,bitsPerComponent:8,filter:E,index:i,alias:s}}return M}}(fs.API);var jx,mM,fQ,AQ,pQ,lae=function(){var t,n,e;function i(l){var h,b,E,M,L,G,V,ne,re,de,fe,he,Ne;for(this.data=l,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},L=null;;){switch(h=this.readUInt32(),ne=function(){var We,pt;for(pt=[],We=0;We<4;++We)pt.push(String.fromCharCode(this.data[this.pos++]));return pt}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(h);break;case"fcTL":L&&this.animation.frames.push(L),this.pos+=4,L={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},M=this.readUInt16(),E=this.readUInt16()||100,L.delay=1e3*M/E,L.disposeOp=this.data[this.pos++],L.blendOp=this.data[this.pos++],L.data=[];break;case"IDAT":case"fdAT":for("fdAT"===ne&&(this.pos+=4,h-=4),l=L?.data||this.imgData,fe=0;0<=h?fe<h:fe>h;0<=h?++fe:--fe)l.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(b=this.palette.length/3,this.transparency.indexed=this.read(h),this.transparency.indexed.length>b)throw new Error("More transparent colors than palette size");if((re=b-this.transparency.indexed.length)>0)for(he=0;0<=re?he<re:he>re;0<=re?++he:--he)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(h)[0];break;case 2:this.transparency.rgb=this.read(h)}break;case"tEXt":G=(de=this.read(h)).indexOf(0),V=String.fromCharCode.apply(String,de.slice(0,G)),this.text[V]=String.fromCharCode.apply(String,de.slice(G+1));break;case"IEND":return L&&this.animation.frames.push(L),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(Ne=this.colorType)||6===Ne,this.pixelBitlength=this.bits*(this.colors+(this.hasAlphaChannel?1:0)),this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=h}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}i.prototype.read=function(l){var h,m;for(m=[],h=0;0<=l?h<l:h>l;0<=l?++h:--h)m.push(this.data[this.pos++]);return m},i.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},i.prototype.decodePixels=function(l){var h=this.pixelBitlength/8,m=new Uint8Array(this.width*this.height*h),b=0,E=this;if(null==l&&(l=this.imgData),0===l.length)return new Uint8Array(0);function M(L,G,V,ne){var re,de,fe,he,Ne,We,pt,Qt,Ye,un,hn,Ue,ze,ut,lt,_n,ft,Ot,wt,Yt,pn=Math.ceil((E.width-L)/V),Ti=Math.ceil((E.height-G)/ne),Se=E.width==pn&&E.height==Ti;for(ze=h*pn,hn=Se?m:new Uint8Array(ze*Ti),We=l.length,Ue=0,de=0;Ue<Ti&&b<We;){switch(l[b++]){case 0:for(he=_n=0;_n<ze;he=_n+=1)hn[de++]=l[b++];break;case 1:for(he=ft=0;ft<ze;he=ft+=1)re=l[b++],Ne=he<h?0:hn[de-h],hn[de++]=(re+Ne)%256;break;case 2:for(he=Ot=0;Ot<ze;he=Ot+=1)re=l[b++],fe=(he-he%h)/h,hn[de++]=((ut=Ue&&hn[(Ue-1)*ze+fe*h+he%h])+re)%256;break;case 3:for(he=wt=0;wt<ze;he=wt+=1)re=l[b++],fe=(he-he%h)/h,Ne=he<h?0:hn[de-h],ut=Ue&&hn[(Ue-1)*ze+fe*h+he%h],hn[de++]=(re+Math.floor((Ne+ut)/2))%256;break;case 4:for(he=Yt=0;Yt<ze;he=Yt+=1)re=l[b++],fe=(he-he%h)/h,0===Ue?ut=lt=0:(ut=hn[(Ue-1)*ze+fe*h+he%h],lt=fe&&hn[(Ue-1)*ze+(fe-1)*h+he%h]),pt=(Ne=he<h?0:hn[de-h])+ut-lt,Qt=Math.abs(pt-Ne),Ye=Math.abs(pt-ut),un=Math.abs(pt-lt),hn[de++]=(re+(Qt<=Ye&&Qt<=un?Ne:Ye<=un?ut:lt))%256;break;default:throw new Error("Invalid filter algorithm: "+l[b-1])}if(!Se){var Xe=((G+Ue*ne)*E.width+L)*h,Je=Ue*ze;for(he=0;he<pn;he+=1){for(var _t=0;_t<h;_t+=1)m[Xe++]=hn[Je++];Xe+=(V-1)*h}}Ue++}}return l=sM(l),1==E.interlaceMethod?(M(0,0,8,8),M(4,0,8,8),M(0,4,4,8),M(2,0,4,4),M(0,2,2,4),M(1,0,2,2),M(0,1,1,2)):M(0,0,1,1),m},i.prototype.decodePalette=function(){var l,h,m,b,E,M,L,G,V;for(m=this.palette,M=this.transparency.indexed||[],E=new Uint8Array((M.length||0)+m.length),b=0,l=0,h=L=0,G=m.length;L<G;h=L+=3)E[b++]=m[h],E[b++]=m[h+1],E[b++]=m[h+2],E[b++]=null!=(V=M[l++])?V:255;return E},i.prototype.copyToImageData=function(l,h){var m,b,E,M,L,G,V,ne,re,de,fe;if(b=this.colors,re=null,m=this.hasAlphaChannel,this.palette.length&&(re=null!=(fe=this._decodedPalette)?fe:this._decodedPalette=this.decodePalette(),b=4,m=!0),ne=(E=l.data||l).length,L=re||h,M=G=0,1===b)for(;M<ne;)V=re?4*h[M/4]:G,de=L[V++],E[M++]=de,E[M++]=de,E[M++]=de,E[M++]=m?L[V++]:255,G=V;else for(;M<ne;)V=re?4*h[M/4]:G,E[M++]=L[V++],E[M++]=L[V++],E[M++]=L[V++],E[M++]=m?L[V++]:255,G=V},i.prototype.decode=function(){var l;return l=new Uint8Array(this.width*this.height*4),this.copyToImageData(l,this.decodePixels()),l};var s=function(){if("[object Window]"===Object.prototype.toString.call(ms)){try{n=ms.document.createElement("canvas"),e=n.getContext("2d")}catch{return!1}return!0}return!1};return s(),t=function(l){var h;if(!0===s())return e.width=l.width,e.height=l.height,e.clearRect(0,0,l.width,l.height),e.putImageData(l,0,0),(h=new Image).src=n.toDataURL(),h;throw new Error("This method requires a Browser with Canvas-capability.")},i.prototype.decodeFrames=function(l){var h,m,b,E,M,L,G,V;if(this.animation){for(V=[],m=M=0,L=(G=this.animation.frames).length;M<L;m=++M)b=l.createImageData((h=G[m]).width,h.height),E=this.decodePixels(new Uint8Array(h.data)),this.copyToImageData(b,E),h.imageData=b,V.push(h.image=t(b));return V}},i.prototype.renderFrame=function(l,h){var m,b,E;return m=(b=this.animation.frames)[h],E=b[h-1],0===h&&l.clearRect(0,0,this.width,this.height),1===E?.disposeOp?l.clearRect(E.xOffset,E.yOffset,E.width,E.height):2===E?.disposeOp&&l.putImageData(E.imageData,E.xOffset,E.yOffset),0===m.blendOp&&l.clearRect(m.xOffset,m.yOffset,m.width,m.height),l.drawImage(m.image,m.xOffset,m.yOffset)},i.prototype.animate=function(l){var h,m,b,E,M,L,G=this;return m=0,E=(L=this.animation).numFrames,b=L.frames,M=L.numPlays,(h=function(){var V,ne;if(V=m++%E,ne=b[V],G.renderFrame(l,V),E>1&&m/E<M)return G.animation._timeout=setTimeout(h,ne.delay)})()},i.prototype.stopAnimation=function(){var l;return clearTimeout(null!=(l=this.animation)?l._timeout:void 0)},i.prototype.render=function(l){var h,m;return l._png&&l._png.stopAnimation(),l._png=this,l.width=this.width,l.height=this.height,h=l.getContext("2d"),this.animation?(this.decodeFrames(h),this.animate(h)):(m=h.createImageData(this.width,this.height),this.copyToImageData(m,this.decodePixels()),h.putImageData(m,0,0))},i}();function cae(t){var n=0;if(71!==t[n++]||73!==t[n++]||70!==t[n++]||56!==t[n++]||56!=(t[n++]+1&253)||97!==t[n++])throw new Error("Invalid GIF 87a/89a header.");var e=t[n++]|t[n++]<<8,i=t[n++]|t[n++]<<8,s=t[n++],h=1<<1+(7&s);n++,n++;var m=null,b=null;s>>7&&(m=n,b=h,n+=3*h);var E=!0,M=[],L=0,G=null,V=0,ne=null;for(this.width=e,this.height=i;E&&n<t.length;)switch(t[n++]){case 33:switch(t[n++]){case 255:if(11!==t[n]||78==t[n+1]&&69==t[n+2]&&84==t[n+3]&&83==t[n+4]&&67==t[n+5]&&65==t[n+6]&&80==t[n+7]&&69==t[n+8]&&50==t[n+9]&&46==t[n+10]&&48==t[n+11]&&3==t[n+12]&&1==t[n+13]&&0==t[n+16])n+=14,ne=t[n++]|t[n++]<<8,n++;else for(n+=12;;){if(!((Ue=t[n++])>=0))throw Error("Invalid block size");if(0===Ue)break;n+=Ue}break;case 249:if(4!==t[n++]||0!==t[n+4])throw new Error("Invalid graphics extension block.");var re=t[n++];L=t[n++]|t[n++]<<8,G=t[n++],!(1&re)&&(G=null),V=re>>2&7,n++;break;case 254:for(;;){if(!((Ue=t[n++])>=0))throw Error("Invalid block size");if(0===Ue)break;n+=Ue}break;default:throw new Error("Unknown graphic control label: 0x"+t[n-1].toString(16))}break;case 44:var de=t[n++]|t[n++]<<8,fe=t[n++]|t[n++]<<8,he=t[n++]|t[n++]<<8,Ne=t[n++]|t[n++]<<8,We=t[n++],pt=We>>6&1,Qt=1<<1+(7&We),yt=m,Ye=b,un=!1;We>>7&&(un=!0,yt=n,Ye=Qt,n+=3*Qt);var hn=n;for(n++;;){var Ue;if(!((Ue=t[n++])>=0))throw Error("Invalid block size");if(0===Ue)break;n+=Ue}M.push({x:de,y:fe,width:he,height:Ne,has_local_palette:un,palette_offset:yt,palette_size:Ye,data_offset:hn,data_length:n-hn,transparent_index:G,interlaced:!!pt,delay:L,disposal:V});break;case 59:E=!1;break;default:throw new Error("Unknown gif block: 0x"+t[n-1].toString(16))}this.numFrames=function(){return M.length},this.loopCount=function(){return ne},this.frameInfo=function(ze){if(ze<0||ze>=M.length)throw new Error("Frame index out of range.");return M[ze]},this.decodeAndBlitFrameBGRA=function(ze,ut){var lt=this.frameInfo(ze),_n=lt.width*lt.height,ft=new Uint8Array(_n);gQ(t,lt.data_offset,ft,_n);var Ot=lt.palette_offset,wt=lt.transparent_index;null===wt&&(wt=256);var Yt=lt.width,pn=e-Yt,Ti=Yt,Se=4*(lt.y*e+lt.x),Xe=4*((lt.y+lt.height)*e+lt.x),Je=Se,_t=4*pn;!0===lt.interlaced&&(_t+=4*e*7);for(var Nt=8,jt=0,en=ft.length;jt<en;++jt){var sn=ft[jt];if(0===Ti&&(Ti=Yt,(Je+=_t)>=Xe&&(_t=4*pn+4*e*(Nt-1),Je=Se+(Yt+pn)*(Nt<<1),Nt>>=1)),sn===wt)Je+=4;else{var bi=t[Ot+3*sn],di=t[Ot+3*sn+1];ut[Je++]=t[Ot+3*sn+2],ut[Je++]=di,ut[Je++]=bi,ut[Je++]=255}--Ti}},this.decodeAndBlitFrameRGBA=function(ze,ut){var lt=this.frameInfo(ze),_n=lt.width*lt.height,ft=new Uint8Array(_n);gQ(t,lt.data_offset,ft,_n);var Ot=lt.palette_offset,wt=lt.transparent_index;null===wt&&(wt=256);var Yt=lt.width,pn=e-Yt,Ti=Yt,Se=4*(lt.y*e+lt.x),Xe=4*((lt.y+lt.height)*e+lt.x),Je=Se,_t=4*pn;!0===lt.interlaced&&(_t+=4*e*7);for(var Nt=8,jt=0,en=ft.length;jt<en;++jt){var sn=ft[jt];if(0===Ti&&(Ti=Yt,(Je+=_t)>=Xe&&(_t=4*pn+4*e*(Nt-1),Je=Se+(Yt+pn)*(Nt<<1),Nt>>=1)),sn===wt)Je+=4;else{var di=t[Ot+3*sn+1],Yi=t[Ot+3*sn+2];ut[Je++]=t[Ot+3*sn],ut[Je++]=di,ut[Je++]=Yi,ut[Je++]=255}--Ti}}}function gQ(t,n,e,i){for(var s=t[n++],l=1<<s,h=l+1,m=h+1,b=s+1,E=(1<<b)-1,M=0,L=0,G=0,V=t[n++],ne=new Int32Array(4096),re=null;;){for(;M<16&&0!==V;)L|=t[n++]<<M,M+=8,1===V?V=t[n++]:--V;if(M<b)break;var de=L&E;if(L>>=b,M-=b,de!==l){if(de===h)break;for(var fe=de<m?de:re,he=0,Ne=fe;Ne>l;)Ne=ne[Ne]>>8,++he;var We=Ne;if(G+he+(fe!==de?1:0)>i)return void $a.log("Warning, gif stream longer than expected.");e[G++]=We;var pt=G+=he;for(fe!==de&&(e[G++]=We),Ne=fe;he--;)e[--pt]=255&(Ne=ne[Ne]),Ne>>=8;null!==re&&m<4096&&(ne[m++]=re<<8|We,m>=E+1&&b<12&&(++b,E=E<<1|1)),re=de}else m=h+1,E=(1<<(b=s+1))-1,re=null}return G!==i&&$a.log("Warning, gif stream shorter than expected."),e}function TP(t){var n,e,i,s,l,h=Math.floor,m=new Array(64),b=new Array(64),E=new Array(64),M=new Array(64),L=new Array(65535),G=new Array(65535),V=new Array(64),ne=new Array(64),re=[],de=0,fe=7,he=new Array(64),Ne=new Array(64),We=new Array(64),pt=new Array(256),Qt=new Array(2048),yt=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Ye=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],un=[0,1,2,3,4,5,6,7,8,9,10,11],hn=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Ue=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],ze=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ut=[0,1,2,3,4,5,6,7,8,9,10,11],lt=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],_n=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ft(Se,Xe){for(var Je=0,_t=0,Nt=new Array,jt=1;jt<=16;jt++){for(var en=1;en<=Se[jt];en++)Nt[Xe[_t]]=[],Nt[Xe[_t]][0]=Je,Nt[Xe[_t]][1]=jt,_t++,Je++;Je*=2}return Nt}function Ot(Se){for(var Xe=Se[0],Je=Se[1]-1;Je>=0;)Xe&1<<Je&&(de|=1<<fe),Je--,--fe<0&&(255==de?(wt(255),wt(0)):wt(de),fe=7,de=0)}function wt(Se){re.push(Se)}function Yt(Se){wt(Se>>8&255),wt(255&Se)}function pn(Se,Xe,Je,_t,Nt){for(var jt,en=Nt[0],sn=Nt[240],bi=function(mi,Ii){var Qi,Vi,Rr,xs,zs,io,Do,aa,Es,yo,er=0;for(Es=0;Es<8;++Es){var id=(Qi=mi[er])+(aa=mi[er+7]),na=Qi-aa,yg=(Vi=mi[er+1])+(Do=mi[er+6]),qa=Vi-Do,Ll=(Rr=mi[er+2])+(io=mi[er+5]),Gm=Rr-io,_a=(xs=mi[er+3])+(zs=mi[er+4]),ob=xs-zs,lc=id+_a,vg=id-_a,m0=yg+Ll,cc=yg-Ll;mi[er]=lc+m0,mi[er+4]=lc-m0;var Vs=.707106781*(cc+vg);mi[er+2]=vg+Vs,mi[er+6]=vg-Vs;var ya=.382683433*((lc=ob+Gm)-(cc=qa+na)),ab=.5411961*lc+ya,Sh=1.306562965*cc+ya,$m=.707106781*(m0=Gm+qa),qm=na+$m,As=na-$m;mi[er+5]=As+ab,mi[er+3]=As-ab,mi[er+1]=qm+Sh,mi[er+7]=qm-Sh,er+=8}for(er=0,Es=0;Es<8;++Es){var bg=(Qi=mi[er])+(aa=mi[er+56]),Km=Qi-aa,vf=(Vi=mi[er+8])+(Do=mi[er+48]),wu=Vi-Do,eu=(Rr=mi[er+16])+(io=mi[er+40]),vA=Rr-io,$x=(xs=mi[er+24])+(zs=mi[er+32]),_0=xs-zs,wg=bg+$x,xg=bg-$x,Cg=vf+eu,Wm=vf-eu;mi[er]=wg+Cg,mi[er+32]=wg-Cg;var up=.707106781*(Wm+xg);mi[er+16]=xg+up,mi[er+48]=xg-up;var Zm=.382683433*((wg=_0+vA)-(Wm=wu+Km)),lb=.5411961*wg+Zm,qx=1.306562965*Wm+Zm,Kx=.707106781*(Cg=vA+wu),Wx=Km+Kx,Zx=Km-Kx;mi[er+40]=Zx+lb,mi[er+24]=Zx-lb,mi[er+8]=Wx+qx,mi[er+56]=Wx-qx,er++}for(Es=0;Es<64;++Es)V[Es]=(yo=mi[Es]*Ii[Es])>0?yo+.5|0:yo-.5|0;return V}(Se,Xe),di=0;di<64;++di)ne[yt[di]]=bi[di];var Yi=ne[0]-Je;Je=ne[0],0==Yi?Ot(_t[0]):(Ot(_t[G[jt=32767+Yi]]),Ot(L[jt]));for(var Ji=63;Ji>0&&0==ne[Ji];)Ji--;if(0==Ji)return Ot(en),Je;for(var ss,Fn=1;Fn<=Ji;){for(var at=Fn;0==ne[Fn]&&Fn<=Ji;)++Fn;var Rs=Fn-at;if(Rs>=16){ss=Rs>>4;for(var yr=1;yr<=ss;++yr)Ot(sn);Rs&=15}Ot(Nt[(Rs<<4)+G[jt=32767+ne[Fn]]]),Ot(L[jt]),Fn++}return 63!=Ji&&Ot(en),Je}function Ti(Se){Se=Math.min(Math.max(Se,1),100),l!=Se&&(function(Xe){for(var Je=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],_t=0;_t<64;_t++){var Nt=h((Je[_t]*Xe+50)/100);Nt=Math.min(Math.max(Nt,1),255),m[yt[_t]]=Nt}for(var jt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],en=0;en<64;en++){var sn=h((jt[en]*Xe+50)/100);sn=Math.min(Math.max(sn,1),255),b[yt[en]]=sn}for(var bi=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],di=0,Yi=0;Yi<8;Yi++)for(var Ji=0;Ji<8;Ji++)E[di]=1/(m[yt[di]]*bi[Yi]*bi[Ji]*8),M[di]=1/(b[yt[di]]*bi[Yi]*bi[Ji]*8),di++}(Se<50?Math.floor(5e3/Se):Math.floor(200-2*Se)),l=Se)}this.encode=function(Se,Xe){var Vi,Rr;Xe&&Ti(Xe),re=new Array,de=0,fe=7,Yt(65496),Yt(65504),Yt(16),wt(74),wt(70),wt(73),wt(70),wt(0),wt(1),wt(1),wt(0),Yt(1),Yt(1),wt(0),wt(0),function(){Yt(65499),Yt(132),wt(0);for(var Vi=0;Vi<64;Vi++)wt(m[Vi]);wt(1);for(var Rr=0;Rr<64;Rr++)wt(b[Rr])}(),Vi=Se.width,Rr=Se.height,Yt(65472),Yt(17),wt(8),Yt(Rr),Yt(Vi),wt(3),wt(1),wt(17),wt(0),wt(2),wt(17),wt(1),wt(3),wt(17),wt(1),function(){Yt(65476),Yt(418),wt(0);for(var Vi=0;Vi<16;Vi++)wt(Ye[Vi+1]);for(var Rr=0;Rr<=11;Rr++)wt(un[Rr]);wt(16);for(var xs=0;xs<16;xs++)wt(hn[xs+1]);for(var zs=0;zs<=161;zs++)wt(Ue[zs]);wt(1);for(var io=0;io<16;io++)wt(ze[io+1]);for(var Do=0;Do<=11;Do++)wt(ut[Do]);wt(17);for(var aa=0;aa<16;aa++)wt(lt[aa+1]);for(var Es=0;Es<=161;Es++)wt(_n[Es])}(),Yt(65498),Yt(12),wt(3),wt(1),wt(0),wt(2),wt(17),wt(3),wt(17),wt(0),wt(63),wt(0);var Je=0,_t=0,Nt=0;de=0,fe=7,this.encode.displayName="_encode_";for(var jt,en,sn,bi,di,Yi,Ji,ss,Fn,at=Se.data,yr=Se.height,mi=4*Se.width,Ii=0;Ii<yr;){for(jt=0;jt<mi;){for(di=mi*Ii+jt,Ji=-1,ss=0,Fn=0;Fn<64;Fn++)Yi=di+(ss=Fn>>3)*mi+(Ji=4*(7&Fn)),Ii+ss>=yr&&(Yi-=mi*(Ii+1+ss-yr)),jt+Ji>=mi&&(Yi-=jt+Ji-mi+4),en=at[Yi++],sn=at[Yi++],bi=at[Yi++],he[Fn]=(Qt[en]+Qt[sn+256>>0]+Qt[bi+512>>0]>>16)-128,Ne[Fn]=(Qt[en+768>>0]+Qt[sn+1024>>0]+Qt[bi+1280>>0]>>16)-128,We[Fn]=(Qt[en+1280>>0]+Qt[sn+1536>>0]+Qt[bi+1792>>0]>>16)-128;Je=pn(he,E,Je,n,i),_t=pn(Ne,M,_t,e,s),Nt=pn(We,M,Nt,e,s),jt+=32}Ii+=8}if(fe>=0){var Qi=[];Qi[1]=fe+1,Qi[0]=(1<<fe+1)-1,Ot(Qi)}return Yt(65497),new Uint8Array(re)},t=t||50,function(){for(var Se=String.fromCharCode,Xe=0;Xe<256;Xe++)pt[Xe]=Se(Xe)}(),n=ft(Ye,un),e=ft(ze,ut),i=ft(hn,Ue),s=ft(lt,_n),function(){for(var Se=1,Xe=2,Je=1;Je<=15;Je++){for(var _t=Se;_t<Xe;_t++)G[32767+_t]=Je,L[32767+_t]=[],L[32767+_t][1]=Je,L[32767+_t][0]=_t;for(var Nt=-(Xe-1);Nt<=-Se;Nt++)G[32767+Nt]=Je,L[32767+Nt]=[],L[32767+Nt][1]=Je,L[32767+Nt][0]=Xe-1+Nt;Se<<=1,Xe<<=1}}(),function(){for(var Se=0;Se<256;Se++)Qt[Se]=19595*Se,Qt[Se+256>>0]=38470*Se,Qt[Se+512>>0]=7471*Se+32768,Qt[Se+768>>0]=-11059*Se,Qt[Se+1024>>0]=-21709*Se,Qt[Se+1280>>0]=32768*Se+8421375,Qt[Se+1536>>0]=-27439*Se,Qt[Se+1792>>0]=-5329*Se}(),Ti(t)}function gg(t,n){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!n,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function mQ(t){function n(Ye){if(!Ye)throw Error("assert :P")}function e(Ye,un,hn){for(var Ue=0;4>Ue;Ue++)if(Ye[un+Ue]!=hn.charCodeAt(Ue))return!0;return!1}function i(Ye,un,hn,Ue,ze){for(var ut=0;ut<ze;ut++)Ye[un+ut]=hn[Ue+ut]}function s(Ye,un,hn,Ue){for(var ze=0;ze<Ue;ze++)Ye[un+ze]=hn}function l(Ye){return new Int32Array(Ye)}function h(Ye,un){for(var hn=[],Ue=0;Ue<Ye;Ue++)hn.push(new un);return hn}function m(Ye,un){var hn=[];return function Ue(ze,ut,lt){for(var _n=lt[ut],ft=0;ft<_n&&(ze.push(lt.length>ut+1?[]:new un),!(lt.length<ut+1));ft++)Ue(ze[ft],ut+1,lt)}(hn,0,Ye),hn}var b=function(){var Ye=this;function un(F,H){for(var Y=1<<H-1>>>0;F&Y;)Y>>>=1;return Y?(F&Y-1)+Y:F}function hn(F,H,Y,oe,ve){n(!(oe%Y));do{F[H+(oe-=Y)]=ve}while(0<oe)}function Ue(F,H,Y,oe,ve){if(n(2328>=ve),512>=ve)var De=l(512);else if(null==(De=l(ve)))return 0;return function(Fe,ke,Pe,Ke,xt,nn){var rn,Lt,Yn=ke,Sn=1<<Pe,Et=l(16),Ft=l(16);for(n(0!=xt),n(null!=Ke),n(null!=Fe),n(0<Pe),Lt=0;Lt<xt;++Lt){if(15<Ke[Lt])return 0;++Et[Ke[Lt]]}if(Et[0]==xt)return 0;for(Ft[1]=0,rn=1;15>rn;++rn){if(Et[rn]>1<<rn)return 0;Ft[rn+1]=Ft[rn]+Et[rn]}for(Lt=0;Lt<xt;++Lt)rn=Ke[Lt],0<Ke[Lt]&&(nn[Ft[rn]++]=Lt);if(1==Ft[15])return(Ke=new ze).g=0,Ke.value=nn[0],hn(Fe,Yn,1,Sn,Ke),Sn;var qn,si=-1,Wn=Sn-1,sr=0,Ui=1,ts=1,Gi=1<<Pe;for(Lt=0,rn=1,xt=2;rn<=Pe;++rn,xt<<=1){if(Ui+=ts<<=1,0>(ts-=Et[rn]))return 0;for(;0<Et[rn];--Et[rn])(Ke=new ze).g=rn,Ke.value=nn[Lt++],hn(Fe,Yn+sr,xt,Gi,Ke),sr=un(sr,rn)}for(rn=Pe+1,xt=2;15>=rn;++rn,xt<<=1){if(Ui+=ts<<=1,0>(ts-=Et[rn]))return 0;for(;0<Et[rn];--Et[rn]){if(Ke=new ze,(sr&Wn)!=si){for(Yn+=Gi,qn=1<<(si=rn)-Pe;15>si&&!(0>=(qn-=Et[si]));)++si,qn<<=1;Sn+=Gi=1<<(qn=si-Pe),Fe[ke+(si=sr&Wn)].g=qn+Pe,Fe[ke+si].value=Yn-ke-si}Ke.g=rn-Pe,Ke.value=nn[Lt++],hn(Fe,Yn+(sr>>Pe),xt,Gi,Ke),sr=un(sr,rn)}}return Ui!=2*Ft[15]-1?0:Sn}(F,H,Y,oe,ve,De)}function ze(){this.value=this.g=0}function ut(){this.value=this.g=0}function lt(){this.G=h(5,ze),this.H=l(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=h(wf,ut)}function _n(F,H,Y,oe){n(null!=F),n(null!=H),n(2147483648>oe),F.Ca=254,F.I=0,F.b=-8,F.Ka=0,F.oa=H,F.pa=Y,F.Jd=H,F.Yc=Y+oe,F.Zc=4<=oe?Y+oe-4+1:Y,jt(F)}function ft(F,H){for(var Y=0;0<H--;)Y|=sn(F,128)<<H;return Y}function Ot(F,H){var Y=ft(F,H);return en(F)?-Y:Y}function wt(F,H,Y,oe){var ve,De=0;for(n(null!=F),n(null!=H),n(4294967288>oe),F.Sb=oe,F.Ra=0,F.u=0,F.h=0,4<oe&&(oe=4),ve=0;ve<oe;++ve)De+=H[Y+ve]<<8*ve;F.Ra=De,F.bb=oe,F.oa=H,F.pa=Y}function Yt(F){for(;8<=F.u&&F.bb<F.Sb;)F.Ra>>>=8,F.Ra+=F.oa[F.pa+F.bb]<<hC-8>>>0,++F.bb,F.u-=8;Je(F)&&(F.h=1,F.u=0)}function pn(F,H){if(n(0<=H),!F.h&&H<=uC){var Y=Xe(F)&cC[H];return F.u+=H,Yt(F),Y}return F.h=1,F.u=0}function Ti(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Se(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Xe(F){return F.Ra>>>(F.u&hC-1)>>>0}function Je(F){return n(F.bb<=F.Sb),F.h||F.bb==F.Sb&&F.u>hC}function _t(F,H){F.u=H,F.h=Je(F)}function Nt(F){F.u>=LS&&(n(F.u>=LS),Yt(F))}function jt(F){n(null!=F&&null!=F.oa),F.pa<F.Zc?(F.I=(F.oa[F.pa++]|F.I<<8)>>>0,F.b+=8):(n(null!=F&&null!=F.oa),F.pa<F.Yc?(F.b+=8,F.I=F.oa[F.pa++]|F.I<<8):F.Ka?F.b=0:(F.I<<=8,F.b+=8,F.Ka=1))}function en(F){return ft(F,1)}function sn(F,H){var Y=F.Ca;0>F.b&&jt(F);var oe=F.b,ve=Y*H>>>8,De=(F.I>>>oe>ve)+0;for(De?(Y-=ve,F.I-=ve+1<<oe>>>0):Y=ve+1,oe=Y,ve=0;256<=oe;)ve+=8,oe>>=8;return F.b-=oe=7^ve+xf[oe],F.Ca=(Y<<oe)-1,De}function bi(F,H,Y){F[H+0]=Y>>24&255,F[H+1]=Y>>16&255,F[H+2]=Y>>8&255,F[H+3]=Y>>0&255}function di(F,H){return F[H+0]<<0|F[H+1]<<8}function Yi(F,H){return di(F,H)|F[H+2]<<16}function Ji(F,H){return di(F,H)|di(F,H+2)<<16}function ss(F,H){var Y=1<<H;return n(null!=F),n(0<H),F.X=l(Y),null==F.X?0:(F.Mb=32-H,F.Xa=H,1)}function Fn(F,H){n(null!=F),n(null!=H),n(F.Xa==H.Xa),i(H.X,0,F.X,0,1<<H.Xa)}function at(){this.X=[],this.Xa=this.Mb=0}function Rs(F,H,Y,oe){n(null!=Y),n(null!=oe);var ve=Y[0],De=oe[0];return 0==ve&&(ve=(F*De+H/2)/H),0==De&&(De=(H*ve+F/2)/F),0>=ve||0>=De?0:(Y[0]=ve,oe[0]=De,1)}function yr(F,H){return F+(1<<H)-1>>>H}function mi(F,H){return((4278255360&F)+(4278255360&H)>>>0&4278255360)+((16711935&F)+(16711935&H)>>>0&16711935)>>>0}function Ii(F,H){Ye[H]=function(Y,oe,ve,De,Fe,ke,Pe){var Ke;for(Ke=0;Ke<Fe;++Ke){var xt=Ye[F](ke[Pe+Ke-1],ve,De+Ke);ke[Pe+Ke]=mi(Y[oe+Ke],xt)}}}function Qi(){this.ud=this.hd=this.jd=0}function Vi(F,H){return((4278124286&(F^H))>>>1)+(F&H)>>>0}function Rr(F){return 0<=F&&256>F?F:0>F?0:255<F?255:void 0}function xs(F,H){return Rr(F+(F-H+.5>>1))}function zs(F,H,Y){return Math.abs(H-Y)-Math.abs(F-Y)}function io(F,H,Y,oe,ve,De,Fe){for(oe=De[Fe-1],Y=0;Y<ve;++Y)De[Fe+Y]=oe=mi(F[H+Y],oe)}function Do(F,H,Y,oe,ve){var De;for(De=0;De<Y;++De){var Fe=F[H+De],ke=Fe>>8&255,Pe=16711935&(Pe=(Pe=16711935&Fe)+((ke<<16)+ke));oe[ve+De]=(4278255360&Fe)+Pe>>>0}}function aa(F,H){H.jd=F>>0&255,H.hd=F>>8&255,H.ud=F>>16&255}function Es(F,H,Y,oe,ve,De){var Fe;for(Fe=0;Fe<oe;++Fe){var ke=H[Y+Fe],Pe=ke>>>8,Ke=ke,xt=255&(xt=(xt=ke>>>16)+((F.jd<<24>>24)*(Pe<<24>>24)>>>5));Ke=255&(Ke=(Ke+=(F.hd<<24>>24)*(Pe<<24>>24)>>>5)+((F.ud<<24>>24)*(xt<<24>>24)>>>5)),ve[De+Fe]=(4278255360&ke)+(xt<<16)+Ke}}function yo(F,H,Y,oe,ve){Ye[H]=function(De,Fe,ke,Pe,Ke,xt,nn,rn,Lt){for(Pe=nn;Pe<rn;++Pe)for(nn=0;nn<Lt;++nn)Ke[xt++]=ve(ke[oe(De[Fe++])])},Ye[F]=function(De,Fe,ke,Pe,Ke,xt,nn){var rn=8>>De.b,Lt=De.Ea,Yn=De.K[0],Sn=De.w;if(8>rn)for(De=(1<<De.b)-1,Sn=(1<<rn)-1;Fe<ke;++Fe){var Et,Ft=0;for(Et=0;Et<Lt;++Et)Et&De||(Ft=oe(Pe[Ke++])),xt[nn++]=ve(Yn[Ft&Sn]),Ft>>=rn}else Ye["VP8LMapColor"+Y](Pe,Ke,Yn,Sn,xt,nn,Fe,ke,Lt)}}function er(F,H,Y,oe,ve){for(Y=H+Y;H<Y;){var De=F[H++];oe[ve++]=De>>16&255,oe[ve++]=De>>8&255,oe[ve++]=De>>0&255}}function id(F,H,Y,oe,ve){for(Y=H+Y;H<Y;){var De=F[H++];oe[ve++]=De>>16&255,oe[ve++]=De>>8&255,oe[ve++]=De>>0&255,oe[ve++]=De>>24&255}}function na(F,H,Y,oe,ve){for(Y=H+Y;H<Y;){var De=(Fe=F[H++])>>16&240|Fe>>12&15,Fe=Fe>>0&240|Fe>>28&15;oe[ve++]=De,oe[ve++]=Fe}}function yg(F,H,Y,oe,ve){for(Y=H+Y;H<Y;){var De=(Fe=F[H++])>>16&248|Fe>>13&7,Fe=Fe>>5&224|Fe>>3&31;oe[ve++]=De,oe[ve++]=Fe}}function qa(F,H,Y,oe,ve){for(Y=H+Y;H<Y;){var De=F[H++];oe[ve++]=De>>0&255,oe[ve++]=De>>8&255,oe[ve++]=De>>16&255}}function Ll(F,H,Y,oe,ve,De){if(0==De)for(Y=H+Y;H<Y;)bi(oe,((De=F[H++])[0]>>24|De[1]>>8&65280|De[2]<<8&16711680|De[3]<<24)>>>0),ve+=32;else i(oe,ve,F,H,Y)}function Gm(F,H){Ye[H][0]=Ye[F+"0"],Ye[H][1]=Ye[F+"1"],Ye[H][2]=Ye[F+"2"],Ye[H][3]=Ye[F+"3"],Ye[H][4]=Ye[F+"4"],Ye[H][5]=Ye[F+"5"],Ye[H][6]=Ye[F+"6"],Ye[H][7]=Ye[F+"7"],Ye[H][8]=Ye[F+"8"],Ye[H][9]=Ye[F+"9"],Ye[H][10]=Ye[F+"10"],Ye[H][11]=Ye[F+"11"],Ye[H][12]=Ye[F+"12"],Ye[H][13]=Ye[F+"13"],Ye[H][14]=Ye[F+"0"],Ye[H][15]=Ye[F+"0"]}function _a(F){return F==BN||F==MN||F==aF||F==FN}function ob(){this.eb=[],this.size=this.A=this.fb=0}function lc(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function vg(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ob,this.f.kb=new lc,this.sd=null}function m0(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function cc(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Vs(F){return alert("todo:WebPSamplerProcessPlane"),F.T}function ya(F,H){var Y=F.T,oe=H.ba.f.RGBA,ve=oe.eb,De=oe.fb+F.ka*oe.A,Fe=Ap[H.ba.S],ke=F.y,Pe=F.O,Ke=F.f,xt=F.N,nn=F.ea,rn=F.W,Lt=H.cc,Yn=H.dc,Sn=H.Mc,Et=H.Nc,Ft=F.ka,qn=F.ka+F.T,si=F.U,Wn=si+1>>1;for(0==Ft?Fe(ke,Pe,null,null,Ke,xt,nn,rn,Ke,xt,nn,rn,ve,De,null,null,si):(Fe(H.ec,H.fc,ke,Pe,Lt,Yn,Sn,Et,Ke,xt,nn,rn,ve,De-oe.A,ve,De,si),++Y);Ft+2<qn;Ft+=2)Fe(ke,(Pe+=2*F.fa)-F.fa,ke,Pe,Lt=Ke,Yn=xt,Sn=nn,Et=rn,Ke,xt+=F.Rc,nn,rn+=F.Rc,ve,(De+=2*oe.A)-oe.A,ve,De,si);return Pe+=F.fa,F.j+qn<F.o?(i(H.ec,H.fc,ke,Pe,si),i(H.cc,H.dc,Ke,xt,Wn),i(H.Mc,H.Nc,nn,rn,Wn),Y--):1&qn||Fe(ke,Pe,null,null,Ke,xt,nn,rn,Ke,xt,nn,rn,ve,De+oe.A,null,null,si),Y}function ab(F,H,Y){var oe=F.F,ve=[F.J];if(null!=oe){var De=F.U,Fe=H.ba.S,ke=Fe==oF||Fe==aF;H=H.ba.f.RGBA;var Pe=[0],Ke=F.ka;Pe[0]=F.T,F.Kb&&(0==Ke?--Pe[0]:(--Ke,ve[0]-=F.width),F.j+F.ka+F.T==F.o&&(Pe[0]=F.o-F.j-Ke));var xt=H.eb;F=tF(oe,ve[0],F.width,De,Pe,xt,(Ke=H.fb+Ke*H.A)+(ke?0:3),H.A),n(Y==Pe),F&&_a(Fe)&&av(xt,Ke,ke,De,Pe,H.A)}return 0}function Sh(F){var H=F.ma,Y=H.ba.S,oe=11>Y,ve=Y==rF||Y==sF||Y==oF||Y==DN||12==Y||_a(Y);if(H.memory=null,H.Ib=null,H.Jb=null,H.Nd=null,!PS(H.Oa,F,ve?11:12))return 0;if(ve&&_a(Y)&&fi(),F.da)alert("todo:use_scaling");else{if(oe){if(H.Ib=Vs,F.Kb){if(H.memory=l(F.U+2*(Y=F.U+1>>1)),null==H.memory)return 0;H.ec=H.memory,H.fc=0,H.cc=H.ec,H.dc=H.fc+F.U,H.Mc=H.cc,H.Nc=H.dc+Y,H.Ib=ya,fi()}}else alert("todo:EmitYUV");ve&&(H.Jb=ab,oe&&qt())}if(oe&&!Sj){for(F=0;256>F;++F)Oue[F]=89858*(F-128)+cF>>lF,Nue[F]=-22014*(F-128)+cF,Pue[F]=-45773*(F-128),kue[F]=113618*(F-128)+cF>>lF;for(F=jS;F<kN;++F)Lue[F-jS]=bA(H=76283*(F-16)+cF>>lF,255),Uue[F-jS]=bA(H+8>>4,15);Sj=1}return 1}function $m(F){var H=F.ma,Y=F.U,oe=F.T;return n(!(1&F.ka)),0>=Y||0>=oe?0:(Y=H.Ib(F,H),null!=H.Jb&&H.Jb(F,H,Y),H.Dc+=Y,1)}function qm(F){F.ma.memory=null}function As(F,H,Y,oe){return 47!=pn(F,8)?0:(H[0]=pn(F,14)+1,Y[0]=pn(F,14)+1,oe[0]=pn(F,1),0!=pn(F,3)?0:!F.h)}function bg(F,H){if(4>F)return F+1;var Y=F-2>>1;return(2+(1&F)<<Y)+pn(H,Y)+1}function Km(F,H){return 120<H?H-120:1<=(Y=((Y=vue[H-1])>>4)*F+(8-(15&Y)))?Y:1;var Y}function vf(F,H,Y){var oe=Xe(Y),ve=F[H+=255&oe].g-8;return 0<ve&&(_t(Y,Y.u+8),oe=Xe(Y),H+=F[H].value,H+=oe&(1<<ve)-1),_t(Y,Y.u+F[H].g),F[H].value}function wu(F,H,Y){return Y.g+=F.g,Y.value+=F.value<<H>>>0,n(8>=Y.g),F.g}function eu(F,H,Y){var oe=F.xc;return n((H=0==oe?0:F.vc[F.md*(Y>>oe)+(H>>oe)])<F.Wb),F.Ya[H]}function vA(F,H,Y,oe){var ve=F.ab,De=F.c*H,Fe=F.C;H=Fe+H;var ke=Y,Pe=oe;for(oe=F.Ta,Y=F.Ua;0<ve--;){var Ke=F.gc[ve],xt=Fe,nn=H,rn=ke,Lt=Pe,Yn=(Pe=oe,ke=Y,Ke.Ea);switch(n(xt<nn),n(nn<=Ke.nc),Ke.hc){case 2:eF(rn,Lt,(nn-xt)*Yn,Pe,ke);break;case 0:var Sn=xt,Et=nn,Ft=Pe,qn=ke,si=(Gi=Ke).Ea;0==Sn&&(EN(rn,Lt,null,null,1,Ft,qn),io(rn,Lt+1,0,0,si-1,Ft,qn+1),Lt+=si,qn+=si,++Sn);for(var Wn=1<<Gi.b,sr=Wn-1,Ui=yr(si,Gi.b),ts=Gi.K,Gi=Gi.w+(Sn>>Gi.b)*Ui;Sn<Et;){var la=ts,Ca=Gi,Yo=1;for(US(rn,Lt,Ft,qn-si,1,Ft,qn);Yo<si;){var Bo=(Yo&~sr)+Wn;Bo>si&&(Bo=si),(0,iv[la[Ca++]>>8&15])(rn,Lt+ +Yo,Ft,qn+Yo-si,Bo-Yo,Ft,qn+Yo),Yo=Bo}Lt+=si,qn+=si,++Sn&sr||(Gi+=Ui)}nn!=Ke.nc&&i(Pe,ke-Yn,Pe,ke+(nn-xt-1)*Yn,Yn);break;case 1:for(Yn=rn,Et=Lt,si=(rn=Ke.Ea)-(qn=rn&~(Ft=(Lt=1<<Ke.b)-1)),Sn=yr(rn,Ke.b),Wn=Ke.K,Ke=Ke.w+(xt>>Ke.b)*Sn;xt<nn;){for(sr=Wn,Ui=Ke,ts=new Qi,Gi=Et+qn,la=Et+rn;Et<Gi;)aa(sr[Ui++],ts),hp(ts,Yn,Et,Lt,Pe,ke),Et+=Lt,ke+=Lt;Et<la&&(aa(sr[Ui++],ts),hp(ts,Yn,Et,si,Pe,ke),Et+=si,ke+=si),++xt&Ft||(Ke+=Sn)}break;case 3:if(rn==Pe&&Lt==ke&&0<Ke.b){for(Et=Pe,rn=Yn=ke+(nn-xt)*Yn-(qn=(nn-xt)*yr(Ke.Ea,Ke.b)),Lt=Pe,Ft=ke,Sn=[],qn=(si=qn)-1;0<=qn;--qn)Sn[qn]=Lt[Ft+qn];for(qn=si-1;0<=qn;--qn)Et[rn+qn]=Sn[qn];Ig(Ke,xt,nn,Pe,Yn,Pe,ke)}else Ig(Ke,xt,nn,rn,Lt,Pe,ke)}ke=oe,Pe=Y}Pe!=Y&&i(oe,Y,ke,Pe,De)}function $x(F,H){var Y=F.V,oe=F.Ba+F.c*F.C,ve=H-F.C;if(n(H<=F.l.o),n(16>=ve),0<ve){var De=F.l,Fe=F.Ta,ke=F.Ua,Pe=De.width;if(vA(F,ve,Y,oe),ve=ke=[ke],n((Y=F.C)<(oe=H)),n(De.v<De.va),oe>De.o&&(oe=De.o),Y<De.j){var Ke=De.j-Y;Y=De.j,ve[0]+=Ke*Pe}if(Y>=oe?Y=0:(ve[0]+=4*De.v,De.ka=Y-De.j,De.U=De.va-De.v,De.T=oe-Y,Y=1),Y){if(ke=ke[0],11>(Y=F.ca).S){var xt=Y.f.RGBA,nn=(oe=Y.S,ve=De.U,De=De.T,Ke=xt.eb,xt.A),rn=De;for(xt=xt.fb+F.Ma*xt.A;0<rn--;){var Lt=Fe,Yn=ke,Sn=ve,Et=Ke,Ft=xt;switch(oe){case iF:Dg(Lt,Yn,Sn,Et,Ft);break;case rF:rv(Lt,Yn,Sn,Et,Ft);break;case BN:rv(Lt,Yn,Sn,Et,Ft),av(Et,Ft,0,Sn,1,0);break;case gj:dC(Lt,Yn,Sn,Et,Ft);break;case sF:Ll(Lt,Yn,Sn,Et,Ft,1);break;case MN:Ll(Lt,Yn,Sn,Et,Ft,1),av(Et,Ft,0,Sn,1,0);break;case oF:Ll(Lt,Yn,Sn,Et,Ft,0);break;case aF:Ll(Lt,Yn,Sn,Et,Ft,0),av(Et,Ft,1,Sn,1,0);break;case DN:Ym(Lt,Yn,Sn,Et,Ft);break;case FN:Ym(Lt,Yn,Sn,Et,Ft),pC(Et,Ft,Sn,1,0);break;case mj:w0(Lt,Yn,Sn,Et,Ft);break;default:n(0)}ke+=Pe,xt+=nn}F.Ma+=De}else alert("todo:EmitRescaledRowsYUVA");n(F.Ma<=Y.height)}}F.C=H,n(F.C<=F.i)}function _0(F){var H;if(0<F.ua)return 0;for(H=0;H<F.Wb;++H){var Y=F.Ya[H].G,oe=F.Ya[H].H;if(0<Y[1][oe[1]+0].g||0<Y[2][oe[2]+0].g||0<Y[3][oe[3]+0].g)return 0}return 1}function wg(F,H,Y,oe,ve,De){if(0!=F.Z){var Fe=F.qd,ke=F.rd;for(n(null!=cv[F.Z]);H<Y;++H)cv[F.Z](Fe,ke,oe,ve,oe,ve,De),Fe=oe,ke=ve,ve+=De;F.qd=Fe,F.rd=ke}}function xg(F,H){var Y=F.l.ma,oe=0==Y.Z||1==Y.Z?F.l.j:F.C;if(oe=F.C<oe?oe:F.C,n(H<=F.l.o),H>oe){var ve=F.l.width,De=Y.ca,Fe=Y.tb+ve*oe,ke=F.V,Pe=F.Ba+F.c*oe,Ke=F.gc;n(1==F.ab),n(3==Ke[0].hc),SN(Ke[0],oe,H,ke,Pe,De,Fe),wg(Y,oe,H,De,Fe,ve)}F.C=F.Ma=H}function Cg(F,H,Y,oe,ve,De,Fe){var ke=F.$/oe,Pe=F.$%oe,Ke=F.m,xt=F.s,nn=Y+F.$,rn=nn;ve=Y+oe*ve;var Lt=Y+oe*De,Yn=280+xt.ua,Sn=F.Pb?ke:16777216,Et=0<xt.ua?xt.Wa:null,Ft=xt.wc,qn=nn<Lt?eu(xt,Pe,ke):null;n(F.C<De),n(Lt<=ve);var si=!1;e:for(;;){for(;si||nn<Lt;){var Wn=0;if(ke>=Sn){var sr=nn-Y;n((Sn=F).Pb),Sn.wd=Sn.m,Sn.xd=sr,0<Sn.s.ua&&Fn(Sn.s.Wa,Sn.s.vb),Sn=ke+wue}if(Pe&Ft||(qn=eu(xt,Pe,ke)),n(null!=qn),qn.Qb&&(H[nn]=qn.qb,si=!0),!si)if(Nt(Ke),qn.jc){sr=H;var Ui=nn,ts=qn.pd[Xe(Wn=Ke)&wf-1];n(qn.jc),256>ts.g?(_t(Wn,Wn.u+ts.g),sr[Ui]=ts.value,Wn=0):(_t(Wn,Wn.u+ts.g-256),n(256<=ts.value),Wn=ts.value),0==Wn&&(si=!0)}else Wn=vf(qn.G[0],qn.H[0],Ke);if(Ke.h)break;if(si||256>Wn){if(!si)if(qn.nd)H[nn]=(qn.qb|Wn<<8)>>>0;else{if(Nt(Ke),si=vf(qn.G[1],qn.H[1],Ke),Nt(Ke),sr=vf(qn.G[2],qn.H[2],Ke),Ui=vf(qn.G[3],qn.H[3],Ke),Ke.h)break;H[nn]=(Ui<<24|si<<16|Wn<<8|sr)>>>0}if(si=!1,++nn,++Pe>=oe&&(Pe=0,++ke,null!=Fe&&ke<=De&&!(ke%16)&&Fe(F,ke),null!=Et))for(;rn<nn;)Wn=H[rn++],Et.X[(506832829*Wn&4294967295)>>>Et.Mb]=Wn}else if(280>Wn){if(Wn=bg(Wn-256,Ke),sr=vf(qn.G[4],qn.H[4],Ke),Nt(Ke),sr=Km(oe,sr=bg(sr,Ke)),Ke.h)break;if(nn-Y<sr||ve-nn<Wn)break e;for(Ui=0;Ui<Wn;++Ui)H[nn+Ui]=H[nn+Ui-sr];for(nn+=Wn,Pe+=Wn;Pe>=oe;)Pe-=oe,++ke,null!=Fe&&ke<=De&&!(ke%16)&&Fe(F,ke);if(n(nn<=ve),Pe&Ft&&(qn=eu(xt,Pe,ke)),null!=Et)for(;rn<nn;)Wn=H[rn++],Et.X[(506832829*Wn&4294967295)>>>Et.Mb]=Wn}else{if(!(Wn<Yn))break e;for(si=Wn-280,n(null!=Et);rn<nn;)Wn=H[rn++],Et.X[(506832829*Wn&4294967295)>>>Et.Mb]=Wn;Wn=nn,n(!(si>>>(sr=Et).Xa)),H[Wn]=sr.X[si],si=!0}si||n(Ke.h==Je(Ke))}if(F.Pb&&Ke.h&&nn<ve)n(F.m.h),F.a=5,F.m=F.wd,F.$=F.xd,0<F.s.ua&&Fn(F.s.vb,F.s.Wa);else{if(Ke.h)break e;Fe?.(F,ke>De?De:ke),F.a=0,F.$=nn-Y}return 1}return F.a=3,0}function Wm(F){n(null!=F),F.vc=null,F.yc=null,F.Ya=null;var H=F.Wa;null!=H&&(H.X=null),F.vb=null,n(null!=F)}function up(){var F=new CN;return null==F?null:(F.a=0,F.xb=vj,Gm("Predictor","VP8LPredictors"),Gm("Predictor","VP8LPredictors_C"),Gm("PredictorAdd","VP8LPredictorsAdd"),Gm("PredictorAdd","VP8LPredictorsAdd_C"),eF=Do,hp=Es,Dg=er,rv=id,Ym=na,w0=yg,dC=qa,Ye.VP8LMapColor32b=zS,Ye.VP8LMapColor8b=TN,F)}function Zm(F,H,Y,oe,ve){var De=1,Fe=[F],ke=[H],Pe=oe.m,Ke=oe.s,xt=null,nn=0;e:for(;;){if(Y)for(;De&&pn(Pe,1);){var rn=Fe,Lt=ke,Yn=oe,Sn=1,Et=Yn.m,Ft=Yn.gc[Yn.ab],qn=pn(Et,2);if(Yn.Oc&1<<qn)De=0;else{switch(Yn.Oc|=1<<qn,Ft.hc=qn,Ft.Ea=rn[0],Ft.nc=Lt[0],Ft.K=[null],++Yn.ab,n(4>=Yn.ab),qn){case 0:case 1:Ft.b=pn(Et,3)+2,Sn=Zm(yr(Ft.Ea,Ft.b),yr(Ft.nc,Ft.b),0,Yn,Ft.K),Ft.K=Ft.K[0];break;case 3:var si,Wn=pn(Et,8)+1,sr=16<Wn?0:4<Wn?1:2<Wn?2:3;if(rn[0]=yr(Ft.Ea,sr),Ft.b=sr,si=Sn=Zm(Wn,1,0,Yn,Ft.K)){var Ui,ts=Wn,Gi=Ft,la=1<<(8>>Gi.b),Ca=l(la);if(null==Ca)si=0;else{var Yo=Gi.K[0],Bo=Gi.w;for(Ca[0]=Gi.K[0][0],Ui=1;Ui<1*ts;++Ui)Ca[Ui]=mi(Yo[Bo+Ui],Ca[Ui-1]);for(;Ui<4*la;++Ui)Ca[Ui]=0;Gi.K[0]=null,Gi.K[0]=Ca,si=1}}Sn=si;break;case 2:break;default:n(0)}De=Sn}}if(Fe=Fe[0],ke=ke[0],De&&pn(Pe,1)&&!(De=1<=(nn=pn(Pe,4))&&11>=nn)){oe.a=3;break e}var Ka;if(Ka=De)t:{var Fa,Ws,nu,Cf=oe,iu=Fe,Ef=ke,Ea=nn,xA=Y,CA=Cf.m,Wu=Cf.s,Th=[null],Rd=1,pp=0,Jm=bue[Ea];n:for(;;){if(xA&&pn(CA,1)){var Zu=pn(CA,3)+2,T0=yr(iu,Zu),pb=yr(Ef,Zu),gC=T0*pb;if(!Zm(T0,pb,0,Cf,Th))break n;for(Th=Th[0],Wu.xc=Zu,Fa=0;Fa<gC;++Fa){var uv=Th[Fa]>>8&65535;Th[Fa]=uv,uv>=Rd&&(Rd=uv+1)}}if(CA.h)break n;for(Ws=0;5>Ws;++Ws){var hc=_j[Ws];!Ws&&0<Ea&&(hc+=1<<Ea),pp<hc&&(pp=hc)}var PN=h(Rd*Jm,ze),Dj=Rd,Bj=h(Dj,lt);if(null==Bj)var hF=null;else n(65536>=Dj),hF=Bj;var GS=l(pp);if(null==hF||null==GS||null==PN){Cf.a=1;break n}var dF=PN;for(Fa=nu=0;Fa<Rd;++Fa){var Rg=hF[Fa],mC=Rg.G,_C=Rg.H,Mj=0,fF=1,Fj=0;for(Ws=0;5>Ws;++Ws){hc=_j[Ws],mC[Ws]=dF,_C[Ws]=nu,!Ws&&0<Ea&&(hc+=1<<Ea);r:{var AF,NN=hc,pF=Cf,$S=GS,Hue=dF,Que=nu,LN=0,hv=pF.m,jue=pn(hv,1);if(s($S,0,0,NN),jue){var Gue=pn(hv,1)+1,$ue=pn(hv,1),Rj=pn(hv,0==$ue?1:8);$S[Rj]=1,2==Gue&&($S[Rj=pn(hv,8)]=1);var gF=1}else{var Oj=l(19),kj=pn(hv,4)+4;if(19<kj){pF.a=3;var mF=0;break r}for(AF=0;AF<kj;++AF)Oj[yue[AF]]=pn(hv,3);var UN=void 0,qS=void 0,Pj=pF,que=Oj,_F=NN,Nj=$S,zN=0,dv=Pj.m,Lj=8,Uj=h(128,ze);i:for(;Ue(Uj,0,7,que,19);){if(pn(dv,1)){var Kue=2+2*pn(dv,3);if((UN=2+pn(dv,Kue))>_F)break i}else UN=_F;for(qS=0;qS<_F&&UN--;){Nt(dv);var zj=Uj[0+(127&Xe(dv))];_t(dv,dv.u+zj.g);var yC=zj.value;if(16>yC)Nj[qS++]=yC,0!=yC&&(Lj=yC);else{var Wue=16==yC,Vj=yC-16,Zue=mue[Vj],Hj=pn(dv,gue[Vj])+Zue;if(qS+Hj>_F)break i;for(var Xue=Wue?Lj:0;0<Hj--;)Nj[qS++]=Xue}}zN=1;break i}zN||(Pj.a=3),gF=zN}(gF=gF&&!hv.h)&&(LN=Ue(Hue,Que,8,$S,NN)),gF&&0!=LN?mF=LN:(pF.a=3,mF=0)}if(0==mF)break n;if(fF&&1==_ue[Ws]&&(fF=0==dF[nu].g),Mj+=dF[nu].g,nu+=mF,3>=Ws){var KS,VN=GS[0];for(KS=1;KS<hc;++KS)GS[KS]>VN&&(VN=GS[KS]);Fj+=VN}}if(Rg.nd=fF,Rg.Qb=0,fF&&(Rg.qb=(mC[3][_C[3]+0].value<<24|mC[1][_C[1]+0].value<<16|mC[2][_C[2]+0].value)>>>0,0==Mj&&256>mC[0][_C[0]+0].value&&(Rg.Qb=1,Rg.qb+=mC[0][_C[0]+0].value<<8)),Rg.jc=!Rg.Qb&&6>Fj,Rg.jc){var yF,I0=Rg;for(yF=0;yF<wf;++yF){var fv=yF,Av=I0.pd[fv],vF=I0.G[0][I0.H[0]+fv];256<=vF.value?(Av.g=vF.g+256,Av.value=vF.value):(Av.g=0,Av.value=0,fv>>=wu(vF,8,Av),fv>>=wu(I0.G[1][I0.H[1]+fv],16,Av),fv>>=wu(I0.G[2][I0.H[2]+fv],0,Av),wu(I0.G[3][I0.H[3]+fv],24,Av))}}}Wu.vc=Th,Wu.Wb=Rd,Wu.Ya=hF,Wu.yc=PN,Ka=1;break t}Ka=0}if(!(De=Ka)){oe.a=3;break e}if(0<nn){if(Ke.ua=1<<nn,!ss(Ke.Wa,nn)){oe.a=1,De=0;break e}}else Ke.ua=0;var HN=oe,Qj=Fe,Yue=ke,QN=HN.s,jN=QN.xc;if(HN.c=Qj,HN.i=Yue,QN.md=yr(Qj,jN),QN.wc=0==jN?-1:(1<<jN)-1,Y){oe.xb=Due;break e}if(null==(xt=l(Fe*ke))){oe.a=1,De=0;break e}De=(De=Cg(oe,xt,0,Fe,ke,ke,null))&&!Pe.h;break e}return De?(null!=ve?ve[0]=xt:(n(null==xt),n(Y)),oe.$=0,Y||Wm(Ke)):Wm(Ke),De}function lb(F,H){var Y=F.c*F.i,oe=Y+H+16*H;return n(F.c<=H),F.V=l(oe),null==F.V?(F.Ta=null,F.Ua=0,F.a=1,0):(F.Ta=F.V,F.Ua=F.Ba+Y+H,1)}function qx(F,H){var Y=F.C,oe=H-Y,ve=F.V,De=F.Ba+F.c*Y;for(n(H<=F.l.o);0<oe;){var Fe=16<oe?16:oe,ke=F.l.ma,Pe=F.l.width,Ke=Pe*Fe,xt=ke.ca,nn=ke.tb+Pe*Y,rn=F.Ta,Lt=F.Ua;vA(F,Fe,ve,De),uj(rn,Lt,xt,nn,Ke),wg(ke,Y,Y+Fe,xt,nn,Pe),oe-=Fe,ve+=Fe*F.c,Y+=Fe}n(Y==H),F.C=F.Ma=H}function Kx(){this.ub=this.yd=this.td=this.Rb=0}function Wx(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Zx(){this.Fb=this.Bb=this.Cb=0,this.Zb=l(4),this.Lb=l(4)}function OM(){var F;this.Yb=(function H(Y,oe,ve){for(var De=ve[oe],Fe=0;Fe<De&&(Y.push(ve.length>oe+1?[]:0),!(ve.length<oe+1));Fe++)H(Y[Fe],oe+1,ve)}(F=[],0,[3,11]),F)}function tN(){this.jb=l(3),this.Wc=m([4,8],OM),this.Xc=m([4,17],OM)}function nN(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new l(4),this.od=new l(4)}function Xx(){this.ld=this.La=this.dd=this.tc=0}function kM(){this.Na=this.la=0}function iN(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function vS(){this.ad=l(384),this.Za=0,this.Ob=l(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function rN(){this.uc=this.M=this.Nb=0,this.wa=Array(new Xx),this.Y=0,this.ya=Array(new vS),this.aa=0,this.l=new Yx}function PM(){this.y=l(16),this.f=l(8),this.ea=l(8)}function sN(){this.cb=this.a=0,this.sc="",this.m=new Ti,this.Od=new Kx,this.Kc=new Wx,this.ed=new nN,this.Qa=new Zx,this.Ic=this.$c=this.Aa=0,this.D=new rN,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=h(8,Ti),this.ia=0,this.pb=h(4,iN),this.Pa=new tN,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new PM),this.Hd=0,this.rb=Array(new kM),this.sb=0,this.wa=Array(new Xx),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new vS),this.L=this.aa=0,this.gd=m([4,2],Xx),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Yx(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function oN(){var F=new sN;return null!=F&&(F.a=0,F.sc="OK",F.cb=0,F.Xb=0,QS||(QS=UM)),F}function Mc(F,H,Y){return 0==F.a&&(F.a=H,F.sc=Y,F.cb=0),0}function NM(F,H,Y){return 3<=Y&&157==F[H+0]&&1==F[H+1]&&42==F[H+2]}function LM(F,H){if(null==F)return 0;if(F.a=0,F.sc="OK",null==H)return Mc(F,2,"null VP8Io passed to VP8GetHeaders()");var Y=H.data,oe=H.w,ve=H.ha;if(4>ve)return Mc(F,7,"Truncated header.");var De=Y[oe+0]|Y[oe+1]<<8|Y[oe+2]<<16,Fe=F.Od;if(Fe.Rb=!(1&De),Fe.td=De>>1&7,Fe.yd=De>>4&1,Fe.ub=De>>5,3<Fe.td)return Mc(F,3,"Incorrect keyframe parameters.");if(!Fe.yd)return Mc(F,4,"Frame not displayable.");oe+=3,ve-=3;var ke=F.Kc;if(Fe.Rb){if(7>ve)return Mc(F,7,"cannot parse picture header");if(!NM(Y,oe,ve))return Mc(F,3,"Bad code word");ke.c=16383&(Y[oe+4]<<8|Y[oe+3]),ke.Td=Y[oe+4]>>6,ke.i=16383&(Y[oe+6]<<8|Y[oe+5]),ke.Ud=Y[oe+6]>>6,oe+=7,ve-=7,F.za=ke.c+15>>4,F.Ub=ke.i+15>>4,H.width=ke.c,H.height=ke.i,H.Da=0,H.j=0,H.v=0,H.va=H.width,H.o=H.height,H.da=0,H.ib=H.width,H.hb=H.height,H.U=H.width,H.T=H.height,s((De=F.Pa).jb,0,255,De.jb.length),n(null!=(De=F.Qa)),De.Cb=0,De.Bb=0,De.Fb=1,s(De.Zb,0,0,De.Zb.length),s(De.Lb,0,0,De.Lb)}if(Fe.ub>ve)return Mc(F,7,"bad partition length");_n(De=F.m,Y,oe,Fe.ub),oe+=Fe.ub,ve-=Fe.ub,Fe.Rb&&(ke.Ld=en(De),ke.Kd=en(De)),ke=F.Qa;var Pe,Ke=F.Pa;if(n(null!=De),n(null!=ke),ke.Cb=en(De),ke.Cb){if(ke.Bb=en(De),en(De)){for(ke.Fb=en(De),Pe=0;4>Pe;++Pe)ke.Zb[Pe]=en(De)?Ot(De,7):0;for(Pe=0;4>Pe;++Pe)ke.Lb[Pe]=en(De)?Ot(De,6):0}if(ke.Bb)for(Pe=0;3>Pe;++Pe)Ke.jb[Pe]=en(De)?ft(De,8):255}else ke.Bb=0;if(De.Ka)return Mc(F,3,"cannot parse segment header");if((ke=F.ed).zd=en(De),ke.Tb=ft(De,6),ke.wb=ft(De,3),ke.Pc=en(De),ke.Pc&&en(De)){for(Ke=0;4>Ke;++Ke)en(De)&&(ke.vd[Ke]=Ot(De,6));for(Ke=0;4>Ke;++Ke)en(De)&&(ke.od[Ke]=Ot(De,6))}if(F.L=0==ke.Tb?0:ke.zd?1:2,De.Ka)return Mc(F,3,"cannot parse filter header");var xt=ve;if(ve=Pe=oe,oe=Pe+xt,ke=xt,F.Xb=(1<<ft(F.m,2))-1,xt<3*(Ke=F.Xb))Y=7;else{for(Pe+=3*Ke,ke-=3*Ke,xt=0;xt<Ke;++xt){var nn=Y[ve+0]|Y[ve+1]<<8|Y[ve+2]<<16;nn>ke&&(nn=ke),_n(F.Jc[+xt],Y,Pe,nn),Pe+=nn,ke-=nn,ve+=3}_n(F.Jc[+Ke],Y,Pe,ke),Y=Pe<oe?0:5}if(0!=Y)return Mc(F,Y,"cannot parse partitions");for(Y=ft(Pe=F.m,7),ve=en(Pe)?Ot(Pe,4):0,oe=en(Pe)?Ot(Pe,4):0,ke=en(Pe)?Ot(Pe,4):0,Ke=en(Pe)?Ot(Pe,4):0,Pe=en(Pe)?Ot(Pe,4):0,xt=F.Qa,nn=0;4>nn;++nn){if(xt.Cb){var rn=xt.Zb[nn];xt.Fb||(rn+=Y)}else{if(0<nn){F.pb[nn]=F.pb[0];continue}rn=Y}var Lt=F.pb[nn];Lt.Sc[0]=RN[bA(rn+ve,127)],Lt.Sc[1]=ON[bA(rn+0,127)],Lt.Eb[0]=2*RN[bA(rn+oe,127)],Lt.Eb[1]=101581*ON[bA(rn+ke,127)]>>16,8>Lt.Eb[1]&&(Lt.Eb[1]=8),Lt.Qc[0]=RN[bA(rn+Ke,117)],Lt.Qc[1]=ON[bA(rn+Pe,127)],Lt.lc=rn+Pe}if(!Fe.Rb)return Mc(F,4,"Not a key frame.");for(en(De),Fe=F.Pa,Y=0;4>Y;++Y){for(ve=0;8>ve;++ve)for(oe=0;3>oe;++oe)for(ke=0;11>ke;++ke)Ke=sn(De,Tue[Y][ve][oe][ke])?ft(De,8):Eue[Y][ve][oe][ke],Fe.Wc[Y][ve].Yb[oe][ke]=Ke;for(ve=0;17>ve;++ve)Fe.Xc[Y][ve]=Fe.Wc[Y][Iue[ve]]}return F.kc=en(De),F.kc&&(F.Bd=ft(De,8)),F.cb=1}function UM(F,H,Y,oe,ve,De,Fe){var ke=H[ve].Yb[Y];for(Y=0;16>ve;++ve){if(!sn(F,ke[Y+0]))return ve;for(;!sn(F,ke[Y+1]);)if(ke=H[++ve].Yb[0],Y=0,16==ve)return 16;var Pe=H[ve+1].Yb;if(sn(F,ke[Y+2])){var Ke=F,xt=0;if(sn(Ke,(rn=ke)[(nn=Y)+3]))if(sn(Ke,rn[nn+6])){for(ke=0,nn=2*(xt=sn(Ke,rn[nn+8]))+(rn=sn(Ke,rn[nn+9+xt])),xt=0,rn=xue[nn];rn[ke];++ke)xt+=xt+sn(Ke,rn[ke]);xt+=3+(8<<nn)}else sn(Ke,rn[nn+7])?(xt=7+2*sn(Ke,165),xt+=sn(Ke,145)):xt=5+sn(Ke,159);else xt=sn(Ke,rn[nn+4])?3+sn(Ke,rn[nn+5]):2;ke=Pe[2]}else xt=1,ke=Pe[1];Pe=Fe+Cue[ve],0>(Ke=F).b&&jt(Ke);var nn,rn=Ke.b,Lt=(nn=Ke.Ca>>1)-(Ke.I>>rn)>>31;--Ke.b,Ke.Ca+=Lt,Ke.Ca|=1,Ke.I-=(nn+1&Lt)<<rn,De[Pe]=((xt^Lt)-Lt)*oe[(0<ve)+0]}return 16}function bS(F){var H=F.rb[F.sb-1];H.la=0,H.Na=0,s(F.zc,0,0,F.zc.length),F.ja=0}function Eg(F,H,Y,oe,ve){F[H+Y+32*oe]=-256&(ve=F[H+Y+32*oe]+(ve>>3))?0>ve?0:255:ve}function Jx(F,H,Y,oe,ve,De){Eg(F,H,0,Y,oe+ve),Eg(F,H,1,Y,oe+De),Eg(F,H,2,Y,oe-De),Eg(F,H,3,Y,oe-ve)}function bf(F){return(20091*F>>16)+F}function wS(F,H,Y,oe){var ve,De=0,Fe=l(16);for(ve=0;4>ve;++ve){var ke=F[H+0]+F[H+8],Pe=F[H+0]-F[H+8],Ke=(35468*F[H+4]>>16)-bf(F[H+12]),xt=bf(F[H+4])+(35468*F[H+12]>>16);Fe[De+0]=ke+xt,Fe[De+1]=Pe+Ke,Fe[De+2]=Pe-Ke,Fe[De+3]=ke-xt,De+=4,H++}for(ve=De=0;4>ve;++ve)ke=(F=Fe[De+0]+4)+Fe[De+8],Pe=F-Fe[De+8],Ke=(35468*Fe[De+4]>>16)-bf(Fe[De+12]),Eg(Y,oe,0,0,ke+(xt=bf(Fe[De+4])+(35468*Fe[De+12]>>16))),Eg(Y,oe,1,0,Pe+Ke),Eg(Y,oe,2,0,Pe-Ke),Eg(Y,oe,3,0,ke-xt),De++,oe+=32}function zM(F,H,Y,oe){var ve=F[H+0]+4,De=35468*F[H+4]>>16,Fe=bf(F[H+4]),ke=35468*F[H+1]>>16;Jx(Y,oe,0,ve+Fe,F=bf(F[H+1]),ke),Jx(Y,oe,1,ve+De,F,ke),Jx(Y,oe,2,ve-De,F,ke),Jx(Y,oe,3,ve-Fe,F,ke)}function lN(F,H,Y,oe,ve){wS(F,H,Y,oe),ve&&wS(F,H+16,Y,oe+4)}function VM(F,H,Y,oe){fC(F,H+0,Y,oe,1),fC(F,H+32,Y,oe+128,1)}function cN(F,H,Y,oe){var ve;for(F=F[H+0]+4,ve=0;4>ve;++ve)for(H=0;4>H;++H)Eg(Y,oe,H,ve,F)}function HM(F,H,Y,oe){F[H+0]&&Mg(F,H+0,Y,oe),F[H+16]&&Mg(F,H+16,Y,oe+4),F[H+32]&&Mg(F,H+32,Y,oe+128),F[H+48]&&Mg(F,H+48,Y,oe+128+4)}function uN(F,H,Y,oe){var ve,De=l(16);for(ve=0;4>ve;++ve){var Fe=F[H+0+ve]+F[H+12+ve],ke=F[H+4+ve]+F[H+8+ve],Pe=F[H+4+ve]-F[H+8+ve],Ke=F[H+0+ve]-F[H+12+ve];De[0+ve]=Fe+ke,De[8+ve]=Fe-ke,De[4+ve]=Ke+Pe,De[12+ve]=Ke-Pe}for(ve=0;4>ve;++ve)Fe=(F=De[0+4*ve]+3)+De[3+4*ve],Pe=De[1+4*ve]-De[2+4*ve],Ke=F-De[3+4*ve],Y[oe+0]=Fe+(ke=De[1+4*ve]+De[2+4*ve])>>3,Y[oe+16]=Ke+Pe>>3,Y[oe+32]=Fe-ke>>3,Y[oe+48]=Ke-Pe>>3,oe+=64}function xS(F,H,Y){var oe,ve=H-32,De=wA,Fe=255-F[ve-1];for(oe=0;oe<Y;++oe){var ke,Pe=De,Ke=Fe+F[H-1];for(ke=0;ke<Y;++ke)F[H+ke]=Pe[Ke+F[ve+ke]];H+=32}}function hN(F,H){xS(F,H,4)}function dN(F,H){xS(F,H,8)}function fN(F,H){xS(F,H,16)}function y0(F,H){var Y;for(Y=0;16>Y;++Y)i(F,H+32*Y,F,H-32,16)}function eC(F,H){var Y;for(Y=16;0<Y;--Y)s(F,H,F[H-1],16),H+=32}function tC(F,H,Y){var oe;for(oe=0;16>oe;++oe)s(H,Y+32*oe,F,16)}function QM(F,H){var Y,oe=16;for(Y=0;16>Y;++Y)oe+=F[H-1+32*Y]+F[H+Y-32];tC(oe>>5,F,H)}function rd(F,H){var Y,oe=8;for(Y=0;16>Y;++Y)oe+=F[H-1+32*Y];tC(oe>>4,F,H)}function AN(F,H){var Y,oe=8;for(Y=0;16>Y;++Y)oe+=F[H+Y-32];tC(oe>>4,F,H)}function jM(F,H){tC(128,F,H)}function Ns(F,H,Y){return F+2*H+Y+2>>2}function pN(F,H){var Y,oe=H-32;for(oe=new Uint8Array([Ns(F[oe-1],F[oe+0],F[oe+1]),Ns(F[oe+0],F[oe+1],F[oe+2]),Ns(F[oe+1],F[oe+2],F[oe+3]),Ns(F[oe+2],F[oe+3],F[oe+4])]),Y=0;4>Y;++Y)i(F,H+32*Y,oe,0,oe.length)}function gN(F,H){var Y=F[H-1],oe=F[H-1+32],ve=F[H-1+64],De=F[H-1+96];bi(F,H+0,16843009*Ns(F[H-1-32],Y,oe)),bi(F,H+32,16843009*Ns(Y,oe,ve)),bi(F,H+64,16843009*Ns(oe,ve,De)),bi(F,H+96,16843009*Ns(ve,De,De))}function Xm(F,H){var Y,oe=4;for(Y=0;4>Y;++Y)oe+=F[H+Y-32]+F[H-1+32*Y];for(oe>>=3,Y=0;4>Y;++Y)s(F,H+32*Y,oe,4)}function GM(F,H){var Y=F[H-1+0],oe=F[H-1+32],ve=F[H-1+64],De=F[H-1-32],Fe=F[H+0-32],ke=F[H+1-32],Pe=F[H+2-32],Ke=F[H+3-32];F[H+0+96]=Ns(oe,ve,F[H-1+96]),F[H+1+96]=F[H+0+64]=Ns(Y,oe,ve),F[H+2+96]=F[H+1+64]=F[H+0+32]=Ns(De,Y,oe),F[H+3+96]=F[H+2+64]=F[H+1+32]=F[H+0+0]=Ns(Fe,De,Y),F[H+3+64]=F[H+2+32]=F[H+1+0]=Ns(ke,Fe,De),F[H+3+32]=F[H+2+0]=Ns(Pe,ke,Fe),F[H+3+0]=Ns(Ke,Pe,ke)}function $M(F,H){var Y=F[H+1-32],oe=F[H+2-32],ve=F[H+3-32],De=F[H+4-32],Fe=F[H+5-32],ke=F[H+6-32],Pe=F[H+7-32];F[H+0+0]=Ns(F[H+0-32],Y,oe),F[H+1+0]=F[H+0+32]=Ns(Y,oe,ve),F[H+2+0]=F[H+1+32]=F[H+0+64]=Ns(oe,ve,De),F[H+3+0]=F[H+2+32]=F[H+1+64]=F[H+0+96]=Ns(ve,De,Fe),F[H+3+32]=F[H+2+64]=F[H+1+96]=Ns(De,Fe,ke),F[H+3+64]=F[H+2+96]=Ns(Fe,ke,Pe),F[H+3+96]=Ns(ke,Pe,Pe)}function nC(F,H){var Y=F[H-1+0],oe=F[H-1+32],ve=F[H-1+64],De=F[H-1-32],Fe=F[H+0-32],ke=F[H+1-32],Pe=F[H+2-32],Ke=F[H+3-32];F[H+0+0]=F[H+1+64]=De+Fe+1>>1,F[H+1+0]=F[H+2+64]=Fe+ke+1>>1,F[H+2+0]=F[H+3+64]=ke+Pe+1>>1,F[H+3+0]=Pe+Ke+1>>1,F[H+0+96]=Ns(ve,oe,Y),F[H+0+64]=Ns(oe,Y,De),F[H+0+32]=F[H+1+96]=Ns(Y,De,Fe),F[H+1+32]=F[H+2+96]=Ns(De,Fe,ke),F[H+2+32]=F[H+3+96]=Ns(Fe,ke,Pe),F[H+3+32]=Ns(ke,Pe,Ke)}function CS(F,H){var Y=F[H+0-32],oe=F[H+1-32],ve=F[H+2-32],De=F[H+3-32],Fe=F[H+4-32],ke=F[H+5-32],Pe=F[H+6-32],Ke=F[H+7-32];F[H+0+0]=Y+oe+1>>1,F[H+1+0]=F[H+0+64]=oe+ve+1>>1,F[H+2+0]=F[H+1+64]=ve+De+1>>1,F[H+3+0]=F[H+2+64]=De+Fe+1>>1,F[H+0+32]=Ns(Y,oe,ve),F[H+1+32]=F[H+0+96]=Ns(oe,ve,De),F[H+2+32]=F[H+1+96]=Ns(ve,De,Fe),F[H+3+32]=F[H+2+96]=Ns(De,Fe,ke),F[H+3+64]=Ns(Fe,ke,Pe),F[H+3+96]=Ns(ke,Pe,Ke)}function mN(F,H){var Y=F[H-1+0],oe=F[H-1+32],ve=F[H-1+64],De=F[H-1+96];F[H+0+0]=Y+oe+1>>1,F[H+2+0]=F[H+0+32]=oe+ve+1>>1,F[H+2+32]=F[H+0+64]=ve+De+1>>1,F[H+1+0]=Ns(Y,oe,ve),F[H+3+0]=F[H+1+32]=Ns(oe,ve,De),F[H+3+32]=F[H+1+64]=Ns(ve,De,De),F[H+3+64]=F[H+2+64]=F[H+0+96]=F[H+1+96]=F[H+2+96]=F[H+3+96]=De}function _N(F,H){var Y=F[H-1+0],oe=F[H-1+32],ve=F[H-1+64],De=F[H-1+96],Fe=F[H-1-32],ke=F[H+0-32],Pe=F[H+1-32],Ke=F[H+2-32];F[H+0+0]=F[H+2+32]=Y+Fe+1>>1,F[H+0+32]=F[H+2+64]=oe+Y+1>>1,F[H+0+64]=F[H+2+96]=ve+oe+1>>1,F[H+0+96]=De+ve+1>>1,F[H+3+0]=Ns(ke,Pe,Ke),F[H+2+0]=Ns(Fe,ke,Pe),F[H+1+0]=F[H+3+32]=Ns(Y,Fe,ke),F[H+1+32]=F[H+3+64]=Ns(oe,Y,Fe),F[H+1+64]=F[H+3+96]=Ns(ve,oe,Y),F[H+1+96]=Ns(De,ve,oe)}function yN(F,H){var Y;for(Y=0;8>Y;++Y)i(F,H+32*Y,F,H-32,8)}function ES(F,H){var Y;for(Y=0;8>Y;++Y)s(F,H,F[H-1],8),H+=32}function cb(F,H,Y){var oe;for(oe=0;8>oe;++oe)s(H,Y+32*oe,F,8)}function Jy(F,H){var Y,oe=8;for(Y=0;8>Y;++Y)oe+=F[H+Y-32]+F[H-1+32*Y];cb(oe>>4,F,H)}function vN(F,H){var Y,oe=4;for(Y=0;8>Y;++Y)oe+=F[H+Y-32];cb(oe>>3,F,H)}function ub(F,H){var Y,oe=4;for(Y=0;8>Y;++Y)oe+=F[H-1+32*Y];cb(oe>>3,F,H)}function SS(F,H){cb(128,F,H)}function iC(F,H,Y){var oe=F[H-Y],ve=F[H+0],De=3*(ve-oe)+IN[1020+F[H-2*Y]-F[H+Y]],Fe=nF[112+(De+4>>3)];F[H-Y]=wA[255+oe+nF[112+(De+3>>3)]],F[H+0]=wA[255+ve-Fe]}function qM(F,H,Y,oe){return fp[255+F[H-2*Y]-F[H-Y]]>oe||fp[255+F[H+Y]-F[H+0]]>oe}function KM(F,H,Y,oe){return 4*fp[255+F[H-Y]-F[H+0]]+fp[255+F[H-2*Y]-F[H+Y]]<=oe}function WM(F,H,Y,oe,ve){var De=F[H-3*Y],Fe=F[H-2*Y],ke=F[H-Y],Pe=F[H+0],Ke=F[H+Y],xt=F[H+2*Y];return 4*fp[255+ke-Pe]+fp[255+Fe-Ke]>oe?0:fp[255+F[H-4*Y]-De]<=ve&&fp[255+De-Fe]<=ve&&fp[255+Fe-ke]<=ve&&fp[255+F[H+3*Y]-xt]<=ve&&fp[255+xt-Ke]<=ve&&fp[255+Ke-Pe]<=ve}function ZM(F,H,Y,oe){var ve=2*oe+1;for(oe=0;16>oe;++oe)KM(F,H+oe,Y,ve)&&iC(F,H+oe,Y)}function v0(F,H,Y,oe){var ve=2*oe+1;for(oe=0;16>oe;++oe)KM(F,H+oe*Y,1,ve)&&iC(F,H+oe*Y,1)}function ev(F,H,Y,oe){var ve;for(ve=3;0<ve;--ve)ZM(F,H+=4*Y,Y,oe)}function bN(F,H,Y,oe){var ve;for(ve=3;0<ve;--ve)v0(F,H+=4,Y,oe)}function tv(F,H,Y,oe,ve,De,Fe,ke){for(De=2*De+1;0<ve--;){if(WM(F,H,Y,De,Fe))if(qM(F,H,Y,ke))iC(F,H,Y);else{var Pe=F,Ke=H,xt=Y,nn=Pe[Ke-2*xt],rn=Pe[Ke-xt],Lt=Pe[Ke+0],Yn=Pe[Ke+xt],Sn=Pe[Ke+2*xt],Et=27*(qn=IN[1020+3*(Lt-rn)+IN[1020+nn-Yn]])+63>>7,Ft=18*qn+63>>7,qn=9*qn+63>>7;Pe[Ke-3*xt]=wA[255+Pe[Ke-3*xt]+qn],Pe[Ke-2*xt]=wA[255+nn+Ft],Pe[Ke-xt]=wA[255+rn+Et],Pe[Ke+0]=wA[255+Lt-Et],Pe[Ke+xt]=wA[255+Yn-Ft],Pe[Ke+2*xt]=wA[255+Sn-qn]}H+=oe}}function Sg(F,H,Y,oe,ve,De,Fe,ke){for(De=2*De+1;0<ve--;){if(WM(F,H,Y,De,Fe))if(qM(F,H,Y,ke))iC(F,H,Y);else{var Pe=F,Ke=H,xt=Y,nn=Pe[Ke-xt],rn=Pe[Ke+0],Lt=Pe[Ke+xt],Yn=nF[112+(4+(Sn=3*(rn-nn))>>3)],Sn=nF[112+(Sn+3>>3)],Et=Yn+1>>1;Pe[Ke-2*xt]=wA[255+Pe[Ke-2*xt]+Et],Pe[Ke-xt]=wA[255+nn+Sn],Pe[Ke+0]=wA[255+rn-Yn],Pe[Ke+xt]=wA[255+Lt-Et]}H+=oe}}function TS(F,H,Y,oe,ve,De){tv(F,H,Y,1,16,oe,ve,De)}function hb(F,H,Y,oe,ve,De){tv(F,H,1,Y,16,oe,ve,De)}function wN(F,H,Y,oe,ve,De){var Fe;for(Fe=3;0<Fe;--Fe)Sg(F,H+=4*Y,Y,1,16,oe,ve,De)}function rC(F,H,Y,oe,ve,De){var Fe;for(Fe=3;0<Fe;--Fe)Sg(F,H+=4,1,Y,16,oe,ve,De)}function xN(F,H,Y,oe,ve,De,Fe,ke){tv(F,H,ve,1,8,De,Fe,ke),tv(Y,oe,ve,1,8,De,Fe,ke)}function IS(F,H,Y,oe,ve,De,Fe,ke){tv(F,H,1,ve,8,De,Fe,ke),tv(Y,oe,1,ve,8,De,Fe,ke)}function DS(F,H,Y,oe,ve,De,Fe,ke){Sg(F,H+4*ve,ve,1,8,De,Fe,ke),Sg(Y,oe+4*ve,ve,1,8,De,Fe,ke)}function XM(F,H,Y,oe,ve,De,Fe,ke){Sg(F,H+4,1,ve,8,De,Fe,ke),Sg(Y,oe+4,1,ve,8,De,Fe,ke)}function sC(){this.ba=new vg,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new cc,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function BS(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function MS(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function YM(){this.ua=0,this.Wa=new at,this.vb=new at,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new lt,this.yc=new ze}function CN(){this.xb=this.a=0,this.l=new Yx,this.ca=new vg,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Se,this.Pb=0,this.wd=new Se,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new YM,this.ab=0,this.gc=h(4,MS),this.Oc=0}function oC(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Yx,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function db(F,H,Y,oe,ve,De,Fe){for(F=null==F?0:F[H+0],H=0;H<Fe;++H)ve[De+H]=F+Y[oe+H]&255,F=ve[De+H]}function FS(F,H,Y,oe,ve,De,Fe){var ke;if(null==F)db(null,null,Y,oe,ve,De,Fe);else for(ke=0;ke<Fe;++ke)ve[De+ke]=F[H+ke]+Y[oe+ke]&255}function nv(F,H,Y,oe,ve,De,Fe){if(null==F)db(null,null,Y,oe,ve,De,Fe);else{var ke,Pe=F[H+0],Ke=Pe,xt=Pe;for(ke=0;ke<Fe;++ke)Ke=xt+(Pe=F[H+ke])-Ke,xt=Y[oe+ke]+(-256&Ke?0>Ke?0:255:Ke)&255,Ke=Pe,ve[De+ke]=xt}}function RS(F,H,Y,oe){var ve=H.width,De=H.o;if(n(null!=F&&null!=H),0>Y||0>=oe||Y+oe>De)return null;if(!F.Cc){if(null==F.ga){var Fe;if(F.ga=new oC,(Fe=null==F.ga)||(Fe=H.width*H.o,n(0==F.Gb.length),F.Gb=l(Fe),F.Uc=0,null==F.Gb?Fe=0:(F.mb=F.Gb,F.nb=F.Uc,F.rc=null,Fe=1),Fe=!Fe),!Fe){var ke=F.Fa,Pe=F.P,Ke=F.qc,xt=F.mb,nn=F.nb,rn=Pe+1,Lt=Ke-1,Yn=(Fe=F.ga).l;if(n(null!=ke&&null!=xt&&null!=H),cv[0]=null,cv[1]=db,cv[2]=FS,cv[3]=nv,Fe.ca=xt,Fe.tb=nn,Fe.c=H.width,Fe.i=H.height,n(0<Fe.c&&0<Fe.i),1>=Ke)H=0;else if(Fe.$a=ke[Pe+0]>>0&3,Fe.Z=ke[Pe+0]>>2&3,Fe.Lc=ke[Pe+0]>>4&3,Pe=ke[Pe+0]>>6&3,0>Fe.$a||1<Fe.$a||4<=Fe.Z||1<Fe.Lc||Pe)H=0;else if(Yn.put=$m,Yn.ac=Sh,Yn.bc=qm,Yn.ma=Fe,Yn.width=H.width,Yn.height=H.height,Yn.Da=H.Da,Yn.v=H.v,Yn.va=H.va,Yn.j=H.j,Yn.o=H.o,Fe.$a)e:{n(1==Fe.$a),H=up();t:for(;;){if(null==H){H=0;break e}if(n(null!=Fe),Fe.mc=H,H.c=Fe.c,H.i=Fe.i,H.l=Fe.l,H.l.ma=Fe,H.l.width=Fe.c,H.l.height=Fe.i,H.a=0,wt(H.m,ke,rn,Lt),!Zm(Fe.c,Fe.i,1,H,null)||(1==H.ab&&3==H.gc[0].hc&&_0(H.s)?(Fe.ic=1,ke=H.c*H.i,H.Ta=null,H.Ua=0,H.V=l(ke),H.Ba=0,null==H.V?(H.a=1,H=0):H=1):(Fe.ic=0,H=lb(H,Fe.c)),!H))break t;H=1;break e}Fe.mc=null,H=0}else H=Lt>=Fe.c*Fe.i;Fe=!H}if(Fe)return null;1!=F.ga.Lc?F.Ga=0:oe=De-Y}n(null!=F.ga),n(Y+oe<=De);e:{if(H=(ke=F.ga).c,De=ke.l.o,0==ke.$a){if(rn=F.rc,Lt=F.Vc,Yn=F.Fa,Ke=F.mb,xt=F.nb+Y*H,n((Pe=F.P+1+Y*H)<=F.P+F.qc),0!=ke.Z)for(n(null!=cv[ke.Z]),Fe=0;Fe<oe;++Fe)cv[ke.Z](rn,Lt,Yn,Pe,Ke,xt,H),rn=Ke,Lt=xt,xt+=H,Pe+=H;else for(Fe=0;Fe<oe;++Fe)i(Ke,xt,Yn,Pe,H),rn=Ke,Lt=xt,xt+=H,Pe+=H;F.rc=rn,F.Vc=Lt}else{if(n(null!=ke.mc),H=Y+oe,n(null!=(Fe=ke.mc)),n(H<=Fe.i),Fe.C>=H)H=1;else if(ke.ic||qt(),ke.ic){ke=Fe.V,rn=Fe.Ba;var Sn=Fe.i,Et=(Yn=1,Pe=Fe.$/(Lt=Fe.c),Ke=Fe.$%Lt,xt=Fe.m,nn=Fe.s,Fe.$),Ft=Lt*Sn,qn=Lt*H,si=nn.wc,Wn=Et<qn?eu(nn,Ke,Pe):null;n(Et<=Ft),n(H<=Sn),n(_0(nn));t:for(;;){for(;!xt.h&&Et<qn;){if(Ke&si||(Wn=eu(nn,Ke,Pe)),n(null!=Wn),Nt(xt),256>(Sn=vf(Wn.G[0],Wn.H[0],xt)))ke[rn+Et]=Sn,++Et,++Ke>=Lt&&(Ke=0,++Pe<=H&&!(Pe%16)&&xg(Fe,Pe));else{if(!(280>Sn)){Yn=0;break t}Sn=bg(Sn-256,xt);var sr,Ui=vf(Wn.G[4],Wn.H[4],xt);if(Nt(xt),!(Et>=(Ui=Km(Lt,Ui=bg(Ui,xt)))&&Ft-Et>=Sn)){Yn=0;break t}for(sr=0;sr<Sn;++sr)ke[rn+Et+sr]=ke[rn+Et+sr-Ui];for(Et+=Sn,Ke+=Sn;Ke>=Lt;)Ke-=Lt,++Pe<=H&&!(Pe%16)&&xg(Fe,Pe);Et<qn&&Ke&si&&(Wn=eu(nn,Ke,Pe))}n(xt.h==Je(xt))}xg(Fe,Pe>H?H:Pe);break t}!Yn||xt.h&&Et<Ft?(Yn=0,Fe.a=xt.h?5:3):Fe.$=Et,H=Yn}else H=Cg(Fe,Fe.V,Fe.Ba,Fe.c,Fe.i,H,qx);if(!H){oe=0;break e}}Y+oe>=De&&(F.Cc=1),oe=1}if(!oe)return null;if(F.Cc&&(null!=(oe=F.ga)&&(oe.mc=null),F.ga=null,0<F.Ga))return alert("todo:WebPDequantizeLevels"),null}return F.nb+Y*ve}function W(F,H,Y,oe,ve,De){for(;0<ve--;){var Fe,ke=F,Pe=H+(Y?1:0),Ke=F,xt=H+(Y?0:3);for(Fe=0;Fe<oe;++Fe){var nn=Ke[xt+4*Fe];255!=nn&&(ke[Pe+4*Fe+0]=ke[Pe+4*Fe+0]*(nn*=32897)>>23,ke[Pe+4*Fe+1]=ke[Pe+4*Fe+1]*nn>>23,ke[Pe+4*Fe+2]=ke[Pe+4*Fe+2]*nn>>23)}H+=De}}function we(F,H,Y,oe,ve){for(;0<oe--;){var De;for(De=0;De<Y;++De){var Fe=F[H+2*De+0],ke=15&(Ke=F[H+2*De+1]),Pe=4369*ke,Ke=(240&Ke|Ke>>4)*Pe>>16;F[H+2*De+0]=(240&Fe|Fe>>4)*Pe>>16&240|(15&Fe|Fe<<4)*Pe>>16>>4&15,F[H+2*De+1]=240&Ke|ke}H+=ve}}function it(F,H,Y,oe,ve,De,Fe,ke){var Pe,Ke,xt=255;for(Ke=0;Ke<ve;++Ke){for(Pe=0;Pe<oe;++Pe){var nn=F[H+Pe];De[Fe+4*Pe]=nn,xt&=nn}H+=Y,Fe+=ke}return 255!=xt}function vt(F,H,Y,oe,ve){var De;for(De=0;De<ve;++De)Y[oe+De]=F[H+De]>>8}function qt(){av=W,pC=we,tF=it,uj=vt}function Dn(F,H,Y){Ye[F]=function(oe,ve,De,Fe,ke,Pe,Ke,xt,nn,rn,Lt,Yn,Sn,Et,Ft,qn,si){var Wn,sr=si-1>>1,Ui=ke[Pe+0]|Ke[xt+0]<<16,ts=nn[rn+0]|Lt[Yn+0]<<16;n(null!=oe);var Gi=3*Ui+ts+131074>>2;for(H(oe[ve+0],255&Gi,Gi>>16,Sn,Et),null!=De&&H(De[Fe+0],255&(Gi=3*ts+Ui+131074>>2),Gi>>16,Ft,qn),Wn=1;Wn<=sr;++Wn){var la=ke[Pe+Wn]|Ke[xt+Wn]<<16,Ca=nn[rn+Wn]|Lt[Yn+Wn]<<16,Yo=Ui+la+ts+Ca+524296,Bo=Yo+2*(la+ts)>>3;Gi=Bo+Ui>>1,Ui=(Yo=Yo+2*(Ui+Ca)>>3)+la>>1,H(oe[ve+2*Wn-1],255&Gi,Gi>>16,Sn,Et+(2*Wn-1)*Y),H(oe[ve+2*Wn-0],255&Ui,Ui>>16,Sn,Et+(2*Wn-0)*Y),null!=De&&(Ui=Bo+Ca>>1,H(De[Fe+2*Wn-1],255&(Gi=Yo+ts>>1),Gi>>16,Ft,qn+(2*Wn-1)*Y),H(De[Fe+2*Wn+0],255&Ui,Ui>>16,Ft,qn+(2*Wn+0)*Y)),Ui=la,ts=Ca}1&si||(H(oe[ve+si-1],255&(Gi=3*Ui+ts+131074>>2),Gi>>16,Sn,Et+(si-1)*Y),null!=De&&H(De[Fe+si-1],255&(Gi=3*ts+Ui+131074>>2),Gi>>16,Ft,qn+(si-1)*Y))}}function fi(){Ap[iF]=Bue,Ap[rF]=bj,Ap[gj]=Mue,Ap[sF]=wj,Ap[oF]=xj,Ap[DN]=Cj,Ap[mj]=Fue,Ap[BN]=bj,Ap[MN]=wj,Ap[aF]=xj,Ap[FN]=Cj}function nr(F){return F&~Rue?0>F?0:255:F>>Ej}function $r(F,H){return nr((19077*F>>8)+(26149*H>>8)-14234)}function js(F,H,Y){return nr((19077*F>>8)-(6419*H>>8)-(13320*Y>>8)+8708)}function co(F,H){return nr((19077*F>>8)+(33050*H>>8)-17685)}function Go(F,H,Y,oe,ve){oe[ve+0]=$r(F,Y),oe[ve+1]=js(F,H,Y),oe[ve+2]=co(F,H)}function Jl(F,H,Y,oe,ve){oe[ve+0]=co(F,H),oe[ve+1]=js(F,H,Y),oe[ve+2]=$r(F,Y)}function uc(F,H,Y,oe,ve){var De=js(F,H,Y);H=De<<3&224|co(F,H)>>3,oe[ve+0]=248&$r(F,Y)|De>>5,oe[ve+1]=H}function tu(F,H,Y,oe,ve){var De=240&co(F,H)|15;oe[ve+0]=240&$r(F,Y)|js(F,H,Y)>>4,oe[ve+1]=De}function sd(F,H,Y,oe,ve){oe[ve+0]=255,Go(F,H,Y,oe,ve+1)}function Ku(F,H,Y,oe,ve){Jl(F,H,Y,oe,ve),oe[ve+3]=255}function Tg(F,H,Y,oe,ve){Go(F,H,Y,oe,ve),oe[ve+3]=255}function bA(F,H){return 0>F?0:F>H?H:F}function b0(F,H,Y){Ye[F]=function(oe,ve,De,Fe,ke,Pe,Ke,xt,nn){for(var rn=xt+(-2&nn)*Y;xt!=rn;)H(oe[ve+0],De[Fe+0],ke[Pe+0],Ke,xt),H(oe[ve+1],De[Fe+0],ke[Pe+0],Ke,xt+Y),ve+=2,++Fe,++Pe,xt+=2*Y;1&nn&&H(oe[ve+0],De[Fe+0],ke[Pe+0],Ke,xt)}}function JM(F,H,Y){return 0==Y?0==F?0==H?6:5:0==H?4:0:Y}function OS(F,H,Y,oe,ve){switch(F>>>30){case 3:fC(H,Y,oe,ve,0);break;case 2:VS(H,Y,oe,ve);break;case 1:Mg(H,Y,oe,ve)}}function kS(F,H){var Y,oe,ve=H.M,De=H.Nb,Fe=F.oc,ke=F.pc+40,Pe=F.oc,Ke=F.pc+584,xt=F.oc,nn=F.pc+600;for(Y=0;16>Y;++Y)Fe[ke+32*Y-1]=129;for(Y=0;8>Y;++Y)Pe[Ke+32*Y-1]=129,xt[nn+32*Y-1]=129;for(0<ve?Fe[ke-1-32]=Pe[Ke-1-32]=xt[nn-1-32]=129:(s(Fe,ke-32-1,127,21),s(Pe,Ke-32-1,127,9),s(xt,nn-32-1,127,9)),oe=0;oe<F.za;++oe){var rn=H.ya[H.aa+oe];if(0<oe){for(Y=-1;16>Y;++Y)i(Fe,ke+32*Y-4,Fe,ke+32*Y+12,4);for(Y=-1;8>Y;++Y)i(Pe,Ke+32*Y-4,Pe,Ke+32*Y+4,4),i(xt,nn+32*Y-4,xt,nn+32*Y+4,4)}var Lt=F.Gd,Yn=F.Hd+oe,Sn=rn.ad,Et=rn.Hc;if(0<ve&&(i(Fe,ke-32,Lt[Yn].y,0,16),i(Pe,Ke-32,Lt[Yn].f,0,8),i(xt,nn-32,Lt[Yn].ea,0,8)),rn.Za){var Ft=Fe,qn=ke-32+16;for(0<ve&&(oe>=F.za-1?s(Ft,qn,Lt[Yn].y[15],4):i(Ft,qn,Lt[Yn+1].y,0,4)),Y=0;4>Y;Y++)Ft[qn+128+Y]=Ft[qn+256+Y]=Ft[qn+384+Y]=Ft[qn+0+Y];for(Y=0;16>Y;++Y,Et<<=2)Fg[rn.Ob[Y]](Ft=Fe,qn=ke+Tj[Y]),OS(Et,Sn,16*+Y,Ft,qn)}else if(Ft=JM(oe,ve,rn.Ob[0]),lv[Ft](Fe,ke),0!=Et)for(Y=0;16>Y;++Y,Et<<=2)OS(Et,Sn,16*+Y,Fe,ke+Tj[Y]);for(Y=rn.Gc,Ft=JM(oe,ve,rn.Dd),S0[Ft](Pe,Ke),S0[Ft](xt,nn),Et=Sn,Ft=Pe,qn=Ke,255&(rn=Y>>0)&&(170&rn?sv(Et,256,Ft,qn):x0(Et,256,Ft,qn)),rn=xt,Et=nn,255&(Y>>=8)&&(170&Y?sv(Sn,320,rn,Et):x0(Sn,320,rn,Et)),ve<F.Ub-1&&(i(Lt[Yn].y,0,Fe,ke+480,16),i(Lt[Yn].f,0,Pe,Ke+224,8),i(Lt[Yn].ea,0,xt,nn+224,8)),Lt=F.sa,Yn=F.ta+16*oe+16*De*F.R,Sn=F.qa,rn=F.ra+8*oe+(Y=8*De*F.B),Et=F.Ha,Ft=F.Ia+8*oe+Y,Y=0;16>Y;++Y)i(Lt,Yn+Y*F.R,Fe,ke+32*Y,16);for(Y=0;8>Y;++Y)i(Sn,rn+Y*F.B,Pe,Ke+32*Y,8),i(Et,Ft+Y*F.B,xt,nn+32*Y,8)}}function aC(F,H,Y,oe,ve,De,Fe,ke,Pe){var Ke=[0],xt=[0],nn=0,rn=null!=Pe?Pe.kd:0,Lt=Pe??new BS;if(null==F||12>Y)return 7;Lt.data=F,Lt.w=H,Lt.ha=Y,H=[H],Y=[Y],Lt.gb=[Lt.gb];e:{var Yn=H,Sn=Y,Et=Lt.gb;if(n(null!=F),n(null!=Sn),n(null!=Et),Et[0]=0,12<=Sn[0]&&!e(F,Yn[0],"RIFF")){if(e(F,Yn[0]+8,"WEBP")){Et=3;break e}var Ft=Ji(F,Yn[0]+4);if(12>Ft||4294967286<Ft){Et=3;break e}if(rn&&Ft>Sn[0]-8){Et=7;break e}Et[0]=Ft,Yn[0]+=12,Sn[0]-=12}Et=0}if(0!=Et)return Et;for(Ft=0<Lt.gb[0],Y=Y[0];;){e:{var qn=F;Sn=H,Et=Y;var si=Ke,Wn=xt,sr=Yn=[0];if((Gi=nn=[nn])[0]=0,8>Et[0])Et=7;else{if(!e(qn,Sn[0],"VP8X")){if(10!=Ji(qn,Sn[0]+4)){Et=3;break e}if(18>Et[0]){Et=7;break e}var Ui=Ji(qn,Sn[0]+8),ts=1+Yi(qn,Sn[0]+12);if(2147483648<=ts*(qn=1+Yi(qn,Sn[0]+15))){Et=3;break e}null!=sr&&(sr[0]=Ui),null!=si&&(si[0]=ts),null!=Wn&&(Wn[0]=qn),Sn[0]+=18,Et[0]-=18,Gi[0]=1}Et=0}}if(nn=nn[0],0!=Et)return Et;if(Sn=!!(2&(Yn=Yn[0])),!Ft&&nn)return 3;if(null!=De&&(De[0]=!!(16&Yn)),null!=Fe&&(Fe[0]=Sn),null!=ke&&(ke[0]=0),Fe=Ke[0],Yn=xt[0],nn&&Sn&&null==Pe){Et=0;break}if(4>Y){Et=7;break}if(Ft&&nn||!Ft&&!nn&&!e(F,H[0],"ALPH")){Y=[Y],Lt.na=[Lt.na],Lt.P=[Lt.P],Lt.Sa=[Lt.Sa];e:{Et=H,Ft=Y;var Gi=Lt.gb;si=Lt.na,Wn=Lt.P,sr=Lt.Sa,ts=22,n(null!=(Ui=F)),n(null!=Ft),qn=Et[0];var la=Ft[0];for(n(null!=si),n(null!=sr),si[0]=null,Wn[0]=null,sr[0]=0;;){if(Et[0]=qn,Ft[0]=la,8>la){Et=7;break e}var Ca=Ji(Ui,qn+4);if(4294967286<Ca){Et=3;break e}var Yo=8+Ca+1&-2;if(ts+=Yo,0<Gi&&ts>Gi){Et=3;break e}if(!e(Ui,qn,"VP8 ")||!e(Ui,qn,"VP8L")){Et=0;break e}if(la[0]<Yo){Et=7;break e}e(Ui,qn,"ALPH")||(si[0]=Ui,Wn[0]=qn+8,sr[0]=Ca),qn+=Yo,la-=Yo}}if(Y=Y[0],Lt.na=Lt.na[0],Lt.P=Lt.P[0],Lt.Sa=Lt.Sa[0],0!=Et)break}Y=[Y],Lt.Ja=[Lt.Ja],Lt.xa=[Lt.xa];e:if(Gi=F,Et=H,Ft=Y,si=Lt.gb[0],Wn=Lt.Ja,sr=Lt.xa,Ui=Et[0],qn=!e(Gi,Ui,"VP8 "),ts=!e(Gi,Ui,"VP8L"),n(null!=Gi),n(null!=Ft),n(null!=Wn),n(null!=sr),8>Ft[0])Et=7;else{if(qn||ts){if(Gi=Ji(Gi,Ui+4),12<=si&&Gi>si-12){Et=3;break e}if(rn&&Gi>Ft[0]-8){Et=7;break e}Wn[0]=Gi,Et[0]+=8,Ft[0]-=8,sr[0]=ts}else sr[0]=5<=Ft[0]&&47==Gi[Ui+0]&&!(Gi[Ui+4]>>5),Wn[0]=Ft[0];Et=0}if(Y=Y[0],Lt.Ja=Lt.Ja[0],Lt.xa=Lt.xa[0],H=H[0],0!=Et)break;if(4294967286<Lt.Ja)return 3;if(null==ke||Sn||(ke[0]=Lt.xa?2:1),Fe=[Fe],Yn=[Yn],Lt.xa){if(5>Y){Et=7;break}ke=Fe,rn=Yn,Sn=De,null==F||5>Y?F=0:5<=Y&&47==F[H+0]&&!(F[H+4]>>5)?(Ft=[0],Gi=[0],si=[0],wt(Wn=new Se,F,H,Y),As(Wn,Ft,Gi,si)?(null!=ke&&(ke[0]=Ft[0]),null!=rn&&(rn[0]=Gi[0]),null!=Sn&&(Sn[0]=si[0]),F=1):F=0):F=0}else{if(10>Y){Et=7;break}ke=Yn,null==F||10>Y||!NM(F,H+3,Y-3)?F=0:(rn=F[H+0]|F[H+1]<<8|F[H+2]<<16,Sn=16383&(F[H+7]<<8|F[H+6]),F=16383&(F[H+9]<<8|F[H+8]),1&rn||3<(rn>>1&7)||!(rn>>4&1)||rn>>5>=Lt.Ja||!Sn||!F?F=0:(Fe&&(Fe[0]=Sn),ke&&(ke[0]=F),F=1))}if(!F||(Fe=Fe[0],Yn=Yn[0],nn&&(Ke[0]!=Fe||xt[0]!=Yn)))return 3;null!=Pe&&(Pe[0]=Lt,Pe.offset=H-Pe.w,n(4294967286>H-Pe.w),n(Pe.offset==Pe.ha-Y));break}return 0==Et||7==Et&&nn&&null==Pe?(null!=De&&(De[0]|=null!=Lt.na&&0<Lt.na.length),null!=oe&&(oe[0]=Fe),null!=ve&&(ve[0]=Yn),0):Et}function PS(F,H,Y){var oe=H.width,ve=H.height,De=0,Fe=0,ke=oe,Pe=ve;if(H.Da=null!=F&&0<F.Da,H.Da&&(ke=F.cd,Pe=F.bd,De=F.v,Fe=F.j,11>Y||(De&=-2,Fe&=-2),0>De||0>Fe||0>=ke||0>=Pe||De+ke>oe||Fe+Pe>ve))return 0;if(H.v=De,H.j=Fe,H.va=De+ke,H.o=Fe+Pe,H.U=ke,H.T=Pe,H.da=null!=F&&0<F.da,H.da){if(!Rs(ke,Pe,Y=[F.ib],De=[F.hb]))return 0;H.ib=Y[0],H.hb=De[0]}return H.ob=null!=F&&F.ob,H.Kb=null==F||!F.Sd,H.da&&(H.ob=H.ib<3*oe/4&&H.hb<3*ve/4,H.Kb=0),1}function NS(F){if(null==F)return 2;if(11>F.S){var H=F.f.RGBA;H.fb+=(F.height-1)*H.A,H.A=-H.A}else(H=F.f.kb).O+=((F=F.height)-1)*H.fa,H.fa=-H.fa,H.N+=(F-1>>1)*H.Ab,H.Ab=-H.Ab,H.W+=(F-1>>1)*H.Db,H.Db=-H.Db,null!=H.F&&(H.J+=(F-1)*H.lb,H.lb=-H.lb);return 0}function lC(F,H,Y,oe){if(null==oe||0>=F||0>=H)return 2;if(null!=Y){if(Y.Da){var ve=Y.cd,De=Y.bd,Fe=-2&Y.v,ke=-2&Y.j;if(0>Fe||0>ke||0>=ve||0>=De||Fe+ve>F||ke+De>H)return 2;F=ve,H=De}if(Y.da){if(!Rs(F,H,ve=[Y.ib],De=[Y.hb]))return 2;F=ve[0],H=De[0]}}oe.width=F,oe.height=H;e:{var Pe=oe.width,Ke=oe.height;if(F=oe.S,0>=Pe||0>=Ke||!(F>=iF&&13>F))F=2;else{if(0>=oe.Rd&&null==oe.sd){Fe=De=ve=H=0;var xt=(ke=Pe*Ij[F])*Ke;if(11>F||(De=(Ke+1)/2*(H=(Pe+1)/2),12==F&&(Fe=(ve=Pe)*Ke)),null==(Ke=l(xt+2*De+Fe))){F=1;break e}oe.sd=Ke,11>F?((Pe=oe.f.RGBA).eb=Ke,Pe.fb=0,Pe.A=ke,Pe.size=xt):((Pe=oe.f.kb).y=Ke,Pe.O=0,Pe.fa=ke,Pe.Fd=xt,Pe.f=Ke,Pe.N=0+xt,Pe.Ab=H,Pe.Cd=De,Pe.ea=Ke,Pe.W=0+xt+De,Pe.Db=H,Pe.Ed=De,12==F&&(Pe.F=Ke,Pe.J=0+xt+2*De),Pe.Tc=Fe,Pe.lb=ve)}if(H=1,De=oe.width,Fe=oe.height,(ve=oe.S)>=iF&&13>ve)if(11>ve)F=oe.f.RGBA,H&=(ke=Math.abs(F.A))*(Fe-1)+De<=F.size,H&=ke>=De*Ij[ve],H&=null!=F.eb;else{F=oe.f.kb,ke=(De+1)/2,xt=(Fe+1)/2,Pe=Math.abs(F.fa),Ke=Math.abs(F.Ab);var nn=Math.abs(F.Db),rn=Math.abs(F.lb);H&=Pe*(Fe-1)+De<=F.Fd,H&=Ke*(xt-1)+ke<=F.Cd,H=(H&=nn*(xt-1)+ke<=F.Ed)&Pe>=De&Ke>=ke&nn>=ke,H&=null!=F.y,H&=null!=F.f,H&=null!=F.ea,12==ve&&(H&=rn>=De,H&=rn*(Fe-1)+De<=F.Tc,H&=null!=F.F)}else H=0;F=H?0:2}}return 0!=F||null!=Y&&Y.fd&&(F=NS(oe)),F}var wf=64,cC=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],uC=24,hC=32,LS=8,xf=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ii("Predictor0","PredictorAdd0"),Ye.Predictor0=function(){return 4278190080},Ye.Predictor1=function(F){return F},Ye.Predictor2=function(F,H,Y){return H[Y+0]},Ye.Predictor3=function(F,H,Y){return H[Y+1]},Ye.Predictor4=function(F,H,Y){return H[Y-1]},Ye.Predictor5=function(F,H,Y){return Vi(Vi(F,H[Y+1]),H[Y+0])},Ye.Predictor6=function(F,H,Y){return Vi(F,H[Y-1])},Ye.Predictor7=function(F,H,Y){return Vi(F,H[Y+0])},Ye.Predictor8=function(F,H,Y){return Vi(H[Y-1],H[Y+0])},Ye.Predictor9=function(F,H,Y){return Vi(H[Y+0],H[Y+1])},Ye.Predictor10=function(F,H,Y){return Vi(Vi(F,H[Y-1]),Vi(H[Y+0],H[Y+1]))},Ye.Predictor11=function(F,H,Y){var oe=H[Y+0];return 0>=zs(oe>>24&255,F>>24&255,(H=H[Y-1])>>24&255)+zs(oe>>16&255,F>>16&255,H>>16&255)+zs(oe>>8&255,F>>8&255,H>>8&255)+zs(255&oe,255&F,255&H)?oe:F},Ye.Predictor12=function(F,H,Y){var oe=H[Y+0];return(Rr((F>>24&255)+(oe>>24&255)-((H=H[Y-1])>>24&255))<<24|Rr((F>>16&255)+(oe>>16&255)-(H>>16&255))<<16|Rr((F>>8&255)+(oe>>8&255)-(H>>8&255))<<8|Rr((255&F)+(255&oe)-(255&H)))>>>0},Ye.Predictor13=function(F,H,Y){var oe=H[Y-1];return(xs((F=Vi(F,H[Y+0]))>>24&255,oe>>24&255)<<24|xs(F>>16&255,oe>>16&255)<<16|xs(F>>8&255,oe>>8&255)<<8|xs(F>>0&255,oe>>0&255))>>>0};var EN=Ye.PredictorAdd0;Ye.PredictorAdd1=io,Ii("Predictor2","PredictorAdd2"),Ii("Predictor3","PredictorAdd3"),Ii("Predictor4","PredictorAdd4"),Ii("Predictor5","PredictorAdd5"),Ii("Predictor6","PredictorAdd6"),Ii("Predictor7","PredictorAdd7"),Ii("Predictor8","PredictorAdd8"),Ii("Predictor9","PredictorAdd9"),Ii("Predictor10","PredictorAdd10"),Ii("Predictor11","PredictorAdd11"),Ii("Predictor12","PredictorAdd12"),Ii("Predictor13","PredictorAdd13");var US=Ye.PredictorAdd2;yo("ColorIndexInverseTransform","MapARGB","32b",function(F){return F>>8&255},function(F){return F}),yo("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(F){return F},function(F){return F>>8&255});var eF,Ig=Ye.ColorIndexInverseTransform,zS=Ye.MapARGB,SN=Ye.VP8LColorIndexInverseTransformAlpha,TN=Ye.MapAlpha,iv=Ye.VP8LPredictorsAdd=[];iv.length=16,(Ye.VP8LPredictors=[]).length=16,(Ye.VP8LPredictorsAdd_C=[]).length=16,(Ye.VP8LPredictors_C=[]).length=16;var hp,Dg,rv,Ym,w0,dC,Bg,fC,VS,sv,Mg,x0,fb,AC,Ab,ov,HS,dp,C0,ol,al,Fc,xu,E0,av,pC,tF,uj,hj=l(511),dj=l(2041),fj=l(225),Aj=l(767),pj=0,IN=dj,nF=fj,wA=Aj,fp=hj,iF=0,rF=1,gj=2,sF=3,oF=4,DN=5,mj=6,BN=7,MN=8,aF=9,FN=10,gue=[2,3,7],mue=[3,3,11],_j=[280,256,256,256,40],_ue=[0,1,1,1,0],yue=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],vue=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],bue=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],wue=8,RN=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ON=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],QS=null,xue=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Cue=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],yj=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Eue=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Sue=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Tue=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Iue=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],lv=[],Fg=[],S0=[],Due=1,vj=2,cv=[],Ap=[];Dn("UpsampleRgbLinePair",Go,3),Dn("UpsampleBgrLinePair",Jl,3),Dn("UpsampleRgbaLinePair",Tg,4),Dn("UpsampleBgraLinePair",Ku,4),Dn("UpsampleArgbLinePair",sd,4),Dn("UpsampleRgba4444LinePair",tu,2),Dn("UpsampleRgb565LinePair",uc,2);var Bue=Ye.UpsampleRgbLinePair,Mue=Ye.UpsampleBgrLinePair,bj=Ye.UpsampleRgbaLinePair,wj=Ye.UpsampleBgraLinePair,xj=Ye.UpsampleArgbLinePair,Cj=Ye.UpsampleRgba4444LinePair,Fue=Ye.UpsampleRgb565LinePair,lF=16,cF=1<<lF-1,jS=-227,kN=482,Ej=6,Rue=(256<<Ej)-1,Sj=0,Oue=l(256),kue=l(256),Pue=l(256),Nue=l(256),Lue=l(kN-jS),Uue=l(kN-jS);b0("YuvToRgbRow",Go,3),b0("YuvToBgrRow",Jl,3),b0("YuvToRgbaRow",Tg,4),b0("YuvToBgraRow",Ku,4),b0("YuvToArgbRow",sd,4),b0("YuvToRgba4444Row",tu,2),b0("YuvToRgb565Row",uc,2);var Tj=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],uF=[0,2,8],zue=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(F,H,Y,oe,ve){var De=rF,Fe=new sC,ke=new vg;Fe.ba=ke,ke.S=De,ke.width=[ke.width],ke.height=[ke.height];var Pe=ke.width,Ke=ke.height,xt=new m0;if(null==xt||null==F)var nn=2;else n(null!=xt),nn=aC(F,H,Y,xt.width,xt.height,xt.Pd,xt.Qd,xt.format,null);if(0!=nn?Pe=0:(null!=Pe&&(Pe[0]=xt.width[0]),null!=Ke&&(Ke[0]=xt.height[0]),Pe=1),Pe){ke.width=ke.width[0],ke.height=ke.height[0],null!=oe&&(oe[0]=ke.width),null!=ve&&(ve[0]=ke.height);e:{if(oe=new Yx,(ve=new BS).data=F,ve.w=H,ve.ha=Y,ve.kd=1,H=[0],n(null!=ve),(0==(F=aC(ve.data,ve.w,ve.ha,null,null,null,H,null,ve))||7==F)&&H[0]&&(F=4),0==(H=F)){if(n(null!=Fe),oe.data=ve.data,oe.w=ve.w+ve.offset,oe.ha=ve.ha-ve.offset,oe.put=$m,oe.ac=Sh,oe.bc=qm,oe.ma=Fe,ve.xa){if(null==(F=up())){Fe=1;break e}if(function(rn,Lt){var Yn=[0],Sn=[0],Et=[0];t:for(;;){if(null==rn)return 0;if(null==Lt)return rn.a=2,0;if(rn.l=Lt,rn.a=0,wt(rn.m,Lt.data,Lt.w,Lt.ha),!As(rn.m,Yn,Sn,Et)){rn.a=3;break t}if(rn.xb=vj,Lt.width=Yn[0],Lt.height=Sn[0],!Zm(Yn[0],Sn[0],1,rn,null))break t;return 1}return n(0!=rn.a),0}(F,oe)){if(oe=0==(H=lC(oe.width,oe.height,Fe.Oa,Fe.ba))){t:{oe=F;n:for(;;){if(null==oe){oe=0;break t}if(n(null!=oe.s.yc),n(null!=oe.s.Ya),n(0<oe.s.Wb),n(null!=(Y=oe.l)),n(null!=(ve=Y.ma)),0!=oe.xb){if(oe.ca=ve.ba,oe.tb=ve.tb,n(null!=oe.ca),!PS(ve.Oa,Y,sF)){oe.a=2;break n}if(!lb(oe,Y.width)||Y.da)break n;if((Y.da||_a(oe.ca.S))&&qt(),11>oe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=oe.ca.f.kb.F&&qt()),oe.Pb&&0<oe.s.ua&&null==oe.s.vb.X&&!ss(oe.s.vb,oe.s.Wa.Xa)){oe.a=1;break n}oe.xb=0}if(!Cg(oe,oe.V,oe.Ba,oe.c,oe.i,Y.o,$x))break n;ve.Dc=oe.Ma,oe=1;break t}n(0!=oe.a),oe=0}oe=!oe}oe&&(H=F.a)}else H=F.a}else{if(null==(F=new oN)){Fe=1;break e}if(F.Fa=ve.na,F.P=ve.P,F.qc=ve.Sa,LM(F,oe)){if(0==(H=lC(oe.width,oe.height,Fe.Oa,Fe.ba))){if(F.Aa=0,Y=Fe.Oa,n(null!=(ve=F)),null!=Y){if(0<(Pe=0>(Pe=Y.Md)?0:100<Pe?255:255*Pe/100)){for(Ke=xt=0;4>Ke;++Ke)12>(nn=ve.pb[Ke]).lc&&(nn.ia=Pe*zue[0>nn.lc?0:nn.lc]>>3),xt|=nn.ia;xt&&(alert("todo:VP8InitRandom"),ve.ia=1)}ve.Ga=Y.Id,100<ve.Ga?ve.Ga=100:0>ve.Ga&&(ve.Ga=0)}(function aN(F,H){if(null==F)return 0;if(null==H)return Mc(F,2,"NULL VP8Io parameter in VP8Decode().");if(!F.cb&&!LM(F,H))return 0;if(n(F.cb),null==H.ac||H.ac(H)){H.ob&&(F.L=0);var Y=uF[F.L];if(2==F.L?(F.yb=0,F.zb=0):(F.yb=H.v-Y>>4,F.zb=H.j-Y>>4,0>F.yb&&(F.yb=0),0>F.zb&&(F.zb=0)),F.Va=H.o+15+Y>>4,F.Hb=H.va+15+Y>>4,F.Hb>F.za&&(F.Hb=F.za),F.Va>F.Ub&&(F.Va=F.Ub),0<F.L){var oe=F.ed;for(Y=0;4>Y;++Y){var ve;if(F.Qa.Cb){var De=F.Qa.Lb[Y];F.Qa.Fb||(De+=oe.Tb)}else De=oe.Tb;for(ve=0;1>=ve;++ve){var Fe=F.gd[Y][ve],ke=De;if(oe.Pc&&(ke+=oe.vd[0],ve&&(ke+=oe.od[0])),0<(ke=0>ke?0:63<ke?63:ke)){var Pe=ke;0<oe.wb&&(Pe=4<oe.wb?Pe>>2:Pe>>1)>9-oe.wb&&(Pe=9-oe.wb),1>Pe&&(Pe=1),Fe.dd=Pe,Fe.tc=2*ke+Pe,Fe.ld=40<=ke?2:15<=ke?1:0}else Fe.tc=0;Fe.La=ve}}}Y=0}else Mc(F,6,"Frame setup failed"),Y=F.a;if(Y=0==Y){if(Y){F.$c=0,0<F.Aa||(F.Ic=1);e:{oe=4*(Pe=F.za);var Ke=32*Pe,xt=Pe+1,nn=0<F.L?Pe*(0<F.Aa?2:1):0,rn=(2==F.Aa?2:1)*Pe;if((Fe=oe+832+(ve=3*(16*(Y=F.Ic)+uF[F.L])/2*Ke)+(De=null!=F.Fa&&0<F.Fa.length?F.Kc.c*F.Kc.i:0))!=Fe)Y=0;else{if(Fe>F.Vb){if(F.Vb=0,F.Ec=l(Fe),F.Fc=0,null==F.Ec){Y=Mc(F,1,"no memory during frame initialization.");break e}F.Vb=Fe}ke=F.Fc,F.Ac=Fe=F.Ec,F.Bc=ke,ke+=oe,F.Gd=h(Ke,PM),F.Hd=0,F.rb=h(xt+1,kM),F.sb=1,F.wa=nn?h(nn,Xx):null,F.Y=0,F.D.Nb=0,F.D.wa=F.wa,F.D.Y=F.Y,0<F.Aa&&(F.D.Y+=Pe),n(!0),F.oc=Fe,F.pc=ke,ke+=832,F.ya=h(rn,vS),F.aa=0,F.D.ya=F.ya,F.D.aa=F.aa,2==F.Aa&&(F.D.aa+=Pe),F.R=16*Pe,F.B=8*Pe,Pe=(Ke=uF[F.L])*F.R,Ke=Ke/2*F.B,F.sa=Fe,F.ta=ke+Pe,F.qa=F.sa,F.ra=F.ta+16*Y*F.R+Ke,F.Ha=F.qa,F.Ia=F.ra+8*Y*F.B+Ke,F.$c=0,ke+=ve,F.mb=De?Fe:null,F.nb=De?ke:null,n(ke+De<=F.Fc+F.Vb),bS(F),s(F.Ac,F.Bc,0,oe),Y=1}}if(Y){if(H.ka=0,H.y=F.sa,H.O=F.ta,H.f=F.qa,H.N=F.ra,H.ea=F.Ha,H.Vd=F.Ia,H.fa=F.R,H.Rc=F.B,H.F=null,H.J=0,!pj){for(Y=-255;255>=Y;++Y)hj[255+Y]=0>Y?-Y:Y;for(Y=-1020;1020>=Y;++Y)dj[1020+Y]=-128>Y?-128:127<Y?127:Y;for(Y=-112;112>=Y;++Y)fj[112+Y]=-16>Y?-16:15<Y?15:Y;for(Y=-255;510>=Y;++Y)Aj[255+Y]=0>Y?0:255<Y?255:Y;pj=1}Bg=uN,fC=lN,sv=VM,Mg=cN,x0=HM,VS=zM,fb=TS,AC=hb,Ab=xN,ov=IS,HS=wN,dp=rC,C0=DS,ol=XM,al=ZM,Fc=v0,xu=ev,E0=bN,Fg[0]=Xm,Fg[1]=hN,Fg[2]=pN,Fg[3]=gN,Fg[4]=GM,Fg[5]=nC,Fg[6]=$M,Fg[7]=CS,Fg[8]=_N,Fg[9]=mN,lv[0]=QM,lv[1]=fN,lv[2]=y0,lv[3]=eC,lv[4]=rd,lv[5]=AN,lv[6]=jM,S0[0]=Jy,S0[1]=dN,S0[2]=yN,S0[3]=ES,S0[4]=ub,S0[5]=vN,S0[6]=SS,Y=1}else Y=0}Y&&(Y=function(Lt,Yn){for(Lt.M=0;Lt.M<Lt.Va;++Lt.M){var Sn,Et=Lt.Jc[Lt.M&Lt.Xb],Ft=Lt.m,qn=Lt;for(Sn=0;Sn<qn.za;++Sn){var si=Ft,Wn=qn,sr=Wn.Ac,Ui=Wn.Bc+4*Sn,ts=Wn.zc,Gi=Wn.ya[Wn.aa+Sn];if(Gi.$b=Wn.Qa.Bb?sn(si,Wn.Pa.jb[0])?2+sn(si,Wn.Pa.jb[2]):sn(si,Wn.Pa.jb[1]):0,Wn.kc&&(Gi.Ad=sn(si,Wn.Bd)),Gi.Za=!sn(si,145)+0,Gi.Za){var la=Gi.Ob,Ca=0;for(Wn=0;4>Wn;++Wn){var Yo,Bo=ts[0+Wn];for(Yo=0;4>Yo;++Yo){for(var Ka=yj[sn(si,(Bo=Sue[sr[Ui+Yo]][Bo])[0])];0<Ka;)Ka=yj[2*Ka+sn(si,Bo[Ka])];sr[Ui+Yo]=Bo=-Ka}i(la,Ca,sr,Ui,4),Ca+=4,ts[0+Wn]=Bo}}else Bo=sn(si,156)?sn(si,128)?1:3:sn(si,163)?2:0,Gi.Ob[0]=Bo,s(sr,Ui,Bo,4),s(ts,0,Bo,4);Gi.Dd=sn(si,142)?sn(si,114)?sn(si,183)?1:3:2:0}if(qn.m.Ka)return Mc(Lt,7,"Premature end-of-partition0 encountered.");for(;Lt.ja<Lt.za;++Lt.ja){if(qn=Et,si=(Ft=Lt).rb[Ft.sb-1],sr=Ft.rb[Ft.sb+Ft.ja],Sn=Ft.ya[Ft.aa+Ft.ja],Ui=Ft.kc?Sn.Ad:0)si.la=sr.la=0,Sn.Za||(si.Na=sr.Na=0),Sn.Hc=0,Sn.Gc=0,Sn.ia=0;else{var Fa,Ws;if(si=sr,sr=qn,Ui=Ft.Pa.Xc,Gi=Ft.pb[(ts=Ft.ya[Ft.aa+Ft.ja]).$b],Ca=Ft.rb[Ft.sb-1],Bo=Yo=0,s(Wn=ts.ad,la=0,0,384),ts.Za)var nu=0,Cf=Ui[3];else{Ka=l(16);var iu=si.Na+Ca.Na;if(iu=QS(sr,Ui[1],iu,Gi.Eb,0,Ka,0),si.Na=Ca.Na=(0<iu)+0,1<iu)Bg(Ka,0,Wn,la);else{var Ef=Ka[0]+3>>3;for(Ka=0;256>Ka;Ka+=16)Wn[la+Ka]=Ef}nu=1,Cf=Ui[0]}var Ea=15&si.la,xA=15&Ca.la;for(Ka=0;4>Ka;++Ka){var CA=1&xA;for(Ef=Ws=0;4>Ef;++Ef)Ea=Ea>>1|(CA=(iu=QS(sr,Cf,iu=CA+(1&Ea),Gi.Sc,nu,Wn,la))>nu)<<7,Ws=Ws<<2|(3<iu?3:1<iu?2:0!=Wn[la+0]),la+=16;Ea>>=4,xA=xA>>1|CA<<7,Yo=(Yo<<8|Ws)>>>0}for(Cf=Ea,nu=xA>>4,Fa=0;4>Fa;Fa+=2){for(Ws=0,Ea=si.la>>4+Fa,xA=Ca.la>>4+Fa,Ka=0;2>Ka;++Ka){for(CA=1&xA,Ef=0;2>Ef;++Ef)Ea=Ea>>1|(CA=0<(iu=QS(sr,Ui[2],iu=CA+(1&Ea),Gi.Qc,0,Wn,la)))<<3,Ws=Ws<<2|(3<iu?3:1<iu?2:0!=Wn[la+0]),la+=16;Ea>>=2,xA=xA>>1|CA<<5}Bo|=Ws<<4*Fa,Cf|=Ea<<4<<Fa,nu|=(240&xA)<<Fa}si.la=Cf,Ca.la=nu,ts.Hc=Yo,ts.Gc=Bo,ts.ia=43690&Bo?0:Gi.ia,Ui=!(Yo|Bo)}if(0<Ft.L&&(Ft.wa[Ft.Y+Ft.ja]=Ft.gd[Sn.$b][Sn.Za],Ft.wa[Ft.Y+Ft.ja].La|=!Ui),qn.Ka)return Mc(Lt,7,"Premature end-of-file encountered.")}if(bS(Lt),Ft=Yn,qn=1,Sn=(Et=Lt).D,si=0<Et.L&&Et.M>=Et.zb&&Et.M<=Et.Va,0==Et.Aa)e:{if(Sn.M=Et.M,Sn.uc=si,kS(Et,Sn),qn=1,Sn=(Ws=Et.D).Nb,si=(Bo=uF[Et.L])*Et.R,Ui=Et.sa,ts=Et.ta-si+(Ka=16*Sn*Et.R),Gi=Et.qa,Wn=Et.ra-(sr=Bo/2*Et.B)+(Ef=8*Sn*Et.B),la=Et.Ha,Ca=Et.Ia-sr+Ef,xA=0==(Ea=Ws.M),Yo=Ea>=Et.Va-1,2==Et.Aa&&kS(Et,Ws),Ws.uc)for(CA=(iu=Et).D.M,n(iu.D.uc),Ws=iu.yb;Ws<iu.Hb;++Ws){Cf=CA;var Wu=(Th=(hc=iu).D).Nb,Th=Th.wa[Th.Y+(nu=Ws)],Rd=hc.sa,pp=hc.ta+16*Wu*(Fa=hc.R)+16*nu,Jm=Th.dd,Zu=Th.tc;if(0!=Zu)if(n(3<=Zu),1==hc.L)0<nu&&Fc(Rd,pp,Fa,Zu+4),Th.La&&E0(Rd,pp,Fa,Zu),0<Cf&&al(Rd,pp,Fa,Zu+4),Th.La&&xu(Rd,pp,Fa,Zu);else{var T0=hc.B,pb=hc.qa,gC=hc.ra+8*Wu*T0+8*nu,uv=hc.Ha,hc=hc.Ia+8*Wu*T0+8*nu;Wu=Th.ld,0<nu&&(AC(Rd,pp,Fa,Zu+4,Jm,Wu),ov(pb,gC,uv,hc,T0,Zu+4,Jm,Wu)),Th.La&&(dp(Rd,pp,Fa,Zu,Jm,Wu),ol(pb,gC,uv,hc,T0,Zu,Jm,Wu)),0<Cf&&(fb(Rd,pp,Fa,Zu+4,Jm,Wu),Ab(pb,gC,uv,hc,T0,Zu+4,Jm,Wu)),Th.La&&(HS(Rd,pp,Fa,Zu,Jm,Wu),C0(pb,gC,uv,hc,T0,Zu,Jm,Wu))}}if(Et.ia&&alert("todo:DitherRow"),null!=Ft.put){if(Ws=16*Ea,Ea=16*(Ea+1),xA?(Ft.y=Et.sa,Ft.O=Et.ta+Ka,Ft.f=Et.qa,Ft.N=Et.ra+Ef,Ft.ea=Et.Ha,Ft.W=Et.Ia+Ef):(Ws-=Bo,Ft.y=Ui,Ft.O=ts,Ft.f=Gi,Ft.N=Wn,Ft.ea=la,Ft.W=Ca),Yo||(Ea-=Bo),Ea>Ft.o&&(Ea=Ft.o),Ft.F=null,Ft.J=null,null!=Et.Fa&&0<Et.Fa.length&&Ws<Ea&&(Ft.J=RS(Et,Ft,Ws,Ea-Ws),Ft.F=Et.mb,null==Ft.F&&0==Ft.F.length)){qn=Mc(Et,3,"Could not decode alpha data.");break e}Ws<Ft.j&&(Bo=Ft.j-Ws,Ws=Ft.j,n(!(1&Bo)),Ft.O+=Et.R*Bo,Ft.N+=Et.B*(Bo>>1),Ft.W+=Et.B*(Bo>>1),null!=Ft.F&&(Ft.J+=Ft.width*Bo)),Ws<Ea&&(Ft.O+=Ft.v,Ft.N+=Ft.v>>1,Ft.W+=Ft.v>>1,null!=Ft.F&&(Ft.J+=Ft.v),Ft.ka=Ws-Ft.j,Ft.U=Ft.va-Ft.v,Ft.T=Ea-Ws,qn=Ft.put(Ft))}Sn+1!=Et.Ic||Yo||(i(Et.sa,Et.ta-si,Ui,ts+16*Et.R,si),i(Et.qa,Et.ra-sr,Gi,Wn+8*Et.B,sr),i(Et.Ha,Et.Ia-sr,la,Ca+8*Et.B,sr))}if(!qn)return Mc(Lt,6,"Output aborted.")}return 1}(F,H)),null!=H.bc&&H.bc(H),Y&=1}return Y?(F.cb=0,Y):0})(F,oe)||(H=F.a)}}else H=F.a}0==H&&null!=Fe.Oa&&Fe.Oa.fd&&(H=NS(Fe.ba))}Fe=H}De=0!=Fe?null:11>De?ke.f.RGBA.eb:ke.f.kb.y}else De=null;return De};var Ij=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function E(Ye,un){for(var hn="",Ue=0;Ue<4;Ue++)hn+=String.fromCharCode(Ye[un++]);return hn}function M(Ye,un){return(Ye[un+0]<<0|Ye[un+1]<<8|Ye[un+2]<<16)>>>0}function L(Ye,un){return(Ye[un+0]<<0|Ye[un+1]<<8|Ye[un+2]<<16|Ye[un+3]<<24)>>>0}new b;var G=[0],V=[0],ne=[],re=new b,de=t,fe=function(Ye,un){var hn={},Ue=0,ze=!1,ut=0,lt=0;if(hn.frames=[],!
/** @license
               * Copyright (c) 2017 Dominik Homberger
              Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
              The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
              THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
              https://webpjs.appspot.com
              WebPRiffParser dominikhlbg@gmail.com
              */
function(Xe,Je,_t,Nt){for(var jt=0;jt<4;jt++)if(Xe[Je+jt]!="RIFF".charCodeAt(jt))return!0;return!1}(Ye,un)){var _n,ft;for(L(Ye,un+=4),un+=8;un<Ye.length;){var Ot=E(Ye,un),wt=L(Ye,un+=4);un+=4;var Yt=wt+(1&wt);switch(Ot){case"VP8 ":case"VP8L":void 0===hn.frames[Ue]&&(hn.frames[Ue]={}),(Se=hn.frames[Ue]).src_off=ze?lt:un-8,Se.src_size=ut+wt+8,Ue++,ze&&(ze=!1,ut=0,lt=0);break;case"VP8X":(Se=hn.header={}).feature_flags=Ye[un];var pn=un+4;Se.canvas_width=1+M(Ye,pn),Se.canvas_height=1+M(Ye,pn+=3),pn+=3;break;case"ALPH":ze=!0,ut=Yt+8,lt=un-8;break;case"ANIM":(Se=hn.header).bgcolor=L(Ye,un),Se.loop_count=(_n=Ye)[(ft=pn=un+4)+0]<<0|_n[ft+1]<<8,pn+=2;break;case"ANMF":var Ti,Se;(Se=hn.frames[Ue]={}).offset_x=2*M(Ye,un),Se.offset_y=2*M(Ye,un+=3),Se.width=1+M(Ye,un+=3),Se.height=1+M(Ye,un+=3),Se.duration=M(Ye,un+=3),un+=3,Ti=Ye[un++],Se.dispose=1&Ti,Se.blend=Ti>>1&1}"ANMF"!=Ot&&(un+=Yt)}return hn}}(de,0);fe.response=de,fe.rgbaoutput=!0,fe.dataurl=!1;var he=fe.header?fe.header:null,Ne=fe.frames?fe.frames:null;if(he){he.loop_counter=he.loop_count,G=[he.canvas_height],V=[he.canvas_width];for(var We=0;We<Ne.length&&0!=Ne[We].blend;We++);}var pt=Ne[0],Qt=re.WebPDecodeRGBA(de,pt.src_off,pt.src_size,V,G);pt.rgba=Qt,pt.imgwidth=V[0],pt.imgheight=G[0];for(var yt=0;yt<V[0]*G[0]*4;yt++)ne[yt]=Qt[yt];return this.width=V,this.height=G,this.data=ne,this}(function(t){var e=function(G,V,ne,re){var de=4,fe=h;switch(re){case t.image_compression.FAST:de=1,fe=l;break;case t.image_compression.MEDIUM:de=6,fe=m;break;case t.image_compression.SLOW:de=9,fe=b}var he=dS(G=i(G,V,ne,fe),{level:de});return t.__addimage__.arrayBufferToBinaryString(he)},i=function(G,V,ne,re){for(var de,fe,he,Ne=G.length/V,We=new Uint8Array(G.length+Ne),pt=M(),Qt=0;Qt<Ne;Qt+=1){if(de=G.subarray(he=Qt*V,he+V),re)We.set(re(de,ne,fe),he+Qt);else{for(var yt,Ye=pt.length,un=[];yt<Ye;yt+=1)un[yt]=pt[yt](de,ne,fe);var hn=L(un.concat());We.set(un[hn],he+Qt)}fe=de}return We},s=function(G){var V=Array.apply([],G);return V.unshift(0),V},l=function(G,V){var re=[],de=G.length;re[0]=1;for(var fe=0;fe<de;fe+=1)re[fe+1]=G[fe]-(G[fe-V]||0)+256&255;return re},h=function(G,V,ne){var de=[],fe=G.length;de[0]=2;for(var he=0;he<fe;he+=1)de[he+1]=G[he]-(ne&&ne[he]||0)+256&255;return de},m=function(G,V,ne){var fe=[],he=G.length;fe[0]=3;for(var Ne=0;Ne<he;Ne+=1)fe[Ne+1]=G[Ne]+256-((G[Ne-V]||0)+(ne&&ne[Ne]||0)>>>1)&255;return fe},b=function(G,V,ne){var he,Ne=[],We=G.length;Ne[0]=4;for(var pt=0;pt<We;pt+=1)he=E(G[pt-V]||0,ne&&ne[pt]||0,ne&&ne[pt-V]||0),Ne[pt+1]=G[pt]-he+256&255;return Ne},E=function(G,V,ne){if(G===V&&V===ne)return G;var re=Math.abs(V-ne),de=Math.abs(G-ne),fe=Math.abs(G+V-ne-ne);return re<=de&&re<=fe?G:de<=fe?V:ne},M=function(){return[s,l,h,m,b]},L=function(G){var V=G.map(function(ne){return ne.reduce(function(re,de){return re+Math.abs(de)},0)});return V.indexOf(Math.min.apply(null,V))};t.processPNG=function(G,V,ne,re){var de,fe,he,Ne,We,pt,Qt,yt,Ye,un,hn,Ue,ze,ut,lt,_n=this.decode.FLATE_DECODE,ft="";if(this.__addimage__.isArrayBuffer(G)&&(G=new Uint8Array(G)),this.__addimage__.isArrayBufferView(G)){if(G=(he=new lae(G)).imgData,fe=he.bits,de=he.colorSpace,We=he.colors,-1!==[4,6].indexOf(he.colorType)){if(8===he.bits){Ye=(yt=32==he.pixelBitlength?new Uint32Array(he.decodePixels().buffer):16==he.pixelBitlength?new Uint16Array(he.decodePixels().buffer):new Uint8Array(he.decodePixels().buffer)).length,hn=new Uint8Array(Ye*he.colors),un=new Uint8Array(Ye);var Ot,wt=he.pixelBitlength-he.bits;for(ut=0,lt=0;ut<Ye;ut++){for(ze=yt[ut],Ot=0;Ot<wt;)hn[lt++]=ze>>>Ot&255,Ot+=he.bits;un[ut]=ze>>>Ot&255}}if(16===he.bits){Ye=(yt=new Uint32Array(he.decodePixels().buffer)).length,hn=new Uint8Array(Ye*(32/he.pixelBitlength)*he.colors),un=new Uint8Array(Ye*(32/he.pixelBitlength)),Ue=he.colors>1,ut=0,lt=0;for(var Yt=0;ut<Ye;)ze=yt[ut++],hn[lt++]=ze>>>0&255,Ue&&(hn[lt++]=ze>>>16&255,ze=yt[ut++],hn[lt++]=ze>>>0&255),un[Yt++]=ze>>>16&255;fe=8}re!==t.image_compression.NONE?(G=e(hn,he.width*he.colors,he.colors,re),Qt=e(un,he.width,1,re)):(G=hn,Qt=un,_n=void 0)}if(3===he.colorType&&(de=this.color_spaces.INDEXED,pt=he.palette,he.transparency.indexed)){var pn=he.transparency.indexed,Ti=0;for(ut=0,Ye=pn.length;ut<Ye;++ut)Ti+=pn[ut];if((Ti/=255)==Ye-1&&-1!==pn.indexOf(0))Ne=[pn.indexOf(0)];else if(Ti!==Ye){for(yt=he.decodePixels(),un=new Uint8Array(yt.length),ut=0,Ye=yt.length;ut<Ye;ut++)un[ut]=pn[yt[ut]];Qt=e(un,he.width,1)}}var Se=function(Xe){var Je;switch(Xe){case t.image_compression.FAST:Je=11;break;case t.image_compression.MEDIUM:Je=13;break;case t.image_compression.SLOW:Je=14;break;default:Je=12}return Je}(re);return _n===this.decode.FLATE_DECODE&&(ft="/Predictor "+Se+" "),ft+="/Colors "+We+" /BitsPerComponent "+fe+" /Columns "+he.width,(this.__addimage__.isArrayBuffer(G)||this.__addimage__.isArrayBufferView(G))&&(G=this.__addimage__.arrayBufferToBinaryString(G)),(Qt&&this.__addimage__.isArrayBuffer(Qt)||this.__addimage__.isArrayBufferView(Qt))&&(Qt=this.__addimage__.arrayBufferToBinaryString(Qt)),{alias:ne,data:G,index:V,filter:_n,decodeParameters:ft,transparency:Ne,palette:pt,sMask:Qt,predictor:Se,width:he.width,height:he.height,bitsPerComponent:fe,colorSpace:de}}}})(fs.API),function(t){t.processGIF89A=function(n,e,i,s){var l=new cae(n),h=l.width,m=l.height,b=[];l.decodeAndBlitFrameRGBA(0,b);var E={data:b,width:h,height:m},M=new TP(100).encode(E,100);return t.processJPEG.call(this,M,e,i,s)},t.processGIF87A=t.processGIF89A}(fs.API),gg.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var n=0;n<t;n++){var e=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0);this.palette[n]={red:s,green:i,blue:e,quad:l}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},gg.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP;this.data=new Uint8Array(this.width*this.height*4),this[t]()}catch(e){$a.log("bit decode error:"+e)}},gg.prototype.bit1=function(){var t,n=Math.ceil(this.width/8),e=n%4;for(t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,s=0;s<n;s++)for(var l=this.datav.getUint8(this.pos++,!0),h=i*this.width*4+8*s*4,m=0;m<8&&8*s+m<this.width;m++){var b=this.palette[l>>7-m&1];this.data[h+4*m]=b.blue,this.data[h+4*m+1]=b.green,this.data[h+4*m+2]=b.red,this.data[h+4*m+3]=255}0!==e&&(this.pos+=4-e)}},gg.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),n=t%4,e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,s=0;s<t;s++){var l=this.datav.getUint8(this.pos++,!0),h=i*this.width*4+2*s*4,b=15&l,E=this.palette[l>>4];if(this.data[h]=E.blue,this.data[h+1]=E.green,this.data[h+2]=E.red,this.data[h+3]=255,2*s+1>=this.width)break;this.data[h+4]=(E=this.palette[b]).blue,this.data[h+4+1]=E.green,this.data[h+4+2]=E.red,this.data[h+4+3]=255}0!==n&&(this.pos+=4-n)}},gg.prototype.bit8=function(){for(var t=this.width%4,n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*i;if(s<this.palette.length){var h=this.palette[s];this.data[l]=h.red,this.data[l+1]=h.green,this.data[l+2]=h.blue,this.data[l+3]=255}else this.data[l]=255,this.data[l+1]=255,this.data[l+2]=255,this.data[l+3]=255}0!==t&&(this.pos+=4-t)}},gg.prototype.bit15=function(){for(var t=this.width%3,n=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var i=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var h=(l&n)/n*255|0,m=(l>>5&n)/n*255|0,E=l>>15?255:0,M=i*this.width*4+4*s;this.data[M]=(l>>10&n)/n*255|0,this.data[M+1]=m,this.data[M+2]=h,this.data[M+3]=E}this.pos+=t}},gg.prototype.bit16=function(){for(var t=this.width%3,n=parseInt("11111",2),e=parseInt("111111",2),i=this.height-1;i>=0;i--){for(var s=this.bottom_up?i:this.height-1-i,l=0;l<this.width;l++){var h=this.datav.getUint16(this.pos,!0);this.pos+=2;var m=(h&n)/n*255|0,b=(h>>5&e)/e*255|0,M=s*this.width*4+4*l;this.data[M]=(h>>11)/n*255|0,this.data[M+1]=b,this.data[M+2]=m,this.data[M+3]=255}this.pos+=t}},gg.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,e=0;e<this.width;e++){var i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),h=n*this.width*4+4*e;this.data[h]=l,this.data[h+1]=s,this.data[h+2]=i,this.data[h+3]=255}this.pos+=this.width%4}},gg.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var n=this.bottom_up?t:this.height-1-t,e=0;e<this.width;e++){var i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),h=this.datav.getUint8(this.pos++,!0),m=n*this.width*4+4*e;this.data[m]=l,this.data[m+1]=s,this.data[m+2]=i,this.data[m+3]=h}},gg.prototype.getData=function(){return this.data},
/**
         * @license
         * Copyright (c) 2018 Aras Abbasi
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(t){t.processBMP=function(n,e,i,s){var l=new gg(n,!1),h=l.width,m=l.height,b={data:l.getData(),width:h,height:m},E=new TP(100).encode(b,100);return t.processJPEG.call(this,E,e,i,s)}}(fs.API),mQ.prototype.getData=function(){return this.data},
/**
         * @license
         * Copyright (c) 2019 Aras Abbasi
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(t){t.processWEBP=function(n,e,i,s){var l=new mQ(n,!1),h=l.width,m=l.height,b={data:l.getData(),width:h,height:m},E=new TP(100).encode(b,100);return t.processJPEG.call(this,E,e,i,s)}}(fs.API),fs.API.processRGBA=function(t,n,e){for(var i=t.data,s=i.length,l=new Uint8Array(s/4*3),h=new Uint8Array(s/4),m=0,b=0,E=0;E<s;E+=4){var L=i[E+1],G=i[E+2],V=i[E+3];l[m++]=i[E],l[m++]=L,l[m++]=G,h[b++]=V}var ne=this.__addimage__.arrayBufferToBinaryString(l);return{alpha:this.__addimage__.arrayBufferToBinaryString(h),data:ne,index:n,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},fs.API.setLanguage=function(t){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]&&(this.internal.languageSettings.languageCode=t,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},mM=(jx=fs.API).getCharWidthsArray=function(t,n){var e,i,s=(n=n||{}).font||this.internal.getFont(),l=n.fontSize||this.internal.getFontSize(),h=n.charSpace||this.internal.getCharSpace(),m=n.widths?n.widths:s.metadata.Unicode.widths,b=m.fof?m.fof:1,E=n.kerning?n.kerning:s.metadata.Unicode.kerning,M=E.fof?E.fof:1,L=!1!==n.doKerning,G=0,V=t.length,ne=0,re=m[0]||b,de=[];for(e=0;e<V;e++)i=t.charCodeAt(e),"function"==typeof s.metadata.widthOfString?de.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(i))+h*(1e3/l)||0)/1e3):(G=L&&"object"===(0,Ga.Z)(E[i])&&!isNaN(parseInt(E[i][ne],10))?E[i][ne]/M:0,de.push((m[i]||re)/b+G)),ne=i;return de},fQ=jx.getStringUnitWidth=function(t,n){var e=(n=n||{}).fontSize||this.internal.getFontSize(),i=n.font||this.internal.getFont(),s=n.charSpace||this.internal.getCharSpace();return jx.processArabic&&(t=jx.processArabic(t)),"function"==typeof i.metadata.widthOfString?i.metadata.widthOfString(t,e,s)/e:mM.apply(this,arguments).reduce(function(l,h){return l+h},0)},AQ=function(t,n,e,i){for(var s=[],l=0,h=t.length,m=0;l!==h&&m+n[l]<e;)m+=n[l],l++;s.push(t.slice(0,l));var b=l;for(m=0;l!==h;)m+n[l]>i&&(s.push(t.slice(b,l)),m=0,b=l),m+=n[l],l++;return b!==l&&s.push(t.slice(b,l)),s},pQ=function(t,n,e){e||(e={});var i,s,l,h,m,b,M=[],L=[M],G=e.textIndent||0,V=0,ne=0,re=t.split(" "),de=mM.apply(this,[" ",e])[0];if(b=-1===e.lineIndent?re[0].length+2:e.lineIndent||0){var fe=Array(b).join(" "),he=[];re.map(function(We){(We=We.split(/\s*\n/)).length>1?he=he.concat(We.map(function(pt,Qt){return(Qt&&pt.length?"\n":"")+pt})):he.push(We[0])}),re=he,b=fQ.apply(this,[fe,e])}for(l=0,h=re.length;l<h;l++){var Ne=0;if(i=re[l],b&&"\n"==i[0]&&(i=i.substr(1),Ne=1),G+V+(ne=(s=mM.apply(this,[i,e])).reduce(function(We,pt){return We+pt},0))>n||Ne){if(ne>n){for(m=AQ.apply(this,[i,s,n-(G+V),n]),M.push(m.shift()),M=[m.pop()];m.length;)L.push([m.shift()]);ne=s.slice(i.length-(M[0]?M[0].length:0)).reduce(function(We,pt){return We+pt},0)}else M=[i];L.push(M),G=ne+b,V=de}else M.push(i),G+=V+ne,V=de}return L.map(b?function(We,pt){return(pt?fe:"")+We.join(" ")}:function(We){return We.join(" ")})},jx.splitTextToSize=function(t,n,e){var i,s=(e=e||{}).fontSize||this.internal.getFontSize(),l=function(M){if(M.widths&&M.kerning)return{widths:M.widths,kerning:M.kerning};var L=this.internal.getFont(M.fontName,M.fontStyle);return L.metadata.Unicode?{widths:L.metadata.Unicode.widths||{0:1},kerning:L.metadata.Unicode.kerning||{}}:{font:L.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,e);i=Array.isArray(t)?t:String(t).split(/\r?\n/);var h=1*this.internal.scaleFactor*n/s;l.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/s:0,l.lineIndent=e.lineIndent;var m,b,E=[];for(m=0,b=i.length;m<b;m++)E=E.concat(pQ.apply(this,[i[m],h,l]));return E},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var n="klmnopqrstuvwxyz",e={},i={},s=0;s<16;s++)e[n[s]]="0123456789abcdef"[s],i["0123456789abcdef"[s]]=n[s];var l=function(L){return"0x"+parseInt(L,10).toString(16)},h=t.__fontmetrics__.compress=function(L){var G,V,ne,re,de=["{"];for(var fe in L){if(G=L[fe],isNaN(parseInt(fe,10))?V="'"+fe+"'":(fe=parseInt(fe,10),V=(V=l(fe).slice(2)).slice(0,-1)+i[V.slice(-1)]),"number"==typeof G)G<0?(ne=l(G).slice(3),re="-"):(ne=l(G).slice(2),re=""),ne=re+ne.slice(0,-1)+i[ne.slice(-1)];else{if("object"!==(0,Ga.Z)(G))throw new Error("Don't know what to do with value type "+(0,Ga.Z)(G)+".");ne=h(G)}de.push(V+ne)}return de.push("}"),de.join("")},m=t.__fontmetrics__.uncompress=function(L){if("string"!=typeof L)throw new Error("Invalid argument passed to uncompress.");for(var G,V,ne,re,de={},fe=1,he=de,Ne=[],We="",pt="",Qt=L.length-1,yt=1;yt<Qt;yt+=1)"'"==(re=L[yt])?G?(ne=G.join(""),G=void 0):G=[]:G?G.push(re):"{"==re?(Ne.push([he,ne]),he={},ne=void 0):"}"==re?((V=Ne.pop())[0][V[1]]=he,ne=void 0,he=V[0]):"-"==re?fe=-1:void 0===ne?e.hasOwnProperty(re)?(We+=e[re],ne=parseInt(We,16)*fe,fe=1,We=""):We+=re:e.hasOwnProperty(re)?(pt+=e[re],he[ne]=parseInt(pt,16)*fe,fe=1,ne=void 0,pt=""):pt+=re;return de},b={codePages:["WinAnsiEncoding"],WinAnsiEncoding:m("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},E={Unicode:{Courier:b,"Courier-Bold":b,"Courier-BoldOblique":b,"Courier-Oblique":b,Helvetica:b,"Helvetica-Bold":b,"Helvetica-BoldOblique":b,"Helvetica-Oblique":b,"Times-Roman":b,"Times-Bold":b,"Times-BoldItalic":b,"Times-Italic":b}},M={Unicode:{"Courier-Oblique":m("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":m("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":m("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:m("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":m("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":m("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:m("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:m("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":m("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:m("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":m("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":m("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":m("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":m("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(L){var G=L.font,V=M.Unicode[G.postScriptName];V&&(G.metadata.Unicode={},G.metadata.Unicode.widths=V.widths,G.metadata.Unicode.kerning=V.kerning);var ne=E.Unicode[G.postScriptName];ne&&(G.metadata.Unicode.encoding=ne,G.encoding=ne.codePages[0])}])}(fs.API),
/**
         * @license
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(t){var n=function(e){for(var i=e.length,s=new Uint8Array(i),l=0;l<i;l++)s[l]=e.charCodeAt(l);return s};t.API.events.push(["addFont",function(e){var h,m,i=void 0,s=e.font,l=e.instance;if(!s.isStandardFont){if(void 0===l)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if("string"!=typeof(i=!1===l.existsFileInVFS(s.postScriptName)?l.loadFile(s.postScriptName):l.getFileFromVFS(s.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");h=s,m=/^\x00\x01\x00\x00/.test(m=i)?n(m):n(fS(m)),h.metadata=t.API.TTFFont.open(m),h.metadata.Unicode=h.metadata.Unicode||{encoding:{},kerning:{},widths:[]},h.metadata.glyIdsUsed=[0]}}])}(fs),fs.API.addSvgAsImage=function(e,i,s,l,h,m,b,E){if(isNaN(i)||isNaN(s))throw $a.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(l)||isNaN(h))throw $a.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var M=document.createElement("canvas");M.width=l,M.height=h;var L=M.getContext("2d");L.fillStyle="#fff",L.fillRect(0,0,M.width,M.height);var G={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},V=this;return function n(){return(ms.canvg?Promise.resolve(ms.canvg):Zs.e(484).then(Zs.bind(Zs,9484))).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}().then(function(ne){return ne.fromString(L,e,G)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(ne){return ne.render(G)}).then(function(){V.addImage(M.toDataURL("image/jpeg",1),i,s,l,h,b,E)})},fs.API.putTotalPages=function(t){var n,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(n=new RegExp(t,"g"),e=this.internal.getNumberOfPages()):(n=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var i=1;i<=this.internal.getNumberOfPages();i++)for(var s=0;s<this.internal.pages[i].length;s++)this.internal.pages[i][s]=this.internal.pages[i][s].replace(n,e);return this},fs.API.viewerPreferences=function(t,n){var e;t=t||{},n=n||!1;var i,s,l,h={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},m=Object.keys(h),b=[],E=0,M=0,L=0;function G(ne,re){var de,fe=!1;for(de=0;de<ne.length;de+=1)ne[de]===re&&(fe=!0);return fe}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(h)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,"reset"===t||!0===n){var V=m.length;for(L=0;L<V;L+=1)e[m[L]].value=e[m[L]].defaultValue,e[m[L]].explicitSet=!1}if("object"===(0,Ga.Z)(t))for(s in t)if(l=t[s],G(m,s)&&void 0!==l){if("boolean"===e[s].type&&"boolean"==typeof l)e[s].value=l;else if("name"===e[s].type&&G(e[s].valueSet,l))e[s].value=l;else if("integer"===e[s].type&&Number.isInteger(l))e[s].value=l;else if("array"===e[s].type){for(E=0;E<l.length;E+=1)if(i=!0,1===l[E].length&&"number"==typeof l[E][0])b.push(String(l[E]-1));else if(l[E].length>1){for(M=0;M<l[E].length;M+=1)"number"!=typeof l[E][M]&&(i=!1);!0===i&&b.push([l[E][0]-1,l[E][1]-1].join(" "))}e[s].value="["+b.join(" ")+"]"}else e[s].value=e[s].defaultValue;e[s].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var ne,re=[];for(ne in e)!0===e[ne].explicitSet&&re.push("name"===e[ne].type?"/"+ne+" /"+e[ne].value:"/"+ne+" "+e[ne].value);0!==re.length&&this.internal.write("/ViewerPreferences\n<<\n"+re.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},
/** ====================================================================
         * @license
         * jsPDF XMP metadata plugin
         * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
         *
         * Permission is hereby granted, free of charge, to any person obtaining
         * a copy of this software and associated documentation files (the
         * "Software"), to deal in the Software without restriction, including
         * without limitation the rights to use, copy, modify, merge, publish,
         * distribute, sublicense, and/or sell copies of the Software, and to
         * permit persons to whom the Software is furnished to do so, subject to
         * the following conditions:
         *
         * The above copyright notice and this permission notice shall be
         * included in all copies or substantial portions of the Software.
         *
         * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
         * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
         * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
         * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
         * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
         * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
         * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
         * ====================================================================
         */
function(t){var n=function(){var i='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),l=unescape(encodeURIComponent(i)),h=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),m=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),b=unescape(encodeURIComponent("</x:xmpmeta>")),E=l.length+h.length+m.length+s.length+b.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+E+" >>"),this.internal.write("stream"),this.internal.write(s+l+h+m+b),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(i,s){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:i,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",n)),this}}(fs.API),function(t){var n=t.API,e=n.pdfEscape16=function(l,h){for(var m,b=h.metadata.Unicode.widths,E=["","0","00","000","0000"],M=[""],L=0,G=l.length;L<G;++L){if(m=h.metadata.characterToGlyph(l.charCodeAt(L)),h.metadata.glyIdsUsed.push(m),h.metadata.toUnicode[m]=l.charCodeAt(L),-1==b.indexOf(m)&&(b.push(m),b.push([parseInt(h.metadata.widthOfGlyph(m),10)])),"0"==m)return M.join("");m=m.toString(16),M.push(E[4-m.length],m)}return M.join("")},i=function(l){var h,m,b,E,M,L,G;for(M="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",b=[],L=0,G=(m=Object.keys(l).sort(function(V,ne){return V-ne})).length;L<G;L++)h=m[L],b.length>=100&&(M+="\n"+b.length+" beginbfchar\n"+b.join("\n")+"\nendbfchar",b=[]),null!=l[h]&&"function"==typeof l[h].toString&&(E=("0000"+l[h].toString(16)).slice(-4),h=("0000"+(+h).toString(16)).slice(-4),b.push("<"+h+"><"+E+">"));return b.length&&(M+="\n"+b.length+" beginbfchar\n"+b.join("\n")+"\nendbfchar\n"),M+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};n.events.push(["putFont",function(l){!function(h){var m=h.font,b=h.out,E=h.newObject,M=h.putStream;if(m.metadata instanceof t.API.TTFFont&&"Identity-H"===m.encoding){for(var L=m.metadata.Unicode.widths,G=m.metadata.subset.encode(m.metadata.glyIdsUsed,1),V="",ne=0;ne<G.length;ne++)V+=String.fromCharCode(G[ne]);var re=E();M({data:V,addLength1:!0,objectId:re}),b("endobj");var de=E();M({data:i(m.metadata.toUnicode),addLength1:!0,objectId:de}),b("endobj");var fe=E();b("<<"),b("/Type /FontDescriptor"),b("/FontName /"+Nx(m.fontName)),b("/FontFile2 "+re+" 0 R"),b("/FontBBox "+t.API.PDFObject.convert(m.metadata.bbox)),b("/Flags "+m.metadata.flags),b("/StemV "+m.metadata.stemV),b("/ItalicAngle "+m.metadata.italicAngle),b("/Ascent "+m.metadata.ascender),b("/Descent "+m.metadata.decender),b("/CapHeight "+m.metadata.capHeight),b(">>"),b("endobj");var he=E();b("<<"),b("/Type /Font"),b("/BaseFont /"+Nx(m.fontName)),b("/FontDescriptor "+fe+" 0 R"),b("/W "+t.API.PDFObject.convert(L)),b("/CIDToGIDMap /Identity"),b("/DW 1000"),b("/Subtype /CIDFontType2"),b("/CIDSystemInfo"),b("<<"),b("/Supplement 0"),b("/Registry (Adobe)"),b("/Ordering ("+m.encoding+")"),b(">>"),b(">>"),b("endobj"),m.objectNumber=E(),b("<<"),b("/Type /Font"),b("/Subtype /Type0"),b("/ToUnicode "+de+" 0 R"),b("/BaseFont /"+Nx(m.fontName)),b("/Encoding /"+m.encoding),b("/DescendantFonts ["+he+" 0 R]"),b(">>"),b("endobj"),m.isAlreadyPutted=!0}}(l)}]),n.events.push(["putFont",function(l){!function(h){var m=h.font,b=h.out,E=h.newObject,M=h.putStream;if(m.metadata instanceof t.API.TTFFont&&"WinAnsiEncoding"===m.encoding){for(var L=m.metadata.rawData,G="",V=0;V<L.length;V++)G+=String.fromCharCode(L[V]);var ne=E();M({data:G,addLength1:!0,objectId:ne}),b("endobj");var re=E();M({data:i(m.metadata.toUnicode),addLength1:!0,objectId:re}),b("endobj");var de=E();b("<<"),b("/Descent "+m.metadata.decender),b("/CapHeight "+m.metadata.capHeight),b("/StemV "+m.metadata.stemV),b("/Type /FontDescriptor"),b("/FontFile2 "+ne+" 0 R"),b("/Flags 96"),b("/FontBBox "+t.API.PDFObject.convert(m.metadata.bbox)),b("/FontName /"+Nx(m.fontName)),b("/ItalicAngle "+m.metadata.italicAngle),b("/Ascent "+m.metadata.ascender),b(">>"),b("endobj"),m.objectNumber=E();for(var fe=0;fe<m.metadata.hmtx.widths.length;fe++)m.metadata.hmtx.widths[fe]=parseInt(m.metadata.hmtx.widths[fe]*(1e3/m.metadata.head.unitsPerEm));b("<</Subtype/TrueType/Type/Font/ToUnicode "+re+" 0 R/BaseFont/"+Nx(m.fontName)+"/FontDescriptor "+de+" 0 R/Encoding/"+m.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(m.metadata.hmtx.widths)+">>"),b("endobj"),m.isAlreadyPutted=!0}}(l)}]);var s=function(l){var h,m=l.text||"",b=l.x,E=l.y,M=l.options||{},L=l.mutex||{},G=L.pdfEscape,V=L.activeFontKey,ne=L.fonts,re=V,de="",fe=0,he="",Ne=ne[re].encoding;if("Identity-H"!==ne[re].encoding)return{text:m,x:b,y:E,options:M,mutex:L};for(he=m,re=V,Array.isArray(m)&&(he=m[0]),fe=0;fe<he.length;fe+=1)ne[re].metadata.hasOwnProperty("cmap")&&(h=ne[re].metadata.cmap.unicode.codeMap[he[fe].charCodeAt(0)]),h||he[fe].charCodeAt(0)<256&&ne[re].metadata.hasOwnProperty("Unicode")?de+=he[fe]:de+="";var We="";return parseInt(re.slice(1))<14||"WinAnsiEncoding"===Ne?We=G(de,re).split("").map(function(pt){return pt.charCodeAt(0).toString(16)}).join(""):"Identity-H"===Ne&&(We=e(de,ne[re])),L.isHex=!0,{text:We,x:b,y:E,options:M,mutex:L}};n.events.push(["postProcessText",function(l){var h=l.text||"",m=[],b={text:h,x:l.x,y:l.y,options:l.options,mutex:l.mutex};if(Array.isArray(h)){var E=0;for(E=0;E<h.length;E+=1)Array.isArray(h[E])&&3===h[E].length?m.push([s(Object.assign({},b,{text:h[E][0]})).text,h[E][1],h[E][2]]):m.push(s(Object.assign({},b,{text:h[E]})).text);l.text=m}else l.text=s(Object.assign({},b,{text:h})).text}])}(fs),
/**
         * @license
         * jsPDF virtual FileSystem functionality
         *
         * Licensed under the MIT License.
         * http://opensource.org/licenses/mit-license
         */
function(t){var n=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(e){return n.call(this),void 0!==this.internal.vFS[e]},t.addFileToVFS=function(e,i){return n.call(this),this.internal.vFS[e]=i,this},t.getFileFromVFS=function(e){return n.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(fs.API),
/**
         * @license
         * Unicode Bidi Engine based on the work of Alex Shensis (@asthensis)
         * MIT License
         */
function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(i){var s,l,h,m,b,E,M,L=n,G=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],V=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],ne={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},re={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},de=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],fe=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),he=!1,Ne=0;this.__bidiEngine__={};var We=function(Ue){var ze=Ue.charCodeAt(),ut=ze>>8,lt=re[ut];return void 0!==lt?L[256*lt+(255&ze)]:252===ut||253===ut?"AL":fe.test(ut)?"L":8===ut?"R":"N"},pt=function(Ue){for(var ze,ut=0;ut<Ue.length;ut++){if("L"===(ze=We(Ue.charAt(ut))))return!1;if("R"===ze)return!0}return!1},Qt=function(Ue,ze,ut,lt){var _n,ft,Ot,wt,Yt=ze[lt];switch(Yt){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":he=!1;break;case"N":case"AN":break;case"EN":he&&(Yt="AN");break;case"AL":he=!0,Yt="R";break;case"WS":case"BN":Yt="N";break;case"CS":lt<1||lt+1>=ze.length||"EN"!==(_n=ut[lt-1])&&"AN"!==_n||"EN"!==(ft=ze[lt+1])&&"AN"!==ft?Yt="N":he&&(ft="AN"),Yt=ft===_n?ft:"N";break;case"ES":Yt="EN"===(_n=lt>0?ut[lt-1]:"B")&&lt+1<ze.length&&"EN"===ze[lt+1]?"EN":"N";break;case"ET":if(lt>0&&"EN"===ut[lt-1]){Yt="EN";break}if(he){Yt="N";break}for(Ot=lt+1,wt=ze.length;Ot<wt&&"ET"===ze[Ot];)Ot++;Yt=Ot<wt&&"EN"===ze[Ot]?"EN":"N";break;case"NSM":if(h&&!m){for(wt=ze.length,Ot=lt+1;Ot<wt&&"NSM"===ze[Ot];)Ot++;if(Ot<wt){var pn=Ue[lt];if(_n=ze[Ot],(pn>=1425&&pn<=2303||64286===pn)&&("R"===_n||"AL"===_n)){Yt="R";break}}}Yt=lt<1||"B"===(_n=ze[lt-1])?"N":ut[lt-1];break;case"B":he=!1,s=!0,Yt=Ne;break;case"S":l=!0,Yt="N"}return Yt},yt=function(Ue,ze,ut){var lt=Ue.split("");return ut&&Ye(lt,ut,{hiLevel:Ne}),lt.reverse(),ze&&ze.reverse(),lt.join("")},Ye=function(Ue,ze,ut){var lt,_n,ft,Ot,wt,Yt=-1,pn=Ue.length,Ti=0,Se=[],Xe=Ne?V:G,Je=[];for(he=!1,s=!1,l=!1,_n=0;_n<pn;_n++)Je[_n]=We(Ue[_n]);for(ft=0;ft<pn;ft++){if(wt=Ti,Se[ft]=Qt(Ue,Je,Se,ft),lt=240&(Ti=Xe[wt][ne[Se[ft]]]),ze[ft]=Ot=Xe[Ti&=15][5],lt>0)if(16===lt){for(_n=Yt;_n<ft;_n++)ze[_n]=1;Yt=-1}else Yt=-1;if(Xe[Ti][6])-1===Yt&&(Yt=ft);else if(Yt>-1){for(_n=Yt;_n<ft;_n++)ze[_n]=Ot;Yt=-1}"B"===Je[ft]&&(ze[ft]=0),ut.hiLevel|=Ot}l&&function(_t,Nt,jt){for(var en=0;en<jt;en++)if("S"===_t[en]){Nt[en]=Ne;for(var sn=en-1;sn>=0&&"WS"===_t[sn];sn--)Nt[sn]=Ne}}(Je,ze,pn)},un=function(Ue,ze,ut,lt,_n){if(!(_n.hiLevel<Ue)){if(1===Ue&&1===Ne&&!s)return ze.reverse(),void(ut&&ut.reverse());for(var ft,Ot,wt,Yt,pn=ze.length,Ti=0;Ti<pn;){if(lt[Ti]>=Ue){for(wt=Ti+1;wt<pn&&lt[wt]>=Ue;)wt++;for(Yt=Ti,Ot=wt-1;Yt<Ot;Yt++,Ot--)ft=ze[Yt],ze[Yt]=ze[Ot],ze[Ot]=ft,ut&&(ft=ut[Yt],ut[Yt]=ut[Ot],ut[Ot]=ft);Ti=wt}Ti++}}},hn=function(Ue,ze,ut){var lt=Ue.split(""),_n={hiLevel:Ne};return ut||(ut=[]),Ye(lt,ut,_n),function(ft,Ot,wt){if(0!==wt.hiLevel&&M)for(var Yt,pn=0;pn<ft.length;pn++)1===Ot[pn]&&(Yt=de.indexOf(ft[pn]))>=0&&(ft[pn]=de[Yt+1])}(lt,ut,_n),un(2,lt,ze,ut,_n),un(1,lt,ze,ut,_n),lt.join("")};return this.__bidiEngine__.doBidiReorder=function(Ue,ze,ut){if(function(_n,ft){if(ft)for(var Ot=0;Ot<_n.length;Ot++)ft[Ot]=Ot;void 0===m&&(m=pt(_n)),void 0===E&&(E=pt(_n))}(Ue,ze),h||!b||E)if(h&&b&&m^E)Ne=m?1:0,Ue=yt(Ue,ze,ut);else if(!h&&b&&E)Ne=m?1:0,Ue=hn(Ue,ze,ut),Ue=yt(Ue,ze);else if(!h||m||b||E){if(h&&!b&&m^E)Ue=yt(Ue,ze),m?(Ne=0,Ue=hn(Ue,ze,ut)):(Ne=1,Ue=hn(Ue,ze,ut),Ue=yt(Ue,ze));else if(h&&m&&!b&&E)Ne=1,Ue=hn(Ue,ze,ut),Ue=yt(Ue,ze);else if(!h&&!b&&m^E){var lt=M;m?(Ne=1,Ue=hn(Ue,ze,ut),Ne=0,M=!1,Ue=hn(Ue,ze,ut),M=lt):(Ne=0,Ue=hn(Ue,ze,ut),Ue=yt(Ue,ze),Ne=1,M=!1,Ue=hn(Ue,ze,ut),M=lt,Ue=yt(Ue,ze))}}else Ne=0,Ue=hn(Ue,ze,ut);else Ne=m?1:0,Ue=hn(Ue,ze,ut);return Ue},this.__bidiEngine__.setOptions=function(Ue){Ue&&(h=Ue.isInputVisual,b=Ue.isOutputVisual,m=Ue.isInputRtl,E=Ue.isOutputRtl,M=Ue.isSymmetricSwapping)},this.__bidiEngine__.setOptions(i),this.__bidiEngine__};var n=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(i){var s=i.text,l=i.options||{},h=[];if(l.isInputVisual="boolean"!=typeof l.isInputVisual||l.isInputVisual,e.setOptions(l),"[object Array]"===Object.prototype.toString.call(s)){var m=0;for(h=[],m=0;m<s.length;m+=1)"[object Array]"===Object.prototype.toString.call(s[m])?h.push([e.doBidiReorder(s[m][0]),s[m][1],s[m][2]]):h.push([e.doBidiReorder(s[m])]);i.text=h}else i.text=e.doBidiReorder(s);e.setOptions({isInputVisual:!0})}])}(fs),fs.API.TTFFont=function(){function t(n){var e;if(this.rawData=n,e=this.contents=new Wy(n),this.contents.pos=4,"ttcf"===e.readString(4))throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new Cae(this),this.registerTTF()}return t.open=function(n){return new t(n)},t.prototype.parse=function(){return this.directory=new uae(this.contents),this.head=new dae(this),this.name=new mae(this),this.cmap=new yQ(this),this.toUnicode={},this.hhea=new fae(this),this.maxp=new _ae(this),this.hmtx=new yae(this),this.post=new pae(this),this.os2=new Aae(this),this.loca=new xae(this),this.glyf=new vae(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,i,s,l;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var h,m,b,E;for(E=[],h=0,m=(b=this.bbox).length;h<m;h++)E.push(Math.round(b[h]*this.scaleFactor));return E}.call(this),this.stemV=0,this.post.exists?(i=255&(s=this.post.italic_angle),32768&(e=s>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+i)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(l=this.familyClass)||2===l||3===l||4===l||5===l||7===l,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(n){var e;return(null!=(e=this.cmap.unicode)?e.codeMap[n]:void 0)||0},t.prototype.widthOfGlyph=function(n){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(n).advance*e},t.prototype.widthOfString=function(n,e,i){var s,l,h,m;for(h=0,l=0,m=(n=""+n).length;0<=m?l<m:l>m;l=0<=m?++l:--l)s=n.charCodeAt(l),h+=this.widthOfGlyph(this.characterToGlyph(s))+i*(1e3/e)||0;return h*(e/1e3)},t.prototype.lineHeight=function(n,e){return null==e&&(e=!1),(this.ascender+(e?this.lineGap:0)-this.decender)/1e3*n},t}();var mg,Wy=function(){function t(n){this.data=n??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(n){return this.data[this.pos++]=n},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(n){return this.writeByte(n>>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt32=function(){var n;return(n=this.readUInt32())>=2147483648?n-4294967296:n},t.prototype.writeInt32=function(n){return n<0&&(n+=4294967296),this.writeUInt32(n)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(n){return this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt16=function(){var n;return(n=this.readUInt16())>=32768?n-65536:n},t.prototype.writeInt16=function(n){return n<0&&(n+=65536),this.writeUInt16(n)},t.prototype.readString=function(n){var e,i;for(i=[],e=0;0<=n?e<n:e>n;e=0<=n?++e:--e)i[e]=String.fromCharCode(this.readByte());return i.join("")},t.prototype.writeString=function(n){var e,i,s;for(s=[],e=0,i=n.length;0<=i?e<i:e>i;e=0<=i?++e:--e)s.push(this.writeByte(n.charCodeAt(e)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(n){return this.writeInt16(n)},t.prototype.readLongLong=function(){var n,e,i,s,l,h,m,b;return n=this.readByte(),e=this.readByte(),i=this.readByte(),s=this.readByte(),l=this.readByte(),h=this.readByte(),m=this.readByte(),b=this.readByte(),128&n?-1*(72057594037927940*(255^n)+281474976710656*(255^e)+1099511627776*(255^i)+4294967296*(255^s)+16777216*(255^l)+65536*(255^h)+256*(255^m)+(255^b)+1):72057594037927940*n+281474976710656*e+1099511627776*i+4294967296*s+16777216*l+65536*h+256*m+b},t.prototype.writeLongLong=function(n){var e,i;return e=Math.floor(n/4294967296),i=4294967295&n,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(n){return this.writeInt32(n)},t.prototype.read=function(n){var e,i;for(e=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)e.push(this.readByte());return e},t.prototype.write=function(n){var i,s,l;for(l=[],i=0,s=n.length;i<s;i++)l.push(this.writeByte(n[i]));return l},t}(),uae=function(){var t;function n(e){var i,s,l;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},s=0,l=this.tableCount;0<=l?s<l:s>l;s=0<=l?++s:--s)i={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[i.tag]=i}return n.prototype.encode=function(e){var i,s,h,m,b,E,M,L,G,V,ne,re;for(re in V=Object.keys(e).length,b=Math.log(2),L=16*Math.floor(Math.log(V)/b),h=Math.floor(L/b),M=16*V-L,(s=new Wy).writeInt(this.scalarType),s.writeShort(V),s.writeShort(L),s.writeShort(h),s.writeShort(M),E=s.pos+16*V,m=null,ne=[],e)for(G=e[re],s.writeString(re),s.writeInt(t(G)),s.writeInt(E),s.writeInt(G.length),ne=ne.concat(G),"head"===re&&(m=E),E+=G.length;E%4;)ne.push(0),E++;return s.write(ne),i=2981146554-t(s.data),s.pos=m+8,s.writeUInt32(i),s.data},t=function(e){var i,s,l,h;for(e=vQ.call(e);e.length%4;)e.push(0);for(l=new Wy(e),s=0,i=0,h=e.length;i<h;i=i+=4)s+=l.readUInt32();return 4294967295&s},n}(),hae={}.hasOwnProperty,Qm=function(t,n){for(var e in n)hae.call(n,e)&&(t[e]=n[e]);function i(){this.constructor=t}return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};mg=function(){function t(n){var e;this.file=n,this.exists=!!(e=this.file.directory.tables[this.tag]),e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var dae=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Qm(n,mg),n.prototype.tag="head",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},n.prototype.encode=function(e){var i;return(i=new Wy).writeInt(this.version),i.writeInt(this.revision),i.writeInt(this.checkSumAdjustment),i.writeInt(this.magicNumber),i.writeShort(this.flags),i.writeShort(this.unitsPerEm),i.writeLongLong(this.created),i.writeLongLong(this.modified),i.writeShort(this.xMin),i.writeShort(this.yMin),i.writeShort(this.xMax),i.writeShort(this.yMax),i.writeShort(this.macStyle),i.writeShort(this.lowestRecPPEM),i.writeShort(this.fontDirectionHint),i.writeShort(e),i.writeShort(this.glyphDataFormat),i.data},n}(),_Q=function(){function t(n,e){var i,s,l,h,m,b,E,M,L,G,V,ne,re,de,fe,he,Ne;switch(this.platformID=n.readUInt16(),this.encodingID=n.readShort(),this.offset=e+n.readInt(),L=n.pos,n.pos=this.offset,this.format=n.readUInt16(),this.length=n.readUInt16(),this.language=n.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(b=0;b<256;++b)this.codeMap[b]=n.readByte();break;case 4:for(V=n.readUInt16(),G=V/2,n.pos+=6,l=function(){var We,pt;for(pt=[],b=We=0;0<=G?We<G:We>G;b=0<=G?++We:--We)pt.push(n.readUInt16());return pt}(),n.pos+=2,re=function(){var We,pt;for(pt=[],b=We=0;0<=G?We<G:We>G;b=0<=G?++We:--We)pt.push(n.readUInt16());return pt}(),E=function(){var We,pt;for(pt=[],b=We=0;0<=G?We<G:We>G;b=0<=G?++We:--We)pt.push(n.readUInt16());return pt}(),M=function(){var We,pt;for(pt=[],b=We=0;0<=G?We<G:We>G;b=0<=G?++We:--We)pt.push(n.readUInt16());return pt}(),s=(this.length-n.pos+this.offset)/2,m=function(){var We,pt;for(pt=[],b=We=0;0<=s?We<s:We>s;b=0<=s?++We:--We)pt.push(n.readUInt16());return pt}(),b=fe=0,Ne=l.length;fe<Ne;b=++fe)for(de=l[b],i=he=ne=re[b];ne<=de?he<=de:he>=de;i=ne<=de?++he:--he)0===M[b]?h=i+E[b]:0!==(h=m[M[b]/2+(i-ne)-(G-b)]||0)&&(h+=E[b]),this.codeMap[i]=65535&h}n.pos=L}return t.encode=function(n,e){var i,s,l,h,m,b,E,M,L,G,V,ne,re,de,fe,he,Ne,pt,Qt,yt,Ye,un,hn,Ue,ze,ut,lt,_n,ft,Ot,wt,Yt,pn,Ti,Se,Xe,Je,_t,Nt,jt,en,sn,bi,di,Yi;switch(lt=new Wy,h=Object.keys(n).sort(function(Ji,ss){return Ji-ss}),e){case"macroman":for(re=0,de=function(){var Ji=[];for(ne=0;ne<256;++ne)Ji.push(0);return Ji}(),he={0:0},l={},_n=0,Yt=h.length;_n<Yt;_n++)null==he[sn=n[s=h[_n]]]&&(he[sn]=++re),l[s]={old:n[s],new:he[n[s]]},de[s]=he[n[s]];return lt.writeUInt16(1),lt.writeUInt16(0),lt.writeUInt32(12),lt.writeUInt16(0),lt.writeUInt16(262),lt.writeUInt16(0),lt.write(de),{charMap:l,subtable:lt.data,maxGlyphID:re+1};case"unicode":for(ze=[],L=[],Ne=0,he={},i={},fe=E=null,ft=0,pn=h.length;ft<pn;ft++)null==he[pt=n[s=h[ft]]]&&(he[pt]=++Ne),i[s]={old:pt,new:he[pt]},m=he[pt]-s,null!=fe&&m===E||(fe&&L.push(fe),ze.push(s),E=m),fe=s;for(fe&&L.push(fe),L.push(65535),ze.push(65535),hn=2*(un=ze.length),Ye=2*Math.pow(Math.log(un)/Math.LN2,2),G=Math.log(Ye/2)/Math.LN2,yt=2*un-Ye,b=[],Qt=[],V=[],ne=Ot=0,Ti=ze.length;Ot<Ti;ne=++Ot){if(M=L[ne],65535===(Ue=ze[ne])){b.push(0),Qt.push(0);break}if(Ue-(ut=i[Ue].new)>=32768)for(b.push(0),Qt.push(2*(V.length+un-ne)),s=wt=Ue;Ue<=M?wt<=M:wt>=M;s=Ue<=M?++wt:--wt)V.push(i[s].new);else b.push(ut-Ue),Qt.push(0)}for(lt.writeUInt16(3),lt.writeUInt16(1),lt.writeUInt32(12),lt.writeUInt16(4),lt.writeUInt16(16+8*un+2*V.length),lt.writeUInt16(0),lt.writeUInt16(hn),lt.writeUInt16(Ye),lt.writeUInt16(G),lt.writeUInt16(yt),jt=0,Se=L.length;jt<Se;jt++)lt.writeUInt16(s=L[jt]);for(lt.writeUInt16(0),en=0,Xe=ze.length;en<Xe;en++)lt.writeUInt16(s=ze[en]);for(bi=0,Je=b.length;bi<Je;bi++)lt.writeUInt16(m=b[bi]);for(di=0,_t=Qt.length;di<_t;di++)lt.writeUInt16(Qt[di]);for(Yi=0,Nt=V.length;Yi<Nt;Yi++)lt.writeUInt16(re=V[Yi]);return{charMap:i,subtable:lt.data,maxGlyphID:Ne+1}}},t}(),yQ=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Qm(n,mg),n.prototype.tag="cmap",n.prototype.parse=function(e){var i,s,l;for(e.pos=this.offset,this.version=e.readUInt16(),l=e.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=l?s<l:s>l;s=0<=l?++s:--s)i=new _Q(e,this.offset),this.tables.push(i),i.isUnicode&&null==this.unicode&&(this.unicode=i);return!0},n.encode=function(e,i){var s,l;return null==i&&(i="macroman"),s=_Q.encode(e,i),(l=new Wy).writeUInt16(0),l.writeUInt16(1),s.table=l.data.concat(s.subtable),s},n}(),fae=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Qm(n,mg),n.prototype.tag="hhea",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},n}(),Aae=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Qm(n,mg),n.prototype.tag="OS/2",n.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var i,s;for(s=[],i=0;i<10;++i)s.push(e.readByte());return s}(),this.charRange=function(){var i,s;for(s=[],i=0;i<4;++i)s.push(e.readInt());return s}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var i,s;for(s=[],i=0;i<2;i=++i)s.push(e.readInt());return s}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},n}(),pae=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Qm(n,mg),n.prototype.tag="post",n.prototype.parse=function(e){var i,s,l;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var h;for(s=e.readUInt16(),this.glyphNameIndex=[],h=0;0<=s?h<s:h>s;h=0<=s?++h:--h)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],l=[];e.pos<this.offset+this.length;)i=e.readByte(),l.push(this.names.push(e.readString(i)));return l;case 151552:return s=e.readUInt16(),this.offsets=e.read(s);case 262144:return this.map=function(){var m,b,E;for(E=[],h=m=0,b=this.file.maxp.numGlyphs;0<=b?m<b:m>b;h=0<=b?++m:--m)E.push(e.readUInt32());return E}.call(this)}},n}(),gae=function(t,n){this.raw=t,this.length=t.length,this.platformID=n.platformID,this.encodingID=n.encodingID,this.languageID=n.languageID},mae=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Qm(n,mg),n.prototype.tag="name",n.prototype.parse=function(e){var i,s,l,h,m,b,E,M,L,G,V;for(e.pos=this.offset,e.readShort(),i=e.readShort(),b=e.readShort(),s=[],h=0;0<=i?h<i:h>i;h=0<=i?++h:--h)s.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+b+e.readShort()});for(E={},h=L=0,G=s.length;L<G;h=++L)e.pos=(l=s[h]).offset,M=e.readString(l.length),m=new gae(M,l),null==E[V=l.nameID]&&(E[V]=[]),E[l.nameID].push(m);this.strings=E,this.copyright=E[0],this.fontFamily=E[1],this.fontSubfamily=E[2],this.uniqueSubfamily=E[3],this.fontName=E[4],this.version=E[5];try{this.postscriptName=E[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=E[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=E[7],this.manufacturer=E[8],this.designer=E[9],this.description=E[10],this.vendorUrl=E[11],this.designerUrl=E[12],this.license=E[13],this.licenseUrl=E[14],this.preferredFamily=E[15],this.preferredSubfamily=E[17],this.compatibleFull=E[18],this.sampleText=E[19]},n}(),_ae=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Qm(n,mg),n.prototype.tag="maxp",n.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},n}(),yae=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Qm(n,mg),n.prototype.tag="hmtx",n.prototype.parse=function(e){var i,s,l,m,b,E;for(e.pos=this.offset,this.metrics=[],i=0,b=this.file.hhea.numberOfMetrics;0<=b?i<b:i>b;i=0<=b?++i:--i)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(l=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var M,L;for(L=[],i=M=0;0<=l?M<l:M>l;i=0<=l?++M:--M)L.push(e.readInt16());return L}(),this.widths=function(){var M,L,G,V;for(V=[],M=0,L=(G=this.metrics).length;M<L;M++)V.push(G[M].advance);return V}.call(this),s=this.widths[this.widths.length-1],E=[],i=m=0;0<=l?m<l:m>l;i=0<=l?++m:--m)E.push(this.widths.push(s));return E},n.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},n}(),vQ=[].slice,vae=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Qm(n,mg),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(e){var i,s,l,h,m,b,E,M,L,G;return e in this.cache?this.cache[e]:(i=this.file.contents,s=(h=this.file.loca).indexOf(e),0===(l=h.lengthOf(e))?this.cache[e]=null:(i.pos=this.offset+s,m=(b=new Wy(i.read(l))).readShort(),M=b.readShort(),G=b.readShort(),E=b.readShort(),L=b.readShort(),this.cache[e]=-1===m?new wae(b,M,G,E,L):new bae(b,m,M,G,E,L),this.cache[e]))},n.prototype.encode=function(e,i,s){var l,h,m,b,E;for(m=[],h=[],b=0,E=i.length;b<E;b++)l=e[i[b]],h.push(m.length),l&&(m=m.concat(l.encode(s)));return h.push(m.length),{table:m,offsets:h}},n}(),bae=function(){function t(n,e,i,s,l,h){this.raw=n,this.numberOfContours=e,this.xMin=i,this.yMin=s,this.xMax=l,this.yMax=h,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),wae=function(){function t(n,e,i,s,l){var h,m;for(this.raw=n,this.xMin=e,this.yMin=i,this.xMax=s,this.yMax=l,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],h=this.raw;m=h.readShort(),this.glyphOffsets.push(h.pos),this.glyphIDs.push(h.readUInt16()),32&m;)h.pos+=1&m?4:2,128&m?h.pos+=8:64&m?h.pos+=4:8&m&&(h.pos+=2)}return t.prototype.encode=function(){var n,e,i;for(e=new Wy(vQ.call(this.raw.data)),n=0,i=this.glyphIDs.length;n<i;++n)e.pos=this.glyphOffsets[n];return e.data},t}(),xae=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Qm(n,mg),n.prototype.tag="loca",n.prototype.parse=function(e){var s;return e.pos=this.offset,this.offsets=0===this.file.head.indexToLocFormat?function(){var l,h;for(h=[],s=0,l=this.length;s<l;s+=2)h.push(2*e.readUInt16());return h}.call(this):function(){var l,h;for(h=[],s=0,l=this.length;s<l;s+=4)h.push(e.readUInt32());return h}.call(this)},n.prototype.indexOf=function(e){return this.offsets[e]},n.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},n.prototype.encode=function(e,i){for(var s=new Uint32Array(this.offsets.length),l=0,h=0,m=0;m<s.length;++m)if(s[m]=l,h<i.length&&i[h]==m){++h,s[m]=l;var E=this.offsets[m+1]-this.offsets[m];E>0&&(l+=E)}for(var M=new Array(4*s.length),L=0;L<s.length;++L)M[4*L+3]=255&s[L],M[4*L+2]=(65280&s[L])>>8,M[4*L+1]=(16711680&s[L])>>16,M[4*L]=(4278190080&s[L])>>24;return M},n}(),Cae=function(){function t(n){this.font=n,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var n,e,s,l;for(e in s=this.font.cmap.tables[0].codeMap,n={},l=this.subset)n[e]=s[l[e]];return n},t.prototype.glyphsFor=function(n){var e,i,s,l,h,m,b;for(s={},h=0,m=n.length;h<m;h++)s[l=n[h]]=this.font.glyf.glyphFor(l);for(l in e=[],s)null!=(i=s[l])&&i.compound&&e.push.apply(e,i.glyphIDs);if(e.length>0)for(l in b=this.glyphsFor(e))s[l]=i=b[l];return s},t.prototype.encode=function(n,e){var i,s,l,h,b,E,M,L,G,V,ne,re,de,fe;for(s in i=yQ.encode(this.generateCmap(),"unicode"),h=this.glyphsFor(n),V={0:0},fe=i.charMap)V[(b=fe[s]).old]=b.new;for(ne in G=i.maxGlyphID,h)ne in V||(V[ne]=G++);return M=function(he){var Ne,We;for(Ne in We={},he)We[he[Ne]]=Ne;return We}(V),L=Object.keys(M).sort(function(he,Ne){return he-Ne}),re=function(){var he,Ne,We;for(We=[],he=0,Ne=L.length;he<Ne;he++)We.push(M[L[he]]);return We}(),l=this.font.glyf.encode(h,re,V),E=this.font.loca.encode(l.offsets,re),de={cmap:this.font.cmap.raw(),glyf:l.table,loca:E,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(de["OS/2"]=this.font.os2.raw()),this.font.directory.encode(de)},t}();fs.API.PDFObject=function(){var t;function n(){}return t=function(e,i){return(Array(i+1).join("0")+e).slice(-i)},n.convert=function(e){var s,l;if(Array.isArray(e))return"["+function(){var m,b,E;for(E=[],m=0,b=e.length;m<b;m++)E.push(n.convert(e[m]));return E}().join(" ")+"]";if("string"==typeof e)return"/"+e;if(e?.isString)return"("+e+")";if(e instanceof Date)return"(D:"+t(e.getUTCFullYear(),4)+t(e.getUTCMonth(),2)+t(e.getUTCDate(),2)+t(e.getUTCHours(),2)+t(e.getUTCMinutes(),2)+t(e.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(e)){for(s in l=["<<"],e)l.push("/"+s+" "+n.convert(e[s]));return l.push(">>"),l.join("\n")}return""+e},n}();const _M=fs;var Eae=Zs(4456),IP=Zs.n(Eae);let DP=(()=>{class t{constructor(e){this.httpClient=e}getGlobalEmissions(){return this.globalCO2emissions=[],this.httpClient.get(xl_apiHost+"/reports/globalCo2").pipe(Ht(e=>e)).pipe(Ht(e=>e))}getTourInfo(e,i){return this.httpClient.get(xl_apiHost+`/reports/getToursInfo?startDate=${e}&endDate=${i}`).pipe(Ht(s=>s)).pipe(Ht(s=>s))}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(dg))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Sae(t,n){if(1&t&&(pe(0,"tr")(1,"td"),et(2),ye(),pe(3,"td"),et(4),ye(),pe(5,"td"),et(6),ye(),pe(7,"td"),et(8),ye(),pe(9,"td"),et(10),ye()()),2&t){const e=n.$implicit,i=dn();$e(2),wr(e.employee_number),$e(2),wr(e.name),$e(2),ho("",e.model_name," ",e.model_year,""),$e(2),wr(e.performance),$e(2),wr(i.formatEmitions(e))}}let Tae=(()=>{class t{constructor(e){this.report_service=e,this.total_emision_acumulated=0}ngOnInit(){this.report_service.getGlobalEmissions(),this.total_emision_acumulated=0}downloadPDFTest(){const e=new _M;e.text("Hello world!",10,10),e.save("hello-world.pdf")}formatEmitions(e){let s=e.distance/e.performance*2.31*2;return this.total_emision_acumulated=this.total_emision_acumulated+s,s.toFixed(2)}downloadPDF(){let e=document.getElementById("htmlData");const i=new _M("p","pt","a4");IP()(e,{background:"white",scale:4}).then(l=>{const h=l.toDataURL("image/PNG"),E=i.getImageProperties(h),M=i.internal.pageSize.getWidth()-30;return i.addImage(h,"PNG",15,15,M,E.height*M/E.width,void 0,"FAST"),i}).then(l=>{l.save(`${(new Date).toISOString()}_tutorial.pdf`)})}calculateDaysDifference(e,i){const s=new Date(e).getTime(),l=new Date(i).getTime(),h=Math.abs(l-s);return Math.ceil(h/864e5)}formatNumber(e){return e.toFixed(2)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(DP))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-global-emissions"]],decls:24,vars:3,consts:[[1,"container",2,"margin-top","60px"],[1,"col-2"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-download"],["id","htmlData"],[1,"table"],["scope","col"],[4,"ngFor","ngForOf"],[3,"ariaColSpan"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"div",1)(2,"button",2),Tt("click",function(){return s.downloadPDF()}),oi(3,"i",3),et(4,"Descargar "),ye()(),pe(5,"div",4)(6,"table",5)(7,"thead")(8,"tr")(9,"th",6),et(10,"Numero de empleado"),ye(),pe(11,"th",6),et(12,"Nombre"),ye(),pe(13,"th",6),et(14,"Veh\xedculo"),ye(),pe(15,"th",6),et(16," Rendimiento"),ye(),pe(17,"th",6),et(18," Emisiones"),ye()()(),pe(19,"tbody"),En(20,Sae,11,6,"tr",7),pe(21,"tr",8)(22,"b"),et(23),ye()()()()()()),2&i&&($e(20),st("ngForOf",s.report_service.globalCO2emissions),$e(1),st("ariaColSpan",4),$e(2),Er("Total: ",s.formatNumber(s.total_emision_acumulated),""))},dependencies:[Pl]})}return t})();function Iae(t,n){if(1&t&&(pe(0,"tr")(1,"td",19),et(2),ye(),pe(3,"td"),et(4),ye(),pe(5,"td"),et(6),ye(),pe(7,"td"),et(8),ye()()),2&t){const e=n.$implicit,i=dn();$e(2),wr(i.getName(e)),$e(2),ho("",e.model_name," ",e.model_year,""),$e(2),wr(e.performance),$e(2),wr(i.formatEmitionsGlobal(e))}}function Dae(t,n){if(1&t&&(pe(0,"tr")(1,"td",19),et(2),ye(),pe(3,"td"),et(4),ye(),pe(5,"td"),et(6),ye(),pe(7,"td"),et(8),ye()()),2&t){const e=n.$implicit,i=dn();$e(2),wr(i.getName(e)),$e(2),ho("",e.model_name," ",e.model_year,""),$e(2),wr(e.performance),$e(2),wr(i.formatSavedEmitions(e))}}let Bae=(()=>{class t{constructor(e){this.report_service=e,this.global_emision_acumulated=0,this.adjust_emision_acumulated=0,this.total_emision_acumulated=0}ngOnInit(){this.total_emision_acumulated=0}formatSavedEmitions(e){let s=e.distance/e.performance*2.31*2;return 0!=e.tour_detail_id&&(s*=-1),0!=e.tour_vehicle&&0==e.tour_detail_id&&(s*=-1),s.toFixed(2)}calculateTotalSaved(){this.report_service.tourInfo.forEach(e=>{let s=e.distance/e.performance*2.31*2;0!=e.tour_detail_id&&(s*=-1),0!=e.tour_vehicle&&0==e.tour_detail_id&&(s*=-1),this.adjust_emision_acumulated=this.adjust_emision_acumulated+s})}calculateTotalGlobal(){this.report_service.globalCO2emissions.forEach(e=>{let s=e.distance/e.performance*2.31*2;s*=this.total_days+1,this.global_emision_acumulated=this.global_emision_acumulated+s})}formatEmitionsGlobal(e){let s=e.distance/e.performance*2.31*2;return e.tour_id&&(s*=-1),s*=this.total_days+1,s.toFixed(2)}formatNumber(e){return e.toFixed(2)}getName(e){return e.name+" "+e.last_name}searchInfo(){this.total_emision_acumulated=0,this.adjust_emision_acumulated=0,this.global_emision_acumulated=0;let e=this.start.year+"-"+("0"+this.start.month).slice(-2)+"-"+("0"+this.start.day).slice(-2),i=this.end.year+"-"+("0"+this.end.month).slice(-2)+"-"+("0"+this.end.day).slice(-2);new Date(e),new Date(i),this.total_days=this.calculateDaysDifference(e,i),this.report_service.tourInfo=[],this.global_emision_acumulated=0,this.report_service.getTourInfo(e,i).subscribe(h=>{this.report_service.tourInfo=h,this.report_service.getGlobalEmissions().subscribe(m=>{this.report_service.globalCO2emissions=m,this.calculateTotalGlobal()}),this.calculateTotalSaved()})}downloadPDF(){let e=document.getElementById("htmlData");const i=new _M("p","pt","a4");IP()(e,{background:"white",scale:4}).then(l=>{const h=l.toDataURL("image/PNG"),E=i.getImageProperties(h),M=i.internal.pageSize.getWidth()-30;return i.addImage(h,"PNG",15,15,M,E.height*M/E.width,void 0,"FAST"),i}).then(l=>{l.save(`${(new Date).toISOString()}_tutorial.pdf`)})}calculateDaysDifference(e,i){const s=new Date(e).getTime(),l=new Date(i).getTime(),h=Math.abs(l-s);return Math.ceil(h/864e5)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(DP))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-real-emissions"]],decls:53,vars:8,consts:[[1,"row","row-cols-sm-auto",2,"margin-top","60px","margin-left","50px"],[1,"col-5"],[1,"input-group"],["placeholder","yyyy-mm-dd","name","dp-start","ngbDatepicker","",1,"form-control",3,"ngModel","ngModelChange"],["s","ngbDatepicker"],["type","button",1,"btn","btn-outline-secondary","bi","bi-calendar3",3,"click"],["placeholder","yyyy-mm-dd","name","dp-end","ngbDatepicker","",1,"form-control",3,"ngModel","ngModelChange"],["e","ngbDatepicker"],[1,"col-2"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],[1,"container",2,"margin-top","60px"],[1,"fa","fa-download"],["id","htmlData",2,"margin-top","10px"],[1,"table"],[1,"table-active"],["scope","col"],[4,"ngFor","ngForOf"],[3,"ariaColSpan"],[2,"width","250px"]],template:function(i,s){if(1&i){const l=xr();pe(0,"form",0)(1,"div",1)(2,"div",2)(3,"input",3,4),Tt("ngModelChange",function(m){return s.start=m}),ye(),pe(5,"button",5),Tt("click",function(){return ti(l),ni(ws(4).toggle())}),ye()()(),pe(6,"div",1)(7,"div",2)(8,"input",6,7),Tt("ngModelChange",function(m){return s.end=m}),ye(),pe(10,"button",5),Tt("click",function(){return ti(l),ni(ws(9).toggle())}),ye()()(),pe(11,"div",8)(12,"button",9),Tt("click",function(){return s.searchInfo()}),oi(13,"i",10),et(14,"Buscar "),ye()()(),pe(15,"div",11)(16,"div",8)(17,"button",9),Tt("click",function(){return s.downloadPDF()}),oi(18,"i",12),et(19,"Descargar "),ye()(),pe(20,"div",13)(21,"table",14)(22,"thead")(23,"tr",15)(24,"th",16),et(25,"Nombre"),ye(),pe(26,"th",16),et(27,"Veh\xedculo"),ye(),pe(28,"th",16),et(29," Rendimiento"),ye(),pe(30,"th",16),et(31," Emisiones"),ye()()(),pe(32,"tbody"),En(33,Iae,9,5,"tr",17),pe(34,"tr",18),et(35),ye()()(),pe(36,"table",14)(37,"thead")(38,"tr",15)(39,"th",16),et(40,"Nombre"),ye(),pe(41,"th",16),et(42,"Veh\xedculo"),ye(),pe(43,"th",16),et(44," Rendimiento"),ye(),pe(45,"th",16),et(46," Emisiones"),ye()()(),pe(47,"tbody"),En(48,Dae,9,5,"tr",17),pe(49,"tr"),et(50),ye()()(),pe(51,"b"),et(52),ye()()()}2&i&&($e(3),st("ngModel",s.start),$e(5),st("ngModel",s.end),$e(25),st("ngForOf",s.report_service.globalCO2emissions),$e(1),st("ariaColSpan",4),$e(1),Er("Total Global: ",s.formatNumber(s.global_emision_acumulated),""),$e(13),st("ngForOf",s.report_service.tourInfo),$e(2),Er("Ajuste por Recorridos: ",s.formatNumber(s.adjust_emision_acumulated),""),$e(2),Er("Total Real de emisiones: ",s.formatNumber(s.global_emision_acumulated+s.adjust_emision_acumulated),""))},dependencies:[Pl,Ek,Fd,oc,Jc,Md,Qu,xh]})}return t})();function Mae(t,n){if(1&t&&(pe(0,"tr")(1,"td",18),et(2),ye(),pe(3,"td"),et(4),ye(),pe(5,"td"),et(6),ye(),pe(7,"td"),et(8),ye()()),2&t){const e=n.$implicit,i=dn();$e(2),wr(i.getName(e)),$e(2),ho("",e.model_name," ",e.model_year,""),$e(2),wr(e.performance),$e(2),wr(i.formatFuelGlobal(e))}}function Fae(t,n){if(1&t&&(pe(0,"tr")(1,"td",18),et(2),ye(),pe(3,"td"),et(4),ye(),pe(5,"td"),et(6),ye(),pe(7,"td"),et(8),ye()()),2&t){const e=n.$implicit,i=dn();$e(2),wr(i.getName(e)),$e(2),ho("",e.model_name," ",e.model_year,""),$e(2),wr(e.performance),$e(2),wr(i.formatSavedFuel(e))}}const Rae=[{path:"",component:Hre},{path:"home",component:yre},{path:"app-cat-employees",component:EV,canActivate:[oS]},{path:"app-cat-vehicles",component:_re,canActivate:[oS]},{path:"app-cat-models",component:$ie,canActivate:[oS]},{path:"app-stations",component:boe,canActivate:[oS]},{path:"app-routes-list",component:Xie,canActivate:[oS]},{path:"tour",component:Moe,canActivate:[KB]},{path:"app-global-emissions",component:Tae,canActivate:[KB]},{path:"app-real-emissions",component:Bae,canActivate:[KB]},{path:"app-real-fuel",component:(()=>{class t{constructor(e){this.report_service=e,this.global_fuel_acumulated=0,this.adjust_fuel_acumulated=0,this.total_fuel_acumulated=0}ngOnInit(){this.total_fuel_acumulated=0}formatSavedFuel(e){let s=e.distance/e.performance*2;return 0!=e.tour_detail_id&&(s*=-1),0!=e.tour_vehicle&&0==e.tour_detail_id&&(s*=-1),s.toFixed(2)}calculateTotalSaved(){this.adjust_fuel_acumulated=0,this.report_service.tourInfo.forEach(e=>{let s=e.distance/e.performance*2;0!=e.tour_detail_id&&(s*=-1),0!=e.tour_vehicle&&0==e.tour_detail_id&&(s*=-1),this.adjust_fuel_acumulated=this.adjust_fuel_acumulated+s})}calculateTotalGlobal(){this.report_service.globalCO2emissions.forEach(e=>{let s=e.distance/e.performance*2;s*=this.total_days+1,this.global_fuel_acumulated=this.global_fuel_acumulated+s})}formatFuelGlobal(e){let s=e.distance/e.performance*2;return s*=this.total_days+1,s.toFixed(2)}formatNumber(e){return e.toFixed(2)}getName(e){return e.name+" "+e.last_name}searchInfo(){this.total_fuel_acumulated=0,this.adjust_fuel_acumulated=0,this.global_fuel_acumulated=0;let e=this.start.year+"-"+("0"+this.start.month).slice(-2)+"-"+("0"+this.start.day).slice(-2),i=this.end.year+"-"+("0"+this.end.month).slice(-2)+"-"+("0"+this.end.day).slice(-2);new Date(e),new Date(i),this.total_days=this.calculateDaysDifference(e,i),this.report_service.getTourInfo(e,i).subscribe(h=>{this.report_service.tourInfo=h,this.report_service.getGlobalEmissions().subscribe(m=>{this.report_service.globalCO2emissions=m,this.calculateTotalGlobal()}),this.calculateTotalSaved()})}downloadPDF(){let e=document.getElementById("htmlData");const i=new _M("p","pt","a4");IP()(e,{background:"white",scale:4}).then(l=>{const h=l.toDataURL("image/PNG"),E=i.getImageProperties(h),M=i.internal.pageSize.getWidth()-30;return i.addImage(h,"PNG",15,15,M,E.height*M/E.width,void 0,"FAST"),i}).then(l=>{l.save(`${(new Date).toISOString()}_tutorial.pdf`)})}calculateDaysDifference(e,i){const s=new Date(e).getTime(),l=new Date(i).getTime(),h=Math.abs(l-s);return Math.ceil(h/864e5)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(DP))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-real-fuel"]],decls:53,vars:8,consts:[[1,"row","row-cols-sm-auto",2,"margin-top","60px","margin-left","50px"],[1,"col-5"],[1,"input-group"],["placeholder","yyyy-mm-dd","name","dp-start","ngbDatepicker","",1,"form-control",3,"ngModel","ngModelChange"],["s","ngbDatepicker"],["type","button",1,"btn","btn-outline-secondary","bi","bi-calendar3",3,"click"],["placeholder","yyyy-mm-dd","name","dp-end","ngbDatepicker","",1,"form-control",3,"ngModel","ngModelChange"],["e","ngbDatepicker"],[1,"col-2"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],[1,"container",2,"margin-top","60px"],[1,"fa","fa-download"],["id","htmlData"],[1,"table"],["scope","col"],[4,"ngFor","ngForOf"],[3,"ariaColSpan"],[2,"width","250px"]],template:function(i,s){if(1&i){const l=xr();pe(0,"form",0)(1,"div",1)(2,"div",2)(3,"input",3,4),Tt("ngModelChange",function(m){return s.start=m}),ye(),pe(5,"button",5),Tt("click",function(){return ti(l),ni(ws(4).toggle())}),ye()()(),pe(6,"div",1)(7,"div",2)(8,"input",6,7),Tt("ngModelChange",function(m){return s.end=m}),ye(),pe(10,"button",5),Tt("click",function(){return ti(l),ni(ws(9).toggle())}),ye()()(),pe(11,"div",8)(12,"button",9),Tt("click",function(){return s.searchInfo()}),oi(13,"i",10),et(14,"Buscar "),ye()()(),pe(15,"div",11)(16,"div",8)(17,"button",9),Tt("click",function(){return s.downloadPDF()}),oi(18,"i",12),et(19,"Descargar "),ye()(),pe(20,"div",13)(21,"table",14)(22,"thead")(23,"tr")(24,"th",15),et(25,"Nombre"),ye(),pe(26,"th",15),et(27,"Veh\xedculo"),ye(),pe(28,"th",15),et(29," Rendimiento"),ye(),pe(30,"th",15),et(31," fuel"),ye()()(),pe(32,"tbody"),En(33,Mae,9,5,"tr",16),pe(34,"tr",17),et(35),ye()()(),pe(36,"table",14)(37,"thead")(38,"tr")(39,"th",15),et(40,"Nombre"),ye(),pe(41,"th",15),et(42,"Veh\xedculo"),ye(),pe(43,"th",15),et(44," Rendimiento"),ye(),pe(45,"th",15),et(46," Combustible"),ye()()(),pe(47,"tbody"),En(48,Fae,9,5,"tr",16),pe(49,"tr"),et(50),ye()()(),pe(51,"b"),et(52),ye()()()}2&i&&($e(3),st("ngModel",s.start),$e(5),st("ngModel",s.end),$e(25),st("ngForOf",s.report_service.globalCO2emissions),$e(1),st("ariaColSpan",4),$e(1),Er("Total Global: ",s.formatNumber(s.global_fuel_acumulated),""),$e(13),st("ngForOf",s.report_service.tourInfo),$e(2),Er("Ajuste por Recorridos: ",s.formatNumber(s.adjust_fuel_acumulated),""),$e(2),Er("Total Real de Combustible: ",s.formatNumber(s.global_fuel_acumulated+s.adjust_fuel_acumulated),""))},dependencies:[Pl,Ek,Fd,oc,Jc,Md,Qu,xh]})}return t})(),canActivate:[KB]}];let Oae=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({imports:[a6.forRoot(Rae),a6]})}return t})();function kae(t,n){1&t&&oi(0,"img",22)}function Pae(t,n){1&t&&oi(0,"img",23)}const Nae=function(){return["/configuration"]},Lae=function(){return["/app-cat-models"]},Uae=function(){return{child:"3"}},zae=function(){return["/app-cat-vehicles"]},Vae=function(){return{child:"2"}},Hae=function(){return["/app-cat-employees"]},nb=function(){return{child:"1"}};function Qae(t,n){1&t&&(pe(0,"div",12)(1,"div",8)(2,"div",9),oi(3,"img",24),ye(),pe(4,"div",2),et(5,"Catalogos"),ye()(),pe(6,"div",14)(7,"div",7)(8,"div",15)(9,"div",9),oi(10,"img",25),ye(),pe(11,"div",2),et(12,"Modelos"),ye()()(),pe(13,"div",7)(14,"div",15)(15,"div",9),oi(16,"img",26),ye(),pe(17,"div",2),et(18,"Vehiculos"),ye()()(),pe(19,"div",7)(20,"div",15)(21,"div",9),oi(22,"img",27),ye(),pe(23,"div",2),et(24,"Empleados"),ye()()()()()),2&t&&($e(1),st("routerLink",Cc(11,Nae))("routerLinkActive","active"),$e(7),st("routerLink",Cc(12,Lae))("queryParams",Cc(13,Uae))("routerLinkActive","active"),$e(6),st("routerLink",Cc(14,zae))("queryParams",Cc(15,Vae))("routerLinkActive","active"),$e(6),st("routerLink",Cc(16,Hae))("queryParams",Cc(17,nb))("routerLinkActive","active"))}const jae=function(){return["/app-stations"]},Gae=function(){return["/app-routes-list"]};function $ae(t,n){1&t&&(pe(0,"div",12)(1,"div",6)(2,"div",9),oi(3,"img",28),ye(),pe(4,"div",2),et(5,"Rutas"),ye()(),pe(6,"div",14)(7,"div",7)(8,"div",15)(9,"div",9),oi(10,"img",29),ye(),pe(11,"div",2),et(12,"Estaciones"),ye()()()(),pe(13,"div",14)(14,"div",7)(15,"div",15)(16,"div",9),oi(17,"img",30),ye(),pe(18,"div",2),et(19,"Rutas"),ye()()()()()),2&t&&($e(8),st("routerLink",Cc(6,jae))("queryParams",Cc(7,nb))("routerLinkActive","active"),$e(7),st("routerLink",Cc(8,Gae))("queryParams",Cc(9,nb))("routerLinkActive","active"))}const qae=function(t){return{expanded:t}},Kae=function(){return["/home"]},Wae=function(){return["/tour"]},Zae=function(){return["/app-global-emissions"]},Xae=function(){return["/app-real-emissions"]},Yae=function(){return["/app-real-fuel"]};let Jae=(()=>{class t{constructor(e){this.user_service=e,this.isExpanded=!1,this.toggleSidebar=new vi,this.handleSidebarToggle=()=>this.toggleSidebar.emit(!this.isExpanded)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(q1))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-sidebar"]],inputs:{isExpanded:"isExpanded"},outputs:{toggleSidebar:"toggleSidebar"},decls:56,vars:30,consts:[[1,"sidebar",3,"ngClass"],[1,"header"],[1,"title"],[1,"toggle",3,"click"],["class","image","alt","bimtrazer-logo","src","assets/icons/icons8-close-20.png",4,"ngIf"],["class","image","alt","bimtrazer-logo","src","assets/icons/icons8-menu-40.png",4,"ngIf"],[1,"content"],[1,"link"],[1,"content",3,"routerLink","routerLinkActive"],[1,"icon"],["alt","bimtrazer-logo","src","assets/icons/icons8-home-26.png",1,"image"],["class","link with-children",4,"ngIf"],[1,"link","with-children"],["alt","bimtrazer-logo","src","assets/icons/icons8-tour-26.png",1,"image"],[1,"children"],[1,"content",3,"routerLink","queryParams","routerLinkActive"],["alt","bimtrazer-logo","src","assets/icons/icons8-start-route-26.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-reports-26.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-co2-26.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-co2-emissions-26.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-fuel-26.png",1,"image"],[1,"footer"],["alt","bimtrazer-logo","src","assets/icons/icons8-close-20.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-menu-40.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-catalog-26.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-model-26.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-vehicle-26.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-employee-26.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-path-26.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-place-26.png",1,"image"],["alt","bimtrazer-logo","src","assets/icons/icons8-route-26.png",1,"image"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"div",1),oi(2,"h1",2),pe(3,"div",3),Tt("click",function(){return s.handleSidebarToggle()}),En(4,kae,1,0,"img",4),En(5,Pae,1,0,"img",5),ye()(),pe(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),oi(10,"img",10),ye(),pe(11,"div",2),et(12,"Home"),ye()()(),En(13,Qae,25,18,"div",11),En(14,$ae,20,10,"div",11),pe(15,"div",12)(16,"div",6)(17,"div",9),oi(18,"img",13),ye(),pe(19,"div",2),et(20,"Recorrido"),ye()(),pe(21,"div",14)(22,"div",7)(23,"div",15)(24,"div",9),oi(25,"img",16),ye(),pe(26,"div",2),et(27,"Reccorrido"),ye()()()()(),pe(28,"div",12)(29,"div",6)(30,"div",9),oi(31,"img",17),ye(),pe(32,"div",2),et(33,"Reportes"),ye()(),pe(34,"div",14)(35,"div",7)(36,"div",15)(37,"div",9),oi(38,"img",18),ye(),pe(39,"div",2),et(40,"Emisiones globales"),ye()()()(),pe(41,"div",14)(42,"div",7)(43,"div",15)(44,"div",9),oi(45,"img",19),ye(),pe(46,"div",2),et(47,"Emisiones Reales"),ye()()()(),pe(48,"div",14)(49,"div",7)(50,"div",15)(51,"div",9),oi(52,"img",20),ye(),pe(53,"div",2),et(54,"Combustible"),ye()()()(),oi(55,"div",21),ye()()()),2&i&&(st("ngClass",C1(19,qae,s.isExpanded)),$e(4),st("ngIf",s.isExpanded),$e(1),st("ngIf",!s.isExpanded),$e(3),st("routerLink",Cc(21,Kae))("routerLinkActive","active"),$e(5),st("ngIf",1==s.user_service.userType),$e(1),st("ngIf",1==s.user_service.userType),$e(9),st("routerLink",Cc(22,Wae))("queryParams",Cc(23,nb))("routerLinkActive","active"),$e(13),st("routerLink",Cc(24,Zae))("queryParams",Cc(25,nb))("routerLinkActive","active"),$e(7),st("routerLink",Cc(26,Xae))("queryParams",Cc(27,nb))("routerLinkActive","active"),$e(7),st("routerLink",Cc(28,Yae))("queryParams",Cc(29,nb))("routerLinkActive","active"))},dependencies:[VR,Xh,iB,JU],styles:['.chevron[_ngcontent-%COMP%]:before{border-style:solid;border-width:.15em .15em 0 0;content:"";display:inline-block;height:.35em;left:.15em;position:relative;top:.3em;vertical-align:top;width:.35em}.sidebar[_ngcontent-%COMP%]{position:fixed;left:0;top:0;height:100vh;transition:.3s;width:60px;background:#1d1e2c;color:#6d6e7e}.sidebar.expanded[_ngcontent-%COMP%]{width:200px}.sidebar.expanded[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .sidebar.expanded[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{margin-left:0}.sidebar.expanded[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]:before{transform:rotate(-135deg)}.sidebar.expanded[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{max-width:100px}.sidebar.expanded[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-right:3px}.sidebar.expanded[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .children[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding-left:30px}.sidebar[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:10px;background:#0f1017}.sidebar[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px;color:#6d6e7e;flex:1;transition:.3s;margin:0 0 0 -100px}.sidebar[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{color:#6d6e7e;cursor:pointer;transition:.3s;margin-left:-25px;padding:10px;min-width:20px;height:20px;display:block;text-align:center}.sidebar[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]:before{transition:.3s;transform:rotate(45deg)}.sidebar[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]:hover{color:#fff}.sidebar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .children[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{background:#27283a;padding-left:10px}.sidebar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .children[_ngcontent-%COMP%]   .content.active[_ngcontent-%COMP%]{background:#191a27}.sidebar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:10px;cursor:pointer;transition:.3s}.sidebar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:hover{background:#0f1017}.sidebar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:hover   .title[_ngcontent-%COMP%]{color:#fff}.sidebar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{fill:#fff}.sidebar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .content.active[_ngcontent-%COMP%]{background:#0f1017}.sidebar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .content.active[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#fff}.sidebar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{flex:0 0 30px;display:flex;align-items:center;justify-content:center;margin-right:0}.sidebar[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:1;color:#6d6e7e;transition:.3s;max-width:0px;overflow:hidden}']})}return t})();function ele(t,n){if(1&t&&(pe(0,"label",2),et(1),ye()),2&t){const e=dn();$e(1),Er("Ruta: ",e.employee_service.employee_info.route_name,"")}}const tle=function(t){return{sidebarExpanded:t}};let nle=(()=>{class t{constructor(e,i){this.office_service=e,this.employee_service=i,this.title="eco-car-sharing",this.sidebarExpanded=!0,this.office_service.getOffice()}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(ZE),Ve(Hy))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-root"]],decls:13,vars:7,consts:[[3,"isExpanded","toggleSidebar"],[1,"content",2,"margin-left","250px",3,"ngClass"],["for",""],["for","",4,"ngIf"]],template:function(i,s){1&i&&(pe(0,"app-sidebar",0),Tt("toggleSidebar",function(){return s.sidebarExpanded=!s.sidebarExpanded}),ye(),pe(1,"div",1)(2,"b")(3,"label",2),et(4),ye()(),et(5,"\xa0 "),pe(6,"b")(7,"label",2),et(8),ye()(),et(9,"\xa0 "),pe(10,"b"),En(11,ele,2,1,"label",3),ye(),oi(12,"router-outlet"),ye()),2&i&&(st("isExpanded",s.sidebarExpanded),$e(1),st("ngClass",C1(5,tle,s.sidebarExpanded)),$e(3),Er("Empleado: ",s.employee_service.employee_info.employee_name,""),$e(4),Er("Numero: ",s.employee_service.employee_info.employee_number,""),$e(3),st("ngIf",s.employee_service.employee_info.vehicle_route_id))},dependencies:[VR,Xh,vO,Jae],styles:[".content[_ngcontent-%COMP%]{margin-left:100px;transition:.3s}.content.sidebarExpanded[_ngcontent-%COMP%]{margin-left:160px}.form_row[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"]})}return t})();const Zy=new Hr(Sa),rle={connector:()=>new Li};function bQ(t,n=rle){const{connector:e}=n;return Xs((i,s)=>{const l=e();gn(t(function ile(t){return new Hr(n=>t.subscribe(n))}(l))).subscribe(s),s.add(i.subscribe(l))})}const AS="Service workers are disabled or not supported by this browser";class yM{constructor(n){if(this.serviceWorker=n,n){const i=Ba(n,"controllerchange").pipe(Ht(()=>n.controller)),l=tx(UD(()=>Bi(n.controller)),i);this.worker=l.pipe(Io(M=>!!M)),this.registration=this.worker.pipe(cl(()=>n.getRegistration()));const E=Ba(n,"message").pipe(Ht(M=>M.data)).pipe(Io(M=>M&&M.type)).pipe(function ole(t){return t?n=>bQ(t)(n):n=>function sle(t,n){const e=qr(t)?t:()=>t;return qr(n)?bQ(n,{connector:e}):i=>new oO(i,e)}(new Li)(n)}());E.connect(),this.events=E}else this.worker=this.events=this.registration=function ale(t){return UD(()=>l0(new Error(t)))}(AS)}postMessage(n,e){return this.worker.pipe(Xo(1),sc(i=>{i.postMessage({action:n,...e})})).toPromise().then(()=>{})}postMessageWithOperation(n,e,i){const s=this.waitForOperationCompleted(i),l=this.postMessage(n,e);return Promise.all([l,s]).then(([,h])=>h)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let e;return e="string"==typeof n?i=>i.type===n:i=>n.includes(i.type),this.events.pipe(Io(e))}nextEventOfType(n){return this.eventsOfType(n).pipe(Xo(1))}waitForOperationCompleted(n){return this.eventsOfType("OPERATION_COMPLETED").pipe(Io(e=>e.nonce===n),Xo(1),Ht(e=>{if(void 0!==e.result)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let wQ=(()=>{class t{get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,this.pushManager=null,this.subscriptionChanges=new Li,!e.isEnabled)return this.messages=Zy,this.notificationClicks=Zy,void(this.subscription=Zy);this.messages=this.sw.eventsOfType("PUSH").pipe(Ht(s=>s.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(Ht(s=>s.data)),this.pushManager=this.sw.registration.pipe(Ht(s=>s.pushManager));const i=this.pushManager.pipe(cl(s=>s.getSubscription()));this.subscription=so(i,this.subscriptionChanges)}requestSubscription(e){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(AS));const i={userVisibleOnly:!0};let s=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),l=new Uint8Array(new ArrayBuffer(s.length));for(let h=0;h<s.length;h++)l[h]=s.charCodeAt(h);return i.applicationServerKey=l,this.pushManager.pipe(cl(h=>h.subscribe(i)),Xo(1)).toPromise().then(h=>(this.subscriptionChanges.next(h),h))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(Xo(1),cl(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(s=>{if(!s)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(AS))}decodeBase64(e){return atob(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(yM))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})(),xQ=(()=>{class t{get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=Zy,this.available=Zy,this.activated=Zy,void(this.unrecoverable=Zy);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.available=this.versionUpdates.pipe(Io(i=>"VERSION_READY"===i.type),Ht(i=>({type:"UPDATE_AVAILABLE",current:i.currentVersion,available:i.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(AS));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(AS));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(yM))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();const CQ=new pi("NGSW_REGISTER_SCRIPT");function lle(t,n,e,i){return()=>{if(!OD(i)||!("serviceWorker"in navigator)||!1===e.enabled)return;let s;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof e.registrationStrategy)s=e.registrationStrategy();else{const[h,...m]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(h){case"registerImmediately":s=Bi(null);break;case"registerWithDelay":s=EQ(+m[0]||0);break;case"registerWhenStable":s=m[0]?so(SQ(t),EQ(+m[0])):SQ(t);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}t.get(Wi).runOutsideAngular(()=>s.pipe(Xo(1)).subscribe(()=>navigator.serviceWorker.register(n,{scope:e.scope}).catch(h=>console.error("Service worker registration failed with:",h))))}}function EQ(t){return Bi(null).pipe(EE(t))}function SQ(t){return t.get(Fm).isStable.pipe(Io(e=>e))}function cle(t,n){return new yM(OD(n)&&!1!==t.enabled?navigator.serviceWorker:void 0)}class BP{}function ule(t,n={}){return ny([wQ,xQ,{provide:CQ,useValue:t},{provide:BP,useValue:n},{provide:yM,useFactory:cle,deps:[BP,Uu]},{provide:AD,useFactory:lle,deps:[Zc,CQ,BP,Uu],multi:!0}])}let hle=(()=>{class t{static register(e,i={}){return{ngModule:t,providers:[ule(e,i)]}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({providers:[wQ,xQ]})}return t})();function dle(t,n){if(1&t){const e=xr();pe(0,"tr")(1,"th",16),et(2),ye(),pe(3,"td"),oi(4,"ngb-highlight",17),ye(),pe(5,"td"),oi(6,"ngb-highlight",17),ye(),pe(7,"td"),oi(8,"ngb-highlight",17),ye(),pe(9,"td")(10,"a",18),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().emitUpdate(l))}),oi(11,"i",19),ye(),pe(12,"a",20),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().emitRemove(l))}),oi(13,"i",21),ye(),pe(14,"a",20),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().emitUser(l))}),oi(15,"i",22),ye()()()}if(2&t){const e=n.$implicit,i=dn();$e(2),wr(e.employee_number),$e(2),st("result",e.name)("term",i.filter.value),$e(2),st("result",e.last_name)("term",i.filter.value),$e(2),st("result",e.mother_lastname)("term",i.filter.value)}}let Ale=(()=>{class t{constructor(e,i){this.employee_service=i,this.modalService=In(hg),this.closeResult="",this.onAddClick=new vi,this.onUpdateClick=new vi,this.onRemoveClick=new vi,this.onUserClick=new vi,this.i=1,this.filter=new F1("",{nonNullable:!0}),this.totalItems=0,this.page=1,this.showPagination=!0,this.employees_=this.filter.valueChanges.pipe(T1(""),Ht(s=>function fle(t,n){return this.employees.filter(e=>{const i=t.toLowerCase();return e.name.toLowerCase().includes(i)||n.transform(e.last_name).includes(i)||n.transform(e.mother_lastname).includes(i)})}(s,e))),this.totalItems=this.employee_service.employee_list.length}ngOnInit(){this.employee_service.getEmployees()}filterTable(){if(console.log(this.search),this.page=1,""!=this.search){let e=this.employee_service.employee_list.filter(i=>i.name.toUpperCase().includes(this.search.toUpperCase()));this.employee_service.employee_list_page=e.slice((this.page-1)*this.employee_service.pageSize,(this.page-1)*this.employee_service.pageSize+this.employee_service.pageSize)}else this.refreshEmployees()}refreshEmployees(){this.employee_service.employee_list_page=this.employee_service.employee_list.slice((this.page-1)*this.employee_service.pageSize,(this.page-1)*this.employee_service.pageSize+this.employee_service.pageSize)}getDismissReason(e){switch(e){case Yl.ESC:return"by pressing ESC";case Yl.BACKDROP_CLICK:return"by clicking on a backdrop";default:return`with: ${e}`}}emitAdd(){this.onAddClick.emit("new")}emitUpdate(e){this.employee_service.selected_employee=e,this.onUpdateClick.emit(e)}emitRemove(e){this.onRemoveClick.emit(e)}emitUser(e){this.onUserClick.emit(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(ex),Ve(Hy))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-employe-list"]],inputs:{employees:"employees",content:"content"},outputs:{onAddClick:"onAddClick",onUpdateClick:"onUpdateClick",onRemoveClick:"onRemoveClick",onUserClick:"onUserClick"},decls:33,vars:5,consts:[[1,"container",2,"margin-top","60px"],[1,"mb-3","row"],["for","filter_search",1,"col-xs-3","col-sm-auto","col-form-label"],[1,"col-xs-3","col-sm-auto"],["id","filter_search","type","text","name","filter_search",1,"form-control",3,"ngModel","ngModelChange"],["filter_search","ngModel"],[1,"col-2"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],[1,"fas","fa-plus-circle"],[1,"table","table-striped"],["scope","col"],[4,"ngFor","ngForOf"],["colspan","5",2,"text-align","center"],[1,"d-flex","justify-content-between","p-2"],[3,"collectionSize","page","pageSize","pageChange"],["scope","row"],[3,"result","term"],[1,"btn","btn-secondary","text-white",3,"click"],[1,"far","fa-edit"],[1,"btn","btn-danger","text-white",3,"click"],[1,"fas","fa-trash-alt"],[1,"fa","fa-user"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"form")(2,"div",1)(3,"label",2),et(4,"Full text search:"),ye(),pe(5,"div",3)(6,"input",4,5),Tt("ngModelChange",function(h){return s.search=h}),ye()(),pe(8,"div",6)(9,"button",7),Tt("click",function(){return s.filterTable()}),oi(10,"i",8),ye()(),pe(11,"div",6)(12,"button",7),Tt("click",function(){return s.emitAdd()}),oi(13,"i",9),et(14,"Nuevo "),ye()()()(),pe(15,"table",10)(16,"thead")(17,"tr")(18,"th",11),et(19,"#"),ye(),pe(20,"th",11),et(21,"Nombre"),ye(),pe(22,"th",11),et(23," Apellido Paterno "),ye(),pe(24,"th",11),et(25,"Apellido Materno"),ye()()(),pe(26,"tbody"),En(27,dle,16,7,"tr",12),pe(28,"tr")(29,"td",13),et(30,"Lista de Empleados"),ye()()()(),pe(31,"div",14)(32,"ngb-pagination",15),Tt("pageChange",function(h){return s.page=h})("pageChange",function(){return s.refreshEmployees()}),ye()()()),2&i&&($e(6),st("ngModel",s.search),$e(21),st("ngForOf",s.employee_service.employee_list_page),$e(5),st("collectionSize",s.employee_service.employee_list.length)("page",s.page)("pageSize",10))},dependencies:[Pl,Rk,GE,Fd,oc,Jc,Md,Qu,xh],styles:[".my-class[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{max-width:80%;width:80%}"]})}return t})();class TQ{}class ple{}const p0="*";function IQ(t,n=null){return{type:2,steps:t,options:n}}function DQ(t){return{type:6,styles:t,offset:null}}class pS{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class BQ{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,i=0,s=0;const l=this.players.length;0==l?queueMicrotask(()=>this._onFinish()):this.players.forEach(h=>{h.onDone(()=>{++e==l&&this._onFinish()}),h.onDestroy(()=>{++i==l&&this._onDestroy()}),h.onStart(()=>{++s==l&&this._onStart()})}),this.totalTime=this.players.reduce((h,m)=>Math.max(h,m.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(i=>{const s=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(s)})}getPosition(){const n=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}function MQ(t){return new ln(3e3,!1)}function Xy(t){switch(t.length){case 0:return new pS;case 1:return t[0];default:return new BQ(t)}}function FQ(t,n,e=new Map,i=new Map){const s=[],l=[];let h=-1,m=null;if(n.forEach(b=>{const E=b.get("offset"),M=E==h,L=M&&m||new Map;b.forEach((G,V)=>{let ne=V,re=G;if("offset"!==V)switch(ne=t.normalizePropertyName(ne,s),re){case"!":re=e.get(V);break;case p0:re=i.get(V);break;default:re=t.normalizeStyleValue(V,ne,re,s)}L.set(ne,re)}),M||l.push(L),m=L,h=E}),s.length)throw function Lle(t){return new ln(3502,!1)}();return l}function FP(t,n,e,i){switch(n){case"start":t.onStart(()=>i(e&&RP(e,"start",t)));break;case"done":t.onDone(()=>i(e&&RP(e,"done",t)));break;case"destroy":t.onDestroy(()=>i(e&&RP(e,"destroy",t)))}}function RP(t,n,e){const l=OP(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),h=t._data;return null!=h&&(l._data=h),l}function OP(t,n,e,i,s="",l=0,h){return{element:t,triggerName:n,fromState:e,toState:i,phaseName:s,totalTime:l,disabled:!!h}}function _A(t,n,e){let i=t.get(n);return i||t.set(n,i=e),i}function RQ(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}const Zle=(()=>typeof document>"u"?null:document.documentElement)();function kP(t){const n=t.parentNode||t.host||null;return n===Zle?null:n}let ib=null,OQ=!1;function kQ(t,n){for(;n;){if(n===t)return!0;n=kP(n)}return!1}function PQ(t,n,e){if(e)return Array.from(t.querySelectorAll(n));const i=t.querySelector(n);return i?[i]:[]}let NQ=(()=>{class t{validateStyleProperty(e){return function Yle(t){ib||(ib=function Jle(){return typeof document<"u"?document.body:null}()||{},OQ=!!ib.style&&"WebkitAppearance"in ib.style);let n=!0;return ib.style&&!function Xle(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in ib.style,!n&&OQ&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in ib.style)),n}(e)}matchesElement(e,i){return!1}containsElement(e,i){return kQ(e,i)}getParentElement(e){return kP(e)}query(e,i,s){return PQ(e,i,s)}computeStyle(e,i,s){return s||""}animate(e,i,s,l,h,m=[],b){return new pS(s,l)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})(),PP=(()=>{class t{static#e=this.NOOP=new NQ}return t})();const ece=1e3,NP="ng-enter",vM="ng-leave",bM="ng-trigger",wM=".ng-trigger",UQ="ng-animating",LP=".ng-animating";function g0(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:UP(parseFloat(n[1]),n[2])}function UP(t,n){return"s"===n?t*ece:t}function xM(t,n,e){return t.hasOwnProperty("duration")?t:function nce(t,n,e){let s,l=0,h="";if("string"==typeof t){const m=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===m)return n.push(MQ()),{duration:0,delay:0,easing:""};s=UP(parseFloat(m[1]),m[2]);const b=m[3];null!=b&&(l=UP(parseFloat(b),m[4]));const E=m[5];E&&(h=E)}else s=t;if(!e){let m=!1,b=n.length;s<0&&(n.push(function gle(){return new ln(3100,!1)}()),m=!0),l<0&&(n.push(function mle(){return new ln(3101,!1)}()),m=!0),m&&n.splice(b,0,MQ())}return{duration:s,delay:l,easing:h}}(t,n,e)}function gS(t,n={}){return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function zQ(t){const n=new Map;return Object.keys(t).forEach(e=>{n.set(e,t[e])}),n}function Yy(t,n=new Map,e){if(e)for(let[i,s]of e)n.set(i,s);for(let[i,s]of t)n.set(i,s);return n}function jm(t,n,e){n.forEach((i,s)=>{const l=VP(s);e&&!e.has(s)&&e.set(s,t.style[l]),t.style[l]=i})}function rb(t,n){n.forEach((e,i)=>{const s=VP(i);t.style[s]=""})}function mS(t){return Array.isArray(t)?1==t.length?t[0]:IQ(t):t}const zP=new RegExp("{{\\s*(.+?)\\s*}}","g");function HQ(t){let n=[];if("string"==typeof t){let e;for(;e=zP.exec(t);)n.push(e[1]);zP.lastIndex=0}return n}function _S(t,n,e){const i=t.toString(),s=i.replace(zP,(l,h)=>{let m=n[h];return null==m&&(e.push(function yle(t){return new ln(3003,!1)}()),m=""),m.toString()});return s==i?t:s}function CM(t){const n=[];let e=t.next();for(;!e.done;)n.push(e.value),e=t.next();return n}const sce=/-+([a-z0-9])/g;function VP(t){return t.replace(sce,(...n)=>n[1].toUpperCase())}function yA(t,n,e){switch(n.type){case 7:return t.visitTrigger(n,e);case 0:return t.visitState(n,e);case 1:return t.visitTransition(n,e);case 2:return t.visitSequence(n,e);case 3:return t.visitGroup(n,e);case 4:return t.visitAnimate(n,e);case 5:return t.visitKeyframes(n,e);case 6:return t.visitStyle(n,e);case 8:return t.visitReference(n,e);case 9:return t.visitAnimateChild(n,e);case 10:return t.visitAnimateRef(n,e);case 11:return t.visitQuery(n,e);case 12:return t.visitStagger(n,e);default:throw function vle(t){return new ln(3004,!1)}()}}function QQ(t,n){return window.getComputedStyle(t)[n]}const EM="*";function lce(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function cce(t,n,e){if(":"==t[0]){const b=function uce(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return n.push(function Ole(t){return new ln(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof b)return void n.push(b);t=b}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function Rle(t){return new ln(3015,!1)}()),n;const s=i[1],l=i[2],h=i[3];n.push(jQ(s,h));"<"==l[0]&&!(s==EM&&h==EM)&&n.push(jQ(h,s))}(i,e,n)):e.push(t),e}const SM=new Set(["true","1"]),TM=new Set(["false","0"]);function jQ(t,n){const e=SM.has(t)||TM.has(t),i=SM.has(n)||TM.has(n);return(s,l)=>{let h=t==EM||t==s,m=n==EM||n==l;return!h&&e&&"boolean"==typeof s&&(h=s?SM.has(t):TM.has(t)),!m&&i&&"boolean"==typeof l&&(m=l?SM.has(n):TM.has(n)),h&&m}}const hce=new RegExp("s*:selfs*,?","g");function HP(t,n,e,i){return new dce(t).build(n,e,i)}class dce{constructor(n){this._driver=n}build(n,e,i){const s=new pce(e);return this._resetContextStyleTimingState(s),yA(this,mS(n),s)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let i=e.queryCount=0,s=e.depCount=0;const l=[],h=[];return"@"==n.name.charAt(0)&&e.errors.push(function wle(){return new ln(3006,!1)}()),n.definitions.forEach(m=>{if(this._resetContextStyleTimingState(e),0==m.type){const b=m,E=b.name;E.toString().split(/\s*,\s*/).forEach(M=>{b.name=M,l.push(this.visitState(b,e))}),b.name=E}else if(1==m.type){const b=this.visitTransition(m,e);i+=b.queryCount,s+=b.depCount,h.push(b)}else e.errors.push(function xle(){return new ln(3007,!1)}())}),{type:7,name:n.name,states:l,transitions:h,queryCount:i,depCount:s,options:null}}visitState(n,e){const i=this.visitStyle(n.styles,e),s=n.options&&n.options.params||null;if(i.containsDynamicStyles){const l=new Set,h=s||{};i.styles.forEach(m=>{m instanceof Map&&m.forEach(b=>{HQ(b).forEach(E=>{h.hasOwnProperty(E)||l.add(E)})})}),l.size&&(CM(l.values()),e.errors.push(function Cle(t,n){return new ln(3008,!1)}()))}return{type:0,name:n.name,style:i,options:s?{params:s}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const i=yA(this,mS(n.animation),e);return{type:1,matchers:lce(n.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:sb(n.options)}}visitSequence(n,e){return{type:2,steps:n.steps.map(i=>yA(this,i,e)),options:sb(n.options)}}visitGroup(n,e){const i=e.currentTime;let s=0;const l=n.steps.map(h=>{e.currentTime=i;const m=yA(this,h,e);return s=Math.max(s,e.currentTime),m});return e.currentTime=s,{type:3,steps:l,options:sb(n.options)}}visitAnimate(n,e){const i=function mce(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return QP(xM(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(l=>"{"==l.charAt(0)&&"{"==l.charAt(1))){const l=QP(0,0,"");return l.dynamic=!0,l.strValue=e,l}const s=xM(e,n);return QP(s.duration,s.delay,s.easing)}(n.timings,e.errors);e.currentAnimateTimings=i;let s,l=n.styles?n.styles:DQ({});if(5==l.type)s=this.visitKeyframes(l,e);else{let h=n.styles,m=!1;if(!h){m=!0;const E={};i.easing&&(E.easing=i.easing),h=DQ(E)}e.currentTime+=i.duration+i.delay;const b=this.visitStyle(h,e);b.isEmptyStep=m,s=b}return e.currentAnimateTimings=null,{type:4,timings:i,style:s,options:null}}visitStyle(n,e){const i=this._makeStyleAst(n,e);return this._validateStyleAst(i,e),i}_makeStyleAst(n,e){const i=[],s=Array.isArray(n.styles)?n.styles:[n.styles];for(let m of s)"string"==typeof m?m===p0?i.push(m):e.errors.push(new ln(3002,!1)):i.push(zQ(m));let l=!1,h=null;return i.forEach(m=>{if(m instanceof Map&&(m.has("easing")&&(h=m.get("easing"),m.delete("easing")),!l))for(let b of m.values())if(b.toString().indexOf("{{")>=0){l=!0;break}}),{type:6,styles:i,easing:h,offset:n.offset,containsDynamicStyles:l,options:null}}_validateStyleAst(n,e){const i=e.currentAnimateTimings;let s=e.currentTime,l=e.currentTime;i&&l>0&&(l-=i.duration+i.delay),n.styles.forEach(h=>{"string"!=typeof h&&h.forEach((m,b)=>{const E=e.collectedStyles.get(e.currentQuerySelector),M=E.get(b);let L=!0;M&&(l!=s&&l>=M.startTime&&s<=M.endTime&&(e.errors.push(function Sle(t,n,e,i,s){return new ln(3010,!1)}()),L=!1),l=M.startTime),L&&E.set(b,{startTime:l,endTime:s}),e.options&&function rce(t,n,e){const i=n.params||{},s=HQ(t);s.length&&s.forEach(l=>{i.hasOwnProperty(l)||e.push(function _le(t){return new ln(3001,!1)}())})}(m,e.options,e.errors)})})}visitKeyframes(n,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function Tle(){return new ln(3011,!1)}()),i;let l=0;const h=[];let m=!1,b=!1,E=0;const M=n.steps.map(fe=>{const he=this._makeStyleAst(fe,e);let Ne=null!=he.offset?he.offset:function gce(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(he.styles),We=0;return null!=Ne&&(l++,We=he.offset=Ne),b=b||We<0||We>1,m=m||We<E,E=We,h.push(We),he});b&&e.errors.push(function Ile(){return new ln(3012,!1)}()),m&&e.errors.push(function Dle(){return new ln(3200,!1)}());const L=n.steps.length;let G=0;l>0&&l<L?e.errors.push(function Ble(){return new ln(3202,!1)}()):0==l&&(G=1/(L-1));const V=L-1,ne=e.currentTime,re=e.currentAnimateTimings,de=re.duration;return M.forEach((fe,he)=>{const Ne=G>0?he==V?1:G*he:h[he],We=Ne*de;e.currentTime=ne+re.delay+We,re.duration=We,this._validateStyleAst(fe,e),fe.offset=Ne,i.styles.push(fe)}),i}visitReference(n,e){return{type:8,animation:yA(this,mS(n.animation),e),options:sb(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:9,options:sb(n.options)}}visitAnimateRef(n,e){return{type:10,animation:this.visitReference(n.animation,e),options:sb(n.options)}}visitQuery(n,e){const i=e.currentQuerySelector,s=n.options||{};e.queryCount++,e.currentQuery=n;const[l,h]=function fce(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(hce,"")),t=t.replace(/@\*/g,wM).replace(/@\w+/g,e=>wM+"-"+e.slice(1)).replace(/:animating/g,LP),[t,n]}(n.selector);e.currentQuerySelector=i.length?i+" "+l:l,_A(e.collectedStyles,e.currentQuerySelector,new Map);const m=yA(this,mS(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:l,limit:s.limit||0,optional:!!s.optional,includeSelf:h,animation:m,originalSelector:n.selector,options:sb(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function Mle(){return new ln(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:xM(n.timings,e.errors,!0);return{type:12,animation:yA(this,mS(n.animation),e),timings:i,options:null}}}class pce{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function sb(t){return t?(t=gS(t)).params&&(t.params=function Ace(t){return t?gS(t):null}(t.params)):t={},t}function QP(t,n,e){return{duration:t,delay:n,easing:e}}function jP(t,n,e,i,s,l,h=null,m=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:i,duration:s,delay:l,totalTime:s+l,easing:h,subTimeline:m}}class IM{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const vce=new RegExp(":enter","g"),wce=new RegExp(":leave","g");function GP(t,n,e,i,s,l=new Map,h=new Map,m,b,E=[]){return(new xce).buildKeyframes(t,n,e,i,s,l,h,m,b,E)}class xce{buildKeyframes(n,e,i,s,l,h,m,b,E,M=[]){E=E||new IM;const L=new $P(n,e,E,s,l,M,[]);L.options=b;const G=b.delay?g0(b.delay):0;L.currentTimeline.delayNextStep(G),L.currentTimeline.setStyles([h],null,L.errors,b),yA(this,i,L);const V=L.timelines.filter(ne=>ne.containsAnimation());if(V.length&&m.size){let ne;for(let re=V.length-1;re>=0;re--){const de=V[re];if(de.element===e){ne=de;break}}ne&&!ne.allowOnlyTimelineStyles()&&ne.setStyles([m],null,L.errors,b)}return V.length?V.map(ne=>ne.buildKeyframes()):[jP(e,[],[],[],0,G,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const i=e.subInstructions.get(e.element);if(i){const s=e.createSubContext(n.options),l=e.currentTimeline.currentTime,h=this._visitSubInstructions(i,s,s.options);l!=h&&e.transformIntoNewTimeline(h)}e.previousNode=n}visitAnimateRef(n,e){const i=e.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,i),this.visitReference(n.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,i){for(const s of n){const l=s?.delay;if(l){const h="number"==typeof l?l:g0(_S(l,s?.params??{},e.errors));i.delayNextStep(h)}}}_visitSubInstructions(n,e,i){let l=e.currentTimeline.currentTime;const h=null!=i.duration?g0(i.duration):null,m=null!=i.delay?g0(i.delay):null;return 0!==h&&n.forEach(b=>{const E=e.appendInstructionToTimeline(b,h,m);l=Math.max(l,E.duration+E.delay)}),l}visitReference(n,e){e.updateOptions(n.options,!0),yA(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const i=e.subContextCount;let s=e;const l=n.options;if(l&&(l.params||l.delay)&&(s=e.createSubContext(l),s.transformIntoNewTimeline(),null!=l.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=DM);const h=g0(l.delay);s.delayNextStep(h)}n.steps.length&&(n.steps.forEach(h=>yA(this,h,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>i&&s.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const i=[];let s=e.currentTimeline.currentTime;const l=n.options&&n.options.delay?g0(n.options.delay):0;n.steps.forEach(h=>{const m=e.createSubContext(n.options);l&&m.delayNextStep(l),yA(this,h,m),s=Math.max(s,m.currentTimeline.currentTime),i.push(m.currentTimeline)}),i.forEach(h=>e.currentTimeline.mergeTimelineCollectedStyles(h)),e.transformIntoNewTimeline(s),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const i=n.strValue;return xM(e.params?_S(i,e.params,e.errors):i,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const i=e.currentAnimateTimings=this._visitTiming(n.timings,e),s=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),s.snapshotCurrentStyles());const l=n.style;5==l.type?this.visitKeyframes(l,e):(e.incrementTime(i.duration),this.visitStyle(l,e),s.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const i=e.currentTimeline,s=e.currentAnimateTimings;!s&&i.hasCurrentStyleProperties()&&i.forwardFrame();const l=s&&s.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(l):i.setStyles(n.styles,l,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const i=e.currentAnimateTimings,s=e.currentTimeline.duration,l=i.duration,m=e.createSubContext().currentTimeline;m.easing=i.easing,n.styles.forEach(b=>{m.forwardTime((b.offset||0)*l),m.setStyles(b.styles,b.easing,e.errors,e.options),m.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(m),e.transformIntoNewTimeline(s+l),e.previousNode=n}visitQuery(n,e){const i=e.currentTimeline.currentTime,s=n.options||{},l=s.delay?g0(s.delay):0;l&&(6===e.previousNode.type||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=DM);let h=i;const m=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!s.optional,e.errors);e.currentQueryTotal=m.length;let b=null;m.forEach((E,M)=>{e.currentQueryIndex=M;const L=e.createSubContext(n.options,E);l&&L.delayNextStep(l),E===e.element&&(b=L.currentTimeline),yA(this,n.animation,L),L.currentTimeline.applyStylesToKeyframe(),h=Math.max(h,L.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(h),b&&(e.currentTimeline.mergeTimelineCollectedStyles(b),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const i=e.parentContext,s=e.currentTimeline,l=n.timings,h=Math.abs(l.duration),m=h*(e.currentQueryTotal-1);let b=h*e.currentQueryIndex;switch(l.duration<0?"reverse":l.easing){case"reverse":b=m-b;break;case"full":b=i.currentStaggerTime}const M=e.currentTimeline;b&&M.delayNextStep(b);const L=M.currentTime;yA(this,n.animation,e),e.previousNode=n,i.currentStaggerTime=s.currentTime-L+(s.startTime-i.currentTimeline.startTime)}}const DM={};class $P{constructor(n,e,i,s,l,h,m,b){this._driver=n,this.element=e,this.subInstructions=i,this._enterClassName=s,this._leaveClassName=l,this.errors=h,this.timelines=m,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=DM,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=b||new BM(this._driver,e,0),m.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const i=n;let s=this.options;null!=i.duration&&(s.duration=g0(i.duration)),null!=i.delay&&(s.delay=g0(i.delay));const l=i.params;if(l){let h=s.params;h||(h=this.options.params={}),Object.keys(l).forEach(m=>{(!e||!h.hasOwnProperty(m))&&(h[m]=_S(l[m],h,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const i=n.params={};Object.keys(e).forEach(s=>{i[s]=e[s]})}}return n}createSubContext(n=null,e,i){const s=e||this.element,l=new $P(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,i||0));return l.previousNode=this.previousNode,l.currentAnimateTimings=this.currentAnimateTimings,l.options=this._copyOptions(),l.updateOptions(n),l.currentQueryIndex=this.currentQueryIndex,l.currentQueryTotal=this.currentQueryTotal,l.parentContext=this,this.subContextCount++,l}transformIntoNewTimeline(n){return this.previousNode=DM,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,i){const s={duration:e??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},l=new Cce(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,s,n.stretchStartingKeyframe);return this.timelines.push(l),s}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,i,s,l,h){let m=[];if(s&&m.push(this.element),n.length>0){n=(n=n.replace(vce,"."+this._enterClassName)).replace(wce,"."+this._leaveClassName);let E=this._driver.query(this.element,n,1!=i);0!==i&&(E=i<0?E.slice(E.length+i,E.length):E.slice(0,i)),m.push(...E)}return!l&&0==m.length&&h.push(function Fle(t){return new ln(3014,!1)}()),m}}class BM{constructor(n,e,i,s){this._driver=n,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=s,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new BM(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||p0),this._currentKeyframe.set(e,p0);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,i,s){e&&this._previousKeyframe.set("easing",e);const l=s&&s.params||{},h=function Ece(t,n){const e=new Map;let i;return t.forEach(s=>{if("*"===s){i=i||n.keys();for(let l of i)e.set(l,p0)}else Yy(s,e)}),e}(n,this._globalTimelineStyles);for(let[m,b]of h){const E=_S(b,l,i);this._pendingStyles.set(m,E),this._localTimelineStyles.has(m)||this._backFill.set(m,this._globalTimelineStyles.get(m)??p0),this._updateStyle(m,E)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,i)=>{const s=this._styleSummary.get(i);(!s||e.time>s.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((m,b)=>{const E=Yy(m,new Map,this._backFill);E.forEach((M,L)=>{"!"===M?n.add(L):M===p0&&e.add(L)}),i||E.set("offset",b/this.duration),s.push(E)});const l=n.size?CM(n.values()):[],h=e.size?CM(e.values()):[];if(i){const m=s[0],b=new Map(m);m.set("offset",0),b.set("offset",1),s=[m,b]}return jP(this.element,s,l,h,this.duration,this.startTime,this.easing,!1)}}class Cce extends BM{constructor(n,e,i,s,l,h,m=!1){super(n,e,h.delay),this.keyframes=i,this.preStyleProps=s,this.postStyleProps=l,this._stretchStartingKeyframe=m,this.timings={duration:h.duration,delay:h.delay,easing:h.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:i,easing:s}=this.timings;if(this._stretchStartingKeyframe&&e){const l=[],h=i+e,m=e/h,b=Yy(n[0]);b.set("offset",0),l.push(b);const E=Yy(n[0]);E.set("offset",qQ(m)),l.push(E);const M=n.length-1;for(let L=1;L<=M;L++){let G=Yy(n[L]);const V=G.get("offset");G.set("offset",qQ((e+V*i)/h)),l.push(G)}i=h,e=0,s="",n=l}return jP(this.element,n,this.preStyleProps,this.postStyleProps,i,e,s,!0)}}function qQ(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}class qP{}const Sce=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Tce extends qP{normalizePropertyName(n,e){return VP(n)}normalizeStyleValue(n,e,i,s){let l="";const h=i.toString().trim();if(Sce.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)l="px";else{const m=i.match(/^[+-]?[\d\.]+([a-z]*)$/);m&&0==m[1].length&&s.push(function ble(t,n){return new ln(3005,!1)}())}return h+l}}function KQ(t,n,e,i,s,l,h,m,b,E,M,L,G){return{type:0,element:t,triggerName:n,isRemovalTransition:s,fromState:e,fromStyles:l,toState:i,toStyles:h,timelines:m,queriedElements:b,preStyleProps:E,postStyleProps:M,totalTime:L,errors:G}}const KP={};class WQ{constructor(n,e,i){this._triggerName=n,this.ast=e,this._stateStyles=i}match(n,e,i,s){return function Ice(t,n,e,i,s){return t.some(l=>l(n,e,i,s))}(this.ast.matchers,n,e,i,s)}buildStyles(n,e,i){let s=this._stateStyles.get("*");return void 0!==n&&(s=this._stateStyles.get(n?.toString())||s),s?s.buildStyles(e,i):new Map}build(n,e,i,s,l,h,m,b,E,M){const L=[],G=this.ast.options&&this.ast.options.params||KP,ne=this.buildStyles(i,m&&m.params||KP,L),re=b&&b.params||KP,de=this.buildStyles(s,re,L),fe=new Set,he=new Map,Ne=new Map,We="void"===s,pt={params:Dce(re,G),delay:this.ast.options?.delay},Qt=M?[]:GP(n,e,this.ast.animation,l,h,ne,de,pt,E,L);let yt=0;if(Qt.forEach(un=>{yt=Math.max(un.duration+un.delay,yt)}),L.length)return KQ(e,this._triggerName,i,s,We,ne,de,[],[],he,Ne,yt,L);Qt.forEach(un=>{const hn=un.element,Ue=_A(he,hn,new Set);un.preStyleProps.forEach(ut=>Ue.add(ut));const ze=_A(Ne,hn,new Set);un.postStyleProps.forEach(ut=>ze.add(ut)),hn!==e&&fe.add(hn)});const Ye=CM(fe.values());return KQ(e,this._triggerName,i,s,We,ne,de,Qt,Ye,he,Ne,yt)}}function Dce(t,n){const e=gS(n);for(const i in t)t.hasOwnProperty(i)&&null!=t[i]&&(e[i]=t[i]);return e}class Bce{constructor(n,e,i){this.styles=n,this.defaultParams=e,this.normalizer=i}buildStyles(n,e){const i=new Map,s=gS(this.defaultParams);return Object.keys(n).forEach(l=>{const h=n[l];null!==h&&(s[l]=h)}),this.styles.styles.forEach(l=>{"string"!=typeof l&&l.forEach((h,m)=>{h&&(h=_S(h,s,e));const b=this.normalizer.normalizePropertyName(m,e);h=this.normalizer.normalizeStyleValue(m,b,h,e),i.set(m,h)})}),i}}class Fce{constructor(n,e,i){this.name=n,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(s=>{this.states.set(s.name,new Bce(s.style,s.options&&s.options.params||{},i))}),ZQ(this.states,"true","1"),ZQ(this.states,"false","0"),e.transitions.forEach(s=>{this.transitionFactories.push(new WQ(n,s,this.states))}),this.fallbackTransition=function Rce(t,n,e){return new WQ(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(h,m)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,i,s){return this.transitionFactories.find(h=>h.match(n,e,i,s))||null}matchStyles(n,e,i){return this.fallbackTransition.buildStyles(n,e,i)}}function ZQ(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const Oce=new IM;class kce{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){const i=[],l=HP(this._driver,e,i,[]);if(i.length)throw function Ule(t){return new ln(3503,!1)}();this._animations.set(n,l)}_buildPlayer(n,e,i){const s=n.element,l=FQ(this._normalizer,n.keyframes,e,i);return this._driver.animate(s,l,n.duration,n.delay,n.easing,[],!0)}create(n,e,i={}){const s=[],l=this._animations.get(n);let h;const m=new Map;if(l?(h=GP(this._driver,e,l,NP,vM,new Map,new Map,i,Oce,s),h.forEach(M=>{const L=_A(m,M.element,new Map);M.postStyleProps.forEach(G=>L.set(G,null))})):(s.push(function zle(){return new ln(3300,!1)}()),h=[]),s.length)throw function Vle(t){return new ln(3504,!1)}();m.forEach((M,L)=>{M.forEach((G,V)=>{M.set(V,this._driver.computeStyle(L,V,p0))})});const E=Xy(h.map(M=>{const L=m.get(M.element);return this._buildPlayer(M,new Map,L)}));return this._playersById.set(n,E),E.onDestroy(()=>this.destroy(n)),this.players.push(E),E}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function Hle(t){return new ln(3301,!1)}();return e}listen(n,e,i,s){const l=OP(e,"","","");return FP(this._getPlayer(n),i,l,s),()=>{}}command(n,e,i,s){if("register"==i)return void this.register(n,s[0]);if("create"==i)return void this.create(n,e,s[0]||{});const l=this._getPlayer(n);switch(i){case"play":l.play();break;case"pause":l.pause();break;case"reset":l.reset();break;case"restart":l.restart();break;case"finish":l.finish();break;case"init":l.init();break;case"setPosition":l.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(n)}}}const XQ="ng-animate-queued",WP="ng-animate-disabled",zce=[],YQ={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Vce={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},_g="__ng_removed";class ZP{get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;const i=n&&n.hasOwnProperty("value");if(this.value=function Gce(t){return t??null}(i?n.value:n),i){const l=gS(n);delete l.value,this.options=l}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const e=n.params;if(e){const i=this.options.params;Object.keys(e).forEach(s=>{null==i[s]&&(i[s]=e[s])})}}}const yS="void",XP=new ZP(yS);class Hce{constructor(n,e,i){this.id=n,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,cp(e,this._hostClassName)}listen(n,e,i,s){if(!this._triggers.has(e))throw function Qle(t,n){return new ln(3302,!1)}();if(null==i||0==i.length)throw function jle(t){return new ln(3303,!1)}();if(!function $ce(t){return"start"==t||"done"==t}(i))throw function Gle(t,n){return new ln(3400,!1)}();const l=_A(this._elementListeners,n,[]),h={name:e,phase:i,callback:s};l.push(h);const m=_A(this._engine.statesByElement,n,new Map);return m.has(e)||(cp(n,bM),cp(n,bM+"-"+e),m.set(e,XP)),()=>{this._engine.afterFlush(()=>{const b=l.indexOf(h);b>=0&&l.splice(b,1),this._triggers.has(e)||m.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function $le(t){return new ln(3401,!1)}();return e}trigger(n,e,i,s=!0){const l=this._getTrigger(e),h=new YP(this.id,e,n);let m=this._engine.statesByElement.get(n);m||(cp(n,bM),cp(n,bM+"-"+e),this._engine.statesByElement.set(n,m=new Map));let b=m.get(e);const E=new ZP(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&b&&E.absorbOptions(b.options),m.set(e,E),b||(b=XP),E.value!==yS&&b.value===E.value){if(!function Wce(t,n){const e=Object.keys(t),i=Object.keys(n);if(e.length!=i.length)return!1;for(let s=0;s<e.length;s++){const l=e[s];if(!n.hasOwnProperty(l)||t[l]!==n[l])return!1}return!0}(b.params,E.params)){const re=[],de=l.matchStyles(b.value,b.params,re),fe=l.matchStyles(E.value,E.params,re);re.length?this._engine.reportError(re):this._engine.afterFlush(()=>{rb(n,de),jm(n,fe)})}return}const G=_A(this._engine.playersByElement,n,[]);G.forEach(re=>{re.namespaceId==this.id&&re.triggerName==e&&re.queued&&re.destroy()});let V=l.matchTransition(b.value,E.value,n,E.params),ne=!1;if(!V){if(!s)return;V=l.fallbackTransition,ne=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:V,fromState:b,toState:E,player:h,isFallbackTransition:ne}),ne||(cp(n,XQ),h.onStart(()=>{Gx(n,XQ)})),h.onDone(()=>{let re=this.players.indexOf(h);re>=0&&this.players.splice(re,1);const de=this._engine.playersByElement.get(n);if(de){let fe=de.indexOf(h);fe>=0&&de.splice(fe,1)}}),this.players.push(h),G.push(h),h}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(s=>s.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const i=this._engine.driver.query(n,wM,!0);i.forEach(s=>{if(s[_g])return;const l=this._engine.fetchNamespacesByElement(s);l.size?l.forEach(h=>h.triggerLeaveAnimation(s,e,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(n,e,i,s){const l=this._engine.statesByElement.get(n),h=new Map;if(l){const m=[];if(l.forEach((b,E)=>{if(h.set(E,b.value),this._triggers.has(E)){const M=this.trigger(n,E,yS,s);M&&m.push(M)}}),m.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,h),i&&Xy(m).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(e&&i){const s=new Set;e.forEach(l=>{const h=l.name;if(s.has(h))return;s.add(h);const b=this._triggers.get(h).fallbackTransition,E=i.get(h)||XP,M=new ZP(yS),L=new YP(this.id,h,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:h,transition:b,fromState:E,toState:M,player:L,isFallbackTransition:!0})})}}removeNode(n,e){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let s=!1;if(i.totalAnimations){const l=i.players.length?i.playersByQueriedElement.get(n):[];if(l&&l.length)s=!0;else{let h=n;for(;h=h.parentNode;)if(i.statesByElement.get(h)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(n),s)i.markElementAsRemoved(this.id,n,!1,e);else{const l=n[_g];(!l||l===YQ)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,e))}}insertNode(n,e){cp(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(i=>{const s=i.player;if(s.destroyed)return;const l=i.element,h=this._elementListeners.get(l);h&&h.forEach(m=>{if(m.name==i.triggerName){const b=OP(l,i.triggerName,i.fromState.value,i.toState.value);b._data=n,FP(i.player,m.phase,b,m.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):e.push(i)}),this._queue=[],e.sort((i,s)=>{const l=i.transition.ast.depCount,h=s.transition.ast.depCount;return 0==l||0==h?l-h:this._engine.driver.containsElement(i.element,s.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class Qce{_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,i){this.bodyNode=n,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,l)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,e){const i=new Hce(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,e){const i=this._namespaceList,s=this.namespacesByHostElement;if(i.length-1>=0){let h=!1,m=this.driver.getParentElement(e);for(;m;){const b=s.get(m);if(b){const E=i.indexOf(b);i.splice(E+1,0,n),h=!0;break}m=this.driver.getParentElement(m)}h||i.unshift(n)}else i.push(n);return s.set(e,n),n}register(n,e){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,e)),i}registerTrigger(n,e,i){let s=this._namespaceLookup[n];s&&s.register(e,i)&&this.totalAnimations++}destroy(n,e){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(n);this.namespacesByHostElement.delete(i.hostElement);const s=this._namespaceList.indexOf(i);s>=0&&this._namespaceList.splice(s,1),i.destroy(e),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,i=this.statesByElement.get(n);if(i)for(let s of i.values())if(s.namespaceId){const l=this._fetchNamespace(s.namespaceId);l&&e.add(l)}return e}trigger(n,e,i,s){if(MM(e)){const l=this._fetchNamespace(n);if(l)return l.trigger(e,i,s),!0}return!1}insertNode(n,e,i,s){if(!MM(e))return;const l=e[_g];if(l&&l.setForRemoval){l.setForRemoval=!1,l.setForMove=!0;const h=this.collectedLeaveElements.indexOf(e);h>=0&&this.collectedLeaveElements.splice(h,1)}if(n){const h=this._fetchNamespace(n);h&&h.insertNode(e,i)}s&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),cp(n,WP)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Gx(n,WP))}removeNode(n,e,i){if(MM(e)){const s=n?this._fetchNamespace(n):null;s?s.removeNode(e,i):this.markElementAsRemoved(n,e,!1,i);const l=this.namespacesByHostElement.get(e);l&&l.id!==n&&l.removeNode(e,i)}else this._onRemovalComplete(e,i)}markElementAsRemoved(n,e,i,s,l){this.collectedLeaveElements.push(e),e[_g]={namespaceId:n,setForRemoval:s,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:l}}listen(n,e,i,s,l){return MM(e)?this._fetchNamespace(n).listen(e,i,s,l):()=>{}}_buildInstruction(n,e,i,s,l){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,s,n.fromState.options,n.toState.options,e,l)}destroyInnerAnimations(n){let e=this.driver.query(n,wM,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,LP,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Xy(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[_g];if(e&&e.setForRemoval){if(n[_g]=YQ,e.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(WP)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,s)=>this._balanceNamespaceList(i,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)cp(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,n)}finally{for(let s=0;s<i.length;s++)i[s]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Xy(e).onDone(()=>{i.forEach(s=>s())}):i.forEach(s=>s())}}reportError(n){throw function qle(t){return new ln(3402,!1)}()}_flushAnimations(n,e){const i=new IM,s=[],l=new Map,h=[],m=new Map,b=new Map,E=new Map,M=new Set;this.disabledNodes.forEach(ft=>{M.add(ft);const Ot=this.driver.query(ft,".ng-animate-queued",!0);for(let wt=0;wt<Ot.length;wt++)M.add(Ot[wt])});const L=this.bodyNode,G=Array.from(this.statesByElement.keys()),V=tj(G,this.collectedEnterElements),ne=new Map;let re=0;V.forEach((ft,Ot)=>{const wt=NP+re++;ne.set(Ot,wt),ft.forEach(Yt=>cp(Yt,wt))});const de=[],fe=new Set,he=new Set;for(let ft=0;ft<this.collectedLeaveElements.length;ft++){const Ot=this.collectedLeaveElements[ft],wt=Ot[_g];wt&&wt.setForRemoval&&(de.push(Ot),fe.add(Ot),wt.hasAnimation?this.driver.query(Ot,".ng-star-inserted",!0).forEach(Yt=>fe.add(Yt)):he.add(Ot))}const Ne=new Map,We=tj(G,Array.from(fe));We.forEach((ft,Ot)=>{const wt=vM+re++;Ne.set(Ot,wt),ft.forEach(Yt=>cp(Yt,wt))}),n.push(()=>{V.forEach((ft,Ot)=>{const wt=ne.get(Ot);ft.forEach(Yt=>Gx(Yt,wt))}),We.forEach((ft,Ot)=>{const wt=Ne.get(Ot);ft.forEach(Yt=>Gx(Yt,wt))}),de.forEach(ft=>{this.processLeaveNode(ft)})});const pt=[],Qt=[];for(let ft=this._namespaceList.length-1;ft>=0;ft--)this._namespaceList[ft].drainQueuedTransitions(e).forEach(wt=>{const Yt=wt.player,pn=wt.element;if(pt.push(Yt),this.collectedEnterElements.length){const jt=pn[_g];if(jt&&jt.setForMove){if(jt.previousTriggersValues&&jt.previousTriggersValues.has(wt.triggerName)){const en=jt.previousTriggersValues.get(wt.triggerName),sn=this.statesByElement.get(wt.element);if(sn&&sn.has(wt.triggerName)){const bi=sn.get(wt.triggerName);bi.value=en,sn.set(wt.triggerName,bi)}}return void Yt.destroy()}}const Ti=!L||!this.driver.containsElement(L,pn),Se=Ne.get(pn),Xe=ne.get(pn),Je=this._buildInstruction(wt,i,Xe,Se,Ti);if(Je.errors&&Je.errors.length)return void Qt.push(Je);if(Ti)return Yt.onStart(()=>rb(pn,Je.fromStyles)),Yt.onDestroy(()=>jm(pn,Je.toStyles)),void s.push(Yt);if(wt.isFallbackTransition)return Yt.onStart(()=>rb(pn,Je.fromStyles)),Yt.onDestroy(()=>jm(pn,Je.toStyles)),void s.push(Yt);const _t=[];Je.timelines.forEach(jt=>{jt.stretchStartingKeyframe=!0,this.disabledNodes.has(jt.element)||_t.push(jt)}),Je.timelines=_t,i.append(pn,Je.timelines),h.push({instruction:Je,player:Yt,element:pn}),Je.queriedElements.forEach(jt=>_A(m,jt,[]).push(Yt)),Je.preStyleProps.forEach((jt,en)=>{if(jt.size){let sn=b.get(en);sn||b.set(en,sn=new Set),jt.forEach((bi,di)=>sn.add(di))}}),Je.postStyleProps.forEach((jt,en)=>{let sn=E.get(en);sn||E.set(en,sn=new Set),jt.forEach((bi,di)=>sn.add(di))})});if(Qt.length){const ft=[];Qt.forEach(Ot=>{ft.push(function Kle(t,n){return new ln(3505,!1)}())}),pt.forEach(Ot=>Ot.destroy()),this.reportError(ft)}const yt=new Map,Ye=new Map;h.forEach(ft=>{const Ot=ft.element;i.has(Ot)&&(Ye.set(Ot,Ot),this._beforeAnimationBuild(ft.player.namespaceId,ft.instruction,yt))}),s.forEach(ft=>{const Ot=ft.element;this._getPreviousPlayers(Ot,!1,ft.namespaceId,ft.triggerName,null).forEach(Yt=>{_A(yt,Ot,[]).push(Yt),Yt.destroy()})});const un=de.filter(ft=>ij(ft,b,E)),hn=new Map;ej(hn,this.driver,he,E,p0).forEach(ft=>{ij(ft,b,E)&&un.push(ft)});const ze=new Map;V.forEach((ft,Ot)=>{ej(ze,this.driver,new Set(ft),b,"!")}),un.forEach(ft=>{const Ot=hn.get(ft),wt=ze.get(ft);hn.set(ft,new Map([...Ot?.entries()??[],...wt?.entries()??[]]))});const ut=[],lt=[],_n={};h.forEach(ft=>{const{element:Ot,player:wt,instruction:Yt}=ft;if(i.has(Ot)){if(M.has(Ot))return wt.onDestroy(()=>jm(Ot,Yt.toStyles)),wt.disabled=!0,wt.overrideTotalTime(Yt.totalTime),void s.push(wt);let pn=_n;if(Ye.size>1){let Se=Ot;const Xe=[];for(;Se=Se.parentNode;){const Je=Ye.get(Se);if(Je){pn=Je;break}Xe.push(Se)}Xe.forEach(Je=>Ye.set(Je,pn))}const Ti=this._buildAnimation(wt.namespaceId,Yt,yt,l,ze,hn);if(wt.setRealPlayer(Ti),pn===_n)ut.push(wt);else{const Se=this.playersByElement.get(pn);Se&&Se.length&&(wt.parentPlayer=Xy(Se)),s.push(wt)}}else rb(Ot,Yt.fromStyles),wt.onDestroy(()=>jm(Ot,Yt.toStyles)),lt.push(wt),M.has(Ot)&&s.push(wt)}),lt.forEach(ft=>{const Ot=l.get(ft.element);if(Ot&&Ot.length){const wt=Xy(Ot);ft.setRealPlayer(wt)}}),s.forEach(ft=>{ft.parentPlayer?ft.syncPlayerEvents(ft.parentPlayer):ft.destroy()});for(let ft=0;ft<de.length;ft++){const Ot=de[ft],wt=Ot[_g];if(Gx(Ot,vM),wt&&wt.hasAnimation)continue;let Yt=[];if(m.size){let Ti=m.get(Ot);Ti&&Ti.length&&Yt.push(...Ti);let Se=this.driver.query(Ot,LP,!0);for(let Xe=0;Xe<Se.length;Xe++){let Je=m.get(Se[Xe]);Je&&Je.length&&Yt.push(...Je)}}const pn=Yt.filter(Ti=>!Ti.destroyed);pn.length?qce(this,Ot,pn):this.processLeaveNode(Ot)}return de.length=0,ut.forEach(ft=>{this.players.push(ft),ft.onDone(()=>{ft.destroy();const Ot=this.players.indexOf(ft);this.players.splice(Ot,1)}),ft.play()}),ut}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,i,s,l){let h=[];if(e){const m=this.playersByQueriedElement.get(n);m&&(h=m)}else{const m=this.playersByElement.get(n);if(m){const b=!l||l==yS;m.forEach(E=>{E.queued||!b&&E.triggerName!=s||h.push(E)})}}return(i||s)&&(h=h.filter(m=>!(i&&i!=m.namespaceId||s&&s!=m.triggerName))),h}_beforeAnimationBuild(n,e,i){const l=e.element,h=e.isRemovalTransition?void 0:n,m=e.isRemovalTransition?void 0:e.triggerName;for(const b of e.timelines){const E=b.element,M=E!==l,L=_A(i,E,[]);this._getPreviousPlayers(E,M,h,m,e.toState).forEach(V=>{const ne=V.getRealPlayer();ne.beforeDestroy&&ne.beforeDestroy(),V.destroy(),L.push(V)})}rb(l,e.fromStyles)}_buildAnimation(n,e,i,s,l,h){const m=e.triggerName,b=e.element,E=[],M=new Set,L=new Set,G=e.timelines.map(ne=>{const re=ne.element;M.add(re);const de=re[_g];if(de&&de.removedBeforeQueried)return new pS(ne.duration,ne.delay);const fe=re!==b,he=function Kce(t){const n=[];return nj(t,n),n}((i.get(re)||zce).map(yt=>yt.getRealPlayer())).filter(yt=>!!yt.element&&yt.element===re),Ne=l.get(re),We=h.get(re),pt=FQ(this._normalizer,ne.keyframes,Ne,We),Qt=this._buildPlayer(ne,pt,he);if(ne.subTimeline&&s&&L.add(re),fe){const yt=new YP(n,m,re);yt.setRealPlayer(Qt),E.push(yt)}return Qt});E.forEach(ne=>{_A(this.playersByQueriedElement,ne.element,[]).push(ne),ne.onDone(()=>function jce(t,n,e){let i=t.get(n);if(i){if(i.length){const s=i.indexOf(e);i.splice(s,1)}0==i.length&&t.delete(n)}return i}(this.playersByQueriedElement,ne.element,ne))}),M.forEach(ne=>cp(ne,UQ));const V=Xy(G);return V.onDestroy(()=>{M.forEach(ne=>Gx(ne,UQ)),jm(b,e.toStyles)}),L.forEach(ne=>{_A(s,ne,[]).push(V)}),V}_buildPlayer(n,e,i){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,i):new pS(n.duration,n.delay)}}class YP{constructor(n,e,i){this.namespaceId=n,this.triggerName=e,this.element=i,this._player=new pS,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,i)=>{e.forEach(s=>FP(n,i,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){_A(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function MM(t){return t&&1===t.nodeType}function JQ(t,n){const e=t.style.display;return t.style.display=n??"none",e}function ej(t,n,e,i,s){const l=[];e.forEach(b=>l.push(JQ(b)));const h=[];i.forEach((b,E)=>{const M=new Map;b.forEach(L=>{const G=n.computeStyle(E,L,s);M.set(L,G),(!G||0==G.length)&&(E[_g]=Vce,h.push(E))}),t.set(E,M)});let m=0;return e.forEach(b=>JQ(b,l[m++])),h}function tj(t,n){const e=new Map;if(t.forEach(m=>e.set(m,[])),0==n.length)return e;const s=new Set(n),l=new Map;function h(m){if(!m)return 1;let b=l.get(m);if(b)return b;const E=m.parentNode;return b=e.has(E)?E:s.has(E)?1:h(E),l.set(m,b),b}return n.forEach(m=>{const b=h(m);1!==b&&e.get(b).push(m)}),e}function cp(t,n){t.classList?.add(n)}function Gx(t,n){t.classList?.remove(n)}function qce(t,n,e){Xy(e).onDone(()=>t.processLeaveNode(n))}function nj(t,n){for(let e=0;e<t.length;e++){const i=t[e];i instanceof BQ?nj(i.players,n):n.push(i)}}function ij(t,n,e){const i=e.get(t);if(!i)return!1;let s=n.get(t);return s?i.forEach(l=>s.add(l)):n.set(t,i),e.delete(t),!0}class FM{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(s,l)=>{},this._transitionEngine=new Qce(n,e,i),this._timelineEngine=new kce(n,e,i),this._transitionEngine.onRemovalComplete=(s,l)=>this.onRemovalComplete(s,l)}registerTrigger(n,e,i,s,l){const h=n+"-"+s;let m=this._triggerCache[h];if(!m){const b=[],M=HP(this._driver,l,b,[]);if(b.length)throw function Nle(t,n){return new ln(3404,!1)}();m=function Mce(t,n,e){return new Fce(t,n,e)}(s,M,this._normalizer),this._triggerCache[h]=m}this._transitionEngine.registerTrigger(e,s,m)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,i,s){this._transitionEngine.insertNode(n,e,i,s)}onRemove(n,e,i){this._transitionEngine.removeNode(n,e,i)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,i,s){if("@"==i.charAt(0)){const[l,h]=RQ(i);this._timelineEngine.command(l,e,h,s)}else this._transitionEngine.trigger(n,e,i,s)}listen(n,e,i,s,l){if("@"==i.charAt(0)){const[h,m]=RQ(i);return this._timelineEngine.listen(h,e,m,l)}return this._transitionEngine.listen(n,e,i,s,l)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}let Xce=(()=>{class t{static#e=this.initialStylesByElement=new WeakMap;constructor(e,i,s){this._element=e,this._startStyles=i,this._endStyles=s,this._state=0;let l=t.initialStylesByElement.get(e);l||t.initialStylesByElement.set(e,l=new Map),this._initialStyles=l}start(){this._state<1&&(this._startStyles&&jm(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(jm(this._element,this._initialStyles),this._endStyles&&(jm(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(rb(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(rb(this._element,this._endStyles),this._endStyles=null),jm(this._element,this._initialStyles),this._state=3)}}return t})();function JP(t){let n=null;return t.forEach((e,i)=>{(function Yce(t){return"display"===t||"position"===t})(i)&&(n=n||new Map,n.set(i,e))}),n}class rj{constructor(n,e,i,s){this.element=n,this.keyframes=e,this.options=i,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map;const e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(n,e,i){return n.animate(this._convertKeyframesToObject(e),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,s)=>{"offset"!==s&&n.set(s,this._finished?i:QQ(this.element,s))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class Jce{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,e){return!1}containsElement(n,e){return kQ(n,e)}getParentElement(n){return kP(n)}query(n,e,i){return PQ(n,e,i)}computeStyle(n,e,i){return window.getComputedStyle(n)[e]}animate(n,e,i,s,l,h=[]){const b={duration:i,delay:s,fill:0==s?"both":"forwards"};l&&(b.easing=l);const E=new Map,M=h.filter(V=>V instanceof rj);(function oce(t,n){return 0===t||0===n})(i,s)&&M.forEach(V=>{V.currentSnapshot.forEach((ne,re)=>E.set(re,ne))});let L=function ice(t){return t.length?t[0]instanceof Map?t:t.map(n=>zQ(n)):[]}(e).map(V=>Yy(V));L=function ace(t,n,e){if(e.size&&n.length){let i=n[0],s=[];if(e.forEach((l,h)=>{i.has(h)||s.push(h),i.set(h,l)}),s.length)for(let l=1;l<n.length;l++){let h=n[l];s.forEach(m=>h.set(m,QQ(t,m)))}}return n}(n,L,E);const G=function Zce(t,n){let e=null,i=null;return Array.isArray(n)&&n.length?(e=JP(n[0]),n.length>1&&(i=JP(n[n.length-1]))):n instanceof Map&&(e=JP(n)),e||i?new Xce(t,e,i):null}(n,L);return new rj(n,L,b,G)}}let eue=(()=>{class t extends TQ{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:Ac.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(e)?IQ(e):e;return sj(this._renderer,null,i,"register",[s]),new tue(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(z_),Xt(wa))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();class tue extends ple{constructor(n,e){super(),this._id=n,this._renderer=e}create(n,e){return new nue(this._id,n,e||{},this._renderer)}}class nue{constructor(n,e,i,s){this.id=n,this.element=e,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,e){return this._renderer.listen(this.element,`@@${this.id}:${n}`,e)}_command(n,...e){return sj(this._renderer,this.element,this.id,n,e)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function sj(t,n,e,i,s){return t.setProperty(n,`@@${e}:${i}`,s)}const oj="@.disabled";let iue=(()=>{class t{constructor(e,i,s){this.delegate=e,this.engine=i,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(l,h)=>{const m=h?.parentNode(l);m&&h.removeChild(m,l)}}createRenderer(e,i){const l=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let M=this._rendererCache.get(l);return M||(M=new aj("",l,this.engine,()=>this._rendererCache.delete(l)),this._rendererCache.set(l,M)),M}const h=i.id,m=i.id+"-"+this._currentId;this._currentId++,this.engine.register(m,e);const b=M=>{Array.isArray(M)?M.forEach(b):this.engine.registerTrigger(h,m,e,M.name,M)};return i.data.animation.forEach(b),new rue(this,m,l,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,s){e>=0&&e<this._microtaskId?this._zone.run(()=>i(s)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(l=>{const[h,m]=l;h(m)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(z_),Xt(FM),Xt(Wi))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();class aj{constructor(n,e,i,s){this.namespaceId=n,this.delegate=e,this.engine=i,this._onDestroy=s}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,i,s=!0){this.delegate.insertBefore(n,e,i),this.engine.onInsert(this.namespaceId,e,n,s)}removeChild(n,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,i,s){this.delegate.setAttribute(n,e,i,s)}removeAttribute(n,e,i){this.delegate.removeAttribute(n,e,i)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,i,s){this.delegate.setStyle(n,e,i,s)}removeStyle(n,e,i){this.delegate.removeStyle(n,e,i)}setProperty(n,e,i){"@"==e.charAt(0)&&e==oj?this.disableAnimations(n,!!i):this.delegate.setProperty(n,e,i)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,i){return this.delegate.listen(n,e,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class rue extends aj{constructor(n,e,i,s,l){super(e,i,s,l),this.factory=n,this.namespaceId=e}setProperty(n,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==oj?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,e.slice(1),i):this.delegate.setProperty(n,e,i)}listen(n,e,i){if("@"==e.charAt(0)){const s=function sue(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let l=e.slice(1),h="";return"@"!=l.charAt(0)&&([l,h]=function oue(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(l)),this.engine.listen(this.namespaceId,s,l,h,m=>{this.factory.scheduleListenerCallback(m._data||-1,i,m)})}return this.delegate.listen(n,e,i)}}let aue=(()=>{class t extends FM{constructor(e,i,s,l){super(e.body,i,s)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||t)(Xt(wa),Xt(PP),Xt(qP),Xt(Fm))};static#t=this.\u0275prov=Pn({token:t,factory:t.\u0275fac})}return t})();const lj=[{provide:TQ,useClass:eue},{provide:qP,useFactory:function lue(){return new Tce}},{provide:FM,useClass:aue},{provide:z_,useFactory:function cue(t,n,e){return new iue(t,n,e)},deps:[eO,FM,Wi]}],eN=[{provide:PP,useFactory:()=>new Jce},{provide:FT,useValue:"BrowserAnimations"},...lj],cj=[{provide:PP,useClass:NQ},{provide:FT,useValue:"NoopAnimations"},...lj];let uue=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?cj:eN}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t});static#n=this.\u0275inj=cs({providers:eN,imports:[Z4]})}return t})();const hue=["vehicle_search"],due=["vehicleSearchList"];function fue(t,n){if(1&t){const e=xr();pe(0,"li",57),Tt("click",function(){const l=ti(e).$implicit;return ni(dn().selectVehicle(l))}),pe(1,"span"),et(2),ye()()}if(2&t){const e=n.$implicit;$e(2),wr(e.licence_plate)}}let Aue=(()=>{class t{constructor(e,i){this.employe_service=e,this.vehicle_service=i,this.selected_vehicle="",this.available_vehicle_list=[]}ngOnInit(){this.employe_service.getEmployees(),this.vehicle_service.getVehiclesAvailables()}ngAfterViewInit(){this.setInputVehicleEvent()}setInputVehicleEvent(){Ba(this.vehicle_search.nativeElement,"keydown").pipe(Ht(e=>e),Uy(500),Tl()).subscribe(e=>{let i=e.target.value;i.trim().length>0?(this.setListStyle(this.vehicleSearchList),"Tab"==e.key||"Enter"==e.key?this.vehicle_service.available_vehicles_list.length>0?this.selectVehicle(this.vehicle_service.available_vehicles_list[0]):this.inputVehicle(i):(1==e.key.length||"Backspace"==e.key)&&(this.inputVehicle(i),this.removeStyle(this.vehicleSearchList,this.vehicle_search))):this.removeStyle(this.vehicleSearchList,this.vehicle_search)})}setListStyle(e){e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer;width: 305px; max-height: 150px; margin-bottom: 10px;  overflow:scroll;  -webkit-overflow-scrolling: touch;",e.nativeElement.hidden=!1}removeStyle(e,i){""==i.nativeElement.value&&(e.nativeElement.style.cssText="position: absolute; z-index: 999; cursor: pointer; ",e.nativeElement.hidden=!0)}selectVehicle(e){this.vehicle_service.selected_vehicle_plate=e.licence_plate,this.employe_service.selected_employee.vehicle_id=e.vehicle_id,this.vehicleSearchList.nativeElement.hidden=!0}inputVehicle(e){this.available_vehicle_list=this.vehicle_service.available_vehicles_list.filter(i=>i.licence_plate.toUpperCase().includes(e.toUpperCase()))}validateVehicle(){""==this.selected_vehicle.trim()&&(this.employe_service.selected_employee.vehicle_id=0)}resetForm(e){e?.reset(),this.employe_service.selected_employee=new zy}geocoding(){this.employe_service.getGeocoder()}static#e=this.\u0275fac=function(i){return new(i||t)(Ve(Hy),Ve(Sx))};static#t=this.\u0275cmp=Mr({type:t,selectors:[["app-employee-form"]],viewQuery:function(i,s){if(1&i&&(wl(hue,5),wl(due,5)),2&i){let l;is(l=rs())&&(s.vehicle_search=l.first),is(l=rs())&&(s.vehicleSearchList=l.first)}},decls:107,vars:16,consts:[[1,"container"],["employeeForm","ngForm"],["type","hidden","name","employee_id",3,"ngModel","ngModelChange"],["employee_id","ngModel"],[1,"row","form_row"],[1,"col-3"],["for","employee_number"],[1,"col-9"],[1,"form-group"],["id","employee_number","type","text","name","employee_number","placeholder","Numero empleado","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["employee_number","ngModel"],["for","employee_name"],["id","employee_name","type","text","name","name","placeholder","Nombre empleado","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["name","ngModel"],["for","last_name"],["id","last_name","type","text","name","last_name","placeholder","Apellido Paterno","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["last_name","ngModel"],["for","mother_last_name"],["id","mother_last_name","type","text","name","mother_lastname","placeholder","Apellido Materno","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["mother_lastname","ngModel"],["for","street"],["id","street_name","type","text","name","street_name","placeholder","Calle","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["street_name","ngModel"],["for","out_num"],["id","out_num","type","text","name","outdoor_number","placeholder","Numero Ext.","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["outdoor_number","ngModel"],["for","int_num"],["id","int_num","type","text","name","interior_number","placeholder","Numero Int.","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["interior_number","ngModel"],["for","neighborhood"],["id","neighborhood","type","text","name","neighborhood","placeholder","Colonia.","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["neighborhood","ngModel"],["for","city"],["id","city","type","text","name","city","placeholder","Ciudad.","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["city","ngModel"],["for","vehicle_search"],["id","vehicle_search","type","text","name","vehicle_search","placeholder","Veh\xedculo.","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange","blur"],["vehicle_search",""],[1,"list-group",2,"position","absolute","z-index","999","cursor","pointer"],["vehicleSearchList",""],["class","list-group-item",3,"click",4,"ngFor","ngForOf"],["for","company_mail"],["id","company_mail","type","text","name","company_mail","placeholder","Email Empresarial","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["company_mail","ngModel"],[1,"row"],["for","personal_mail"],["id","personal_mail","type","text","name","personal_mail","placeholder","Email Personal","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["personal_mail","ngModel"],["for","location"],[1,"col-4"],["id","location","type","text","name","location","placeholder","Geo Localizacion","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["location","ngModel"],[1,"col-2"],[1,"btn","btn-secondary",3,"click"],[1,"fas","fa-search"],["id","office_distance","type","text","name","office_distance","placeholder","Distancia","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["office_distance","ngModel"],[1,"list-group-item",3,"click"]],template:function(i,s){1&i&&(pe(0,"div",0)(1,"form",null,1)(3,"input",2,3),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.employee_id=h}),ye(),pe(5,"div",4)(6,"div",5)(7,"label",6),et(8,"Numero empleado"),ye()(),pe(9,"div",7)(10,"div",8)(11,"input",9,10),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.employee_number=h}),ye()()()(),pe(13,"div",4)(14,"div",5)(15,"label",11),et(16,"Nombre empleado"),ye()(),pe(17,"div",7)(18,"div",8)(19,"input",12,13),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.name=h}),ye()()()(),pe(21,"div",4)(22,"div",5)(23,"label",14),et(24,"Apellido Paterno"),ye()(),pe(25,"div",7)(26,"input",15,16),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.last_name=h}),ye()()(),pe(28,"div",4)(29,"div",5)(30,"label",17),et(31,"Apellido Materno"),ye()(),pe(32,"div",7)(33,"input",18,19),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.mother_lastname=h}),ye()()(),pe(35,"div",4)(36,"div",5)(37,"label",20),et(38,"Calle"),ye()(),pe(39,"div",7)(40,"input",21,22),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.street_name=h}),ye()()(),pe(42,"div",4)(43,"div",5)(44,"label",23),et(45,"Numero Ext."),ye()(),pe(46,"div",7)(47,"input",24,25),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.outdoor_number=h}),ye()()(),pe(49,"div",4)(50,"div",5)(51,"label",26),et(52,"Numero Int."),ye()(),pe(53,"div",7)(54,"input",27,28),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.interior_number=h}),ye()()(),pe(56,"div",4)(57,"div",5)(58,"label",29),et(59,"Colonia."),ye()(),pe(60,"div",5)(61,"input",30,31),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.neighborhood=h}),ye()(),pe(63,"div",5)(64,"label",32),et(65,"Ciudad."),ye()(),pe(66,"div",5)(67,"input",33,34),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.city=h}),ye()()(),pe(69,"div",4)(70,"div",5)(71,"label",35),et(72,"Veh\xedculo"),ye()(),pe(73,"div",7)(74,"input",36,37),Tt("ngModelChange",function(h){return s.vehicle_service.selected_vehicle_plate=h})("blur",function(){return s.validateVehicle()}),ye(),pe(76,"ul",38,39),En(78,fue,3,1,"li",40),ye()()(),pe(79,"div",4)(80,"div",5)(81,"label",41),et(82,"Email Empresarial"),ye()(),pe(83,"div",7)(84,"input",42,43),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.company_mail=h}),ye()()(),pe(86,"div",44)(87,"div",5)(88,"label",45),et(89,"Email Personal"),ye()(),pe(90,"div",7)(91,"input",46,47),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.personal_mail=h}),ye()()(),pe(93,"div",4)(94,"div",5)(95,"label",48),et(96,"Geo Localizacion"),ye()(),pe(97,"div",49)(98,"input",50,51),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.location=h}),ye()(),pe(100,"div",52)(101,"button",53),Tt("click",function(){return s.geocoding()}),et(102,"Buscar "),oi(103,"i",54),ye()(),pe(104,"div",52)(105,"input",55,56),Tt("ngModelChange",function(h){return s.employe_service.selected_employee.office_distance=h}),ye()()()()()),2&i&&($e(3),st("ngModel",s.employe_service.selected_employee.employee_id),$e(8),st("ngModel",s.employe_service.selected_employee.employee_number),$e(8),st("ngModel",s.employe_service.selected_employee.name),$e(7),st("ngModel",s.employe_service.selected_employee.last_name),$e(7),st("ngModel",s.employe_service.selected_employee.mother_lastname),$e(7),st("ngModel",s.employe_service.selected_employee.street_name),$e(7),st("ngModel",s.employe_service.selected_employee.outdoor_number),$e(7),st("ngModel",s.employe_service.selected_employee.interior_number),$e(7),st("ngModel",s.employe_service.selected_employee.neighborhood),$e(6),st("ngModel",s.employe_service.selected_employee.city),$e(7),st("ngModel",s.vehicle_service.selected_vehicle_plate),$e(4),st("ngForOf",s.available_vehicle_list),$e(6),st("ngModel",s.employe_service.selected_employee.company_mail),$e(7),st("ngModel",s.employe_service.selected_employee.personal_mail),$e(7),st("ngModel",s.employe_service.selected_employee.location),$e(7),st("ngModel",s.employe_service.selected_employee.office_distance))},dependencies:[Pl,Fd,oc,Jc,Md,Qu,xh],styles:[".form_row[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}"]})}return t})(),pue=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ps({type:t,bootstrap:[nle]});static#n=this.\u0275inj=cs({providers:[ex,zy],imports:[Z4,Oae,hle.register("ngsw-worker.js",{enabled:!0,registrationStrategy:"registerWhenStable:30000"}),Ure.forRoot(),Aie,Qne,TY,$R,IY,Ok,kie,uue,jse]})}return t})();(function RA(t,n,e){const i=t.\u0275cmp;i.directiveDefs=Vf(n,!1),i.pipeDefs=Vf(e,!0)})(EV,function(){return[Fd,oc,XO,Jc,Md,Qu,xh,Ale,Aue]},[]),bK().bootstrapModule(pue).catch(t=>console.error(t))},4456:function(Sf){Sf.exports=function(){"use strict";var Rc=function(k,R){return(Rc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(U,N){U.__proto__=N}||function(U,N){for(var ee in N)Object.prototype.hasOwnProperty.call(N,ee)&&(U[ee]=N[ee])})(k,R)};function Zs(k,R){if("function"!=typeof R&&null!==R)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");function U(){this.constructor=k}Rc(k,R),k.prototype=null===R?Object.create(R):(U.prototype=R.prototype,new U)}var qr=function(){return qr=Object.assign||function(R){for(var U,N=1,ee=arguments.length;N<ee;N++)for(var ue in U=arguments[N])Object.prototype.hasOwnProperty.call(U,ue)&&(R[ue]=U[ue]);return R},qr.apply(this,arguments)};function Mo(k,R,U,N){return new(U||(U=Promise))(function(ue,Te){function je(Mt){try{mt(N.next(Mt))}catch($t){Te($t)}}function Qe(Mt){try{mt(N.throw(Mt))}catch($t){Te($t)}}function mt(Mt){Mt.done?ue(Mt.value):function ee(ue){return ue instanceof U?ue:new U(function(Te){Te(ue)})}(Mt.value).then(je,Qe)}mt((N=N.apply(k,R||[])).next())})}function vo(k,R){var N,ee,ue,Te,U={label:0,sent:function(){if(1&ue[0])throw ue[1];return ue[1]},trys:[],ops:[]};return Te={next:je(0),throw:je(1),return:je(2)},"function"==typeof Symbol&&(Te[Symbol.iterator]=function(){return this}),Te;function je(mt){return function(Mt){return function Qe(mt){if(N)throw new TypeError("Generator is already executing.");for(;U;)try{if(N=1,ee&&(ue=2&mt[0]?ee.return:mt[0]?ee.throw||((ue=ee.return)&&ue.call(ee),0):ee.next)&&!(ue=ue.call(ee,mt[1])).done)return ue;switch(ee=0,ue&&(mt=[2&mt[0],ue.value]),mt[0]){case 0:case 1:ue=mt;break;case 4:return U.label++,{value:mt[1],done:!1};case 5:U.label++,ee=mt[1],mt=[0];continue;case 7:mt=U.ops.pop(),U.trys.pop();continue;default:if(!(ue=(ue=U.trys).length>0&&ue[ue.length-1])&&(6===mt[0]||2===mt[0])){U=0;continue}if(3===mt[0]&&(!ue||mt[1]>ue[0]&&mt[1]<ue[3])){U.label=mt[1];break}if(6===mt[0]&&U.label<ue[1]){U.label=ue[1],ue=mt;break}if(ue&&U.label<ue[2]){U.label=ue[2],U.ops.push(mt);break}ue[2]&&U.ops.pop(),U.trys.pop();continue}mt=R.call(k,U)}catch(Mt){mt=[6,Mt],ee=0}finally{N=ue=0}if(5&mt[0])throw mt[1];return{value:mt[0]?mt[1]:void 0,done:!0}}([mt,Mt])}}}function p(k,R,U){if(U||2===arguments.length)for(var ue,N=0,ee=R.length;N<ee;N++)(ue||!(N in R))&&(ue||(ue=Array.prototype.slice.call(R,0,N)),ue[N]=R[N]);return k.concat(ue||R)}for(var Ai=function(){function k(R,U,N,ee){this.left=R,this.top=U,this.width=N,this.height=ee}return k.prototype.add=function(R,U,N,ee){return new k(this.left+R,this.top+U,this.width+N,this.height+ee)},k.fromClientRect=function(R,U){return new k(U.left+R.windowBounds.left,U.top+R.windowBounds.top,U.width,U.height)},k.fromDOMRectList=function(R,U){var N=Array.from(U).find(function(ee){return 0!==ee.width});return N?new k(N.left+R.windowBounds.left,N.top+R.windowBounds.top,N.width,N.height):k.EMPTY},k.EMPTY=new k(0,0,0,0),k}(),Ra=function(k,R){return Ai.fromClientRect(k,R.getBoundingClientRect())},El=function(k){for(var R=[],U=0,N=k.length;U<N;){var ee=k.charCodeAt(U++);if(ee>=55296&&ee<=56319&&U<N){var ue=k.charCodeAt(U++);56320==(64512&ue)?R.push(((1023&ee)<<10)+(1023&ue)+65536):(R.push(ee),U--)}else R.push(ee)}return R},Di=function(){for(var k=[],R=0;R<arguments.length;R++)k[R]=arguments[R];if(String.fromCodePoint)return String.fromCodePoint.apply(String,k);var U=k.length;if(!U)return"";for(var N=[],ee=-1,ue="";++ee<U;){var Te=k[ee];Te<=65535?N.push(Te):N.push(55296+((Te-=65536)>>10),Te%1024+56320),(ee+1===U||N.length>16384)&&(ue+=String.fromCharCode.apply(String,N),N.length=0)}return ue},ia="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wa=typeof Uint8Array>"u"?[]:new Uint8Array(256),Sa=0;Sa<64;Sa++)Wa[ia.charCodeAt(Sa)]=Sa;for(var Ih="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Dh=typeof Uint8Array>"u"?[]:new Uint8Array(256),Ta=0;Ta<64;Ta++)Dh[Ih.charCodeAt(Ta)]=Ta;for(var Oa=function(k,R,U){return k.slice?k.slice(R,U):new Uint16Array(Array.prototype.slice.call(k,R,U))},Pd=function(){function k(R,U,N,ee,ue,Te){this.initialValue=R,this.errorValue=U,this.highStart=N,this.highValueIndex=ee,this.index=ue,this.data=Te}return k.prototype.get=function(R){var U;if(R>=0){if(R<55296||R>56319&&R<=65535)return this.data[U=((U=this.index[R>>5])<<2)+(31&R)];if(R<=65535)return this.data[U=((U=this.index[2048+(R-55296>>5)])<<2)+(31&R)];if(R<this.highStart)return U=this.index[U=2080+(R>>11)],this.data[U=((U=this.index[U+=R>>5&63])<<2)+(31&R)];if(R<=1114111)return this.data[this.highValueIndex]}return this.errorValue},k}(),Li="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Tf=typeof Uint8Array>"u"?[]:new Uint8Array(256),ru=0;ru<64;ru++)Tf[Li.charCodeAt(ru)]=ru;var U,N,ee,Te,je,zt=10,Hn=13,Mi=15,kt=17,_e=18,Re=19,tt=20,Gt=21,tn=22,zn=24,Vt=25,jn=26,Zn=27,ui=28,os=30,Os=32,as=33,ls=34,Ss=35,ca=37,fo=38,Za=39,Xa=40,ua=42,Zt=[9001,65288],Wt="\xd7",Bn=(U=function(k){var N,ue,Te,je,Qe,R=.75*k.length,U=k.length,ee=0;"="===k[k.length-1]&&(R--,"="===k[k.length-2]&&R--);var mt=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(R):new Array(R),Mt=Array.isArray(mt)?mt:new Uint8Array(mt);for(N=0;N<U;N+=4)ue=Dh[k.charCodeAt(N)],Te=Dh[k.charCodeAt(N+1)],je=Dh[k.charCodeAt(N+2)],Qe=Dh[k.charCodeAt(N+3)],Mt[ee++]=ue<<2|Te>>4,Mt[ee++]=(15&Te)<<4|je>>2,Mt[ee++]=(3&je)<<6|63&Qe;return mt}("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),N=Array.isArray(U)?function(k){for(var R=k.length,U=[],N=0;N<R;N+=4)U.push(k[N+3]<<24|k[N+2]<<16|k[N+1]<<8|k[N]);return U}(U):new Uint32Array(U),ee=Array.isArray(U)?function(k){for(var R=k.length,U=[],N=0;N<R;N+=2)U.push(k[N+1]<<8|k[N]);return U}(U):new Uint16Array(U),Te=Oa(ee,12,N[4]/2),je=2===N[5]?Oa(ee,(24+N[4])/2):function(k,R,U){return k.slice?k.slice(R,U):new Uint32Array(Array.prototype.slice.call(k,R,U))}(N,Math.ceil((24+N[4])/4)),new Pd(N[0],N[1],N[2],N[3],Te,je)),gn=[os,36],Gn=[1,2,3,5],Ln=[zt,8],ii=[Zn,jn],Vn=Gn.concat(Ln),ji=[fo,Za,Xa,ls,Ss],Ur=[Mi,Hn],Jr=function(k,R,U,N){var ee=N[U];if(Array.isArray(k)?-1!==k.indexOf(ee):k===ee)for(var ue=U;ue<=N.length;){if((Te=N[++ue])===R)return!0;if(Te!==zt)break}if(ee===zt)for(ue=U;ue>0;){var je=N[--ue];if(Array.isArray(k)?-1!==k.indexOf(je):k===je)for(var Qe=U;Qe<=N.length;){var Te;if((Te=N[++Qe])===R)return!0;if(Te!==zt)break}if(je!==zt)break}return!1},wo=function(k,R){for(var U=k;U>=0;){var N=R[U];if(N!==zt)return N;U--}return 0},es=function(k,R,U,N,ee){if(0===U[N])return Wt;var ue=N-1;if(Array.isArray(ee)&&!0===ee[ue])return Wt;var Te=ue-1,je=ue+1,Qe=R[ue],mt=Te>=0?R[Te]:0,Mt=R[je];if(2===Qe&&3===Mt)return Wt;if(-1!==Gn.indexOf(Qe))return"!";if(-1!==Gn.indexOf(Mt)||-1!==Ln.indexOf(Mt))return Wt;if(8===wo(ue,R))return"\xf7";if(11===Bn.get(k[ue])||(Qe===Os||Qe===as)&&11===Bn.get(k[je])||7===Qe||7===Mt||9===Qe||-1===[zt,Hn,Mi].indexOf(Qe)&&9===Mt||-1!==[kt,_e,Re,zn,ui].indexOf(Mt)||wo(ue,R)===tn||Jr(23,tn,ue,R)||Jr([kt,_e],Gt,ue,R)||Jr(12,12,ue,R))return Wt;if(Qe===zt)return"\xf7";if(23===Qe||23===Mt)return Wt;if(16===Mt||16===Qe)return"\xf7";if(-1!==[Hn,Mi,Gt].indexOf(Mt)||14===Qe||36===mt&&-1!==Ur.indexOf(Qe)||Qe===ui&&36===Mt||Mt===tt||-1!==gn.indexOf(Mt)&&Qe===Vt||-1!==gn.indexOf(Qe)&&Mt===Vt||Qe===Zn&&-1!==[ca,Os,as].indexOf(Mt)||-1!==[ca,Os,as].indexOf(Qe)&&Mt===jn||-1!==gn.indexOf(Qe)&&-1!==ii.indexOf(Mt)||-1!==ii.indexOf(Qe)&&-1!==gn.indexOf(Mt)||-1!==[Zn,jn].indexOf(Qe)&&(Mt===Vt||-1!==[tn,Mi].indexOf(Mt)&&R[je+1]===Vt)||-1!==[tn,Mi].indexOf(Qe)&&Mt===Vt||Qe===Vt&&-1!==[Vt,ui,zn].indexOf(Mt))return Wt;if(-1!==[Vt,ui,zn,kt,_e].indexOf(Mt))for(var $t=ue;$t>=0;){if((yn=R[$t])===Vt)return Wt;if(-1===[ui,zn].indexOf(yn))break;$t--}if(-1!==[Zn,jn].indexOf(Mt))for($t=-1!==[kt,_e].indexOf(Qe)?Te:ue;$t>=0;){var yn;if((yn=R[$t])===Vt)return Wt;if(-1===[ui,zn].indexOf(yn))break;$t--}if(fo===Qe&&-1!==[fo,Za,ls,Ss].indexOf(Mt)||-1!==[Za,ls].indexOf(Qe)&&-1!==[Za,Xa].indexOf(Mt)||-1!==[Xa,Ss].indexOf(Qe)&&Mt===Xa||-1!==ji.indexOf(Qe)&&-1!==[tt,jn].indexOf(Mt)||-1!==ji.indexOf(Mt)&&Qe===Zn||-1!==gn.indexOf(Qe)&&-1!==gn.indexOf(Mt)||Qe===zn&&-1!==gn.indexOf(Mt)||-1!==gn.concat(Vt).indexOf(Qe)&&Mt===tn&&-1===Zt.indexOf(k[je])||-1!==gn.concat(Vt).indexOf(Mt)&&Qe===_e)return Wt;if(41===Qe&&41===Mt){for(var Xi=U[ue],mn=1;Xi>0&&41===R[--Xi];)mn++;if(mn%2!=0)return Wt}return Qe===Os&&Mt===as?Wt:"\xf7"},qo=function(k,R){R||(R={lineBreak:"normal",wordBreak:"normal"});var U=function(k,R){void 0===R&&(R="strict");var U=[],N=[],ee=[];return k.forEach(function(ue,Te){var je=Bn.get(ue);if(je>50?(ee.push(!0),je-=50):ee.push(!1),-1!==["normal","auto","loose"].indexOf(R)&&-1!==[8208,8211,12316,12448].indexOf(ue))return N.push(Te),U.push(16);if(4===je||11===je){if(0===Te)return N.push(Te),U.push(os);var Qe=U[Te-1];return-1===Vn.indexOf(Qe)?(N.push(N[Te-1]),U.push(Qe)):(N.push(Te),U.push(os))}return N.push(Te),31===je?U.push("strict"===R?Gt:ca):je===ua||29===je?U.push(os):43===je?U.push(ue>=131072&&ue<=196605||ue>=196608&&ue<=262141?ca:os):void U.push(je)}),[N,U,ee]}(k,R.lineBreak),N=U[0],ee=U[1],ue=U[2];return("break-all"===R.wordBreak||"break-word"===R.wordBreak)&&(ee=ee.map(function(je){return-1!==[Vt,os,ua].indexOf(je)?ca:je})),[N,ee,"keep-all"===R.wordBreak?ue.map(function(je,Qe){return je&&k[Qe]>=19968&&k[Qe]<=40959}):void 0]},Fo=function(){function k(R,U,N,ee){this.codePoints=R,this.required="!"===U,this.start=N,this.end=ee}return k.prototype.slice=function(){return Di.apply(void 0,this.codePoints.slice(this.start,this.end))},k}(),qi=function(k){return k>=48&&k<=57},Hd=function(k){return qi(k)||k>=65&&k<=70||k>=97&&k<=102},jd=function(k){return 10===k||9===k||32===k},Or=function(k){return function(k){return function(k){return k>=97&&k<=122}(k)||function(k){return k>=65&&k<=90}(k)}(k)||function(k){return k>=128}(k)||95===k},Of=function(k){return Or(k)||qi(k)||45===k},i_=function(k){return k>=0&&k<=8||11===k||k>=14&&k<=31||127===k},Ju=function(k,R){return 92===k&&10!==R},kf=function(k,R,U){return 45===k?Or(R)||Ju(R,U):!!Or(k)||!(92!==k||!Ju(k,R))},Du=function(k,R,U){return 43===k||45===k?!!qi(R)||46===R&&qi(U):qi(46===k?R:k)},ud=function(k){var R=0,U=1;(43===k[R]||45===k[R])&&(45===k[R]&&(U=-1),R++);for(var N=[];qi(k[R]);)N.push(k[R++]);var ee=N.length?parseInt(Di.apply(void 0,N),10):0;46===k[R]&&R++;for(var ue=[];qi(k[R]);)ue.push(k[R++]);var Te=ue.length,je=Te?parseInt(Di.apply(void 0,ue),10):0;(69===k[R]||101===k[R])&&R++;var Qe=1;(43===k[R]||45===k[R])&&(45===k[R]&&(Qe=-1),R++);for(var mt=[];qi(k[R]);)mt.push(k[R++]);var Mt=mt.length?parseInt(Di.apply(void 0,mt),10):0;return U*(ee+je*Math.pow(10,-Te))*Math.pow(10,Qe*Mt)},Lg={type:2},vs={type:3},yp={type:4},Oh={type:13},Pa={type:8},IA={type:21},D0={type:9},Uo={type:10},eh={type:11},gv={type:12},pi={type:14},Gd={type:23},vp={type:1},Ug={type:25},bp={type:24},DA={type:26},BA={type:27},zg={type:28},Pf={type:29},B0={type:31},ou={type:32},Jn=function(){function k(){this._value=[]}return k.prototype.write=function(R){this._value=this._value.concat(El(R))},k.prototype.read=function(){for(var R=[],U=this.consumeToken();U!==ou;)R.push(U),U=this.consumeToken();return R},k.prototype.consumeToken=function(){var R=this.consumeCodePoint();switch(R){case 34:return this.consumeStringToken(34);case 35:var U=this.peekCodePoint(0),N=this.peekCodePoint(1),ee=this.peekCodePoint(2);if(Of(U)||Ju(N,ee)){var ue=kf(U,N,ee)?2:1;return{type:5,value:this.consumeName(),flags:ue}}break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Oh;break;case 39:return this.consumeStringToken(39);case 40:return Lg;case 41:return vs;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),pi;break;case 43:if(Du(R,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(R),this.consumeNumericToken();break;case 44:return yp;case 45:var je=R,Qe=this.peekCodePoint(0),mt=this.peekCodePoint(1);if(Du(je,Qe,mt))return this.reconsumeCodePoint(R),this.consumeNumericToken();if(kf(je,Qe,mt))return this.reconsumeCodePoint(R),this.consumeIdentLikeToken();if(45===Qe&&62===mt)return this.consumeCodePoint(),this.consumeCodePoint(),bp;break;case 46:if(Du(R,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(R),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var Mt=this.consumeCodePoint();if(42===Mt&&47===(Mt=this.consumeCodePoint()))return this.consumeToken();if(-1===Mt)return this.consumeToken()}break;case 58:return DA;case 59:return BA;case 60:if(33===this.peekCodePoint(0)&&45===this.peekCodePoint(1)&&45===this.peekCodePoint(2))return this.consumeCodePoint(),this.consumeCodePoint(),Ug;break;case 64:var $t=this.peekCodePoint(0),yn=this.peekCodePoint(1),Xi=this.peekCodePoint(2);if(kf($t,yn,Xi))return{type:7,value:this.consumeName()};break;case 91:return zg;case 92:if(Ju(R,this.peekCodePoint(0)))return this.reconsumeCodePoint(R),this.consumeIdentLikeToken();break;case 93:return Pf;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Pa;break;case 123:return eh;case 125:return gv;case 117:case 85:var mn=this.peekCodePoint(0),Ni=this.peekCodePoint(1);return 43===mn&&(Hd(Ni)||63===Ni)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(R),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),D0;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),IA;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Uo;break;case-1:return ou}return jd(R)?(this.consumeWhiteSpace(),B0):qi(R)?(this.reconsumeCodePoint(R),this.consumeNumericToken()):Or(R)?(this.reconsumeCodePoint(R),this.consumeIdentLikeToken()):{type:6,value:Di(R)}},k.prototype.consumeCodePoint=function(){var R=this._value.shift();return typeof R>"u"?-1:R},k.prototype.reconsumeCodePoint=function(R){this._value.unshift(R)},k.prototype.peekCodePoint=function(R){return R>=this._value.length?-1:this._value[R]},k.prototype.consumeUnicodeRangeToken=function(){for(var R=[],U=this.consumeCodePoint();Hd(U)&&R.length<6;)R.push(U),U=this.consumeCodePoint();for(var N=!1;63===U&&R.length<6;)R.push(U),U=this.consumeCodePoint(),N=!0;if(N)return{type:30,start:parseInt(Di.apply(void 0,R.map(function(Qe){return 63===Qe?48:Qe})),16),end:parseInt(Di.apply(void 0,R.map(function(Qe){return 63===Qe?70:Qe})),16)};var Te=parseInt(Di.apply(void 0,R),16);if(45===this.peekCodePoint(0)&&Hd(this.peekCodePoint(1))){this.consumeCodePoint(),U=this.consumeCodePoint();for(var je=[];Hd(U)&&je.length<6;)je.push(U),U=this.consumeCodePoint();return{type:30,start:Te,end:parseInt(Di.apply(void 0,je),16)}}return{type:30,start:Te,end:Te}},k.prototype.consumeIdentLikeToken=function(){var R=this.consumeName();return"url"===R.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:19,value:R}):{type:20,value:R}},k.prototype.consumeUrlToken=function(){var R=[];if(this.consumeWhiteSpace(),-1===this.peekCodePoint(0))return{type:22,value:""};var U=this.peekCodePoint(0);if(39===U||34===U){var N=this.consumeStringToken(this.consumeCodePoint());return 0===N.type&&(this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:22,value:N.value}):(this.consumeBadUrlRemnants(),Gd)}for(;;){var ee=this.consumeCodePoint();if(-1===ee||41===ee)return{type:22,value:Di.apply(void 0,R)};if(jd(ee))return this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:22,value:Di.apply(void 0,R)}):(this.consumeBadUrlRemnants(),Gd);if(34===ee||39===ee||40===ee||i_(ee))return this.consumeBadUrlRemnants(),Gd;if(92===ee){if(!Ju(ee,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),Gd;R.push(this.consumeEscapedCodePoint())}else R.push(ee)}},k.prototype.consumeWhiteSpace=function(){for(;jd(this.peekCodePoint(0));)this.consumeCodePoint()},k.prototype.consumeBadUrlRemnants=function(){for(;;){var R=this.consumeCodePoint();if(41===R||-1===R)return;Ju(R,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},k.prototype.consumeStringSlice=function(R){for(var N="";R>0;){var ee=Math.min(5e4,R);N+=Di.apply(void 0,this._value.splice(0,ee)),R-=ee}return this._value.shift(),N},k.prototype.consumeStringToken=function(R){for(var U="",N=0;;){var ee=this._value[N];if(-1===ee||void 0===ee||ee===R)return{type:0,value:U+=this.consumeStringSlice(N)};if(10===ee)return this._value.splice(0,N),vp;if(92===ee){var ue=this._value[N+1];-1!==ue&&void 0!==ue&&(10===ue?(U+=this.consumeStringSlice(N),N=-1,this._value.shift()):Ju(ee,ue)&&(U+=this.consumeStringSlice(N),U+=Di(this.consumeEscapedCodePoint()),N=-1))}N++}},k.prototype.consumeNumber=function(){var R=[],U=4,N=this.peekCodePoint(0);for((43===N||45===N)&&R.push(this.consumeCodePoint());qi(this.peekCodePoint(0));)R.push(this.consumeCodePoint());N=this.peekCodePoint(0);var ee=this.peekCodePoint(1);if(46===N&&qi(ee))for(R.push(this.consumeCodePoint(),this.consumeCodePoint()),U=8;qi(this.peekCodePoint(0));)R.push(this.consumeCodePoint());N=this.peekCodePoint(0),ee=this.peekCodePoint(1);var ue=this.peekCodePoint(2);if((69===N||101===N)&&((43===ee||45===ee)&&qi(ue)||qi(ee)))for(R.push(this.consumeCodePoint(),this.consumeCodePoint()),U=8;qi(this.peekCodePoint(0));)R.push(this.consumeCodePoint());return[ud(R),U]},k.prototype.consumeNumericToken=function(){var R=this.consumeNumber(),U=R[0],N=R[1],ee=this.peekCodePoint(0),ue=this.peekCodePoint(1),Te=this.peekCodePoint(2);return kf(ee,ue,Te)?{type:15,number:U,flags:N,unit:this.consumeName()}:37===ee?(this.consumeCodePoint(),{type:16,number:U,flags:N}):{type:17,number:U,flags:N}},k.prototype.consumeEscapedCodePoint=function(){var R=this.consumeCodePoint();if(Hd(R)){for(var U=Di(R);Hd(this.peekCodePoint(0))&&U.length<6;)U+=Di(this.consumeCodePoint());jd(this.peekCodePoint(0))&&this.consumeCodePoint();var N=parseInt(U,16);return 0===N||function(k){return k>=55296&&k<=57343}(N)||N>1114111?65533:N}return-1===R?65533:R},k.prototype.consumeName=function(){for(var R="";;){var U=this.consumeCodePoint();if(Of(U))R+=Di(U);else{if(!Ju(U,this.peekCodePoint(0)))return this.reconsumeCodePoint(U),R;R+=Di(this.consumeEscapedCodePoint())}}},k}(),hd=function(){function k(R){this._tokens=R}return k.create=function(R){var U=new Jn;return U.write(R),new k(U.read())},k.parseValue=function(R){return k.create(R).parseComponentValue()},k.parseValues=function(R){return k.create(R).parseComponentValues()},k.prototype.parseComponentValue=function(){for(var R=this.consumeToken();31===R.type;)R=this.consumeToken();if(32===R.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(R);var U=this.consumeComponentValue();do{R=this.consumeToken()}while(31===R.type);if(32===R.type)return U;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},k.prototype.parseComponentValues=function(){for(var R=[];;){var U=this.consumeComponentValue();if(32===U.type)return R;R.push(U),R.push()}},k.prototype.consumeComponentValue=function(){var R=this.consumeToken();switch(R.type){case 11:case 28:case 2:return this.consumeSimpleBlock(R.type);case 19:return this.consumeFunction(R)}return R},k.prototype.consumeSimpleBlock=function(R){for(var U={type:R,values:[]},N=this.consumeToken();;){if(32===N.type||Nc(N,R))return U;this.reconsumeToken(N),U.values.push(this.consumeComponentValue()),N=this.consumeToken()}},k.prototype.consumeFunction=function(R){for(var U={name:R.value,values:[],type:18};;){var N=this.consumeToken();if(32===N.type||3===N.type)return U;this.reconsumeToken(N),U.values.push(this.consumeComponentValue())}},k.prototype.consumeToken=function(){var R=this._tokens.shift();return typeof R>"u"?ou:R},k.prototype.reconsumeToken=function(R){this._tokens.unshift(R)},k}(),dd=function(k){return 15===k.type},au=function(k){return 17===k.type},Co=function(k){return 20===k.type},$d=function(k){return 0===k.type},lu=function(k,R){return Co(k)&&k.value===R},wp=function(k){return 31!==k.type},Vl=function(k){return 31!==k.type&&4!==k.type},cu=function(k){var R=[],U=[];return k.forEach(function(N){if(4===N.type){if(0===U.length)throw new Error("Error parsing function args, zero tokens for arg");return R.push(U),void(U=[])}31!==N.type&&U.push(N)}),U.length&&R.push(U),R},Nc=function(k,R){return 11===R&&12===k.type||28===R&&29===k.type||2===R&&3===k.type},kh=function(k){return 17===k.type||15===k.type},Xt=function(k){return 16===k.type||kh(k)},qd=function(k){return k.length>1?[k[0],k[1]]:[k[0]]},In={type:17,number:0,flags:4},Nf={type:16,number:50,flags:4},th={type:16,number:100,flags:4},nh=function(k,R,U){var N=k[0],ee=k[1];return[ea(N,R),ea(typeof ee<"u"?ee:N,U)]},ea=function(k,R){if(16===k.type)return k.number/100*R;if(dd(k))switch(k.unit){case"rem":case"em":return 16*k.number;default:return k.number}return k.number},Ac_parse=function(k,R){if(15===R.type)switch(R.unit){case"deg":return Math.PI*R.number/180;case"grad":return Math.PI/200*R.number;case"rad":return R.number;case"turn":return 2*Math.PI*R.number}throw new Error("Unsupported angle type")},Lc=function(k){return 15===k.type&&("deg"===k.unit||"grad"===k.unit||"rad"===k.unit||"turn"===k.unit)},Ys=function(k){switch(k.filter(Co).map(function(U){return U.value}).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[In,In];case"to top":case"bottom":return ic(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[In,th];case"to right":case"left":return ic(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[th,th];case"to bottom":case"top":return ic(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[th,In];case"to left":case"right":return ic(270)}return 0},ic=function(k){return Math.PI*k/180},Bu_parse=function(k,R){if(18===R.type){var U=Uf[R.name];if(typeof U>"u")throw new Error('Attempting to parse an unsupported color function "'+R.name+'"');return U(k,R.values)}if(5===R.type){if(3===R.value.length){var N=R.value.substring(0,1),ee=R.value.substring(1,2),ue=R.value.substring(2,3);return Ia(parseInt(N+N,16),parseInt(ee+ee,16),parseInt(ue+ue,16),1)}if(4===R.value.length){N=R.value.substring(0,1),ee=R.value.substring(1,2),ue=R.value.substring(2,3);var Te=R.value.substring(3,4);return Ia(parseInt(N+N,16),parseInt(ee+ee,16),parseInt(ue+ue,16),parseInt(Te+Te,16)/255)}if(6===R.value.length)return N=R.value.substring(0,2),ee=R.value.substring(2,4),ue=R.value.substring(4,6),Ia(parseInt(N,16),parseInt(ee,16),parseInt(ue,16),1);if(8===R.value.length)return N=R.value.substring(0,2),ee=R.value.substring(2,4),ue=R.value.substring(4,6),Te=R.value.substring(6,8),Ia(parseInt(N,16),parseInt(ee,16),parseInt(ue,16),parseInt(Te,16)/255)}if(20===R.type){var je=Hl[R.value.toUpperCase()];if(typeof je<"u")return je}return Hl.TRANSPARENT},uu=function(k){return 0==(255&k)},Na=function(k){var R=255&k,U=255&k>>8,N=255&k>>16,ee=255&k>>24;return R<255?"rgba("+ee+","+N+","+U+","+R/255+")":"rgb("+ee+","+N+","+U+")"},Ia=function(k,R,U,N){return(k<<24|R<<16|U<<8|Math.round(255*N)<<0)>>>0},Ad=function(k,R){if(17===k.type)return k.number;if(16===k.type){var U=3===R?1:255;return 3===R?k.number/100*U:Math.round(k.number/100*U)}return 0},Lf=function(k,R){var U=R.filter(Vl);if(3===U.length){var N=U.map(Ad);return Ia(N[0],N[1],N[2],1)}if(4===U.length){var je=U.map(Ad);return Ia(je[0],je[1],je[2],je[3])}return 0};function MA(k,R,U){return U<0&&(U+=1),U>=1&&(U-=1),U<1/6?(R-k)*U*6+k:U<.5?R:U<2/3?6*(R-k)*(2/3-U)+k:k}var Kd=function(k,R){var U=R.filter(Vl),N=U[0],ee=U[1],ue=U[2],Te=U[3],je=(17===N.type?ic(N.number):Ac_parse(k,N))/(2*Math.PI),Qe=Xt(ee)?ee.number/100:0,mt=Xt(ue)?ue.number/100:0,Mt=typeof Te<"u"&&Xt(Te)?ea(Te,1):1;if(0===Qe)return Ia(255*mt,255*mt,255*mt,1);var $t=mt<=.5?mt*(Qe+1):mt+Qe-mt*Qe,yn=2*mt-$t,Xi=MA(yn,$t,je+1/3),mn=MA(yn,$t,je),Ni=MA(yn,$t,je-1/3);return Ia(255*Xi,255*mn,255*Ni,Mt)},Uf={hsl:Kd,hsla:Kd,rgb:Lf,rgba:Lf},rh=function(k,R){return Bu_parse(k,hd.create(R).parseComponentValue())},Hl={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},FA={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(k,R){return R.map(function(U){if(Co(U))switch(U.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},ul={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},sh=function(k,R){var U=Bu_parse(k,R[0]),N=R[1];return N&&Xt(N)?{color:U,stop:N}:{color:U,stop:null}},Ql=function(k,R){var U=k[0],N=k[k.length-1];null===U.stop&&(U.stop=In),null===N.stop&&(N.stop=th);for(var ee=[],ue=0,Te=0;Te<k.length;Te++){var je=k[Te].stop;if(null!==je){var Qe=ea(je,R);ee.push(Qe>ue?Qe:ue),ue=Qe}else ee.push(null)}var mt=null;for(Te=0;Te<ee.length;Te++){var Mt=ee[Te];if(null===Mt)null===mt&&(mt=Te);else if(null!==mt){for(var $t=Te-mt,Xi=(Mt-ee[mt-1])/($t+1),mn=1;mn<=$t;mn++)ee[mt+mn-1]=Xi*mn;mt=null}}return k.map(function(Ni,Lr){return{color:Ni.color,stop:Math.max(Math.min(1,ee[Lr]/R),0)}})},R0=function(k,R,U){var N="number"==typeof k?k:function(k,R,U){var N=R/2,ee=U/2,ue=ea(k[0],R)-N,Te=ee-ea(k[1],U);return(Math.atan2(Te,ue)+2*Math.PI)%(2*Math.PI)}(k,R,U),ee=Math.abs(R*Math.sin(N))+Math.abs(U*Math.cos(N)),ue=R/2,Te=U/2,je=ee/2,Qe=Math.sin(N-Math.PI/2)*je,mt=Math.cos(N-Math.PI/2)*je;return[ee,ue-mt,ue+mt,Te-Qe,Te+Qe]},va=function(k,R){return Math.sqrt(k*k+R*R)},Wd=function(k,R,U,N,ee){return[[0,0],[0,R],[k,0],[k,R]].reduce(function(Te,je){var Mt=va(U-je[0],N-je[1]);return(ee?Mt<Te.optimumDistance:Mt>Te.optimumDistance)?{optimumCorner:je,optimumDistance:Mt}:Te},{optimumDistance:ee?1/0:-1/0,optimumCorner:null}).optimumCorner},Ep=function(k,R){var U=ic(180),N=[];return cu(R).forEach(function(ee,ue){if(0===ue){var Te=ee[0];if(20===Te.type&&-1!==["top","left","right","bottom"].indexOf(Te.value))return void(U=Ys(ee));if(Lc(Te))return void(U=(Ac_parse(k,Te)+ic(270))%ic(360))}var je=sh(k,ee);N.push(je)}),{angle:U,stops:N,type:1}},s_="closest-side",Xd="farthest-side",Vg="closest-corner",o_="farthest-corner",Mr="ellipse",Sp="contain",ps=function(k,R){var U=0,N=3,ee=[],ue=[];return cu(R).forEach(function(Te,je){var Qe=!0;if(0===je?Qe=Te.reduce(function(Mt,$t){if(Co($t))switch($t.value){case"center":return ue.push(Nf),!1;case"top":case"left":return ue.push(In),!1;case"right":case"bottom":return ue.push(th),!1}else if(Xt($t)||kh($t))return ue.push($t),!1;return Mt},Qe):1===je&&(Qe=Te.reduce(function(Mt,$t){if(Co($t))switch($t.value){case"circle":return U=0,!1;case Mr:return U=1,!1;case Sp:case s_:return N=0,!1;case Xd:return N=1,!1;case Vg:return N=2,!1;case"cover":case o_:return N=3,!1}else if(kh($t)||Xt($t))return Array.isArray(N)||(N=[]),N.push($t),!1;return Mt},Qe)),Qe){var mt=sh(k,Te);ee.push(mt)}}),{size:N,shape:U,stops:ee,position:ue,type:2}},Xn_parse=function(k,R){if(22===R.type){var U={url:R.value,type:0};return k.cache.addImage(R.value),U}if(18===R.type){var N=Is[R.name];if(typeof N>"u")throw new Error('Attempting to parse an unsupported image function "'+R.name+'"');return N(k,R.values)}throw new Error("Unsupported image type "+R.type)};for(var Is={"linear-gradient":function(k,R){var U=ic(180),N=[];return cu(R).forEach(function(ee,ue){if(0===ue){var Te=ee[0];if(20===Te.type&&"to"===Te.value)return void(U=Ys(ee));if(Lc(Te))return void(U=Ac_parse(k,Te))}var je=sh(k,ee);N.push(je)}),{angle:U,stops:N,type:1}},"-moz-linear-gradient":Ep,"-ms-linear-gradient":Ep,"-o-linear-gradient":Ep,"-webkit-linear-gradient":Ep,"radial-gradient":function(k,R){var U=0,N=3,ee=[],ue=[];return cu(R).forEach(function(Te,je){var Qe=!0;if(0===je){var mt=!1;Qe=Te.reduce(function($t,yn){if(mt)if(Co(yn))switch(yn.value){case"center":return ue.push(Nf),$t;case"top":case"left":return ue.push(In),$t;case"right":case"bottom":return ue.push(th),$t}else(Xt(yn)||kh(yn))&&ue.push(yn);else if(Co(yn))switch(yn.value){case"circle":return U=0,!1;case Mr:return U=1,!1;case"at":return mt=!0,!1;case s_:return N=0,!1;case"cover":case Xd:return N=1,!1;case Sp:case Vg:return N=2,!1;case o_:return N=3,!1}else if(kh(yn)||Xt(yn))return Array.isArray(N)||(N=[]),N.push(yn),!1;return $t},Qe)}if(Qe){var Mt=sh(k,Te);ee.push(Mt)}}),{size:N,shape:U,stops:ee,position:ue,type:2}},"-moz-radial-gradient":ps,"-ms-radial-gradient":ps,"-o-radial-gradient":ps,"-webkit-radial-gradient":ps,"-webkit-gradient":function(k,R){var U=ic(180),N=[],ee=1;return cu(R).forEach(function(Qe,mt){var Mt=Qe[0];if(0===mt){if(Co(Mt)&&"linear"===Mt.value)return void(ee=1);if(Co(Mt)&&"radial"===Mt.value)return void(ee=2)}if(18===Mt.type)if("from"===Mt.name){var $t=Bu_parse(k,Mt.values[0]);N.push({stop:In,color:$t})}else if("to"===Mt.name)$t=Bu_parse(k,Mt.values[0]),N.push({stop:th,color:$t});else if("color-stop"===Mt.name){var yn=Mt.values.filter(Vl);if(2===yn.length){$t=Bu_parse(k,yn[1]);var Xi=yn[0];au(Xi)&&N.push({stop:{type:16,number:100*Xi.number,flags:Xi.flags},color:$t})}}}),1===ee?{angle:(U+ic(180))%ic(360),stops:N,type:ee}:{size:3,shape:0,stops:N,position:[],type:ee}}},dl={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(k,R){if(0===R.length)return[];var U=R[0];return 20===U.type&&"none"===U.value?[]:R.filter(function(N){return Vl(N)&&function hl(k){return!(20===k.type&&"none"===k.value||18===k.type&&!Is[k.name])}(N)}).map(function(N){return Xn_parse(k,N)})}},fl={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(k,R){return R.map(function(U){if(Co(U))switch(U.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},oh={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(k,R){return cu(R).map(function(U){return U.filter(Xt)}).map(qd)}},ra={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(k,R){return cu(R).map(function(U){return U.filter(Co).map(function(N){return N.value}).join(" ")}).map(zf)}},zf=function(k){switch(k){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}},Yd=function(k){return k.AUTO="auto",k.CONTAIN="contain",k.COVER="cover",k}(Yd||{}),Vf={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(k,R){return cu(R).map(function(U){return U.filter(l_)})}},l_=function(k){return Co(k)||Xt(k)},ah=function(k){return{name:"border-"+k+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Zi=ah("top"),Oi=ah("right"),gs=ah("bottom"),Wo=ah("left"),pc=function(k){return{name:"border-radius-"+k,initialValue:"0 0",prefix:!1,type:1,parse:function(R,U){return qd(U.filter(Xt))}}},Hf=pc("top-left"),jl=pc("top-right"),pd=pc("bottom-right"),Da=pc("bottom-left"),gc=function(k){return{name:"border-"+k+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(R,U){switch(U){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},lh=gc("top"),Zr=gc("right"),Qf=gc("bottom"),jf=gc("left"),ch=function(k){return{name:"border-"+k+"-width",initialValue:"0",type:0,prefix:!1,parse:function(R,U){return dd(U)?U.number:0}}},ba=ch("top"),Tp=ch("right"),OA=ch("bottom"),uh=ch("left"),Ip={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},jg={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(k,R){return"rtl"===R?1:0}},Ph={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(k,R){return R.filter(Co).reduce(function(U,N){return U|Nh(N.value)},0)}},Nh=function(k){switch(k){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Gf={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(k,R){switch(R){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},$f={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(k,R){return 20===R.type&&"normal"===R.value?0:17===R.type||15===R.type?R.number:0}},Ds=function(k){return k.NORMAL="normal",k.STRICT="strict",k}(Ds||{}),k0={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(k,R){return"strict"===R?Ds.STRICT:Ds.NORMAL}},Dp={name:"line-height",initialValue:"normal",prefix:!1,type:4},gd=function(k,R){return Co(k)&&"normal"===k.value?1.2*R:17===k.type?R*k.number:Xt(k)?ea(k,R):R},mc={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(k,R){return 20===R.type&&"none"===R.value?null:Xn_parse(k,R)}},kA={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(k,R){return"inside"===R?0:1}},Uc={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(k,R){switch(R){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},md=function(k){return{name:"margin-"+k,initialValue:"0",prefix:!1,type:4}},Ya=md("top"),P0=md("right"),_c=md("bottom"),Gl=md("left"),PA={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(k,R){return R.filter(Co).map(function(U){switch(U.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}})}},Jd={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(k,R){return"break-word"===R?"break-word":"normal"}},_d=function(k){return{name:"padding-"+k,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},yc=_d("top"),c_=_d("right"),mv=_d("bottom"),N0=_d("left"),_v={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(k,R){switch(R){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},Gg={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(k,R){switch(R){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Bp={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(k,R){return 1===R.length&&lu(R[0],"none")?[]:cu(R).map(function(U){for(var N={color:Hl.TRANSPARENT,offsetX:In,offsetY:In,blur:In},ee=0,ue=0;ue<U.length;ue++){var Te=U[ue];kh(Te)?(0===ee?N.offsetX=Te:1===ee?N.offsetY=Te:N.blur=Te,ee++):N.color=Bu_parse(k,Te)}return N})}},u_={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(k,R){switch(R){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},L0={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(k,R){if(20===R.type&&"none"===R.value)return null;if(18===R.type){var U=qg[R.name];if(typeof U>"u")throw new Error('Attempting to parse an unsupported transform function "'+R.name+'"');return U(R.values)}return null}},qg={matrix:function(k){var R=k.filter(function(U){return 17===U.type}).map(function(U){return U.number});return 6===R.length?R:null},matrix3d:function(k){var R=k.filter(function(Qe){return 17===Qe.type}).map(function(Qe){return Qe.number});return 16===R.length?[R[0],R[1],R[4],R[5],R[12],R[13]]:null}},Mp={type:16,number:50,flags:4},gb=[Mp,Mp],Lh={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(k,R){var U=R.filter(Xt);return 2!==U.length?gb:[U[0],U[1]]}},Uh={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(k,R){switch(R){case"hidden":return 1;case"collapse":return 2;default:return 0}}},hh=function(k){return k.NORMAL="normal",k.BREAK_ALL="break-all",k.KEEP_ALL="keep-all",k}(hh||{}),Kg={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(k,R){switch(R){case"break-all":return hh.BREAK_ALL;case"keep-all":return hh.KEEP_ALL;default:return hh.NORMAL}}},ai={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(k,R){if(20===R.type)return{auto:!0,order:0};if(au(R))return{auto:!1,order:R.number};throw new Error("Invalid z-index number parsed")}},Wg={name:"time",parse:function(k,R){if(15===R.type)switch(R.unit.toLowerCase()){case"s":return 1e3*R.number;case"ms":return R.number}throw new Error("Unsupported time type")}},Fp={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(k,R){return au(R)?R.number:1}},qf={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},NA={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(k,R){return R.filter(Co).map(function(U){switch(U.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(U){return 0!==U})}},gi={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(k,R){var U=[],N=[];return R.forEach(function(ee){switch(ee.type){case 20:case 0:U.push(ee.value);break;case 17:U.push(ee.number.toString());break;case 4:N.push(U.join(" ")),U.length=0}}),U.length&&N.push(U.join(" ")),N.map(function(ee){return-1===ee.indexOf(" ")?ee:"'"+ee+"'"})}},zc={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},ef={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(k,R){return au(R)?R.number:Co(R)&&"bold"===R.value?700:400}},mb={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(k,R){return R.filter(Co).map(function(U){return U.value})}},U0={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(k,R){switch(R){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},$s=function(k,R){return 0!=(k&R)},Rp={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(k,R){if(0===R.length)return[];var U=R[0];return 20===U.type&&"none"===U.value?[]:R}},hu={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(k,R){if(0===R.length)return null;var U=R[0];if(20===U.type&&"none"===U.value)return null;for(var N=[],ee=R.filter(wp),ue=0;ue<ee.length;ue++){var Te=ee[ue],je=ee[ue+1];if(20===Te.type){var Qe=je&&au(je)?je.number:1;N.push({counter:Te.value,increment:Qe})}}return N}},Zg={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(k,R){if(0===R.length)return[];for(var U=[],N=R.filter(wp),ee=0;ee<N.length;ee++){var ue=N[ee],Te=N[ee+1];if(Co(ue)&&"none"!==ue.value){var je=Te&&au(Te)?Te.number:0;U.push({counter:ue.value,reset:je})}}return U}},Xg={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(k,R){return R.filter(dd).map(function(U){return Wg.parse(k,U)})}},Yg={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(k,R){if(0===R.length)return null;var U=R[0];if(20===U.type&&"none"===U.value)return null;var N=[],ee=R.filter($d);if(ee.length%2!=0)return null;for(var ue=0;ue<ee.length;ue+=2)N.push({open:ee[ue].value,close:ee[ue+1].value});return N}},Op=function(k,R,U){if(!k)return"";var N=k[Math.min(R,k.length-1)];return N?U?N.open:N.close:""},kp={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(k,R){return 1===R.length&&lu(R[0],"none")?[]:cu(R).map(function(U){for(var N={color:255,offsetX:In,offsetY:In,blur:In,spread:In,inset:!1},ee=0,ue=0;ue<U.length;ue++){var Te=U[ue];lu(Te,"inset")?N.inset=!0:kh(Te)?(0===ee?N.offsetX=Te:1===ee?N.offsetY=Te:2===ee?N.blur=Te:N.spread=Te,ee++):N.color=Bu_parse(k,Te)}return N})}},vc={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(k,R){var N=[];return R.filter(Co).forEach(function(ee){switch(ee.value){case"stroke":N.push(1);break;case"fill":N.push(0);break;case"markers":N.push(2)}}),[0,1,2].forEach(function(ee){-1===N.indexOf(ee)&&N.push(ee)}),N}},zh={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Jg={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(k,R){return dd(R)?R.number:0}},em=function(){function k(R,U){var N,ee;this.animationDuration=Pi(R,Xg,U.animationDuration),this.backgroundClip=Pi(R,FA,U.backgroundClip),this.backgroundColor=Pi(R,ul,U.backgroundColor),this.backgroundImage=Pi(R,dl,U.backgroundImage),this.backgroundOrigin=Pi(R,fl,U.backgroundOrigin),this.backgroundPosition=Pi(R,oh,U.backgroundPosition),this.backgroundRepeat=Pi(R,ra,U.backgroundRepeat),this.backgroundSize=Pi(R,Vf,U.backgroundSize),this.borderTopColor=Pi(R,Zi,U.borderTopColor),this.borderRightColor=Pi(R,Oi,U.borderRightColor),this.borderBottomColor=Pi(R,gs,U.borderBottomColor),this.borderLeftColor=Pi(R,Wo,U.borderLeftColor),this.borderTopLeftRadius=Pi(R,Hf,U.borderTopLeftRadius),this.borderTopRightRadius=Pi(R,jl,U.borderTopRightRadius),this.borderBottomRightRadius=Pi(R,pd,U.borderBottomRightRadius),this.borderBottomLeftRadius=Pi(R,Da,U.borderBottomLeftRadius),this.borderTopStyle=Pi(R,lh,U.borderTopStyle),this.borderRightStyle=Pi(R,Zr,U.borderRightStyle),this.borderBottomStyle=Pi(R,Qf,U.borderBottomStyle),this.borderLeftStyle=Pi(R,jf,U.borderLeftStyle),this.borderTopWidth=Pi(R,ba,U.borderTopWidth),this.borderRightWidth=Pi(R,Tp,U.borderRightWidth),this.borderBottomWidth=Pi(R,OA,U.borderBottomWidth),this.borderLeftWidth=Pi(R,uh,U.borderLeftWidth),this.boxShadow=Pi(R,kp,U.boxShadow),this.color=Pi(R,Ip,U.color),this.direction=Pi(R,jg,U.direction),this.display=Pi(R,Ph,U.display),this.float=Pi(R,Gf,U.cssFloat),this.fontFamily=Pi(R,gi,U.fontFamily),this.fontSize=Pi(R,zc,U.fontSize),this.fontStyle=Pi(R,U0,U.fontStyle),this.fontVariant=Pi(R,mb,U.fontVariant),this.fontWeight=Pi(R,ef,U.fontWeight),this.letterSpacing=Pi(R,$f,U.letterSpacing),this.lineBreak=Pi(R,k0,U.lineBreak),this.lineHeight=Pi(R,Dp,U.lineHeight),this.listStyleImage=Pi(R,mc,U.listStyleImage),this.listStylePosition=Pi(R,kA,U.listStylePosition),this.listStyleType=Pi(R,Uc,U.listStyleType),this.marginTop=Pi(R,Ya,U.marginTop),this.marginRight=Pi(R,P0,U.marginRight),this.marginBottom=Pi(R,_c,U.marginBottom),this.marginLeft=Pi(R,Gl,U.marginLeft),this.opacity=Pi(R,Fp,U.opacity);var ue=Pi(R,PA,U.overflow);this.overflowX=ue[0],this.overflowY=ue[ue.length>1?1:0],this.overflowWrap=Pi(R,Jd,U.overflowWrap),this.paddingTop=Pi(R,yc,U.paddingTop),this.paddingRight=Pi(R,c_,U.paddingRight),this.paddingBottom=Pi(R,mv,U.paddingBottom),this.paddingLeft=Pi(R,N0,U.paddingLeft),this.paintOrder=Pi(R,vc,U.paintOrder),this.position=Pi(R,Gg,U.position),this.textAlign=Pi(R,_v,U.textAlign),this.textDecorationColor=Pi(R,qf,null!==(N=U.textDecorationColor)&&void 0!==N?N:U.color),this.textDecorationLine=Pi(R,NA,null!==(ee=U.textDecorationLine)&&void 0!==ee?ee:U.textDecoration),this.textShadow=Pi(R,Bp,U.textShadow),this.textTransform=Pi(R,u_,U.textTransform),this.transform=Pi(R,L0,U.transform),this.transformOrigin=Pi(R,Lh,U.transformOrigin),this.visibility=Pi(R,Uh,U.visibility),this.webkitTextStrokeColor=Pi(R,zh,U.webkitTextStrokeColor),this.webkitTextStrokeWidth=Pi(R,Jg,U.webkitTextStrokeWidth),this.wordBreak=Pi(R,Kg,U.wordBreak),this.zIndex=Pi(R,ai,U.zIndex)}return k.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},k.prototype.isTransparent=function(){return uu(this.backgroundColor)},k.prototype.isTransformed=function(){return null!==this.transform},k.prototype.isPositioned=function(){return 0!==this.position},k.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},k.prototype.isFloating=function(){return 0!==this.float},k.prototype.isInlineLevel=function(){return $s(this.display,4)||$s(this.display,33554432)||$s(this.display,268435456)||$s(this.display,536870912)||$s(this.display,67108864)||$s(this.display,134217728)},k}(),tm=function k(R,U){this.content=Pi(R,Rp,U.content),this.quotes=Pi(R,Yg,U.quotes)},Vh=function k(R,U){this.counterIncrement=Pi(R,hu,U.counterIncrement),this.counterReset=Pi(R,Zg,U.counterReset)},Pi=function(k,R,U){var N=new Jn,ee=null!==U&&typeof U<"u"?U.toString():R.initialValue;N.write(ee);var ue=new hd(N.read());switch(R.type){case 2:var Te=ue.parseComponentValue();return R.parse(k,Co(Te)?Te.value:R.initialValue);case 0:return R.parse(k,ue.parseComponentValue());case 1:return R.parse(k,ue.parseComponentValues());case 4:return ue.parseComponentValue();case 3:switch(R.format){case"angle":return Ac_parse(k,ue.parseComponentValue());case"color":return Bu_parse(k,ue.parseComponentValue());case"image":return Xn_parse(k,ue.parseComponentValue());case"length":var je=ue.parseComponentValue();return kh(je)?je:In;case"length-percentage":var Qe=ue.parseComponentValue();return Xt(Qe)?Qe:In;case"time":return Wg.parse(k,ue.parseComponentValue())}}},Kf=function(k,R){var U=function(k){switch(k.getAttribute("data-html2canvas-debug")){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}}(k);return 1===U||R===U},dh=function k(R,U){this.context=R,this.textNodes=[],this.elements=[],this.flags=0,Kf(U,3),this.styles=new em(R,window.getComputedStyle(U,null)),d(U)&&(this.styles.animationDuration.some(function(N){return N>0})&&(U.style.animationDuration="0s"),null!==this.styles.transform&&(U.style.transform="none")),this.bounds=Ra(this.context,U),Kf(U,4)&&(this.flags|=16)},d_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fh=typeof Uint8Array>"u"?[]:new Uint8Array(256),nm=0;nm<64;nm++)fh[d_.charCodeAt(nm)]=nm;for(var VA=function(k,R,U){return k.slice?k.slice(R,U):new Uint16Array(Array.prototype.slice.call(k,R,U))},Np=function(){function k(R,U,N,ee,ue,Te){this.initialValue=R,this.errorValue=U,this.highStart=N,this.highValueIndex=ee,this.index=ue,this.data=Te}return k.prototype.get=function(R){var U;if(R>=0){if(R<55296||R>56319&&R<=65535)return this.data[U=((U=this.index[R>>5])<<2)+(31&R)];if(R<=65535)return this.data[U=((U=this.index[2048+(R-55296>>5)])<<2)+(31&R)];if(R<this.highStart)return U=this.index[U=2080+(R>>11)],this.data[U=((U=this.index[U+=R>>5&63])<<2)+(31&R)];if(R<=1114111)return this.data[this.highValueIndex]}return this.errorValue},k}(),Lp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",sm=typeof Uint8Array>"u"?[]:new Uint8Array(256),yd=0;yd<64;yd++)sm[Lp.charCodeAt(yd)]=yd;var Hs=8,Al=9,ql=11,om=12,zp=function(){for(var k=[],R=0;R<arguments.length;R++)k[R]=arguments[R];if(String.fromCodePoint)return String.fromCodePoint.apply(String,k);var U=k.length;if(!U)return"";for(var N=[],ee=-1,ue="";++ee<U;){var Te=k[ee];Te<=65535?N.push(Te):N.push(55296+((Te-=65536)>>10),Te%1024+56320),(ee+1===U||N.length>16384)&&(ue+=String.fromCharCode.apply(String,N),N.length=0)}return ue},p_=function(k,R){var U=function(k){var N,ue,Te,je,Qe,R=.75*k.length,U=k.length,ee=0;"="===k[k.length-1]&&(R--,"="===k[k.length-2]&&R--);var mt=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(R):new Array(R),Mt=Array.isArray(mt)?mt:new Uint8Array(mt);for(N=0;N<U;N+=4)ue=fh[k.charCodeAt(N)],Te=fh[k.charCodeAt(N+1)],je=fh[k.charCodeAt(N+2)],Qe=fh[k.charCodeAt(N+3)],Mt[ee++]=ue<<2|Te>>4,Mt[ee++]=(15&Te)<<4|je>>2,Mt[ee++]=(3&je)<<6|63&Qe;return mt}(k),N=Array.isArray(U)?function(k){for(var R=k.length,U=[],N=0;N<R;N+=4)U.push(k[N+3]<<24|k[N+2]<<16|k[N+1]<<8|k[N]);return U}(U):new Uint32Array(U),ee=Array.isArray(U)?function(k){for(var R=k.length,U=[],N=0;N<R;N+=2)U.push(k[N+1]<<8|k[N]);return U}(U):new Uint16Array(U),Te=VA(ee,12,N[4]/2),je=2===N[5]?VA(ee,(24+N[4])/2):function(k,R,U){return k.slice?k.slice(R,U):new Uint32Array(Array.prototype.slice.call(k,R,U))}(N,Math.ceil((24+N[4])/4));return new Np(N[0],N[1],N[2],N[3],Te,je)}("AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA="),g_=function(k){return p_.get(k)},jA=function(k,R,U){var N=U-2,ee=R[N],ue=R[U-1],Te=R[U];if(2===ue&&3===Te)return"\xd7";if(2===ue||3===ue||4===ue||2===Te||3===Te||4===Te)return"\xf7";if(ue===Hs&&-1!==[Hs,Al,ql,om].indexOf(Te)||(ue===ql||ue===Al)&&(Te===Al||10===Te)||(ue===om||10===ue)&&10===Te||13===Te||5===Te||7===Te||1===ue)return"\xd7";if(13===ue&&14===Te){for(;5===ee;)ee=R[--N];if(14===ee)return"\xd7"}if(15===ue&&15===Te){for(var je=0;15===ee;)je++,ee=R[--N];if(je%2==0)return"\xd7"}return"\xf7"},Vp=function(k){var R=function(k){for(var R=[],U=0,N=k.length;U<N;){var ee=k.charCodeAt(U++);if(ee>=55296&&ee<=56319&&U<N){var ue=k.charCodeAt(U++);56320==(64512&ue)?R.push(((1023&ee)<<10)+(1023&ue)+65536):(R.push(ee),U--)}else R.push(ee)}return R}(k),U=R.length,N=0,ee=0,ue=R.map(g_);return{next:function(){if(N>=U)return{done:!0,value:null};for(var Te="\xd7";N<U&&"\xd7"===(Te=jA(0,ue,++N)););if("\xd7"!==Te||N===U){var je=zp.apply(null,R.slice(ee,N));return ee=N,{value:je,done:!1}}return{done:!0,value:null}}}},um=function(k){return 0===k[0]&&255===k[1]&&0===k[2]&&255===k[3]},GA=function(k,R,U,N,ee){var ue="http://www.w3.org/2000/svg",Te=document.createElementNS(ue,"svg"),je=document.createElementNS(ue,"foreignObject");return Te.setAttributeNS(null,"width",k.toString()),Te.setAttributeNS(null,"height",R.toString()),je.setAttributeNS(null,"width","100%"),je.setAttributeNS(null,"height","100%"),je.setAttributeNS(null,"x",U.toString()),je.setAttributeNS(null,"y",N.toString()),je.setAttributeNS(null,"externalResourcesRequired","true"),Te.appendChild(je),je.appendChild(ee),Te},Au=function(k){return new Promise(function(R,U){var N=new Image;N.onload=function(){return R(N)},N.onerror=U,N.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(k))})},Ua={get SUPPORT_RANGE_BOUNDS(){var k=function(k){if(k.createRange){var U=k.createRange();if(U.getBoundingClientRect){var N=k.createElement("boundtest");N.style.height="123px",N.style.display="block",k.body.appendChild(N),U.selectNode(N);var ee=U.getBoundingClientRect(),ue=Math.round(ee.height);if(k.body.removeChild(N),123===ue)return!0}}return!1}(document);return Object.defineProperty(Ua,"SUPPORT_RANGE_BOUNDS",{value:k}),k},get SUPPORT_WORD_BREAKING(){var k=Ua.SUPPORT_RANGE_BOUNDS&&function(k){var R=k.createElement("boundtest");R.style.width="50px",R.style.display="block",R.style.fontSize="12px",R.style.letterSpacing="0px",R.style.wordSpacing="0px",k.body.appendChild(R);var U=k.createRange();R.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var N=R.firstChild,ee=El(N.data).map(function(Qe){return Di(Qe)}),ue=0,Te={},je=ee.every(function(Qe,mt){U.setStart(N,ue),U.setEnd(N,ue+Qe.length);var Mt=U.getBoundingClientRect();ue+=Qe.length;var $t=Mt.x>Te.x||Mt.y>Te.y;return Te=Mt,0===mt||$t});return k.body.removeChild(R),je}(document);return Object.defineProperty(Ua,"SUPPORT_WORD_BREAKING",{value:k}),k},get SUPPORT_SVG_DRAWING(){var k=function(k){var R=new Image,U=k.createElement("canvas"),N=U.getContext("2d");if(!N)return!1;R.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{N.drawImage(R,0,0),U.toDataURL()}catch{return!1}return!0}(document);return Object.defineProperty(Ua,"SUPPORT_SVG_DRAWING",{value:k}),k},get SUPPORT_FOREIGNOBJECT_DRAWING(){var k="function"==typeof Array.from&&"function"==typeof window.fetch?function(k){var R=k.createElement("canvas"),U=100;R.width=U,R.height=U;var N=R.getContext("2d");if(!N)return Promise.reject(!1);N.fillStyle="rgb(0, 255, 0)",N.fillRect(0,0,U,U);var ee=new Image,ue=R.toDataURL();ee.src=ue;var Te=GA(U,U,0,0,ee);return N.fillStyle="red",N.fillRect(0,0,U,U),Au(Te).then(function(je){N.drawImage(je,0,0);var Qe=N.getImageData(0,0,U,U).data;N.fillStyle="red",N.fillRect(0,0,U,U);var mt=k.createElement("div");return mt.style.backgroundImage="url("+ue+")",mt.style.height=U+"px",um(Qe)?Au(GA(U,U,0,0,mt)):Promise.reject(!1)}).then(function(je){return N.drawImage(je,0,0),um(N.getImageData(0,0,U,U).data)}).catch(function(){return!1})}(document):Promise.resolve(!1);return Object.defineProperty(Ua,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:k}),k},get SUPPORT_CORS_IMAGES(){var k=typeof(new Image).crossOrigin<"u";return Object.defineProperty(Ua,"SUPPORT_CORS_IMAGES",{value:k}),k},get SUPPORT_RESPONSE_TYPE(){var k="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(Ua,"SUPPORT_RESPONSE_TYPE",{value:k}),k},get SUPPORT_CORS_XHR(){var k="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Ua,"SUPPORT_CORS_XHR",{value:k}),k},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var k=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Ua,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:k}),k}},Zf=function k(R,U){this.text=R,this.bounds=U},m_=function(k,R){var U=R.ownerDocument;if(U){var N=U.createElement("html2canvaswrapper");N.appendChild(R.cloneNode(!0));var ee=R.parentNode;if(ee){ee.replaceChild(N,R);var ue=Ra(k,N);return N.firstChild&&ee.replaceChild(N.firstChild,N),ue}}return Ai.EMPTY},__=function(k,R,U){var N=k.ownerDocument;if(!N)throw new Error("Node has no owner document");var ee=N.createRange();return ee.setStart(k,R),ee.setEnd(k,R+U),ee},Qn=function(k){if(Ua.SUPPORT_NATIVE_TEXT_SEGMENTATION){var R=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(R.segment(k)).map(function(U){return U.segment})}return function(k){for(var N,R=Vp(k),U=[];!(N=R.next()).done;)N.value&&U.push(N.value.slice());return U}(k)},ti=function(k,R){return 0!==R.letterSpacing?Qn(k):function(k,R){if(Ua.SUPPORT_NATIVE_TEXT_SEGMENTATION){var U=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(U.segment(k)).map(function(N){return N.segment})}return Dl(k,R)}(k,R)},ni=[32,160,4961,65792,65793,4153,4241],Dl=function(k,R){for(var ee,U=function(k,R){var U=El(k),N=qo(U,R),ee=N[0],ue=N[1],Te=N[2],je=U.length,Qe=0,mt=0;return{next:function(){if(mt>=je)return{done:!0,value:null};for(var Mt=Wt;mt<je&&(Mt=es(U,ue,ee,++mt,Te))===Wt;);if(Mt!==Wt||mt===je){var $t=new Fo(U,Mt,Qe,mt);return Qe=mt,{value:$t,done:!1}}return{done:!0,value:null}}}}(k,{lineBreak:R.lineBreak,wordBreak:"break-word"===R.overflowWrap?"break-word":R.wordBreak}),N=[],ue=function(){if(ee.value){var Te=ee.value.slice(),je=El(Te),Qe="";je.forEach(function(mt){-1===ni.indexOf(mt)?Qe+=Di(mt):(Qe.length&&N.push(Qe),N.push(Di(mt)),Qe="")}),Qe.length&&N.push(Qe)}};!(ee=U.next()).done;)ue();return N},y_=function k(R,U,N){this.text=vd(U.data,N.textTransform),this.textBounds=function(k,R,U,N){var ee=ti(R,U),ue=[],Te=0;return ee.forEach(function(je){if(U.textDecorationLine.length||je.trim().length>0)if(Ua.SUPPORT_RANGE_BOUNDS){var Qe=__(N,Te,je.length).getClientRects();if(Qe.length>1){var mt=Qn(je),Mt=0;mt.forEach(function(yn){ue.push(new Zf(yn,Ai.fromDOMRectList(k,__(N,Mt+Te,yn.length).getClientRects()))),Mt+=yn.length})}else ue.push(new Zf(je,Ai.fromDOMRectList(k,Qe)))}else{var $t=N.splitText(je.length);ue.push(new Zf(je,m_(k,N))),N=$t}else Ua.SUPPORT_RANGE_BOUNDS||(N=N.splitText(je.length));Te+=je.length}),ue}(R,this.text,N,U)},vd=function(k,R){switch(R){case 1:return k.toLowerCase();case 3:return k.replace(ph,hm);case 2:return k.toUpperCase();default:return k}},ph=/(^|\s|:|-|\(|\))([a-z])/g,hm=function(k,R,U){return k.length>0?R+U.toUpperCase():k},rf=function(k){function R(U,N){var ee=k.call(this,U,N)||this;return ee.src=N.currentSrc||N.src,ee.intrinsicWidth=N.naturalWidth,ee.intrinsicHeight=N.naturalHeight,ee.context.cache.addImage(ee.src),ee}return Zs(R,k),R}(dh),Q0=function(k){function R(U,N){var ee=k.call(this,U,N)||this;return ee.canvas=N,ee.intrinsicWidth=N.width,ee.intrinsicHeight=N.height,ee}return Zs(R,k),R}(dh),j0=function(k){function R(U,N){var ee=k.call(this,U,N)||this,ue=new XMLSerializer,Te=Ra(U,N);return N.setAttribute("width",Te.width+"px"),N.setAttribute("height",Te.height+"px"),ee.svg="data:image/svg+xml,"+encodeURIComponent(ue.serializeToString(N)),ee.intrinsicWidth=N.width.baseVal.value,ee.intrinsicHeight=N.height.baseVal.value,ee.context.cache.addImage(ee.svg),ee}return Zs(R,k),R}(dh),zo=function(k){function R(U,N){var ee=k.call(this,U,N)||this;return ee.value=N.value,ee}return Zs(R,k),R}(dh),pl=function(k){function R(U,N){var ee=k.call(this,U,N)||this;return ee.start=N.start,ee.reversed="boolean"==typeof N.reversed&&!0===N.reversed,ee}return Zs(R,k),R}(dh),Qh=[{type:15,flags:0,unit:"px",number:3}],v_=[{type:16,flags:0,number:50}],$A="checkbox",qA="radio",G0="password",b_=707406591,Xf=function(k){function R(U,N){var ee=k.call(this,U,N)||this;switch(ee.type=N.type.toLowerCase(),ee.checked=N.checked,ee.value=function(k){var R=k.type===G0?new Array(k.value.length+1).join("\u2022"):k.value;return 0===R.length?k.placeholder||"":R}(N),(ee.type===$A||ee.type===qA)&&(ee.styles.backgroundColor=3739148031,ee.styles.borderTopColor=ee.styles.borderRightColor=ee.styles.borderBottomColor=ee.styles.borderLeftColor=2779096575,ee.styles.borderTopWidth=ee.styles.borderRightWidth=ee.styles.borderBottomWidth=ee.styles.borderLeftWidth=1,ee.styles.borderTopStyle=ee.styles.borderRightStyle=ee.styles.borderBottomStyle=ee.styles.borderLeftStyle=1,ee.styles.backgroundClip=[0],ee.styles.backgroundOrigin=[0],ee.bounds=function(k){return k.width>k.height?new Ai(k.left+(k.width-k.height)/2,k.top,k.height,k.height):k.width<k.height?new Ai(k.left,k.top+(k.height-k.width)/2,k.width,k.width):k}(ee.bounds)),ee.type){case $A:ee.styles.borderTopRightRadius=ee.styles.borderTopLeftRadius=ee.styles.borderBottomRightRadius=ee.styles.borderBottomLeftRadius=Qh;break;case qA:ee.styles.borderTopRightRadius=ee.styles.borderTopLeftRadius=ee.styles.borderBottomRightRadius=ee.styles.borderBottomLeftRadius=v_}return ee}return Zs(R,k),R}(dh),sf=function(k){function R(U,N){var ee=k.call(this,U,N)||this,ue=N.options[N.selectedIndex||0];return ee.value=ue&&ue.text||"",ee}return Zs(R,k),R}(dh),dm=function(k){function R(U,N){var ee=k.call(this,U,N)||this;return ee.value=N.value,ee}return Zs(R,k),R}(dh),KA=function(k){function R(U,N){var ee=k.call(this,U,N)||this;ee.src=N.src,ee.width=parseInt(N.width,10)||0,ee.height=parseInt(N.height,10)||0,ee.backgroundColor=ee.styles.backgroundColor;try{if(N.contentWindow&&N.contentWindow.document&&N.contentWindow.document.documentElement){ee.tree=Bl(U,N.contentWindow.document.documentElement);var ue=N.contentWindow.document.documentElement?rh(U,getComputedStyle(N.contentWindow.document.documentElement).backgroundColor):Hl.TRANSPARENT,Te=N.contentWindow.document.body?rh(U,getComputedStyle(N.contentWindow.document.body).backgroundColor):Hl.TRANSPARENT;ee.backgroundColor=uu(ue)?uu(Te)?ee.styles.backgroundColor:Te:ue}}catch{}return ee}return Zs(R,k),R}(dh),fm=["OL","UL","MENU"],pu=function(k,R,U,N){for(var ee=R.firstChild,ue=void 0;ee;ee=ue)if(ue=ee.nextSibling,_(ee)&&ee.data.trim().length>0)U.textNodes.push(new y_(k,ee,U.styles));else if(c(ee))if(me(ee)&&ee.assignedNodes)ee.assignedNodes().forEach(function(je){return pu(k,je,U,N)});else{var Te=Yf(k,ee);Te.styles.isVisible()&&(bd(ee,Te,N)?Te.flags|=4:w_(Te.styles)&&(Te.flags|=2),-1!==fm.indexOf(ee.tagName)&&(Te.flags|=8),U.elements.push(Te),ee.shadowRoot?pu(k,ee.shadowRoot,Te,N):!Ae(ee)&&!P(ee)&&!se(ee)&&pu(k,ee,Te,N))}},Yf=function(k,R){return J(R)?new rf(k,R):j(R)?new Q0(k,R):P(R)?new j0(k,R):w(R)?new zo(k,R):C(R)?new pl(k,R):I(R)?new Xf(k,R):se(R)?new sf(k,R):Ae(R)?new dm(k,R):te(R)?new KA(k,R):new dh(k,R)},Bl=function(k,R){var U=Yf(k,R);return U.flags|=4,pu(k,R,U,U),U},bd=function(k,R,U){return R.styles.isPositionedWithZIndex()||R.styles.opacity<1||R.styles.isTransformed()||Q(k)&&U.styles.isTransparent()},w_=function(k){return k.isPositioned()||k.isFloating()},_=function(k){return k.nodeType===Node.TEXT_NODE},c=function(k){return k.nodeType===Node.ELEMENT_NODE},d=function(k){return c(k)&&typeof k.style<"u"&&!y(k)},y=function(k){return"object"==typeof k.className},w=function(k){return"LI"===k.tagName},C=function(k){return"OL"===k.tagName},I=function(k){return"INPUT"===k.tagName},P=function(k){return"svg"===k.tagName},Q=function(k){return"BODY"===k.tagName},j=function(k){return"CANVAS"===k.tagName},q=function(k){return"VIDEO"===k.tagName},J=function(k){return"IMG"===k.tagName},te=function(k){return"IFRAME"===k.tagName},le=function(k){return"STYLE"===k.tagName},Ae=function(k){return"TEXTAREA"===k.tagName},se=function(k){return"SELECT"===k.tagName},me=function(k){return"SLOT"===k.tagName},Ie=function(k){return k.tagName.indexOf("-")>0},xe=function(){function k(){this.counters={}}return k.prototype.getCounterValue=function(R){var U=this.counters[R];return U&&U.length?U[U.length-1]:1},k.prototype.getCounterValues=function(R){return this.counters[R]||[]},k.prototype.pop=function(R){var U=this;R.forEach(function(N){return U.counters[N].pop()})},k.prototype.parse=function(R){var U=this,N=R.counterIncrement,ee=R.counterReset,ue=!0;null!==N&&N.forEach(function(je){var Qe=U.counters[je.counter];Qe&&0!==je.increment&&(ue=!1,Qe.length||Qe.push(1),Qe[Math.max(0,Qe.length-1)]+=je.increment)});var Te=[];return ue&&ee.forEach(function(je){var Qe=U.counters[je.counter];Te.push(je.counter),Qe||(Qe=U.counters[je.counter]=[]),Qe.push(je.reset)}),Te},k}(),Be={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},ge={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054f","\u054e","\u054d","\u054c","\u054b","\u054a","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053f","\u053e","\u053d","\u053c","\u053b","\u053a","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},Me={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05d9\u05f3","\u05d8\u05f3","\u05d7\u05f3","\u05d6\u05f3","\u05d5\u05f3","\u05d4\u05f3","\u05d3\u05f3","\u05d2\u05f3","\u05d1\u05f3","\u05d0\u05f3","\u05ea","\u05e9","\u05e8","\u05e7","\u05e6","\u05e4","\u05e2","\u05e1","\u05e0","\u05de","\u05dc","\u05db","\u05d9\u05d8","\u05d9\u05d7","\u05d9\u05d6","\u05d8\u05d6","\u05d8\u05d5","\u05d9","\u05d8","\u05d7","\u05d6","\u05d5","\u05d4","\u05d3","\u05d2","\u05d1","\u05d0"]},He={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10f5","\u10f0","\u10ef","\u10f4","\u10ee","\u10ed","\u10ec","\u10eb","\u10ea","\u10e9","\u10e8","\u10e7","\u10e6","\u10e5","\u10e4","\u10f3","\u10e2","\u10e1","\u10e0","\u10df","\u10de","\u10dd","\u10f2","\u10dc","\u10db","\u10da","\u10d9","\u10d8","\u10d7","\u10f1","\u10d6","\u10d5","\u10d4","\u10d3","\u10d2","\u10d1","\u10d0"]},Ge=function(k,R,U,N,ee,ue){return k<R||k>U?Cn(k,ee,ue.length>0):N.integers.reduce(function(Te,je,Qe){for(;k>=je;)k-=je,Te+=N.values[Qe];return Te},"")+ue},nt=function(k,R,U,N){var ee="";do{U||k--,ee=N(k)+ee,k/=R}while(k*R>=R);return ee},dt=function(k,R,U,N,ee){var ue=U-R+1;return(k<0?"-":"")+(nt(Math.abs(k),ue,N,function(Te){return Di(Math.floor(Te%ue)+R)})+ee)},ot=function(k,R,U){void 0===U&&(U=". ");var N=R.length;return nt(Math.abs(k),N,!1,function(ee){return R[Math.floor(ee%N)]})+U},St=function(k,R,U,N,ee,ue){if(k<-9999||k>9999)return Cn(k,4,ee.length>0);var Te=Math.abs(k),je=ee;if(0===Te)return R[0]+je;for(var Qe=0;Te>0&&Qe<=4;Qe++){var mt=Te%10;0===mt&&$s(ue,1)&&""!==je?je=R[mt]+je:mt>1||1===mt&&0===Qe||1===mt&&1===Qe&&$s(ue,2)||1===mt&&1===Qe&&$s(ue,4)&&k>100||1===mt&&Qe>1&&$s(ue,8)?je=R[mt]+(Qe>0?U[Qe-1]:"")+je:1===mt&&Qe>0&&(je=U[Qe-1]+je),Te=Math.floor(Te/10)}return(k<0?N:"")+je},Tn="\ub9c8\uc774\ub108\uc2a4",Cn=function(k,R,U){var N=U?". ":"",ee=U?"\u3001":"",ue=U?", ":"",Te=U?" ":"";switch(R){case 0:return"\u2022"+Te;case 1:return"\u25e6"+Te;case 2:return"\u25fe"+Te;case 5:var je=dt(k,48,57,!0,N);return je.length<4?"0"+je:je;case 4:return ot(k,"\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d",ee);case 6:return Ge(k,1,3999,Be,3,N).toLowerCase();case 7:return Ge(k,1,3999,Be,3,N);case 8:return dt(k,945,969,!1,N);case 9:return dt(k,97,122,!1,N);case 10:return dt(k,65,90,!1,N);case 11:return dt(k,1632,1641,!0,N);case 12:case 49:return Ge(k,1,9999,ge,3,N);case 35:return Ge(k,1,9999,ge,3,N).toLowerCase();case 13:return dt(k,2534,2543,!0,N);case 14:case 30:return dt(k,6112,6121,!0,N);case 15:return ot(k,"\u5b50\u4e11\u5bc5\u536f\u8fb0\u5df3\u5348\u672a\u7533\u9149\u620c\u4ea5",ee);case 16:return ot(k,"\u7532\u4e59\u4e19\u4e01\u620a\u5df1\u5e9a\u8f9b\u58ec\u7678",ee);case 17:case 48:return St(k,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c","\u8ca0",ee,14);case 47:return St(k,"\u96f6\u58f9\u8cb3\u53c3\u8086\u4f0d\u9678\u67d2\u634c\u7396","\u62fe\u4f70\u4edf\u842c","\u8ca0",ee,15);case 42:return St(k,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c","\u8d1f",ee,14);case 41:return St(k,"\u96f6\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c\u7396","\u62fe\u4f70\u4edf\u842c","\u8d1f",ee,15);case 26:return St(k,"\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u4e07","\u30de\u30a4\u30ca\u30b9",ee,0);case 25:return St(k,"\u96f6\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d","\u62fe\u767e\u5343\u4e07","\u30de\u30a4\u30ca\u30b9",ee,7);case 31:return St(k,"\uc601\uc77c\uc774\uc0bc\uc0ac\uc624\uc721\uce60\ud314\uad6c","\uc2ed\ubc31\ucc9c\ub9cc",Tn,ue,7);case 33:return St(k,"\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u5341\u767e\u5343\u842c",Tn,ue,0);case 32:return St(k,"\u96f6\u58f9\u8cb3\u53c3\u56db\u4e94\u516d\u4e03\u516b\u4e5d","\u62fe\u767e\u5343",Tn,ue,7);case 18:return dt(k,2406,2415,!0,N);case 20:return Ge(k,1,19999,He,3,N);case 21:return dt(k,2790,2799,!0,N);case 22:return dt(k,2662,2671,!0,N);case 22:return Ge(k,1,10999,Me,3,N);case 23:return ot(k,"\u3042\u3044\u3046\u3048\u304a\u304b\u304d\u304f\u3051\u3053\u3055\u3057\u3059\u305b\u305d\u305f\u3061\u3064\u3066\u3068\u306a\u306b\u306c\u306d\u306e\u306f\u3072\u3075\u3078\u307b\u307e\u307f\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308a\u308b\u308c\u308d\u308f\u3090\u3091\u3092\u3093");case 24:return ot(k,"\u3044\u308d\u306f\u306b\u307b\u3078\u3068\u3061\u308a\u306c\u308b\u3092\u308f\u304b\u3088\u305f\u308c\u305d\u3064\u306d\u306a\u3089\u3080\u3046\u3090\u306e\u304a\u304f\u3084\u307e\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304d\u3086\u3081\u307f\u3057\u3091\u3072\u3082\u305b\u3059");case 27:return dt(k,3302,3311,!0,N);case 28:return ot(k,"\u30a2\u30a4\u30a6\u30a8\u30aa\u30ab\u30ad\u30af\u30b1\u30b3\u30b5\u30b7\u30b9\u30bb\u30bd\u30bf\u30c1\u30c4\u30c6\u30c8\u30ca\u30cb\u30cc\u30cd\u30ce\u30cf\u30d2\u30d5\u30d8\u30db\u30de\u30df\u30e0\u30e1\u30e2\u30e4\u30e6\u30e8\u30e9\u30ea\u30eb\u30ec\u30ed\u30ef\u30f0\u30f1\u30f2\u30f3",ee);case 29:return ot(k,"\u30a4\u30ed\u30cf\u30cb\u30db\u30d8\u30c8\u30c1\u30ea\u30cc\u30eb\u30f2\u30ef\u30ab\u30e8\u30bf\u30ec\u30bd\u30c4\u30cd\u30ca\u30e9\u30e0\u30a6\u30f0\u30ce\u30aa\u30af\u30e4\u30de\u30b1\u30d5\u30b3\u30a8\u30c6\u30a2\u30b5\u30ad\u30e6\u30e1\u30df\u30b7\u30f1\u30d2\u30e2\u30bb\u30b9",ee);case 34:return dt(k,3792,3801,!0,N);case 37:return dt(k,6160,6169,!0,N);case 38:return dt(k,4160,4169,!0,N);case 39:return dt(k,2918,2927,!0,N);case 40:return dt(k,1776,1785,!0,N);case 43:return dt(k,3046,3055,!0,N);case 44:return dt(k,3174,3183,!0,N);case 45:return dt(k,3664,3673,!0,N);case 46:return dt(k,3872,3881,!0,N);default:return dt(k,48,57,!0,N)}},$n="data-html2canvas-ignore",li=function(){function k(R,U,N){if(this.context=R,this.options=N,this.scrolledElements=[],this.referenceElement=U,this.counters=new xe,this.quoteDepth=0,!U.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(U.ownerDocument.documentElement,!1)}return k.prototype.toIFrame=function(R,U){var N=this,ee=yi(R,U);if(!ee.contentWindow)return Promise.reject("Unable to find iframe window");var ue=R.defaultView.pageXOffset,Te=R.defaultView.pageYOffset,je=ee.contentWindow,Qe=je.document,mt=Ki(ee).then(function(){return Mo(N,void 0,void 0,function(){var Mt,$t;return vo(this,function(yn){switch(yn.label){case 0:return this.scrolledElements.forEach(Fr),je&&(je.scrollTo(U.left,U.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(je.scrollY!==U.top||je.scrollX!==U.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(je.scrollX-U.left,je.scrollY-U.top,0,0))),Mt=this.options.onclone,typeof($t=this.clonedReferenceElement)>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:Qe.fonts&&Qe.fonts.ready?[4,Qe.fonts.ready]:[3,2];case 1:yn.sent(),yn.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,gr(Qe)]:[3,4];case 3:yn.sent(),yn.label=4;case 4:return"function"==typeof Mt?[2,Promise.resolve().then(function(){return Mt(Qe,$t)}).then(function(){return ee})]:[2,ee]}})})});return Qe.open(),Qe.write(kr(document.doctype)+"<html></html>"),qs(this.referenceElement.ownerDocument,ue,Te),Qe.replaceChild(Qe.adoptNode(this.documentElement),Qe.documentElement),Qe.close(),mt},k.prototype.createElementClone=function(R){if(Kf(R,2),j(R))return this.createCanvasClone(R);if(q(R))return this.createVideoClone(R);if(le(R))return this.createStyleClone(R);var U=R.cloneNode(!1);return J(U)&&(J(R)&&R.currentSrc&&R.currentSrc!==R.src&&(U.src=R.currentSrc,U.srcset=""),"lazy"===U.loading&&(U.loading="eager")),Ie(U)?this.createCustomElementClone(U):U},k.prototype.createCustomElementClone=function(R){var U=document.createElement("html2canvascustomelement");return rr(R.style,U),U},k.prototype.createStyleClone=function(R){try{var U=R.sheet;if(U&&U.cssRules){var N=[].slice.call(U.cssRules,0).reduce(function(ue,Te){return Te&&"string"==typeof Te.cssText?ue+Te.cssText:ue},""),ee=R.cloneNode(!1);return ee.textContent=N,ee}}catch(ue){if(this.context.logger.error("Unable to access cssRules property",ue),"SecurityError"!==ue.name)throw ue}return R.cloneNode(!1)},k.prototype.createCanvasClone=function(R){var U;if(this.options.inlineImages&&R.ownerDocument){var N=R.ownerDocument.createElement("img");try{return N.src=R.toDataURL(),N}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",R)}}var ee=R.cloneNode(!1);try{ee.width=R.width,ee.height=R.height;var ue=R.getContext("2d"),Te=ee.getContext("2d");if(Te)if(!this.options.allowTaint&&ue)Te.putImageData(ue.getImageData(0,0,R.width,R.height),0,0);else{var je=null!==(U=R.getContext("webgl2"))&&void 0!==U?U:R.getContext("webgl");if(je){var Qe=je.getContextAttributes();!1===Qe?.preserveDrawingBuffer&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",R)}Te.drawImage(R,0,0)}return ee}catch{this.context.logger.info("Unable to clone canvas as it is tainted",R)}return ee},k.prototype.createVideoClone=function(R){var U=R.ownerDocument.createElement("canvas");U.width=R.offsetWidth,U.height=R.offsetHeight;var N=U.getContext("2d");try{return N&&(N.drawImage(R,0,0,U.width,U.height),this.options.allowTaint||N.getImageData(0,0,U.width,U.height)),U}catch{this.context.logger.info("Unable to clone video as it is tainted",R)}var ee=R.ownerDocument.createElement("canvas");return ee.width=R.offsetWidth,ee.height=R.offsetHeight,ee},k.prototype.appendChildNode=function(R,U,N){(!c(U)||!function(k){return"SCRIPT"===k.tagName}(U)&&!U.hasAttribute($n)&&("function"!=typeof this.options.ignoreElements||!this.options.ignoreElements(U)))&&(!this.options.copyStyles||!c(U)||!le(U))&&R.appendChild(this.cloneNode(U,N))},k.prototype.cloneChildNodes=function(R,U,N){for(var ee=this,ue=R.shadowRoot?R.shadowRoot.firstChild:R.firstChild;ue;ue=ue.nextSibling)if(c(ue)&&me(ue)&&"function"==typeof ue.assignedNodes){var Te=ue.assignedNodes();Te.length&&Te.forEach(function(je){return ee.appendChildNode(U,je,N)})}else this.appendChildNode(U,ue,N)},k.prototype.cloneNode=function(R,U){if(_(R))return document.createTextNode(R.data);if(!R.ownerDocument)return R.cloneNode(!1);var N=R.ownerDocument.defaultView;if(N&&c(R)&&(d(R)||y(R))){var ee=this.createElementClone(R);ee.style.transitionProperty="none";var ue=N.getComputedStyle(R),Te=N.getComputedStyle(R,":before"),je=N.getComputedStyle(R,":after");this.referenceElement===R&&d(ee)&&(this.clonedReferenceElement=ee),Q(ee)&&eo(ee);var Qe=this.counters.parse(new Vh(this.context,ue)),mt=this.resolvePseudoContent(R,ee,Te,xi.BEFORE);Ie(R)&&(U=!0),q(R)||this.cloneChildNodes(R,ee,U),mt&&ee.insertBefore(mt,ee.firstChild);var Mt=this.resolvePseudoContent(R,ee,je,xi.AFTER);return Mt&&ee.appendChild(Mt),this.counters.pop(Qe),(ue&&(this.options.copyStyles||y(R))&&!te(R)||U)&&rr(ue,ee),(0!==R.scrollTop||0!==R.scrollLeft)&&this.scrolledElements.push([ee,R.scrollLeft,R.scrollTop]),(Ae(R)||se(R))&&(Ae(ee)||se(ee))&&(ee.value=R.value),ee}return R.cloneNode(!1)},k.prototype.resolvePseudoContent=function(R,U,N,ee){var ue=this;if(N){var Te=N.content,je=U.ownerDocument;if(je&&Te&&"none"!==Te&&"-moz-alt-content"!==Te&&"none"!==N.display){this.counters.parse(new Vh(this.context,N));var Qe=new tm(this.context,N),mt=je.createElement("html2canvaspseudoelement");rr(N,mt),Qe.content.forEach(function($t){if(0===$t.type)mt.appendChild(je.createTextNode($t.value));else if(22===$t.type){var yn=je.createElement("img");yn.src=$t.value,yn.style.opacity="1",mt.appendChild(yn)}else if(18===$t.type){if("attr"===$t.name){var Xi=$t.values.filter(Co);Xi.length&&mt.appendChild(je.createTextNode(R.getAttribute(Xi[0].value)||""))}else if("counter"===$t.name){var mn=$t.values.filter(Vl),Lr=mn[1];if((Ni=mn[0])&&Co(Ni)){var hr=ue.counters.getCounterValue(Ni.value),tr=Lr&&Co(Lr)?Uc.parse(ue.context,Lr.value):3;mt.appendChild(je.createTextNode(Cn(hr,tr,!1)))}}else if("counters"===$t.name){var Ni,So=$t.values.filter(Vl),Ls=So[1];if(Lr=So[2],(Ni=So[0])&&Co(Ni)){var Gr=ue.counters.getCounterValues(Ni.value),$i=Lr&&Co(Lr)?Uc.parse(ue.context,Lr.value):3,po=Ls&&0===Ls.type?Ls.value:"",go=Gr.map(function(Kc){return Cn(Kc,$i,!1)}).join(po);mt.appendChild(je.createTextNode(go))}}}else if(20===$t.type)switch($t.value){case"open-quote":mt.appendChild(je.createTextNode(Op(Qe.quotes,ue.quoteDepth++,!0)));break;case"close-quote":mt.appendChild(je.createTextNode(Op(Qe.quotes,--ue.quoteDepth,!1)));break;default:mt.appendChild(je.createTextNode($t.value))}}),mt.className=jr+" "+br;var Mt=ee===xi.BEFORE?" "+jr:" "+br;return y(U)?U.className.baseValue+=Mt:U.className+=Mt,mt}}},k.destroy=function(R){return!!R.parentNode&&(R.parentNode.removeChild(R),!0)},k}(),xi=function(k){return k[k.BEFORE=0]="BEFORE",k[k.AFTER=1]="AFTER",k}(xi||{}),yi=function(k,R){var U=k.createElement("iframe");return U.className="html2canvas-container",U.style.visibility="hidden",U.style.position="fixed",U.style.left="-10000px",U.style.top="0px",U.style.border="0",U.width=R.width.toString(),U.height=R.height.toString(),U.scrolling="no",U.setAttribute($n,"true"),k.body.appendChild(U),U},ci=function(k){return new Promise(function(R){k.complete?R():k.src?(k.onload=R,k.onerror=R):R()})},gr=function(k){return Promise.all([].slice.call(k.images,0).map(ci))},Ki=function(k){return new Promise(function(R,U){var N=k.contentWindow;if(!N)return U("No window assigned for iframe");var ee=N.document;N.onload=k.onload=function(){N.onload=k.onload=null;var ue=setInterval(function(){ee.body.childNodes.length>0&&"complete"===ee.readyState&&(clearInterval(ue),R(k))},50)}})},lr=["all","d","content"],rr=function(k,R){for(var U=k.length-1;U>=0;U--){var N=k.item(U);-1===lr.indexOf(N)&&R.style.setProperty(N,k.getPropertyValue(N))}return R},kr=function(k){var R="";return k&&(R+="<!DOCTYPE ",k.name&&(R+=k.name),k.internalSubset&&(R+=k.internalSubset),k.publicId&&(R+='"'+k.publicId+'"'),k.systemId&&(R+='"'+k.systemId+'"'),R+=">"),R},qs=function(k,R,U){k&&k.defaultView&&(R!==k.defaultView.pageXOffset||U!==k.defaultView.pageYOffset)&&k.defaultView.scrollTo(R,U)},Fr=function(k){var R=k[0],N=k[2];R.scrollLeft=k[1],R.scrollTop=N},jr="___html2canvas___pseudoelement_before",br="___html2canvas___pseudoelement_after",Xr='{\n    content: "" !important;\n    display: none !important;\n}',eo=function(k){zr(k,"."+jr+":before"+Xr+"\n         ."+br+":after"+Xr)},zr=function(k,R){var U=k.ownerDocument;if(U){var N=U.createElement("style");N.textContent=R,k.appendChild(N)}},za=function(){function k(){}return k.getOrigin=function(R){var U=k._link;return U?(U.href=R,U.href=U.href,U.protocol+U.hostname+U.port):"about:blank"},k.isSameOrigin=function(R){return k.getOrigin(R)===k._origin},k.setContext=function(R){k._link=R.document.createElement("a"),k._origin=k.getOrigin(R.location.href)},k._origin="about:blank",k}(),gl=function(){function k(R,U){this.context=R,this._options=U,this._cache={}}return k.prototype.addImage=function(R){var U=Promise.resolve();return this.has(R)||(ml(R)||oo(R))&&(this._cache[R]=this.loadImage(R)).catch(function(){}),U},k.prototype.match=function(R){return this._cache[R]},k.prototype.loadImage=function(R){return Mo(this,void 0,void 0,function(){var U,N,ee,ue,Te=this;return vo(this,function(je){switch(je.label){case 0:return U=za.isSameOrigin(R),N=!fa(R)&&!0===this._options.useCORS&&Ua.SUPPORT_CORS_IMAGES&&!U,ee=!fa(R)&&!U&&!ml(R)&&"string"==typeof this._options.proxy&&Ua.SUPPORT_CORS_XHR&&!N,U||!1!==this._options.allowTaint||fa(R)||ml(R)||ee||N?(ue=R,ee?[4,this.proxy(ue)]:[3,2]):[2];case 1:ue=je.sent(),je.label=2;case 2:return this.context.logger.debug("Added image "+R.substring(0,256)),[4,new Promise(function(Qe,mt){var Mt=new Image;Mt.onload=function(){return Qe(Mt)},Mt.onerror=mt,(Ms(ue)||N)&&(Mt.crossOrigin="anonymous"),Mt.src=ue,!0===Mt.complete&&setTimeout(function(){return Qe(Mt)},500),Te._options.imageTimeout>0&&setTimeout(function(){return mt("Timed out ("+Te._options.imageTimeout+"ms) loading image")},Te._options.imageTimeout)})];case 3:return[2,je.sent()]}})})},k.prototype.has=function(R){return typeof this._cache[R]<"u"},k.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},k.prototype.proxy=function(R){var U=this,N=this._options.proxy;if(!N)throw new Error("No proxy defined");var ee=R.substring(0,256);return new Promise(function(ue,Te){var je=Ua.SUPPORT_RESPONSE_TYPE?"blob":"text",Qe=new XMLHttpRequest;Qe.onload=function(){if(200===Qe.status)if("text"===je)ue(Qe.response);else{var $t=new FileReader;$t.addEventListener("load",function(){return ue($t.result)},!1),$t.addEventListener("error",function(yn){return Te(yn)},!1),$t.readAsDataURL(Qe.response)}else Te("Failed to proxy resource "+ee+" with status code "+Qe.status)},Qe.onerror=Te;var mt=N.indexOf("?")>-1?"&":"?";if(Qe.open("GET",""+N+mt+"url="+encodeURIComponent(R)+"&responseType="+je),"text"!==je&&Qe instanceof XMLHttpRequest&&(Qe.responseType=je),U._options.imageTimeout){var Mt=U._options.imageTimeout;Qe.timeout=Mt,Qe.ontimeout=function(){return Te("Timed out ("+Mt+"ms) proxying "+ee)}}Qe.send()})},k}(),bc=/^data:image\/svg\+xml/i,jc=/^data:image\/.*;base64,/i,Gc=/^data:image\/.*/i,oo=function(k){return Ua.SUPPORT_SVG_DRAWING||!$c(k)},fa=function(k){return Gc.test(k)},Ms=function(k){return jc.test(k)},ml=function(k){return"blob"===k.substr(0,4)},$c=function(k){return"svg"===k.substr(-3).toLowerCase()||bc.test(k)},Si=function(){function k(R,U){this.type=0,this.x=R,this.y=U}return k.prototype.add=function(R,U){return new k(this.x+R,this.y+U)},k}(),_l=function(k,R,U){return new Si(k.x+(R.x-k.x)*U,k.y+(R.y-k.y)*U)},wc=function(){function k(R,U,N,ee){this.type=1,this.start=R,this.startControl=U,this.endControl=N,this.end=ee}return k.prototype.subdivide=function(R,U){var N=_l(this.start,this.startControl,R),ee=_l(this.startControl,this.endControl,R),ue=_l(this.endControl,this.end,R),Te=_l(N,ee,R),je=_l(ee,ue,R),Qe=_l(Te,je,R);return U?new k(this.start,N,Te,Qe):new k(Qe,je,ue,this.end)},k.prototype.add=function(R,U){return new k(this.start.add(R,U),this.startControl.add(R,U),this.endControl.add(R,U),this.end.add(R,U))},k.prototype.reverse=function(){return new k(this.end,this.endControl,this.startControl,this.start)},k}(),Va=function(k){return 1===k.type},Gh=function k(R){var U=R.styles,N=R.bounds,ee=nh(U.borderTopLeftRadius,N.width,N.height),ue=ee[0],Te=ee[1],je=nh(U.borderTopRightRadius,N.width,N.height),Qe=je[0],mt=je[1],Mt=nh(U.borderBottomRightRadius,N.width,N.height),$t=Mt[0],yn=Mt[1],Xi=nh(U.borderBottomLeftRadius,N.width,N.height),mn=Xi[0],Ni=Xi[1],Lr=[];Lr.push((ue+Qe)/N.width),Lr.push((mn+$t)/N.width),Lr.push((Te+Ni)/N.height),Lr.push((mt+yn)/N.height);var hr=Math.max.apply(Math,Lr);hr>1&&(ue/=hr,Te/=hr,Qe/=hr,mt/=hr,$t/=hr,yn/=hr,mn/=hr,Ni/=hr);var tr=N.width-Qe,So=N.height-yn,Ls=N.width-$t,Gr=N.height-Ni,$i=U.borderTopWidth,po=U.borderRightWidth,go=U.borderBottomWidth,us=U.borderLeftWidth,Wl=ea(U.paddingTop,R.bounds.width),Kc=ea(U.paddingRight,R.bounds.width),tl=ea(U.paddingBottom,R.bounds.width),No=ea(U.paddingLeft,R.bounds.width);this.topLeftBorderDoubleOuterBox=ue>0||Te>0?Eo(N.left+us/3,N.top+$i/3,ue-us/3,Te-$i/3,Ao.TOP_LEFT):new Si(N.left+us/3,N.top+$i/3),this.topRightBorderDoubleOuterBox=ue>0||Te>0?Eo(N.left+tr,N.top+$i/3,Qe-po/3,mt-$i/3,Ao.TOP_RIGHT):new Si(N.left+N.width-po/3,N.top+$i/3),this.bottomRightBorderDoubleOuterBox=$t>0||yn>0?Eo(N.left+Ls,N.top+So,$t-po/3,yn-go/3,Ao.BOTTOM_RIGHT):new Si(N.left+N.width-po/3,N.top+N.height-go/3),this.bottomLeftBorderDoubleOuterBox=mn>0||Ni>0?Eo(N.left+us/3,N.top+Gr,mn-us/3,Ni-go/3,Ao.BOTTOM_LEFT):new Si(N.left+us/3,N.top+N.height-go/3),this.topLeftBorderDoubleInnerBox=ue>0||Te>0?Eo(N.left+2*us/3,N.top+2*$i/3,ue-2*us/3,Te-2*$i/3,Ao.TOP_LEFT):new Si(N.left+2*us/3,N.top+2*$i/3),this.topRightBorderDoubleInnerBox=ue>0||Te>0?Eo(N.left+tr,N.top+2*$i/3,Qe-2*po/3,mt-2*$i/3,Ao.TOP_RIGHT):new Si(N.left+N.width-2*po/3,N.top+2*$i/3),this.bottomRightBorderDoubleInnerBox=$t>0||yn>0?Eo(N.left+Ls,N.top+So,$t-2*po/3,yn-2*go/3,Ao.BOTTOM_RIGHT):new Si(N.left+N.width-2*po/3,N.top+N.height-2*go/3),this.bottomLeftBorderDoubleInnerBox=mn>0||Ni>0?Eo(N.left+2*us/3,N.top+Gr,mn-2*us/3,Ni-2*go/3,Ao.BOTTOM_LEFT):new Si(N.left+2*us/3,N.top+N.height-2*go/3),this.topLeftBorderStroke=ue>0||Te>0?Eo(N.left+us/2,N.top+$i/2,ue-us/2,Te-$i/2,Ao.TOP_LEFT):new Si(N.left+us/2,N.top+$i/2),this.topRightBorderStroke=ue>0||Te>0?Eo(N.left+tr,N.top+$i/2,Qe-po/2,mt-$i/2,Ao.TOP_RIGHT):new Si(N.left+N.width-po/2,N.top+$i/2),this.bottomRightBorderStroke=$t>0||yn>0?Eo(N.left+Ls,N.top+So,$t-po/2,yn-go/2,Ao.BOTTOM_RIGHT):new Si(N.left+N.width-po/2,N.top+N.height-go/2),this.bottomLeftBorderStroke=mn>0||Ni>0?Eo(N.left+us/2,N.top+Gr,mn-us/2,Ni-go/2,Ao.BOTTOM_LEFT):new Si(N.left+us/2,N.top+N.height-go/2),this.topLeftBorderBox=ue>0||Te>0?Eo(N.left,N.top,ue,Te,Ao.TOP_LEFT):new Si(N.left,N.top),this.topRightBorderBox=Qe>0||mt>0?Eo(N.left+tr,N.top,Qe,mt,Ao.TOP_RIGHT):new Si(N.left+N.width,N.top),this.bottomRightBorderBox=$t>0||yn>0?Eo(N.left+Ls,N.top+So,$t,yn,Ao.BOTTOM_RIGHT):new Si(N.left+N.width,N.top+N.height),this.bottomLeftBorderBox=mn>0||Ni>0?Eo(N.left,N.top+Gr,mn,Ni,Ao.BOTTOM_LEFT):new Si(N.left,N.top+N.height),this.topLeftPaddingBox=ue>0||Te>0?Eo(N.left+us,N.top+$i,Math.max(0,ue-us),Math.max(0,Te-$i),Ao.TOP_LEFT):new Si(N.left+us,N.top+$i),this.topRightPaddingBox=Qe>0||mt>0?Eo(N.left+Math.min(tr,N.width-po),N.top+$i,tr>N.width+po?0:Math.max(0,Qe-po),Math.max(0,mt-$i),Ao.TOP_RIGHT):new Si(N.left+N.width-po,N.top+$i),this.bottomRightPaddingBox=$t>0||yn>0?Eo(N.left+Math.min(Ls,N.width-us),N.top+Math.min(So,N.height-go),Math.max(0,$t-po),Math.max(0,yn-go),Ao.BOTTOM_RIGHT):new Si(N.left+N.width-po,N.top+N.height-go),this.bottomLeftPaddingBox=mn>0||Ni>0?Eo(N.left+us,N.top+Math.min(Gr,N.height-go),Math.max(0,mn-us),Math.max(0,Ni-go),Ao.BOTTOM_LEFT):new Si(N.left+us,N.top+N.height-go),this.topLeftContentBox=ue>0||Te>0?Eo(N.left+us+No,N.top+$i+Wl,Math.max(0,ue-(us+No)),Math.max(0,Te-($i+Wl)),Ao.TOP_LEFT):new Si(N.left+us+No,N.top+$i+Wl),this.topRightContentBox=Qe>0||mt>0?Eo(N.left+Math.min(tr,N.width+us+No),N.top+$i+Wl,tr>N.width+us+No?0:Qe-us+No,mt-($i+Wl),Ao.TOP_RIGHT):new Si(N.left+N.width-(po+Kc),N.top+$i+Wl),this.bottomRightContentBox=$t>0||yn>0?Eo(N.left+Math.min(Ls,N.width-(us+No)),N.top+Math.min(So,N.height+$i+Wl),Math.max(0,$t-(po+Kc)),yn-(go+tl),Ao.BOTTOM_RIGHT):new Si(N.left+N.width-(po+Kc),N.top+N.height-(go+tl)),this.bottomLeftContentBox=mn>0||Ni>0?Eo(N.left+us+No,N.top+Gr,Math.max(0,mn-(us+No)),Ni-(go+tl),Ao.BOTTOM_LEFT):new Si(N.left+us+No,N.top+N.height-(go+tl))},Ao=function(k){return k[k.TOP_LEFT=0]="TOP_LEFT",k[k.TOP_RIGHT=1]="TOP_RIGHT",k[k.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",k[k.BOTTOM_LEFT=3]="BOTTOM_LEFT",k}(Ao||{}),Eo=function(k,R,U,N,ee){var ue=(Math.sqrt(2)-1)/3*4,Te=U*ue,je=N*ue,Qe=k+U,mt=R+N;switch(ee){case Ao.TOP_LEFT:return new wc(new Si(k,mt),new Si(k,mt-je),new Si(Qe-Te,R),new Si(Qe,R));case Ao.TOP_RIGHT:return new wc(new Si(k,R),new Si(k+Te,R),new Si(Qe,mt-je),new Si(Qe,mt));case Ao.BOTTOM_RIGHT:return new wc(new Si(Qe,R),new Si(Qe,R+je),new Si(k+Te,mt),new Si(k,mt));default:return new wc(new Si(Qe,mt),new Si(Qe-Te,mt),new Si(k,R+je),new Si(k,R))}},qc=function(k){return[k.topLeftBorderBox,k.topRightBorderBox,k.bottomRightBorderBox,k.bottomLeftBorderBox]},Fu=function(k){return[k.topLeftPaddingBox,k.topRightPaddingBox,k.bottomRightPaddingBox,k.bottomLeftPaddingBox]},vC=function k(R,U,N){this.offsetX=R,this.offsetY=U,this.matrix=N,this.type=0,this.target=6},vv=function k(R,U){this.path=R,this.target=U,this.type=1},C_=function k(R){this.opacity=R,this.type=2,this.target=6},Am=function(k){return 1===k.type},WA=function(k,R){return k.length===R.length&&k.some(function(U,N){return U===R[N]})},vb=function k(R){this.element=R,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]},Ml=function(){function k(R,U){if(this.container=R,this.parent=U,this.effects=[],this.curves=new Gh(this.container),this.container.styles.opacity<1&&this.effects.push(new C_(this.container.styles.opacity)),null!==this.container.styles.transform&&this.effects.push(new vC(this.container.bounds.left+this.container.styles.transformOrigin[0].number,this.container.bounds.top+this.container.styles.transformOrigin[1].number,this.container.styles.transform)),0!==this.container.styles.overflowX){var Te=qc(this.curves),je=Fu(this.curves);WA(Te,je)?this.effects.push(new vv(Te,6)):(this.effects.push(new vv(Te,2)),this.effects.push(new vv(je,4)))}}return k.prototype.getEffects=function(R){for(var U=-1===[2,3].indexOf(this.container.styles.position),N=this.parent,ee=this.effects.slice(0);N;){var ue=N.effects.filter(function(Qe){return!Am(Qe)});if(U||0!==N.container.styles.position||!N.parent){if(ee.unshift.apply(ee,ue),U=-1===[2,3].indexOf(N.container.styles.position),0!==N.container.styles.overflowX){var Te=qc(N.curves),je=Fu(N.curves);WA(Te,je)||ee.unshift(new vv(je,6))}}else ee.unshift.apply(ee,ue);N=N.parent}return ee.filter(function(Qe){return $s(Qe.target,R)})},k}(),Ha=function(k,R,U,N){k.container.elements.forEach(function(ee){var ue=$s(ee.flags,4),Te=$s(ee.flags,2),je=new Ml(ee,k);$s(ee.styles.display,2048)&&N.push(je);var Qe=$s(ee.flags,8)?[]:N;if(ue||Te){var mt=ue||ee.styles.isPositioned()?U:R,Mt=new vb(je);if(ee.styles.isPositioned()||ee.styles.opacity<1||ee.styles.isTransformed()){var $t=ee.styles.zIndex.order;if($t<0){var yn=0;mt.negativeZIndex.some(function(mn,Ni){return $t>mn.element.container.styles.zIndex.order?(yn=Ni,!1):yn>0}),mt.negativeZIndex.splice(yn,0,Mt)}else if($t>0){var Xi=0;mt.positiveZIndex.some(function(mn,Ni){return $t>=mn.element.container.styles.zIndex.order?(Xi=Ni+1,!1):Xi>0}),mt.positiveZIndex.splice(Xi,0,Mt)}else mt.zeroOrAutoZIndexOrTransformedOrOpacity.push(Mt)}else ee.styles.isFloating()?mt.nonPositionedFloats.push(Mt):mt.nonPositionedInlineLevel.push(Mt);Ha(je,Mt,ue?Mt:U,Qe)}else ee.styles.isInlineLevel()?R.inlineLevel.push(je):R.nonInlineLevel.push(je),Ha(je,R,U,Qe);$s(ee.flags,8)&&Aa(ee,Qe)})},Aa=function(k,R){for(var U=k instanceof pl?k.start:1,N=k instanceof pl&&k.reversed,ee=0;ee<R.length;ee++){var ue=R[ee];ue.container instanceof zo&&"number"==typeof ue.container.value&&0!==ue.container.value&&(U=ue.container.value),ue.listValue=Cn(U,ue.container.styles.listStyleType,!0),U+=N?-1:1}},Ru=function(k,R){switch(R){case 0:return Kl(k.topLeftBorderBox,k.topLeftPaddingBox,k.topRightBorderBox,k.topRightPaddingBox);case 1:return Kl(k.topRightBorderBox,k.topRightPaddingBox,k.bottomRightBorderBox,k.bottomRightPaddingBox);case 2:return Kl(k.bottomRightBorderBox,k.bottomRightPaddingBox,k.bottomLeftBorderBox,k.bottomLeftPaddingBox);default:return Kl(k.bottomLeftBorderBox,k.bottomLeftPaddingBox,k.topLeftBorderBox,k.topLeftPaddingBox)}},af=function(k,R){var U=[];return Va(k)?U.push(k.subdivide(.5,!1)):U.push(k),Va(R)?U.push(R.subdivide(.5,!0)):U.push(R),U},Kl=function(k,R,U,N){var ee=[];return Va(k)?ee.push(k.subdivide(.5,!1)):ee.push(k),Va(U)?ee.push(U.subdivide(.5,!0)):ee.push(U),Va(N)?ee.push(N.subdivide(.5,!0).reverse()):ee.push(N),Va(R)?ee.push(R.subdivide(.5,!1).reverse()):ee.push(R),ee},xb=function(k){var U=k.styles;return k.bounds.add(U.borderLeftWidth,U.borderTopWidth,-(U.borderRightWidth+U.borderLeftWidth),-(U.borderTopWidth+U.borderBottomWidth))},E_=function(k){var R=k.styles,U=k.bounds,N=ea(R.paddingLeft,U.width),ee=ea(R.paddingRight,U.width),ue=ea(R.paddingTop,U.width),Te=ea(R.paddingBottom,U.width);return U.add(N+R.borderLeftWidth,ue+R.borderTopWidth,-(R.borderRightWidth+R.borderLeftWidth+N+ee),-(R.borderTopWidth+R.borderBottomWidth+ue+Te))},Gp=function(k,R,U){var N=function(k,R){return 0===k?R.bounds:2===k?E_(R):xb(R)}($p(k.styles.backgroundOrigin,R),k),ee=function(k,R){return 0===k?R.bounds:2===k?E_(R):xb(R)}($p(k.styles.backgroundClip,R),k),ue=wv($p(k.styles.backgroundSize,R),U,N),Te=ue[0],je=ue[1],Qe=nh($p(k.styles.backgroundPosition,R),N.width-Te,N.height-je);return[to($p(k.styles.backgroundRepeat,R),Qe,ue,N,ee),Math.round(N.left+Qe[0]),Math.round(N.top+Qe[1]),Te,je]},Fl=function(k){return Co(k)&&k.value===Yd.AUTO},$0=function(k){return"number"==typeof k},wv=function(k,R,U){var N=R[0],ee=R[1],ue=R[2],Te=k[0],je=k[1];if(!Te)return[0,0];if(Xt(Te)&&je&&Xt(je))return[ea(Te,U.width),ea(je,U.height)];var Qe=$0(ue);if(Co(Te)&&(Te.value===Yd.CONTAIN||Te.value===Yd.COVER))return $0(ue)?U.width/U.height<ue!=(Te.value===Yd.COVER)?[U.width,U.width/ue]:[U.height*ue,U.height]:[U.width,U.height];var Mt=$0(N),$t=$0(ee),yn=Mt||$t;if(Fl(Te)&&(!je||Fl(je)))return Mt&&$t?[N,ee]:Qe||yn?yn&&Qe?[Mt?N:ee*ue,$t?ee:N/ue]:[Mt?N:U.width,$t?ee:U.height]:[U.width,U.height];if(Qe){var hr=0,tr=0;return Xt(Te)?hr=ea(Te,U.width):Xt(je)&&(tr=ea(je,U.height)),Fl(Te)?hr=tr*ue:(!je||Fl(je))&&(tr=hr/ue),[hr,tr]}var So=null,Ls=null;if(Xt(Te)?So=ea(Te,U.width):je&&Xt(je)&&(Ls=ea(je,U.height)),null!==So&&(!je||Fl(je))&&(Ls=Mt&&$t?So/N*ee:U.height),null!==Ls&&Fl(Te)&&(So=Mt&&$t?Ls/ee*N:U.width),null!==So&&null!==Ls)return[So,Ls];throw new Error("Unable to calculate background-size for element")},$p=function(k,R){var U=k[R];return typeof U>"u"?k[0]:U},to=function(k,R,U,N,ee){var ue=R[0],Te=R[1],je=U[0],Qe=U[1];switch(k){case 2:return[new Si(Math.round(N.left),Math.round(N.top+Te)),new Si(Math.round(N.left+N.width),Math.round(N.top+Te)),new Si(Math.round(N.left+N.width),Math.round(Qe+N.top+Te)),new Si(Math.round(N.left),Math.round(Qe+N.top+Te))];case 3:return[new Si(Math.round(N.left+ue),Math.round(N.top)),new Si(Math.round(N.left+ue+je),Math.round(N.top)),new Si(Math.round(N.left+ue+je),Math.round(N.height+N.top)),new Si(Math.round(N.left+ue),Math.round(N.height+N.top))];case 1:return[new Si(Math.round(N.left+ue),Math.round(N.top+Te)),new Si(Math.round(N.left+ue+je),Math.round(N.top+Te)),new Si(Math.round(N.left+ue+je),Math.round(N.top+Te+Qe)),new Si(Math.round(N.left+ue),Math.round(N.top+Te+Qe))];default:return[new Si(Math.round(ee.left),Math.round(ee.top)),new Si(Math.round(ee.left+ee.width),Math.round(ee.top)),new Si(Math.round(ee.left+ee.width),Math.round(ee.height+ee.top)),new Si(Math.round(ee.left),Math.round(ee.height+ee.top))]}},Ou="Hidden Text",Cb=function(){function k(R){this._data={},this._document=R}return k.prototype.parseMetrics=function(R,U){var N=this._document.createElement("div"),ee=this._document.createElement("img"),ue=this._document.createElement("span"),Te=this._document.body;N.style.visibility="hidden",N.style.fontFamily=R,N.style.fontSize=U,N.style.margin="0",N.style.padding="0",N.style.whiteSpace="nowrap",Te.appendChild(N),ee.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",ee.width=1,ee.height=1,ee.style.margin="0",ee.style.padding="0",ee.style.verticalAlign="baseline",ue.style.fontFamily=R,ue.style.fontSize=U,ue.style.margin="0",ue.style.padding="0",ue.appendChild(this._document.createTextNode(Ou)),N.appendChild(ue),N.appendChild(ee);var je=ee.offsetTop-ue.offsetTop+2;N.removeChild(ue),N.appendChild(this._document.createTextNode(Ou)),N.style.lineHeight="normal",ee.style.verticalAlign="super";var Qe=ee.offsetTop-N.offsetTop+2;return Te.removeChild(N),{baseline:je,middle:Qe}},k.prototype.getMetrics=function(R,U){var N=R+" "+U;return typeof this._data[N]>"u"&&(this._data[N]=this.parseMetrics(R,U)),this._data[N]},k}(),Cv=function k(R,U){this.context=R,this.options=U},dr=function(k){function R(U,N){var ee=k.call(this,U,N)||this;return ee._activeEffects=[],ee.canvas=N.canvas?N.canvas:document.createElement("canvas"),ee.ctx=ee.canvas.getContext("2d"),N.canvas||(ee.canvas.width=Math.floor(N.width*N.scale),ee.canvas.height=Math.floor(N.height*N.scale),ee.canvas.style.width=N.width+"px",ee.canvas.style.height=N.height+"px"),ee.fontMetrics=new Cb(document),ee.ctx.scale(ee.options.scale,ee.options.scale),ee.ctx.translate(-N.x,-N.y),ee.ctx.textBaseline="bottom",ee._activeEffects=[],ee.context.logger.debug("Canvas renderer initialized ("+N.width+"x"+N.height+") with scale "+N.scale),ee}return Zs(R,k),R.prototype.applyEffects=function(U){for(var N=this;this._activeEffects.length;)this.popEffect();U.forEach(function(ee){return N.applyEffect(ee)})},R.prototype.applyEffect=function(U){this.ctx.save(),function(k){return 2===k.type}(U)&&(this.ctx.globalAlpha=U.opacity),function(k){return 0===k.type}(U)&&(this.ctx.translate(U.offsetX,U.offsetY),this.ctx.transform(U.matrix[0],U.matrix[1],U.matrix[2],U.matrix[3],U.matrix[4],U.matrix[5]),this.ctx.translate(-U.offsetX,-U.offsetY)),Am(U)&&(this.path(U.path),this.ctx.clip()),this._activeEffects.push(U)},R.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},R.prototype.renderStack=function(U){return Mo(this,void 0,void 0,function(){return vo(this,function(ee){switch(ee.label){case 0:return U.element.container.styles.isVisible()?[4,this.renderStackContent(U)]:[3,2];case 1:ee.sent(),ee.label=2;case 2:return[2]}})})},R.prototype.renderNode=function(U){return Mo(this,void 0,void 0,function(){return vo(this,function(N){switch(N.label){case 0:return $s(U.container.flags,16),U.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(U)]:[3,3];case 1:return N.sent(),[4,this.renderNodeContent(U)];case 2:N.sent(),N.label=3;case 3:return[2]}})})},R.prototype.renderTextWithLetterSpacing=function(U,N,ee){var ue=this;0===N?this.ctx.fillText(U.text,U.bounds.left,U.bounds.top+ee):Qn(U.text).reduce(function(je,Qe){return ue.ctx.fillText(Qe,je,U.bounds.top+ee),je+ue.ctx.measureText(Qe).width},U.bounds.left)},R.prototype.createFontStyle=function(U){var N=U.fontVariant.filter(function(Te){return"normal"===Te||"small-caps"===Te}).join(""),ee=Sb(U.fontFamily).join(", "),ue=dd(U.fontSize)?""+U.fontSize.number+U.fontSize.unit:U.fontSize.number+"px";return[[U.fontStyle,N,U.fontWeight,ue,ee].join(" "),ee,ue]},R.prototype.renderTextNode=function(U,N){return Mo(this,void 0,void 0,function(){var ee,Te,je,Qe,mt,Mt,$t,yn=this;return vo(this,function(Xi){return ee=this.createFontStyle(N),Te=ee[1],je=ee[2],this.ctx.font=ee[0],this.ctx.direction=1===N.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",Qe=this.fontMetrics.getMetrics(Te,je),mt=Qe.baseline,Mt=Qe.middle,$t=N.paintOrder,U.textBounds.forEach(function(mn){$t.forEach(function(Ni){switch(Ni){case 0:yn.ctx.fillStyle=Na(N.color),yn.renderTextWithLetterSpacing(mn,N.letterSpacing,mt);var Lr=N.textShadow;Lr.length&&mn.text.trim().length&&(Lr.slice(0).reverse().forEach(function(hr){yn.ctx.shadowColor=Na(hr.color),yn.ctx.shadowOffsetX=hr.offsetX.number*yn.options.scale,yn.ctx.shadowOffsetY=hr.offsetY.number*yn.options.scale,yn.ctx.shadowBlur=hr.blur.number,yn.renderTextWithLetterSpacing(mn,N.letterSpacing,mt)}),yn.ctx.shadowColor="",yn.ctx.shadowOffsetX=0,yn.ctx.shadowOffsetY=0,yn.ctx.shadowBlur=0),N.textDecorationLine.length&&(yn.ctx.fillStyle=Na(N.textDecorationColor||N.color),N.textDecorationLine.forEach(function(hr){switch(hr){case 1:yn.ctx.fillRect(mn.bounds.left,Math.round(mn.bounds.top+mt),mn.bounds.width,1);break;case 2:yn.ctx.fillRect(mn.bounds.left,Math.round(mn.bounds.top),mn.bounds.width,1);break;case 3:yn.ctx.fillRect(mn.bounds.left,Math.ceil(mn.bounds.top+Mt),mn.bounds.width,1)}}));break;case 1:N.webkitTextStrokeWidth&&mn.text.trim().length&&(yn.ctx.strokeStyle=Na(N.webkitTextStrokeColor),yn.ctx.lineWidth=N.webkitTextStrokeWidth,yn.ctx.lineJoin=window.chrome?"miter":"round",yn.ctx.strokeText(mn.text,mn.bounds.left,mn.bounds.top+mt)),yn.ctx.strokeStyle="",yn.ctx.lineWidth=0,yn.ctx.lineJoin="miter"}})}),[2]})})},R.prototype.renderReplacedElement=function(U,N,ee){if(ee&&U.intrinsicWidth>0&&U.intrinsicHeight>0){var ue=E_(U),Te=Fu(N);this.path(Te),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(ee,0,0,U.intrinsicWidth,U.intrinsicHeight,ue.left,ue.top,ue.width,ue.height),this.ctx.restore()}},R.prototype.renderNodeContent=function(U){return Mo(this,void 0,void 0,function(){var N,ee,ue,Te,je,Mt,$t,yn,mn,Ni,Lr,hr,tr,So,Ls,Gr;return vo(this,function($i){switch($i.label){case 0:this.applyEffects(U.getEffects(4)),ee=U.curves,ue=(N=U.container).styles,Te=0,je=N.textNodes,$i.label=1;case 1:return Te<je.length?[4,this.renderTextNode(je[Te],ue)]:[3,4];case 2:$i.sent(),$i.label=3;case 3:return Te++,[3,1];case 4:if(!(N instanceof rf))return[3,8];$i.label=5;case 5:return $i.trys.push([5,7,,8]),[4,this.context.cache.match(N.src)];case 6:return tr=$i.sent(),this.renderReplacedElement(N,ee,tr),[3,8];case 7:return $i.sent(),this.context.logger.error("Error loading image "+N.src),[3,8];case 8:if(N instanceof Q0&&this.renderReplacedElement(N,ee,N.canvas),!(N instanceof j0))return[3,12];$i.label=9;case 9:return $i.trys.push([9,11,,12]),[4,this.context.cache.match(N.svg)];case 10:return tr=$i.sent(),this.renderReplacedElement(N,ee,tr),[3,12];case 11:return $i.sent(),this.context.logger.error("Error loading svg "+N.svg.substring(0,255)),[3,12];case 12:return N instanceof KA&&N.tree?[4,new R(this.context,{scale:this.options.scale,backgroundColor:N.backgroundColor,x:0,y:0,width:N.width,height:N.height}).render(N.tree)]:[3,14];case 13:Mt=$i.sent(),N.width&&N.height&&this.ctx.drawImage(Mt,0,0,N.width,N.height,N.bounds.left,N.bounds.top,N.bounds.width,N.bounds.height),$i.label=14;case 14:if(N instanceof Xf&&($t=Math.min(N.bounds.width,N.bounds.height),N.type===$A?N.checked&&(this.ctx.save(),this.path([new Si(N.bounds.left+.39363*$t,N.bounds.top+.79*$t),new Si(N.bounds.left+.16*$t,N.bounds.top+.5549*$t),new Si(N.bounds.left+.27347*$t,N.bounds.top+.44071*$t),new Si(N.bounds.left+.39694*$t,N.bounds.top+.5649*$t),new Si(N.bounds.left+.72983*$t,N.bounds.top+.23*$t),new Si(N.bounds.left+.84*$t,N.bounds.top+.34085*$t),new Si(N.bounds.left+.39363*$t,N.bounds.top+.79*$t)]),this.ctx.fillStyle=Na(b_),this.ctx.fill(),this.ctx.restore()):N.type===qA&&N.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(N.bounds.left+$t/2,N.bounds.top+$t/2,$t/4,0,2*Math.PI,!0),this.ctx.fillStyle=Na(b_),this.ctx.fill(),this.ctx.restore())),Ev(N)&&N.value.length){switch(yn=this.createFontStyle(ue),mn=this.fontMetrics.getMetrics(Ls=yn[0],yn[1]).baseline,this.ctx.font=Ls,this.ctx.fillStyle=Na(ue.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Eb(N.styles.textAlign),Gr=E_(N),Ni=0,N.styles.textAlign){case 1:Ni+=Gr.width/2;break;case 2:Ni+=Gr.width}Lr=Gr.add(Ni,0,0,-Gr.height/2+1),this.ctx.save(),this.path([new Si(Gr.left,Gr.top),new Si(Gr.left+Gr.width,Gr.top),new Si(Gr.left+Gr.width,Gr.top+Gr.height),new Si(Gr.left,Gr.top+Gr.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Zf(N.value,Lr),ue.letterSpacing,mn),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!$s(N.styles.display,2048))return[3,20];if(null===N.styles.listStyleImage)return[3,19];if(0!==(hr=N.styles.listStyleImage).type)return[3,18];tr=void 0,So=hr.url,$i.label=15;case 15:return $i.trys.push([15,17,,18]),[4,this.context.cache.match(So)];case 16:return tr=$i.sent(),this.ctx.drawImage(tr,N.bounds.left-(tr.width+10),N.bounds.top),[3,18];case 17:return $i.sent(),this.context.logger.error("Error loading list-style-image "+So),[3,18];case 18:return[3,20];case 19:U.listValue&&-1!==N.styles.listStyleType&&(Ls=this.createFontStyle(ue)[0],this.ctx.font=Ls,this.ctx.fillStyle=Na(ue.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Gr=new Ai(N.bounds.left,N.bounds.top+ea(N.styles.paddingTop,N.bounds.width),N.bounds.width,gd(ue.lineHeight,ue.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Zf(U.listValue,Gr),ue.letterSpacing,gd(ue.lineHeight,ue.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),$i.label=20;case 20:return[2]}})})},R.prototype.renderStackContent=function(U){return Mo(this,void 0,void 0,function(){var N,ee,ue,Te,je,Qe,mt,Mt,$t,yn,Xi,mn,Ni,Lr;return vo(this,function(tr){switch(tr.label){case 0:return $s(U.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(U.element)];case 1:tr.sent(),N=0,ee=U.negativeZIndex,tr.label=2;case 2:return N<ee.length?[4,this.renderStack(ee[N])]:[3,5];case 3:tr.sent(),tr.label=4;case 4:return N++,[3,2];case 5:return[4,this.renderNodeContent(U.element)];case 6:tr.sent(),ue=0,Te=U.nonInlineLevel,tr.label=7;case 7:return ue<Te.length?[4,this.renderNode(Te[ue])]:[3,10];case 8:tr.sent(),tr.label=9;case 9:return ue++,[3,7];case 10:je=0,Qe=U.nonPositionedFloats,tr.label=11;case 11:return je<Qe.length?[4,this.renderStack(Qe[je])]:[3,14];case 12:tr.sent(),tr.label=13;case 13:return je++,[3,11];case 14:mt=0,Mt=U.nonPositionedInlineLevel,tr.label=15;case 15:return mt<Mt.length?[4,this.renderStack(Mt[mt])]:[3,18];case 16:tr.sent(),tr.label=17;case 17:return mt++,[3,15];case 18:$t=0,yn=U.inlineLevel,tr.label=19;case 19:return $t<yn.length?[4,this.renderNode(yn[$t])]:[3,22];case 20:tr.sent(),tr.label=21;case 21:return $t++,[3,19];case 22:Xi=0,mn=U.zeroOrAutoZIndexOrTransformedOrOpacity,tr.label=23;case 23:return Xi<mn.length?[4,this.renderStack(mn[Xi])]:[3,26];case 24:tr.sent(),tr.label=25;case 25:return Xi++,[3,23];case 26:Ni=0,Lr=U.positiveZIndex,tr.label=27;case 27:return Ni<Lr.length?[4,this.renderStack(Lr[Ni])]:[3,30];case 28:tr.sent(),tr.label=29;case 29:return Ni++,[3,27];case 30:return[2]}})})},R.prototype.mask=function(U){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(U.slice(0).reverse()),this.ctx.closePath()},R.prototype.path=function(U){this.ctx.beginPath(),this.formatPath(U),this.ctx.closePath()},R.prototype.formatPath=function(U){var N=this;U.forEach(function(ee,ue){var Te=Va(ee)?ee.start:ee;0===ue?N.ctx.moveTo(Te.x,Te.y):N.ctx.lineTo(Te.x,Te.y),Va(ee)&&N.ctx.bezierCurveTo(ee.startControl.x,ee.startControl.y,ee.endControl.x,ee.endControl.y,ee.end.x,ee.end.y)})},R.prototype.renderRepeat=function(U,N,ee,ue){this.path(U),this.ctx.fillStyle=N,this.ctx.translate(ee,ue),this.ctx.fill(),this.ctx.translate(-ee,-ue)},R.prototype.resizeImage=function(U,N,ee){var ue;if(U.width===N&&U.height===ee)return U;var je=(null!==(ue=this.canvas.ownerDocument)&&void 0!==ue?ue:document).createElement("canvas");return je.width=Math.max(1,N),je.height=Math.max(1,ee),je.getContext("2d").drawImage(U,0,0,U.width,U.height,0,0,N,ee),je},R.prototype.renderBackgroundImage=function(U){return Mo(this,void 0,void 0,function(){var N,ee,ue,Te,je;return vo(this,function(mt){switch(mt.label){case 0:N=U.styles.backgroundImage.length-1,ee=function(Mt){var $t,yn,Xi,mn,Ni,Lr,hr,tr,So,Ls,Gr,$i,po,go,us,Wl,Kc,tl,No,pa,yl,Wc,nl,lf,$h,qh,wd,gu,Kh,ZA,cf;return vo(this,function(XA){switch(XA.label){case 0:if(0!==Mt.type)return[3,5];$t=void 0,yn=Mt.url,XA.label=1;case 1:return XA.trys.push([1,3,,4]),[4,ue.context.cache.match(yn)];case 2:return $t=XA.sent(),[3,4];case 3:return XA.sent(),ue.context.logger.error("Error loading background-image "+yn),[3,4];case 4:return $t&&(Xi=Gp(U,N,[$t.width,$t.height,$t.width/$t.height]),Wl=Xi[0],Wc=Xi[1],nl=Xi[2],go=ue.ctx.createPattern(ue.resizeImage($t,No=Xi[3],pa=Xi[4]),"repeat"),ue.renderRepeat(Wl,go,Wc,nl)),[3,6];case 5:!function(k){return 1===k.type}(Mt)?function(k){return 2===k.type}(Mt)&&(us=Gp(U,N,[null,null,null]),Wl=us[0],Kc=us[1],tl=us[2],pa=us[4],Wc=ea((yl=0===Mt.position.length?[Nf]:Mt.position)[0],No=us[3]),nl=ea(yl[yl.length-1],pa),lf=function(k,R,U,N,ee){var ue=0,Te=0;switch(k.size){case 0:0===k.shape?ue=Te=Math.min(Math.abs(R),Math.abs(R-N),Math.abs(U),Math.abs(U-ee)):1===k.shape&&(ue=Math.min(Math.abs(R),Math.abs(R-N)),Te=Math.min(Math.abs(U),Math.abs(U-ee)));break;case 2:if(0===k.shape)ue=Te=Math.min(va(R,U),va(R,U-ee),va(R-N,U),va(R-N,U-ee));else if(1===k.shape){var je=Math.min(Math.abs(U),Math.abs(U-ee))/Math.min(Math.abs(R),Math.abs(R-N)),Qe=Wd(N,ee,R,U,!0);Te=je*(ue=va(Qe[0]-R,(Qe[1]-U)/je))}break;case 1:0===k.shape?ue=Te=Math.max(Math.abs(R),Math.abs(R-N),Math.abs(U),Math.abs(U-ee)):1===k.shape&&(ue=Math.max(Math.abs(R),Math.abs(R-N)),Te=Math.max(Math.abs(U),Math.abs(U-ee)));break;case 3:if(0===k.shape)ue=Te=Math.max(va(R,U),va(R,U-ee),va(R-N,U),va(R-N,U-ee));else if(1===k.shape){je=Math.max(Math.abs(U),Math.abs(U-ee))/Math.max(Math.abs(R),Math.abs(R-N));var $t=Wd(N,ee,R,U,!1);Te=je*(ue=va($t[0]-R,($t[1]-U)/je))}}return Array.isArray(k.size)&&(ue=ea(k.size[0],N),Te=2===k.size.length?ea(k.size[1],ee):ue),[ue,Te]}(Mt,Wc,nl,No,pa),qh=lf[1],($h=lf[0])>0&&qh>0&&(wd=ue.ctx.createRadialGradient(Kc+Wc,tl+nl,0,Kc+Wc,tl+nl,$h),Ql(Mt.stops,2*$h).forEach(function(YA){return wd.addColorStop(YA.stop,Na(YA.color))}),ue.path(Wl),ue.ctx.fillStyle=wd,$h!==qh?(gu=U.bounds.left+.5*U.bounds.width,Kh=U.bounds.top+.5*U.bounds.height,cf=1/(ZA=qh/$h),ue.ctx.save(),ue.ctx.translate(gu,Kh),ue.ctx.transform(1,0,0,ZA,0,0),ue.ctx.translate(-gu,-Kh),ue.ctx.fillRect(Kc,cf*(tl-Kh)+Kh,No,pa*cf),ue.ctx.restore()):ue.ctx.fill())):(mn=Gp(U,N,[null,null,null]),Wl=mn[0],Wc=mn[1],nl=mn[2],Ni=R0(Mt.angle,No=mn[3],pa=mn[4]),Lr=Ni[0],hr=Ni[1],tr=Ni[2],So=Ni[3],Ls=Ni[4],(Gr=document.createElement("canvas")).width=No,Gr.height=pa,$i=Gr.getContext("2d"),po=$i.createLinearGradient(hr,So,tr,Ls),Ql(Mt.stops,Lr).forEach(function(YA){return po.addColorStop(YA.stop,Na(YA.color))}),$i.fillStyle=po,$i.fillRect(0,0,No,pa),No>0&&pa>0&&(go=ue.ctx.createPattern(Gr,"repeat"),ue.renderRepeat(Wl,go,Wc,nl))),XA.label=6;case 6:return N--,[2]}})},ue=this,Te=0,je=U.styles.backgroundImage.slice(0).reverse(),mt.label=1;case 1:return Te<je.length?[5,ee(je[Te])]:[3,4];case 2:mt.sent(),mt.label=3;case 3:return Te++,[3,1];case 4:return[2]}})})},R.prototype.renderSolidBorder=function(U,N,ee){return Mo(this,void 0,void 0,function(){return vo(this,function(ue){return this.path(Ru(ee,N)),this.ctx.fillStyle=Na(U),this.ctx.fill(),[2]})})},R.prototype.renderDoubleBorder=function(U,N,ee,ue){return Mo(this,void 0,void 0,function(){var Te,je;return vo(this,function(Qe){switch(Qe.label){case 0:return N<3?[4,this.renderSolidBorder(U,ee,ue)]:[3,2];case 1:return Qe.sent(),[2];case 2:return Te=function(k,R){switch(R){case 0:return Kl(k.topLeftBorderBox,k.topLeftBorderDoubleOuterBox,k.topRightBorderBox,k.topRightBorderDoubleOuterBox);case 1:return Kl(k.topRightBorderBox,k.topRightBorderDoubleOuterBox,k.bottomRightBorderBox,k.bottomRightBorderDoubleOuterBox);case 2:return Kl(k.bottomRightBorderBox,k.bottomRightBorderDoubleOuterBox,k.bottomLeftBorderBox,k.bottomLeftBorderDoubleOuterBox);default:return Kl(k.bottomLeftBorderBox,k.bottomLeftBorderDoubleOuterBox,k.topLeftBorderBox,k.topLeftBorderDoubleOuterBox)}}(ue,ee),this.path(Te),this.ctx.fillStyle=Na(U),this.ctx.fill(),je=function(k,R){switch(R){case 0:return Kl(k.topLeftBorderDoubleInnerBox,k.topLeftPaddingBox,k.topRightBorderDoubleInnerBox,k.topRightPaddingBox);case 1:return Kl(k.topRightBorderDoubleInnerBox,k.topRightPaddingBox,k.bottomRightBorderDoubleInnerBox,k.bottomRightPaddingBox);case 2:return Kl(k.bottomRightBorderDoubleInnerBox,k.bottomRightPaddingBox,k.bottomLeftBorderDoubleInnerBox,k.bottomLeftPaddingBox);default:return Kl(k.bottomLeftBorderDoubleInnerBox,k.bottomLeftPaddingBox,k.topLeftBorderDoubleInnerBox,k.topLeftPaddingBox)}}(ue,ee),this.path(je),this.ctx.fill(),[2]}})})},R.prototype.renderNodeBackgroundAndBorders=function(U){return Mo(this,void 0,void 0,function(){var N,ee,ue,Te,je,Qe,mt,Mt,$t=this;return vo(this,function(yn){switch(yn.label){case 0:return this.applyEffects(U.getEffects(2)),ee=!uu((N=U.container.styles).backgroundColor)||N.backgroundImage.length,ue=[{style:N.borderTopStyle,color:N.borderTopColor,width:N.borderTopWidth},{style:N.borderRightStyle,color:N.borderRightColor,width:N.borderRightWidth},{style:N.borderBottomStyle,color:N.borderBottomColor,width:N.borderBottomWidth},{style:N.borderLeftStyle,color:N.borderLeftColor,width:N.borderLeftWidth}],Te=Vo($p(N.backgroundClip,0),U.curves),ee||N.boxShadow.length?(this.ctx.save(),this.path(Te),this.ctx.clip(),uu(N.backgroundColor)||(this.ctx.fillStyle=Na(N.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(U.container)]):[3,2];case 1:yn.sent(),this.ctx.restore(),N.boxShadow.slice(0).reverse().forEach(function(Xi){$t.ctx.save();var mn=qc(U.curves),Ni=Xi.inset?0:1e4,Lr=function(k,R,U,N,ee){return k.map(function(ue,Te){switch(Te){case 0:return ue.add(R,U);case 1:return ue.add(R+N,U);case 2:return ue.add(R+N,U+ee);case 3:return ue.add(R,U+ee)}return ue})}(mn,(Xi.inset?1:-1)*Xi.spread.number-Ni,(Xi.inset?1:-1)*Xi.spread.number,Xi.spread.number*(Xi.inset?-2:2),Xi.spread.number*(Xi.inset?-2:2));Xi.inset?($t.path(mn),$t.ctx.clip(),$t.mask(Lr)):($t.mask(mn),$t.ctx.clip(),$t.path(Lr)),$t.ctx.shadowOffsetX=Xi.offsetX.number+Ni,$t.ctx.shadowOffsetY=Xi.offsetY.number,$t.ctx.shadowColor=Na(Xi.color),$t.ctx.shadowBlur=Xi.blur.number,$t.ctx.fillStyle=Xi.inset?Na(Xi.color):"rgba(0,0,0,1)",$t.ctx.fill(),$t.ctx.restore()}),yn.label=2;case 2:je=0,Qe=0,mt=ue,yn.label=3;case 3:return Qe<mt.length?0!==(Mt=mt[Qe]).style&&!uu(Mt.color)&&Mt.width>0?2!==Mt.style?[3,5]:[4,this.renderDashedDottedBorder(Mt.color,Mt.width,je,U.curves,2)]:[3,11]:[3,13];case 4:return yn.sent(),[3,11];case 5:return 3!==Mt.style?[3,7]:[4,this.renderDashedDottedBorder(Mt.color,Mt.width,je,U.curves,3)];case 6:return yn.sent(),[3,11];case 7:return 4!==Mt.style?[3,9]:[4,this.renderDoubleBorder(Mt.color,Mt.width,je,U.curves)];case 8:return yn.sent(),[3,11];case 9:return[4,this.renderSolidBorder(Mt.color,je,U.curves)];case 10:yn.sent(),yn.label=11;case 11:je++,yn.label=12;case 12:return Qe++,[3,3];case 13:return[2]}})})},R.prototype.renderDashedDottedBorder=function(U,N,ee,ue,Te){return Mo(this,void 0,void 0,function(){var je,Qe,mt,Mt,$t,yn,Xi,mn,Ni,Lr,hr,tr,So,Ls,Gr,$i;return vo(this,function(po){return this.ctx.save(),je=function(k,R){switch(R){case 0:return af(k.topLeftBorderStroke,k.topRightBorderStroke);case 1:return af(k.topRightBorderStroke,k.bottomRightBorderStroke);case 2:return af(k.bottomRightBorderStroke,k.bottomLeftBorderStroke);default:return af(k.bottomLeftBorderStroke,k.topLeftBorderStroke)}}(ue,ee),Qe=Ru(ue,ee),2===Te&&(this.path(Qe),this.ctx.clip()),Va(Qe[0])?(mt=Qe[0].start.x,Mt=Qe[0].start.y):(mt=Qe[0].x,Mt=Qe[0].y),Va(Qe[1])?($t=Qe[1].end.x,yn=Qe[1].end.y):($t=Qe[1].x,yn=Qe[1].y),Xi=0===ee||2===ee?Math.abs(mt-$t):Math.abs(Mt-yn),this.ctx.beginPath(),this.formatPath(3===Te?je:Qe.slice(0,2)),mn=N<3?3*N:2*N,Ni=N<3?2*N:N,3===Te&&(mn=N,Ni=N),Lr=!0,Xi<=2*mn?Lr=!1:Xi<=2*mn+Ni?(mn*=hr=Xi/(2*mn+Ni),Ni*=hr):(tr=Math.floor((Xi+Ni)/(mn+Ni)),So=(Xi-tr*mn)/(tr-1),Ni=(Ls=(Xi-(tr+1)*mn)/tr)<=0||Math.abs(Ni-So)<Math.abs(Ni-Ls)?So:Ls),Lr&&this.ctx.setLineDash(3===Te?[0,mn+Ni]:[mn,Ni]),3===Te?(this.ctx.lineCap="round",this.ctx.lineWidth=N):this.ctx.lineWidth=2*N+1.1,this.ctx.strokeStyle=Na(U),this.ctx.stroke(),this.ctx.setLineDash([]),2===Te&&(Va(Qe[0])&&(Gr=Qe[3],$i=Qe[0],this.ctx.beginPath(),this.formatPath([new Si(Gr.end.x,Gr.end.y),new Si($i.start.x,$i.start.y)]),this.ctx.stroke()),Va(Qe[1])&&(Gr=Qe[1],$i=Qe[2],this.ctx.beginPath(),this.formatPath([new Si(Gr.end.x,Gr.end.y),new Si($i.start.x,$i.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},R.prototype.render=function(U){return Mo(this,void 0,void 0,function(){var N;return vo(this,function(ee){switch(ee.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Na(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),N=function(k){var R=new Ml(k,null),U=new vb(R),N=[];return Ha(R,U,U,N),Aa(R.container,N),U}(U),[4,this.renderStack(N)];case 1:return ee.sent(),this.applyEffects([]),[2,this.canvas]}})})},R}(Cv),Ev=function(k){return k instanceof dm||k instanceof sf||k instanceof Xf&&k.type!==qA&&k.type!==$A},Vo=function(k,R){switch(k){case 0:return qc(R);case 2:return function(k){return[k.topLeftContentBox,k.topRightContentBox,k.bottomRightContentBox,k.bottomLeftContentBox]}(R);default:return Fu(R)}},Eb=function(k){switch(k){case 1:return"center";case 2:return"right";default:return"left"}},S_=["-apple-system","system-ui"],Sb=function(k){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?k.filter(function(R){return-1===S_.indexOf(R)}):k},Sv=function(k){function R(U,N){var ee=k.call(this,U,N)||this;return ee.canvas=N.canvas?N.canvas:document.createElement("canvas"),ee.ctx=ee.canvas.getContext("2d"),ee.options=N,ee.canvas.width=Math.floor(N.width*N.scale),ee.canvas.height=Math.floor(N.height*N.scale),ee.canvas.style.width=N.width+"px",ee.canvas.style.height=N.height+"px",ee.ctx.scale(ee.options.scale,ee.options.scale),ee.ctx.translate(-N.x,-N.y),ee.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+N.width+"x"+N.height+" at "+N.x+","+N.y+") with scale "+N.scale),ee}return Zs(R,k),R.prototype.render=function(U){return Mo(this,void 0,void 0,function(){var N,ee;return vo(this,function(ue){switch(ue.label){case 0:return N=GA(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,U),[4,K0(N)];case 1:return ee=ue.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Na(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(ee,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},R}(Cv),K0=function(k){return new Promise(function(R,U){var N=new Image;N.onload=function(){R(N)},N.onerror=U,N.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(k))})},T_=function(){function k(R){var N=R.enabled;this.id=R.id,this.enabled=N,this.start=Date.now()}return k.prototype.debug=function(){for(var R=[],U=0;U<arguments.length;U++)R[U]=arguments[U];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.debug?console.debug.apply(console,p([this.id,this.getTime()+"ms"],R)):this.info.apply(this,R))},k.prototype.getTime=function(){return Date.now()-this.start},k.prototype.info=function(){for(var R=[],U=0;U<arguments.length;U++)R[U]=arguments[U];this.enabled&&typeof window<"u"&&window.console&&"function"==typeof console.info&&console.info.apply(console,p([this.id,this.getTime()+"ms"],R))},k.prototype.warn=function(){for(var R=[],U=0;U<arguments.length;U++)R[U]=arguments[U];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.warn?console.warn.apply(console,p([this.id,this.getTime()+"ms"],R)):this.info.apply(this,R))},k.prototype.error=function(){for(var R=[],U=0;U<arguments.length;U++)R[U]=arguments[U];this.enabled&&(typeof window<"u"&&window.console&&"function"==typeof console.error?console.error.apply(console,p([this.id,this.getTime()+"ms"],R)):this.info.apply(this,R))},k.instances={},k}(),Tv=function(){function k(R,U){var N;this.windowBounds=U,this.instanceName="#"+k.instanceCount++,this.logger=new T_({id:this.instanceName,enabled:R.logging}),this.cache=null!==(N=R.cache)&&void 0!==N?N:new gl(this,R)}return k.instanceCount=1,k}();typeof window<"u"&&za.setContext(window);var fr=function(k,R){return Mo(void 0,void 0,void 0,function(){var U,N,ee,ue,Te,je,Qe,mt,Mt,$t,yn,Xi,mn,Ni,Lr,hr,tr,So,Ls,Gr,$i,go,us,Wl,Kc,tl,No,pa,yl,Wc,nl,lf,$h,qh,wd,gu,Kh,ZA;return vo(this,function(cf){switch(cf.label){case 0:if(!k||"object"!=typeof k)return[2,Promise.reject("Invalid element provided as first argument")];if(!(U=k.ownerDocument))throw new Error("Element is not attached to a Document");if(!(N=U.defaultView))throw new Error("Document is not attached to a Window");return ee={allowTaint:null!==(go=R.allowTaint)&&void 0!==go&&go,imageTimeout:null!==(us=R.imageTimeout)&&void 0!==us?us:15e3,proxy:R.proxy,useCORS:null!==(Wl=R.useCORS)&&void 0!==Wl&&Wl},ue=qr({logging:null===(Kc=R.logging)||void 0===Kc||Kc,cache:R.cache},ee),Te={windowWidth:null!==(tl=R.windowWidth)&&void 0!==tl?tl:N.innerWidth,windowHeight:null!==(No=R.windowHeight)&&void 0!==No?No:N.innerHeight,scrollX:null!==(pa=R.scrollX)&&void 0!==pa?pa:N.pageXOffset,scrollY:null!==(yl=R.scrollY)&&void 0!==yl?yl:N.pageYOffset},je=new Ai(Te.scrollX,Te.scrollY,Te.windowWidth,Te.windowHeight),Qe=new Tv(ue,je),mt=null!==(Wc=R.foreignObjectRendering)&&void 0!==Wc&&Wc,Mt={allowTaint:null!==(nl=R.allowTaint)&&void 0!==nl&&nl,onclone:R.onclone,ignoreElements:R.ignoreElements,inlineImages:mt,copyStyles:mt},Qe.logger.debug("Starting document clone with size "+je.width+"x"+je.height+" scrolled to "+-je.left+","+-je.top),$t=new li(Qe,k,Mt),(yn=$t.clonedReferenceElement)?[4,$t.toIFrame(U,je)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return Xi=cf.sent(),mn=Q(yn)||function(k){return"HTML"===k.tagName}(yn)?function(k){var R=k.body,U=k.documentElement;if(!R||!U)throw new Error("Unable to get document size");var N=Math.max(Math.max(R.scrollWidth,U.scrollWidth),Math.max(R.offsetWidth,U.offsetWidth),Math.max(R.clientWidth,U.clientWidth)),ee=Math.max(Math.max(R.scrollHeight,U.scrollHeight),Math.max(R.offsetHeight,U.offsetHeight),Math.max(R.clientHeight,U.clientHeight));return new Ai(0,0,N,ee)}(yn.ownerDocument):Ra(Qe,yn),Ni=mn.width,Lr=mn.height,hr=mn.left,tr=mn.top,So=cr(Qe,yn,R.backgroundColor),Ls={canvas:R.canvas,backgroundColor:So,scale:null!==($h=null!==(lf=R.scale)&&void 0!==lf?lf:N.devicePixelRatio)&&void 0!==$h?$h:1,x:(null!==(qh=R.x)&&void 0!==qh?qh:0)+hr,y:(null!==(wd=R.y)&&void 0!==wd?wd:0)+tr,width:null!==(gu=R.width)&&void 0!==gu?gu:Math.ceil(Ni),height:null!==(Kh=R.height)&&void 0!==Kh?Kh:Math.ceil(Lr)},mt?(Qe.logger.debug("Document cloned, using foreign object rendering"),[4,new Sv(Qe,Ls).render(yn)]):[3,3];case 2:return Gr=cf.sent(),[3,5];case 3:return Qe.logger.debug("Document cloned, element located at "+hr+","+tr+" with size "+Ni+"x"+Lr+" using computed rendering"),Qe.logger.debug("Starting DOM parsing"),$i=Bl(Qe,yn),So===$i.styles.backgroundColor&&($i.styles.backgroundColor=Hl.TRANSPARENT),Qe.logger.debug("Starting renderer for element at "+Ls.x+","+Ls.y+" with size "+Ls.width+"x"+Ls.height),[4,new dr(Qe,Ls).render($i)];case 4:Gr=cf.sent(),cf.label=5;case 5:return(!(null!==(ZA=R.removeContainer)&&void 0!==ZA)||ZA)&&(li.destroy(Xi)||Qe.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),Qe.logger.debug("Finished rendering"),[2,Gr]}})})},cr=function(k,R,U){var N=R.ownerDocument,ee=N.documentElement?rh(k,getComputedStyle(N.documentElement).backgroundColor):Hl.TRANSPARENT,ue=N.body?rh(k,getComputedStyle(N.body).backgroundColor):Hl.TRANSPARENT,Te="string"==typeof U?rh(k,U):null===U?Hl.TRANSPARENT:4294967295;return R===N.documentElement?uu(ee)?uu(ue)?Te:ue:ee:Te};return function(k,R){return void 0===R&&(R={}),fr(k,R)}}()},2574:function(Sf){Sf.exports=function(){"use strict";var Rc,Zs,qr;function Mo(p,Ai){if(Rc)if(Zs){var Ra="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Rc+")(sharedChunk); ("+Zs+")(sharedChunk); self.onerror = null;",ar={};Rc(ar),qr=Ai(ar),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(qr.workerUrl=window.URL.createObjectURL(new Blob([Ra],{type:"text/javascript"})))}else Zs=Ai;else Rc=Ai}return Mo(0,function(p){var Ai="3.3.0";let Ra;const ar={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Ra){const o=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Ra=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):o}catch{Ra=o}}return Ra},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ar.API_URL)return null;try{const o=new URL(ar.API_URL);return"api.mapbox.cn"===o.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===o.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"};function El(o){return ar.API_URL_REGEX.test(o)}function Di(o){return 0===o.indexOf("mapbox:")}function ia(o){return ar.API_CDN_URL_REGEX.test(o)}function Wa(o){return ar.API_SPRITE_REGEX.test(o)}function Sa(o){return ar.API_STYLE_REGEX.test(o)&&!Wa(o)}const Ih={create:"create",load:"load",fullLoad:"fullLoad"};function Dh(o){const r=o.name.split("?")[0];return ia(r)&&r.includes("mapbox-gl.js")?"javascript":ia(r)&&r.includes("mapbox-gl.css")?"css":ar.API_FONTS_REGEX.test(r)?"fontRange":Wa(r)?"sprite":Sa(r)?"style":ar.API_TILEJSON_REGEX.test(r)?"tilejson":"other"}function Ta(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Bh=ec;function ec(o,r,a,u){this.cx=3*o,this.bx=3*(a-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(u-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=r,this.p2x=a,this.p2y=u}ec.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,r){if(void 0===r&&(r=1e-6),o<0)return 0;if(o>1)return 1;for(var a=o,u=0;u<8;u++){var f=this.sampleCurveX(a)-o;if(Math.abs(f)<r)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=f/g}var v=0,x=1;for(a=o,u=0;u<20&&(f=this.sampleCurveX(a),!(Math.abs(f-o)<r));u++)o>f?v=a:x=a,a=.5*(x-v)+v;return a},solve:function(o,r){return this.sampleCurveY(this.solveCurveX(o,r))}};var Oc=Ta(Bh),Ul=tc;function tc(o,r){this.x=o,this.y=r}tc.prototype={clone:function(){return new tc(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,r){return this.clone()._rotateAround(o,r)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var r=o.x-this.x,a=o.y-this.y;return r*r+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,r){return Math.atan2(this.x*r-this.y*o,this.x*o+this.y*r)},_matMult:function(o){var r=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=r,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var r=Math.cos(o),a=Math.sin(o),u=a*this.x+r*this.y;return this.x=r*this.x-a*this.y,this.y=u,this},_rotateAround:function(o,r){var a=Math.cos(o),u=Math.sin(o),f=r.y+u*(this.x-r.x)+a*(this.y-r.y);return this.x=r.x+a*(this.x-r.x)-u*(this.y-r.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},tc.convert=function(o){return o instanceof tc?o:Array.isArray(o)?new tc(o[0],o[1]):o};var Nn=Ta(Ul);const Sl=Math.PI/180,od=180/Math.PI;function Sr(o){return o*Sl}function Jo(o){return o*od}const EA=[[0,0],[1,0],[1,1],[0,1]];function ei(o){if(o<=0)return 0;if(o>=1)return 1;const r=o*o,a=r*o;return 4*(o<.5?a:3*(o-r)+a-.75)}function kc(o,r,a,u){const f=new Oc(o,r,a,u);return function(g){return f.solve(g)}}const ll=kc(.25,.1,.25,1);function ir(o,r,a){return Math.min(a,Math.max(r,o))}function Od(o,r,a){return(a=ir((a-o)/(r-o),0,1))*a*(3-2*a)}function Xu(o,r,a){const u=a-r,f=((o-r)%u+u)%u+r;return f===r?a:f}function Hr(o,r,a){if(!o.length)return a(null,[]);let u=o.length;const f=new Array(o.length);let g=null;o.forEach((v,x)=>{r(v,(S,T)=>{S&&(g=S),f[x]=T,0==--u&&a(g,f)})})}function Oa(o,...r){for(const a of r)for(const u in a)o[u]=a[u];return o}let Mh=1;function kd(){return Mh++}function Pd(){return function o(r){return r?(r^Math.random()*(16>>r/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,o)}()}function Li(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function Tf(o){return!!o&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o)}function ru(o,r){o.forEach(a=>{r[a]&&(r[a]=r[a].bind(r))})}function Xs(o,r){return-1!==o.indexOf(r,o.length-r.length)}function Kr(o,r,a){const u={};for(const f in o)u[f]=r.call(a||this,o[f],f,o);return u}function dc(o,r,a){const u={};for(const f in o)r.call(a||this,o[f],f,o)&&(u[f]=o[f]);return u}function Ht(o){return Array.isArray(o)?o.map(Ht):"object"==typeof o&&o?Kr(o,Ht):o}const Nd={};function $o(o){Nd[o]||(typeof console<"u"&&console.warn(o),Nd[o]=!0)}function nc(o,r,a){return(a.y-o.y)*(r.x-o.x)>(r.y-o.y)*(a.x-o.x)}function Cu(o){let r=0;for(let a,u,f=0,g=o.length,v=g-1;f<g;v=f++)a=o[f],u=o[v],r+=(u.x-a.x)*(a.y+u.y);return r}function Eu([o,r,a]){const u=Sr(r+90),f=Sr(a);return{x:o*Math.cos(u)*Math.sin(f),y:o*Math.sin(u)*Math.sin(f),z:o*Math.cos(f),azimuthal:r,polar:a}}function Pc(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function zt(o){const r={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,u,f,g)=>{const v=f||g;return r[u]=!v||v.toLowerCase(),""}),r["max-age"]){const a=parseInt(r["max-age"],10);isNaN(a)?delete r["max-age"]:r["max-age"]=a}return r}let Ct,vn,Hn,_i,Mi,Lo,kt=null;function _e(o){try{const r=self[o];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}}function Re(o,r){return[o[4*r],o[4*r+1],o[4*r+2],o[4*r+3]]}function tt(o,r,a,u){for(;r<a;){const f=r+a>>1;o[f]<u?r=f+1:a=f}return r}function Gt(o,r,a,u){for(;r<a;){const f=r+a>>1;o[f]<=u?r=f+1:a=f}return r}function tn(){return null==Ct&&(Ct=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),Ct}const wn={now:()=>void 0!==_i?_i:performance.now(),setNow(o){_i=o},restoreNow(){_i=void 0},frame(o){const r=requestAnimationFrame(o);return{cancel:()=>cancelAnimationFrame(r)}},getImageData(o,r=0){const{width:a,height:u}=o;Mi||(Mi=document.createElement("canvas"));const f=Mi.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(a>Mi.width||u>Mi.height)&&(Mi.width=a,Mi.height=u),f.clearRect(-r,-r,a+2*r,u+2*r),f.drawImage(o,0,0,a,u),f.getImageData(-r,-r,a+2*r,u+2*r)},resolveURL:o=>(vn||(vn=document.createElement("a")),vn.href=o,vn.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(null==Hn&&(Hn=window.matchMedia("(prefers-reduced-motion: reduce)")),Hn.matches)},hasCanvasFingerprintNoise(){if(void 0!==Lo)return Lo;if(!tn())return Lo=!1,!1;const o=new OffscreenCanvas(85,1),r=o.getContext("2d",{willReadFrequently:!0});let a=0;for(let f=0;f<o.width;++f)r.fillStyle=`rgba(${a++},${a++},${a++}, 255)`,r.fillRect(f,0,1,1);const u=r.getImageData(0,0,o.width,o.height);a=0;for(let f=0;f<u.data.length;++f)if(f%4!=3&&a++!==u.data[f])return Lo=!0,!0;return Lo=!1,!1}},zn="mapbox-tiles";let Zn,ui,Vt=500,jn=50;function vr(){try{return caches}catch{}}function os(){const o=vr();o&&!Zn&&(Zn=o.open(zn))}function bo(o){const r=o.indexOf("?");if(r<0)return o;const a=["language","worldview"],u=new URLSearchParams,f=new URLSearchParams(o.slice(r));for(const g of a){const v=f.get(g);v&&u.set(g,v)}return`${o.slice(0,r)}?${u.toString()}`}function Os(o,r){const a=o.indexOf("?");if(a<0)return`${o}?${new URLSearchParams(r).toString()}`;const u=new URLSearchParams(o.slice(a));for(const f in r)u.set(f,r[f]);return`${o.slice(0,a)}?${u.toString()}`}let as=1/0;const ls={supported:!1,testSupport:function(o){!ca&&ro&&(fo?Xa(o):Ss=o)}};let Ss,ro,ca=!1,fo=!1;const Za=typeof self<"u"?self:{};function Xa(o){const r=o.createTexture();o.bindTexture(o.TEXTURE_2D,r);try{if(o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,ro),o.isContextLost())return;ls.supported=!0}catch{}o.deleteTexture(r),ca=!0}Za.document&&(ro=Za.document.createElement("img"),ro.onload=function(){Ss&&Xa(Ss),Ss=null,fo=!0},ro.onerror=function(){ca=!0,Ss=null},ro.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const zl={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(zl);class ua extends Error{constructor(r,a,u){401===a&&El(u)&&(r+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(r),this.status=a,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ha=Pc()?()=>self.worker&&self.worker.referrer:()=>("blob:"===location.protocol?parent:self).location.href,Zt=function(o,r){if(!(/^file:/.test(a=o.url)||/^file:/.test(ha())&&!/^\w+:/.test(a))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,f){const g=new AbortController,v=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:ha(),referrerPolicy:u.referrerPolicy,signal:g.signal});let x=!1,S=!1;const T=(D=v.url).indexOf("sku=")>0&&El(D);var D;"json"===u.type&&v.headers.set("Accept","application/json");const O=($,K,X)=>{if(S)return;if($&&"SecurityError"!==$.message&&$o($.toString()),K&&X)return z(K);const ie=Date.now();fetch(v).then(ae=>{if(ae.ok){const be=T?ae.clone():null;return z(ae,be,ie)}return f(new ua(ae.statusText,ae.status,u.url))}).catch(ae=>{"AbortError"!==ae.name&&f(new Error(`${ae.message} ${u.url}`))})},z=($,K,X)=>{("arrayBuffer"===u.type?$.arrayBuffer():"json"===u.type?$.json():$.text()).then(ie=>{S||(K&&X&&function(ae,be,Ce){if(os(),!Zn)return;const Ee=zt(be.headers.get("Cache-Control")||"");if(Ee["no-store"])return;const Le={status:be.status,statusText:be.statusText,headers:new Headers};be.headers.forEach((rt,ht)=>Le.headers.set(ht,rt)),Ee["max-age"]&&Le.headers.set("Expires",new Date(Ce+1e3*Ee["max-age"]).toUTCString());const Oe=Le.headers.get("Expires");if(!Oe||new Date(Oe).getTime()-Ce<42e4)return;let qe=bo(ae.url);if(206===be.status){const rt=ae.headers.get("Range");if(!rt)return;Le.status=200,qe=Os(qe,{range:rt})}!function(rt,ht){if(void 0===ui)try{new Response(new ReadableStream),ui=!0}catch{ui=!1}ui?ht(rt.body):rt.blob().then(ht)}(be,rt=>{const ht=new Response(rt,Le);os(),Zn&&Zn.then(It=>It.put(qe,ht)).catch(It=>$o(It.message))})}(v,K,X),x=!0,f(null,ie,$.headers.get("Cache-Control"),$.headers.get("Expires")))}).catch(ie=>{S||f(new Error(ie.message))})};return T?function($,K){if(os(),!Zn)return K(null);Zn.then(X=>{let ie=bo($.url);const ae=$.headers.get("Range");ae&&(ie=Os(ie,{range:ae})),X.match(ie).then(be=>{const Ce=function(Ee){if(!Ee)return!1;const Le=new Date(Ee.headers.get("Expires")||0),Oe=zt(Ee.headers.get("Cache-Control")||"");return Le>Date.now()&&!Oe["no-cache"]}(be);X.delete(ie),Ce&&X.put(ie,be.clone()),K(null,be,Ce)}).catch(K)}).catch(K)}(v,O):O(null,null),{cancel:()=>{S=!0,x||g.abort()}}}(o,r);if(Pc()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,r,void 0,!0)}var a;return function(u,f){const g=new XMLHttpRequest;g.open(u.method||"GET",u.url,!0),"arrayBuffer"===u.type&&(g.responseType="arraybuffer");for(const v in u.headers)g.setRequestHeader(v,u.headers[v]);return"json"===u.type&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials="include"===u.credentials,g.onerror=()=>{f(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||0===g.status)&&null!==g.response){let v=g.response;if("json"===u.type)try{v=JSON.parse(g.response)}catch(x){return f(x)}f(null,v,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else f(new ua(g.statusText,g.status,u.url))},g.send(u.body),{cancel:()=>g.abort()}}(o,r)},Jt=function(o,r){return Zt(Oa(o,{type:"arrayBuffer"}),r)};function Wt(o){const r=document.createElement("a");return r.href=o,r.protocol===location.protocol&&r.host===location.host}const On="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Bn,gn;Bn=[],gn=0;const Gn=function(o,r){if(ls.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),gn>=ar.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:o,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return Bn.push(g),g}gn++;let a=!1;const u=()=>{if(!a)for(a=!0,gn--;Bn.length&&gn<ar.MAX_PARALLEL_IMAGE_REQUESTS;){const g=Bn.shift(),{requestParameters:v,callback:x,cancelled:S}=g;S||(g.cancel=Gn(v,x).cancel)}},f=Jt(o,(g,v,x,S)=>{u(),g?r(g):v&&(self.createImageBitmap?function(T,D){const O=new Blob([new Uint8Array(T)],{type:"image/png"});createImageBitmap(O).then(z=>{D(null,z)}).catch(z=>{D(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(T,D)=>r(T,D,x,S)):function(T,D){const O=new Image;O.onload=()=>{D(null,O),URL.revokeObjectURL(O.src),O.onload=null,requestAnimationFrame(()=>{O.src=On})},O.onerror=()=>D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const z=new Blob([new Uint8Array(T)],{type:"image/png"});O.src=T.byteLength?URL.createObjectURL(z):On}(v,(T,D)=>r(T,D,x,S)))});return{cancel:()=>{f.cancel(),u()}}},Ln="01",ii="NO_ACCESS_TOKEN",Vn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ji(o){const r=o.match(Vn);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Ur(o){const r=o.params.length?`?${o.params.join("&")}`:"";return`${o.protocol}://${o.authority}${o.path}${r}`}const Ci="mapbox.eventData";function Jr(o){if(!o)return null;const r=o.split(".");if(!r||3!==r.length)return null;try{return JSON.parse(decodeURIComponent(atob(r[1]).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class wo{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const a=Jr(ar.ACCESS_TOKEN);let u="";return u=a&&a.u?btoa(encodeURIComponent(a.u).replace(/%([0-9A-F]{2})/g,(f,g)=>String.fromCharCode(+("0x"+g)))):ar.ACCESS_TOKEN||"",r?`${Ci}.${r}:${u}`:`${Ci}:${u}`}fetchEventData(){const r=_e("localStorage"),a=this.getStorageKey(),u=this.getStorageKey("uuid");if(r)try{const f=localStorage.getItem(a);f&&(this.eventData=JSON.parse(f));const g=localStorage.getItem(u);g&&(this.anonId=g)}catch{$o("Unable to read from LocalStorage")}}saveEventData(){const r=_e("localStorage"),a=this.getStorageKey(),u=this.getStorageKey("uuid"),f=this.anonId;if(r&&f)try{localStorage.setItem(u,f),Object.keys(this.eventData).length>=1&&localStorage.setItem(a,JSON.stringify(this.eventData))}catch{$o("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,a,u,f){if(!ar.EVENTS_URL)return;const g=ji(ar.EVENTS_URL);g.params.push(`access_token=${f||ar.ACCESS_TOKEN||""}`);const v={event:this.type,created:new Date(r).toISOString()},x=a?Oa(v,a):v,S={url:Ur(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([x])};var D;this.pendingRequest=(D=T=>{this.pendingRequest=null,u(T),this.saveEventData(),this.processRequests(f)},Zt(Oa(S,{method:"POST"}),D))}queueRequest(r,a){this.queue.push(r),this.processRequests(a)}}const es=new class extends wo{constructor(o){super("appUserTurnstile"),this._customAccessToken=o}postTurnstileEvent(o,r){ar.EVENTS_URL&&ar.ACCESS_TOKEN&&Array.isArray(o)&&o.some(a=>Di(a)||El(a))&&this.queueRequest(Date.now(),r)}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=Jr(ar.ACCESS_TOKEN),a=r?r.u:ar.ACCESS_TOKEN;let u=a!==this.eventData.tokenU;Tf(this.anonId)||(this.anonId=Pd(),u=!0);const f=this.queue.shift();if(this.eventData.lastSuccess){const g=new Date(this.eventData.lastSuccess),v=new Date(f),x=(f-this.eventData.lastSuccess)/864e5;u=u||x>=1||x<-1||g.getDate()!==v.getDate()}else u=!0;u?this.postEvent(f,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Ai,skuId:Ln,"enabled.telemetry":!1,userId:this.anonId},g=>{g||(this.eventData.lastSuccess=f,this.eventData.tokenU=a)},o):this.processRequests()}},qo=es.postTurnstileEvent.bind(es),Fo=new class extends wo{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(o,r,a,u){this.skuToken=r,this.errorCb=u,ar.EVENTS_URL&&(a||ar.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},a):this.errorCb(new Error(ii)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:a}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),Tf(this.anonId)||(this.anonId=Pd()),this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Ai,skuId:Ln,skuToken:this.skuToken,userId:this.anonId},u=>{u?this.errorCb(u):r&&(this.success[r]=!0)},o))}remove(){this.errorCb=null}},_s=Fo.postMapLoadEvent.bind(Fo),su=new class extends wo{constructor(){super("gljs.performance")}postPerformanceEvent(o,r){ar.EVENTS_URL&&(o||ar.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},o)}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:r,performanceData:a}=this.queue.shift(),u=function(f){const g=performance.getEntriesByType("resource"),v=performance.getEntriesByType("mark"),x=function($){const K={};if($)for(const X in $)if("other"!==X)for(const ie of $[X]){const ae=`${X}ResolveRangeMin`,be=`${X}ResolveRangeMax`,Ce=`${X}RequestCount`,Ee=`${X}RequestCachedCount`;K[ae]=Math.min(K[ae]||1/0,ie.startTime),K[be]=Math.max(K[be]||-1/0,ie.responseEnd);const Le=Oe=>{void 0===K[Oe]&&(K[Oe]=0),++K[Oe]};void 0!==ie.transferSize&&0===ie.transferSize&&Le(Ee),Le(Ce)}return K}(function($,K){const X={};if($)for(const ie of $){const ae=K(ie);void 0===X[ae]&&(X[ae]=[]),X[ae].push(ie)}return X}(g,Dh)),S=window.devicePixelRatio,T=navigator.connection||navigator.mozConnection||navigator.webkitConnection,D=T?T.effectiveType:void 0,O={counters:[],metadata:[],attributes:[]},z=($,K,X)=>{null!=X&&$.push({name:K,value:X.toString()})};for(const $ in x)z(O.counters,$,x[$]);if(f.interactionRange[0]!==1/0&&f.interactionRange[1]!==-1/0&&(z(O.counters,"interactionRangeMin",f.interactionRange[0]),z(O.counters,"interactionRangeMax",f.interactionRange[1])),v)for(const $ of Object.keys(Ih)){const K=Ih[$],X=v.find(ie=>ie.name===K);X&&z(O.counters,K,X.startTime)}return z(O.counters,"visibilityHidden",f.visibilityHidden),z(O.attributes,"style",function($){if($)for(const K of $){const X=K.name.split("?")[0];if(Sa(X)){const ie=X.split("/").slice(-2);if(2===ie.length)return`mapbox://styles/${ie[0]}/${ie[1]}`}}}(g)),z(O.attributes,"terrainEnabled",f.terrainEnabled?"true":"false"),z(O.attributes,"fogEnabled",f.fogEnabled?"true":"false"),z(O.attributes,"projection",f.projection),z(O.attributes,"zoom",f.zoom),z(O.metadata,"devicePixelRatio",S),z(O.metadata,"connectionEffectiveType",D),z(O.metadata,"navigatorUserAgent",navigator.userAgent),z(O.metadata,"screenWidth",window.screen.width),z(O.metadata,"screenHeight",window.screen.height),z(O.metadata,"windowWidth",window.innerWidth),z(O.metadata,"windowHeight",window.innerHeight),z(O.metadata,"mapWidth",f.width/S),z(O.metadata,"mapHeight",f.height/S),z(O.metadata,"webglRenderer",f.renderer),z(O.metadata,"webglVendor",f.vendor),z(O.metadata,"sdkVersion",Ai),z(O.metadata,"sdkIdentifier","mapbox-gl-js"),O}(a);for(const f of u.metadata);for(const f of u.counters);for(const f of u.attributes);this.postEvent(r,u,()=>{},o)}},Su=su.postPerformanceEvent.bind(su),da=new class extends wo{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(o,r,a,u){if(!ar.API_URL||!ar.SESSION_PATH)return;const f=ji(ar.API_URL+ar.SESSION_PATH);f.params.push(`sku=${r||""}`),f.params.push(`access_token=${u||ar.ACCESS_TOKEN||""}`);const g={url:Ur(f),headers:{"Content-Type":"text/plain"}};var x;this.pendingRequest=(x=v=>{this.pendingRequest=null,a(v),this.saveEventData(),this.processRequests(u)},Zt(Oa(g,{method:"GET"}),x))}getSessionAPI(o,r,a,u){this.skuToken=r,this.errorCb=u,ar.SESSION_PATH&&ar.API_URL&&(a||ar.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},a):this.errorCb(new Error(ii)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:a}=this.queue.shift();r&&this.success[r]||this.getSession(a,this.skuToken,u=>{u?this.errorCb(u):r&&(this.success[r]=!0)},o)}remove(){this.errorCb=null}},ad=da.getSessionAPI.bind(da),fc=new Set;function If(o,r,a){a[o]&&-1!==a[o].indexOf(r)||(a[o]=a[o]||[],a[o].push(r))}function Ld(o,r,a){if(a&&a[o]){const u=a[o].indexOf(r);-1!==u&&a[o].splice(u,1)}}class Ud{constructor(r,a={}){Oa(this,a),this.type=r}}class e_ extends Ud{constructor(r,a={}){super("error",Oa({error:r},a))}}class ld{on(r,a){return this._listeners=this._listeners||{},If(r,a,this._listeners),this}off(r,a){return Ld(r,a,this._listeners),Ld(r,a,this._oneTimeListeners),this}once(r,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},If(r,a,this._oneTimeListeners),this):new Promise(u=>this.once(r,u))}fire(r,a){"string"==typeof r&&(r=new Ud(r,a||{}));const u=r.type;if(this.listens(u)){r.target=this;const f=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const x of f)x.call(this,r);const g=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const x of g)Ld(u,x,this._oneTimeListeners),x.call(this,r);const v=this._eventedParent;v&&(Oa(r,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),v.fire(r))}else r instanceof e_&&console.error(r.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,a){return this._eventedParent=r,this._eventedParentData=a,this}}p.y=void 0;var SA={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Og(o){return(o=Math.round(o))<0?0:o>255?255:o}function kg(o){return Og("%"===o[o.length-1]?parseFloat(o)/100*255:parseInt(o))}function Pg(o){return(r="%"===o[o.length-1]?parseFloat(o)/100:parseFloat(o))<0?0:r>1?1:r;var r}function TA(o,r,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?o+(r-o)*a*6:2*a<1?r:3*a<2?o+(r-o)*(2/3-a)*6:o}try{p.y={}.parseCSSColor=function(o){var r,a=o.replace(/ /g,"").toLowerCase();if(a in SA)return SA[a].slice();if("#"===a[0])return 4===a.length?(r=parseInt(a.substr(1),16))>=0&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null:7===a.length&&(r=parseInt(a.substr(1),16))>=0&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null;var u=a.indexOf("("),f=a.indexOf(")");if(-1!==u&&f+1===a.length){var g=a.substr(0,u),v=a.substr(u+1,f-(u+1)).split(","),x=1;switch(g){case"rgba":if(4!==v.length)return null;x=Pg(v.pop());case"rgb":return 3!==v.length?null:[kg(v[0]),kg(v[1]),kg(v[2]),x];case"hsla":if(4!==v.length)return null;x=Pg(v.pop());case"hsl":if(3!==v.length)return null;var S=(parseFloat(v[0])%360+360)%360/360,T=Pg(v[1]),D=Pg(v[2]),O=D<=.5?D*(T+1):D+T-D*T,z=2*D-O;return[Og(255*TA(z,O,S+1/3)),Og(255*TA(z,O,S)),Og(255*TA(z,O,S-1/3)),x];default:return null}}return null}}catch{}class Gs{constructor(r,a,u,f=1){this.r=r,this.g=a,this.b=u,this.a=f}static parse(r){if(!r)return;if(r instanceof Gs)return r;if("string"!=typeof r)return;const a=p.y(r);return a?new Gs(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[r,a,u,f]=this.toArray();return`rgba(${Math.round(r)},${Math.round(a)},${Math.round(u)},${f})`}toArray(){const{r,g:a,b:u,a:f}=this;return 0===f?[0,0,0,0]:[255*r/f,255*a/f,255*u/f,f]}toArray01(){const{r,g:a,b:u,a:f}=this;return 0===f?[0,0,0,0]:[r/f,a/f,u/f,f]}toArray01Scaled(r){const{r:a,g:u,b:f,a:g}=this;return 0===g?[0,0,0]:[a/g*r,u/g*r,f/g*r]}toArray01PremultipliedAlpha(){const{r,g:a,b:u,a:f}=this;return[r,a,u,f]}toArray01Linear(){const{r,g:a,b:u,a:f}=this;return 0===f?[0,0,0,0]:[Math.pow(r/f,2.2),Math.pow(a/f,2.2),Math.pow(u/f,2.2),f]}}Gs.black=new Gs(0,0,0,1),Gs.white=new Gs(1,1,1,1),Gs.transparent=new Gs(0,0,0,0),Gs.red=new Gs(1,0,0,1),Gs.blue=new Gs(0,0,1,1);var so=Gs;function Fi(o,r,a){return o*(1-a)+r*a}function Bi(o,r,a){return o.map((u,f)=>Fi(u,r[f],a))}var gp=Object.freeze({__proto__:null,array:Bi,color:function(o,r,a){return new so(Fi(o.r,r.r,a),Fi(o.g,r.g,a),Fi(o.b,r.b,a),Fi(o.a,r.a,a))},number:Fi});function mp(o,...r){for(const a of r)for(const u in a)o[u]=a[u];return o}class cl extends Error{constructor(r,a){super(a),this.message=a,this.key=r}}var Tl=cl;class t_{constructor(r,a=[]){this.parent=r,this.bindings={};for(const[u,f]of a)this.bindings[u]=f}concat(r){return new t_(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}var Ro=t_;const cd={kind:"null"},Un={kind:"number"},Wr={kind:"string"},ys={kind:"boolean"},Nr={kind:"color"},Br={kind:"object"},Qr={kind:"value"},Df={kind:"collator"},Bf={kind:"formatted"},Tu={kind:"resolvedImage"};function ln(o,r){return{kind:"array",itemType:o,N:r}}function Ko(o){if("array"===o.kind){const r=Ko(o.itemType);return"number"==typeof o.N?`array<${r}, ${o.N}>`:"value"===o.itemType.kind?"array":`array<${r}>`}return o.kind}const kn=[cd,Un,Wr,ys,Nr,Bf,Br,ln(Qr),Tu];function Ts(o,r){if("error"===r.kind)return null;if("array"===o.kind){if("array"===r.kind&&(0===r.N&&"value"===r.itemType.kind||!Ts(o.itemType,r.itemType))&&("number"!=typeof o.N||o.N===r.N))return null}else{if(o.kind===r.kind)return null;if("value"===o.kind)for(const a of kn)if(!Ts(a,r))return null}return`Expected ${Ko(o)} but found ${Ko(r)} instead.`}function or(o,r){return r.some(a=>a.kind===o.kind)}function Mf(o,r){return r.some(a=>"null"===a?null===o:"array"===a?Array.isArray(o):"object"===a?o&&!Array.isArray(o)&&"object"==typeof o:a===typeof o)}class Tr{constructor(r,a,u){this.sensitivity=r?a?"variant":"case":a?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,a){return this.collator.compare(r,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class zd{constructor(r,a,u,f,g){this.text=r.normalize?r.normalize():r,this.image=a,this.scale=u,this.fontStack=f,this.textColor=g}}class xo{constructor(r){this.sections=r}static fromString(r){return new xo([new zd(r,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(r=>0!==r.text.length||r.image&&0!==r.image.namePrimary.length)}static factory(r){return r instanceof xo?r:xo.fromString(r)}toString(){return 0===this.sections.length?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const a of this.sections){if(a.image){r.push(["image",a.image.namePrimary]);continue}r.push(a.text);const u={};a.fontStack&&(u["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(u["font-scale"]=a.scale),a.textColor&&(u["text-color"]=["rgba"].concat(a.textColor.toArray())),r.push(u)}return r}}class Ri{constructor(r){this.namePrimary=r.namePrimary,r.nameSecondary&&(this.nameSecondary=r.nameSecondary),this.available=r.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(r,a){return r?new Ri({namePrimary:r,nameSecondary:a,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Yu(o,r,a,u){return"number"==typeof o&&o>=0&&o<=255&&"number"==typeof r&&r>=0&&r<=255&&"number"==typeof a&&a>=0&&a<=255?void 0===u||"number"==typeof u&&u>=0&&u<=1?null:`Invalid rgba value [${[o,r,a,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof u?[o,r,a,u]:[o,r,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ff(o){if(null===o||"string"==typeof o||"boolean"==typeof o||"number"==typeof o||o instanceof so||o instanceof Tr||o instanceof xo||o instanceof Ri)return!0;if(Array.isArray(o)){for(const r of o)if(!Ff(r))return!1;return!0}if("object"==typeof o){for(const r in o)if(!Ff(o[r]))return!1;return!0}return!1}function Oo(o){if(null===o)return cd;if("string"==typeof o)return Wr;if("boolean"==typeof o)return ys;if("number"==typeof o)return Un;if(o instanceof so)return Nr;if(o instanceof Tr)return Df;if(o instanceof xo)return Bf;if(o instanceof Ri)return Tu;if(Array.isArray(o)){const r=o.length;let a;for(const u of o){const f=Oo(u);if(a){if(a===f)continue;a=Qr;break}a=f}return ln(a||Qr,r)}return Br}function Iu(o){const r=typeof o;return null===o?"":"string"===r||"number"===r||"boolean"===r?String(o):o instanceof so||o instanceof xo||o instanceof Ri?o.toString():JSON.stringify(o)}class Rf{constructor(r,a){this.type=r,this.value=a}static parse(r,a){if(2!==r.length)return a.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!Ff(r[1]))return a.error("invalid value");const u=r[1];let f=Oo(u);const g=a.expectedType;return"array"!==f.kind||0!==f.N||!g||"array"!==g.kind||"number"==typeof g.N&&0!==g.N||(f=g),new Rf(f,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof so?["rgba"].concat(this.value.toArray()):this.value instanceof xo?this.value.serialize():this.value}}var Vd=Rf,ka=class{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}};const Ng={string:Wr,number:Un,boolean:ys,object:Br};class n_{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");let u,f=1;const g=r[0];if("array"===g){let x,S;if(r.length>2){const T=r[1];if("string"!=typeof T||!(T in Ng)||"object"===T)return a.error('The item type argument of "array" must be one of string, number, boolean',1);x=Ng[T],f++}else x=Qr;if(r.length>3){if(null!==r[2]&&("number"!=typeof r[2]||r[2]<0||r[2]!==Math.floor(r[2])))return a.error('The length argument to "array" must be a positive integer literal',2);S=r[2],f++}u=ln(x,S)}else u=Ng[g];const v=[];for(;f<r.length;f++){const x=a.parse(r[f],f,Qr);if(!x)return null;v.push(x)}return new n_(u,v)}evaluate(r){for(let a=0;a<this.args.length;a++){const u=this.args[a].evaluate(r);if(!Ts(this.type,Oo(u)))return u;if(a===this.args.length-1)throw new ka(`Expected value to be of type ${Ko(this.type)}, but found ${Ko(Oo(u))} instead.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,a=[r.kind];if("array"===r.kind){const u=r.itemType;if("string"===u.kind||"number"===u.kind||"boolean"===u.kind){a.push(u.kind);const f=r.N;("number"==typeof f||this.args.length>1)&&a.push(f)}}return a.concat(this.args.map(u=>u.serialize()))}}var Fh=n_;class _p{constructor(r){this.type=Bf,this.sections=r}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const u=r[1];if(!Array.isArray(u)&&"object"==typeof u)return a.error("First argument must be an image or text section.");const f=[];let g=!1;for(let v=1;v<=r.length-1;++v){const x=r[v];if(g&&"object"==typeof x&&!Array.isArray(x)){g=!1;let S=null;if(x["font-scale"]&&(S=a.parse(x["font-scale"],1,Un),!S))return null;let T=null;if(x["text-font"]&&(T=a.parse(x["text-font"],1,ln(Wr)),!T))return null;let D=null;if(x["text-color"]&&(D=a.parse(x["text-color"],1,Nr),!D))return null;const O=f[f.length-1];O.scale=S,O.font=T,O.textColor=D}else{const S=a.parse(r[v],1,Qr);if(!S)return null;const T=S.type.kind;if("string"!==T&&"value"!==T&&"null"!==T&&"resolvedImage"!==T)return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,f.push({content:S,scale:null,font:null,textColor:null})}}return new _p(f)}evaluate(r){return new xo(this.sections.map(a=>{const u=a.content.evaluate(r);return Oo(u)===Tu?new zd("",u,null,null,null):new zd(Iu(u),null,a.scale?a.scale.evaluate(r):null,a.font?a.font.evaluate(r).join(","):null,a.textColor?a.textColor.evaluate(r):null)}))}eachChild(r){for(const a of this.sections)r(a.content),a.scale&&r(a.scale),a.font&&r(a.font),a.textColor&&r(a.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const a of this.sections){r.push(a.content.serialize());const u={};a.scale&&(u["font-scale"]=a.scale.serialize()),a.font&&(u["text-font"]=a.font.serialize()),a.textColor&&(u["text-color"]=a.textColor.serialize()),r.push(u)}return r}}class Il{constructor(r,a){this.type=Tu,this.inputPrimary=r,this.inputSecondary=a}static parse(r,a){if(r.length<2)return a.error("Expected two or more arguments.");const u=a.parse(r[1],1,Wr);if(!u)return a.error("No image name provided.");if(2===r.length)return new Il(u);const f=a.parse(r[2],1,Wr);return f?new Il(u,f):a.error("Secondary image variant is not a string.")}evaluate(r){const a=Ri.fromString(this.inputPrimary.evaluate(r),this.inputSecondary?this.inputSecondary.evaluate(r):void 0);return a&&r.availableImages&&(a.available=r.availableImages.indexOf(a.namePrimary)>-1,a.nameSecondary&&a.available&&r.availableImages&&(a.available=r.availableImages.indexOf(a.nameSecondary)>-1)),a}eachChild(r){r(this.inputPrimary),this.inputSecondary&&r(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function qi(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":null===o?"null":typeof o}const Rh={"to-boolean":ys,"to-color":Nr,"to-number":Un,"to-string":Wr};class Hd{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const u=r[0],f=[];let g=cd;if("to-array"===u){if(!Array.isArray(r[1]))return null;const v=r[1].length;if(a.expectedType){if("array"!==a.expectedType.kind)return a.error(`Expected ${a.expectedType.kind} but found array.`);g=ln(a.expectedType.itemType,v)}else{if(!(v>0&&Ff(r[1][0])))return null;g=ln(Oo(r[1][0]),v)}for(let x=0;x<v;x++){const S=r[1][x];let T;if("array"===qi(S))T=a.parse(S,void 0,g.itemType);else{const D=qi(S);if(D!==g.itemType.kind)return a.error(`Expected ${g.itemType.kind} but found ${D}.`);T=a.registry.literal.parse(["literal",void 0===S?null:S],a)}if(!T)return null;f.push(T)}}else{if(("to-boolean"===u||"to-string"===u)&&2!==r.length)return a.error("Expected one argument.");g=Rh[u];for(let v=1;v<r.length;v++){const x=a.parse(r[v],v,Qr);if(!x)return null;f.push(x)}}return new Hd(g,f)}evaluate(r){if("boolean"===this.type.kind)return!!this.args[0].evaluate(r);if("color"===this.type.kind){let a,u;for(const f of this.args){if(a=f.evaluate(r),u=null,a instanceof so)return a;if("string"==typeof a){const g=r.parseColor(a);if(g)return g}else if(Array.isArray(a)&&(u=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Yu(a[0],a[1],a[2],a[3]),!u))return new so(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new ka(u||`Could not parse color from value '${"string"==typeof a?a:String(JSON.stringify(a))}'`)}if("number"===this.type.kind){let a=null;for(const u of this.args){if(a=u.evaluate(r),null===a)return 0;const f=Number(a);if(!isNaN(f))return f}throw new ka(`Could not convert ${JSON.stringify(a)} to number.`)}return"formatted"===this.type.kind?xo.fromString(Iu(this.args[0].evaluate(r))):"resolvedImage"===this.type.kind?Ri.fromString(Iu(this.args[0].evaluate(r))):"array"===this.type.kind?this.args.map(a=>a.evaluate(r)):Iu(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if("formatted"===this.type.kind)return new _p([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Il(this.args[0]).serialize();const r="array"===this.type.kind?[]:[`to-${this.type.kind}`];return this.eachChild(a=>{r.push(a.serialize())}),r}}var Qd=Hd;const Pn=["Unknown","Point","LineString","Polygon"];var pv=class{constructor(o,r){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=o,this.options=r}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Pn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(o){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,r=this.featureDistanceData.scale,{x:a,y:u}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(a*r-o[0])+this.featureDistanceData.bearing[1]*(u*r-o[1])}return 0}parseColor(o){let r=this._parseColorCache[o];return r||(r=this._parseColorCache[o]=so.parse(o)),r}getConfig(o){return this.options?this.options.get(o):null}};class cs{constructor(r,a,u,f,g){this.name=r,this.type=a,this._evaluate=u,this.args=f,this._overloadIndex=g}evaluate(r){if(!this._evaluate){const a=cs.definitions[this.name];this._evaluate=Array.isArray(a)?a[2]:a.overloads[this._overloadIndex][1]}return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,a){const u=r[0],f=cs.definitions[u];if(!f)return a.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,x=[];let S=null,T=-1;for(const[D,O]of v){if(Array.isArray(D)&&D.length!==r.length-1)continue;x.push(D),T++,S=new R0(a.registry,a.path,null,a.scope,void 0,a._scope,a.options);const z=[];let $=!1;for(let K=1;K<r.length;K++){const X=r[K],ie=Array.isArray(D)?D[K-1]:D.type,ae=S.parse(X,1+z.length,ie);if(!ae){$=!0;break}z.push(ae)}if(!$)if(Array.isArray(D)&&D.length!==z.length)S.error(`Expected ${D.length} arguments, but found ${z.length} instead.`);else{for(let K=0;K<z.length;K++){const X=Array.isArray(D)?D[K]:D.type,ie=z[K];S.concat(K+1).checkSubtype(X,ie.type)}if(0===S.errors.length)return new cs(u,g,O,z,T)}}if(1===x.length)a.errors.push(...S.errors);else{const D=(x.length?x:v.map(([z])=>z)).map(jd).join(" | "),O=[];for(let z=1;z<r.length;z++){const $=a.parse(r[z],1+O.length);if(!$)return null;O.push(Ko($.type))}a.error(`Expected arguments of type ${D}, but found (${O.join(", ")}) instead.`)}return null}static register(r,a){cs.definitions=a;for(const u in a)r[u]=cs}}function jd(o){return Array.isArray(o)?`(${o.map(Ko).join(", ")})`:`(${Ko(o.type)}...)`}var Or=cs;class Of{constructor(r,a,u){this.type=Df,this.locale=u,this.caseSensitive=r,this.diacriticSensitive=a}static parse(r,a){if(2!==r.length)return a.error("Expected one argument.");const u=r[1];if("object"!=typeof u||Array.isArray(u))return a.error("Collator options argument must be an object.");const f=a.parse(void 0!==u["case-sensitive"]&&u["case-sensitive"],1,ys);if(!f)return null;const g=a.parse(void 0!==u["diacritic-sensitive"]&&u["diacritic-sensitive"],1,ys);if(!g)return null;let v=null;return u.locale&&(v=a.parse(u.locale,1,Wr),!v)?null:new Of(f,g,v)}evaluate(r){return new Tr(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}var i_={exports:{}};i_.exports=function(){function o(u,f,g,v,x){for(;v>g;){if(v-g>600){var S=v-g+1,T=f-g+1,D=Math.log(S),O=.5*Math.exp(2*D/3),z=.5*Math.sqrt(D*O*(S-O)/S)*(T-S/2<0?-1:1);o(u,f,Math.max(g,Math.floor(f-T*O/S+z)),Math.min(v,Math.floor(f+(S-T)*O/S+z)),x)}var $=u[f],K=g,X=v;for(r(u,g,f),x(u[v],$)>0&&r(u,g,v);K<X;){for(r(u,K,X),K++,X--;x(u[K],$)<0;)K++;for(;x(u[X],$)>0;)X--}0===x(u[g],$)?r(u,g,X):r(u,++X,v),X<=f&&(g=X+1),f<=X&&(v=X-1)}}function r(u,f,g){var v=u[f];u[f]=u[g],u[g]=v}function a(u,f){return u<f?-1:u>f?1:0}return function(u,f,g,v,x){o(u,f,g||0,v||u.length-1,x||a)}}();var Ju=Ta(i_.exports);function kf(o){let r=0;for(let a,u,f=0,g=o.length,v=g-1;f<g;v=f++)a=o[f],u=o[v],r+=(u.x-a.x)*(a.y+u.y);return r}function Du(o,r){o[0]=Math.min(o[0],r[0]),o[1]=Math.min(o[1],r[1]),o[2]=Math.max(o[2],r[0]),o[3]=Math.max(o[3],r[1])}function ud(o,r){return!(o[0]<=r[0]||o[2]>=r[2]||o[1]<=r[1]||o[3]>=r[3])}function Lg(o,r,a){const u=o[0]-r[0],f=o[1]-r[1],g=o[0]-a[0],v=o[1]-a[1];return u*v-g*f==0&&u*g<=0&&f*v<=0}function vs(o,r,a=!1){let u=!1;for(let x=0,S=r.length;x<S;x++){const T=r[x];for(let D=0,O=T.length,z=O-1;D<O;z=D++){const $=T[z],K=T[D];if(Lg(o,$,K))return a;(g=$)[1]>(f=o)[1]!=(v=K)[1]>f[1]&&f[0]<(v[0]-g[0])*(f[1]-g[1])/(v[1]-g[1])+g[0]&&(u=!u)}}var f,g,v;return u}function yp(o,r,a,u){const f=u[0]-a[0],g=u[1]-a[1],v=(o[0]-a[0])*g-f*(o[1]-a[1]),x=(r[0]-a[0])*g-f*(r[1]-a[1]);return v>0&&x<0||v<0&&x>0}function Oh(o,r,a,u){return(f=[u[0]-a[0],u[1]-a[1]])[0]*(g=[r[0]-o[0],r[1]-o[1]])[1]-f[1]*g[0]!=0&&!(!yp(o,r,a,u)||!yp(a,u,o,r));var f,g}const Pa=8192;function IA(o,r){const a=(180+o[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,f=Math.pow(2,r.z);return[Math.round(a*f*Pa),Math.round(u*f*Pa)]}function D0(o,r){for(let a=0;a<r.length;a++)if(vs(o,r[a]))return!0;return!1}function Uo(o,r,a){for(const u of a)for(let f=0,g=u.length,v=g-1;f<g;v=f++)if(Oh(o,r,u[v],u[f]))return!0;return!1}function eh(o,r){for(let a=0;a<o.length;++a)if(!vs(o[a],r))return!1;for(let a=0;a<o.length-1;++a)if(Uo(o[a],o[a+1],r))return!1;return!0}function gv(o,r){for(let a=0;a<r.length;a++)if(eh(o,r[a]))return!0;return!1}function pi(o,r,a){const u=[];for(let f=0;f<o.length;f++){const g=[];for(let v=0;v<o[f].length;v++){const x=IA(o[f][v],a);Du(r,x),g.push(x)}u.push(g)}return u}function Gd(o,r,a){const u=[];for(let f=0;f<o.length;f++){const g=pi(o[f],r,a);u.push(g)}return u}function vp(o,r,a,u){if(o[0]<a[0]||o[0]>a[2]){const f=.5*u;let g=o[0]-a[0]>f?-u:a[0]-o[0]>f?u:0;0===g&&(g=o[0]-a[2]>f?-u:a[2]-o[0]>f?u:0),o[0]+=g}Du(r,o)}function Ug(o,r,a,u){const f=Math.pow(2,u.z)*Pa,g=[u.x*Pa,u.y*Pa],v=[];if(!o)return v;for(const x of o)for(const S of x){const T=[S.x+g[0],S.y+g[1]];vp(T,r,a,f),v.push(T)}return v}function bp(o,r,a,u){const f=Math.pow(2,u.z)*Pa,g=[u.x*Pa,u.y*Pa],v=[];if(!o)return v;for(const S of o){const T=[];for(const D of S){const O=[D.x+g[0],D.y+g[1]];Du(r,O),T.push(O)}v.push(T)}if(r[2]-r[0]<=f/2){(x=r)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const S of v)for(const T of S)vp(T,r,a,f)}var x;return v}class DA{constructor(r,a){this.type=ys,this.geojson=r,this.geometries=a}static parse(r,a){if(2!==r.length)return a.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Ff(r[1])){const u=r[1];if("FeatureCollection"===u.type)for(let f=0;f<u.features.length;++f){const g=u.features[f].geometry.type;if("Polygon"===g||"MultiPolygon"===g)return new DA(u,u.features[f].geometry)}else if("Feature"===u.type){const f=u.geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new DA(u,u.geometry)}else if("Polygon"===u.type||"MultiPolygon"===u.type)return new DA(u,u)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(null!=r.geometry()&&null!=r.canonicalID()){if("Point"===r.geometryType())return function(a,u){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(!v)return!1;if("Polygon"===u.type){const x=pi(u.coordinates,g,v),S=Ug(a.geometry(),f,g,v);if(!ud(f,g))return!1;for(const T of S)if(!vs(T,x))return!1}if("MultiPolygon"===u.type){const x=Gd(u.coordinates,g,v),S=Ug(a.geometry(),f,g,v);if(!ud(f,g))return!1;for(const T of S)if(!D0(T,x))return!1}return!0}(r,this.geometries);if("LineString"===r.geometryType())return function(a,u){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(!v)return!1;if("Polygon"===u.type){const x=pi(u.coordinates,g,v),S=bp(a.geometry(),f,g,v);if(!ud(f,g))return!1;for(const T of S)if(!eh(T,x))return!1}if("MultiPolygon"===u.type){const x=Gd(u.coordinates,g,v),S=bp(a.geometry(),f,g,v);if(!ud(f,g))return!1;for(const T of S)if(!gv(T,x))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var BA=DA,zg={exports:{}};zg.exports=function(){var o={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},r=1/298.257223563,a=r*(2-r),u=Math.PI/180,f=function(T,D){if(void 0===T)throw new Error("No latitude given.");if(D&&!o[D])throw new Error("Unknown unit "+D+". Use one of: "+Object.keys(o).join(", "));var O=6378.137*u*(D?o[D]:1),z=Math.cos(T*u),$=1/(1-a*(1-z*z)),K=Math.sqrt($);this.kx=O*K*z,this.ky=O*K*$*(1-a)},g={units:{configurable:!0}};function v(T,D){return T[0]===D[0]&&T[1]===D[1]}function x(T,D,O){var z=S(D[0]-T[0]);return[T[0]+z*O,T[1]+(D[1]-T[1])*O]}function S(T){for(;T<-180;)T+=360;for(;T>180;)T-=360;return T}return f.fromTile=function(T,D,O){var z=Math.PI*(1-2*(T+.5)/Math.pow(2,D)),$=Math.atan(.5*(Math.exp(z)-Math.exp(-z)))/u;return new f($,O)},g.units.get=function(){return o},f.prototype.distance=function(T,D){var O=S(T[0]-D[0])*this.kx,z=(T[1]-D[1])*this.ky;return Math.sqrt(O*O+z*z)},f.prototype.bearing=function(T,D){var O=S(D[0]-T[0])*this.kx;return Math.atan2(O,(D[1]-T[1])*this.ky)/u},f.prototype.destination=function(T,D,O){var z=O*u;return this.offset(T,Math.sin(z)*D,Math.cos(z)*D)},f.prototype.offset=function(T,D,O){return[T[0]+D/this.kx,T[1]+O/this.ky]},f.prototype.lineDistance=function(T){for(var D=0,O=0;O<T.length-1;O++)D+=this.distance(T[O],T[O+1]);return D},f.prototype.area=function(T){for(var D=0,O=0;O<T.length;O++)for(var z=T[O],$=0,K=z.length,X=K-1;$<K;X=$++)D+=S(z[$][0]-z[X][0])*(z[$][1]+z[X][1])*(O?-1:1);return Math.abs(D)/2*this.kx*this.ky},f.prototype.along=function(T,D){var O=0;if(D<=0)return T[0];for(var z=0;z<T.length-1;z++){var $=T[z],K=T[z+1],X=this.distance($,K);if((O+=X)>D)return x($,K,(D-(O-X))/X)}return T[T.length-1]},f.prototype.pointToSegmentDistance=function(T,D,O){var z=D[0],$=D[1],K=S(O[0]-z)*this.kx,X=(O[1]-$)*this.ky,ie=0;return 0===K&&0===X||((ie=(S(T[0]-z)*this.kx*K+(T[1]-$)*this.ky*X)/(K*K+X*X))>1?(z=O[0],$=O[1]):ie>0&&(z+=K/this.kx*ie,$+=X/this.ky*ie)),K=S(T[0]-z)*this.kx,X=(T[1]-$)*this.ky,Math.sqrt(K*K+X*X)},f.prototype.pointOnLine=function(T,D){for(var O,z,$,K,X=1/0,ie=0;ie<T.length-1;ie++){var ae=T[ie][0],be=T[ie][1],Ce=S(T[ie+1][0]-ae)*this.kx,Ee=(T[ie+1][1]-be)*this.ky,Le=0;0===Ce&&0===Ee||((Le=(S(D[0]-ae)*this.kx*Ce+(D[1]-be)*this.ky*Ee)/(Ce*Ce+Ee*Ee))>1?(ae=T[ie+1][0],be=T[ie+1][1]):Le>0&&(ae+=Ce/this.kx*Le,be+=Ee/this.ky*Le));var Oe=(Ce=S(D[0]-ae)*this.kx)*Ce+(Ee=(D[1]-be)*this.ky)*Ee;Oe<X&&(X=Oe,O=ae,z=be,$=ie,K=Le)}return{point:[O,z],index:$,t:Math.max(0,Math.min(1,K))}},f.prototype.lineSlice=function(T,D,O){var z=this.pointOnLine(O,T),$=this.pointOnLine(O,D);if(z.index>$.index||z.index===$.index&&z.t>$.t){var K=z;z=$,$=K}var X=[z.point],ie=z.index+1,ae=$.index;!v(O[ie],X[0])&&ie<=ae&&X.push(O[ie]);for(var be=ie+1;be<=ae;be++)X.push(O[be]);return v(O[ae],$.point)||X.push($.point),X},f.prototype.lineSliceAlong=function(T,D,O){for(var z=0,$=[],K=0;K<O.length-1;K++){var X=O[K],ie=O[K+1],ae=this.distance(X,ie);if((z+=ae)>T&&0===$.length&&$.push(x(X,ie,(T-(z-ae))/ae)),z>=D)return $.push(x(X,ie,(D-(z-ae))/ae)),$;z>T&&$.push(ie)}return $},f.prototype.bufferPoint=function(T,D){var O=D/this.ky,z=D/this.kx;return[T[0]-z,T[1]-O,T[0]+z,T[1]+O]},f.prototype.bufferBBox=function(T,D){var O=D/this.ky,z=D/this.kx;return[T[0]-z,T[1]-O,T[2]+z,T[3]+O]},f.prototype.insideBBox=function(T,D){return S(T[0]-D[0])>=0&&S(T[0]-D[2])<=0&&T[1]>=D[1]&&T[1]<=D[3]},Object.defineProperties(f,g),f}();var Pf=Ta(zg.exports),B0={exports:{}};B0.exports=function(){var o=function(a,u){if(void 0===a&&(a=[]),void 0===u&&(u=r),this.data=a,this.length=this.data.length,this.compare=u,this.length>0)for(var f=(this.length>>1)-1;f>=0;f--)this._down(f)};function r(a,u){return a<u?-1:a>u?1:0}return o.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},o.prototype.pop=function(){if(0!==this.length){var a=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),a}},o.prototype.peek=function(){return this.data[0]},o.prototype._up=function(a){for(var u=this.data,f=this.compare,g=u[a];a>0;){var v=a-1>>1,x=u[v];if(f(g,x)>=0)break;u[a]=x,a=v}u[a]=g},o.prototype._down=function(a){for(var u=this.data,f=this.compare,g=this.length>>1,v=u[a];a<g;){var x=1+(a<<1),S=u[x],T=x+1;if(T<this.length&&f(u[T],S)<0&&(x=T,S=u[T]),f(S,v)>=0)break;u[a]=S,a=x}u[a]=v},o}();var ou=Ta(B0.exports),Jn=8192;function hd(o,r){return r.dist-o.dist}const dd=100,au=50;function Co(o){const r=[1/0,1/0,-1/0,-1/0];if(r.length!==o.length)return!1;for(let a=0;a<r.length;a++)if(r[a]!==o[a])return!1;return!0}function $d(o){return o[1]-o[0]+1}function lu(o,r){const a=o[1]>=o[0]&&o[1]<r;return a||console.warn("Distance Expression: Index is out of range"),a}function wp(o,r){if(o[0]>o[1])return[null,null];const a=$d(o);if(r){if(2===a)return[o,null];const u=Math.floor(a/2);return[[o[0],o[0]+u],[o[0]+u,o[1]]]}{if(1===a)return[o,null];const u=Math.floor(a/2)-1;return[[o[0],o[0]+u],[o[0]+u+1,o[1]]]}}function Vl(o,r){const a=[1/0,1/0,-1/0,-1/0];if(!lu(r,o.length))return a;for(let u=r[0];u<=r[1];++u)Du(a,o[u]);return a}function cu(o){const r=[1/0,1/0,-1/0,-1/0];for(let a=0;a<o.length;++a)for(let u=0;u<o[a].length;++u)Du(r,o[a][u]);return r}function Nc(o,r,a){if(Co(o)||Co(r))return NaN;let u=0,f=0;return o[2]<r[0]&&(u=r[0]-o[2]),o[0]>r[2]&&(u=o[0]-r[2]),o[1]>r[3]&&(f=o[1]-r[3]),o[3]<r[1]&&(f=r[1]-o[3]),a.distance([0,0],[u,f])}function kh(o){return 360*o-180}function Xt(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function qd(o,r){const a=Math.pow(2,r.z),u=(o.y/Jn+r.y)/a;return[kh((o.x/Jn+r.x)/a),Xt(u)]}function In(o,r){const a=[];for(let u=0;u<o.length;++u)a.push(qd(o[u],r));return a}function Nf(o,r,a){const u=a.pointOnLine(r,o).point;return a.distance(o,u)}function th(o,r,a,u,f){const g=a.slice(u[0],u[1]+1);let v=1/0;for(let x=r[0];x<=r[1];++x)if(0===(v=Math.min(v,Nf(o[x],g,f))))return 0;return v}function nh(o,r,a,u,f){const g=Math.min(f.pointToSegmentDistance(o,a,u),f.pointToSegmentDistance(r,a,u)),v=Math.min(f.pointToSegmentDistance(a,o,r),f.pointToSegmentDistance(u,o,r));return Math.min(g,v)}function ea(o,r,a,u,f){if(!lu(r,o.length)||!lu(u,a.length))return NaN;let g=1/0;for(let v=r[0];v<r[1];++v)for(let x=u[0];x<u[1];++x){if(Oh(o[v],o[v+1],a[x],a[x+1]))return 0;g=Math.min(g,nh(o[v],o[v+1],a[x],a[x+1],f))}return g}function M0(o,r,a,u,f){if(!lu(r,o.length)||!lu(u,a.length))return NaN;let g=1/0;for(let v=r[0];v<=r[1];++v)for(let x=u[0];x<=u[1];++x)if(0===(g=Math.min(g,f.distance(o[v],a[x]))))return g;return g}function F0(o,r,a){if(vs(o,r,!0))return 0;let u=1/0;for(const f of r){const g=f.length;if(g<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(f[0]!==f[g-1]&&0===(u=Math.min(u,a.pointToSegmentDistance(o,f[g-1],f[0])))||0===(u=Math.min(u,Nf(o,f,a))))return u}return u}function ih(o,r,a,u){if(!lu(r,o.length))return NaN;for(let g=r[0];g<=r[1];++g)if(vs(o[g],a,!0))return 0;let f=1/0;for(let g=r[0];g<r[1];++g)for(const v of a)for(let x=0,S=v.length,T=S-1;x<S;T=x++){if(Oh(o[g],o[g+1],v[T],v[x]))return 0;f=Math.min(f,nh(o[g],o[g+1],v[T],v[x],u))}return f}function fd(o,r){for(const a of o)for(let u=0;u<=a.length-1;++u)if(vs(a[u],r,!0))return!0;return!1}function Ac(o,r,a,u=1/0){const f=cu(o),g=cu(r);if(u!==1/0&&Nc(f,g,a)>=u)return u;if(ud(f,g)){if(fd(o,r))return 0}else if(fd(r,o))return 0;let v=u;for(const x of o)for(let S=0,T=x.length,D=T-1;S<T;D=S++)for(const O of r)for(let z=0,$=O.length,K=$-1;z<$;K=z++){if(Oh(x[D],x[S],O[K],O[z]))return 0;v=Math.min(v,nh(x[D],x[S],O[K],O[z],a))}return v}function Lc(o,r,a,u,f,g,v){if(null===g||null===v)return;const x=Nc(Vl(u,g),Vl(f,v),a);x<r&&o.push({dist:x,range1:g,range2:v})}function Ys(o,r,a,u,f=1/0){let g=Math.min(u.distance(o[0],a[0][0]),f);if(0===g)return g;const v=new ou([{dist:0,range1:[0,o.length-1],range2:[0,0]}],hd),x=r?au:dd,S=cu(a);for(;v.length;){const T=v.pop();if(T.dist>=g)continue;const D=T.range1;if($d(D)<=x){if(!lu(D,o.length))return NaN;if(r){const O=ih(o,D,a,u);if(0===(g=Math.min(g,O)))return g}else for(let O=D[0];O<=D[1];++O){const z=F0(o[O],a,u);if(0===(g=Math.min(g,z)))return g}}else{const O=wp(D,r);if(null!==O[0]){const z=Nc(Vl(o,O[0]),S,u);z<g&&v.push({dist:z,range1:O[0],range2:[0,0]})}if(null!==O[1]){const z=Nc(Vl(o,O[1]),S,u);z<g&&v.push({dist:z,range1:O[1],range2:[0,0]})}}}return g}function ic(o,r,a,u,f,g=1/0){let v=Math.min(g,f.distance(o[0],a[0]));if(0===v)return v;const x=new ou([{dist:0,range1:[0,o.length-1],range2:[0,a.length-1]}],hd),S=r?au:dd,T=u?au:dd;for(;x.length;){const D=x.pop();if(D.dist>=v)continue;const O=D.range1,z=D.range2;if($d(O)<=S&&$d(z)<=T){if(!lu(O,o.length)||!lu(z,a.length))return NaN;if(r&&u?v=Math.min(v,ea(o,O,a,z,f)):r||u?r&&!u?v=Math.min(v,th(a,z,o,O,f)):!r&&u&&(v=Math.min(v,th(o,O,a,z,f))):v=Math.min(v,M0(o,O,a,z,f)),0===v)return v}else{const $=wp(O,r),K=wp(z,u);Lc(x,v,f,o,a,$[0],K[0]),Lc(x,v,f,o,a,$[0],K[1]),Lc(x,v,f,o,a,$[1],K[0]),Lc(x,v,f,o,a,$[1],K[1])}}return v}function Bu(o,r,a,u,f=1/0){let g=f;const v=Vl(o,[0,o.length-1]);for(const x of a)if(!(g!==1/0&&Nc(v,Vl(x,[0,x.length-1]),u)>=g)&&(g=Math.min(g,ic(o,r,x,!0,u,g)),0===g))return g;return g}function uu(o,r,a,u,f=1/0){let g=f;const v=Vl(o,[0,o.length-1]);for(const x of a){if(g!==1/0&&Nc(v,cu(x),u)>=g)continue;const S=Ys(o,r,x,u,g);if(isNaN(S))return S;if(0===(g=Math.min(g,S)))return g}return g}function Na(o){return"Point"===o||"MultiPoint"===o||"LineString"===o||"MultiLineString"===o||"Polygon"===o||"MultiPolygon"===o}class Ia{constructor(r,a){this.type=Un,this.geojson=r,this.geometries=a}static parse(r,a){if(2!==r.length)return a.error(`'distance' expression requires either one argument, but found ' ${r.length-1} instead.`);if(Ff(r[1])){const u=r[1];if("FeatureCollection"===u.type){for(let f=0;f<u.features.length;++f)if(Na(u.features[f].geometry.type))return new Ia(u,u.features[f].geometry)}else if("Feature"===u.type){if(Na(u.geometry.type))return new Ia(u,u.geometry)}else if(Na(u.type))return new Ia(u,u)}return a.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(r){const a=r.geometry(),u=r.canonicalID();if(null!=a&&null!=u){if("Point"===r.geometryType())return function(f,g,v){const x=[];for(const T of f)for(const D of T)x.push(qd(D,g));const S=new Pf(x[0][1],"meters");return"Point"===v.type||"MultiPoint"===v.type||"LineString"===v.type?ic(x,!1,"Point"===v.type?[v.coordinates]:v.coordinates,"LineString"===v.type,S):"MultiLineString"===v.type?Bu(x,!1,v.coordinates,S):"Polygon"===v.type||"MultiPolygon"===v.type?uu(x,!1,"Polygon"===v.type?[v.coordinates]:v.coordinates,S):null}(a,u,this.geometries);if("LineString"===r.geometryType())return function(f,g,v){const x=[];for(const T of f){const D=[];for(const O of T)D.push(qd(O,g));x.push(D)}const S=new Pf(x[0][0][1],"meters");if("Point"===v.type||"MultiPoint"===v.type||"LineString"===v.type)return Bu("Point"===v.type?[v.coordinates]:v.coordinates,"LineString"===v.type,x,S);if("MultiLineString"===v.type){let T=1/0;for(let D=0;D<v.coordinates.length;D++){const O=Bu(v.coordinates[D],!0,x,S,T);if(isNaN(O))return O;if(0===(T=Math.min(T,O)))return T}return T}if("Polygon"===v.type||"MultiPolygon"===v.type){let T=1/0;for(let D=0;D<x.length;D++){const O=uu(x[D],!0,"Polygon"===v.type?[v.coordinates]:v.coordinates,S,T);if(isNaN(O))return O;if(0===(T=Math.min(T,O)))return T}return T}return null}(a,u,this.geometries);if("Polygon"===r.geometryType())return function(f,g,v){const x=[];for(const T of function(D,O){const z=D.length;if(z<=1)return[D];const $=[];let K,X;for(let ie=0;ie<z;ie++){const ae=kf(D[ie]);0!==ae&&(D[ie].area=Math.abs(ae),void 0===X&&(X=ae<0),X===ae<0?(K&&$.push(K),K=[D[ie]]):K.push(D[ie]))}return K&&$.push(K),$}(f)){const D=[];for(let O=0;O<T.length;++O)D.push(In(T[O],g));x.push(D)}const S=new Pf(x[0][0][0][1],"meters");if("Point"===v.type||"MultiPoint"===v.type||"LineString"===v.type)return uu("Point"===v.type?[v.coordinates]:v.coordinates,"LineString"===v.type,x,S);if("MultiLineString"===v.type){let T=1/0;for(let D=0;D<v.coordinates.length;D++){const O=uu(v.coordinates[D],!0,x,S,T);if(isNaN(O))return O;if(0===(T=Math.min(T,O)))return T}return T}return"Polygon"===v.type||"MultiPolygon"===v.type?function(T,D,O){let z=1/0;for(const $ of T)for(const K of D){const X=Ac($,K,O,z);if(isNaN(X))return X;if(0===(z=Math.min(z,X)))return z}return z}("Polygon"===v.type?[v.coordinates]:v.coordinates,x,S):null}(a,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var Ad=Ia;function Lf(o,r){switch(o){case"string":return Iu(r);case"number":return+r;case"boolean":return!!r;case"color":return so.parse(r);case"formatted":return xo.fromString(Iu(r));case"resolvedImage":return Ri.fromString(Iu(r))}return r}function MA(o,r,a,u){return void 0!==u&&(o=u*Math.round(o/u)),void 0!==r&&o<r&&(o=r),void 0!==a&&o>a&&(o=a),o}class Kd{constructor(r,a,u){this.type=r,this.key=a,this.scope=u}static parse(r,a){let u=a.expectedType;if(null==u&&(u=Qr),r.length<2||r.length>3)return a.error("Invalid number of arguments for 'config' expression.");const f=a.parse(r[1],1);if(!(f instanceof Vd))return a.error("Key name of 'config' expression must be a string literal.");if(r.length>=3){const g=a.parse(r[2],2);return g instanceof Vd?new Kd(u,Iu(f.value),Iu(g.value)):a.error("Scope of 'config' expression must be a string literal.")}return new Kd(u,Iu(f.value))}evaluate(r){const a=[this.key,this.scope,r.scope].filter(Boolean).join("\x1f"),u=r.getConfig(a);if(!u)return null;const{type:f,value:g,values:v,minValue:x,maxValue:S,stepValue:T}=u,D=u.default.evaluate(r);let O=D;if(g){const z=r.scope;r.scope=(z||"").split("\x1f").slice(1).join("\x1f"),O=g.evaluate(r),r.scope=z}return f&&(O=Lf(f,O)),void 0===O||void 0===x&&void 0===S&&void 0===T||("number"==typeof O?O=MA(O,x,S,T):Array.isArray(O)&&(O=O.map(z=>"number"==typeof z?MA(z,x,S,T):z))),void 0!==g&&void 0!==O&&v&&!v.includes(O)&&(O=D,f&&(O=Lf(f,O))),(f&&f!==this.type||void 0!==O&&Oo(O)!==this.type)&&(O=Lf(this.type.kind,O)),O}eachChild(){}outputDefined(){return!1}serialize(){const r=["config",this.key];return this.scope&&r.concat(this.key),r}}var Uf=Kd;function rh(o){if(o instanceof Or&&("get"===o.name&&1===o.args.length||"feature-state"===o.name||"has"===o.name&&1===o.args.length||"properties"===o.name||"geometry-type"===o.name||"id"===o.name||/^filter-/.test(o.name))||o instanceof BA||o instanceof Ad)return!1;let r=!0;return o.eachChild(a=>{r&&!rh(a)&&(r=!1)}),r}function Hl(o){if(o instanceof Or&&"feature-state"===o.name)return!1;let r=!0;return o.eachChild(a=>{r&&!Hl(a)&&(r=!1)}),r}function FA(o){if(o instanceof Uf)return!1;let r=!0;return o.eachChild(a=>{r&&!FA(a)&&(r=!1)}),r}function ul(o,r){if(o instanceof Or&&r.indexOf(o.name)>=0)return!1;let a=!0;return o.eachChild(u=>{a&&!ul(u,r)&&(a=!1)}),a}class sh{constructor(r,a){this.type=a.type,this.name=r,this.boundExpression=a}static parse(r,a){if(2!==r.length||"string"!=typeof r[1])return a.error("'var' expression requires exactly one string literal argument.");const u=r[1];return a.scope.has(u)?new sh(u,a.scope.get(u)):a.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Ql=sh;class r_{constructor(r,a=[],u,f=new Ro,g=[],v,x){this.registry=r,this.path=a,this.key=a.map(S=>`[${S}]`).join(""),this.scope=f,this.errors=g,this.expectedType=u,this._scope=v,this.options=x}parse(r,a,u,f,g={}){return a||u?this.concat(a,u,f)._parse(r,g):this._parse(r,g)}_parse(r,a){function u(f,g,v){return"assert"===v?new Fh(g,[f]):"coerce"===v?new Qd(g,[f]):f}if(null!==r&&"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r||(r=["literal",r]),Array.isArray(r)){if(0===r.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f="string"==typeof r[0]?this.registry[r[0]]:void 0;if(f){let g=f.parse(r,this);if(!g)return null;if(this.expectedType){const v=this.expectedType,x=g.type;if("string"!==v.kind&&"number"!==v.kind&&"boolean"!==v.kind&&"object"!==v.kind&&"array"!==v.kind||"value"!==x.kind)if("color"!==v.kind&&"formatted"!==v.kind&&"resolvedImage"!==v.kind||"value"!==x.kind&&"string"!==x.kind){if(this.checkSubtype(v,x))return null}else g=u(g,v,a.typeAnnotation||"coerce");else g=u(g,v,a.typeAnnotation||"assert")}if(!(g instanceof Vd)&&"resolvedImage"!==g.type.kind&&va(g)){const v=new pv(this._scope,this.options);try{g=new Vd(g.type,g.evaluate(v))}catch(x){return this.error(x.message),null}}return g}return Qd.parse(["to-array",r],this)}return this.error(void 0===r?"'undefined' value invalid. Use null instead.":"object"==typeof r?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,a,u){const f="number"==typeof r?this.path.concat(r):this.path,g=u?this.scope.concat(u):this.scope;return new r_(this.registry,f,a||null,g,this.errors,this._scope,this.options)}error(r,...a){const u=`${this.key}${a.map(f=>`[${f}]`).join("")}`;this.errors.push(new Tl(u,r))}checkSubtype(r,a){const u=Ts(r,a);return u&&this.error(u),u}}var R0=r_;function va(o){if(o instanceof Ql)return va(o.boundExpression);if(o instanceof Or&&"error"===o.name||o instanceof Of||o instanceof BA||o instanceof Ad||o instanceof Uf)return!1;const r=o instanceof Qd||o instanceof Fh;let a=!0;return o.eachChild(u=>{a=r?a&&va(u):a&&u instanceof Vd}),!!a&&rh(o)&&ul(o,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Wd(o,r){const a=o.length-1;let u,f,g=0,v=a,x=0;for(;g<=v;)if(x=Math.floor((g+v)/2),u=o[x],f=o[x+1],u<=r){if(x===a||r<f)return x;g=x+1}else{if(!(u>r))throw new ka("Input is not a number.");v=x-1}return 0}class xp{constructor(r,a,u){this.type=r,this.input=a,this.labels=[],this.outputs=[];for(const[f,g]of u)this.labels.push(f),this.outputs.push(g)}static parse(r,a){if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");const u=a.parse(r[1],1,Un);if(!u)return null;const f=[];let g=null;a.expectedType&&"value"!==a.expectedType.kind&&(g=a.expectedType);for(let v=1;v<r.length;v+=2){const x=1===v?-1/0:r[v],S=r[v+1],T=v,D=v+1;if("number"!=typeof x)return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(f.length&&f[f.length-1][0]>=x)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const O=a.parse(S,D,g);if(!O)return null;g=g||O.type,f.push([x,O])}return new xp(g,u,f)}evaluate(r){const a=this.labels,u=this.outputs;if(1===a.length)return u[0].evaluate(r);const f=this.input.evaluate(r);if(f<=a[0])return u[0].evaluate(r);const g=a.length;return f>=a[g-1]?u[g-1].evaluate(r):u[Wd(a,f)].evaluate(r)}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&r.push(this.labels[a]),r.push(this.outputs[a].serialize());return r}}var Cp=xp;const s_=4/29,Xd=6/29,Vg=3*Xd*Xd,o_=Xd*Xd*Xd,O0=Math.PI/180,Mr=180/Math.PI;function RA(o){return o>o_?Math.pow(o,1/3):o/Vg+s_}function Sp(o){return o>Xd?o*o*o:Vg*(o-s_)}function Hg(o){return 255*(o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055)}function ps(o){return(o/=255)<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function a_(o){const r=ps(o.r),a=ps(o.g),u=ps(o.b),f=RA((.4124564*r+.3575761*a+.1804375*u)/.95047),g=RA((.2126729*r+.7151522*a+.072175*u)/1);return{l:116*g-16,a:500*(f-g),b:200*(g-RA((.0193339*r+.119192*a+.9503041*u)/1.08883)),alpha:o.a}}function Qg(o){let r=(o.l+16)/116,a=isNaN(o.a)?r:r+o.a/500,u=isNaN(o.b)?r:r-o.b/200;return r=1*Sp(r),a=.95047*Sp(a),u=1.08883*Sp(u),new so(Hg(3.2404542*a-1.5371385*r-.4985314*u),Hg(-.969266*a+1.8760108*r+.041556*u),Hg(.0556434*a-.2040259*r+1.0572252*u),o.alpha)}function Xn(o,r,a){const u=r-o;return o+a*(u>180||u<-180?u-360*Math.round(u/360):u)}const hl={forward:a_,reverse:Qg,interpolate:function(o,r,a){return{l:Fi(o.l,r.l,a),a:Fi(o.a,r.a,a),b:Fi(o.b,r.b,a),alpha:Fi(o.alpha,r.alpha,a)}}},Is={forward:function(o){const{l:r,a,b:u}=a_(o),f=Math.atan2(u,a)*Mr;return{h:f<0?f+360:f,c:Math.sqrt(a*a+u*u),l:r,alpha:o.a}},reverse:function(o){const r=o.h*O0,a=o.c;return Qg({l:o.l,a:Math.cos(r)*a,b:Math.sin(r)*a,alpha:o.alpha})},interpolate:function(o,r,a){return{h:Xn(o.h,r.h,a),c:Fi(o.c,r.c,a),l:Fi(o.l,r.l,a),alpha:Fi(o.alpha,r.alpha,a)}}};var dl=Object.freeze({__proto__:null,hcl:Is,lab:hl});class fl{constructor(r,a,u,f,g){this.type=r,this.operator=a,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(const[v,x]of g)this.labels.push(v),this.outputs.push(x)}static interpolationFactor(r,a,u,f){let g=0;if("exponential"===r.name)g=oh(a,r.base,u,f);else if("linear"===r.name)g=oh(a,1,u,f);else if("cubic-bezier"===r.name){const v=r.controlPoints;g=new Oc(v[0],v[1],v[2],v[3]).solve(oh(a,1,u,f))}return g}static parse(r,a){let[u,f,g,...v]=r;if(!Array.isArray(f)||0===f.length)return a.error("Expected an interpolation type expression.",1);if("linear"===f[0])f={name:"linear"};else if("exponential"===f[0]){const T=f[1];if("number"!=typeof T)return a.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:T}}else{if("cubic-bezier"!==f[0])return a.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const T=f.slice(1);if(4!==T.length||T.some(D=>"number"!=typeof D||D<0||D>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:T}}}if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(g=a.parse(g,2,Un),!g)return null;const x=[];let S=null;"interpolate-hcl"===u||"interpolate-lab"===u?S=Nr:a.expectedType&&"value"!==a.expectedType.kind&&(S=a.expectedType);for(let T=0;T<v.length;T+=2){const D=v[T],O=v[T+1],z=T+3,$=T+4;if("number"!=typeof D)return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(x.length&&x[x.length-1][0]>=D)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);const K=a.parse(O,$,S);if(!K)return null;S=S||K.type,x.push([D,K])}return"number"===S.kind||"color"===S.kind||"array"===S.kind&&"number"===S.itemType.kind&&"number"==typeof S.N?new fl(S,u,f,g,x):a.error(`Type ${Ko(S)} is not interpolatable.`)}evaluate(r){const a=this.labels,u=this.outputs;if(1===a.length)return u[0].evaluate(r);const f=this.input.evaluate(r);if(f<=a[0])return u[0].evaluate(r);const g=a.length;if(f>=a[g-1])return u[g-1].evaluate(r);const v=Wd(a,f),x=fl.interpolationFactor(this.interpolation,f,a[v],a[v+1]),S=u[v].evaluate(r),T=u[v+1].evaluate(r);return"interpolate"===this.operator?gp[this.type.kind.toLowerCase()](S,T,x):"interpolate-hcl"===this.operator?Is.reverse(Is.interpolate(Is.forward(S),Is.forward(T),x)):hl.reverse(hl.interpolate(hl.forward(S),hl.forward(T),x))}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;r="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,r,this.input.serialize()];for(let u=0;u<this.labels.length;u++)a.push(this.labels[u],this.outputs[u].serialize());return a}}function oh(o,r,a,u){const f=u-a,g=o-a;return 0===f?0:1===r?g/f:(Math.pow(r,g)-1)/(Math.pow(r,f)-1)}var ra=fl;class zf{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expectected at least one argument.");let u=null;const f=a.expectedType;f&&"value"!==f.kind&&(u=f);const g=[];for(const x of r.slice(1)){const S=a.parse(x,1+g.length,u,void 0,{typeAnnotation:"omit"});if(!S)return null;u=u||S.type,g.push(S)}const v=f&&g.some(x=>Ts(f,x.type));return new zf(v?Qr:u,g)}evaluate(r){let a,u=null,f=0;for(const g of this.args){if(f++,u=g.evaluate(r),u&&u instanceof Ri&&!u.available&&(a||(a=u),u=null,f===this.args.length))return a;if(null!==u)break}return u}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(a=>{r.push(a.serialize())}),r}}var Yd=zf;class Vf{constructor(r,a){this.type=a.type,this.bindings=[].concat(r),this.result=a}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const a of this.bindings)r(a[1]);r(this.result)}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const u=[];for(let g=1;g<r.length-1;g+=2){const v=r[g];if("string"!=typeof v)return a.error(`Expected string, but found ${typeof v} instead.`,g);if(/[^a-zA-Z0-9_]/.test(v))return a.error("Variable names must contain only alphanumeric characters or '_'.",g);const x=a.parse(r[g+1],g+1);if(!x)return null;u.push([v,x])}const f=a.parse(r[r.length-1],r.length-1,a.expectedType,u);return f?new Vf(u,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[a,u]of this.bindings)r.push(a,u.serialize());return r.push(this.result.serialize()),r}}var l_=Vf;class ah{constructor(r,a,u){this.type=r,this.index=a,this.input=u}static parse(r,a){if(3!==r.length)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=a.parse(r[1],1,Un),f=a.parse(r[2],2,ln(a.expectedType||Qr));return u&&f?new ah(f.type.itemType,u,f):null}evaluate(r){const a=this.index.evaluate(r),u=this.input.evaluate(r);if(a<0)throw new ka(`Array index out of bounds: ${a} < 0.`);if(a>=u.length)throw new ka(`Array index out of bounds: ${a} > ${u.length-1}.`);if(a!==Math.floor(a))throw new ka(`Array index must be an integer, but found ${a} instead.`);return u[a]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Zi=ah;class Oi{constructor(r,a){this.type=ys,this.needle=r,this.haystack=a}static parse(r,a){if(3!==r.length)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=a.parse(r[1],1,Qr),f=a.parse(r[2],2,Qr);return u&&f?or(u.type,[ys,Wr,Un,cd,Qr])?new Oi(u,f):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ko(u.type)} instead`):null}evaluate(r){const a=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(null==u)return!1;if(!Mf(a,["boolean","string","number","null"]))throw new ka(`Expected first argument to be of type boolean, string, number or null, but found ${Ko(Oo(a))} instead.`);if(!Mf(u,["string","array"]))throw new ka(`Expected second argument to be of type array or string, but found ${Ko(Oo(u))} instead.`);return u.indexOf(a)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var gs=Oi;class Wo{constructor(r,a,u){this.type=Un,this.needle=r,this.haystack=a,this.fromIndex=u}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const u=a.parse(r[1],1,Qr),f=a.parse(r[2],2,Qr);if(!u||!f)return null;if(!or(u.type,[ys,Wr,Un,cd,Qr]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ko(u.type)} instead`);if(4===r.length){const g=a.parse(r[3],3,Un);return g?new Wo(u,f,g):null}return new Wo(u,f)}evaluate(r){const a=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(!Mf(a,["boolean","string","number","null"]))throw new ka(`Expected first argument to be of type boolean, string, number or null, but found ${Ko(Oo(a))} instead.`);if(!Mf(u,["string","array"]))throw new ka(`Expected second argument to be of type array or string, but found ${Ko(Oo(u))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(r);return u.indexOf(a,f)}return u.indexOf(a)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var pc=Wo;class Hf{constructor(r,a,u,f,g,v){this.inputType=r,this.type=a,this.input=u,this.cases=f,this.outputs=g,this.otherwise=v}static parse(r,a){if(r.length<5)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return a.error("Expected an even number of arguments.");let u,f;a.expectedType&&"value"!==a.expectedType.kind&&(f=a.expectedType);const g={},v=[];for(let T=2;T<r.length-1;T+=2){let D=r[T];const O=r[T+1];Array.isArray(D)||(D=[D]);const z=a.concat(T);if(0===D.length)return z.error("Expected at least one branch label.");for(const K of D){if("number"!=typeof K&&"string"!=typeof K)return z.error("Branch labels must be numbers or strings.");if("number"==typeof K&&Math.abs(K)>Number.MAX_SAFE_INTEGER)return z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof K&&Math.floor(K)!==K)return z.error("Numeric branch labels must be integer values.");if(u){if(z.checkSubtype(u,Oo(K)))return null}else u=Oo(K);if(void 0!==g[String(K)])return z.error("Branch labels must be unique.");g[String(K)]=v.length}const $=a.parse(O,T,f);if(!$)return null;f=f||$.type,v.push($)}const x=a.parse(r[1],1,Qr);if(!x)return null;const S=a.parse(r[r.length-1],r.length-1,f);return S?"value"!==x.type.kind&&a.concat(1).checkSubtype(u,x.type)?null:new Hf(u,f,x,g,v,S):null}evaluate(r){const a=this.input.evaluate(r);return(Oo(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),u=[],f={};for(const v of a){const x=f[this.cases[v]];void 0===x?(f[this.cases[v]]=u.length,u.push([this.cases[v],[v]])):u[x][1].push(v)}const g=v=>"number"===this.inputType.kind?Number(v):v;for(const[v,x]of u)r.push(1===x.length?g(x[0]):x.map(g)),r.push(this.outputs[v].serialize());return r.push(this.otherwise.serialize()),r}}var jl=Hf;class pd{constructor(r,a,u){this.type=r,this.branches=a,this.otherwise=u}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return a.error("Expected an odd number of arguments.");let u;a.expectedType&&"value"!==a.expectedType.kind&&(u=a.expectedType);const f=[];for(let v=1;v<r.length-1;v+=2){const x=a.parse(r[v],v,ys);if(!x)return null;const S=a.parse(r[v+1],v+1,u);if(!S)return null;f.push([x,S]),u=u||S.type}const g=a.parse(r[r.length-1],r.length-1,u);return g?new pd(u,f,g):null}evaluate(r){for(const[a,u]of this.branches)if(a.evaluate(r))return u.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[a,u]of this.branches)r(a),r(u);r(this.otherwise)}outputDefined(){return this.branches.every(([r,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(a=>{r.push(a.serialize())}),r}}var Da=pd;class gc{constructor(r,a,u,f){this.type=r,this.input=a,this.beginIndex=u,this.endIndex=f}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const u=a.parse(r[1],1,Qr),f=a.parse(r[2],2,Un);if(!u||!f)return null;if(!or(u.type,[ln(Qr),Wr,Qr]))return a.error(`Expected first argument to be of type array or string, but found ${Ko(u.type)} instead`);if(4===r.length){const g=a.parse(r[3],3,Un);return g?new gc(u.type,u,f,g):null}return new gc(u.type,u,f)}evaluate(r){const a=this.input.evaluate(r),u=this.beginIndex.evaluate(r);if(!Mf(a,["string","array"]))throw new ka(`Expected first argument to be of type array or string, but found ${Ko(Oo(a))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(r);return a.slice(u,f)}return a.slice(u)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var lh=gc;function Zr(o,r){return"=="===o||"!="===o?"boolean"===r.kind||"string"===r.kind||"number"===r.kind||"null"===r.kind||"value"===r.kind:"string"===r.kind||"number"===r.kind||"value"===r.kind}function Qf(o,r,a,u){return 0===u.compare(r,a)}function jf(o,r,a){const u="=="!==o&&"!="!==o;return class jj{constructor(g,v,x){this.type=ys,this.lhs=g,this.rhs=v,this.collator=x,this.hasUntypedArgument="value"===g.type.kind||"value"===v.type.kind}static parse(g,v){if(3!==g.length&&4!==g.length)return v.error("Expected two or three arguments.");const x=g[0];let S=v.parse(g[1],1,Qr);if(!S)return null;if(!Zr(x,S.type))return v.concat(1).error(`"${x}" comparisons are not supported for type '${Ko(S.type)}'.`);let T=v.parse(g[2],2,Qr);if(!T)return null;if(!Zr(x,T.type))return v.concat(2).error(`"${x}" comparisons are not supported for type '${Ko(T.type)}'.`);if(S.type.kind!==T.type.kind&&"value"!==S.type.kind&&"value"!==T.type.kind)return v.error(`Cannot compare types '${Ko(S.type)}' and '${Ko(T.type)}'.`);u&&("value"===S.type.kind&&"value"!==T.type.kind?S=new Fh(T.type,[S]):"value"!==S.type.kind&&"value"===T.type.kind&&(T=new Fh(S.type,[T])));let D=null;if(4===g.length){if("string"!==S.type.kind&&"string"!==T.type.kind&&"value"!==S.type.kind&&"value"!==T.type.kind)return v.error("Cannot use collator to compare non-string types.");if(D=v.parse(g[3],3,Df),!D)return null}return new jj(S,T,D)}evaluate(g){const v=this.lhs.evaluate(g),x=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){const S=Oo(v),T=Oo(x);if(S.kind!==T.kind||"string"!==S.kind&&"number"!==S.kind)throw new ka(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${S.kind}, ${T.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const S=Oo(v),T=Oo(x);if("string"!==S.kind||"string"!==T.kind)return r(g,v,x)}return this.collator?a(g,v,x,this.collator.evaluate(g)):r(g,v,x)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[o];return this.eachChild(v=>{g.push(v.serialize())}),g}}}const ch=jf("==",function(o,r,a){return r===a},Qf),ba=jf("!=",function(o,r,a){return r!==a},function(o,r,a,u){return!Qf(0,r,a,u)}),Tp=jf("<",function(o,r,a){return r<a},function(o,r,a,u){return u.compare(r,a)<0}),OA=jf(">",function(o,r,a){return r>a},function(o,r,a,u){return u.compare(r,a)>0}),uh=jf("<=",function(o,r,a){return r<=a},function(o,r,a,u){return u.compare(r,a)<=0}),Ip=jf(">=",function(o,r,a){return r>=a},function(o,r,a,u){return u.compare(r,a)>=0});class jg{constructor(r,a,u,f,g,v){this.type=Wr,this.number=r,this.locale=a,this.currency=u,this.unit=f,this.minFractionDigits=g,this.maxFractionDigits=v}static parse(r,a){if(3!==r.length)return a.error("Expected two arguments.");const u=a.parse(r[1],1,Un);if(!u)return null;const f=r[2];if("object"!=typeof f||Array.isArray(f))return a.error("NumberFormat options argument must be an object.");let g=null;if(f.locale&&(g=a.parse(f.locale,1,Wr),!g))return null;let v=null;if(f.currency&&(v=a.parse(f.currency,1,Wr),!v))return null;let x=null;if(f.unit&&(x=a.parse(f.unit,1,Wr),!x))return null;let S=null;if(f["min-fraction-digits"]&&(S=a.parse(f["min-fraction-digits"],1,Un),!S))return null;let T=null;return f["max-fraction-digits"]&&(T=a.parse(f["max-fraction-digits"],1,Un),!T)?null:new jg(u,g,v,x,S,T)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(r):void 0,unit:this.unit?this.unit.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.unit&&r(this.unit),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.unit&&(r.unit=this.unit.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class Ph{constructor(r){this.type=Un,this.input=r}static parse(r,a){if(2!==r.length)return a.error(`Expected 1 argument, but found ${r.length-1} instead.`);const u=a.parse(r[1],1);return u?"array"!==u.type.kind&&"string"!==u.type.kind&&"value"!==u.type.kind?a.error(`Expected argument of type string or array, but found ${Ko(u.type)} instead.`):new Ph(u):null}evaluate(r){const a=this.input.evaluate(r);if("string"==typeof a||Array.isArray(a))return a.length;throw new ka(`Expected value to be of type string or array, but found ${Ko(Oo(a))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(a=>{r.push(a.serialize())}),r}}function Nh(o){return function(){o=1831565813+(o|=0)|0;let r=Math.imul(o^o>>>15,1|o);return r=r+Math.imul(r^r>>>7,61|r)^r,((r^r>>>14)>>>0)/4294967296}}const Gf={"==":ch,"!=":ba,">":OA,"<":Tp,">=":Ip,"<=":uh,array:Fh,at:Zi,boolean:Fh,case:Da,coalesce:Yd,collator:Of,format:_p,image:Il,in:gs,"index-of":pc,interpolate:ra,"interpolate-hcl":ra,"interpolate-lab":ra,length:Ph,let:l_,literal:Vd,match:jl,number:Fh,"number-format":jg,object:Fh,slice:lh,step:Cp,string:Fh,"to-boolean":Qd,"to-color":Qd,"to-number":Qd,"to-string":Qd,var:Ql,within:BA,distance:Ad,config:Uf};function $f(o,[r,a,u,f]){r=r.evaluate(o),a=a.evaluate(o),u=u.evaluate(o);const g=f?f.evaluate(o):1,v=Yu(r,a,u,g);if(v)throw new ka(v);return new so(r/255*g,a/255*g,u/255*g,g)}function Ds(o,[r,a,u,f]){r=r.evaluate(o),a=a.evaluate(o),u=u.evaluate(o);const g=f?f.evaluate(o):1,v=(D=a,O=u,z=g,"number"==typeof(T=r)&&T>=0&&T<=360?"number"==typeof D&&D>=0&&D<=100&&"number"==typeof O&&O>=0&&O<=100?void 0===z||"number"==typeof z&&z>=0&&z<=1?null:`Invalid hsla value [${[T,D,O,z].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${("number"==typeof z?[T,D,O,z]:[T,D,O]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${("number"==typeof z?[T,D,O,z]:[T,D,O]).join(", ")}]: 'h' must be between 0 and 360.`);var T,D,O,z;if(v)throw new ka(v);const x=`hsla(${r}, ${a}%, ${u}%, ${g})`,S=so.parse(x);if(!S)throw new ka(`Failed to parse HSLA color: ${x}`);return S}function k0(o,r){return o in r}function Dp(o,r){const a=r[o];return void 0===a?null:a}function gd(o){return{type:o}}Or.register(Gf,{error:[{kind:"error"},[Wr],(o,[r])=>{throw new ka(r.evaluate(o))}],typeof:[Wr,[Qr],(o,[r])=>Ko(Oo(r.evaluate(o)))],"to-rgba":[ln(Un,4),[Nr],(o,[r])=>r.evaluate(o).toArray()],rgb:[Nr,[Un,Un,Un],$f],rgba:[Nr,[Un,Un,Un,Un],$f],hsl:[Nr,[Un,Un,Un],Ds],hsla:[Nr,[Un,Un,Un,Un],Ds],has:{type:ys,overloads:[[[Wr],(o,[r])=>k0(r.evaluate(o),o.properties())],[[Wr,Br],(o,[r,a])=>k0(r.evaluate(o),a.evaluate(o))]]},get:{type:Qr,overloads:[[[Wr],(o,[r])=>Dp(r.evaluate(o),o.properties())],[[Wr,Br],(o,[r,a])=>Dp(r.evaluate(o),a.evaluate(o))]]},"feature-state":[Qr,[Wr],(o,[r])=>Dp(r.evaluate(o),o.featureState||{})],properties:[Br,[],o=>o.properties()],"geometry-type":[Wr,[],o=>o.geometryType()],id:[Qr,[],o=>o.id()],zoom:[Un,[],o=>o.globals.zoom],pitch:[Un,[],o=>o.globals.pitch||0],"distance-from-center":[Un,[],o=>o.distanceFromCenter()],"measure-light":[Un,[Wr],(o,[r])=>o.measureLight(r.evaluate(o))],"heatmap-density":[Un,[],o=>o.globals.heatmapDensity||0],"line-progress":[Un,[],o=>o.globals.lineProgress||0],"raster-value":[Un,[],o=>o.globals.rasterValue||0],"raster-particle-speed":[Un,[],o=>o.globals.rasterParticleSpeed||0],"sky-radial-progress":[Un,[],o=>o.globals.skyRadialProgress||0],accumulated:[Qr,[],o=>void 0===o.globals.accumulated?null:o.globals.accumulated],"+":[Un,gd(Un),(o,r)=>{let a=0;for(const u of r)a+=u.evaluate(o);return a}],"*":[Un,gd(Un),(o,r)=>{let a=1;for(const u of r)a*=u.evaluate(o);return a}],"-":{type:Un,overloads:[[[Un,Un],(o,[r,a])=>r.evaluate(o)-a.evaluate(o)],[[Un],(o,[r])=>-r.evaluate(o)]]},"/":[Un,[Un,Un],(o,[r,a])=>r.evaluate(o)/a.evaluate(o)],"%":[Un,[Un,Un],(o,[r,a])=>r.evaluate(o)%a.evaluate(o)],ln2:[Un,[],()=>Math.LN2],pi:[Un,[],()=>Math.PI],e:[Un,[],()=>Math.E],"^":[Un,[Un,Un],(o,[r,a])=>Math.pow(r.evaluate(o),a.evaluate(o))],sqrt:[Un,[Un],(o,[r])=>Math.sqrt(r.evaluate(o))],log10:[Un,[Un],(o,[r])=>Math.log(r.evaluate(o))/Math.LN10],ln:[Un,[Un],(o,[r])=>Math.log(r.evaluate(o))],log2:[Un,[Un],(o,[r])=>Math.log(r.evaluate(o))/Math.LN2],sin:[Un,[Un],(o,[r])=>Math.sin(r.evaluate(o))],cos:[Un,[Un],(o,[r])=>Math.cos(r.evaluate(o))],tan:[Un,[Un],(o,[r])=>Math.tan(r.evaluate(o))],asin:[Un,[Un],(o,[r])=>Math.asin(r.evaluate(o))],acos:[Un,[Un],(o,[r])=>Math.acos(r.evaluate(o))],atan:[Un,[Un],(o,[r])=>Math.atan(r.evaluate(o))],min:[Un,gd(Un),(o,r)=>Math.min(...r.map(a=>a.evaluate(o)))],max:[Un,gd(Un),(o,r)=>Math.max(...r.map(a=>a.evaluate(o)))],abs:[Un,[Un],(o,[r])=>Math.abs(r.evaluate(o))],round:[Un,[Un],(o,[r])=>{const a=r.evaluate(o);return a<0?-Math.round(-a):Math.round(a)}],floor:[Un,[Un],(o,[r])=>Math.floor(r.evaluate(o))],ceil:[Un,[Un],(o,[r])=>Math.ceil(r.evaluate(o))],"filter-==":[ys,[Wr,Qr],(o,[r,a])=>o.properties()[r.value]===a.value],"filter-id-==":[ys,[Qr],(o,[r])=>o.id()===r.value],"filter-type-==":[ys,[Wr],(o,[r])=>o.geometryType()===r.value],"filter-<":[ys,[Wr,Qr],(o,[r,a])=>{const u=o.properties()[r.value],f=a.value;return typeof u==typeof f&&u<f}],"filter-id-<":[ys,[Qr],(o,[r])=>{const a=o.id(),u=r.value;return typeof a==typeof u&&a<u}],"filter->":[ys,[Wr,Qr],(o,[r,a])=>{const u=o.properties()[r.value],f=a.value;return typeof u==typeof f&&u>f}],"filter-id->":[ys,[Qr],(o,[r])=>{const a=o.id(),u=r.value;return typeof a==typeof u&&a>u}],"filter-<=":[ys,[Wr,Qr],(o,[r,a])=>{const u=o.properties()[r.value],f=a.value;return typeof u==typeof f&&u<=f}],"filter-id-<=":[ys,[Qr],(o,[r])=>{const a=o.id(),u=r.value;return typeof a==typeof u&&a<=u}],"filter->=":[ys,[Wr,Qr],(o,[r,a])=>{const u=o.properties()[r.value],f=a.value;return typeof u==typeof f&&u>=f}],"filter-id->=":[ys,[Qr],(o,[r])=>{const a=o.id(),u=r.value;return typeof a==typeof u&&a>=u}],"filter-has":[ys,[Qr],(o,[r])=>r.value in o.properties()],"filter-has-id":[ys,[],o=>null!==o.id()&&void 0!==o.id()],"filter-type-in":[ys,[ln(Wr)],(o,[r])=>r.value.indexOf(o.geometryType())>=0],"filter-id-in":[ys,[ln(Qr)],(o,[r])=>r.value.indexOf(o.id())>=0],"filter-in-small":[ys,[Wr,ln(Qr)],(o,[r,a])=>a.value.indexOf(o.properties()[r.value])>=0],"filter-in-large":[ys,[Wr,ln(Qr)],(o,[r,a])=>function(u,f,g,v){for(;g<=v;){const x=g+v>>1;if(f[x]===u)return!0;f[x]>u?v=x-1:g=x+1}return!1}(o.properties()[r.value],a.value,0,a.value.length-1)],all:{type:ys,overloads:[[[ys,ys],(o,[r,a])=>r.evaluate(o)&&a.evaluate(o)],[gd(ys),(o,r)=>{for(const a of r)if(!a.evaluate(o))return!1;return!0}]]},any:{type:ys,overloads:[[[ys,ys],(o,[r,a])=>r.evaluate(o)||a.evaluate(o)],[gd(ys),(o,r)=>{for(const a of r)if(a.evaluate(o))return!0;return!1}]]},"!":[ys,[ys],(o,[r])=>!r.evaluate(o)],"is-supported-script":[ys,[Wr],(o,[r])=>{const a=o.globals&&o.globals.isSupportedScript;return!a||a(r.evaluate(o))}],upcase:[Wr,[Wr],(o,[r])=>r.evaluate(o).toUpperCase()],downcase:[Wr,[Wr],(o,[r])=>r.evaluate(o).toLowerCase()],concat:[Wr,gd(Qr),(o,r)=>r.map(a=>Iu(a.evaluate(o))).join("")],"resolved-locale":[Wr,[Df],(o,[r])=>r.evaluate(o).resolvedLocale()],random:[Un,[Un,Un,Qr],(o,r)=>{const[a,u,f]=r.map(v=>v.evaluate(o));if(a>u||a===u)return a;let g;if("string"==typeof f)g=function(v){let x=0;if(0===v.length)return x;for(let S=0;S<v.length;S++)x=(x<<5)-x+v.charCodeAt(S),x|=0;return x}(f);else{if("number"!=typeof f)throw new ka(`Invalid seed input: ${f}`);g=f}return a+Nh(g)()*(u-a)}]});var mc=Gf;function kA(o){return{result:"success",value:o}}function Uc(o){return{result:"error",value:o}}function md(o,r){return!!o&&!!o.parameters&&o.parameters.indexOf(r)>-1}function Ya(o){return"data-driven"===o["property-type"]}function P0(o){return md(o.expression,"measure-light")}function _c(o){return md(o.expression,"zoom")}function Gl(o){return!!o.expression&&o.expression.interpolated}function PA(o){return"object"==typeof o&&null!==o&&!Array.isArray(o)}function Jd(o){return o}function _d(o,r){const a="color"===r.type,u=o.stops&&"object"==typeof o.stops[0][0],f=u||!(u||void 0!==o.property),g=o.type||(Gl(r)?"exponential":"interval");if(a&&((o=mp({},o)).stops&&(o.stops=o.stops.map(T=>[T[0],so.parse(T[1])])),o.default=so.parse(o.default?o.default:r.default)),o.colorSpace&&"rgb"!==o.colorSpace&&!dl[o.colorSpace])throw new Error(`Unknown color space: ${o.colorSpace}`);let v,x,S;if("exponential"===g)v=N0;else if("interval"===g)v=mv;else if("categorical"===g){v=c_,x=Object.create(null);for(const T of o.stops)x[T[0]]=T[1];S=typeof o.stops[0][0]}else{if("identity"!==g)throw new Error(`Unknown function type "${g}"`);v=_v}if(u){const T={},D=[];for(let $=0;$<o.stops.length;$++){const K=o.stops[$],X=K[0].zoom;void 0===T[X]&&(T[X]={zoom:X,type:o.type,property:o.property,default:o.default,stops:[]},D.push(X)),T[X].stops.push([K[0].value,K[1]])}const O=[];for(const $ of D)O.push([T[$].zoom,_d(T[$],r)]);const z={name:"linear"};return{kind:"composite",interpolationType:z,interpolationFactor:ra.interpolationFactor.bind(void 0,z),zoomStops:O.map($=>$[0]),evaluate:({zoom:$},K)=>N0({stops:O,base:o.base},r,$).evaluate($,K)}}if(f){const T="exponential"===g?{name:"exponential",base:void 0!==o.base?o.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:ra.interpolationFactor.bind(void 0,T),zoomStops:o.stops.map(D=>D[0]),evaluate:({zoom:D})=>v(o,r,D,x,S)}}return{kind:"source",evaluate(T,D){const O=D&&D.properties?D.properties[o.property]:void 0;return void 0===O?yc(o.default,r.default):v(o,r,O,x,S)}}}function yc(o,r,a){return void 0!==o?o:void 0!==r?r:void 0!==a?a:void 0}function c_(o,r,a,u,f){return yc(typeof a===f?u[a]:void 0,o.default,r.default)}function mv(o,r,a){if("number"!==qi(a))return yc(o.default,r.default);const u=o.stops.length;if(1===u||a<=o.stops[0][0])return o.stops[0][1];if(a>=o.stops[u-1][0])return o.stops[u-1][1];const f=Wd(o.stops.map(g=>g[0]),a);return o.stops[f][1]}function N0(o,r,a){const u=void 0!==o.base?o.base:1;if("number"!==qi(a))return yc(o.default,r.default);const f=o.stops.length;if(1===f||a<=o.stops[0][0])return o.stops[0][1];if(a>=o.stops[f-1][0])return o.stops[f-1][1];const g=Wd(o.stops.map(D=>D[0]),a),v=function(D,O,z,$){const K=$-z,X=D-z;return 0===K?0:1===O?X/K:(Math.pow(O,X)-1)/(Math.pow(O,K)-1)}(a,u,o.stops[g][0],o.stops[g+1][0]),x=o.stops[g][1],S=o.stops[g+1][1];let T=gp[r.type]||Jd;if(o.colorSpace&&"rgb"!==o.colorSpace){const D=dl[o.colorSpace];T=(O,z)=>D.reverse(D.interpolate(D.forward(O),D.forward(z),v))}return"function"==typeof x.evaluate?{evaluate(...D){const O=x.evaluate.apply(void 0,D),z=S.evaluate.apply(void 0,D);if(void 0!==O&&void 0!==z)return T(O,z,v)}}:T(x,S,v)}function _v(o,r,a){return"color"===r.type?a=so.parse(a):"formatted"===r.type?a=xo.fromString(a.toString()):"resolvedImage"===r.type?a=Ri.fromString(a.toString()):qi(a)===r.type||"enum"===r.type&&r.values[a]||(a=void 0),yc(a,o.default,r.default)}class Gg{constructor(r,a,u,f){var g;this.expression=r,this._warningHistory={},this._evaluator=new pv(u,f),this._defaultValue=a?"color"===(g=a).type&&(PA(g.default)||Array.isArray(g.default))?new so(0,0,0,0):"color"===g.type?so.parse(g.default)||null:void 0===g.default?null:g.default:null,this._enumValues=a&&"enum"===a.type?a.values:null}evaluateWithoutErrorHandling(r,a,u,f,g,v,x,S){return this._evaluator.globals=r,this._evaluator.feature=a,this._evaluator.featureState=u,this._evaluator.canonical=f||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=S||null,this.expression.evaluate(this._evaluator)}evaluate(r,a,u,f,g,v,x,S){this._evaluator.globals=r,this._evaluator.feature=a||null,this._evaluator.featureState=u||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=S||null;try{const T=this.expression.evaluate(this._evaluator);if(null==T||"number"==typeof T&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new ka(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Bp(o){return Array.isArray(o)&&o.length>0&&"string"==typeof o[0]&&o[0]in mc}function u_(o,r,a,u){const f=new R0(mc,[],r?function(v){const x={color:Nr,string:Wr,number:Un,enum:Wr,boolean:ys,formatted:Bf,resolvedImage:Tu};return"array"===v.type?ln(x[v.value]||Qr,v.length):x[v.type]}(r):void 0,void 0,void 0,a,u),g=f.parse(o,void 0,void 0,void 0,r&&"string"===r.type?{typeAnnotation:"coerce"}:void 0);return g?kA(new Gg(g,r,a,u)):Uc(f.errors)}class L0{constructor(r,a,u){this.kind=r,this._styleExpression=a,this.isLightConstant=u,this.isStateDependent="constant"!==r&&!Hl(a.expression),this.isConfigDependent=!FA(a.expression)}evaluateWithoutErrorHandling(r,a,u,f,g,v){return this._styleExpression.evaluateWithoutErrorHandling(r,a,u,f,g,v)}evaluate(r,a,u,f,g,v){return this._styleExpression.evaluate(r,a,u,f,g,v)}}class $g{constructor(r,a,u,f,g){this.kind=r,this.zoomStops=u,this._styleExpression=a,this.isStateDependent="camera"!==r&&!Hl(a.expression),this.isLightConstant=g,this.isConfigDependent=!FA(a.expression),this.interpolationType=f}evaluateWithoutErrorHandling(r,a,u,f,g,v){return this._styleExpression.evaluateWithoutErrorHandling(r,a,u,f,g,v)}evaluate(r,a,u,f,g,v){return this._styleExpression.evaluate(r,a,u,f,g,v)}interpolationFactor(r,a,u){return this.interpolationType?ra.interpolationFactor(this.interpolationType,r,a,u):0}}function h_(o,r,a,u){if("error"===(o=u_(o,r,a,u)).result)return o;const f=o.value.expression,g=rh(f);if(!g&&!Ya(r))return Uc([new Tl("","data expressions not supported")]);const v=ul(f,["zoom","pitch","distance-from-center"]);if(!v&&!_c(r))return Uc([new Tl("","zoom expressions not supported")]);const x=ul(f,["measure-light"]);if(!x&&!P0(r))return Uc([new Tl("","measure-light expression not supported")]);const S=r.expression&&r.expression.relaxZoomRestriction,T=Mp(f);return T||v||S?T instanceof Tl?Uc([T]):T instanceof ra&&!Gl(r)?Uc([new Tl("",'"interpolate" expressions cannot be used with this property')]):kA(T?new $g(g?"camera":"composite",o.value,T.labels,T instanceof ra?T.interpolation:void 0,x):new L0(g?"constant":"source",o.value,x)):Uc([new Tl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class qg{constructor(r,a){this._parameters=r,this._specification=a,mp(this,_d(this._parameters,this._specification))}static deserialize(r){return new qg(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function Mp(o){let r=null;if(o instanceof l_)r=Mp(o.result);else if(o instanceof Yd){for(const a of o.args)if(r=Mp(a),r)break}else(o instanceof Cp||o instanceof ra)&&o.input instanceof Or&&"zoom"===o.input.name&&(r=o);return r instanceof Tl||o.eachChild(a=>{const u=Mp(a);u instanceof Tl?r=u:r&&u&&r!==u&&(r=new Tl("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}var gb=Uh,Lh=3;function Uh(o,r,a){var u=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var f=new Int32Array(this.arrayBuffer);o=f[0],this.d=(r=f[1])+2*(a=f[2]);for(var g=0;g<this.d*this.d;g++){var v=f[Lh+g],x=f[Lh+g+1];u.push(v===x?null:f.subarray(v,x))}var S=f[Lh+u.length+1];this.keys=f.subarray(f[Lh+u.length],S),this.bboxes=f.subarray(S),this.insert=this._insertReadonly}else{this.d=r+2*a;for(var T=0;T<this.d*this.d;T++)u.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=o,this.padding=a,this.scale=r/o,this.uid=0;var D=a/r*o;this.min=-D,this.max=o+D}Uh.prototype.insert=function(o,r,a,u,f){this._forEachCell(r,a,u,f,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(f)},Uh.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Uh.prototype._insertCell=function(o,r,a,u,f,g){this.cells[f].push(g)},Uh.prototype.query=function(o,r,a,u,f){var g=this.min,v=this.max;if(o<=g&&r<=g&&v<=a&&v<=u&&!f)return Array.prototype.slice.call(this.keys);var x=[];return this._forEachCell(o,r,a,u,this._queryCell,x,{},f),x},Uh.prototype._queryCell=function(o,r,a,u,f,g,v,x){var S=this.cells[f];if(null!==S)for(var T=this.keys,D=this.bboxes,O=0;O<S.length;O++){var z=S[O];if(void 0===v[z]){var $=4*z;(x?x(D[$+0],D[$+1],D[$+2],D[$+3]):o<=D[$+2]&&r<=D[$+3]&&a>=D[$+0]&&u>=D[$+1])?(v[z]=!0,g.push(T[z])):v[z]=!1}}},Uh.prototype._forEachCell=function(o,r,a,u,f,g,v,x){for(var S=this._convertToCellCoord(o),T=this._convertToCellCoord(r),D=this._convertToCellCoord(a),O=this._convertToCellCoord(u),z=S;z<=D;z++)for(var $=T;$<=O;$++){var K=this.d*$+z;if((!x||x(this._convertFromCellCoord(z),this._convertFromCellCoord($),this._convertFromCellCoord(z+1),this._convertFromCellCoord($+1)))&&f.call(this,o,r,a,u,K,g,v,x))return}},Uh.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},Uh.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},Uh.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,r=Lh+this.cells.length+1+1,a=0,u=0;u<this.cells.length;u++)a+=this.cells[u].length;var f=new Int32Array(r+a+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var g=r,v=0;v<o.length;v++){var x=o[v];f[Lh+v]=g,f.set(x,g),g+=x.length}return f[Lh+o.length]=g,f.set(this.keys,g),f[Lh+o.length+1]=g+=this.keys.length,f.set(this.bboxes,g),g+=this.bboxes.length,f.buffer};var hh=Ta(gb);const Kg={};function ai(o,r,a={}){Object.defineProperty(o,"_classRegistryKey",{value:r,writeable:!1}),Kg[r]={klass:o,omit:a.omit||[]}}ai(Object,"Object"),hh.serialize=function(o,r){const a=o.toArrayBuffer();return r&&r.add(a),{buffer:a}},hh.deserialize=function(o){return new hh(o.buffer)},Object.defineProperty(hh,"name",{value:"Grid"}),ai(hh,"Grid"),ai(so,"Color"),ai(Error,"Error"),ai(xo,"Formatted"),ai(zd,"FormattedSection"),ai(ua,"AJAXError"),ai(Ri,"ResolvedImage"),ai(qg,"StylePropertyFunction"),ai(Gg,"StyleExpression",{omit:["_evaluator"]}),ai($g,"ZoomDependentExpression"),ai(L0,"ZoomConstantExpression"),ai(Or,"CompoundExpression",{omit:["_evaluate"]});for(const o in mc)Kg[mc[o]._classRegistryKey]||ai(mc[o],`Expression${o}`);function Wg(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&"ArrayBuffer"===o.constructor.name)}function Fp(o){return self.ImageBitmap&&o instanceof ImageBitmap}function qf(o,r){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp)return o;if(Wg(o)||Fp(o))return r&&r.add(o),o;if(ArrayBuffer.isView(o)){const a=o;return r&&r.add(a.buffer),a}if(o instanceof ImageData)return r&&r.add(o.data.buffer),o;if(Array.isArray(o)){const a=[];for(const u of o)a.push(qf(u,r));return a}if(o instanceof Map){const a={$name:"Map"};for(const[u,f]of o.entries())a[u]=qf(f);return a}if("object"==typeof o){const a=o.constructor,u=a._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const f=a.serialize?a.serialize(o,r):{};if(!a.serialize){for(const g in o)o.hasOwnProperty(g)&&(Kg[u].omit.indexOf(g)>=0||(f[g]=qf(o[g],r)));o instanceof Error&&(f.message=o.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==u&&(f.$name=u),f}throw new Error("can't serialize object of type "+typeof o)}function NA(o){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||Wg(o)||Fp(o)||ArrayBuffer.isView(o)||o instanceof ImageData)return o;if(Array.isArray(o))return o.map(NA);if("object"==typeof o){const r=o.$name||"Object";if("Map"===r){const f=new Map;for(const g of Object.keys(o))"$name"!==g&&f.set(g,NA(o[g]));return f}const{klass:a}=Kg[r];if(!a)throw new Error(`can't deserialize unregistered class ${r}`);if(a.deserialize)return a.deserialize(o);const u=Object.create(a.prototype);for(const f of Object.keys(o))"$name"!==f&&(u[f]=NA(o[f]));return u}throw new Error("can't deserialize object of type "+typeof o)}const gi={"Latin-1 Supplement":o=>o>=128&&o<=255,Arabic:o=>o>=1536&&o<=1791,"Arabic Supplement":o=>o>=1872&&o<=1919,"Arabic Extended-A":o=>o>=2208&&o<=2303,"Hangul Jamo":o=>o>=4352&&o<=4607,"Unified Canadian Aboriginal Syllabics":o=>o>=5120&&o<=5759,Khmer:o=>o>=6016&&o<=6143,"Unified Canadian Aboriginal Syllabics Extended":o=>o>=6320&&o<=6399,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"CJK Radicals Supplement":o=>o>=11904&&o<=12031,"Kangxi Radicals":o=>o>=12032&&o<=12255,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Bopomofo:o=>o>=12544&&o<=12591,"Hangul Compatibility Jamo":o=>o>=12592&&o<=12687,Kanbun:o=>o>=12688&&o<=12703,"Bopomofo Extended":o=>o>=12704&&o<=12735,"CJK Strokes":o=>o>=12736&&o<=12783,"Katakana Phonetic Extensions":o=>o>=12784&&o<=12799,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"CJK Unified Ideographs Extension A":o=>o>=13312&&o<=19903,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Yi Syllables":o=>o>=40960&&o<=42127,"Yi Radicals":o=>o>=42128&&o<=42191,"Hangul Jamo Extended-A":o=>o>=43360&&o<=43391,"Hangul Syllables":o=>o>=44032&&o<=55215,"Hangul Jamo Extended-B":o=>o>=55216&&o<=55295,"Private Use Area":o=>o>=57344&&o<=63743,"CJK Compatibility Ideographs":o=>o>=63744&&o<=64255,"Arabic Presentation Forms-A":o=>o>=64336&&o<=65023,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Arabic Presentation Forms-B":o=>o>=65136&&o<=65279,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519,"CJK Unified Ideographs Extension B":o=>o>=131072&&o<=173791};function zc(o){for(const r of o)if(U0(r.charCodeAt(0)))return!0;return!1}function ef(o){for(const r of o)if(!mb(r.charCodeAt(0)))return!1;return!0}function mb(o){return!(gi.Arabic(o)||gi["Arabic Supplement"](o)||gi["Arabic Extended-A"](o)||gi["Arabic Presentation Forms-A"](o)||gi["Arabic Presentation Forms-B"](o))}function U0(o){return!(746!==o&&747!==o&&(o<4352||!(gi["Bopomofo Extended"](o)||gi.Bopomofo(o)||gi["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||gi["CJK Compatibility Ideographs"](o)||gi["CJK Compatibility"](o)||gi["CJK Radicals Supplement"](o)||gi["CJK Strokes"](o)||!(!gi["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||12336===o)||gi["CJK Unified Ideographs Extension A"](o)||gi["CJK Unified Ideographs"](o)||gi["Enclosed CJK Letters and Months"](o)||gi["Hangul Compatibility Jamo"](o)||gi["Hangul Jamo Extended-A"](o)||gi["Hangul Jamo Extended-B"](o)||gi["Hangul Jamo"](o)||gi["Hangul Syllables"](o)||gi.Hiragana(o)||gi["Ideographic Description Characters"](o)||gi.Kanbun(o)||gi["Kangxi Radicals"](o)||gi["Katakana Phonetic Extensions"](o)||gi.Katakana(o)&&12540!==o||!(!gi["Halfwidth and Fullwidth Forms"](o)||65288===o||65289===o||65293===o||o>=65306&&o<=65310||65339===o||65341===o||65343===o||o>=65371&&o<=65503||65507===o||o>=65512&&o<=65519)||!(!gi["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||gi["Unified Canadian Aboriginal Syllabics"](o)||gi["Unified Canadian Aboriginal Syllabics Extended"](o)||gi["Vertical Forms"](o)||gi["Yijing Hexagram Symbols"](o)||gi["Yi Syllables"](o)||gi["Yi Radicals"](o))))}function $s(o){return!(U0(o)||(r=o,gi["Latin-1 Supplement"](r)&&(167===r||169===r||174===r||177===r||188===r||189===r||190===r||215===r||247===r)||gi["General Punctuation"](r)&&(8214===r||8224===r||8225===r||8240===r||8241===r||8251===r||8252===r||8258===r||8263===r||8264===r||8265===r||8273===r)||gi["Letterlike Symbols"](r)||gi["Number Forms"](r)||gi["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||9003===r||r>=9085&&r<=9114||r>=9150&&r<=9165||9167===r||r>=9169&&r<=9179||r>=9186&&r<=9215)||gi["Control Pictures"](r)&&9251!==r||gi["Optical Character Recognition"](r)||gi["Enclosed Alphanumerics"](r)||gi["Geometric Shapes"](r)||gi["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||gi["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||gi["CJK Symbols and Punctuation"](r)||gi.Katakana(r)||gi["Private Use Area"](r)||gi["CJK Compatibility Forms"](r)||gi["Small Form Variants"](r)||gi["Halfwidth and Fullwidth Forms"](r)||8734===r||8756===r||8757===r||r>=9984&&r<=10087||r>=10102&&r<=10131||65532===r||65533===r));var r}function Rp(o){return o>=1424&&o<=2303||gi["Arabic Presentation Forms-A"](o)||gi["Arabic Presentation Forms-B"](o)}function hu(o,r){return!(!r&&Rp(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||gi.Khmer(o))}function Zg(o){for(const r of o)if(Rp(r.charCodeAt(0)))return!0;return!1}const Xg="deferred",Yg="loading",Op="loaded";let kp=null,vc="unavailable",zh=null;const Jg=function(o){o&&"string"==typeof o&&o.indexOf("NetworkError")>-1&&(vc="error"),kp&&kp(o)};function em(){tm.fire(new Ud("pluginStateChange",{pluginStatus:vc,pluginURL:zh}))}const tm=new ld,Vh=function(){return vc},Pi=function(){if(vc!==Xg||!zh)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");vc=Yg,em(),zh&&Jt({url:zh},o=>{o?Jg(o):(vc=Op,em())})},$l={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>vc===Op||null!=$l.applyArabicShaping,isLoading:()=>vc===Yg,setState(o){vc=o.pluginStatus,zh=o.pluginURL},isParsed:()=>null!=$l.applyArabicShaping&&null!=$l.processBidirectionalText&&null!=$l.processStyledBidirectionalText,getPluginURL:()=>zh};class uo{constructor(r,a){this.zoom=r,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch,this.brightness=a.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(r){return function(a,u){for(const f of a)if(!hu(f.charCodeAt(0),u))return!1;return!0}(r,$l.isLoaded())}}class Kf{constructor(r,a,u,f){this.property=r,this.value=a,this.expression=function(g,v,x,S){if(PA(g))return new qg(g,v);if(Bp(g)||Array.isArray(g)&&g.length>0){const T=h_(g,v,x,S);if("error"===T.result)throw new Error(T.value.map(D=>`${D.key}: ${D.message}`).join(", "));return T.value}{let T=g;return"string"==typeof g&&"color"===v.type&&(T=so.parse(g)),{kind:"constant",isConfigDependent:!1,evaluate:()=>T}}}(void 0===a?r.specification.default:a,r.specification,u,f)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(r,a,u){return this.property.possiblyEvaluate(this,r,a,u)}}class dh{constructor(r,a,u){this.property=r,this.value=new Kf(r,void 0,a,u)}transitioned(r,a){return new d_(this.property,this.value,a,Oa({},r.transition,this.transition),r.now)}untransitioned(){return new d_(this.property,this.value,null,{},0)}}class tf{constructor(r,a,u){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues),this._scope=a,this._options=u,this.isConfigDependent=!1}getValue(r){return Ht(this._values[r].value.value)}setValue(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new dh(this._values[r].property,this._scope,this._options)),this._values[r].value=new Kf(this._values[r].property,null===a?void 0:Ht(a),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[r].value.expression.isConfigDependent}setTransitionOrValue(r,a){a&&(this._options=a);const u=this._properties.properties;if(r)for(const f in r){const g=r[f];if(Xs(f,"-transition")){const v=f.slice(0,-11);u[v]&&this.setTransition(v,g)}else u[f]&&this.setValue(f,g)}}getTransition(r){return Ht(this._values[r].transition)}setTransition(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new dh(this._values[r].property)),this._values[r].transition=Ht(a)||void 0}serialize(){const r={};for(const a of Object.keys(this._values)){const u=this.getValue(a);void 0!==u&&(r[a]=u);const f=this.getTransition(a);void 0!==f&&(r[`${a}-transition`]=f)}return r}transitioned(r,a){const u=new fh(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].transitioned(r,a._values[f]);return u}untransitioned(){const r=new fh(this._properties);for(const a of Object.keys(this._values))r._values[a]=this._values[a].untransitioned();return r}}class d_{constructor(r,a,u,f,g){const v=f.delay||0,x=f.duration||0;g=g||0,this.property=r,this.value=a,this.begin=g+v,this.end=this.begin+x,r.specification.transition&&(f.delay||f.duration)&&(this.prior=u)}possiblyEvaluate(r,a,u){const f=r.now||0,g=this.value.possiblyEvaluate(r,a,u),v=this.prior;if(v){if(f>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(f<this.begin)return v.possiblyEvaluate(r,a,u);{const x=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(r,a,u),g,ei(x))}}return g}}class fh{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,a,u){const f=new LA(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(r,a,u);return f}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class nm{constructor(r,a,u){this._properties=r,this._values=Object.create(r.defaultPropertyValues),this._scope=a,this._options=u,this.isConfigDependent=!1}getValue(r){return Ht(this._values[r].value)}setValue(r,a){this._values[r]=new Kf(this._values[r].property,null===a?void 0:Ht(a),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[r].expression.isConfigDependent}serialize(){const r={};for(const a of Object.keys(this._values)){const u=this.getValue(a);void 0!==u&&(r[a]=u)}return r}possiblyEvaluate(r,a,u){const f=new LA(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(r,a,u);return f}}class Pp{constructor(r,a,u){this.property=r,this.value=a,this.parameters=u}isConstant(){return"constant"===this.value.kind}constantOr(r){return"constant"===this.value.kind?this.value.value:r}evaluate(r,a,u,f){return this.property.evaluate(this.value,this.parameters,r,a,u,f)}}class LA{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class Rn{constructor(r){this.specification=r}possiblyEvaluate(r,a){return r.expression.evaluate(a)}interpolate(r,a,u){const f=gp[this.specification.type];return f?f(r,a,u):r}}class wi{constructor(r,a){this.specification=r,this.overrides=a}possiblyEvaluate(r,a,u,f){return new Pp(this,"constant"===r.expression.kind||"camera"===r.expression.kind?{kind:"constant",value:r.expression.evaluate(a,null,{},u,f)}:r.expression,a)}interpolate(r,a,u){if("constant"!==r.value.kind||"constant"!==a.value.kind)return r;if(void 0===r.value.value||void 0===a.value.value)return new Pp(this,{kind:"constant",value:void 0},r.parameters);const f=gp[this.specification.type];return f?new Pp(this,{kind:"constant",value:f(r.value.value,a.value.value,u)},r.parameters):r}evaluate(r,a,u,f,g,v){return"constant"===r.kind?r.value:r.evaluate(a,u,f,g,v)}}class Ah{constructor(r){this.specification=r}possiblyEvaluate(r,a,u,f){return!!r.expression.evaluate(a,null,{},u,f)}interpolate(){return!1}}class ko{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new uo(0,{});for(const u in r){const f=r[u];f.specification.overridable&&this.overridableProperties.push(u);const g=this.defaultPropertyValues[u]=new Kf(f,void 0),v=this.defaultTransitionablePropertyValues[u]=new dh(f);this.defaultTransitioningPropertyValues[u]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=g.possiblyEvaluate(a)}}}function im(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function UA(o){if(Array.isArray(o))return o.map(UA);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const r={};for(const a in o)r[a]=UA(o[a]);return r}return im(o)}ai(wi,"DataDrivenProperty"),ai(Rn,"DataConstantProperty"),ai(Ah,"ColorRampProperty");var bt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function zA(o){if(!0===o||!1===o)return!0;if(!Array.isArray(o)||0===o.length)return!1;switch(o[0]){case"has":return o.length>=2&&"$id"!==o[1]&&"$type"!==o[1];case"in":return o.length>=3&&("string"!=typeof o[1]||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==o.length||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const r of o.slice(1))if(!zA(r)&&"boolean"!=typeof r)return!1;return!0;default:return!0}}function du(o,r="fill"){if(null==o)return{filter:()=>!0,needGeometry:!1,needFeature:!1};zA(o)||(o=rm(o));const a=o;let u=!0;try{u=function(T){if(!Wf(T))return T;let D=UA(T);return f_(D),D=z0(D),D}(a)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(a,null,2)}\n        `)}const f=bt[`filter_${r}`],g=u_(u,f);let v=null;if("error"===g.result)throw new Error(g.value.map(T=>`${T.key}: ${T.message}`).join(", "));v=(T,D,O)=>g.value.evaluate(T,D,{},O);let x=null,S=null;if(u!==a){const T=u_(a,f);if("error"===T.result)throw new Error(T.value.map(D=>`${D.key}: ${D.message}`).join(", "));x=(D,O,z,$,K)=>T.value.evaluate(D,O,{},z,void 0,void 0,$,K),S=!rh(T.value.expression)}return{filter:v,dynamicFilter:x||void 0,needGeometry:H0(u),needFeature:!!S}}function z0(o){if(!Array.isArray(o))return o;const r=function(a){if(yv.has(a[0]))for(let u=1;u<a.length;u++)if(Wf(a[u]))return!0;return a}(o);return!0===r?r:r.map(a=>z0(a))}function f_(o){let r=!1;const a=[];if("case"===o[0]){for(let u=1;u<o.length-1;u+=2)r=r||Wf(o[u]),a.push(o[u+1]);a.push(o[o.length-1])}else if("match"===o[0]){r=r||Wf(o[1]);for(let u=2;u<o.length-1;u+=2)a.push(o[u+1]);a.push(o[o.length-1])}else if("step"===o[0]){r=r||Wf(o[1]);for(let u=1;u<o.length-1;u+=2)a.push(o[u+1])}r&&(o.length=0,o.push("any",...a));for(let u=1;u<o.length;u++)f_(o[u])}function Wf(o){if(!Array.isArray(o))return!1;if("pitch"===(r=o[0])||"distance-from-center"===r)return!0;var r;for(let a=1;a<o.length;a++)if(Wf(o[a]))return!0;return!1}const yv=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function V0(o,r){return o<r?-1:o>r?1:0}function H0(o){if(!Array.isArray(o))return!1;if("within"===o[0]||"distance"===o[0])return!0;for(let r=1;r<o.length;r++)if(H0(o[r]))return!0;return!1}function rm(o){if(!o)return!0;const r=o[0];return o.length<=1?"any"!==r:"=="===r?VA(o[1],o[2],"=="):"!="===r?Np(VA(o[1],o[2],"==")):"<"===r||">"===r||"<="===r||">="===r?VA(o[1],o[2],r):"any"===r?(a=o.slice(1),["any"].concat(a.map(rm))):"all"===r?["all"].concat(o.slice(1).map(rm)):"none"===r?["all"].concat(o.slice(1).map(rm).map(Np)):"in"===r?Zo(o[1],o.slice(2)):"!in"===r?Np(Zo(o[1],o.slice(2))):"has"===r?A_(o[1]):"!has"!==r||Np(A_(o[1]));var a}function VA(o,r,a){switch(o){case"$type":return[`filter-type-${a}`,r];case"$id":return[`filter-id-${a}`,r];default:return[`filter-${a}`,o,r]}}function Zo(o,r){if(0===r.length)return!1;switch(o){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(a=>typeof a!=typeof r[0])?["filter-in-large",o,["literal",r.sort(V0)]]:["filter-in-small",o,["literal",r]]}}function A_(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function Np(o){return["!",o]}function sm(o,r){return r?`${o}\x1f${r}`:o}const yd="-transition";class Vc extends ld{constructor(r,a,u,f){if(super(),this.id=r.id,this.fqid=sm(this.id,u),this.type=r.type,this.scope=u,this.options=f,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,"custom"!==r.type&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,"background"!==r.type&&"sky"!==r.type&&"slot"!==r.type&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),r.slot&&(this.slot=r.slot),a.layout&&(this._unevaluatedLayout=new nm(a.layout,this.scope,f),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),a.paint)){this._transitionablePaint=new tf(a.paint,this.scope,f);for(const g in r.paint)this.setPaintProperty(g,r.paint[g]);for(const g in r.layout)this.setLayoutProperty(g,r.layout[g]);this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new LA(a.paint)}}getLayoutProperty(r){return"visibility"===r?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,a){if("custom"===this.type&&"visibility"===r)return void(this.visibility=a);const u=this._unevaluatedLayout;u._properties.properties[r]&&(u.setValue(r,a),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,"visibility"===r&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(r){return Xs(r,yd)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,a){const u=this._transitionablePaint,f=u._properties.properties;if(Xs(r,yd)){const O=r.slice(0,-11);return f[O]&&u.setTransition(O,a||void 0),!1}if(!f[r])return!1;const g=u._values[r],v=g.value.isDataDriven(),x=g.value;u.setValue(r,a),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,this._handleSpecialPaintPropertyUpdate(r);const S=u._values[r].value,T=S.isDataDriven(),D=Xs(r,"pattern")||"line-dasharray"===r;return T||v||D||this._handleOverridablePaintPropertyUpdate(r,x,S)}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getDefaultProgramParams(r,a){return null}_handleOverridablePaintPropertyUpdate(r,a,u){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||"none"===this.visibility}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,a)}serialize(){return dc({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(r,a)=>!(void 0===r||"layout"===a&&!Object.keys(r).length||"paint"===a&&!Object.keys(r).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const r in this.paint._values){const a=this.paint.get(r);if(a instanceof Pp&&Ya(a.property.specification)&&("source"===a.value.kind||"composite"===a.value.kind)&&a.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=du(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(r){this._stats&&("shadow"===r.renderPass?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}}const Up={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class HA{constructor(r,a){this._structArray=r,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Bs{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,a){return r._trim(),a&&(r.isTransferred=!0,a.add(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const a=Object.create(this.prototype);return a.arrayBuffer=r.arrayBuffer,a.length=r.length,a.capacity=r.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...r){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...r){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function bs(o,r=1){let a=0,u=0;return{members:o.map(f=>{const g=Up[f.type].BYTES_PER_ELEMENT,v=a=QA(a,Math.max(r,g)),x=f.components||1;return u=Math.max(u,g),a+=g*x,{name:f.name,type:f.type,components:x,offset:v}}),size:QA(a,Math.max(u,r)),alignment:r}}function QA(o,r){return Math.ceil(o/r)*r}class Hs extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a){const u=this.length;return this.resize(u+1),this.emplace(u,r,a)}emplace(r,a,u){const f=2*r;return this.int16[f+0]=a,this.int16[f+1]=u,r}}Hs.prototype.bytesPerElement=4,ai(Hs,"StructArrayLayout2i4");class Al extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,r,a,u)}emplace(r,a,u,f){const g=3*r;return this.int16[g+0]=a,this.int16[g+1]=u,this.int16[g+2]=f,r}}Al.prototype.bytesPerElement=6,ai(Al,"StructArrayLayout3i6");class Hc extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,u,f)}emplace(r,a,u,f,g){const v=4*r;return this.int16[v+0]=a,this.int16[v+1]=u,this.int16[v+2]=f,this.int16[v+3]=g,r}}Hc.prototype.bytesPerElement=8,ai(Hc,"StructArrayLayout4i8");class ql extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,u,f,g)}emplace(r,a,u,f,g,v){const x=5*r;return this.int16[x+0]=a,this.int16[x+1]=u,this.int16[x+2]=f,this.int16[x+3]=g,this.int16[x+4]=v,r}}ql.prototype.bytesPerElement=10,ai(ql,"StructArrayLayout5i10");class om extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,r,a,u,f,g,v,x)}emplace(r,a,u,f,g,v,x,S){const T=6*r,D=12*r,O=3*r;return this.int16[T+0]=a,this.int16[T+1]=u,this.uint8[D+4]=f,this.uint8[D+5]=g,this.uint8[D+6]=v,this.uint8[D+7]=x,this.float32[O+2]=S,r}}om.prototype.bytesPerElement=12,ai(om,"StructArrayLayout2i4ub1f12");class Hh extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,u,f)}emplace(r,a,u,f,g){const v=4*r;return this.float32[v+0]=a,this.float32[v+1]=u,this.float32[v+2]=f,this.float32[v+3]=g,r}}Hh.prototype.bytesPerElement=16,ai(Hh,"StructArrayLayout4f16");class Qc extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,u,f,g)}emplace(r,a,u,f,g,v){const x=6*r,S=3*r;return this.uint16[x+0]=a,this.uint16[x+1]=u,this.uint16[x+2]=f,this.uint16[x+3]=g,this.float32[S+2]=v,r}}Qc.prototype.bytesPerElement=12,ai(Qc,"StructArrayLayout4ui1f12");class Ja extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,u,f)}emplace(r,a,u,f,g){const v=4*r;return this.uint16[v+0]=a,this.uint16[v+1]=u,this.uint16[v+2]=f,this.uint16[v+3]=g,r}}Ja.prototype.bytesPerElement=8,ai(Ja,"StructArrayLayout4ui8");class am extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g,v){const x=this.length;return this.resize(x+1),this.emplace(x,r,a,u,f,g,v)}emplace(r,a,u,f,g,v,x){const S=6*r;return this.int16[S+0]=a,this.int16[S+1]=u,this.int16[S+2]=f,this.int16[S+3]=g,this.int16[S+4]=v,this.int16[S+5]=x,r}}am.prototype.bytesPerElement=12,ai(am,"StructArrayLayout6i12");class zp extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g,v,x,S,T,D,O,z){const $=this.length;return this.resize($+1),this.emplace($,r,a,u,f,g,v,x,S,T,D,O,z)}emplace(r,a,u,f,g,v,x,S,T,D,O,z,$){const K=12*r;return this.int16[K+0]=a,this.int16[K+1]=u,this.int16[K+2]=f,this.int16[K+3]=g,this.uint16[K+4]=v,this.uint16[K+5]=x,this.uint16[K+6]=S,this.uint16[K+7]=T,this.int16[K+8]=D,this.int16[K+9]=O,this.int16[K+10]=z,this.int16[K+11]=$,r}}zp.prototype.bytesPerElement=24,ai(zp,"StructArrayLayout4i4ui4i24");class p_ extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g,v){const x=this.length;return this.resize(x+1),this.emplace(x,r,a,u,f,g,v)}emplace(r,a,u,f,g,v,x){const S=10*r,T=5*r;return this.int16[S+0]=a,this.int16[S+1]=u,this.int16[S+2]=f,this.float32[T+2]=g,this.float32[T+3]=v,this.float32[T+4]=x,r}}p_.prototype.bytesPerElement=20,ai(p_,"StructArrayLayout3i3f20");class La extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint32[1*r+0]=a,r}}La.prototype.bytesPerElement=4,ai(La,"StructArrayLayout1ul4");class fu extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a){const u=this.length;return this.resize(u+1),this.emplace(u,r,a)}emplace(r,a,u){const f=2*r;return this.uint16[f+0]=a,this.uint16[f+1]=u,r}}fu.prototype.bytesPerElement=4,ai(fu,"StructArrayLayout2ui4");class g_ extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g,v,x,S,T,D,O,z,$){const K=this.length;return this.resize(K+1),this.emplace(K,r,a,u,f,g,v,x,S,T,D,O,z,$)}emplace(r,a,u,f,g,v,x,S,T,D,O,z,$,K){const X=20*r,ie=10*r;return this.int16[X+0]=a,this.int16[X+1]=u,this.int16[X+2]=f,this.int16[X+3]=g,this.int16[X+4]=v,this.float32[ie+3]=x,this.float32[ie+4]=S,this.float32[ie+5]=T,this.float32[ie+6]=D,this.int16[X+14]=O,this.uint32[ie+8]=z,this.uint16[X+18]=$,this.uint16[X+19]=K,r}}g_.prototype.bytesPerElement=40,ai(g_,"StructArrayLayout5i4f1i1ul2ui40");class jA extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,r,a,u,f,g,v,x)}emplace(r,a,u,f,g,v,x,S){const T=8*r;return this.int16[T+0]=a,this.int16[T+1]=u,this.int16[T+2]=f,this.int16[T+4]=g,this.int16[T+5]=v,this.int16[T+6]=x,this.int16[T+7]=S,r}}jA.prototype.bytesPerElement=16,ai(jA,"StructArrayLayout3i2i2i16");class Vp extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,u,f,g)}emplace(r,a,u,f,g,v){const x=4*r,S=8*r;return this.float32[x+0]=a,this.float32[x+1]=u,this.float32[x+2]=f,this.int16[S+6]=g,this.int16[S+7]=v,r}}Vp.prototype.bytesPerElement=16,ai(Vp,"StructArrayLayout2f1f2i16");class lm extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,u,f)}emplace(r,a,u,f,g){const v=12*r,x=3*r;return this.uint8[v+0]=a,this.uint8[v+1]=u,this.float32[x+1]=f,this.float32[x+2]=g,r}}lm.prototype.bytesPerElement=12,ai(lm,"StructArrayLayout2ub2f12");class el extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,r,a,u)}emplace(r,a,u,f){const g=3*r;return this.uint16[g+0]=a,this.uint16[g+1]=u,this.uint16[g+2]=f,r}}el.prototype.bytesPerElement=6,ai(el,"StructArrayLayout3ui6");class Ir extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie,ae,be,Ce,Ee,Le){const Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie,ae,be,Ce,Ee,Le)}emplace(r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie,ae,be,Ce,Ee,Le,Oe){const qe=30*r,rt=15*r,ht=60*r;return this.int16[qe+0]=a,this.int16[qe+1]=u,this.int16[qe+2]=f,this.float32[rt+2]=g,this.float32[rt+3]=v,this.uint16[qe+8]=x,this.uint16[qe+9]=S,this.uint32[rt+5]=T,this.uint32[rt+6]=D,this.uint32[rt+7]=O,this.uint16[qe+16]=z,this.uint16[qe+17]=$,this.uint16[qe+18]=K,this.float32[rt+10]=X,this.float32[rt+11]=ie,this.uint8[ht+48]=ae,this.uint8[ht+49]=be,this.uint8[ht+50]=Ce,this.uint32[rt+13]=Ee,this.int16[qe+28]=Le,this.uint8[ht+58]=Oe,r}}Ir.prototype.bytesPerElement=60,ai(Ir,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Hp extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie,ae,be,Ce,Ee,Le,Oe,qe,rt,ht,It,At,Kt,fn,Ut,Dt,Bt){const an=this.length;return this.resize(an+1),this.emplace(an,r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie,ae,be,Ce,Ee,Le,Oe,qe,rt,ht,It,At,Kt,fn,Ut,Dt,Bt)}emplace(r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie,ae,be,Ce,Ee,Le,Oe,qe,rt,ht,It,At,Kt,fn,Ut,Dt,Bt,an){const Mn=20*r,on=40*r,ri=80*r;return this.float32[Mn+0]=a,this.float32[Mn+1]=u,this.int16[on+4]=f,this.int16[on+5]=g,this.int16[on+6]=v,this.int16[on+7]=x,this.int16[on+8]=S,this.int16[on+9]=T,this.int16[on+10]=D,this.int16[on+11]=O,this.int16[on+12]=z,this.uint16[on+13]=$,this.uint16[on+14]=K,this.uint16[on+15]=X,this.uint16[on+16]=ie,this.uint16[on+17]=ae,this.uint16[on+18]=be,this.uint16[on+19]=Ce,this.uint16[on+20]=Ee,this.uint16[on+21]=Le,this.uint16[on+22]=Oe,this.uint16[on+23]=qe,this.uint16[on+24]=rt,this.uint16[on+25]=ht,this.uint16[on+26]=It,this.uint16[on+27]=At,this.uint32[Mn+14]=Kt,this.float32[Mn+15]=fn,this.float32[Mn+16]=Ut,this.float32[Mn+17]=Dt,this.float32[Mn+18]=Bt,this.uint8[ri+76]=an,r}}Hp.prototype.bytesPerElement=80,ai(Hp,"StructArrayLayout2f9i15ui1ul4f1ub80");class cm extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.float32[1*r+0]=a,r}}cm.prototype.bytesPerElement=4,ai(cm,"StructArrayLayout1f4");class nf extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,r,a,u,f,g)}emplace(r,a,u,f,g,v){const x=5*r;return this.float32[x+0]=a,this.float32[x+1]=u,this.float32[x+2]=f,this.float32[x+3]=g,this.float32[x+4]=v,r}}nf.prototype.bytesPerElement=20,ai(nf,"StructArrayLayout5f20");class um extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,r,a,u,f,g,v,x)}emplace(r,a,u,f,g,v,x,S){const T=7*r;return this.float32[T+0]=a,this.float32[T+1]=u,this.float32[T+2]=f,this.float32[T+3]=g,this.float32[T+4]=v,this.float32[T+5]=x,this.float32[T+6]=S,r}}um.prototype.bytesPerElement=28,ai(um,"StructArrayLayout7f28");class Qp extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,u,f)}emplace(r,a,u,f,g){const v=6*r;return this.uint32[3*r+0]=a,this.uint16[v+2]=u,this.uint16[v+3]=f,this.uint16[v+4]=g,r}}Qp.prototype.bytesPerElement=12,ai(Qp,"StructArrayLayout1ul3ui12");class GA extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint16[1*r+0]=a,r}}GA.prototype.bytesPerElement=2,ai(GA,"StructArrayLayout1ui2");class Au extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,r,a,u)}emplace(r,a,u,f){const g=3*r;return this.float32[g+0]=a,this.float32[g+1]=u,this.float32[g+2]=f,r}}Au.prototype.bytesPerElement=12,ai(Au,"StructArrayLayout3f12");class Ua extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a){const u=this.length;return this.resize(u+1),this.emplace(u,r,a)}emplace(r,a,u){const f=2*r;return this.float32[f+0]=a,this.float32[f+1]=u,r}}Ua.prototype.bytesPerElement=8,ai(Ua,"StructArrayLayout2f8");class Zf extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie){const ae=this.length;return this.resize(ae+1),this.emplace(ae,r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie)}emplace(r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie,ae){const be=16*r;return this.float32[be+0]=a,this.float32[be+1]=u,this.float32[be+2]=f,this.float32[be+3]=g,this.float32[be+4]=v,this.float32[be+5]=x,this.float32[be+6]=S,this.float32[be+7]=T,this.float32[be+8]=D,this.float32[be+9]=O,this.float32[be+10]=z,this.float32[be+11]=$,this.float32[be+12]=K,this.float32[be+13]=X,this.float32[be+14]=ie,this.float32[be+15]=ae,r}}Zf.prototype.bytesPerElement=64,ai(Zf,"StructArrayLayout16f64");class jp extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,f,g,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,r,a,u,f,g,v,x)}emplace(r,a,u,f,g,v,x,S){const T=10*r,D=5*r;return this.uint16[T+0]=a,this.uint16[T+1]=u,this.uint16[T+2]=f,this.uint16[T+3]=g,this.float32[D+2]=v,this.float32[D+3]=x,this.float32[D+4]=S,r}}jp.prototype.bytesPerElement=20,ai(jp,"StructArrayLayout4ui3f20");class m_ extends Bs{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint8[1*r+0]=a,r}}m_.prototype.bytesPerElement=1,ai(m_,"StructArrayLayout1ub1");class __ extends HA{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}__.prototype.size=40;class Qn extends g_{get(r){return new __(this,r)}}ai(Qn,"CollisionBoxArray");class Js extends HA{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}Js.prototype.size=60;class ti extends Ir{get(r){return new Js(this,r)}}ai(ti,"PlacedSymbolArray");class ni extends HA{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(r){this._structArray.uint32[this._pos4+14]=r}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(r){this._structArray.float32[this._pos4+18]=r}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}ni.prototype.size=80;class Dl extends Hp{get(r){return new ni(this,r)}}ai(Dl,"SymbolInstanceArray");class y_ extends cm{getoffsetX(r){return this.float32[1*r+0]}}ai(y_,"GlyphOffsetArray");class vd extends Hs{getx(r){return this.int16[2*r+0]}gety(r){return this.int16[2*r+1]}}ai(vd,"SymbolLineVertexArray");class ph extends HA{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ph.prototype.size=12;class hm extends Qp{get(r){return new ph(this,r)}}ai(hm,"FeatureIndexArray");class rf extends fu{geta_centroid_pos0(r){return this.uint16[2*r+0]}geta_centroid_pos1(r){return this.uint16[2*r+1]}}ai(rf,"FillExtrusionCentroidArray");const Q0=bs([{name:"a_pos",components:2,type:"Int16"}],4),j0=bs([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class zo{constructor(r=[]){this.segments=r}_prepareSegment(r,a,u,f){let g=this.segments[this.segments.length-1];return r>zo.MAX_VERTEX_ARRAY_LENGTH&&$o(`Max vertices per segment is ${zo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!g||g.vertexLength+r>zo.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==f)&&(g={vertexOffset:a,primitiveOffset:u,vertexLength:0,primitiveLength:0},void 0!==f&&(g.sortKey=f),this.segments.push(g)),g}prepareSegment(r,a,u,f){return this._prepareSegment(r,a.length,u.length,f)}get(){return this.segments}destroy(){for(const r of this.segments)for(const a in r.vaos)r.vaos[a].destroy()}static simpleSegment(r,a,u,f){return new zo([{vertexOffset:r,primitiveOffset:a,vertexLength:u,primitiveLength:f,vaos:{},sortKey:0}])}}function pl(o,r){return 256*(o=ir(Math.floor(o),0,255))+ir(Math.floor(r),0,255)}zo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ai(zo,"SegmentVector");const Qh=bs([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),v_=bs([{name:"a_dash",components:4,type:"Uint16"}]);var jh={exports:{}},$A={exports:function(r,a){var u,f,g,v,x,S,T,D;for(f=r.length-(u=3&r.length),g=a,x=3432918353,S=461845907,D=0;D<f;)T=255&r.charCodeAt(D)|(255&r.charCodeAt(++D))<<8|(255&r.charCodeAt(++D))<<16|(255&r.charCodeAt(++D))<<24,++D,g=27492+(65535&(v=5*(65535&(g=(g^=T=(65535&(T=(T=(65535&T)*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*S+(((T>>>16)*S&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(T=0,u){case 3:T^=(255&r.charCodeAt(D+2))<<16;case 2:T^=(255&r.charCodeAt(D+1))<<8;case 1:g^=T=(65535&(T=(T=(65535&(T^=255&r.charCodeAt(D)))*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*S+(((T>>>16)*S&65535)<<16)&4294967295}return g^=r.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}}.exports,qA={exports:{}};qA.exports=function(r,a){for(var u,f=r.length,g=a^f,v=0;f>=4;)u=1540483477*(65535&(u=255&r.charCodeAt(v)|(255&r.charCodeAt(++v))<<8|(255&r.charCodeAt(++v))<<16|(255&r.charCodeAt(++v))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++v;switch(f){case 3:g^=(255&r.charCodeAt(v+2))<<16;case 2:g^=(255&r.charCodeAt(v+1))<<8;case 1:g=1540483477*(65535&(g^=255&r.charCodeAt(v)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var G0=$A,b_=qA.exports;jh.exports=G0,jh.exports.murmur3=G0,jh.exports.murmur2=b_;var Xf=Ta(jh.exports);class sf{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(r,a,u,f){this.ids.push(dm(r)),this.positions.push(a,u,f)}eachPosition(r,a){const u=dm(r);let f=0,g=this.ids.length-1;for(;f<g;){const v=f+g>>1;this.ids[v]>=u?g=v:f=v+1}for(;this.ids[f]===u;)a(this.positions[3*f],this.positions[3*f+1],this.positions[3*f+2]),f++}static serialize(r,a){const u=new Float64Array(r.ids),f=new Uint32Array(r.positions);return KA(u,f,0,u.length-1),a&&(a.add(u.buffer),a.add(f.buffer)),{ids:u,positions:f}}static deserialize(r){const a=new sf;let u;a.ids=r.ids,a.positions=r.positions;for(const f of a.ids)f!==u&&a.uniqueIds.push(f),u=f;return a.indexed=!0,a}}function dm(o){const r=+o;return!isNaN(r)&&Number.MIN_SAFE_INTEGER<=r&&r<=Number.MAX_SAFE_INTEGER?r:Xf(String(o))}function KA(o,r,a,u){for(;a<u;){const f=o[a+u>>1];let g=a-1,v=u+1;for(;;){do{g++}while(o[g]<f);do{v--}while(o[v]>f);if(g>=v)break;fm(o,g,v),fm(r,3*g,3*v),fm(r,3*g+1,3*v+1),fm(r,3*g+2,3*v+2)}v-a<u-v?(KA(o,r,a,v),a=v+1):(KA(o,r,v+1,u),u=v)}}function fm(o,r,a){const u=o[r];o[r]=o[a],o[a]=u}ai(sf,"FeaturePositionMap");class pu{constructor(r){this.gl=r.gl,this.initialized=!1}fetchUniformLocation(r,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(r,a),this.initialized=!0),!!this.location}}class Yf extends pu{constructor(r){super(r),this.current=0}set(r,a,u){this.fetchUniformLocation(r,a)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class Bl extends pu{constructor(r){super(r),this.current=0}set(r,a,u){this.fetchUniformLocation(r,a)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class bd extends pu{constructor(r){super(r),this.current=[0,0]}set(r,a,u){this.fetchUniformLocation(r,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class w_ extends pu{constructor(r){super(r),this.current=[0,0,0]}set(r,a,u){this.fetchUniformLocation(r,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class _ extends pu{constructor(r){super(r),this.current=[0,0,0,0]}set(r,a,u){this.fetchUniformLocation(r,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class c extends pu{constructor(r){super(r),this.current=so.transparent}set(r,a,u){this.fetchUniformLocation(r,a)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const d=new Float32Array(16);class y extends pu{constructor(r){super(r),this.current=d}set(r,a,u){if(this.fetchUniformLocation(r,a)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let f=1;f<16;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const w=new Float32Array(9),C=new Float32Array(4);class I extends pu{constructor(r){super(r),this.current=C}set(r,a,u){if(this.fetchUniformLocation(r,a))for(let f=0;f<4;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}function B(o){return[pl(255*o.r,255*o.g),pl(255*o.b,255*o.a)]}class P{constructor(r,a,u){this.value=r,this.uniformNames=a.map(f=>`u_${f}`),this.type=u}setUniform(r,a,u,f,g){a.set(r,g,f.constantOr(this.value))}getBinding(r,a){return"color"===this.type?new c(r):new Bl(r)}}class Q{constructor(r,a){this.uniformNames=a.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(r){this.pixelRatio=r.pixelRatio||1,this.pattern=r.tl.concat(r.br)}setUniform(r,a,u,f,g){const v="u_pattern"===g||"u_dash"===g?this.pattern:"u_pixel_ratio"===g?this.pixelRatio:null;v&&a.set(r,g,v)}getBinding(r,a){return"u_pattern"===a||"u_dash"===a?new _(r):new Bl(r)}}class j{constructor(r,a,u,f){this.expression=r,this.type=u,this.maxValue=0,this.paintVertexAttributes=a.map(g=>({name:`a_${g}`,type:"Float32",components:"color"===u?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(r,a,u,f,g,v,x){const S=this.paintVertexArray.length,T=this.expression.evaluate(new uo(0,{brightness:v}),a,{},g,f,x);this.paintVertexArray.resize(r),this._setPaintValue(S,r,T)}updatePaintArray(r,a,u,f,g,v,x){const S=this.expression.evaluate({zoom:0,brightness:x},u,f,void 0,g);this._setPaintValue(r,a,S)}_setPaintValue(r,a,u){if("color"===this.type){const f=B(u);for(let g=r;g<a;g++)this.paintVertexArray.emplace(g,f[0],f[1])}else{for(let f=r;f<a;f++)this.paintVertexArray.emplace(f,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class q{constructor(r,a,u,f,g,v){this.expression=r,this.uniformNames=a.map(x=>`u_${x}_t`),this.type=u,this.useIntegerZoom=f,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=a.map(x=>({name:`a_${x}`,type:"Float32",components:"color"===u?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(r,a,u,f,g,v,x){const S=this.expression.evaluate(new uo(this.zoom,{brightness:v}),a,{},g,f,x),T=this.expression.evaluate(new uo(this.zoom+1,{brightness:v}),a,{},g,f,x),D=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(D,r,S,T)}updatePaintArray(r,a,u,f,g,v,x){const S=this.expression.evaluate({zoom:this.zoom,brightness:x},u,f,void 0,g),T=this.expression.evaluate({zoom:this.zoom+1,brightness:x},u,f,void 0,g);this._setPaintValue(r,a,S,T)}_setPaintValue(r,a,u,f){if("color"===this.type){const g=B(u),v=B(f);for(let x=r;x<a;x++)this.paintVertexArray.emplace(x,g[0],g[1],v[0],v[1])}else{for(let g=r;g<a;g++)this.paintVertexArray.emplace(g,u,f);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(f))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,a,u,f,g){const v=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,x=ir(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);a.set(r,g,x)}getBinding(r,a){return new Bl(r)}}class J{constructor(r,a,u,f,g){this.expression=r,this.layerId=g,this.paintVertexAttributes=("array"===u?v_:Qh).members;for(let v=0;v<a.length;++v);this.paintVertexArray=new f}populatePaintArray(r,a,u){const f=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValues(f,r,a.patterns&&a.patterns[this.layerId],u)}updatePaintArray(r,a,u,f,g,v,x){this._setPaintValues(r,a,u.patterns&&u.patterns[this.layerId],v)}_setPaintValues(r,a,u,f){if(!f||!u)return;const g=f[u];if(!g)return;const{tl:v,br:x,pixelRatio:S}=g;for(let T=r;T<a;T++)this.paintVertexArray.emplace(T,v[0],v[1],x[0],x[1],S)}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class te{constructor(r,a,u=(()=>!0)){this.binders={},this._buffers=[];const f=[];for(const g in r.paint._values){const v=r.paint.get(g);if(!u(g)||!(v instanceof Pp&&Ya(v.property.specification)))continue;const x=Ae(g,r.type),S=v.value,T=v.property.specification.type,D=!!v.property.useIntegerZoom,O="line-dasharray"===g||g.endsWith("pattern"),z="line-dasharray"===g&&"constant"!==r.layout.get("line-cap").value.kind;if("constant"!==S.kind||z)if("source"===S.kind||z||O){const $=Ie(g,T,"source");this.binders[g]=O?new J(S,x,T,$,r.id):new j(S,x,T,$),f.push(`/a_${g}`)}else{const $=Ie(g,T,"composite");this.binders[g]=new q(S,x,T,D,a,$),f.push(`/z_${g}`)}else this.binders[g]=O?new Q(S.value,x):new P(S.value,x,T),f.push(`/u_${g}`)}this.cacheKey=f.sort().join("")}getMaxValue(r){const a=this.binders[r];return a instanceof j||a instanceof q?a.maxValue:0}populatePaintArrays(r,a,u,f,g,v,x){for(const S in this.binders){const T=this.binders[S];(T instanceof j||T instanceof q||T instanceof J)&&T.populatePaintArray(r,a,u,f,g,v,x)}}setConstantPatternPositions(r){for(const a in this.binders){const u=this.binders[a];u instanceof Q&&u.setConstantPatternPositions(r)}}updatePaintArrays(r,a,u,f,g,v,x,S){let T=!1;const D=Object.keys(r),O=0!==D.length,z=O?D:a.uniqueIds;for(const $ in this.binders){const K=this.binders[$];if((K instanceof j||K instanceof q||K instanceof J)&&(!0===K.expression.isStateDependent||!1===K.expression.isLightConstant)){const X=g.paint.get($);K.expression=X.value;for(const ie of z){const ae=r[ie.toString()];a.eachPosition(ie,(be,Ce,Ee)=>{const Le=f.feature(be);K.updatePaintArray(Ce,Ee,Le,ae,v,x,S)})}if(!O)for(const ie of u.uniqueIds){const ae=r[ie.toString()];u.eachPosition(ie,(be,Ce,Ee)=>{const Le=f.feature(be);K.updatePaintArray(Ce,Ee,Le,ae,v,x,S)})}T=!0}}return T}defines(){const r=[];for(const a in this.binders){const u=this.binders[a];(u instanceof P||u instanceof Q)&&r.push(...u.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return r}getBinderAttributes(){const r=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof j||u instanceof q||u instanceof J)for(let f=0;f<u.paintVertexAttributes.length;f++)r.push(u.paintVertexAttributes[f].name)}return r}getBinderUniforms(){const r=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof P||u instanceof Q||u instanceof q)for(const f of u.uniformNames)r.push(f)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r){const a=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof P||f instanceof Q||f instanceof q)for(const g of f.uniformNames)a.push({name:g,property:u,binding:f.getBinding(r,g)})}return a}setUniforms(r,a,u,f,g){for(const{name:v,property:x,binding:S}of u)this.binders[x].setUniform(r,S,g,f.get(x),v)}updatePaintBuffers(){this._buffers=[];for(const r in this.binders){const a=this.binders[r];(a instanceof j||a instanceof q||a instanceof J)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(r){for(const a in this.binders){const u=this.binders[a];(u instanceof j||u instanceof q||u instanceof J)&&u.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const a=this.binders[r];(a instanceof j||a instanceof q||a instanceof J)&&a.destroy()}}}class le{constructor(r,a,u=(()=>!0)){this.programConfigurations={};for(const f of r)this.programConfigurations[f.id]=new te(f,a,u);this.needsUpload=!1,this._featureMap=new sf,this._featureMapWithoutIds=new sf,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(r,a,u,f,g,v,x,S){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(r,a,f,g,v,x,S);void 0!==a.id?this._featureMap.add(a.id,u,this._bufferOffset,r):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,r),this._idlessCounter+=1),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,a,u,f,g,v){for(const x of u)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(r,this._featureMap,this._featureMapWithoutIds,a,x,f,g,v||0)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const ce={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Ae(o,r){return ce[o]||[o.replace(`${r}-`,"").replace(/-/g,"_")]}const se={"line-pattern":{source:Qc,composite:Qc},"fill-pattern":{source:Qc,composite:Qc},"fill-extrusion-pattern":{source:Qc,composite:Qc},"line-dasharray":{source:Ja,composite:Ja}},me={color:{source:Ua,composite:Hh},number:{source:cm,composite:Ua}};function Ie(o,r,a){const u=se[o];return u&&u[a]||me[r][a]}ai(P,"ConstantBinder"),ai(Q,"PatternConstantBinder"),ai(j,"SourceExpressionBinder"),ai(J,"PatternCompositeBinder"),ai(q,"CompositeExpressionBinder"),ai(te,"ProgramConfiguration",{omit:["_buffers"]}),ai(le,"ProgramConfigurationSet");const xe=Jn/Math.PI/2,Be=5,ge=6,Me=16383,Ge=[64,32,16],nt=-xe,dt=xe;function ot(o,r,a,u=xe){return a=Sr(a),[o*Math.sin(a)*u,-r*u,o*Math.cos(a)*u]}function Pt(o,r,a){return ot(Math.cos(Sr(o)),Math.sin(Sr(o)),r,a)}const Rt=6371008.8,cn=2*Math.PI*Rt;class ct{constructor(r,a){if(isNaN(r)||isNaN(a))throw new Error(`Invalid LngLat object: (${r}, ${a})`);if(this.lng=+r,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ct(Xu(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const a=Math.PI/180,u=this.lat*a,f=r.lat*a,g=Math.sin(u)*Math.sin(f)+Math.cos(u)*Math.cos(f)*Math.cos((r.lng-this.lng)*a);return Rt*Math.acos(Math.min(g,1))}toBounds(r=0){const a=360*r/40075017,u=a/Math.cos(Math.PI/180*this.lat);return new St({lng:this.lng-u,lat:this.lat-a},{lng:this.lng+u,lat:this.lat+a})}toEcef(r){return Pt(this.lat,this.lng,xe+r*xe/Rt)}static convert(r){if(r instanceof ct)return r;if(Array.isArray(r)&&(2===r.length||3===r.length))return new ct(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&"object"==typeof r&&null!==r)return new ct(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class St{constructor(r,a){r&&(a?this.setSouthWest(r).setNorthEast(a):4===r.length?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}setNorthEast(r){return this._ne=r instanceof ct?new ct(r.lng,r.lat):ct.convert(r),this}setSouthWest(r){return this._sw=r instanceof ct?new ct(r.lng,r.lat):ct.convert(r),this}extend(r){const a=this._sw,u=this._ne;let f,g;if(r instanceof ct)f=r,g=r;else{if(!(r instanceof St))return Array.isArray(r)?4===r.length||r.every(Array.isArray)?this.extend(St.convert(r)):this.extend(ct.convert(r)):"object"==typeof r&&null!==r&&r.hasOwnProperty("lat")&&(r.hasOwnProperty("lon")||r.hasOwnProperty("lng"))?this.extend(ct.convert(r)):this;if(f=r._sw,g=r._ne,!f||!g)return this}return a||u?(a.lng=Math.min(f.lng,a.lng),a.lat=Math.min(f.lat,a.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new ct(f.lng,f.lat),this._ne=new ct(g.lng,g.lat)),this}getCenter(){return new ct((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ct(this.getWest(),this.getNorth())}getSouthEast(){return new ct(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:a,lat:u}=ct.convert(r);let f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f}static convert(r){return!r||r instanceof St?r:new St(r)}}var Ze={};!function(a){function u(g,v,x){var S=f(256*g,256*(v=Math.pow(2,x)-v-1),x),T=f(256*(g+1),256*(v+1),x);return S[0]+","+S[1]+","+T[0]+","+T[1]}function f(g,v,x){var S=2*Math.PI*6378137/256/Math.pow(2,x);return[g*S-2*Math.PI*6378137/2,v*S-2*Math.PI*6378137/2]}a.getURL=function(g,v,x,S,T,D){return D=D||{},g+"?"+["bbox="+u(x,S,T),"format="+(D.format||"image/png"),"service="+(D.service||"WMS"),"version="+(D.version||"1.1.1"),"request="+(D.request||"GetMap"),"srs="+(D.srs||"EPSG:3857"),"width="+(D.width||256),"height="+(D.height||256),"layers="+v].join("&")},a.getTileBBox=u,a.getMercCoords=f,Object.defineProperty(a,"__esModule",{value:!0})}(Ze);var gt=Ze;class An{constructor(r,a,u){this.z=r,this.x=a,this.y=u,this.key=$n(0,r,r,a,u)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,a){const u=gt.getTileBBox(this.x,this.y,this.z),f=function(g,v,x){let S,T="";for(let D=g;D>0;D--)S=1<<D-1,T+=(v&S?1:0)+(x&S?2:0);return T}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===a?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Tn{constructor(r,a){this.wrap=r,this.canonical=a,this.key=$n(r,a.z,a.z,a.x,a.y)}}class Cn{constructor(r,a,u,f,g){this.overscaledZ=r,this.wrap=a,this.canonical=new An(u,+f,+g),this.key=0===a&&r===u?this.canonical.key:$n(a,r,u,f,g)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const a=this.canonical.z-r;return r>this.canonical.z?new Cn(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Cn(r,this.wrap,r,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(r,a=!0){if(this.overscaledZ===r&&a)return this.key;if(r>this.canonical.z)return $n(this.wrap*+a,r,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-r;return $n(this.wrap*+a,r,r,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const a=this.canonical.z-r.canonical.z;return 0===r.overscaledZ||r.overscaledZ<this.overscaledZ&&r.canonical.z<this.canonical.z&&r.canonical.x===this.canonical.x>>a&&r.canonical.y===this.canonical.y>>a}children(r){if(this.overscaledZ>=r)return[new Cn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,u=2*this.canonical.x,f=2*this.canonical.y;return[new Cn(a,this.wrap,a,u,f),new Cn(a,this.wrap,a,u+1,f),new Cn(a,this.wrap,a,u,f+1),new Cn(a,this.wrap,a,u+1,f+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Cn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Cn(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Tn(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function $n(o,r,a,u,f){const g=1<<Math.min(a,22);let v=g*(f%g)+u%g;return o&&a<22&&(v+=g*g*((o<0?-2*o-1:2*o)%(1<<2*(22-a)))),16*(32*v+a)+(r-a)}const li=[o=>{let r=o.canonical.x-1,a=o.wrap;return r<0&&(r=(1<<o.canonical.z)-1,a--),new Cn(o.overscaledZ,a,o.canonical.z,r,o.canonical.y)},o=>{let r=o.canonical.x+1,a=o.wrap;return r===1<<o.canonical.z&&(r=0,a++),new Cn(o.overscaledZ,a,o.canonical.z,r,o.canonical.y)},o=>new Cn(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,(0===o.canonical.y?1<<o.canonical.z:o.canonical.y)-1),o=>new Cn(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y===(1<<o.canonical.z)-1?0:o.canonical.y+1)];ai(An,"CanonicalTileID"),ai(Cn,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const xi=0,yi=25.5;function ci(o){return cn*Math.cos(o*Math.PI/180)}function gr(o){return(180+o)/360}function Ki(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function lr(o,r){return o/ci(r)}function rr(o){return 360*o-180}function kr(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function qs(o,r){return o*ci(kr(r))}const Fr=85.051129;function Po(o){return Math.cos(Sr(ir(o,-Fr,Fr)))}function Dr(o,r){const a=ir(r,xi,yi),u=Math.pow(2,a);return Po(o)*cn/(512*u)}function jr(o){return 1/Math.cos(o*Math.PI/180)}function br(o,r=0){const a=Math.exp(Math.PI*(1-(o.y+r/Jn)/(1<<o.z)*2));return 80150034*a/(a*a+1)/Jn/(1<<o.z)}class Xr{constructor(r,a,u=0){this.x=+r,this.y=+a,this.z=+u}static fromLngLat(r,a=0){const u=ct.convert(r);return new Xr(gr(u.lng),Ki(u.lat),lr(a,u.lat))}toLngLat(){return new ct(rr(this.x),kr(this.y))}toAltitude(){return qs(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/cn*jr(kr(this.y))}}function eo(o,r,a,u,f,g,v,x,S){const T=(r+u)/2,D=(a+f)/2,O=new Nn(T,D);x(O),function(z,$,K,X,ie,ae){const be=K-ie,Ce=X-ae;return Math.abs((X-$)*be-(K-z)*Ce)/Math.hypot(be,Ce)}(O.x,O.y,g.x,g.y,v.x,v.y)>=S?(eo(o,r,a,T,D,g,O,x,S),eo(o,T,D,u,f,O,v,x,S)):o.push(v)}function zr(o,r,a){let u=o[0],f=u.x,g=u.y;r(u);const v=[u];for(let x=1;x<o.length;x++){const S=o[x],{x:T,y:D}=S;r(S),eo(v,f,g,T,D,u,S,r,a),f=T,g=D,u=S}return v}function za(o,r,a,u){if(u(r,a)){const f=r.add(a)._mult(.5);za(o,r,f,u),za(o,f,a,u)}else o.push(a)}function gl(o,r){let a=o[0];const u=[a];for(let f=1;f<o.length;f++){const g=o[f];za(u,a,g,r),a=g}return u}const bc=Math.pow(2,14)-1,jc=-bc-1;function Gc(o,r){const a=Math.round(o.x*r),u=Math.round(o.y*r);return o.x=ir(a,jc,bc),o.y=ir(u,jc,bc),(a<o.x||a>o.x+1||u<o.y||u>o.y+1)&&$o("Geometry exceeds allowed extent, reduce your vector tile buffer size"),o}function oo(o,r,a){const u=o.loadGeometry(),f=o.extent,g=Jn/f;if(r&&a&&a.projection.isReprojectedInTileSpace){const v=1<<r.z,{scale:x,x:S,y:T,projection:D}=a,O=z=>{const $=rr((r.x+z.x/f)/v),K=kr((r.y+z.y/f)/v),X=D.project($,K);z.x=(X.x*x-S)*f,z.y=(X.y*x-T)*f};for(let z=0;z<u.length;z++)if(1!==o.type)u[z]=zr(u[z],O,1);else{const $=[];for(const K of u[z])K.x<0||K.x>=f||K.y<0||K.y>=f||(O(K),$.push(K));u[z]=$}}for(const v of u)for(const x of v)Gc(x,g);return u}function fa(o,r){return{type:o.type,id:o.id,properties:o.properties,geometry:r?oo(o):[]}}function Ms(o,r,a,u,f){o.emplaceBack(2*r+(u+1)/2,2*a+(f+1)/2)}function ml(o,r,a){o.emplaceBack(r.x,r.y,r.z,16384*a[0],16384*a[1],16384*a[2])}class $c{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=r.index,this.hasPattern=!1,this.projection=r.projection,this.layoutVertexArray=new Hs,this.indexArray=new el,this.segments=new zo,this.programConfigurations=new le(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,u,f){const g=this.layers[0],v=[];let x=null;"circle"===g.type&&(x=g.layout.get("circle-sort-key"));for(const{feature:T,id:D,index:O,sourceLayerIndex:z}of r){const $=this.layers[0]._featureFilter.needGeometry,K=fa(T,$);if(!this.layers[0]._featureFilter.filter(new uo(this.zoom),K,u))continue;const X=x?x.evaluate(K,{},u):void 0,ie={id:D,properties:T.properties,type:T.type,sourceLayerIndex:z,index:O,geometry:$?K.geometry:oo(T,u,f),patterns:{},sortKey:X};v.push(ie)}x&&v.sort((T,D)=>T.sortKey-D.sortKey);let S=null;"globe"===f.projection.name&&(this.globeExtVertexArray=new am,S=f.projection);for(const T of v){const{geometry:D,index:O,sourceLayerIndex:z}=T,$=r[O].feature;this.addFeature(T,D,O,a.availableImages,u,S,a.brightness),a.featureIndex.insert($,D,O,z,this.index)}}update(r,a,u,f,g){const v=0!==Object.keys(r).length;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(r,a,v?this.stateDependentLayers:this.layers,u,f,g)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Q0.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,j0.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(r,a,u,f,g,v,x){for(const S of a)for(const T of S){const D=T.x,O=T.y;if(D<0||D>=Jn||O<0||O>=Jn)continue;if(v){const K=v.projectTilePoint(D,O,g),X=v.upVector(g,D,O),ie=this.globeExtVertexArray;ml(ie,K,X),ml(ie,K,X),ml(ie,K,X),ml(ie,K,X)}const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),$=z.vertexLength;Ms(this.layoutVertexArray,D,O,-1,-1),Ms(this.layoutVertexArray,D,O,1,-1),Ms(this.layoutVertexArray,D,O,1,1),Ms(this.layoutVertexArray,D,O,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+2,$+3),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,{},f,g,x)}}function Si(o,r){for(let a=0;a<o.length;a++)if(Fu(r,o[a]))return!0;for(let a=0;a<r.length;a++)if(Fu(o,r[a]))return!0;return!!Gh(o,r)}function _l(o,r,a){return!!Fu(o,r)||!!Eo(r,o,a)}function wc(o,r){if(1===o.length)return x_(r,o[0]);for(let a=0;a<r.length;a++){const u=r[a];for(let f=0;f<u.length;f++)if(Fu(o,u[f]))return!0}for(let a=0;a<o.length;a++)if(x_(r,o[a]))return!0;for(let a=0;a<r.length;a++)if(Gh(o,r[a]))return!0;return!1}function Va(o,r,a){if(o.length>1){if(Gh(o,r))return!0;for(let u=0;u<r.length;u++)if(Eo(r[u],o,a))return!0}for(let u=0;u<o.length;u++)if(Eo(o[u],r,a))return!0;return!1}function Gh(o,r){if(0===o.length||0===r.length)return!1;for(let a=0;a<o.length-1;a++){const u=o[a],f=o[a+1];for(let g=0;g<r.length-1;g++)if(Ao(u,f,r[g],r[g+1]))return!0}return!1}function Ao(o,r,a,u){return nc(o,a,u)!==nc(r,a,u)&&nc(o,r,a)!==nc(o,r,u)}function Eo(o,r,a){const u=a*a;if(1===r.length)return o.distSqr(r[0])<u;for(let f=1;f<r.length;f++)if(qc(o,r[f-1],r[f])<u)return!0;return!1}function qc(o,r,a){const u=r.distSqr(a);if(0===u)return o.distSqr(r);const f=((o.x-r.x)*(a.x-r.x)+(o.y-r.y)*(a.y-r.y))/u;return o.distSqr(f<0?r:f>1?a:a.sub(r)._mult(f)._add(r))}function x_(o,r){let a,u,f,g=!1;for(let v=0;v<o.length;v++){a=o[v];for(let x=0,S=a.length-1;x<a.length;S=x++)u=a[x],f=a[S],u.y>r.y!=f.y>r.y&&r.x<(f.x-u.x)*(r.y-u.y)/(f.y-u.y)+u.x&&(g=!g)}return g}function Fu(o,r){let a=!1;for(let u=0,f=o.length-1;u<o.length;f=u++){const g=o[u],v=o[f];g.y>r.y!=v.y>r.y&&r.x<(v.x-g.x)*(r.y-g.y)/(v.y-g.y)+g.x&&(a=!a)}return a}function vC(o,r,a,u,f){for(const v of o)if(r<=v.x&&a<=v.y&&u>=v.x&&f>=v.y)return!0;const g=[new Nn(r,a),new Nn(r,f),new Nn(u,f),new Nn(u,a)];if(o.length>2)for(const v of g)if(Fu(o,v))return!0;for(let v=0;v<o.length-1;v++)if(vv(o[v],o[v+1],g))return!0;return!1}function vv(o,r,a){const u=a[0],f=a[2];if(o.x<u.x&&r.x<u.x||o.x>f.x&&r.x>f.x||o.y<u.y&&r.y<u.y||o.y>f.y&&r.y>f.y)return!1;const g=nc(o,r,a[0]);return g!==nc(o,r,a[1])||g!==nc(o,r,a[2])||g!==nc(o,r,a[3])}function C_(o,r,a,u,f,g){let v=r.y-o.y,x=o.x-r.x;if(g=g||0){const S=v*v+x*x;if(0===S)return!0;const T=Math.sqrt(S);v/=T,x/=T}return!((a.x-o.x)*v+(a.y-o.y)*x-g<0||(u.x-o.x)*v+(u.y-o.y)*x-g<0||(f.x-o.x)*v+(f.y-o.y)*x-g<0)}function _b(o,r,a,u,f,g,v){return!(C_(o,r,u,f,g,v)||C_(r,a,u,f,g,v)||C_(a,o,u,f,g,v)||C_(u,f,o,r,a,v)||C_(f,g,o,r,a,v)||C_(g,u,o,r,a,v))}function Am(o,r,a){const u=r.paint.get(o).value;return"constant"===u.kind?u.value:a.programConfigurations.get(r.id).getMaxValue(o)}function bv(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function WA(o,r,a,u,f){if(!r[0]&&!r[1])return o;const g=Nn.convert(r)._mult(f);"viewport"===a&&g._rotate(-u);const v=[];for(let x=0;x<o.length;x++)v.push(o[x].sub(g));return v}function yb(o,r,a,u){const f=Nn.convert(o)._mult(u);return"viewport"===r&&f._rotate(-a),f}ai($c,"CircleBucket",{omit:["layers"]});const vb=new ko({"circle-sort-key":new wi(bt.layout_circle["circle-sort-key"]),visibility:new Rn(bt.layout_circle.visibility)});var Ml={paint:new ko({"circle-radius":new wi(bt.paint_circle["circle-radius"]),"circle-color":new wi(bt.paint_circle["circle-color"]),"circle-blur":new wi(bt.paint_circle["circle-blur"]),"circle-opacity":new wi(bt.paint_circle["circle-opacity"]),"circle-translate":new Rn(bt.paint_circle["circle-translate"]),"circle-translate-anchor":new Rn(bt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Rn(bt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Rn(bt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new wi(bt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new wi(bt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new wi(bt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Rn(bt.paint_circle["circle-emissive-strength"])}),layout:vb},Ha={},Aa={};Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.setMatrixArrayType=function(o){Aa.ARRAY_TYPE=Ru=o},Aa.toRadian=function(o){return o*wb},Aa.equals=function(o,r){return Math.abs(o-r)<=bb*Math.max(1,Math.abs(o),Math.abs(r))},Aa.RANDOM=Aa.ARRAY_TYPE=Aa.EPSILON=void 0;var bb=1e-6;Aa.EPSILON=bb;var Ru=typeof Float32Array<"u"?Float32Array:Array;Aa.ARRAY_TYPE=Ru;var pm=Math.random;Aa.RANDOM=pm;var wb=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var o=0,r=arguments.length;r--;)o+=arguments[r]*arguments[r];return Math.sqrt(o)});var mo={};function af(o){return(af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(o)}Object.defineProperty(mo,"__esModule",{value:!0}),mo.create=function(){var o=new Kl.ARRAY_TYPE(4);return Kl.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0),o[0]=1,o[3]=1,o},mo.clone=function(o){var r=new Kl.ARRAY_TYPE(4);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r},mo.copy=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o},mo.identity=function(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=1,o},mo.fromValues=function(o,r,a,u){var f=new Kl.ARRAY_TYPE(4);return f[0]=o,f[1]=r,f[2]=a,f[3]=u,f},mo.set=function(o,r,a,u,f){return o[0]=r,o[1]=a,o[2]=u,o[3]=f,o},mo.transpose=function(o,r){if(o===r){var a=r[1];o[1]=r[2],o[2]=a}else o[0]=r[0],o[1]=r[2],o[2]=r[1],o[3]=r[3];return o},mo.invert=function(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=a*g-f*u;return v?(o[0]=g*(v=1/v),o[1]=-u*v,o[2]=-f*v,o[3]=a*v,o):null},mo.adjoint=function(o,r){var a=r[0];return o[0]=r[3],o[1]=-r[1],o[2]=-r[2],o[3]=a,o},mo.determinant=function(o){return o[0]*o[3]-o[2]*o[1]},mo.multiply=E_,mo.rotate=function(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=Math.sin(a),S=Math.cos(a);return o[0]=u*S+g*x,o[1]=f*S+v*x,o[2]=u*-x+g*S,o[3]=f*-x+v*S,o},mo.scale=function(o,r,a){var u=r[1],f=r[2],g=r[3],v=a[0],x=a[1];return o[0]=r[0]*v,o[1]=u*v,o[2]=f*x,o[3]=g*x,o},mo.fromRotation=function(o,r){var a=Math.sin(r),u=Math.cos(r);return o[0]=u,o[1]=a,o[2]=-a,o[3]=u,o},mo.fromScaling=function(o,r){return o[0]=r[0],o[1]=0,o[2]=0,o[3]=r[1],o},mo.str=function(o){return"mat2("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"},mo.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3])},mo.LDU=function(o,r,a,u){return o[2]=u[2]/u[0],a[0]=u[0],a[1]=u[1],a[3]=u[3]-o[2]*a[1],[o,r,a]},mo.add=function(o,r,a){return o[0]=r[0]+a[0],o[1]=r[1]+a[1],o[2]=r[2]+a[2],o[3]=r[3]+a[3],o},mo.subtract=bC,mo.exactEquals=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]},mo.equals=function(o,r){var a=o[0],u=o[1],f=o[2],g=o[3],v=r[0],x=r[1],S=r[2],T=r[3];return Math.abs(a-v)<=Kl.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(u-x)<=Kl.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(f-S)<=Kl.EPSILON*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(g-T)<=Kl.EPSILON*Math.max(1,Math.abs(g),Math.abs(T))},mo.multiplyScalar=function(o,r,a){return o[0]=r[0]*a,o[1]=r[1]*a,o[2]=r[2]*a,o[3]=r[3]*a,o},mo.multiplyScalarAndAdd=function(o,r,a,u){return o[0]=r[0]+a[0]*u,o[1]=r[1]+a[1]*u,o[2]=r[2]+a[2]*u,o[3]=r[3]+a[3]*u,o},mo.sub=mo.mul=void 0;var Kl=function(o,r){if(o&&o.__esModule)return o;if(null===o||"object"!==af(o)&&"function"!=typeof o)return{default:o};var a=xb(void 0);if(a&&a.has(o))return a.get(o);var u={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in o)if("default"!==g&&Object.prototype.hasOwnProperty.call(o,g)){var v=f?Object.getOwnPropertyDescriptor(o,g):null;v&&(v.get||v.set)?Object.defineProperty(u,g,v):u[g]=o[g]}return u.default=o,a&&a.set(o,u),u}(Aa);function xb(o){if("function"!=typeof WeakMap)return null;var r=new WeakMap,a=new WeakMap;return(xb=function(u){return u?a:r})(o)}function E_(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=a[0],S=a[1],T=a[2],D=a[3];return o[0]=u*x+g*S,o[1]=f*x+v*S,o[2]=u*T+g*D,o[3]=f*T+v*D,o}function bC(o,r,a){return o[0]=r[0]-a[0],o[1]=r[1]-a[1],o[2]=r[2]-a[2],o[3]=r[3]-a[3],o}mo.mul=E_,mo.sub=bC;var ks={};function Gp(o){return(Gp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(o)}Object.defineProperty(ks,"__esModule",{value:!0}),ks.create=function(){var o=new Fl.ARRAY_TYPE(6);return Fl.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0,o[4]=0,o[5]=0),o[0]=1,o[3]=1,o},ks.clone=function(o){var r=new Fl.ARRAY_TYPE(6);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r},ks.copy=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o},ks.identity=function(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=1,o[4]=0,o[5]=0,o},ks.fromValues=function(o,r,a,u,f,g){var v=new Fl.ARRAY_TYPE(6);return v[0]=o,v[1]=r,v[2]=a,v[3]=u,v[4]=f,v[5]=g,v},ks.set=function(o,r,a,u,f,g,v){return o[0]=r,o[1]=a,o[2]=u,o[3]=f,o[4]=g,o[5]=v,o},ks.invert=function(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=r[4],x=r[5],S=a*g-u*f;return S?(o[0]=g*(S=1/S),o[1]=-u*S,o[2]=-f*S,o[3]=a*S,o[4]=(f*x-g*v)*S,o[5]=(u*v-a*x)*S,o):null},ks.determinant=function(o){return o[0]*o[3]-o[1]*o[2]},ks.multiply=wv,ks.rotate=function(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=r[4],S=r[5],T=Math.sin(a),D=Math.cos(a);return o[0]=u*D+g*T,o[1]=f*D+v*T,o[2]=u*-T+g*D,o[3]=f*-T+v*D,o[4]=x,o[5]=S,o},ks.scale=function(o,r,a){var u=r[1],f=r[2],g=r[3],v=r[4],x=r[5],S=a[0],T=a[1];return o[0]=r[0]*S,o[1]=u*S,o[2]=f*T,o[3]=g*T,o[4]=v,o[5]=x,o},ks.translate=function(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=r[4],S=r[5],T=a[0],D=a[1];return o[0]=u,o[1]=f,o[2]=g,o[3]=v,o[4]=u*T+g*D+x,o[5]=f*T+v*D+S,o},ks.fromRotation=function(o,r){var a=Math.sin(r),u=Math.cos(r);return o[0]=u,o[1]=a,o[2]=-a,o[3]=u,o[4]=0,o[5]=0,o},ks.fromScaling=function(o,r){return o[0]=r[0],o[1]=0,o[2]=0,o[3]=r[1],o[4]=0,o[5]=0,o},ks.fromTranslation=function(o,r){return o[0]=1,o[1]=0,o[2]=0,o[3]=1,o[4]=r[0],o[5]=r[1],o},ks.str=function(o){return"mat2d("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+")"},ks.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3],o[4],o[5],1)},ks.add=function(o,r,a){return o[0]=r[0]+a[0],o[1]=r[1]+a[1],o[2]=r[2]+a[2],o[3]=r[3]+a[3],o[4]=r[4]+a[4],o[5]=r[5]+a[5],o},ks.subtract=$p,ks.multiplyScalar=function(o,r,a){return o[0]=r[0]*a,o[1]=r[1]*a,o[2]=r[2]*a,o[3]=r[3]*a,o[4]=r[4]*a,o[5]=r[5]*a,o},ks.multiplyScalarAndAdd=function(o,r,a,u){return o[0]=r[0]+a[0]*u,o[1]=r[1]+a[1]*u,o[2]=r[2]+a[2]*u,o[3]=r[3]+a[3]*u,o[4]=r[4]+a[4]*u,o[5]=r[5]+a[5]*u,o},ks.exactEquals=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]&&o[4]===r[4]&&o[5]===r[5]},ks.equals=function(o,r){var a=o[0],u=o[1],f=o[2],g=o[3],v=o[4],x=o[5],S=r[0],T=r[1],D=r[2],O=r[3],z=r[4],$=r[5];return Math.abs(a-S)<=Fl.EPSILON*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(u-T)<=Fl.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(f-D)<=Fl.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(g-O)<=Fl.EPSILON*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(v-z)<=Fl.EPSILON*Math.max(1,Math.abs(v),Math.abs(z))&&Math.abs(x-$)<=Fl.EPSILON*Math.max(1,Math.abs(x),Math.abs($))},ks.sub=ks.mul=void 0;var Fl=function(o,r){if(o&&o.__esModule)return o;if(null===o||"object"!==Gp(o)&&"function"!=typeof o)return{default:o};var a=$0(void 0);if(a&&a.has(o))return a.get(o);var u={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in o)if("default"!==g&&Object.prototype.hasOwnProperty.call(o,g)){var v=f?Object.getOwnPropertyDescriptor(o,g):null;v&&(v.get||v.set)?Object.defineProperty(u,g,v):u[g]=o[g]}return u.default=o,a&&a.set(o,u),u}(Aa);function $0(o){if("function"!=typeof WeakMap)return null;var r=new WeakMap,a=new WeakMap;return($0=function(u){return u?a:r})(o)}function wv(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=r[4],S=r[5],T=a[0],D=a[1],O=a[2],z=a[3],$=a[4],K=a[5];return o[0]=u*T+g*D,o[1]=f*T+v*D,o[2]=u*O+g*z,o[3]=f*O+v*z,o[4]=u*$+g*K+x,o[5]=f*$+v*K+S,o}function $p(o,r,a){return o[0]=r[0]-a[0],o[1]=r[1]-a[1],o[2]=r[2]-a[2],o[3]=r[3]-a[3],o[4]=r[4]-a[4],o[5]=r[5]-a[5],o}ks.mul=wv,ks.sub=$p;var to={};function xv(o){return(xv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(o)}Object.defineProperty(to,"__esModule",{value:!0}),to.create=function(){var o=new Ou.ARRAY_TYPE(9);return Ou.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o},to.fromMat4=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[4],o[4]=r[5],o[5]=r[6],o[6]=r[8],o[7]=r[9],o[8]=r[10],o},to.clone=function(o){var r=new Ou.ARRAY_TYPE(9);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r[6]=o[6],r[7]=o[7],r[8]=o[8],r},to.copy=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o},to.fromValues=function(o,r,a,u,f,g,v,x,S){var T=new Ou.ARRAY_TYPE(9);return T[0]=o,T[1]=r,T[2]=a,T[3]=u,T[4]=f,T[5]=g,T[6]=v,T[7]=x,T[8]=S,T},to.set=function(o,r,a,u,f,g,v,x,S,T){return o[0]=r,o[1]=a,o[2]=u,o[3]=f,o[4]=g,o[5]=v,o[6]=x,o[7]=S,o[8]=T,o},to.identity=function(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=1,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},to.transpose=function(o,r){if(o===r){var a=r[1],u=r[2],f=r[5];o[1]=r[3],o[2]=r[6],o[3]=a,o[5]=r[7],o[6]=u,o[7]=f}else o[0]=r[0],o[1]=r[3],o[2]=r[6],o[3]=r[1],o[4]=r[4],o[5]=r[7],o[6]=r[2],o[7]=r[5],o[8]=r[8];return o},to.invert=function(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=r[4],x=r[5],S=r[6],T=r[7],D=r[8],O=D*v-x*T,z=-D*g+x*S,$=T*g-v*S,K=a*O+u*z+f*$;return K?(o[0]=O*(K=1/K),o[1]=(-D*u+f*T)*K,o[2]=(x*u-f*v)*K,o[3]=z*K,o[4]=(D*a-f*S)*K,o[5]=(-x*a+f*g)*K,o[6]=$*K,o[7]=(-T*a+u*S)*K,o[8]=(v*a-u*g)*K,o):null},to.adjoint=function(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=r[4],x=r[5],S=r[6],T=r[7],D=r[8];return o[0]=v*D-x*T,o[1]=f*T-u*D,o[2]=u*x-f*v,o[3]=x*S-g*D,o[4]=a*D-f*S,o[5]=f*g-a*x,o[6]=g*T-v*S,o[7]=u*S-a*T,o[8]=a*v-u*g,o},to.determinant=function(o){var r=o[3],a=o[4],u=o[5],f=o[6],g=o[7],v=o[8];return o[0]*(v*a-u*g)+o[1]*(-v*r+u*f)+o[2]*(g*r-a*f)},to.multiply=Cv,to.translate=function(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=r[4],S=r[5],T=r[6],D=r[7],O=r[8],z=a[0],$=a[1];return o[0]=u,o[1]=f,o[2]=g,o[3]=v,o[4]=x,o[5]=S,o[6]=z*u+$*v+T,o[7]=z*f+$*x+D,o[8]=z*g+$*S+O,o},to.rotate=function(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=r[4],S=r[5],T=r[6],D=r[7],O=r[8],z=Math.sin(a),$=Math.cos(a);return o[0]=$*u+z*v,o[1]=$*f+z*x,o[2]=$*g+z*S,o[3]=$*v-z*u,o[4]=$*x-z*f,o[5]=$*S-z*g,o[6]=T,o[7]=D,o[8]=O,o},to.scale=function(o,r,a){var u=a[0],f=a[1];return o[0]=u*r[0],o[1]=u*r[1],o[2]=u*r[2],o[3]=f*r[3],o[4]=f*r[4],o[5]=f*r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o},to.fromTranslation=function(o,r){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=1,o[5]=0,o[6]=r[0],o[7]=r[1],o[8]=1,o},to.fromRotation=function(o,r){var a=Math.sin(r),u=Math.cos(r);return o[0]=u,o[1]=a,o[2]=0,o[3]=-a,o[4]=u,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},to.fromScaling=function(o,r){return o[0]=r[0],o[1]=0,o[2]=0,o[3]=0,o[4]=r[1],o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},to.fromMat2d=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=0,o[3]=r[2],o[4]=r[3],o[5]=0,o[6]=r[4],o[7]=r[5],o[8]=1,o},to.fromQuat=function(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=a+a,x=u+u,S=f+f,T=a*v,D=u*v,O=u*x,z=f*v,$=f*x,K=f*S,X=g*v,ie=g*x,ae=g*S;return o[0]=1-O-K,o[3]=D-ae,o[6]=z+ie,o[1]=D+ae,o[4]=1-T-K,o[7]=$-X,o[2]=z-ie,o[5]=$+X,o[8]=1-T-O,o},to.normalFromMat4=function(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=r[4],x=r[5],S=r[6],T=r[7],D=r[8],O=r[9],z=r[10],$=r[11],K=r[12],X=r[13],ie=r[14],ae=r[15],be=a*x-u*v,Ce=a*S-f*v,Ee=a*T-g*v,Le=u*S-f*x,Oe=u*T-g*x,qe=f*T-g*S,rt=D*X-O*K,ht=D*ie-z*K,It=D*ae-$*K,At=O*ie-z*X,Kt=O*ae-$*X,fn=z*ae-$*ie,Ut=be*fn-Ce*Kt+Ee*At+Le*It-Oe*ht+qe*rt;return Ut?(o[0]=(x*fn-S*Kt+T*At)*(Ut=1/Ut),o[1]=(S*It-v*fn-T*ht)*Ut,o[2]=(v*Kt-x*It+T*rt)*Ut,o[3]=(f*Kt-u*fn-g*At)*Ut,o[4]=(a*fn-f*It+g*ht)*Ut,o[5]=(u*It-a*Kt-g*rt)*Ut,o[6]=(X*qe-ie*Oe+ae*Le)*Ut,o[7]=(ie*Ee-K*qe-ae*Ce)*Ut,o[8]=(K*Oe-X*Ee+ae*be)*Ut,o):null},to.projection=function(o,r,a){return o[0]=2/r,o[1]=0,o[2]=0,o[3]=0,o[4]=-2/a,o[5]=0,o[6]=-1,o[7]=1,o[8]=1,o},to.str=function(o){return"mat3("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+", "+o[6]+", "+o[7]+", "+o[8]+")"},to.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8])},to.add=function(o,r,a){return o[0]=r[0]+a[0],o[1]=r[1]+a[1],o[2]=r[2]+a[2],o[3]=r[3]+a[3],o[4]=r[4]+a[4],o[5]=r[5]+a[5],o[6]=r[6]+a[6],o[7]=r[7]+a[7],o[8]=r[8]+a[8],o},to.subtract=q0,to.multiplyScalar=function(o,r,a){return o[0]=r[0]*a,o[1]=r[1]*a,o[2]=r[2]*a,o[3]=r[3]*a,o[4]=r[4]*a,o[5]=r[5]*a,o[6]=r[6]*a,o[7]=r[7]*a,o[8]=r[8]*a,o},to.multiplyScalarAndAdd=function(o,r,a,u){return o[0]=r[0]+a[0]*u,o[1]=r[1]+a[1]*u,o[2]=r[2]+a[2]*u,o[3]=r[3]+a[3]*u,o[4]=r[4]+a[4]*u,o[5]=r[5]+a[5]*u,o[6]=r[6]+a[6]*u,o[7]=r[7]+a[7]*u,o[8]=r[8]+a[8]*u,o},to.exactEquals=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]&&o[4]===r[4]&&o[5]===r[5]&&o[6]===r[6]&&o[7]===r[7]&&o[8]===r[8]},to.equals=function(o,r){var a=o[0],u=o[1],f=o[2],g=o[3],v=o[4],x=o[5],S=o[6],T=o[7],D=o[8],O=r[0],z=r[1],$=r[2],K=r[3],X=r[4],ie=r[5],ae=r[6],be=r[7],Ce=r[8];return Math.abs(a-O)<=Ou.EPSILON*Math.max(1,Math.abs(a),Math.abs(O))&&Math.abs(u-z)<=Ou.EPSILON*Math.max(1,Math.abs(u),Math.abs(z))&&Math.abs(f-$)<=Ou.EPSILON*Math.max(1,Math.abs(f),Math.abs($))&&Math.abs(g-K)<=Ou.EPSILON*Math.max(1,Math.abs(g),Math.abs(K))&&Math.abs(v-X)<=Ou.EPSILON*Math.max(1,Math.abs(v),Math.abs(X))&&Math.abs(x-ie)<=Ou.EPSILON*Math.max(1,Math.abs(x),Math.abs(ie))&&Math.abs(S-ae)<=Ou.EPSILON*Math.max(1,Math.abs(S),Math.abs(ae))&&Math.abs(T-be)<=Ou.EPSILON*Math.max(1,Math.abs(T),Math.abs(be))&&Math.abs(D-Ce)<=Ou.EPSILON*Math.max(1,Math.abs(D),Math.abs(Ce))},to.sub=to.mul=void 0;var Ou=function(o,r){if(o&&o.__esModule)return o;if(null===o||"object"!==xv(o)&&"function"!=typeof o)return{default:o};var a=Cb(void 0);if(a&&a.has(o))return a.get(o);var u={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in o)if("default"!==g&&Object.prototype.hasOwnProperty.call(o,g)){var v=f?Object.getOwnPropertyDescriptor(o,g):null;v&&(v.get||v.set)?Object.defineProperty(u,g,v):u[g]=o[g]}return u.default=o,a&&a.set(o,u),u}(Aa);function Cb(o){if("function"!=typeof WeakMap)return null;var r=new WeakMap,a=new WeakMap;return(Cb=function(u){return u?a:r})(o)}function Cv(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=r[4],S=r[5],T=r[6],D=r[7],O=r[8],z=a[0],$=a[1],K=a[2],X=a[3],ie=a[4],ae=a[5],be=a[6],Ce=a[7],Ee=a[8];return o[0]=z*u+$*v+K*T,o[1]=z*f+$*x+K*D,o[2]=z*g+$*S+K*O,o[3]=X*u+ie*v+ae*T,o[4]=X*f+ie*x+ae*D,o[5]=X*g+ie*S+ae*O,o[6]=be*u+Ce*v+Ee*T,o[7]=be*f+Ce*x+Ee*D,o[8]=be*g+Ce*S+Ee*O,o}function q0(o,r,a){return o[0]=r[0]-a[0],o[1]=r[1]-a[1],o[2]=r[2]-a[2],o[3]=r[3]-a[3],o[4]=r[4]-a[4],o[5]=r[5]-a[5],o[6]=r[6]-a[6],o[7]=r[7]-a[7],o[8]=r[8]-a[8],o}to.mul=Cv,to.sub=q0;var dr={};function Ev(o){return(Ev="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(o)}Object.defineProperty(dr,"__esModule",{value:!0}),dr.create=function(){var o=new Vo.ARRAY_TYPE(16);return Vo.ARRAY_TYPE!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},dr.clone=function(o){var r=new Vo.ARRAY_TYPE(16);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r[6]=o[6],r[7]=o[7],r[8]=o[8],r[9]=o[9],r[10]=o[10],r[11]=o[11],r[12]=o[12],r[13]=o[13],r[14]=o[14],r[15]=o[15],r},dr.copy=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15],o},dr.fromValues=function(o,r,a,u,f,g,v,x,S,T,D,O,z,$,K,X){var ie=new Vo.ARRAY_TYPE(16);return ie[0]=o,ie[1]=r,ie[2]=a,ie[3]=u,ie[4]=f,ie[5]=g,ie[6]=v,ie[7]=x,ie[8]=S,ie[9]=T,ie[10]=D,ie[11]=O,ie[12]=z,ie[13]=$,ie[14]=K,ie[15]=X,ie},dr.set=function(o,r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie){return o[0]=r,o[1]=a,o[2]=u,o[3]=f,o[4]=g,o[5]=v,o[6]=x,o[7]=S,o[8]=T,o[9]=D,o[10]=O,o[11]=z,o[12]=$,o[13]=K,o[14]=X,o[15]=ie,o},dr.identity=S_,dr.transpose=function(o,r){if(o===r){var a=r[1],u=r[2],f=r[3],g=r[6],v=r[7],x=r[11];o[1]=r[4],o[2]=r[8],o[3]=r[12],o[4]=a,o[6]=r[9],o[7]=r[13],o[8]=u,o[9]=g,o[11]=r[14],o[12]=f,o[13]=v,o[14]=x}else o[0]=r[0],o[1]=r[4],o[2]=r[8],o[3]=r[12],o[4]=r[1],o[5]=r[5],o[6]=r[9],o[7]=r[13],o[8]=r[2],o[9]=r[6],o[10]=r[10],o[11]=r[14],o[12]=r[3],o[13]=r[7],o[14]=r[11],o[15]=r[15];return o},dr.invert=function(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=r[4],x=r[5],S=r[6],T=r[7],D=r[8],O=r[9],z=r[10],$=r[11],K=r[12],X=r[13],ie=r[14],ae=r[15],be=a*x-u*v,Ce=a*S-f*v,Ee=a*T-g*v,Le=u*S-f*x,Oe=u*T-g*x,qe=f*T-g*S,rt=D*X-O*K,ht=D*ie-z*K,It=D*ae-$*K,At=O*ie-z*X,Kt=O*ae-$*X,fn=z*ae-$*ie,Ut=be*fn-Ce*Kt+Ee*At+Le*It-Oe*ht+qe*rt;return Ut?(o[0]=(x*fn-S*Kt+T*At)*(Ut=1/Ut),o[1]=(f*Kt-u*fn-g*At)*Ut,o[2]=(X*qe-ie*Oe+ae*Le)*Ut,o[3]=(z*Oe-O*qe-$*Le)*Ut,o[4]=(S*It-v*fn-T*ht)*Ut,o[5]=(a*fn-f*It+g*ht)*Ut,o[6]=(ie*Ee-K*qe-ae*Ce)*Ut,o[7]=(D*qe-z*Ee+$*Ce)*Ut,o[8]=(v*Kt-x*It+T*rt)*Ut,o[9]=(u*It-a*Kt-g*rt)*Ut,o[10]=(K*Oe-X*Ee+ae*be)*Ut,o[11]=(O*Ee-D*Oe-$*be)*Ut,o[12]=(x*ht-v*At-S*rt)*Ut,o[13]=(a*At-u*ht+f*rt)*Ut,o[14]=(X*Ce-K*Le-ie*be)*Ut,o[15]=(D*Le-O*Ce+z*be)*Ut,o):null},dr.adjoint=function(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=r[4],x=r[5],S=r[6],T=r[7],D=r[8],O=r[9],z=r[10],$=r[11],K=r[12],X=r[13],ie=r[14],ae=r[15];return o[0]=x*(z*ae-$*ie)-O*(S*ae-T*ie)+X*(S*$-T*z),o[1]=-(u*(z*ae-$*ie)-O*(f*ae-g*ie)+X*(f*$-g*z)),o[2]=u*(S*ae-T*ie)-x*(f*ae-g*ie)+X*(f*T-g*S),o[3]=-(u*(S*$-T*z)-x*(f*$-g*z)+O*(f*T-g*S)),o[4]=-(v*(z*ae-$*ie)-D*(S*ae-T*ie)+K*(S*$-T*z)),o[5]=a*(z*ae-$*ie)-D*(f*ae-g*ie)+K*(f*$-g*z),o[6]=-(a*(S*ae-T*ie)-v*(f*ae-g*ie)+K*(f*T-g*S)),o[7]=a*(S*$-T*z)-v*(f*$-g*z)+D*(f*T-g*S),o[8]=v*(O*ae-$*X)-D*(x*ae-T*X)+K*(x*$-T*O),o[9]=-(a*(O*ae-$*X)-D*(u*ae-g*X)+K*(u*$-g*O)),o[10]=a*(x*ae-T*X)-v*(u*ae-g*X)+K*(u*T-g*x),o[11]=-(a*(x*$-T*O)-v*(u*$-g*O)+D*(u*T-g*x)),o[12]=-(v*(O*ie-z*X)-D*(x*ie-S*X)+K*(x*z-S*O)),o[13]=a*(O*ie-z*X)-D*(u*ie-f*X)+K*(u*z-f*O),o[14]=-(a*(x*ie-S*X)-v*(u*ie-f*X)+K*(u*S-f*x)),o[15]=a*(x*z-S*O)-v*(u*z-f*O)+D*(u*S-f*x),o},dr.determinant=function(o){var r=o[0],a=o[1],u=o[2],f=o[3],g=o[4],v=o[5],x=o[6],S=o[7],T=o[8],D=o[9],O=o[10],z=o[11],$=o[12],K=o[13],X=o[14],ie=o[15];return(r*v-a*g)*(O*ie-z*X)-(r*x-u*g)*(D*ie-z*K)+(r*S-f*g)*(D*X-O*K)+(a*x-u*v)*(T*ie-z*$)-(a*S-f*v)*(T*X-O*$)+(u*S-f*x)*(T*K-D*$)},dr.multiply=Sb,dr.translate=function(o,r,a){var u,f,g,v,x,S,T,D,O,z,$,K,X=a[0],ie=a[1],ae=a[2];return r===o?(o[12]=r[0]*X+r[4]*ie+r[8]*ae+r[12],o[13]=r[1]*X+r[5]*ie+r[9]*ae+r[13],o[14]=r[2]*X+r[6]*ie+r[10]*ae+r[14],o[15]=r[3]*X+r[7]*ie+r[11]*ae+r[15]):(f=r[1],g=r[2],v=r[3],x=r[4],S=r[5],T=r[6],D=r[7],O=r[8],z=r[9],$=r[10],K=r[11],o[0]=u=r[0],o[1]=f,o[2]=g,o[3]=v,o[4]=x,o[5]=S,o[6]=T,o[7]=D,o[8]=O,o[9]=z,o[10]=$,o[11]=K,o[12]=u*X+x*ie+O*ae+r[12],o[13]=f*X+S*ie+z*ae+r[13],o[14]=g*X+T*ie+$*ae+r[14],o[15]=v*X+D*ie+K*ae+r[15]),o},dr.scale=function(o,r,a){var u=a[0],f=a[1],g=a[2];return o[0]=r[0]*u,o[1]=r[1]*u,o[2]=r[2]*u,o[3]=r[3]*u,o[4]=r[4]*f,o[5]=r[5]*f,o[6]=r[6]*f,o[7]=r[7]*f,o[8]=r[8]*g,o[9]=r[9]*g,o[10]=r[10]*g,o[11]=r[11]*g,o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15],o},dr.rotate=function(o,r,a,u){var f,g,v,x,S,T,D,O,z,$,K,X,ie,ae,be,Ce,Ee,Le,Oe,qe,rt,ht,It,At,Kt=u[0],fn=u[1],Ut=u[2],Dt=Math.hypot(Kt,fn,Ut);return Dt<Vo.EPSILON?null:(Kt*=Dt=1/Dt,fn*=Dt,Ut*=Dt,f=Math.sin(a),g=Math.cos(a),S=r[1],T=r[2],D=r[3],z=r[5],$=r[6],K=r[7],ie=r[9],ae=r[10],be=r[11],Ce=Kt*Kt*(v=1-g)+g,Oe=Kt*fn*v-Ut*f,qe=fn*fn*v+g,rt=Ut*fn*v+Kt*f,ht=Kt*Ut*v+fn*f,It=fn*Ut*v-Kt*f,At=Ut*Ut*v+g,o[0]=(x=r[0])*Ce+(O=r[4])*(Ee=fn*Kt*v+Ut*f)+(X=r[8])*(Le=Ut*Kt*v-fn*f),o[1]=S*Ce+z*Ee+ie*Le,o[2]=T*Ce+$*Ee+ae*Le,o[3]=D*Ce+K*Ee+be*Le,o[4]=x*Oe+O*qe+X*rt,o[5]=S*Oe+z*qe+ie*rt,o[6]=T*Oe+$*qe+ae*rt,o[7]=D*Oe+K*qe+be*rt,o[8]=x*ht+O*It+X*At,o[9]=S*ht+z*It+ie*At,o[10]=T*ht+$*It+ae*At,o[11]=D*ht+K*It+be*At,r!==o&&(o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o)},dr.rotateX=function(o,r,a){var u=Math.sin(a),f=Math.cos(a),g=r[4],v=r[5],x=r[6],S=r[7],T=r[8],D=r[9],O=r[10],z=r[11];return r!==o&&(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[4]=g*f+T*u,o[5]=v*f+D*u,o[6]=x*f+O*u,o[7]=S*f+z*u,o[8]=T*f-g*u,o[9]=D*f-v*u,o[10]=O*f-x*u,o[11]=z*f-S*u,o},dr.rotateY=function(o,r,a){var u=Math.sin(a),f=Math.cos(a),g=r[0],v=r[1],x=r[2],S=r[3],T=r[8],D=r[9],O=r[10],z=r[11];return r!==o&&(o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[0]=g*f-T*u,o[1]=v*f-D*u,o[2]=x*f-O*u,o[3]=S*f-z*u,o[8]=g*u+T*f,o[9]=v*u+D*f,o[10]=x*u+O*f,o[11]=S*u+z*f,o},dr.rotateZ=function(o,r,a){var u=Math.sin(a),f=Math.cos(a),g=r[0],v=r[1],x=r[2],S=r[3],T=r[4],D=r[5],O=r[6],z=r[7];return r!==o&&(o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[0]=g*f+T*u,o[1]=v*f+D*u,o[2]=x*f+O*u,o[3]=S*f+z*u,o[4]=T*f-g*u,o[5]=D*f-v*u,o[6]=O*f-x*u,o[7]=z*f-S*u,o},dr.fromTranslation=function(o,r){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=r[0],o[13]=r[1],o[14]=r[2],o[15]=1,o},dr.fromScaling=function(o,r){return o[0]=r[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=r[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=r[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},dr.fromRotation=function(o,r,a){var u,f,g,v=a[0],x=a[1],S=a[2],T=Math.hypot(v,x,S);return T<Vo.EPSILON?null:(v*=T=1/T,x*=T,S*=T,u=Math.sin(r),f=Math.cos(r),o[0]=v*v*(g=1-f)+f,o[1]=x*v*g+S*u,o[2]=S*v*g-x*u,o[3]=0,o[4]=v*x*g-S*u,o[5]=x*x*g+f,o[6]=S*x*g+v*u,o[7]=0,o[8]=v*S*g+x*u,o[9]=x*S*g-v*u,o[10]=S*S*g+f,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o)},dr.fromXRotation=function(o,r){var a=Math.sin(r),u=Math.cos(r);return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=u,o[6]=a,o[7]=0,o[8]=0,o[9]=-a,o[10]=u,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},dr.fromYRotation=function(o,r){var a=Math.sin(r),u=Math.cos(r);return o[0]=u,o[1]=0,o[2]=-a,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=a,o[9]=0,o[10]=u,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},dr.fromZRotation=function(o,r){var a=Math.sin(r),u=Math.cos(r);return o[0]=u,o[1]=a,o[2]=0,o[3]=0,o[4]=-a,o[5]=u,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},dr.fromRotationTranslation=Sv,dr.fromQuat2=function(o,r){var a=new Vo.ARRAY_TYPE(3),u=-r[0],f=-r[1],g=-r[2],v=r[3],x=r[4],S=r[5],T=r[6],D=r[7],O=u*u+f*f+g*g+v*v;return O>0?(a[0]=2*(x*v+D*u+S*g-T*f)/O,a[1]=2*(S*v+D*f+T*u-x*g)/O,a[2]=2*(T*v+D*g+x*f-S*u)/O):(a[0]=2*(x*v+D*u+S*g-T*f),a[1]=2*(S*v+D*f+T*u-x*g),a[2]=2*(T*v+D*g+x*f-S*u)),Sv(o,r,a),o},dr.getTranslation=function(o,r){return o[0]=r[12],o[1]=r[13],o[2]=r[14],o},dr.getScaling=K0,dr.getRotation=function(o,r){var a=new Vo.ARRAY_TYPE(3);K0(a,r);var u=1/a[0],f=1/a[1],g=1/a[2],v=r[0]*u,x=r[1]*f,S=r[2]*g,T=r[4]*u,D=r[5]*f,O=r[6]*g,z=r[8]*u,$=r[9]*f,K=r[10]*g,X=v+D+K,ie=0;return X>0?(ie=2*Math.sqrt(X+1),o[3]=.25*ie,o[0]=(O-$)/ie,o[1]=(z-S)/ie,o[2]=(x-T)/ie):v>D&&v>K?(ie=2*Math.sqrt(1+v-D-K),o[3]=(O-$)/ie,o[0]=.25*ie,o[1]=(x+T)/ie,o[2]=(z+S)/ie):D>K?(ie=2*Math.sqrt(1+D-v-K),o[3]=(z-S)/ie,o[0]=(x+T)/ie,o[1]=.25*ie,o[2]=(O+$)/ie):(ie=2*Math.sqrt(1+K-v-D),o[3]=(x-T)/ie,o[0]=(z+S)/ie,o[1]=(O+$)/ie,o[2]=.25*ie),o},dr.fromRotationTranslationScale=function(o,r,a,u){var f=r[0],g=r[1],v=r[2],x=r[3],S=f+f,T=g+g,D=v+v,O=f*S,z=f*T,$=f*D,K=g*T,X=g*D,ie=v*D,ae=x*S,be=x*T,Ce=x*D,Ee=u[0],Le=u[1],Oe=u[2];return o[0]=(1-(K+ie))*Ee,o[1]=(z+Ce)*Ee,o[2]=($-be)*Ee,o[3]=0,o[4]=(z-Ce)*Le,o[5]=(1-(O+ie))*Le,o[6]=(X+ae)*Le,o[7]=0,o[8]=($+be)*Oe,o[9]=(X-ae)*Oe,o[10]=(1-(O+K))*Oe,o[11]=0,o[12]=a[0],o[13]=a[1],o[14]=a[2],o[15]=1,o},dr.fromRotationTranslationScaleOrigin=function(o,r,a,u,f){var g=r[0],v=r[1],x=r[2],S=r[3],T=g+g,D=v+v,O=x+x,z=g*T,$=g*D,K=g*O,X=v*D,ie=v*O,ae=x*O,be=S*T,Ce=S*D,Ee=S*O,Le=u[0],Oe=u[1],qe=u[2],rt=f[0],ht=f[1],It=f[2],At=(1-(X+ae))*Le,Kt=($+Ee)*Le,fn=(K-Ce)*Le,Ut=($-Ee)*Oe,Dt=(1-(z+ae))*Oe,Bt=(ie+be)*Oe,an=(K+Ce)*qe,Mn=(ie-be)*qe,on=(1-(z+X))*qe;return o[0]=At,o[1]=Kt,o[2]=fn,o[3]=0,o[4]=Ut,o[5]=Dt,o[6]=Bt,o[7]=0,o[8]=an,o[9]=Mn,o[10]=on,o[11]=0,o[12]=a[0]+rt-(At*rt+Ut*ht+an*It),o[13]=a[1]+ht-(Kt*rt+Dt*ht+Mn*It),o[14]=a[2]+It-(fn*rt+Bt*ht+on*It),o[15]=1,o},dr.fromQuat=function(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=a+a,x=u+u,S=f+f,T=a*v,D=u*v,O=u*x,z=f*v,$=f*x,K=f*S,X=g*v,ie=g*x,ae=g*S;return o[0]=1-O-K,o[1]=D+ae,o[2]=z-ie,o[3]=0,o[4]=D-ae,o[5]=1-T-K,o[6]=$+X,o[7]=0,o[8]=z+ie,o[9]=$-X,o[10]=1-T-O,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},dr.frustum=function(o,r,a,u,f,g,v){var x=1/(a-r),S=1/(f-u),T=1/(g-v);return o[0]=2*g*x,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*g*S,o[6]=0,o[7]=0,o[8]=(a+r)*x,o[9]=(f+u)*S,o[10]=(v+g)*T,o[11]=-1,o[12]=0,o[13]=0,o[14]=v*g*2*T,o[15]=0,o},dr.perspectiveNO=T_,dr.perspectiveZO=function(o,r,a,u,f){var g,v=1/Math.tan(r/2);return o[0]=v/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=v,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,null!=f&&f!==1/0?(o[10]=f*(g=1/(u-f)),o[14]=f*u*g):(o[10]=-1,o[14]=-u),o},dr.perspectiveFromFieldOfView=function(o,r,a,u){var f=Math.tan(r.upDegrees*Math.PI/180),g=Math.tan(r.downDegrees*Math.PI/180),v=Math.tan(r.leftDegrees*Math.PI/180),x=Math.tan(r.rightDegrees*Math.PI/180),S=2/(v+x),T=2/(f+g);return o[0]=S,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=T,o[6]=0,o[7]=0,o[8]=-(v-x)*S*.5,o[9]=(f-g)*T*.5,o[10]=u/(a-u),o[11]=-1,o[12]=0,o[13]=0,o[14]=u*a/(a-u),o[15]=0,o},dr.orthoNO=Tv,dr.orthoZO=function(o,r,a,u,f,g,v){var x=1/(r-a),S=1/(u-f),T=1/(g-v);return o[0]=-2*x,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*S,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=T,o[11]=0,o[12]=(r+a)*x,o[13]=(f+u)*S,o[14]=g*T,o[15]=1,o},dr.lookAt=function(o,r,a,u){var f,g,v,x,S,T,D,O,z,$,K=r[0],X=r[1],ie=r[2],ae=u[0],be=u[1],Ce=u[2],Ee=a[0],Le=a[1],Oe=a[2];return Math.abs(K-Ee)<Vo.EPSILON&&Math.abs(X-Le)<Vo.EPSILON&&Math.abs(ie-Oe)<Vo.EPSILON?S_(o):(D=K-Ee,O=X-Le,z=ie-Oe,f=be*(z*=$=1/Math.hypot(D,O,z))-Ce*(O*=$),g=Ce*(D*=$)-ae*z,v=ae*O-be*D,($=Math.hypot(f,g,v))?(f*=$=1/$,g*=$,v*=$):(f=0,g=0,v=0),x=O*v-z*g,S=z*f-D*v,T=D*g-O*f,($=Math.hypot(x,S,T))?(x*=$=1/$,S*=$,T*=$):(x=0,S=0,T=0),o[0]=f,o[1]=x,o[2]=D,o[3]=0,o[4]=g,o[5]=S,o[6]=O,o[7]=0,o[8]=v,o[9]=T,o[10]=z,o[11]=0,o[12]=-(f*K+g*X+v*ie),o[13]=-(x*K+S*X+T*ie),o[14]=-(D*K+O*X+z*ie),o[15]=1,o)},dr.targetTo=function(o,r,a,u){var f=r[0],g=r[1],v=r[2],x=u[0],S=u[1],T=u[2],D=f-a[0],O=g-a[1],z=v-a[2],$=D*D+O*O+z*z;$>0&&(D*=$=1/Math.sqrt($),O*=$,z*=$);var K=S*z-T*O,X=T*D-x*z,ie=x*O-S*D;return($=K*K+X*X+ie*ie)>0&&(K*=$=1/Math.sqrt($),X*=$,ie*=$),o[0]=K,o[1]=X,o[2]=ie,o[3]=0,o[4]=O*ie-z*X,o[5]=z*K-D*ie,o[6]=D*X-O*K,o[7]=0,o[8]=D,o[9]=O,o[10]=z,o[11]=0,o[12]=f,o[13]=g,o[14]=v,o[15]=1,o},dr.str=function(o){return"mat4("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+", "+o[6]+", "+o[7]+", "+o[8]+", "+o[9]+", "+o[10]+", "+o[11]+", "+o[12]+", "+o[13]+", "+o[14]+", "+o[15]+")"},dr.frob=function(o){return Math.hypot(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15])},dr.add=function(o,r,a){return o[0]=r[0]+a[0],o[1]=r[1]+a[1],o[2]=r[2]+a[2],o[3]=r[3]+a[3],o[4]=r[4]+a[4],o[5]=r[5]+a[5],o[6]=r[6]+a[6],o[7]=r[7]+a[7],o[8]=r[8]+a[8],o[9]=r[9]+a[9],o[10]=r[10]+a[10],o[11]=r[11]+a[11],o[12]=r[12]+a[12],o[13]=r[13]+a[13],o[14]=r[14]+a[14],o[15]=r[15]+a[15],o},dr.subtract=Tb,dr.multiplyScalar=function(o,r,a){return o[0]=r[0]*a,o[1]=r[1]*a,o[2]=r[2]*a,o[3]=r[3]*a,o[4]=r[4]*a,o[5]=r[5]*a,o[6]=r[6]*a,o[7]=r[7]*a,o[8]=r[8]*a,o[9]=r[9]*a,o[10]=r[10]*a,o[11]=r[11]*a,o[12]=r[12]*a,o[13]=r[13]*a,o[14]=r[14]*a,o[15]=r[15]*a,o},dr.multiplyScalarAndAdd=function(o,r,a,u){return o[0]=r[0]+a[0]*u,o[1]=r[1]+a[1]*u,o[2]=r[2]+a[2]*u,o[3]=r[3]+a[3]*u,o[4]=r[4]+a[4]*u,o[5]=r[5]+a[5]*u,o[6]=r[6]+a[6]*u,o[7]=r[7]+a[7]*u,o[8]=r[8]+a[8]*u,o[9]=r[9]+a[9]*u,o[10]=r[10]+a[10]*u,o[11]=r[11]+a[11]*u,o[12]=r[12]+a[12]*u,o[13]=r[13]+a[13]*u,o[14]=r[14]+a[14]*u,o[15]=r[15]+a[15]*u,o},dr.exactEquals=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]&&o[4]===r[4]&&o[5]===r[5]&&o[6]===r[6]&&o[7]===r[7]&&o[8]===r[8]&&o[9]===r[9]&&o[10]===r[10]&&o[11]===r[11]&&o[12]===r[12]&&o[13]===r[13]&&o[14]===r[14]&&o[15]===r[15]},dr.equals=function(o,r){var a=o[0],u=o[1],f=o[2],g=o[3],v=o[4],x=o[5],S=o[6],T=o[7],D=o[8],O=o[9],z=o[10],$=o[11],K=o[12],X=o[13],ie=o[14],ae=o[15],be=r[0],Ce=r[1],Ee=r[2],Le=r[3],Oe=r[4],qe=r[5],rt=r[6],ht=r[7],It=r[8],At=r[9],Kt=r[10],fn=r[11],Ut=r[12],Dt=r[13],Bt=r[14],an=r[15];return Math.abs(a-be)<=Vo.EPSILON*Math.max(1,Math.abs(a),Math.abs(be))&&Math.abs(u-Ce)<=Vo.EPSILON*Math.max(1,Math.abs(u),Math.abs(Ce))&&Math.abs(f-Ee)<=Vo.EPSILON*Math.max(1,Math.abs(f),Math.abs(Ee))&&Math.abs(g-Le)<=Vo.EPSILON*Math.max(1,Math.abs(g),Math.abs(Le))&&Math.abs(v-Oe)<=Vo.EPSILON*Math.max(1,Math.abs(v),Math.abs(Oe))&&Math.abs(x-qe)<=Vo.EPSILON*Math.max(1,Math.abs(x),Math.abs(qe))&&Math.abs(S-rt)<=Vo.EPSILON*Math.max(1,Math.abs(S),Math.abs(rt))&&Math.abs(T-ht)<=Vo.EPSILON*Math.max(1,Math.abs(T),Math.abs(ht))&&Math.abs(D-It)<=Vo.EPSILON*Math.max(1,Math.abs(D),Math.abs(It))&&Math.abs(O-At)<=Vo.EPSILON*Math.max(1,Math.abs(O),Math.abs(At))&&Math.abs(z-Kt)<=Vo.EPSILON*Math.max(1,Math.abs(z),Math.abs(Kt))&&Math.abs($-fn)<=Vo.EPSILON*Math.max(1,Math.abs($),Math.abs(fn))&&Math.abs(K-Ut)<=Vo.EPSILON*Math.max(1,Math.abs(K),Math.abs(Ut))&&Math.abs(X-Dt)<=Vo.EPSILON*Math.max(1,Math.abs(X),Math.abs(Dt))&&Math.abs(ie-Bt)<=Vo.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Bt))&&Math.abs(ae-an)<=Vo.EPSILON*Math.max(1,Math.abs(ae),Math.abs(an))},dr.sub=dr.mul=dr.ortho=dr.perspective=void 0;var Vo=function(o,r){if(o&&o.__esModule)return o;if(null===o||"object"!==Ev(o)&&"function"!=typeof o)return{default:o};var a=Eb(void 0);if(a&&a.has(o))return a.get(o);var u={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in o)if("default"!==g&&Object.prototype.hasOwnProperty.call(o,g)){var v=f?Object.getOwnPropertyDescriptor(o,g):null;v&&(v.get||v.set)?Object.defineProperty(u,g,v):u[g]=o[g]}return u.default=o,a&&a.set(o,u),u}(Aa);function Eb(o){if("function"!=typeof WeakMap)return null;var r=new WeakMap,a=new WeakMap;return(Eb=function(u){return u?a:r})(o)}function S_(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Sb(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=r[4],S=r[5],T=r[6],D=r[7],O=r[8],z=r[9],$=r[10],K=r[11],X=r[12],ie=r[13],ae=r[14],be=r[15],Ce=a[0],Ee=a[1],Le=a[2],Oe=a[3];return o[0]=Ce*u+Ee*x+Le*O+Oe*X,o[1]=Ce*f+Ee*S+Le*z+Oe*ie,o[2]=Ce*g+Ee*T+Le*$+Oe*ae,o[3]=Ce*v+Ee*D+Le*K+Oe*be,o[4]=(Ce=a[4])*u+(Ee=a[5])*x+(Le=a[6])*O+(Oe=a[7])*X,o[5]=Ce*f+Ee*S+Le*z+Oe*ie,o[6]=Ce*g+Ee*T+Le*$+Oe*ae,o[7]=Ce*v+Ee*D+Le*K+Oe*be,o[8]=(Ce=a[8])*u+(Ee=a[9])*x+(Le=a[10])*O+(Oe=a[11])*X,o[9]=Ce*f+Ee*S+Le*z+Oe*ie,o[10]=Ce*g+Ee*T+Le*$+Oe*ae,o[11]=Ce*v+Ee*D+Le*K+Oe*be,o[12]=(Ce=a[12])*u+(Ee=a[13])*x+(Le=a[14])*O+(Oe=a[15])*X,o[13]=Ce*f+Ee*S+Le*z+Oe*ie,o[14]=Ce*g+Ee*T+Le*$+Oe*ae,o[15]=Ce*v+Ee*D+Le*K+Oe*be,o}function Sv(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=u+u,S=f+f,T=g+g,D=u*x,O=u*S,z=u*T,$=f*S,K=f*T,X=g*T,ie=v*x,ae=v*S,be=v*T;return o[0]=1-($+X),o[1]=O+be,o[2]=z-ae,o[3]=0,o[4]=O-be,o[5]=1-(D+X),o[6]=K+ie,o[7]=0,o[8]=z+ae,o[9]=K-ie,o[10]=1-(D+$),o[11]=0,o[12]=a[0],o[13]=a[1],o[14]=a[2],o[15]=1,o}function K0(o,r){var a=r[4],u=r[5],f=r[6],g=r[8],v=r[9],x=r[10];return o[0]=Math.hypot(r[0],r[1],r[2]),o[1]=Math.hypot(a,u,f),o[2]=Math.hypot(g,v,x),o}function T_(o,r,a,u,f){var g,v=1/Math.tan(r/2);return o[0]=v/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=v,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,null!=f&&f!==1/0?(o[10]=(f+u)*(g=1/(u-f)),o[14]=2*f*u*g):(o[10]=-1,o[14]=-2*u),o}function Tv(o,r,a,u,f,g,v){var x=1/(r-a),S=1/(u-f),T=1/(g-v);return o[0]=-2*x,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*S,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*T,o[11]=0,o[12]=(r+a)*x,o[13]=(f+u)*S,o[14]=(v+g)*T,o[15]=1,o}function Tb(o,r,a){return o[0]=r[0]-a[0],o[1]=r[1]-a[1],o[2]=r[2]-a[2],o[3]=r[3]-a[3],o[4]=r[4]-a[4],o[5]=r[5]-a[5],o[6]=r[6]-a[6],o[7]=r[7]-a[7],o[8]=r[8]-a[8],o[9]=r[9]-a[9],o[10]=r[10]-a[10],o[11]=r[11]-a[11],o[12]=r[12]-a[12],o[13]=r[13]-a[13],o[14]=r[14]-a[14],o[15]=r[15]-a[15],o}dr.perspective=T_,dr.ortho=Tv,dr.mul=Sb,dr.sub=Tb;var fr={},cr={};function k(o){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(o)}Object.defineProperty(cr,"__esModule",{value:!0}),cr.create=N,cr.clone=function(o){var r=new R.ARRAY_TYPE(3);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r},cr.length=ee,cr.fromValues=function(o,r,a){var u=new R.ARRAY_TYPE(3);return u[0]=o,u[1]=r,u[2]=a,u},cr.copy=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o},cr.set=function(o,r,a,u){return o[0]=r,o[1]=a,o[2]=u,o},cr.add=function(o,r,a){return o[0]=r[0]+a[0],o[1]=r[1]+a[1],o[2]=r[2]+a[2],o},cr.subtract=ue,cr.multiply=Te,cr.divide=je,cr.ceil=function(o,r){return o[0]=Math.ceil(r[0]),o[1]=Math.ceil(r[1]),o[2]=Math.ceil(r[2]),o},cr.floor=function(o,r){return o[0]=Math.floor(r[0]),o[1]=Math.floor(r[1]),o[2]=Math.floor(r[2]),o},cr.min=function(o,r,a){return o[0]=Math.min(r[0],a[0]),o[1]=Math.min(r[1],a[1]),o[2]=Math.min(r[2],a[2]),o},cr.max=function(o,r,a){return o[0]=Math.max(r[0],a[0]),o[1]=Math.max(r[1],a[1]),o[2]=Math.max(r[2],a[2]),o},cr.round=function(o,r){return o[0]=Math.round(r[0]),o[1]=Math.round(r[1]),o[2]=Math.round(r[2]),o},cr.scale=function(o,r,a){return o[0]=r[0]*a,o[1]=r[1]*a,o[2]=r[2]*a,o},cr.scaleAndAdd=function(o,r,a,u){return o[0]=r[0]+a[0]*u,o[1]=r[1]+a[1]*u,o[2]=r[2]+a[2]*u,o},cr.distance=Qe,cr.squaredDistance=mt,cr.squaredLength=Mt,cr.negate=function(o,r){return o[0]=-r[0],o[1]=-r[1],o[2]=-r[2],o},cr.inverse=function(o,r){return o[0]=1/r[0],o[1]=1/r[1],o[2]=1/r[2],o},cr.normalize=function(o,r){var a=r[0],u=r[1],f=r[2],g=a*a+u*u+f*f;return g>0&&(g=1/Math.sqrt(g)),o[0]=r[0]*g,o[1]=r[1]*g,o[2]=r[2]*g,o},cr.dot=$t,cr.cross=function(o,r,a){var u=r[0],f=r[1],g=r[2],v=a[0],x=a[1],S=a[2];return o[0]=f*S-g*x,o[1]=g*v-u*S,o[2]=u*x-f*v,o},cr.lerp=function(o,r,a,u){var f=r[0],g=r[1],v=r[2];return o[0]=f+u*(a[0]-f),o[1]=g+u*(a[1]-g),o[2]=v+u*(a[2]-v),o},cr.hermite=function(o,r,a,u,f,g){var v=g*g,x=v*(2*g-3)+1,S=v*(g-2)+g,T=v*(g-1),D=v*(3-2*g);return o[0]=r[0]*x+a[0]*S+u[0]*T+f[0]*D,o[1]=r[1]*x+a[1]*S+u[1]*T+f[1]*D,o[2]=r[2]*x+a[2]*S+u[2]*T+f[2]*D,o},cr.bezier=function(o,r,a,u,f,g){var v=1-g,x=v*v,S=g*g,T=x*v,D=3*g*x,O=3*S*v,z=S*g;return o[0]=r[0]*T+a[0]*D+u[0]*O+f[0]*z,o[1]=r[1]*T+a[1]*D+u[1]*O+f[1]*z,o[2]=r[2]*T+a[2]*D+u[2]*O+f[2]*z,o},cr.random=function(o,r){r=r||1;var a=2*R.RANDOM()*Math.PI,u=2*R.RANDOM()-1,f=Math.sqrt(1-u*u)*r;return o[0]=Math.cos(a)*f,o[1]=Math.sin(a)*f,o[2]=u*r,o},cr.transformMat4=function(o,r,a){var u=r[0],f=r[1],g=r[2],v=a[3]*u+a[7]*f+a[11]*g+a[15];return o[0]=(a[0]*u+a[4]*f+a[8]*g+a[12])/(v=v||1),o[1]=(a[1]*u+a[5]*f+a[9]*g+a[13])/v,o[2]=(a[2]*u+a[6]*f+a[10]*g+a[14])/v,o},cr.transformMat3=function(o,r,a){var u=r[0],f=r[1],g=r[2];return o[0]=u*a[0]+f*a[3]+g*a[6],o[1]=u*a[1]+f*a[4]+g*a[7],o[2]=u*a[2]+f*a[5]+g*a[8],o},cr.transformQuat=function(o,r,a){var u=a[0],f=a[1],g=a[2],v=r[0],x=r[1],S=r[2],T=f*S-g*x,D=g*v-u*S,O=u*x-f*v,z=f*O-g*D,$=g*T-u*O,K=u*D-f*T,X=2*a[3];return D*=X,O*=X,$*=2,K*=2,o[0]=v+(T*=X)+(z*=2),o[1]=x+D+$,o[2]=S+O+K,o},cr.rotateX=function(o,r,a,u){var f=[],g=[];return f[0]=r[0]-a[0],f[1]=r[1]-a[1],f[2]=r[2]-a[2],g[0]=f[0],g[1]=f[1]*Math.cos(u)-f[2]*Math.sin(u),g[2]=f[1]*Math.sin(u)+f[2]*Math.cos(u),o[0]=g[0]+a[0],o[1]=g[1]+a[1],o[2]=g[2]+a[2],o},cr.rotateY=function(o,r,a,u){var f=[],g=[];return f[0]=r[0]-a[0],f[1]=r[1]-a[1],f[2]=r[2]-a[2],g[0]=f[2]*Math.sin(u)+f[0]*Math.cos(u),g[1]=f[1],g[2]=f[2]*Math.cos(u)-f[0]*Math.sin(u),o[0]=g[0]+a[0],o[1]=g[1]+a[1],o[2]=g[2]+a[2],o},cr.rotateZ=function(o,r,a,u){var f=[],g=[];return f[0]=r[0]-a[0],f[1]=r[1]-a[1],f[2]=r[2]-a[2],g[0]=f[0]*Math.cos(u)-f[1]*Math.sin(u),g[1]=f[0]*Math.sin(u)+f[1]*Math.cos(u),g[2]=f[2],o[0]=g[0]+a[0],o[1]=g[1]+a[1],o[2]=g[2]+a[2],o},cr.angle=function(o,r){var a=o[0],u=o[1],f=o[2],g=r[0],v=r[1],x=r[2],S=Math.sqrt(a*a+u*u+f*f)*Math.sqrt(g*g+v*v+x*x),T=S&&$t(o,r)/S;return Math.acos(Math.min(Math.max(T,-1),1))},cr.zero=function(o){return o[0]=0,o[1]=0,o[2]=0,o},cr.str=function(o){return"vec3("+o[0]+", "+o[1]+", "+o[2]+")"},cr.exactEquals=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]},cr.equals=function(o,r){var a=o[0],u=o[1],f=o[2],g=r[0],v=r[1],x=r[2];return Math.abs(a-g)<=R.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(u-v)<=R.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(f-x)<=R.EPSILON*Math.max(1,Math.abs(f),Math.abs(x))},cr.forEach=cr.sqrLen=cr.len=cr.sqrDist=cr.dist=cr.div=cr.mul=cr.sub=void 0;var R=function(o,r){if(o&&o.__esModule)return o;if(null===o||"object"!==k(o)&&"function"!=typeof o)return{default:o};var a=U(void 0);if(a&&a.has(o))return a.get(o);var u={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in o)if("default"!==g&&Object.prototype.hasOwnProperty.call(o,g)){var v=f?Object.getOwnPropertyDescriptor(o,g):null;v&&(v.get||v.set)?Object.defineProperty(u,g,v):u[g]=o[g]}return u.default=o,a&&a.set(o,u),u}(Aa);function U(o){if("function"!=typeof WeakMap)return null;var r=new WeakMap,a=new WeakMap;return(U=function(u){return u?a:r})(o)}function N(){var o=new R.ARRAY_TYPE(3);return R.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function ee(o){return Math.hypot(o[0],o[1],o[2])}function ue(o,r,a){return o[0]=r[0]-a[0],o[1]=r[1]-a[1],o[2]=r[2]-a[2],o}function Te(o,r,a){return o[0]=r[0]*a[0],o[1]=r[1]*a[1],o[2]=r[2]*a[2],o}function je(o,r,a){return o[0]=r[0]/a[0],o[1]=r[1]/a[1],o[2]=r[2]/a[2],o}function Qe(o,r){return Math.hypot(r[0]-o[0],r[1]-o[1],r[2]-o[2])}function mt(o,r){var a=r[0]-o[0],u=r[1]-o[1],f=r[2]-o[2];return a*a+u*u+f*f}function Mt(o){var r=o[0],a=o[1],u=o[2];return r*r+a*a+u*u}function $t(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]}cr.sub=ue,cr.mul=Te,cr.div=je,cr.dist=Qe,cr.sqrDist=mt,cr.len=ee,cr.sqrLen=Mt;var yn,Xi=(yn=N(),function(o,r,a,u,f,g){var v,x;for(r||(r=3),a||(a=0),x=u?Math.min(u*r+a,o.length):o.length,v=a;v<x;v+=r)yn[0]=o[v],yn[1]=o[v+1],yn[2]=o[v+2],f(yn,yn,g),o[v]=yn[0],o[v+1]=yn[1],o[v+2]=yn[2];return o});cr.forEach=Xi;var mn={};function Ni(o){return(Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(o)}Object.defineProperty(mn,"__esModule",{value:!0}),mn.create=tr,mn.clone=function(o){var r=new Lr.ARRAY_TYPE(4);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r},mn.fromValues=function(o,r,a,u){var f=new Lr.ARRAY_TYPE(4);return f[0]=o,f[1]=r,f[2]=a,f[3]=u,f},mn.copy=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o},mn.set=function(o,r,a,u,f){return o[0]=r,o[1]=a,o[2]=u,o[3]=f,o},mn.add=function(o,r,a){return o[0]=r[0]+a[0],o[1]=r[1]+a[1],o[2]=r[2]+a[2],o[3]=r[3]+a[3],o},mn.subtract=So,mn.multiply=Ls,mn.divide=Gr,mn.ceil=function(o,r){return o[0]=Math.ceil(r[0]),o[1]=Math.ceil(r[1]),o[2]=Math.ceil(r[2]),o[3]=Math.ceil(r[3]),o},mn.floor=function(o,r){return o[0]=Math.floor(r[0]),o[1]=Math.floor(r[1]),o[2]=Math.floor(r[2]),o[3]=Math.floor(r[3]),o},mn.min=function(o,r,a){return o[0]=Math.min(r[0],a[0]),o[1]=Math.min(r[1],a[1]),o[2]=Math.min(r[2],a[2]),o[3]=Math.min(r[3],a[3]),o},mn.max=function(o,r,a){return o[0]=Math.max(r[0],a[0]),o[1]=Math.max(r[1],a[1]),o[2]=Math.max(r[2],a[2]),o[3]=Math.max(r[3],a[3]),o},mn.round=function(o,r){return o[0]=Math.round(r[0]),o[1]=Math.round(r[1]),o[2]=Math.round(r[2]),o[3]=Math.round(r[3]),o},mn.scale=function(o,r,a){return o[0]=r[0]*a,o[1]=r[1]*a,o[2]=r[2]*a,o[3]=r[3]*a,o},mn.scaleAndAdd=function(o,r,a,u){return o[0]=r[0]+a[0]*u,o[1]=r[1]+a[1]*u,o[2]=r[2]+a[2]*u,o[3]=r[3]+a[3]*u,o},mn.distance=$i,mn.squaredDistance=po,mn.length=go,mn.squaredLength=us,mn.negate=function(o,r){return o[0]=-r[0],o[1]=-r[1],o[2]=-r[2],o[3]=-r[3],o},mn.inverse=function(o,r){return o[0]=1/r[0],o[1]=1/r[1],o[2]=1/r[2],o[3]=1/r[3],o},mn.normalize=function(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=a*a+u*u+f*f+g*g;return v>0&&(v=1/Math.sqrt(v)),o[0]=a*v,o[1]=u*v,o[2]=f*v,o[3]=g*v,o},mn.dot=function(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]+o[3]*r[3]},mn.cross=function(o,r,a,u){var f=a[0]*u[1]-a[1]*u[0],g=a[0]*u[2]-a[2]*u[0],v=a[0]*u[3]-a[3]*u[0],x=a[1]*u[2]-a[2]*u[1],S=a[1]*u[3]-a[3]*u[1],T=a[2]*u[3]-a[3]*u[2],D=r[0],O=r[1],z=r[2],$=r[3];return o[0]=O*T-z*S+$*x,o[1]=-D*T+z*v-$*g,o[2]=D*S-O*v+$*f,o[3]=-D*x+O*g-z*f,o},mn.lerp=function(o,r,a,u){var f=r[0],g=r[1],v=r[2],x=r[3];return o[0]=f+u*(a[0]-f),o[1]=g+u*(a[1]-g),o[2]=v+u*(a[2]-v),o[3]=x+u*(a[3]-x),o},mn.random=function(o,r){var a,u,f,g,v,x;r=r||1;do{v=(a=2*Lr.RANDOM()-1)*a+(u=2*Lr.RANDOM()-1)*u}while(v>=1);do{x=(f=2*Lr.RANDOM()-1)*f+(g=2*Lr.RANDOM()-1)*g}while(x>=1);var S=Math.sqrt((1-v)/x);return o[0]=r*a,o[1]=r*u,o[2]=r*f*S,o[3]=r*g*S,o},mn.transformMat4=function(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3];return o[0]=a[0]*u+a[4]*f+a[8]*g+a[12]*v,o[1]=a[1]*u+a[5]*f+a[9]*g+a[13]*v,o[2]=a[2]*u+a[6]*f+a[10]*g+a[14]*v,o[3]=a[3]*u+a[7]*f+a[11]*g+a[15]*v,o},mn.transformQuat=function(o,r,a){var u=r[0],f=r[1],g=r[2],v=a[0],x=a[1],S=a[2],T=a[3],D=T*u+x*g-S*f,O=T*f+S*u-v*g,z=T*g+v*f-x*u,$=-v*u-x*f-S*g;return o[0]=D*T+$*-v+O*-S-z*-x,o[1]=O*T+$*-x+z*-v-D*-S,o[2]=z*T+$*-S+D*-x-O*-v,o[3]=r[3],o},mn.zero=function(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=0,o},mn.str=function(o){return"vec4("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"},mn.exactEquals=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]},mn.equals=function(o,r){var a=o[0],u=o[1],f=o[2],g=o[3],v=r[0],x=r[1],S=r[2],T=r[3];return Math.abs(a-v)<=Lr.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(u-x)<=Lr.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(f-S)<=Lr.EPSILON*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(g-T)<=Lr.EPSILON*Math.max(1,Math.abs(g),Math.abs(T))},mn.forEach=mn.sqrLen=mn.len=mn.sqrDist=mn.dist=mn.div=mn.mul=mn.sub=void 0;var Lr=function(o,r){if(o&&o.__esModule)return o;if(null===o||"object"!==Ni(o)&&"function"!=typeof o)return{default:o};var a=hr(void 0);if(a&&a.has(o))return a.get(o);var u={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in o)if("default"!==g&&Object.prototype.hasOwnProperty.call(o,g)){var v=f?Object.getOwnPropertyDescriptor(o,g):null;v&&(v.get||v.set)?Object.defineProperty(u,g,v):u[g]=o[g]}return u.default=o,a&&a.set(o,u),u}(Aa);function hr(o){if("function"!=typeof WeakMap)return null;var r=new WeakMap,a=new WeakMap;return(hr=function(u){return u?a:r})(o)}function tr(){var o=new Lr.ARRAY_TYPE(4);return Lr.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0,o[3]=0),o}function So(o,r,a){return o[0]=r[0]-a[0],o[1]=r[1]-a[1],o[2]=r[2]-a[2],o[3]=r[3]-a[3],o}function Ls(o,r,a){return o[0]=r[0]*a[0],o[1]=r[1]*a[1],o[2]=r[2]*a[2],o[3]=r[3]*a[3],o}function Gr(o,r,a){return o[0]=r[0]/a[0],o[1]=r[1]/a[1],o[2]=r[2]/a[2],o[3]=r[3]/a[3],o}function $i(o,r){return Math.hypot(r[0]-o[0],r[1]-o[1],r[2]-o[2],r[3]-o[3])}function po(o,r){var a=r[0]-o[0],u=r[1]-o[1],f=r[2]-o[2],g=r[3]-o[3];return a*a+u*u+f*f+g*g}function go(o){return Math.hypot(o[0],o[1],o[2],o[3])}function us(o){var r=o[0],a=o[1],u=o[2],f=o[3];return r*r+a*a+u*u+f*f}mn.sub=So,mn.mul=Ls,mn.div=Gr,mn.dist=$i,mn.sqrDist=po,mn.len=go,mn.sqrLen=us;var Wl=function(){var o=tr();return function(r,a,u,f,g,v){var x,S;for(a||(a=4),u||(u=0),S=f?Math.min(f*a+u,r.length):r.length,x=u;x<S;x+=a)o[0]=r[x],o[1]=r[x+1],o[2]=r[x+2],o[3]=r[x+3],g(o,o,v),r[x]=o[0],r[x+1]=o[1],r[x+2]=o[2],r[x+3]=o[3];return r}}();function Kc(o){return(Kc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(o)}mn.forEach=Wl,Object.defineProperty(fr,"__esModule",{value:!0}),fr.create=lf,fr.identity=function(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o},fr.setAxisAngle=$h,fr.getAxisAngle=function(o,r){var a=2*Math.acos(r[3]),u=Math.sin(a/2);return u>tl.EPSILON?(o[0]=r[0]/u,o[1]=r[1]/u,o[2]=r[2]/u):(o[0]=1,o[1]=0,o[2]=0),a},fr.getAngle=function(o,r){var a=XA(o,r);return Math.acos(2*a*a-1)},fr.multiply=qh,fr.rotateX=function(o,r,a){a*=.5;var u=r[0],f=r[1],g=r[2],v=r[3],x=Math.sin(a),S=Math.cos(a);return o[0]=u*S+v*x,o[1]=f*S+g*x,o[2]=g*S-f*x,o[3]=v*S-u*x,o},fr.rotateY=function(o,r,a){a*=.5;var u=r[0],f=r[1],g=r[2],v=r[3],x=Math.sin(a),S=Math.cos(a);return o[0]=u*S-g*x,o[1]=f*S+v*x,o[2]=g*S+u*x,o[3]=v*S-f*x,o},fr.rotateZ=function(o,r,a){a*=.5;var u=r[0],f=r[1],g=r[2],v=r[3],x=Math.sin(a),S=Math.cos(a);return o[0]=u*S+f*x,o[1]=f*S-u*x,o[2]=g*S+v*x,o[3]=v*S-g*x,o},fr.calculateW=function(o,r){var a=r[0],u=r[1],f=r[2];return o[0]=a,o[1]=u,o[2]=f,o[3]=Math.sqrt(Math.abs(1-a*a-u*u-f*f)),o},fr.exp=wd,fr.ln=gu,fr.pow=function(o,r,a){return gu(o,r),cf(o,o,a),wd(o,o),o},fr.slerp=Kh,fr.random=function(o){var r=tl.RANDOM(),a=tl.RANDOM(),u=tl.RANDOM(),f=Math.sqrt(1-r),g=Math.sqrt(r);return o[0]=f*Math.sin(2*Math.PI*a),o[1]=f*Math.cos(2*Math.PI*a),o[2]=g*Math.sin(2*Math.PI*u),o[3]=g*Math.cos(2*Math.PI*u),o},fr.invert=function(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=a*a+u*u+f*f+g*g,x=v?1/v:0;return o[0]=-a*x,o[1]=-u*x,o[2]=-f*x,o[3]=g*x,o},fr.conjugate=function(o,r){return o[0]=-r[0],o[1]=-r[1],o[2]=-r[2],o[3]=r[3],o},fr.fromMat3=ZA,fr.fromEuler=function(o,r,a,u){var f=.5*Math.PI/180;r*=f,a*=f,u*=f;var g=Math.sin(r),v=Math.cos(r),x=Math.sin(a),S=Math.cos(a),T=Math.sin(u),D=Math.cos(u);return o[0]=g*S*D-v*x*T,o[1]=v*x*D+g*S*T,o[2]=v*S*T-g*x*D,o[3]=v*S*D+g*x*T,o},fr.str=function(o){return"quat("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+")"},fr.setAxes=fr.sqlerp=fr.rotationTo=fr.equals=fr.exactEquals=fr.normalize=fr.sqrLen=fr.squaredLength=fr.len=fr.length=fr.lerp=fr.dot=fr.scale=fr.mul=fr.add=fr.set=fr.copy=fr.fromValues=fr.clone=void 0;var tl=nl(Aa),No=nl(to),pa=nl(cr),yl=nl(mn);function Wc(o){if("function"!=typeof WeakMap)return null;var r=new WeakMap,a=new WeakMap;return(Wc=function(u){return u?a:r})(o)}function nl(o,r){if(!r&&o&&o.__esModule)return o;if(null===o||"object"!==Kc(o)&&"function"!=typeof o)return{default:o};var a=Wc(r);if(a&&a.has(o))return a.get(o);var u={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in o)if("default"!==g&&Object.prototype.hasOwnProperty.call(o,g)){var v=f?Object.getOwnPropertyDescriptor(o,g):null;v&&(v.get||v.set)?Object.defineProperty(u,g,v):u[g]=o[g]}return u.default=o,a&&a.set(o,u),u}function lf(){var o=new tl.ARRAY_TYPE(4);return tl.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function $h(o,r,a){a*=.5;var u=Math.sin(a);return o[0]=u*r[0],o[1]=u*r[1],o[2]=u*r[2],o[3]=Math.cos(a),o}function qh(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=a[0],S=a[1],T=a[2],D=a[3];return o[0]=u*D+v*x+f*T-g*S,o[1]=f*D+v*S+g*x-u*T,o[2]=g*D+v*T+u*S-f*x,o[3]=v*D-u*x-f*S-g*T,o}function wd(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=Math.sqrt(a*a+u*u+f*f),x=Math.exp(g),S=v>0?x*Math.sin(v)/v:0;return o[0]=a*S,o[1]=u*S,o[2]=f*S,o[3]=x*Math.cos(v),o}function gu(o,r){var a=r[0],u=r[1],f=r[2],g=r[3],v=Math.sqrt(a*a+u*u+f*f),x=v>0?Math.atan2(v,g)/v:0;return o[0]=a*x,o[1]=u*x,o[2]=f*x,o[3]=.5*Math.log(a*a+u*u+f*f+g*g),o}function Kh(o,r,a,u){var f,g,v,x,S,T=r[0],D=r[1],O=r[2],z=r[3],$=a[0],K=a[1],X=a[2],ie=a[3];return(g=T*$+D*K+O*X+z*ie)<0&&(g=-g,$=-$,K=-K,X=-X,ie=-ie),1-g>tl.EPSILON?(f=Math.acos(g),v=Math.sin(f),x=Math.sin((1-u)*f)/v,S=Math.sin(u*f)/v):(x=1-u,S=u),o[0]=x*T+S*$,o[1]=x*D+S*K,o[2]=x*O+S*X,o[3]=x*z+S*ie,o}function ZA(o,r){var a,u=r[0]+r[4]+r[8];if(u>0)a=Math.sqrt(u+1),o[3]=.5*a,o[0]=(r[5]-r[7])*(a=.5/a),o[1]=(r[6]-r[2])*a,o[2]=(r[1]-r[3])*a;else{var f=0;r[4]>r[0]&&(f=1),r[8]>r[3*f+f]&&(f=2);var g=(f+1)%3,v=(f+2)%3;a=Math.sqrt(r[3*f+f]-r[3*g+g]-r[3*v+v]+1),o[f]=.5*a,o[3]=(r[3*g+v]-r[3*v+g])*(a=.5/a),o[g]=(r[3*g+f]+r[3*f+g])*a,o[v]=(r[3*v+f]+r[3*f+v])*a}return o}fr.clone=yl.clone,fr.fromValues=yl.fromValues,fr.copy=yl.copy,fr.set=yl.set,fr.add=yl.add,fr.mul=qh;var cf=yl.scale;fr.scale=cf;var XA=yl.dot;fr.dot=XA,fr.lerp=yl.lerp;var YA=yl.length;fr.length=YA,fr.len=YA;var WS=yl.squaredLength;fr.squaredLength=WS,fr.sqrLen=WS;var wC=yl.normalize;fr.normalize=wC,fr.exactEquals=yl.exactEquals,fr.equals=yl.equals;var Jf,xC,ZS,bF=(Jf=pa.create(),xC=pa.fromValues(1,0,0),ZS=pa.fromValues(0,1,0),function(o,r,a){var u=pa.dot(r,a);return u<-.999999?(pa.cross(Jf,xC,r),pa.len(Jf)<1e-6&&pa.cross(Jf,ZS,r),pa.normalize(Jf,Jf),$h(o,Jf,Math.PI),o):u>.999999?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):(pa.cross(Jf,r,a),o[0]=Jf[0],o[1]=Jf[1],o[2]=Jf[2],o[3]=1+u,wC(o,o))});fr.rotationTo=bF;var ku,Iv,XS=(ku=lf(),Iv=lf(),function(o,r,a,u,f,g){return Kh(ku,r,f,g),Kh(Iv,a,u,g),Kh(o,ku,Iv,2*g*(1-g)),o});fr.sqlerp=XS;var xd,Pu=(xd=No.create(),function(o,r,a,u){return xd[0]=a[0],xd[3]=a[1],xd[6]=a[2],xd[1]=u[0],xd[4]=u[1],xd[7]=u[2],xd[2]=-r[0],xd[5]=-r[1],xd[8]=-r[2],wC(o,ZA(o,xd))});fr.setAxes=Pu;var Vr={};function Ib(o){return(Ib="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(o)}Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.create=function(){var o=new Nu.ARRAY_TYPE(8);return Nu.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0,o[4]=0,o[5]=0,o[6]=0,o[7]=0),o[3]=1,o},Vr.clone=function(o){var r=new Nu.ARRAY_TYPE(8);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r[6]=o[6],r[7]=o[7],r},Vr.fromValues=function(o,r,a,u,f,g,v,x){var S=new Nu.ARRAY_TYPE(8);return S[0]=o,S[1]=r,S[2]=a,S[3]=u,S[4]=f,S[5]=g,S[6]=v,S[7]=x,S},Vr.fromRotationTranslationValues=function(o,r,a,u,f,g,v){var x=new Nu.ARRAY_TYPE(8);x[0]=o,x[1]=r,x[2]=a,x[3]=u;var S=.5*f,T=.5*g,D=.5*v;return x[4]=S*u+T*a-D*r,x[5]=T*u+D*o-S*a,x[6]=D*u+S*r-T*o,x[7]=-S*o-T*r-D*a,x},Vr.fromRotationTranslation=JS,Vr.fromTranslation=function(o,r){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o[4]=.5*r[0],o[5]=.5*r[1],o[6]=.5*r[2],o[7]=0,o},Vr.fromRotation=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=0,o[5]=0,o[6]=0,o[7]=0,o},Vr.fromMat4=function(o,r){var a=qp.create();CC.getRotation(a,r);var u=new Nu.ARRAY_TYPE(3);return CC.getTranslation(u,r),JS(o,a,u),o},Vr.copy=EC,Vr.identity=function(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o[4]=0,o[5]=0,o[6]=0,o[7]=0,o},Vr.set=function(o,r,a,u,f,g,v,x,S){return o[0]=r,o[1]=a,o[2]=u,o[3]=f,o[4]=g,o[5]=v,o[6]=x,o[7]=S,o},Vr.getDual=function(o,r){return o[0]=r[4],o[1]=r[5],o[2]=r[6],o[3]=r[7],o},Vr.setDual=function(o,r){return o[4]=r[0],o[5]=r[1],o[6]=r[2],o[7]=r[3],o},Vr.getTranslation=function(o,r){var a=r[4],u=r[5],f=r[6],g=r[7],v=-r[0],x=-r[1],S=-r[2],T=r[3];return o[0]=2*(a*T+g*v+u*S-f*x),o[1]=2*(u*T+g*x+f*v-a*S),o[2]=2*(f*T+g*S+a*x-u*v),o},Vr.translate=function(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=.5*a[0],S=.5*a[1],T=.5*a[2],D=r[4],O=r[5],z=r[6],$=r[7];return o[0]=u,o[1]=f,o[2]=g,o[3]=v,o[4]=v*x+f*T-g*S+D,o[5]=v*S+g*x-u*T+O,o[6]=v*T+u*S-f*x+z,o[7]=-u*x-f*S-g*T+$,o},Vr.rotateX=function(o,r,a){var u=-r[0],f=-r[1],g=-r[2],v=r[3],x=r[4],S=r[5],T=r[6],D=r[7],O=x*v+D*u+S*g-T*f,z=S*v+D*f+T*u-x*g,$=T*v+D*g+x*f-S*u,K=D*v-x*u-S*f-T*g;return qp.rotateX(o,r,a),o[4]=O*(v=o[3])+K*(u=o[0])+z*(g=o[2])-$*(f=o[1]),o[5]=z*v+K*f+$*u-O*g,o[6]=$*v+K*g+O*f-z*u,o[7]=K*v-O*u-z*f-$*g,o},Vr.rotateY=function(o,r,a){var u=-r[0],f=-r[1],g=-r[2],v=r[3],x=r[4],S=r[5],T=r[6],D=r[7],O=x*v+D*u+S*g-T*f,z=S*v+D*f+T*u-x*g,$=T*v+D*g+x*f-S*u,K=D*v-x*u-S*f-T*g;return qp.rotateY(o,r,a),o[4]=O*(v=o[3])+K*(u=o[0])+z*(g=o[2])-$*(f=o[1]),o[5]=z*v+K*f+$*u-O*g,o[6]=$*v+K*g+O*f-z*u,o[7]=K*v-O*u-z*f-$*g,o},Vr.rotateZ=function(o,r,a){var u=-r[0],f=-r[1],g=-r[2],v=r[3],x=r[4],S=r[5],T=r[6],D=r[7],O=x*v+D*u+S*g-T*f,z=S*v+D*f+T*u-x*g,$=T*v+D*g+x*f-S*u,K=D*v-x*u-S*f-T*g;return qp.rotateZ(o,r,a),o[4]=O*(v=o[3])+K*(u=o[0])+z*(g=o[2])-$*(f=o[1]),o[5]=z*v+K*f+$*u-O*g,o[6]=$*v+K*g+O*f-z*u,o[7]=K*v-O*u-z*f-$*g,o},Vr.rotateByQuatAppend=function(o,r,a){var u=a[0],f=a[1],g=a[2],v=a[3],x=r[0],S=r[1],T=r[2],D=r[3];return o[0]=x*v+D*u+S*g-T*f,o[1]=S*v+D*f+T*u-x*g,o[2]=T*v+D*g+x*f-S*u,o[3]=D*v-x*u-S*f-T*g,o[4]=(x=r[4])*v+(D=r[7])*u+(S=r[5])*g-(T=r[6])*f,o[5]=S*v+D*f+T*u-x*g,o[6]=T*v+D*g+x*f-S*u,o[7]=D*v-x*u-S*f-T*g,o},Vr.rotateByQuatPrepend=function(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=a[0],S=a[1],T=a[2],D=a[3];return o[0]=u*D+v*x+f*T-g*S,o[1]=f*D+v*S+g*x-u*T,o[2]=g*D+v*T+u*S-f*x,o[3]=v*D-u*x-f*S-g*T,o[4]=u*(D=a[7])+v*(x=a[4])+f*(T=a[6])-g*(S=a[5]),o[5]=f*D+v*S+g*x-u*T,o[6]=g*D+v*T+u*S-f*x,o[7]=v*D-u*x-f*S-g*T,o},Vr.rotateAroundAxis=function(o,r,a,u){if(Math.abs(u)<Nu.EPSILON)return EC(o,r);var f=Math.hypot(a[0],a[1],a[2]);u*=.5;var g=Math.sin(u),v=g*a[0]/f,x=g*a[1]/f,S=g*a[2]/f,T=Math.cos(u),D=r[0],O=r[1],z=r[2],$=r[3];o[0]=D*T+$*v+O*S-z*x,o[1]=O*T+$*x+z*v-D*S,o[2]=z*T+$*S+D*x-O*v,o[3]=$*T-D*v-O*x-z*S;var K=r[4],X=r[5],ie=r[6],ae=r[7];return o[4]=K*T+ae*v+X*S-ie*x,o[5]=X*T+ae*x+ie*v-K*S,o[6]=ie*T+ae*S+K*x-X*v,o[7]=ae*T-K*v-X*x-ie*S,o},Vr.add=function(o,r,a){return o[0]=r[0]+a[0],o[1]=r[1]+a[1],o[2]=r[2]+a[2],o[3]=r[3]+a[3],o[4]=r[4]+a[4],o[5]=r[5]+a[5],o[6]=r[6]+a[6],o[7]=r[7]+a[7],o},Vr.multiply=eT,Vr.scale=function(o,r,a){return o[0]=r[0]*a,o[1]=r[1]*a,o[2]=r[2]*a,o[3]=r[3]*a,o[4]=r[4]*a,o[5]=r[5]*a,o[6]=r[6]*a,o[7]=r[7]*a,o},Vr.lerp=function(o,r,a,u){var f=1-u;return tT(r,a)<0&&(u=-u),o[0]=r[0]*f+a[0]*u,o[1]=r[1]*f+a[1]*u,o[2]=r[2]*f+a[2]*u,o[3]=r[3]*f+a[3]*u,o[4]=r[4]*f+a[4]*u,o[5]=r[5]*f+a[5]*u,o[6]=r[6]*f+a[6]*u,o[7]=r[7]*f+a[7]*u,o},Vr.invert=function(o,r){var a=W0(r);return o[0]=-r[0]/a,o[1]=-r[1]/a,o[2]=-r[2]/a,o[3]=r[3]/a,o[4]=-r[4]/a,o[5]=-r[5]/a,o[6]=-r[6]/a,o[7]=r[7]/a,o},Vr.conjugate=function(o,r){return o[0]=-r[0],o[1]=-r[1],o[2]=-r[2],o[3]=r[3],o[4]=-r[4],o[5]=-r[5],o[6]=-r[6],o[7]=r[7],o},Vr.normalize=function(o,r){var a=W0(r);if(a>0){a=Math.sqrt(a);var u=r[0]/a,f=r[1]/a,g=r[2]/a,v=r[3]/a,x=r[4],S=r[5],T=r[6],D=r[7],O=u*x+f*S+g*T+v*D;o[0]=u,o[1]=f,o[2]=g,o[3]=v,o[4]=(x-u*O)/a,o[5]=(S-f*O)/a,o[6]=(T-g*O)/a,o[7]=(D-v*O)/a}return o},Vr.str=function(o){return"quat2("+o[0]+", "+o[1]+", "+o[2]+", "+o[3]+", "+o[4]+", "+o[5]+", "+o[6]+", "+o[7]+")"},Vr.exactEquals=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]&&o[4]===r[4]&&o[5]===r[5]&&o[6]===r[6]&&o[7]===r[7]},Vr.equals=function(o,r){var a=o[0],u=o[1],f=o[2],g=o[3],v=o[4],x=o[5],S=o[6],T=o[7],D=r[0],O=r[1],z=r[2],$=r[3],K=r[4],X=r[5],ie=r[6],ae=r[7];return Math.abs(a-D)<=Nu.EPSILON*Math.max(1,Math.abs(a),Math.abs(D))&&Math.abs(u-O)<=Nu.EPSILON*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(f-z)<=Nu.EPSILON*Math.max(1,Math.abs(f),Math.abs(z))&&Math.abs(g-$)<=Nu.EPSILON*Math.max(1,Math.abs(g),Math.abs($))&&Math.abs(v-K)<=Nu.EPSILON*Math.max(1,Math.abs(v),Math.abs(K))&&Math.abs(x-X)<=Nu.EPSILON*Math.max(1,Math.abs(x),Math.abs(X))&&Math.abs(S-ie)<=Nu.EPSILON*Math.max(1,Math.abs(S),Math.abs(ie))&&Math.abs(T-ae)<=Nu.EPSILON*Math.max(1,Math.abs(T),Math.abs(ae))},Vr.sqrLen=Vr.squaredLength=Vr.len=Vr.length=Vr.dot=Vr.mul=Vr.setReal=Vr.getReal=void 0;var Nu=Db(Aa),qp=Db(fr),CC=Db(dr);function YS(o){if("function"!=typeof WeakMap)return null;var r=new WeakMap,a=new WeakMap;return(YS=function(u){return u?a:r})(o)}function Db(o,r){if(!r&&o&&o.__esModule)return o;if(null===o||"object"!==Ib(o)&&"function"!=typeof o)return{default:o};var a=YS(r);if(a&&a.has(o))return a.get(o);var u={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in o)if("default"!==g&&Object.prototype.hasOwnProperty.call(o,g)){var v=f?Object.getOwnPropertyDescriptor(o,g):null;v&&(v.get||v.set)?Object.defineProperty(u,g,v):u[g]=o[g]}return u.default=o,a&&a.set(o,u),u}function JS(o,r,a){var u=.5*a[0],f=.5*a[1],g=.5*a[2],v=r[0],x=r[1],S=r[2],T=r[3];return o[0]=v,o[1]=x,o[2]=S,o[3]=T,o[4]=u*T+f*S-g*x,o[5]=f*T+g*v-u*S,o[6]=g*T+u*x-f*v,o[7]=-u*v-f*x-g*S,o}function EC(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o}function eT(o,r,a){var u=r[0],f=r[1],g=r[2],v=r[3],x=a[4],S=a[5],T=a[6],D=a[7],O=r[4],z=r[5],$=r[6],K=r[7],X=a[0],ie=a[1],ae=a[2],be=a[3];return o[0]=u*be+v*X+f*ae-g*ie,o[1]=f*be+v*ie+g*X-u*ae,o[2]=g*be+v*ae+u*ie-f*X,o[3]=v*be-u*X-f*ie-g*ae,o[4]=u*D+v*x+f*T-g*S+O*be+K*X+z*ae-$*ie,o[5]=f*D+v*S+g*x-u*T+z*be+K*ie+$*X-O*ae,o[6]=g*D+v*T+u*S-f*x+$*be+K*ae+O*ie-z*X,o[7]=v*D-u*x-f*S-g*T+K*be-O*X-z*ie-$*ae,o}Vr.getReal=qp.copy,Vr.setReal=qp.copy,Vr.mul=eT;var tT=qp.dot;Vr.dot=tT;var Bb=qp.length;Vr.length=Bb,Vr.len=Bb;var W0=qp.squaredLength;Vr.squaredLength=W0,Vr.sqrLen=W0;var Pr={};function I_(o){return(I_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(o)}Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.create=SC,Pr.clone=function(o){var r=new D_.ARRAY_TYPE(2);return r[0]=o[0],r[1]=o[1],r},Pr.fromValues=function(o,r){var a=new D_.ARRAY_TYPE(2);return a[0]=o,a[1]=r,a},Pr.copy=function(o,r){return o[0]=r[0],o[1]=r[1],o},Pr.set=function(o,r,a){return o[0]=r,o[1]=a,o},Pr.add=function(o,r,a){return o[0]=r[0]+a[0],o[1]=r[1]+a[1],o},Pr.subtract=TC,Pr.multiply=IC,Pr.divide=B_,Pr.ceil=function(o,r){return o[0]=Math.ceil(r[0]),o[1]=Math.ceil(r[1]),o},Pr.floor=function(o,r){return o[0]=Math.floor(r[0]),o[1]=Math.floor(r[1]),o},Pr.min=function(o,r,a){return o[0]=Math.min(r[0],a[0]),o[1]=Math.min(r[1],a[1]),o},Pr.max=function(o,r,a){return o[0]=Math.max(r[0],a[0]),o[1]=Math.max(r[1],a[1]),o},Pr.round=function(o,r){return o[0]=Math.round(r[0]),o[1]=Math.round(r[1]),o},Pr.scale=function(o,r,a){return o[0]=r[0]*a,o[1]=r[1]*a,o},Pr.scaleAndAdd=function(o,r,a,u){return o[0]=r[0]+a[0]*u,o[1]=r[1]+a[1]*u,o},Pr.distance=Dv,Pr.squaredDistance=DC,Pr.length=Mb,Pr.squaredLength=Bv,Pr.negate=function(o,r){return o[0]=-r[0],o[1]=-r[1],o},Pr.inverse=function(o,r){return o[0]=1/r[0],o[1]=1/r[1],o},Pr.normalize=function(o,r){var a=r[0],u=r[1],f=a*a+u*u;return f>0&&(f=1/Math.sqrt(f)),o[0]=r[0]*f,o[1]=r[1]*f,o},Pr.dot=function(o,r){return o[0]*r[0]+o[1]*r[1]},Pr.cross=function(o,r,a){var u=r[0]*a[1]-r[1]*a[0];return o[0]=o[1]=0,o[2]=u,o},Pr.lerp=function(o,r,a,u){var f=r[0],g=r[1];return o[0]=f+u*(a[0]-f),o[1]=g+u*(a[1]-g),o},Pr.random=function(o,r){r=r||1;var a=2*D_.RANDOM()*Math.PI;return o[0]=Math.cos(a)*r,o[1]=Math.sin(a)*r,o},Pr.transformMat2=function(o,r,a){var u=r[0],f=r[1];return o[0]=a[0]*u+a[2]*f,o[1]=a[1]*u+a[3]*f,o},Pr.transformMat2d=function(o,r,a){var u=r[0],f=r[1];return o[0]=a[0]*u+a[2]*f+a[4],o[1]=a[1]*u+a[3]*f+a[5],o},Pr.transformMat3=function(o,r,a){var u=r[0],f=r[1];return o[0]=a[0]*u+a[3]*f+a[6],o[1]=a[1]*u+a[4]*f+a[7],o},Pr.transformMat4=function(o,r,a){var u=r[0],f=r[1];return o[0]=a[0]*u+a[4]*f+a[12],o[1]=a[1]*u+a[5]*f+a[13],o},Pr.rotate=function(o,r,a,u){var f=r[0]-a[0],g=r[1]-a[1],v=Math.sin(u),x=Math.cos(u);return o[0]=f*x-g*v+a[0],o[1]=f*v+g*x+a[1],o},Pr.angle=function(o,r){var a=o[0],u=o[1],f=r[0],g=r[1],v=Math.sqrt(a*a+u*u)*Math.sqrt(f*f+g*g);return Math.acos(Math.min(Math.max(v&&(a*f+u*g)/v,-1),1))},Pr.zero=function(o){return o[0]=0,o[1]=0,o},Pr.str=function(o){return"vec2("+o[0]+", "+o[1]+")"},Pr.exactEquals=function(o,r){return o[0]===r[0]&&o[1]===r[1]},Pr.equals=function(o,r){var a=o[0],u=o[1],f=r[0],g=r[1];return Math.abs(a-f)<=D_.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(u-g)<=D_.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))},Pr.forEach=Pr.sqrLen=Pr.sqrDist=Pr.dist=Pr.div=Pr.mul=Pr.sub=Pr.len=void 0;var D_=function(o,r){if(o&&o.__esModule)return o;if(null===o||"object"!==I_(o)&&"function"!=typeof o)return{default:o};var a=nT(void 0);if(a&&a.has(o))return a.get(o);var u={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in o)if("default"!==g&&Object.prototype.hasOwnProperty.call(o,g)){var v=f?Object.getOwnPropertyDescriptor(o,g):null;v&&(v.get||v.set)?Object.defineProperty(u,g,v):u[g]=o[g]}return u.default=o,a&&a.set(o,u),u}(Aa);function nT(o){if("function"!=typeof WeakMap)return null;var r=new WeakMap,a=new WeakMap;return(nT=function(u){return u?a:r})(o)}function SC(){var o=new D_.ARRAY_TYPE(2);return D_.ARRAY_TYPE!=Float32Array&&(o[0]=0,o[1]=0),o}function TC(o,r,a){return o[0]=r[0]-a[0],o[1]=r[1]-a[1],o}function IC(o,r,a){return o[0]=r[0]*a[0],o[1]=r[1]*a[1],o}function B_(o,r,a){return o[0]=r[0]/a[0],o[1]=r[1]/a[1],o}function Dv(o,r){return Math.hypot(r[0]-o[0],r[1]-o[1])}function DC(o,r){var a=r[0]-o[0],u=r[1]-o[1];return a*a+u*u}function Mb(o){return Math.hypot(o[0],o[1])}function Bv(o){var r=o[0],a=o[1];return r*r+a*a}Pr.len=Mb,Pr.sub=TC,Pr.mul=IC,Pr.div=B_,Pr.dist=Dv,Pr.sqrDist=DC,Pr.sqrLen=Bv;var wF=function(){var o=SC();return function(r,a,u,f,g,v){var x,S;for(a||(a=2),u||(u=0),S=f?Math.min(f*a+u,r.length):r.length,x=u;x<S;x+=a)o[0]=r[x],o[1]=r[x+1],g(o,o,v),r[x]=o[0],r[x+1]=o[1];return r}}();function BC(o){return(BC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(o)}Pr.forEach=wF,Object.defineProperty(Ha,"__esModule",{value:!0}),p.a7=Ha.vec4=p.N=Ha.vec3=Ha.vec2=Ha.quat2=p.bi=Ha.quat=p.a6=Ha.mat4=p.co=Ha.mat3=Ha.mat2d=p.b4=Ha.mat2=Ha.glMatrix=void 0;var xF=eA(Aa);Ha.glMatrix=xF;var CF=eA(mo);p.b4=Ha.mat2=CF;var EF=eA(ks);Ha.mat2d=EF;var SF=eA(to);p.co=Ha.mat3=SF;var iT=eA(dr);p.a6=Ha.mat4=iT;var Fb=eA(fr);p.bi=Ha.quat=Fb;var MC=eA(Vr);Ha.quat2=MC;var FC=eA(Pr);Ha.vec2=FC;var TF=eA(cr);p.N=Ha.vec3=TF;var IF=eA(mn);function Rb(o){if("function"!=typeof WeakMap)return null;var r=new WeakMap,a=new WeakMap;return(Rb=function(u){return u?a:r})(o)}function eA(o,r){if(!r&&o&&o.__esModule)return o;if(null===o||"object"!==BC(o)&&"function"!=typeof o)return{default:o};var a=Rb(r);if(a&&a.has(o))return a.get(o);var u={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in o)if("default"!==g&&Object.prototype.hasOwnProperty.call(o,g)){var v=f?Object.getOwnPropertyDescriptor(o,g):null;v&&(v.get||v.set)?Object.defineProperty(u,g,v):u[g]=o[g]}return u.default=o,a&&a.set(o,u),u}p.a7=Ha.vec4=IF;class Kp{constructor(r,a){this.pos=r,this.dir=a}intersectsPlane(r,a,u){const f=p.N.dot(a,this.dir);if(Math.abs(f)<1e-6)return!1;const g=((r[0]-this.pos[0])*a[0]+(r[1]-this.pos[1])*a[1]+(r[2]-this.pos[2])*a[2])/f;return u[0]=this.pos[0]+this.dir[0]*g,u[1]=this.pos[1]+this.dir[1]*g,u[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(r,a,u){if(p.N.equals(this.pos,r)||0===a)return u[0]=u[1]=u[2]=0,!1;const[f,g,v]=this.dir,x=this.pos[0]-r[0],S=this.pos[1]-r[1],T=this.pos[2]-r[2],D=f*f+g*g+v*v,O=2*(x*f+S*g+T*v),z=O*O-4*D*(x*x+S*S+T*T-a*a);if(z<0){const $=Math.max(-O/2,0),K=x+f*$,X=S+g*$,ie=T+v*$,ae=Math.hypot(K,X,ie);return u[0]=K*a/ae,u[1]=X*a/ae,u[2]=ie*a/ae,!1}{const $=(-O-Math.sqrt(z))/(2*D);if($<0){const K=Math.hypot(x,S,T);return u[0]=x*a/K,u[1]=S*a/K,u[2]=T*a/K,!1}return u[0]=x+f*$,u[1]=S+g*$,u[2]=T+v*$,!0}}}class Ob{constructor(r,a,u,f,g){this.TL=r,this.TR=a,this.BR=u,this.BL=f,this.horizon=g}static fromInvProjectionMatrix(r,a,u){const f=[-1,1,1],g=[1,1,1],v=[1,-1,1],x=[-1,-1,1],S=p.N.transformMat4(f,f,r),T=p.N.transformMat4(g,g,r),D=p.N.transformMat4(v,v,r),O=p.N.transformMat4(x,x,r);return new Ob(S,T,D,O,a/u)}}function Z0(o,r,a){let u=1/0,f=-1/0;const g=[];for(const v of o){p.N.sub(g,v,r);const x=p.N.dot(g,a);u=Math.min(u,x),f=Math.max(f,x)}return[u,f]}function rT(o,r){let a=!0;for(let u=0;u<o.planes.length;u++){const f=o.planes[u];let g=0;for(let v=0;v<r.length;v++)g+=p.N.dot(f,r[v])+f[3]>=0;if(0===g)return 0;g!==r.length&&(a=!1)}return a?2:1}function DF(o,r){for(const a of o.projections){const u=Z0(r,o.points[0],a.axis);if(a.projection[1]<u[0]||a.projection[0]>u[1])return 0}return 1}function Mv(o,r){let a=0;const u=[0,0,0,0];for(let f=0;f<o.length;f++)u[0]=o[f][0],u[1]=o[f][1],u[2]=o[f][2],u[3]=1,p.a7.dot(u,r)>=0&&a++;return a}class RC{constructor(r,a){this.points=r||new Array(8).fill([0,0,0]),this.planes=a||new Array(6).fill([0,0,0,0]),this.bounds=ta.fromPoints(this.points),this.projections=[],this.frustumEdges=[p.N.sub([],this.points[2],this.points[3]),p.N.sub([],this.points[0],this.points[3]),p.N.sub([],this.points[4],this.points[0]),p.N.sub([],this.points[5],this.points[1]),p.N.sub([],this.points[6],this.points[2]),p.N.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const f=[0,-u[2],u[1]],g=[u[2],0,-u[0]];this.projections.push({axis:f,projection:Z0(this.points,this.points[0],f)}),this.projections.push({axis:g,projection:Z0(this.points,this.points[0],g)})}}static fromInvProjectionMatrix(r,a,u,f){const g=Math.pow(2,u),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const D=p.a7.transformMat4([],T,r),O=1/D[3]/a*g;return p.a7.mul(D,D,[O,O,f?1/D[3]:O,O])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const D=p.N.sub([],v[T[0]],v[T[1]]),O=p.N.sub([],v[T[2]],v[T[1]]),z=p.N.normalize([],p.N.cross([],D,O)),$=-p.N.dot(z,v[T[1]]);return z.concat($)}),S=[];for(let T=0;T<v.length;T++)S.push([v[T][0],v[T][1],v[T][2]]);return new RC(S,x)}intersectsPrecise(r,a,u){for(let f=0;f<a.length;f++)if(!Mv(r,a[f]))return 0;for(let f=0;f<this.planes.length;f++)if(!Mv(r,this.planes[f]))return 0;for(const f of u)for(const g of this.frustumEdges){const v=p.N.cross([],f,g),x=p.N.length(v);if(0===x)continue;p.N.scale(v,v,1/x);const S=Z0(this.points,this.points[0],v),T=Z0(r,this.points[0],v);if(S[0]>T[1]||T[0]>S[1])return 0}return 1}}class ta{static fromPoints(r){const a=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const f of r)p.N.min(a,a,f),p.N.max(u,u,f);return new ta(a,u)}static fromTileIdAndHeight(r,a,u){const f=1<<r.canonical.z,g=r.canonical.x,v=r.canonical.y;return new ta([g/f,v/f,a],[(g+1)/f,(v+1)/f,u])}static applyTransform(r,a){const u=r.getCorners();for(let f=0;f<u.length;++f)p.N.transformMat4(u[f],u[f],a);return ta.fromPoints(u)}static projectAabbCorners(r,a){const u=r.getCorners();for(let f=0;f<u.length;++f)p.N.transformMat4(u[f],u[f],a);return u}constructor(r,a){this.min=r,this.max=a,this.center=p.N.scale([],p.N.add([],this.min,this.max),.5)}quadrant(r){const a=[r%2==0,r<2],u=p.N.clone(this.min),f=p.N.clone(this.max);for(let g=0;g<a.length;g++)u[g]=a[g]?this.min[g]:this.center[g],f[g]=a[g]?this.center[g]:this.max[g];return f[2]=this.max[2],new ta(u,f)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}getCorners(){const r=this.min,a=this.max;return[[r[0],r[1],r[2]],[a[0],r[1],r[2]],[a[0],a[1],r[2]],[r[0],a[1],r[2]],[r[0],r[1],a[2]],[a[0],r[1],a[2]],[a[0],a[1],a[2]],[r[0],a[1],a[2]]]}intersects(r){return this.intersectsAabb(r.bounds)?rT(r,this.getCorners()):0}intersectsFlat(r){return this.intersectsAabb(r.bounds)?rT(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(r,a){return a||this.intersects(r)?DF(r,this.getCorners()):0}intersectsPreciseFlat(r,a){return a||this.intersectsFlat(r)?DF(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(r){for(let a=0;a<3;++a)if(this.min[a]>r.max[a]||r.min[a]>this.max[a])return!1;return!0}intersectsAabbXY(r){return!(this.min[0]>r.max[0]||r.min[0]>this.max[0]||this.min[1]>r.max[1]||r.min[1]>this.max[1])}encapsulate(r){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],r.min[a]),this.max[a]=Math.max(this.max[a],r.max[a])}encapsulatePoint(r){for(let a=0;a<3;a++)this.min[a]=Math.min(this.min[a],r[a]),this.max[a]=Math.max(this.max[a],r[a])}closestPoint(r){return[Math.max(Math.min(this.max[0],r[0]),this.min[0]),Math.max(Math.min(this.max[1],r[1]),this.min[1]),Math.max(Math.min(this.max[2],r[2]),this.min[2])]}}ai(ta,"Aabb");const sT=bs([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Fv}=sT,OC=bs([{name:"a_pos_3",components:3,type:"Int16"}]);var kC=bs([{name:"a_pos",type:"Int16",components:2}]);function M_(o){return o*xe/Rt}const Rv=[new ta([nt,nt,nt],[dt,dt,dt]),new ta([nt,nt,nt],[0,0,dt]),new ta([0,nt,nt],[dt,0,dt]),new ta([nt,0,nt],[0,dt,dt]),new ta([0,0,nt],[dt,dt,dt])];function PC(o,r,a,u=!0){const f=p.N.scale([],o._camera.position,o.worldSize),g=[r,a,1,1];p.a7.transformMat4(g,g,o.pixelMatrixInverse),p.a7.scale(g,g,1/g[3]);const v=p.N.sub([],g,f),x=p.N.normalize([],v),S=o.globeMatrix,T=[S[12],S[13],S[14]],D=p.N.sub([],T,f),O=p.N.length(D),z=p.N.normalize([],D),$=o.worldSize/(2*Math.PI),K=p.N.dot(z,x),X=Math.asin($/O);if(X<Math.acos(K)){if(!u)return null;const At=[],Kt=[];p.N.scale(At,x,O/K),p.N.normalize(Kt,p.N.sub(Kt,At,D)),p.N.normalize(x,p.N.add(x,D,p.N.scale(x,Kt,Math.tan(X)*O)))}const ie=[];new Kp(f,x).closestPointOnSphere(T,$,ie);const ae=p.N.normalize([],Re(S,0)),be=p.N.normalize([],Re(S,1)),Ce=p.N.normalize([],Re(S,2)),Ee=p.N.dot(ae,ie),Le=p.N.dot(be,ie),Oe=p.N.dot(Ce,ie),qe=Jo(Math.asin(-Le/$));let rt=Jo(Math.atan2(Ee,Oe));rt=o.center.lng+function(At,Kt){const fn=(Kt-At+180)%360-180;return fn<-180?fn+360:fn}(o.center.lng,rt);const ht=gr(rt),It=ir(Ki(qe),0,1);return new Xr(ht,It)}class NC{constructor(r,a,u){this.a=p.N.sub([],r,u),this.b=p.N.sub([],a,u),this.center=u;const f=p.N.normalize([],this.a),g=p.N.normalize([],this.b);this.angle=Math.acos(p.N.dot(f,g))}}function X0(o,r){if(0===o.angle)return null;let a;return a=0===o.a[r]?1/o.angle*.5*Math.PI:1/o.angle*Math.atan(o.b[r]/o.a[r]/Math.sin(o.angle)-1/Math.tan(o.angle)),a<0||a>1?null:function(u,f,g,v){const x=Math.sin(g);return u*(Math.sin((1-v)*g)/x)+f*(Math.sin(v*g)/x)}(o.a[r],o.b[r],o.angle,ir(a,0,1))+o.center[r]}function tA(o){if(o.z<=1)return Rv[o.z+2*o.y+o.x];const r=LC(Ov(o));return ta.fromPoints(r)}function nA(o,r,a){return p.N.scale(o,o,1-a),p.N.scaleAndAdd(o,o,r,a)}function Y0(o,r,a){for(const u of o)p.N.transformMat4(u,u,r),p.N.scale(u,u,a)}function oT(o,r,a,u){const f=r/o.worldSize,g=o.globeMatrix;if(a.z<=1){const ht=tA(a).getCorners();return Y0(ht,g,f),ta.fromPoints(ht)}const v=Ov(a,u),x=LC(v,xe+M_(o._tileCoverLift));Y0(x,g,f);const S=Number.MAX_VALUE,T=[-S,-S,-S],D=[S,S,S];if(v.contains(o.center)){for(const At of x)p.N.min(D,D,At),p.N.max(T,T,At);T[2]=0;const ht=o.point,It=[ht.x*f,ht.y*f,0];return p.N.min(D,D,It),p.N.max(T,T,It),new ta(D,T)}if(o._tileCoverLift>0){for(const ht of x)p.N.min(D,D,ht),p.N.max(T,T,ht);return new ta(D,T)}const O=[g[12]*f,g[13]*f,g[14]*f],z=v.getCenter(),$=ir(o.center.lat,-Fr,Fr),K=ir(z.lat,-Fr,Fr),X=gr(o.center.lng),ie=Ki($);let ae=X-gr(z.lng);const be=ie-Ki(K);ae>.5?ae-=1:ae<-.5&&(ae+=1);let Ce=0;if(Math.abs(ae)>Math.abs(be))Ce=ae>=0?1:3;else{Ce=be>=0?0:2;const ht=[g[4]*f,g[5]*f,g[6]*f],It=-Math.sin(Sr(be>=0?v.getSouth():v.getNorth()))*xe;p.N.scaleAndAdd(O,O,ht,It)}const Ee=x[Ce],Le=x[(Ce+1)%4],Oe=new NC(Ee,Le,O),qe=[X0(Oe,0)||Ee[0],X0(Oe,1)||Ee[1],X0(Oe,2)||Ee[2]],rt=gm(o.zoom);if(rt>0){const ht=function({x:At,y:Kt,z:fn},Ut,Dt,Bt,an){const Mn=1/(1<<fn);let on=At*Mn,ri=on+Mn,Kn=Kt*Mn,bn=Kn+Mn,Hi=0;const Ei=(on+ri)/2-Bt;return Ei>.5?Hi=-1:Ei<-.5&&(Hi=1),on=((on+Hi)*Ut-(Bt*=Ut))*Dt+Bt,ri=((ri+Hi)*Ut-Bt)*Dt+Bt,Kn=(Kn*Ut-(an*=Ut))*Dt+an,bn=(bn*Ut-an)*Dt+an,[[on,bn,0],[ri,bn,0],[ri,Kn,0],[on,Kn,0]]}(a,r,o._pixelsPerMercatorPixel,X,ie);for(let At=0;At<x.length;At++)nA(x[At],ht[At],rt);const It=p.N.add([],ht[Ce],ht[(Ce+1)%4]);p.N.scale(It,It,.5),nA(qe,It,rt)}for(const ht of x)p.N.min(D,D,ht),p.N.max(T,T,ht);return D[2]=Math.min(Ee[2],Le[2]),p.N.min(D,D,qe),p.N.max(T,T,qe),new ta(D,T)}function Ov({x:o,y:r,z:a},u=!1){const f=1/(1<<a),g=new ct(rr(o*f),r===(1<<a)-1&&u?-90:kr((r+1)*f)),v=new ct(rr((o+1)*f),0===r&&u?90:kr(r*f));return new St(g,v)}function LC(o,r=xe){const a=Sr(o.getNorth()),u=Sr(o.getSouth()),f=Math.cos(a),g=Math.cos(u),v=Math.sin(a),x=Math.sin(u),S=o.getWest(),T=o.getEast();return[ot(g,x,S,r),ot(g,x,T,r),ot(f,v,T,r),ot(f,v,S,r)]}function kv(o,r,a,u){const f=1<<a.z,g=(o/Jn+a.x)/f;return Pt(kr((r/Jn+a.y)/f),rr(g),u)}function kb({min:o,max:r}){return Me/Math.max(r[0]-o[0],r[1]-o[1],r[2]-o[2])}const UC=new Float64Array(16);function Pv(o){const r=kb(o),a=p.a6.fromScaling(UC,[r,r,r]);return p.a6.translate(a,a,p.N.negate([],o.min))}function J0(o){const r=p.a6.fromTranslation(UC,o.min),a=1/kb(o);return p.a6.scale(r,r,[a,a,a])}function Nv(o){const r=Jn/(2*Math.PI);return o/(2*Math.PI)/r}function F_(o,r){return Jn/(512*Math.pow(2,o))*kb(tA(r))}function aT(o,r,a,u,f){const g=Nv(a),v=[o,r,-a/(2*Math.PI)],x=p.a6.identity(new Float64Array(16));return p.a6.translate(x,x,v),p.a6.scale(x,x,[g,g,g]),p.a6.rotateX(x,x,Sr(-f)),p.a6.rotateY(x,x,Sr(-u)),x}function gm(o){return Od(Be,ge,o)}function BF(o,r){const a=Pt(r.lat,r.lng),u=function(g){const v=Pt(g._center.lat,g._center.lng),x=p.N.fromValues(0,1,0);let S=p.N.cross([],x,v);const T=p.a6.fromRotation([],-g.angle,v);S=p.N.transformMat4(S,S,T),p.a6.fromRotation(T,-g._pitch,S);const D=p.N.normalize([],v);return p.N.scale(D,D,M_(g.cameraToCenterDistance/g.pixelsPerMeter)),p.N.transformMat4(D,D,T),p.N.add([],v,D)}(o),f=p.N.subtract([],u,a);return p.N.angle(f,a)}function zC(o,r){return BF(o,r)>Math.PI/2*1.01}const Pb=Sr(85),MF=Math.cos(Pb),ey=Math.sin(Pb),Nb=p.a6.create(),Lb=o=>{const r=[];return"map"===o.paint.get("circle-pitch-alignment")&&r.push("PITCH_WITH_MAP"),"map"===o.paint.get("circle-pitch-scale")&&r.push("SCALE_WITH_MAP"),r};function VC(o,r,a,u,f,g,v,x,S){if(g&&o.queryGeometry.isAboveHorizon)return!1;g&&(S*=o.pixelToTileUnitsFactor);const T=o.tileID.canonical,D=a.projection.upVectorScale(T,a.center.lat,a.worldSize).metersToTile;for(const O of r)for(const z of O){const $=z.add(x),K=f&&a.elevation?a.elevation.exaggeration()*f.getElevationAt($.x,$.y,!0):0,X=a.projection.projectTilePoint($.x,$.y,T);if(K>0){const Ce=a.projection.upVector(T,$.x,$.y);X.x+=Ce[0]*D*K,X.y+=Ce[1]*D*K,X.z+=Ce[2]*D*K}const ie=g?$:lT(X.x,X.y,X.z,u),ae=g?o.tilespaceRays.map(Ce=>FF(Ce,K)):o.queryGeometry.screenGeometry,be=p.a7.transformMat4([],[X.x,X.y,X.z,1],u);if(!v&&g?S*=be[3]/a.cameraToCenterDistance:v&&!g&&(S*=a.cameraToCenterDistance/be[3]),g){const Ce=kr((z.y/Jn+T.y)/(1<<T.z));S/=a.projection.pixelsPerMeter(Ce,1)/lr(1,Ce)}if(_l(ae,ie,S))return!0}return!1}function lT(o,r,a,u){const f=p.a7.transformMat4([],[o,r,a,1],u);return new Nn(f[0]/f[3],f[1]/f[3])}const HC=p.N.fromValues(0,0,0),cT=p.N.fromValues(0,0,1);function FF(o,r){const a=p.N.create();return HC[2]=r,o.intersectsPlane(HC,cT,a),new Nn(a[0],a[1])}class uT extends $c{}function hT(o,{width:r,height:a},u,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==r*a*u)throw new RangeError("mismatched image size")}else f=new Uint8Array(r*a*u);return o.width=r,o.height=a,o.data=f,o}function dT(o,r,a){const{width:u,height:f}=r;u===o.width&&f===o.height||(QC(o,r,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,u),height:Math.min(o.height,f)},a),o.width=u,o.height=f,o.data=r.data)}function QC(o,r,a,u,f,g,v){if(0===f.width||0===f.height)return r;if(f.width>o.width||f.height>o.height||a.x>o.width-f.width||a.y>o.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>r.width||f.height>r.height||u.x>r.width-f.width||u.y>r.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const x=o.data,S=r.data,T=4===g&&v;for(let D=0;D<f.height;D++){const O=((a.y+D)*o.width+a.x)*g,z=((u.y+D)*r.width+u.x)*g;if(T)for(let $=0;$<f.width;$++){const K=O+$*g+3,X=z+$*g;S[X+0]=255,S[X+1]=255,S[X+2]=255,S[X+3]=x[K]}else for(let $=0;$<f.width*g;$++)S[z+$]=x[O+$]}return r}ai(uT,"HeatmapBucket",{omit:["layers"]});class gh{constructor(r,a){hT(this,r,1,a)}resize(r){dT(this,new gh(r),1)}clone(){return new gh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,u,f,g){QC(r,a,u,f,g,1)}}class mu{constructor(r,a){hT(this,r,4,a)}resize(r){dT(this,new mu(r),4)}replace(r,a){a?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new mu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,u,f,g,v){QC(r,a,u,f,g,4,v)}}class fT{constructor(r,a){this.width=r.width,this.height=r.height,this.data=a instanceof Uint8Array?new Float32Array(a.buffer):a}}ai(gh,"AlphaImage"),ai(mu,"RGBAImage");const GN=new ko({visibility:new Rn(bt.layout_heatmap.visibility)});var $N={paint:new ko({"heatmap-radius":new wi(bt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new wi(bt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Rn(bt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ah(bt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Rn(bt.paint_heatmap["heatmap-opacity"])}),layout:GN};function Ub(o){const r={},a=o.resolution||256,u=o.clips?o.clips.length:1,f=o.image||new mu({width:a,height:u}),g=(v,x,S)=>{r[o.evaluationKey]=S;const T=o.expression.evaluate(r);T&&(f.data[v+x+0]=Math.floor(255*T.r/T.a),f.data[v+x+1]=Math.floor(255*T.g/T.a),f.data[v+x+2]=Math.floor(255*T.b/T.a),f.data[v+x+3]=Math.floor(255*T.a))};if(o.clips)for(let v=0,x=0;v<u;++v,x+=4*a)for(let S=0,T=0;S<a;S++,T+=4){const D=S/(a-1),{start:O,end:z}=o.clips[v];g(x,T,O*(1-D)+z*D)}else for(let v=0,x=0;v<a;v++,x+=4)g(0,x,v/(a-1));return f}const qN=new ko({visibility:new Rn(bt.layout_hillshade.visibility)});var KN={paint:new ko({"hillshade-illumination-direction":new Rn(bt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Rn(bt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Rn(bt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Rn(bt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Rn(bt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Rn(bt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Rn(bt.paint_hillshade["hillshade-emissive-strength"])}),layout:qN};const AT=bs([{name:"a_pos",components:2,type:"Int16"}],4),{members:RF}=AT;var jC={exports:{}};function zb(o,r,a){a=a||2;var u,f,g,v,x,S,T,D=r&&r.length,O=D?r[0]*a:o.length,z=pT(o,0,O,a,!0),$=[];if(!z||z.next===z.prev)return $;if(D&&(z=function(X,ie,ae,be){var Ce,Ee,Le,Oe=[];for(Ce=0,Ee=ie.length;Ce<Ee;Ce++)(Le=pT(X,ie[Ce]*be,Ce<Ee-1?ie[Ce+1]*be:X.length,be,!1))===Le.next&&(Le.steiner=!0),Oe.push(GC(Le));for(Oe.sort(WN),Ce=0;Ce<Oe.length;Ce++)ae=ZN(Oe[Ce],ae);return ae}(o,r,z,a)),o.length>80*a){u=g=o[0],f=v=o[1];for(var K=a;K<O;K+=a)(x=o[K])<u&&(u=x),(S=o[K+1])<f&&(f=S),x>g&&(g=x),S>v&&(v=S);T=0!==(T=Math.max(g-u,v-f))?32767/T:0}return Cd(z,$,a,u,f,T,0),$}function pT(o,r,a,u,f){var g,v;if(f===mm(o,r,a,u)>0)for(g=r;g<a;g+=u)v=vT(g,o[g],o[g+1],v);else for(g=a-u;g>=r;g-=u)v=vT(g,o[g],o[g+1],v);return v&&Vb(v,v.next)&&(R_(v),v=v.next),v}function Wp(o,r){if(!o)return o;r||(r=o);var a,u=o;do{if(a=!1,u.steiner||!Vb(u,u.next)&&0!==il(u.prev,u,u.next))u=u.next;else{if(R_(u),(u=r=u.prev)===u.next)break;a=!0}}while(a||u!==r);return r}function Cd(o,r,a,u,f,g,v){if(o){!v&&g&&function(D,O,z,$){var K=D;do{0===K.z&&(K.z=Uv(K.x,K.y,O,z,$)),K.prevZ=K.prev,K.nextZ=K.next,K=K.next}while(K!==D);K.prevZ.nextZ=null,K.prevZ=null,function(X){var ie,ae,be,Ce,Ee,Le,Oe,qe,rt=1;do{for(ae=X,X=null,Ee=null,Le=0;ae;){for(Le++,be=ae,Oe=0,ie=0;ie<rt&&(Oe++,be=be.nextZ);ie++);for(qe=rt;Oe>0||qe>0&&be;)0!==Oe&&(0===qe||!be||ae.z<=be.z)?(Ce=ae,ae=ae.nextZ,Oe--):(Ce=be,be=be.nextZ,qe--),Ee?Ee.nextZ=Ce:X=Ce,Ce.prevZ=Ee,Ee=Ce;ae=be}Ee.nextZ=null,rt*=2}while(Le>1)}(K)}(o,u,f,g);for(var x,S,T=o;o.prev!==o.next;)if(x=o.prev,S=o.next,g?gT(o,u,f,g):Lv(o))r.push(x.i/a|0),r.push(o.i/a|0),r.push(S.i/a|0),R_(o),o=S.next,T=S.next;else if((o=S)===T){v?1===v?Cd(o=mT(Wp(o),r,a),r,a,u,f,g,2):2===v&&_T(o,r,a,u,f,g):Cd(Wp(o),r,a,u,f,g,1);break}}}function Lv(o){var r=o.prev,a=o,u=o.next;if(il(r,a,u)>=0)return!1;for(var f=r.x,g=a.x,v=u.x,x=r.y,S=a.y,T=u.y,D=f<g?f<v?f:v:g<v?g:v,O=x<S?x<T?x:T:S<T?S:T,z=f>g?f>v?f:v:g>v?g:v,$=x>S?x>T?x:T:S>T?S:T,K=u.next;K!==r;){if(K.x>=D&&K.x<=z&&K.y>=O&&K.y<=$&&zv(f,x,g,S,v,T,K.x,K.y)&&il(K.prev,K,K.next)>=0)return!1;K=K.next}return!0}function gT(o,r,a,u){var f=o.prev,g=o,v=o.next;if(il(f,g,v)>=0)return!1;for(var x=f.x,S=g.x,T=v.x,D=f.y,O=g.y,z=v.y,$=x<S?x<T?x:T:S<T?S:T,K=D<O?D<z?D:z:O<z?O:z,X=x>S?x>T?x:T:S>T?S:T,ie=D>O?D>z?D:z:O>z?O:z,ae=Uv($,K,r,a,u),be=Uv(X,ie,r,a,u),Ce=o.prevZ,Ee=o.nextZ;Ce&&Ce.z>=ae&&Ee&&Ee.z<=be;){if(Ce.x>=$&&Ce.x<=X&&Ce.y>=K&&Ce.y<=ie&&Ce!==f&&Ce!==v&&zv(x,D,S,O,T,z,Ce.x,Ce.y)&&il(Ce.prev,Ce,Ce.next)>=0||(Ce=Ce.prevZ,Ee.x>=$&&Ee.x<=X&&Ee.y>=K&&Ee.y<=ie&&Ee!==f&&Ee!==v&&zv(x,D,S,O,T,z,Ee.x,Ee.y)&&il(Ee.prev,Ee,Ee.next)>=0))return!1;Ee=Ee.nextZ}for(;Ce&&Ce.z>=ae;){if(Ce.x>=$&&Ce.x<=X&&Ce.y>=K&&Ce.y<=ie&&Ce!==f&&Ce!==v&&zv(x,D,S,O,T,z,Ce.x,Ce.y)&&il(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.prevZ}for(;Ee&&Ee.z<=be;){if(Ee.x>=$&&Ee.x<=X&&Ee.y>=K&&Ee.y<=ie&&Ee!==f&&Ee!==v&&zv(x,D,S,O,T,z,Ee.x,Ee.y)&&il(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.nextZ}return!0}function mT(o,r,a){var u=o;do{var f=u.prev,g=u.next.next;!Vb(f,g)&&yT(f,u,u.next,g)&&ty(f,g)&&ty(g,f)&&(r.push(f.i/a|0),r.push(u.i/a|0),r.push(g.i/a|0),R_(u),R_(u.next),u=o=g),u=u.next}while(u!==o);return Wp(u)}function _T(o,r,a,u,f,g){var v=o;do{for(var x=v.next.next;x!==v.prev;){if(v.i!==x.i&&YN(v,x)){var S=Vv(v,x);return v=Wp(v,v.next),S=Wp(S,S.next),Cd(v,r,a,u,f,g,0),void Cd(S,r,a,u,f,g,0)}x=x.next}v=v.next}while(v!==o)}function WN(o,r){return o.x-r.x}function ZN(o,r){var a=function(f,g){var v,x=g,S=f.x,T=f.y,D=-1/0;do{if(T<=x.y&&T>=x.next.y&&x.next.y!==x.y){var O=x.x+(T-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(O<=S&&O>D&&(D=O,v=x.x<x.next.x?x:x.next,O===S))return v}x=x.next}while(x!==g);if(!v)return null;var z,$=v,K=v.x,X=v.y,ie=1/0;x=v;do{S>=x.x&&x.x>=K&&S!==x.x&&zv(T<X?S:D,T,K,X,T<X?D:S,T,x.x,x.y)&&(z=Math.abs(T-x.y)/(S-x.x),ty(x,f)&&(z<ie||z===ie&&(x.x>v.x||x.x===v.x&&XN(v,x)))&&(v=x,ie=z)),x=x.next}while(x!==$);return v}(o,r);if(!a)return r;var u=Vv(a,o);return Wp(u,u.next),Wp(a,a.next)}function XN(o,r){return il(o.prev,o,r.prev)<0&&il(r.next,o,o.next)<0}function Uv(o,r,a,u,f){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-a)*f|0)|o<<8))|o<<4))|o<<2))|o<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-u)*f|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function GC(o){var r=o,a=o;do{(r.x<a.x||r.x===a.x&&r.y<a.y)&&(a=r),r=r.next}while(r!==o);return a}function zv(o,r,a,u,f,g,v,x){return(f-v)*(r-x)>=(o-v)*(g-x)&&(o-v)*(u-x)>=(a-v)*(r-x)&&(a-v)*(g-x)>=(f-v)*(u-x)}function YN(o,r){return o.next.i!==r.i&&o.prev.i!==r.i&&!function(a,u){var f=a;do{if(f.i!==a.i&&f.next.i!==a.i&&f.i!==u.i&&f.next.i!==u.i&&yT(f,f.next,a,u))return!0;f=f.next}while(f!==a);return!1}(o,r)&&(ty(o,r)&&ty(r,o)&&function(a,u){var f=a,g=!1,v=(a.x+u.x)/2,x=(a.y+u.y)/2;do{f.y>x!=f.next.y>x&&f.next.y!==f.y&&v<(f.next.x-f.x)*(x-f.y)/(f.next.y-f.y)+f.x&&(g=!g),f=f.next}while(f!==a);return g}(o,r)&&(il(o.prev,o,r.prev)||il(o,r.prev,r))||Vb(o,r)&&il(o.prev,o,o.next)>0&&il(r.prev,r,r.next)>0)}function il(o,r,a){return(r.y-o.y)*(a.x-r.x)-(r.x-o.x)*(a.y-r.y)}function Vb(o,r){return o.x===r.x&&o.y===r.y}function yT(o,r,a,u){var f=Qb(il(o,r,a)),g=Qb(il(o,r,u)),v=Qb(il(a,u,o)),x=Qb(il(a,u,r));return f!==g&&v!==x||!(0!==f||!Hb(o,a,r))||!(0!==g||!Hb(o,u,r))||!(0!==v||!Hb(a,o,u))||!(0!==x||!Hb(a,r,u))}function Hb(o,r,a){return r.x<=Math.max(o.x,a.x)&&r.x>=Math.min(o.x,a.x)&&r.y<=Math.max(o.y,a.y)&&r.y>=Math.min(o.y,a.y)}function Qb(o){return o>0?1:o<0?-1:0}function ty(o,r){return il(o.prev,o,o.next)<0?il(o,r,o.next)>=0&&il(o,o.prev,r)>=0:il(o,r,o.prev)<0||il(o,o.next,r)<0}function Vv(o,r){var a=new $C(o.i,o.x,o.y),u=new $C(r.i,r.x,r.y),f=o.next,g=r.prev;return o.next=r,r.prev=o,a.next=f,f.prev=a,u.next=a,a.prev=u,g.next=u,u.prev=g,u}function vT(o,r,a,u){var f=new $C(o,r,a);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function R_(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function $C(o,r,a){this.i=o,this.x=r,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function mm(o,r,a,u){for(var f=0,g=r,v=a-u;g<a;g+=u)f+=(o[v]-o[g])*(o[g+1]+o[v+1]),v=g;return f}jC.exports=zb,jC.exports.default=zb,zb.deviation=function(o,r,a,u){var f=r&&r.length,g=Math.abs(mm(o,0,f?r[0]*a:o.length,a));if(f)for(var v=0,x=r.length;v<x;v++)g-=Math.abs(mm(o,r[v]*a,v<x-1?r[v+1]*a:o.length,a));var S=0;for(v=0;v<u.length;v+=3){var T=u[v]*a,D=u[v+1]*a,O=u[v+2]*a;S+=Math.abs((o[T]-o[O])*(o[D+1]-o[T+1])-(o[T]-o[D])*(o[O+1]-o[T+1]))}return 0===g&&0===S?0:Math.abs((S-g)/g)},zb.flatten=function(o){for(var r=o[0][0].length,a={vertices:[],holes:[],dimensions:r},u=0,f=0;f<o.length;f++){for(var g=0;g<o[f].length;g++)for(var v=0;v<r;v++)a.vertices.push(o[f][g][v]);f>0&&a.holes.push(u+=o[f-1].length)}return a};var jb=Ta(jC.exports);function qC(o,r){const a=o.length;if(a<=1)return[o];const u=[];let f,g;for(let v=0;v<a;v++){const x=Cu(o[v]);0!==x&&(o[v].area=Math.abs(x),void 0===g&&(g=x<0),g===x<0?(f&&u.push(f),f=[o[v]]):f.push(o[v]))}if(f&&u.push(f),r>1)for(let v=0;v<u.length;v++)u[v].length<=r||(Ju(u[v],r,1,u[v].length-1,bT),u[v]=u[v].slice(0,r));return u}function bT(o,r){return r.area-o.area}function Gb(o,r,a){const u=a.patternDependencies;let f=!1;for(const g of r){const v=g.paint.get(`${o}-pattern`);v.isConstant()||(f=!0);const x=v.constantOr(null);x&&(f=!0,u[x]=!0)}return f}function KC(o,r,a,u,f){const g=f.patternDependencies;for(const v of r){const x=v.paint.get(`${o}-pattern`).value;if("constant"!==x.kind){let S=x.evaluate({zoom:u},a,{},f.availableImages);S=S&&S.name?S.name:S,g[S]=!0,a.patterns[v.id]=S}}return a}class WC{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Hs,this.indexArray=new el,this.indexArray2=new fu,this.programConfigurations=new le(r.layers,r.zoom),this.segments=new zo,this.segments2=new zo,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=r.projection}populate(r,a,u,f){this.hasPattern=Gb("fill",this.layers,a);const g=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:x,id:S,index:T,sourceLayerIndex:D}of r){const O=this.layers[0]._featureFilter.needGeometry,z=fa(x,O);if(!this.layers[0]._featureFilter.filter(new uo(this.zoom),z,u))continue;const $=g?g.evaluate(z,{},u,a.availableImages):void 0,K={id:S,properties:x.properties,type:x.type,sourceLayerIndex:D,index:T,geometry:O?z.geometry:oo(x,u,f),patterns:{},sortKey:$};v.push(K)}g&&v.sort((x,S)=>x.sortKey-S.sortKey);for(const x of v){const{geometry:S,index:T,sourceLayerIndex:D}=x;if(this.hasPattern){const O=KC("fill",this.layers,x,this.zoom,a);this.patternFeatures.push(O)}else this.addFeature(x,S,T,u,{},a.availableImages,a.brightness);a.featureIndex.insert(r[T].feature,S,T,D,this.index)}}update(r,a,u,f,g){const v=0!==Object.keys(r).length;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(r,a,v?this.stateDependentLayers:this.layers,u,f,g)}addFeatures(r,a,u,f,g,v){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,a,u,f,v)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,RF),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,a,u,f,g,v=[],x){for(const S of qC(a,500)){let T=0;for(const X of S)T+=X.length;const D=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),O=D.vertexLength,z=[],$=[];for(const X of S){if(0===X.length)continue;X!==S[0]&&$.push(z.length/2);const ie=this.segments2.prepareSegment(X.length,this.layoutVertexArray,this.indexArray2),ae=ie.vertexLength;this.layoutVertexArray.emplaceBack(X[0].x,X[0].y),this.indexArray2.emplaceBack(ae+X.length-1,ae),z.push(X[0].x),z.push(X[0].y);for(let be=1;be<X.length;be++)this.layoutVertexArray.emplaceBack(X[be].x,X[be].y),this.indexArray2.emplaceBack(ae+be-1,ae+be),z.push(X[be].x),z.push(X[be].y);ie.vertexLength+=X.length,ie.primitiveLength+=X.length}const K=jb(z,$);for(let X=0;X<K.length;X+=3)this.indexArray.emplaceBack(O+K[X],O+K[X+1],O+K[X+2]);D.vertexLength+=T,D.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,g,v,f,x)}}ai(WC,"FillBucket",{omit:["layers","patternFeatures"]});const OF=new ko({"fill-sort-key":new wi(bt.layout_fill["fill-sort-key"]),visibility:new Rn(bt.layout_fill.visibility)});var kF={paint:new ko({"fill-antialias":new Rn(bt.paint_fill["fill-antialias"]),"fill-opacity":new wi(bt.paint_fill["fill-opacity"]),"fill-color":new wi(bt.paint_fill["fill-color"]),"fill-outline-color":new wi(bt.paint_fill["fill-outline-color"]),"fill-translate":new Rn(bt.paint_fill["fill-translate"]),"fill-translate-anchor":new Rn(bt.paint_fill["fill-translate-anchor"]),"fill-pattern":new wi(bt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Rn(bt.paint_fill["fill-emissive-strength"])}),layout:OF};const wT=bs([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),JN=bs([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),eL=bs([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Hv=bs([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Qv=bs([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:xT}=wT;var jv={},ZC=Ul,ny=iy;function iy(o,r,a,u,f){this.properties={},this.extent=a,this.type=0,this._pbf=o,this._geometry=-1,this._keys=u,this._values=f,o.readFields(CT,this,r)}function CT(o,r,a){1==o?r.id=a.readVarint():2==o?function(u,f){for(var g=u.readVarint()+u.pos;u.pos<g;){var v=f._keys[u.readVarint()],x=f._values[u.readVarint()];f.properties[v]=x}}(a,r):3==o?r.type=a.readVarint():4==o&&(r._geometry=a.pos)}function ET(o){for(var r,a,u=0,f=0,g=o.length,v=g-1;f<g;v=f++)u+=((a=o[v]).x-(r=o[f]).x)*(r.y+a.y);return u}iy.types=["Unknown","Point","LineString","Polygon"],iy.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var r,a=o.readVarint()+o.pos,u=1,f=0,g=0,v=0,x=[];o.pos<a;){if(f<=0){var S=o.readVarint();u=7&S,f=S>>3}if(f--,1===u||2===u)g+=o.readSVarint(),v+=o.readSVarint(),1===u&&(r&&x.push(r),r=[]),r.push(new ZC(g,v));else{if(7!==u)throw new Error("unknown command "+u);r&&r.push(r[0].clone())}}return r&&x.push(r),x},iy.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var r=o.readVarint()+o.pos,a=1,u=0,f=0,g=0,v=1/0,x=-1/0,S=1/0,T=-1/0;o.pos<r;){if(u<=0){var D=o.readVarint();a=7&D,u=D>>3}if(u--,1===a||2===a)(f+=o.readSVarint())<v&&(v=f),f>x&&(x=f),(g+=o.readSVarint())<S&&(S=g),g>T&&(T=g);else if(7!==a)throw new Error("unknown command "+a)}return[v,S,x,T]},iy.prototype.toGeoJSON=function(o,r,a){var u,f,g=this.extent*Math.pow(2,a),v=this.extent*o,x=this.extent*r,S=this.loadGeometry(),T=iy.types[this.type];function D($){for(var K=0;K<$.length;K++){var X=$[K];$[K]=[360*(X.x+v)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(X.y+x)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var O=[];for(u=0;u<S.length;u++)O[u]=S[u][0];D(S=O);break;case 2:for(u=0;u<S.length;u++)D(S[u]);break;case 3:for(S=function($){var K=$.length;if(K<=1)return[$];for(var X,ie,ae=[],be=0;be<K;be++){var Ce=ET($[be]);0!==Ce&&(void 0===ie&&(ie=Ce<0),ie===Ce<0?(X&&ae.push(X),X=[$[be]]):X.push($[be]))}return X&&ae.push(X),ae}(S),u=0;u<S.length;u++)for(f=0;f<S[u].length;f++)D(S[u][f])}1===S.length?S=S[0]:T="Multi"+T;var z={type:"Feature",geometry:{type:T,coordinates:S},properties:this.properties};return"id"in this&&(z.id=this.id),z};var $b=ny,PF=qb;function qb(o,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(NF,this,r),this.length=this._features.length}function NF(o,r,a){15===o?r.version=a.readVarint():1===o?r.name=a.readString():5===o?r.extent=a.readVarint():2===o?r._features.push(a.pos):3===o?r._keys.push(a.readString()):4===o&&r._values.push(function(u){for(var f=null,g=u.readVarint()+u.pos;u.pos<g;){var v=u.readVarint()>>3;f=1===v?u.readString():2===v?u.readFloat():3===v?u.readDouble():4===v?u.readVarint64():5===v?u.readVarint():6===v?u.readSVarint():7===v?u.readBoolean():null}return f}(a))}qb.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var r=this._pbf.readVarint()+this._pbf.pos;return new $b(this._pbf,r,this.extent,this._keys,this._values)};var XC=PF;function ST(o,r,a){if(3===o){var u=new XC(a,a.readVarint()+a.pos);u.length&&(r[u.name]=u)}}var Kb=jv.VectorTile=function(o,r){this.layers=o.readFields(ST,{},r)},JA=jv.VectorTileFeature=ny;function Wb(o,r,a,u){const f=[],g=0===u?(v,x,S,T,D,O)=>{v.push(new Nn(O,S+(O-x)/(T-x)*(D-S)))}:(v,x,S,T,D,O)=>{v.push(new Nn(x+(O-S)/(D-S)*(T-x),O))};for(const v of o){const x=[];for(const S of v){if(S.length<=2)continue;const T=[];for(let z=0;z<S.length-1;z++){const $=S[z].x,K=S[z].y,X=S[z+1].x,ie=S[z+1].y,ae=0===u?$:K,be=0===u?X:ie;ae<r?be>r&&g(T,$,K,X,ie,r):ae>a?be<a&&g(T,$,K,X,ie,a):T.push(S[z]),be<r&&ae>=r&&g(T,$,K,X,ie,r),be>a&&ae<=a&&g(T,$,K,X,ie,a)}let D=S[S.length-1];const O=0===u?D.x:D.y;O>=r&&O<=a&&T.push(D),T.length&&(D=T[T.length-1],T[0].x===D.x&&T[0].y===D.y||T.push(T[0]),x.push(T))}x.length&&f.push(x)}return f}function ry(o,r){return o.x-r.x||o.y-r.y}function Gv(o,r){return 0===ry(o.min,r.min)&&0===ry(o.max,r.max)}function TT(o,r){return!(o.min.x>r.max.x||o.max.x<r.min.x||o.min.y>r.max.y||o.max.y<r.min.y)}function Zb(o,r,a){const u=1/Jn,f=1/(1<<a.canonical.z),g=(r.x*u+a.canonical.x)*f+a.wrap,v=(r.y*u+a.canonical.y)*f;return{min:new Nn((o.x*u+a.canonical.x)*f+a.wrap,(o.y*u+a.canonical.y)*f),max:new Nn(g,v)}}function Xb(o,r,a){const u=1<<a.canonical.z,f=((r.x-a.wrap)*u-a.canonical.x)*Jn,g=(r.y*u-a.canonical.y)*Jn;return{min:new Nn(((o.x-a.wrap)*u-a.canonical.x)*Jn,(o.y*u-a.canonical.y)*Jn),max:new Nn(f,g)}}function Lu(o,r,a,u,f,g,v){const x=o.indices,S=o.vertices,T=[];for(let D=u;D<u+f;D+=3){const O=r[a[D+0]+g],z=r[a[D+1]+g],$=r[a[D+2]+g],K=Math.min(O.x,z.x,$.x),X=Math.max(O.x,z.x,$.x),ie=Math.min(O.y,z.y,$.y),ae=Math.max(O.y,z.y,$.y);T.length=0,o.grid.query(new Nn(K,ie),new Nn(X,ae),T);for(let be=0;be<T.length;be++){const Ce=T[be];if(_b(S[x[3*Ce+0]],S[x[3*Ce+1]],S[x[3*Ce+2]],O,z,$,v))return!0}}return!1}function O_(o,r,a,u){if(!o||!a)return!1;let f=o.vertices;if(!r.canonical.equals(u.canonical)||r.wrap!==u.wrap){if(a.vertices.length<o.vertices.length)return O_(a,u,o,r);const g=r.canonical,v=u.canonical,x=Math.pow(2,v.z-g.z);f=o.vertices.map(S=>new Nn(S.x*g.x*Jn*x-v.x*Jn,S.y*g.y*Jn*x-v.y*Jn))}return Lu(a,f,o.indices,0,o.indices.length,0,0)}jv.VectorTileLayer=PF;class Yb{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,a){const u=this.toIdx(r,a);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(r,a){return this.leaves[this.toIdx(r,a)]}toIdx(r,a){return a*this.size+r}}function IT(o,r,a,u){let f=0,g=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(u[v])<1e-15){if(a[v]<o[v]||a[v]>r[v])return null}else{const x=1/u[v];let S=(o[v]-a[v])*x,T=(r[v]-a[v])*x;if(S>T){const D=S;S=T,T=D}if(S>f&&(f=S),T<g&&(g=T),f>g)return null}return f}function DT(o,r,a,u,f,g,v,x,S,T,D){const O=u-o,z=f-r,$=g-a,K=v-o,X=x-r,ie=S-a,ae=D[1]*ie-D[2]*X,be=D[2]*K-D[0]*ie,Ce=D[0]*X-D[1]*K,Ee=O*ae+z*be+$*Ce;if(Math.abs(Ee)<1e-15)return null;const Le=1/Ee,Oe=T[0]-o,qe=T[1]-r,rt=T[2]-a,ht=(Oe*ae+qe*be+rt*Ce)*Le;if(ht<0||ht>1)return null;const It=qe*$-rt*z,At=rt*O-Oe*$,Kt=Oe*z-qe*O,fn=(D[0]*It+D[1]*At+D[2]*Kt)*Le;return fn<0||ht+fn>1?null:(K*It+X*At+ie*Kt)*Le}function YC(o,r,a){return(o-r)/(a-r)}function k_(o,r,a,u,f,g,v,x,S){const T=1<<a,D=g-u,O=v-f,z=(o+1)/T*D+u,$=(r+0)/T*O+f,K=(r+1)/T*O+f;x[0]=(o+0)/T*D+u,x[1]=$,S[0]=z,S[1]=K}class BT{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=function(g){const v=Math.ceil(Math.log2(g.dim/8)),x=[];let S=Math.ceil(Math.pow(2,v));const T=1/S,D=($,K,X,ie,ae)=>{const be=ie?1:0,Ce=($+1)*X-be,Ee=K*X,Le=(K+1)*X-be;ae[0]=$*X,ae[1]=Ee,ae[2]=Ce,ae[3]=Le};let O=new Yb(S);const z=[];for(let $=0;$<S*S;$++){D($%S,Math.floor($/S),T,!1,z);const K=_m(z[0],z[1],g),X=_m(z[2],z[1],g),ie=_m(z[2],z[3],g),ae=_m(z[0],z[3],g);O.minimums.push(Math.min(K,X,ie,ae)),O.maximums.push(Math.max(K,X,ie,ae)),O.leaves.push(1)}for(x.push(O),S/=2;S>=1;S/=2){const $=x[x.length-1];O=new Yb(S);for(let K=0;K<S*S;K++){D(K%S,Math.floor(K/S),2,!0,z);const X=$.getElevation(z[0],z[1]),ie=$.getElevation(z[2],z[1]),ae=$.getElevation(z[2],z[3]),be=$.getElevation(z[0],z[3]),Ce=$.isLeaf(z[0],z[1]),Ee=$.isLeaf(z[2],z[1]),Le=$.isLeaf(z[2],z[3]),Oe=$.isLeaf(z[0],z[3]),qe=Math.min(X.min,ie.min,ae.min,be.min),rt=Math.max(X.max,ie.max,ae.max,be.max),ht=Ce&&Ee&&Le&&Oe;O.maximums.push(rt),O.minimums.push(qe),O.leaves.push(rt-qe<=5&&ht?1:0)}x.push(O)}return x}(this.dem),u=a.length-1,f=a[u];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(a,0,0,u,0)}raycastRoot(r,a,u,f,g,v,x=1){return IT([r,a,-100],[u,f,this.maximums[0]*x],g,v)}raycast(r,a,u,f,g,v,x=1){if(!this.nodeCount)return null;const S=this.raycastRoot(r,a,u,f,g,v,x);if(null==S)return null;const T=[],D=[],O=[],z=[],$=[{idx:0,t:S,nodex:0,nodey:0,depth:0}];for(;$.length>0;){const{idx:K,t:X,nodex:ie,nodey:ae,depth:be}=$.pop();if(this.leaves[K]){k_(ie,ae,be,r,a,u,f,O,z);const Ee=1<<be,Le=(ie+0)/Ee,Oe=(ie+1)/Ee,qe=(ae+0)/Ee,rt=(ae+1)/Ee,ht=_m(Le,qe,this.dem)*x,It=_m(Oe,qe,this.dem)*x,At=_m(Oe,rt,this.dem)*x,Kt=_m(Le,rt,this.dem)*x,fn=DT(O[0],O[1],ht,z[0],O[1],It,z[0],z[1],At,g,v),Ut=DT(z[0],z[1],At,O[0],z[1],Kt,O[0],O[1],ht,g,v),Dt=Math.min(null!==fn?fn:Number.MAX_VALUE,null!==Ut?Ut:Number.MAX_VALUE);if(Dt!==Number.MAX_VALUE)return Dt;{const Bt=p.N.scaleAndAdd([],g,v,X);if(MT(ht,It,Kt,At,YC(Bt[0],O[0],z[0]),YC(Bt[1],O[1],z[1]))>=Bt[2])return X}continue}let Ce=0;for(let Ee=0;Ee<this._siblingOffset.length;Ee++){k_((ie<<1)+this._siblingOffset[Ee][0],(ae<<1)+this._siblingOffset[Ee][1],be+1,r,a,u,f,O,z),O[2]=-100,z[2]=this.maximums[this.childOffsets[K]+Ee]*x;const Le=IT(O,z,g,v);if(null!=Le){const Oe=Le;T[Ee]=Oe;let qe=!1;for(let rt=0;rt<Ce&&!qe;rt++)Oe>=T[D[rt]]&&(D.splice(rt,0,Ee),qe=!0);qe||(D[Ce]=Ee),Ce++}}for(let Ee=0;Ee<Ce;Ee++){const Le=D[Ee];$.push({idx:this.childOffsets[K]+Le,t:T[Le],nodex:(ie<<1)+this._siblingOffset[Le][0],nodey:(ae<<1)+this._siblingOffset[Le][1],depth:be+1})}}return null}_addNode(r,a,u){return this.minimums.push(r),this.maximums.push(a),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(r,a,u,f,g){if(1===r[f].isLeaf(a,u))return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const v=f-1,x=r[v];let S=0,T=0;for(let D=0;D<this._siblingOffset.length;D++){const O=2*a+this._siblingOffset[D][0],z=2*u+this._siblingOffset[D][1],$=x.getElevation(O,z),K=x.isLeaf(O,z),X=this._addNode($.min,$.max,K);K&&(S|=1<<D),T||(T=X)}for(let D=0;D<this._siblingOffset.length;D++)S&1<<D||this._construct(r,2*a+this._siblingOffset[D][0],2*u+this._siblingOffset[D][1],v,T+D)}}function MT(o,r,a,u,f,g){return Fi(Fi(o,a,g),Fi(r,u,g),f)}function _m(o,r,a){const u=a.dim,f=ir(o*u-.5,0,u-1),g=ir(r*u-.5,0,u-1),v=Math.floor(f),x=Math.floor(g),S=Math.min(v+1,u-1),T=Math.min(x+1,u-1);return MT(a.get(v,x),a.get(S,x),a.get(v,T),a.get(S,T),f-v,g-x)}const JC={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Jb(o,r,a){return(256*o*256+256*r+a)/10-1e4}function LF(o,r,a){return 256*o+r+a/256-32768}class $v{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,a,u,f=!1){if(this.uid=r,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(u&&"mapbox"!==u&&"terrarium"!==u)return $o(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const g=this.dim=a.height-2,v=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.floatView=new Float32Array(a.data.buffer),this.borderReady=f,this._modifiedForSources={},!f){for(let S=0;S<g;S++)v[this._idx(-1,S)]=v[this._idx(0,S)],v[this._idx(g,S)]=v[this._idx(g-1,S)],v[this._idx(S,-1)]=v[this._idx(S,0)],v[this._idx(S,g)]=v[this._idx(S,g-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(g,-1)]=v[this._idx(g-1,0)],v[this._idx(-1,g)]=v[this._idx(0,g-1)],v[this._idx(g,g)]=v[this._idx(g-1,g-1)]}const x="terrarium"===u?LF:Jb;for(let S=0;S<v.length;++S){const T=4*S;this.floatView[S]=x(this.pixels[T],this.pixels[T+1],this.pixels[T+2])}this._timestamp=wn.now()}_buildQuadTree(){this._tree=new BT(this)}get(r,a,u=!1){u&&(r=ir(r,-1,this.dim),a=ir(a,-1,this.dim));const f=this._idx(r,a);return this.floatView[f]}set(r,a,u){const f=this._idx(r,a),g=this.floatView[f];return this.floatView[f]=u,u-g}static getUnpackVector(r){return JC[r]}_idx(r,a){if(r<-1||r>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(r+1)}static pack(r,a){const u=[0,0,0,0],f=$v.getUnpackVector(a);let g=Math.floor((r+f[3])/f[2]);return u[2]=g%256,g=Math.floor(g/256),u[1]=g%256,g=Math.floor(g/256),u[0]=g,u}getPixels(){return new fT({width:this.stride,height:this.stride},this.pixels)}backfillBorder(r,a,u){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let f=a*this.dim,g=a*this.dim+this.dim,v=u*this.dim,x=u*this.dim+this.dim;switch(a){case-1:f=g-1;break;case 1:g=f+1}switch(u){case-1:v=x-1;break;case 1:x=v+1}const S=-a*this.dim,T=-u*this.dim;for(let D=v;D<x;D++)for(let O=f;O<g;O++){const z=4*this._idx(O,D),$=4*this._idx(O+S,D+T);this.pixels[z+0]=r.pixels[$+0],this.pixels[z+1]=r.pixels[$+1],this.pixels[z+2]=r.pixels[$+2],this.pixels[z+3]=r.pixels[$+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}ai($v,"DEMData"),ai(BT,"DemMinMaxQuadTree",{omit:["dem"]});class Uu{constructor(r,a,u){this._demTile=r,this._dem=this._demTile.dem,this._scale=a,this._offset=u}static create(r,a,u){const f=u||r.findDEMTileFor(a);if(!f||!f.dem)return;const g=f.dem,v=f.tileID,x=1<<a.canonical.z-v.canonical.z;return new Uu(f,g.dim/Jn/x,[(a.canonical.x/x-v.canonical.x)*g.dim,(a.canonical.y/x-v.canonical.y)*g.dim])}tileCoordToPixel(r,a){const u=a*this._scale+this._offset[1],f=Math.floor(r*this._scale+this._offset[0]),g=Math.floor(u);return new Nn(f,g)}getElevationAt(r,a,u,f){const g=r*this._scale+this._offset[0],v=a*this._scale+this._offset[1],x=Math.floor(g),S=Math.floor(v),T=this._dem;return f=!!f,u?Fi(Fi(T.get(x,S,f),T.get(x,S+1,f),v-S),Fi(T.get(x+1,S,f),T.get(x+1,S+1,f),v-S),g-x):T.get(x,S,f)}getElevationAtPixel(r,a,u){return this._dem.get(r,a,!!u)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*lr(1,r)*this._dem.stride}}const tL=JA.types,FT=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],RT=["fill-extrusion-flood-light-ground-radius"],UF=Math.pow(2,13),nL=Math.pow(2,15)-1,zF=new Nn(0,1),iA=2147483648;function qv(o,r,a,u,f,g,v,x){o.emplaceBack((r<<1)+v,(a<<1)+g,(Math.floor(u*UF)<<1)+f,Math.round(x))}function sy(o,r,a,u,f,g){o.emplaceBack(r.x,r.y,(a.x<<1)+u,(a.y<<1)+f,g)}function P_(o,r,a){o.emplaceBack(r.x,r.y,r.z,16384*a[0],16384*a[1],16384*a[2])}class N_{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class ew{constructor(){this.centroidXY=new Nn(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Nn(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Nn(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Nn(this.max.x-this.min.x,this.max.y-this.min.y)}}class tw{constructor(){this.acc=new Nn(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(r,a){r.min.x===Number.MAX_VALUE&&(r.min.x=r.max.x=a.x,r.min.y=r.max.y=a.y)}appendEdge(r,a,u){this.accCount++,this.acc._add(a);let f=!!this.borders;a.x<r.min.x?(r.min.x=a.x,f=!0):a.x>r.max.x&&(r.max.x=a.x,f=!0),a.y<r.min.y?(r.min.y=a.y,f=!0):a.y>r.max.y&&(r.max.y=a.y,f=!0),((0===a.x||a.x===Jn)&&a.x===u.x)!=((0===a.y||a.y===Jn)&&a.y===u.y)&&this.processBorderOverlap(a,u),f&&this.checkBorderIntersection(a,u)}checkBorderIntersection(r,a){a.x<0!=r.x<0&&this.addBorderIntersection(0,Fi(a.y,r.y,(0-a.x)/(r.x-a.x))),a.x>Jn!=r.x>Jn&&this.addBorderIntersection(1,Fi(a.y,r.y,(Jn-a.x)/(r.x-a.x))),a.y<0!=r.y<0&&this.addBorderIntersection(2,Fi(a.x,r.x,(0-a.y)/(r.y-a.y))),a.y>Jn!=r.y>Jn&&this.addBorderIntersection(3,Fi(a.x,r.x,(Jn-a.y)/(r.y-a.y)))}addBorderIntersection(r,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[r];a<u[0]&&(u[0]=a),a>u[1]&&(u[1]=a)}processBorderOverlap(r,a){if(r.x===a.x){if(r.y===a.y)return;const u=0===r.x?0:1;this.addBorderIntersection(u,a.y),this.addBorderIntersection(u,r.y)}else{const u=0===r.y?2:3;this.addBorderIntersection(u,a.x),this.addBorderIntersection(u,r.x)}}centroid(){return 0===this.accCount?new Nn(0,0):new Nn(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((r,a)=>r+ +(a[0]!==Number.MAX_VALUE),0):0}}function oy(o,r){const a=o.add(r)._unit(),u=ir(o.x*a.x+o.y*a.y,-1,1);var f,g,v;return f=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(f)))/4*nL*((g=o).x*(v=r).y-g.y*v.x<0?-1:1)}const nw=[o=>o.x<0,o=>o.x>Jn,o=>o.y<0,o=>o.y>Jn];function ay(o,r,a,u){const f=[4];if(0===u)return f;a._mult(u);const g=o.sub(a),v=r.sub(a),x=[o,r,g,v];for(let S=0;S<4;S++)for(const T of x)if(nw[S](T)){f.push(S);break}return f}class iw{constructor(r){this.vertexArray=new ql,this.indexArray=new el,this.programConfigurations=new le(r.layers,r.zoom,a=>RT.includes(a)),this._segments=new zo,this.hiddenByLandmarkVertexArray=new m_,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new zo}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(r,a,u,f=!1){const g=r.length;if(g>2){let v=Math.max(0,this._segments.get().length-1);const x=this._segments._prepareSegment(4*g,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let S;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const T=r[0],D=r[1];S=oy(T.sub(r[g-1])._perp()._unit(),D.sub(T)._perp()._unit())}for(let T=0;T<g;T++){const D=T===g-1?0:T+1,O=r[T],z=r[D],$=r[D===g-1?0:D+1],K=z.sub(O)._perp()._unit(),X=oy(K,$.sub(z)._perp()._unit()),ie=S,ae=X;if(L_(O,z,a)||f&&OT(O,a)&&OT(z,a)){S=X;continue}const be=x.vertexLength;sy(this.vertexArray,O,z,1,1,ie),sy(this.vertexArray,O,z,1,0,ie),sy(this.vertexArray,O,z,0,1,ae),sy(this.vertexArray,O,z,0,0,ae),x.vertexLength+=4;const Ce=ay(O,z,K,u);for(const Ee of Ce)this._segmentToGroundQuads[v].push({id:be,region:Ee}),this._segmentToRegionTriCounts[v][Ee]+=2,x.primitiveLength+=2;S=X}}}prepareBorderSegments(){if(!this.hasData())return;const r=this._segments.get(),a=r.length;for(let u=0;u<a;u++)this._segmentToGroundQuads[u].sort((f,g)=>f.region-g.region);for(let u=0;u<a;u++){const f=this._segmentToGroundQuads[u],g=r[u],v=this._segmentToRegionTriCounts[u];v.reduce((S,T)=>S+T,0);let x=0;for(let S=0;S<=4;S++){const T=v[S];if(0!==T){let D=this.regionSegments[S];D||(D=this.regionSegments[S]=new zo);const O={vertexOffset:g.vertexOffset,primitiveOffset:g.primitiveOffset+x,vertexLength:g.vertexLength,primitiveLength:T};D.get().push(O)}x+=T}for(let S=0;S<f.length;S++){const T=f[S].id;this.indexArray.emplaceBack(T,T+1,T+3),this.indexArray.emplaceBack(T,T+3,T+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(r,a,u,f,g,v){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,r,a,u,f,g,v)}upload(r){this.hasData()&&(this.vertexBuffer=r.createVertexBuffer(this.vertexArray,JN.members),this.indexBuffer=r.createIndexBuffer(this.indexArray))}uploadPaintProperties(r){this.hasData()&&this.programConfigurations.upload(r)}update(r,a,u,f,g,v){this.hasData()&&this.programConfigurations.updatePaintArrays(r,a,u,f,g,v)}updateHiddenByLandmark(r){if(!this.hasData())return;const a=r.groundVertexCount+r.groundVertexArrayOffset;if(0===r.groundVertexCount)return;const u=r.flags&iA?1:0;for(let f=r.groundVertexArrayOffset;f<a;++f)this.hiddenByLandmarkVertexArray.emplace(f,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(r){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=r.createVertexBuffer(this.hiddenByLandmarkVertexArray,Hv.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let r=0;r<=4;r++){const a=this.regionSegments[r];a&&a.destroy()}}}}class ly{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=r.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=r.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new el,this.footprintVertices=new Hs,this.footprintSegments=[],this.layoutVertexArray=new Hc,this.centroidVertexArray=new rf,this.indexArray=new el,this.programConfigurations=new le(r.layers,r.zoom,a=>FT.includes(a)),this.segments=new zo,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.groundEffect=new iw(r),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(r,a,u,f){this.features=[],this.hasPattern=Gb("fill-extrusion",this.layers,a),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=br(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:g,id:v,index:x,sourceLayerIndex:S}of r){const T=this.layers[0]._featureFilter.needGeometry,D=fa(g,T);if(!this.layers[0]._featureFilter.filter(new uo(this.zoom),D,u))continue;const O={id:v,sourceLayerIndex:S,index:x,geometry:T?D.geometry:oo(g,u,f),properties:g.properties,type:g.type,patterns:{}},z=this.layoutVertexArray.length;this.hasPattern?this.features.push(KC("fill-extrusion",this.layers,O,this.zoom,a)):this.addFeature(O,O.geometry,x,u,{},a.availableImages,f,a.brightness),a.featureIndex.insert(g,O.geometry,x,S,this.index,z)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(r,a,u,f,g,v){for(const x of this.features){const{geometry:S}=x;this.addFeature(x,S,x.index,a,u,f,g,v)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(r,a,u,f,g){const v=0!==Object.keys(r).length;if(v&&!this.stateDependentLayers.length)return;const x=v?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(r,a,x,u,f,g),this.groundEffect.update(r,a,x,u,f,g)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,xT),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=r.createVertexBuffer(this.layoutVertexExtArray,Qv.members,!0)),this.groundEffect.upload(r)),this.groundEffect.uploadPaintProperties(r),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){this.groundEffect.uploadHiddenByLandmark(r),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,eL.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,a,u,f,g,v,x,S){const T=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(r,{})/this.tileToMeter,D=[new Nn(0,0),new Nn(Jn,Jn)],O=x.projection,z="globe"===O.name,$="Polygon"===tL[r.type],K=new tw;K.centroidDataIndex=this.centroidData.length;const X=new ew,ie=this.layers[0].paint.get("fill-extrusion-base").evaluate(r,{},f)<=0,ae=this.layers[0].paint.get("fill-extrusion-height").evaluate(r,{},f);X.height=ae,X.vertexArrayOffset=this.layoutVertexArray.length,X.groundVertexArrayOffset=this.groundEffect.vertexArray.length,z&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new am);const be=qC(a,500);for(let rt=be.length-1;rt>=0;rt--){const ht=be[rt];(0===ht.length||(Ce=ht[0]).every(It=>It.x<=0)||Ce.every(It=>It.x>=Jn)||Ce.every(It=>It.y<=0)||Ce.every(It=>It.y>=Jn))&&be.splice(rt,1)}var Ce;let Ee;if(z)Ee=sw(be,D,f);else{Ee=[];for(const rt of be)Ee.push({polygon:rt,bounds:D})}const Le=$?this.edgeRadius:0,Oe=Le>0&&this.zoom<17,qe=(rt,ht)=>{if(0===rt.length)return!1;const It=rt[rt.length-1];return ht.x===It.x&&ht.y===It.y};for(const{polygon:rt,bounds:ht}of Ee){let It=0,At=0;for(const Dt of rt)$&&!Dt[0].equals(Dt[Dt.length-1])&&Dt.push(Dt[0]),At+=$?Dt.length-1:Dt.length;const Kt=this.segments.prepareSegment(($?5:4)*At,this.layoutVertexArray,this.indexArray);X.footprintSegIdx<0&&(X.footprintSegIdx=this.footprintSegments.length),X.polygonSegIdx<0&&(X.polygonSegIdx=this.polygonSegments.length);const fn={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ut=new N_;if(Ut.vertexOffset=this.footprintVertices.length,Ut.indexOffset=3*this.footprintIndices.length,Ut.ringIndices=[],$){const Dt=[],Bt=[];It=Kt.vertexLength;for(let Mn=0;Mn<rt.length;Mn++){const on=rt[Mn];on.length&&0!==Mn&&Bt.push(Dt.length/2);const ri=[];let Kn,bn;Kn=on[1].sub(on[0])._perp()._unit(),Ut.ringIndices.push(on.length-1);for(let Hi=1;Hi<on.length;Hi++){const Ei=on[Hi],hi=on[Hi===on.length-1?1:Hi+1],xn=Ei.clone();if(Le){bn=hi.sub(Ei)._perp()._unit();const ki=Kn.add(bn)._unit(),_r=Le*Math.min(4,1/(Kn.x*ki.x+Kn.y*ki.y));xn.x+=_r*ki.x,xn.y+=_r*ki.y,xn.x=Math.round(xn.x),xn.y=Math.round(xn.y),Kn=bn}!ie||0!==Le&&!Oe||qe(ri,xn)||ri.push(xn),qv(this.layoutVertexArray,xn.x,xn.y,0,0,1,1,0),Kt.vertexLength++,this.footprintVertices.emplaceBack(Ei.x,Ei.y),Dt.push(Ei.x,Ei.y),z&&P_(this.layoutVertexExtArray,O.projectTilePoint(xn.x,xn.y,f),O.upVector(f,xn.x,xn.y))}ie&&(0===Le||Oe)&&(0!==ri.length&&qe(ri,ri[0])&&ri.pop(),this.groundEffect.addData(ri,ht,T))}const an=jb(Dt,Bt);for(let Mn=0;Mn<an.length;Mn+=3)this.footprintIndices.emplaceBack(Ut.vertexOffset+an[Mn+0],Ut.vertexOffset+an[Mn+1],Ut.vertexOffset+an[Mn+2]),this.indexArray.emplaceBack(It+an[Mn],It+an[Mn+2],It+an[Mn+1]),Kt.primitiveLength++;Ut.indexCount+=an.length,Ut.vertexCount+=this.footprintVertices.length-Ut.vertexOffset}for(let Dt=0;Dt<rt.length;Dt++){const Bt=rt[Dt];K.startRing(X,Bt[0]);let an=Bt.length>4&&e2(Bt[Bt.length-2],Bt[0],Bt[1]),Mn=Le?iL(Bt[Bt.length-2],Bt[0],Bt[1],Le):0;const on=[];let ri,Kn,bn;Kn=Bt[1].sub(Bt[0])._perp()._unit();let Hi=!0;for(let Ei=1,hi=0;Ei<Bt.length;Ei++){let xn=Bt[Ei-1],ki=Bt[Ei];const _r=Bt[Ei===Bt.length-1?1:Ei+1];if(K.appendEdge(X,ki,xn),L_(ki,xn,ht)){Le&&(Kn=_r.sub(ki)._perp()._unit(),Hi=!Hi);continue}const zi=ki.sub(xn)._perp(),Cr=zi.x/(Math.abs(zi.x)+Math.abs(zi.y)),ur=zi.y>0?1:0,Yr=xn.dist(ki);if(hi+Yr>32768&&(hi=0),Le){bn=_r.sub(ki)._perp()._unit();let ns=rw(xn,ki,_r,Kv(Kn,bn),Le);isNaN(ns)&&(ns=0);const Fs=ki.sub(xn)._unit();xn=xn.add(Fs.mult(Mn))._round(),ki=ki.add(Fs.mult(-ns))._round(),Mn=ns,Kn=bn,ie&&this.zoom>=17&&(qe(on,xn)||on.push(xn),qe(on,ki)||on.push(ki))}const Ar=Kt.vertexLength,lo=Bt.length>4&&e2(xn,ki,_r);let hs=kT(hi,an,Hi);if(qv(this.layoutVertexArray,xn.x,xn.y,Cr,ur,0,0,hs),qv(this.layoutVertexArray,xn.x,xn.y,Cr,ur,0,1,hs),hi+=Yr,hs=kT(hi,lo,!Hi),an=lo,qv(this.layoutVertexArray,ki.x,ki.y,Cr,ur,0,0,hs),qv(this.layoutVertexArray,ki.x,ki.y,Cr,ur,0,1,hs),Kt.vertexLength+=4,this.indexArray.emplaceBack(Ar+0,Ar+1,Ar+2),this.indexArray.emplaceBack(Ar+1,Ar+3,Ar+2),Kt.primitiveLength+=2,Le){const ns=It+(1===Ei?Bt.length-2:Ei-2),Fs=1===Ei?It:ns+1;if(this.indexArray.emplaceBack(Ar+1,ns,Ar+3),this.indexArray.emplaceBack(ns,Fs,Ar+3),Kt.primitiveLength+=2,void 0===ri&&(ri=Ar),!L_(_r,Bt[Ei],ht)){const ds=Ei===Bt.length-1?ri:Kt.vertexLength;this.indexArray.emplaceBack(Ar+2,Ar+3,ds),this.indexArray.emplaceBack(Ar+3,ds+1,ds),this.indexArray.emplaceBack(Ar+3,Fs,ds+1),Kt.primitiveLength+=3}Hi=!Hi}if(z){const ns=this.layoutVertexExtArray,Fs=O.projectTilePoint(xn.x,xn.y,f),ds=O.projectTilePoint(ki.x,ki.y,f),et=O.upVector(f,xn.x,xn.y),Qs=O.upVector(f,ki.x,ki.y);P_(ns,Fs,et),P_(ns,Fs,et),P_(ns,ds,Qs),P_(ns,ds,Qs)}}$&&(It+=Bt.length-1),ie&&Le&&this.zoom>=17&&(0!==on.length&&qe(on,on[0])&&on.pop(),this.groundEffect.addData(on,ht,T,Le>0))}this.footprintSegments.push(Ut),fn.triangleCount=this.indexArray.length-fn.triangleArrayOffset,this.polygonSegments.push(fn),++X.footprintSegLen,++X.polygonSegLen}if(X.vertexCount=this.layoutVertexArray.length-X.vertexArrayOffset,X.groundVertexCount=this.groundEffect.vertexArray.length-X.groundVertexArrayOffset,0!==X.vertexCount){if(X.centroidXY=K.borders?zF:this.encodeCentroid(K,X),this.centroidData.push(X),K.borders){this.featuresOnBorder.push(K);const rt=this.featuresOnBorder.length-1;for(let ht=0;ht<K.borders.length;ht++)K.borders[ht][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ht].push(rt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,g,v,f,S),this.groundEffect.addPaintPropertiesData(r,u,g,v,f,S),this.maxHeight=Math.max(this.maxHeight,ae)}}sortBorders(){for(let r=0;r<this.borderFeatureIndices.length;r++)this.borderFeatureIndices[r].sort((a,u)=>this.featuresOnBorder[a].borders[r][0]-this.featuresOnBorder[u].borders[r][0])}splitToSubtiles(){const r=[];for(let x=0;x<this.centroidData.length;x++){const S=this.centroidData[x],T=+(S.min.y+S.max.y>Jn),D=2*T+(+(S.min.x+S.max.x>Jn)^T);for(let O=0;O<S.polygonSegLen;O++){const z=S.polygonSegIdx+O;r.push({centroidIdx:x,subtile:D,polygonSegmentIdx:z,triangleSegmentIdx:this.polygonSegments[z].triangleSegIdx})}}const a=new el;r.sort((x,S)=>x.triangleSegmentIdx===S.triangleSegmentIdx?x.subtile-S.subtile:x.triangleSegmentIdx-S.triangleSegmentIdx);let u=0,f=0,g=0;for(const x of r){if(x.triangleSegmentIdx!==u)break;g++}const v=r.length;for(;f!==r.length;){u=r[f].triangleSegmentIdx;let x=0,S=f,T=f;for(let D=S;D<g&&r[D].subtile===x;D++)T++;for(;S!==g;){const D=r[S];x=D.subtile;const O=this.centroidData[D.centroidIdx].min.clone(),z=this.centroidData[D.centroidIdx].max.clone(),$={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:a.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let K=S;K<T;K++){const X=r[K],ie=this.polygonSegments[X.polygonSegmentIdx],ae=this.centroidData[X.centroidIdx].min,be=this.centroidData[X.centroidIdx].max,Ce=this.indexArray.uint16;for(let Ee=ie.triangleArrayOffset;Ee<ie.triangleArrayOffset+ie.triangleCount;Ee++)a.emplaceBack(Ce[3*Ee],Ce[3*Ee+1],Ce[3*Ee+2]);$.primitiveLength+=ie.triangleCount,O.x=Math.min(O.x,ae.x),O.y=Math.min(O.y,ae.y),z.x=Math.max(z.x,be.x),z.y=Math.max(z.y,be.y)}$.primitiveLength>0&&this.triangleSubSegments.push({segment:$,min:O,max:z}),S=T;for(let K=S;K<g&&r[K].subtile===r[S].subtile;K++)T++}f=g;for(let D=f;D<v&&r[D].triangleSegmentIdx===r[f].triangleSegmentIdx;D++)g++}a._trim(),this.indexArray=a}getVisibleSegments(r,a,u){let f=0,g=0;const v=1<<r.canonical.z;if(a){const X=a.getMinMaxForTile(r);X&&(f=X.min,g=X.max)}g+=this.maxHeight;const x=r.toUnwrapped();let S;const T=[x.canonical.x/v+x.wrap,x.canonical.y/v],D=[(x.canonical.x+1)/v+x.wrap,(x.canonical.y+1)/v],O=new zo,z=(X,ie,ae)=>[X[0]*(1-ae[0])+ie[0]*ae[0],X[1]*(1-ae[1])+ie[1]*ae[1]],$=[],K=[];for(const X of this.triangleSubSegments){$[0]=X.min.x/Jn,$[1]=X.min.y/Jn,K[0]=X.max.x/Jn,K[1]=X.max.y/Jn;const ie=z(T,D,$),ae=z(T,D,K);if(0===new ta([ie[0],ie[1],f],[ae[0],ae[1],g]).intersectsPrecise(u)){S&&(O.segments.push(S),S=void 0);continue}const be=X.segment;S&&S.vertexOffset!==be.vertexOffset&&(O.segments.push(S),S=void 0),S?(S.vertexLength+=be.vertexLength,S.primitiveLength+=be.primitiveLength):S={vertexOffset:be.vertexOffset,primitiveLength:be.primitiveLength,vertexLength:be.vertexLength,primitiveOffset:be.primitiveOffset,sortKey:void 0,vaos:{}}}return S&&O.segments.push(S),O}encodeCentroid(r,a){const u=r.centroid(),f=a.span(),g=Math.min(7,Math.round(f.x*this.tileToMeter/10)),v=Math.min(7,Math.round(f.y*this.tileToMeter/10));return new Nn(ir(u.x,1,Jn-1)<<3|g,ir(u.y,1,Jn-1)<<3|v)}encodeBorderCentroid(r){if(!r.borders)return new Nn(0,0);const a=r.borders,u=Number.MAX_VALUE;if(a[0][0]!==u||a[1][0]!==u){const f=a[0][0]!==u?0:1;return new Nn(6|(a[0][0]!==u?0:65528),(a[f][0]+a[f][1])/2<<3|6)}{const f=a[2][0]!==u?2:3;return new Nn((a[f][0]+a[f][1])/2<<3|6,6|(a[2][0]!==u?0:65528))}}showCentroid(r){const a=this.centroidData[r.centroidDataIndex];a.flags&=iA,a.centroidXY.x=0,a.centroidXY.y=0,this.writeCentroidToBuffer(a)}writeCentroidToBuffer(r){this.groundEffect.updateHiddenByLandmark(r);const a=r.vertexArrayOffset,u=r.vertexCount+r.vertexArrayOffset,f=r.flags&iA?zF:r.centroidXY,g=this.centroidVertexArray.geta_centroid_pos0(a);if(this.centroidVertexArray.geta_centroid_pos1(a)!==f.y||g!==f.x){for(let v=a;v<u;++v)this.centroidVertexArray.emplace(v,f.x,f.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const r of this.centroidData)this.writeCentroidToBuffer(r)}updateReplacement(r,a){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const u=a.getReplacementRegionsForTile(r.toUnwrapped());if(function(g,v){if(g.length!==v.length)return!1;for(let x=0;x<g.length;x++)if(g[x].sourceId!==v[x].sourceId||!Gv(g[x],v[x]))return!1;return!0}(this.activeReplacements,u))return;if(this.activeReplacements=u,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const g of this.centroidData)g.flags&=2147483647;const f=[];for(const g of this.activeReplacements){const v=Math.pow(2,g.footprintTileId.canonical.z-r.canonical.z);for(const x of this.centroidData)if(!(x.flags&iA||g.min.x>x.max.x||x.min.x>g.max.x||g.min.y>x.max.y||x.min.y>g.max.y))for(let S=0;S<x.footprintSegLen;S++){const T=this.footprintSegments[x.footprintSegIdx+S];if(f.length=0,NT(this.footprintVertices,T.vertexOffset,T.vertexCount,g.footprintTileId.canonical,r.canonical,f),Lu(g.footprint,f,this.footprintIndices.uint16,T.indexOffset,T.indexCount,-T.vertexOffset,-v)){x.flags|=iA;break}}}for(const g of this.centroidData)this.writeCentroidToBuffer(g);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(r,a,u){let f=!1;for(let g=0;g<u.footprintSegLen;g++){const v=this.footprintSegments[u.footprintSegIdx+g];let x=0;for(const S of v.ringIndices){for(let T=x,D=S+x-1;T<S+x;D=T++){const O=this.footprintVertices.int16[2*(T+v.vertexOffset)+0],z=this.footprintVertices.int16[2*(T+v.vertexOffset)+1],$=this.footprintVertices.int16[2*(D+v.vertexOffset)+1];z>a!=$>a&&r<(this.footprintVertices.int16[2*(D+v.vertexOffset)+0]-O)*(a-z)/($-z)+O&&(f=!f)}x=S}}return f}getHeightAtTileCoord(r,a){let u=Number.NEGATIVE_INFINITY,f=!0;const g=4*(r+Jn)*Jn+(a+Jn);if(this.partLookup.hasOwnProperty(g)){const v=this.partLookup[g];return v?{height:v.height,hidden:!!(v.flags&iA)}:void 0}for(const v of this.centroidData)r>v.max.x||v.min.x>r||a>v.max.y||v.min.y>a||this.footprintContainsPoint(r,a,v)&&v&&v.height>u&&(u=v.height,this.partLookup[g]=v,f=!!(v.flags&iA));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:f};this.partLookup[g]=void 0}}function Kv(o,r){const a=o.add(r)._unit();return o.x*a.x+o.y*a.y}function iL(o,r,a,u){const f=r.sub(o)._perp()._unit(),g=a.sub(r)._perp()._unit();return rw(o,r,a,Kv(f,g),u)}function rw(o,r,a,u,f){const g=Math.sqrt(1-u*u);return Math.min(o.dist(r)/3,r.dist(a)/3,f*g/u)}function L_(o,r,a){return o.x<a[0].x&&r.x<a[0].x||o.x>a[1].x&&r.x>a[1].x||o.y<a[0].y&&r.y<a[0].y||o.y>a[1].y&&r.y>a[1].y}function OT(o,r){return o.x<r[0].x||o.x>r[1].x||o.y<r[0].y||o.y>r[1].y}function e2(o,r,a){if(o.x<0||o.x>=Jn||r.x<0||r.x>=Jn||a.x<0||a.x>=Jn)return!1;const u=a.sub(r),f=u.perp(),g=o.sub(r);return(u.x*g.x+u.y*g.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(g.x*g.x+g.y*g.y))>-.866&&f.x*g.x+f.y*g.y<0}function kT(o,r,a){const u=r?2|o:-3&o;return a?1|u:-2&u}function PT(){const o=Math.PI/32,r=Math.tan(o),a=Rt;return a*Math.sqrt(1+2*r*r)-a}function sw(o,r,a){const u=1<<a.z,f=rr(a.x/u),g=rr((a.x+1)/u),v=kr(a.y/u),x=kr((a.y+1)/u);return function(S,T,D,O,z=0,$){const K=[];if(!S.length||!D||!O)return K;const X=(Oe,qe)=>{for(const rt of Oe)K.push({polygon:rt,bounds:qe})},ie=Math.ceil(Math.log2(D)),ae=Math.ceil(Math.log2(O)),be=ie-ae,Ce=[];for(let Oe=0;Oe<Math.abs(be);Oe++)Ce.push(be>0?0:1);for(let Oe=0;Oe<Math.min(ie,ae);Oe++)Ce.push(0),Ce.push(1);let Ee=S;if(Ee=Wb(Ee,T[0].y-z,T[1].y+z,1),Ee=Wb(Ee,T[0].x-z,T[1].x+z,0),!Ee.length)return K;const Le=[];for(Ce.length?Le.push({polygons:Ee,bounds:T,depth:0}):X(Ee,T);Le.length;){const Oe=Le.pop(),qe=Oe.depth,rt=Ce[qe],ht=Oe.bounds[0],It=Oe.bounds[1],At=0===rt?ht.x:ht.y,Kt=0===rt?It.x:It.y,fn=$?$(rt,At,Kt):.5*(At+Kt),Ut=Wb(Oe.polygons,At-z,fn+z,rt),Dt=Wb(Oe.polygons,fn-z,Kt+z,rt);if(Ut.length){const Bt=[ht,new Nn(0===rt?fn:It.x,1===rt?fn:It.y)];Ce.length>qe+1?Le.push({polygons:Ut,bounds:Bt,depth:qe+1}):X(Ut,Bt)}if(Dt.length){const Bt=[new Nn(0===rt?fn:ht.x,1===rt?fn:ht.y),It];Ce.length>qe+1?Le.push({polygons:Dt,bounds:Bt,depth:qe+1}):X(Dt,Bt)}}return K}(o,r,Math.ceil((g-f)/11.25),Math.ceil((v-x)/11.25),1,(S,T,D)=>{if(0===S)return.5*(T+D);{const O=kr((a.y+T/Jn)/u);return(Ki(.5*(kr((a.y+D/Jn)/u)+O))*u-a.y)*Jn}})}function NT(o,r,a,u,f,g){const v=Math.pow(2,u.z-f.z);for(let x=0;x<a;x++){let S=o.int16[2*(x+r)+0],T=o.int16[2*(x+r)+1];S=(S+f.x*Jn)*v-u.x*Jn,T=(T+f.y*Jn)*v-u.y*Jn,g.push(new Nn(S,T))}}ai(ly,"FillExtrusionBucket",{omit:["layers","features"]}),ai(ew,"PartData"),ai(N_,"FootprintSegment"),ai(tw,"BorderCentroidData"),ai(iw,"GroundEffect");const VF=new ko({visibility:new Rn(bt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Rn(bt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var HF={paint:new ko({"fill-extrusion-opacity":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new wi(bt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new wi(bt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new wi(bt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new wi(bt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new wi(bt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new wi(bt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Rn(bt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:VF};class Wv extends Nn{constructor(r,a,u){super(r,a),this.z=u}}function Zv(o,r){return o.x*r.x+o.y*r.y}function Xv(o,r){if(1===o.length){let a=0;const u=r[a++];let f;for(;!f||u.equals(f);)if(f=r[a++],!f)return 1/0;for(;a<r.length;a++){const g=r[a],v=o[0],x=f.sub(u),S=g.sub(u),T=v.sub(u),D=Zv(x,x),O=Zv(x,S),z=Zv(S,S),$=Zv(T,x),K=Zv(T,S),X=D*z-O*O,ie=(z*$-O*K)/X,ae=(D*K-O*$)/X,be=u.z*(1-ie-ae)+f.z*ie+g.z*ae;if(isFinite(be))return be}return 1/0}{let a=1/0;for(const u of r)a=Math.min(a,u.z);return a}}function ow(o,r,a,u,f,g,v,x){const S=v*f.getElevationAt(o,r,!0,!0),T=0!==g[0],D=T?0===g[1]?v*(g[0]/7-450):v*function(O,z,$){const K=Math.floor(z[0]/8),X=Math.floor(z[1]/8),ie=10*(z[0]-8*K),ae=10*(z[1]-8*X),be=O.getElevationAt(K,X,!0,!0),Ce=O.getMeterToDEM($),Ee=Math.floor(.5*(ie*Ce-1)),Le=Math.floor(.5*(ae*Ce-1)),Oe=O.tileCoordToPixel(K,X),qe=2*Ee+1,rt=2*Le+1,ht=(Mn=qe,on=rt,[(Dt=O).getElevationAtPixel(Bt=Oe.x-Ee,an=Oe.y-Le,!0),Dt.getElevationAtPixel(Bt+on,an,!0),Dt.getElevationAtPixel(Bt,an+on,!0),Dt.getElevationAtPixel(Bt+Mn,an+on,!0)]),It=Math.abs(ht[0]-ht[1]),At=Math.abs(ht[2]-ht[3]),Kt=Math.abs(ht[0]-ht[2])+Math.abs(ht[1]-ht[3]),fn=Math.min(.25,.5*Ce*(It+At)/qe),Ut=Math.min(.25,.5*Ce*Kt/rt);var Dt,Bt,an,Mn,on;return be+Math.max(fn*ie,Ut*ae)}(f,g,x):S;return{base:S+(0===a)?-1:a,top:T?Math.max(D+u,S+a+2):S+u}}const QF=bs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:LT}=QF,t2=bs([{name:"a_packed",components:4,type:"Float32"}]),{members:aw}=t2;class UT{constructor(r,a){this.width=r,this.height=a,this.nextRow=0,this.image=new gh({width:r,height:a}),this.positions={},this.uploaded=!1}getDash(r,a){const u=this.getKey(r,a);return this.positions[u]}trim(){const r=this.width,a=this.height=Li(this.nextRow);this.image.resize({width:r,height:a})}getKey(r,a){return r.join(",")+a}getDashRanges(r,a,u){const f=[];let g=r.length%2==1?-r[r.length-1]*u:0,v=r[0]*u,x=!0;f.push({left:g,right:v,isDash:x,zeroLength:0===r[0]});let S=r[0];for(let T=1;T<r.length;T++){x=!x;const D=r[T];g=S*u,S+=D,v=S*u,f.push({left:g,right:v,isDash:x,zeroLength:0===D})}return f}addRoundDash(r,a,u){const f=a/2;for(let g=-u;g<=u;g++){const v=this.width*(this.nextRow+u+g);let x=0,S=r[x];for(let T=0;T<this.width;T++){T/S.right>1&&(S=r[++x]);const D=Math.abs(T-S.left),O=Math.abs(T-S.right),z=Math.min(D,O);let $;const K=g/u*(f+1);if(S.isDash){const X=f-Math.abs(K);$=Math.sqrt(z*z+X*X)}else $=f-Math.sqrt(z*z+K*K);this.image.data[v+T]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(r,a){for(let S=r.length-1;S>=0;--S){const T=r[S],D=r[S+1];T.zeroLength?r.splice(S,1):D&&D.isDash===T.isDash&&(D.left=T.left,r.splice(S,1))}const u=r[0],f=r[r.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const g=this.width*this.nextRow;let v=0,x=r[v];for(let S=0;S<this.width;S++){S/x.right>1&&(x=r[++v]);const T=Math.abs(S-x.left),D=Math.abs(S-x.right),O=Math.min(T,D);this.image.data[g+S]=Math.max(0,Math.min(255,(x.isDash?O:-O)+a+128))}}addDash(r,a){const u=this.getKey(r,a);if(this.positions[u])return this.positions[u];const f="round"===a,g=f?7:0,v=2*g+1;if(this.nextRow+v>this.height)return $o("LineAtlas out of space"),null;0===r.length&&r.push(1);let x=0;for(let D=0;D<r.length;D++)r[D]<0&&($o("Negative value is found in line dasharray, replacing values with 0"),r[D]=0),x+=r[D];if(0!==x){const D=this.width/x,O=this.getDashRanges(r,this.width,D);f?this.addRoundDash(O,D,g):this.addRegularDash(O,"square"===a?.5*D:0)}const S=this.nextRow+g;this.nextRow+=v;const T={tl:[S,g],br:[x,0]};return this.positions[u]=T,T}}ai(UT,"LineAtlas");const zT=JA.types,jF=Math.cos(Math.PI/180*37.5);class lw{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.fqid),this.index=r.index,this.projection=r.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new om,this.layoutVertexArray2=new Hh,this.indexArray=new el,this.programConfigurations=new le(r.layers,r.zoom),this.segments=new zo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,u,f){this.hasPattern=Gb("line",this.layers,a);const g=this.layers[0].layout.get("line-sort-key"),v=[];for(const{feature:D,id:O,index:z,sourceLayerIndex:$}of r){const K=this.layers[0]._featureFilter.needGeometry,X=fa(D,K);if(!this.layers[0]._featureFilter.filter(new uo(this.zoom),X,u))continue;const ie=g?g.evaluate(X,{},u):void 0,ae={id:O,properties:D.properties,type:D.type,sourceLayerIndex:$,index:z,geometry:K?X.geometry:oo(D,u,f),patterns:{},sortKey:ie};v.push(ae)}g&&v.sort((D,O)=>D.sortKey-O.sortKey);const{lineAtlas:x,featureIndex:S}=a,T=this.addConstantDashes(x);for(const D of v){const{geometry:O,index:z,sourceLayerIndex:$}=D;if(T&&this.addFeatureDashes(D,x),this.hasPattern){const K=KC("line",this.layers,D,this.zoom,a);this.patternFeatures.push(K)}else this.addFeature(D,O,z,u,x.positions,a.availableImages,a.brightness);S.insert(r[z].feature,O,z,$,this.index)}}addConstantDashes(r){let a=!1;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,g=u.layout.get("line-cap").value;if("constant"!==f.kind||"constant"!==g.kind)a=!0;else{const v=g.value,x=f.value;if(!x)continue;r.addDash(x,v)}}return a}addFeatureDashes(r,a){const u=this.zoom;for(const f of this.layers){const g=f.paint.get("line-dasharray").value,v=f.layout.get("line-cap").value;if("constant"===g.kind&&"constant"===v.kind)continue;let x,S;if("constant"===g.kind){if(x=g.value,!x)continue}else x=g.evaluate({zoom:u},r);S="constant"===v.kind?v.value:v.evaluate({zoom:u},r),a.addDash(x,S),r.patterns[f.id]=a.getKey(x,S)}}update(r,a,u,f,g){const v=0!==Object.keys(r).length;v&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(r,a,v?this.stateDependentLayers:this.layers,u,f,g)}addFeatures(r,a,u,f,g,v){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,a,u,f,v)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,aw)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,LT),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,a,u,f,g,v,x){const S=this.layers[0].layout,T=S.get("line-join").evaluate(r,{}),D=S.get("line-cap").evaluate(r,{}),O=S.get("line-miter-limit"),z=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const $ of a)this.addLine($,r,T,D,O,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,g,v,f,x)}addLine(r,a,u,f,g,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ae=0;ae<r.length-1;ae++)this.totalDistance+=r[ae].dist(r[ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x="Polygon"===zT[a.type];let S=r.length;for(;S>=2&&r[S-1].equals(r[S-2]);)S--;let T=0;for(;T<S-1&&r[T].equals(r[T+1]);)T++;if(S<(x?3:2))return;"bevel"===u&&(g=1.05);const D=this.overscaling<=16?15*Jn/(512*this.overscaling):0,O=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let z,$,K,X,ie;this.e1=this.e2=-1,x&&(z=r[S-2],ie=r[T].sub(z)._unit()._perp());for(let ae=T;ae<S;ae++){if(K=ae===S-1?x?r[T+1]:void 0:r[ae+1],K&&r[ae].equals(K))continue;ie&&(X=ie),z&&($=z),z=r[ae],ie=K?K.sub(z)._unit()._perp():X,X=X||ie;let be=X.add(ie);0===be.x&&0===be.y||be._unit();const Ce=X.x*ie.x+X.y*ie.y,Ee=be.x*ie.x+be.y*ie.y,Le=0!==Ee?1/Ee:1/0,Oe=2*Math.sqrt(2-2*Ee),qe=Ee<jF&&$&&K,rt=X.x*ie.y-X.y*ie.x>0;if(qe&&ae>T){const At=z.dist($);if(At>2*D){const Kt=z.sub(z.sub($)._mult(D/At)._round());this.updateDistance($,Kt),this.addCurrentVertex(Kt,X,0,0,O),$=Kt}}const ht=$&&K;let It=ht?u:x?"butt":f;if(ht&&"round"===It&&(Le<v?It="miter":Le<=2&&(It="fakeround")),"miter"===It&&Le>g&&(It="bevel"),"bevel"===It&&(Le>2&&(It="flipbevel"),Le<g&&(It="miter")),$&&this.updateDistance($,z),"miter"===It)be._mult(Le),this.addCurrentVertex(z,be,0,0,O);else if("flipbevel"===It){if(Le>100)be=ie.mult(-1);else{const At=Le*X.add(ie).mag()/X.sub(ie).mag();be._perp()._mult(At*(rt?-1:1))}this.addCurrentVertex(z,be,0,0,O),this.addCurrentVertex(z,be.mult(-1),0,0,O)}else if("bevel"===It||"fakeround"===It){const At=-Math.sqrt(Le*Le-1),Kt=rt?At:0,fn=rt?0:At;if($&&this.addCurrentVertex(z,X,Kt,fn,O),"fakeround"===It){const Ut=Math.round(180*Oe/Math.PI/20);for(let Dt=1;Dt<Ut;Dt++){let Bt=Dt/Ut;if(.5!==Bt){const Mn=Bt-.5;Bt+=Bt*Mn*(Bt-1)*((1.0904+Ce*(Ce*(3.55645-1.43519*Ce)-3.2452))*Mn*Mn+(.848013+Ce*(.215638*Ce-1.06021)))}const an=ie.sub(X)._mult(Bt)._add(X)._unit()._mult(rt?-1:1);this.addHalfVertex(z,an.x,an.y,!1,rt,0,O)}}K&&this.addCurrentVertex(z,ie,-Kt,-fn,O)}else if("butt"===It)this.addCurrentVertex(z,be,0,0,O);else if("square"===It){const At=$?1:-1;$||this.addCurrentVertex(z,be,At,At,O),this.addCurrentVertex(z,be,0,0,O),$&&this.addCurrentVertex(z,be,At,At,O)}else"round"===It&&($&&(this.addCurrentVertex(z,X,0,0,O),this.addCurrentVertex(z,X,1,1,O,!0)),K&&(this.addCurrentVertex(z,ie,-1,-1,O,!0),this.addCurrentVertex(z,ie,0,0,O)));if(qe&&ae<S-1){const At=z.dist(K);if(At>2*D){const Kt=z.add(K.sub(z)._mult(D/At)._round());this.updateDistance(z,Kt),this.addCurrentVertex(Kt,ie,0,0,O),z=Kt}}}}addCurrentVertex(r,a,u,f,g,v=!1){const x=a.y*f-a.x,S=-a.y-a.x*f;this.addHalfVertex(r,a.x+a.y*u,a.y-a.x*u,v,!1,u,g),this.addHalfVertex(r,x,S,v,!0,-f,g)}addHalfVertex({x:r,y:a},u,f,g,v,x,S){this.layoutVertexArray.emplaceBack((r<<1)+(g?1:0),(a<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*f)+128,1+(0===x?0:x<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const T=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),S.primitiveLength++),v?this.e2=T:this.e1=T}updateScaledDistance(){if(this.lineClips){const r=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=r*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(r,a){this.distance+=r.dist(a),this.updateScaledDistance()}}ai(lw,"LineBucket",{omit:["layers","patternFeatures"]});const rL=new ko({"line-cap":new wi(bt.layout_line["line-cap"]),"line-join":new wi(bt.layout_line["line-join"]),"line-miter-limit":new Rn(bt.layout_line["line-miter-limit"]),"line-round-limit":new Rn(bt.layout_line["line-round-limit"]),"line-sort-key":new wi(bt.layout_line["line-sort-key"]),visibility:new Rn(bt.layout_line.visibility)});var VT={paint:new ko({"line-opacity":new wi(bt.paint_line["line-opacity"]),"line-color":new wi(bt.paint_line["line-color"]),"line-translate":new Rn(bt.paint_line["line-translate"]),"line-translate-anchor":new Rn(bt.paint_line["line-translate-anchor"]),"line-width":new wi(bt.paint_line["line-width"]),"line-gap-width":new wi(bt.paint_line["line-gap-width"]),"line-offset":new wi(bt.paint_line["line-offset"]),"line-blur":new wi(bt.paint_line["line-blur"]),"line-dasharray":new wi(bt.paint_line["line-dasharray"]),"line-pattern":new wi(bt.paint_line["line-pattern"]),"line-gradient":new Ah(bt.paint_line["line-gradient"]),"line-trim-offset":new Rn(bt.paint_line["line-trim-offset"]),"line-emissive-strength":new Rn(bt.paint_line["line-emissive-strength"]),"line-border-width":new wi(bt.paint_line["line-border-width"]),"line-border-color":new wi(bt.paint_line["line-border-color"])}),layout:rL};function Yv(o,r,a){return r*(Jn/(o.tileSize*Math.pow(2,a-o.tileID.overscaledZ)))}function HT(o,r){return 1/Yv(o,1,r.tileZoom)}function U_(o,r,a,u){return o.translatePosMatrix(u||r.tileID.projMatrix,r,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const ao=o=>{const r=[];QT(o)&&r.push("RENDER_LINE_DASH"),o.paint.get("line-gradient")&&r.push("RENDER_LINE_GRADIENT");const a=o.paint.get("line-trim-offset");return 0===a[0]&&0===a[1]||r.push("RENDER_LINE_TRIM_OFFSET"),0!==o.paint.get("line-border-width").constantOr(1)&&r.push("RENDER_LINE_BORDER"),r};function QT(o){const r=o.paint.get("line-dasharray").value;return r.value||"constant"!==r.kind}const z_=new class extends wi{possiblyEvaluate(o,r){return r=new uo(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,transition:r.transition}),super.possiblyEvaluate(o,r)}evaluate(o,r,a,u){return r=Oa({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(o,r,a,u)}}(VT.paint.properties["line-width"].specification);function Wh(o,r){return r>0?r+2*o:o}z_.useIntegerZoom=!0;const GF=bs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),$F=bs([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Jv=bs([{name:"a_projected_pos",components:4,type:"Float32"}],4);bs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const qF=bs([{name:"a_z_offset",components:1,type:"Float32"}],4),n2=bs([{name:"a_texb",components:2,type:"Uint16"}]),sL=bs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),cw=bs([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);bs([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const r2=bs([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),KF=bs([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);bs([{name:"triangle",components:3,type:"Uint16"}]),bs([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),bs([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),bs([{type:"Float32",name:"offsetX"}]),bs([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var xc=24;const uf=128;function s2(o,r){const{expression:a}=r;if("constant"===a.kind)return{kind:"constant",layoutSize:a.evaluate(new uo(o+1))};if("source"===a.kind)return{kind:"source"};{const{zoomStops:u,interpolationType:f}=a;let g=0;for(;g<u.length&&u[g]<=o;)g++;g=Math.max(0,g-1);let v=g;for(;v<u.length&&u[v]<o+1;)v++;v=Math.min(u.length-1,v);const x=u[g],S=u[v];return"composite"===a.kind?{kind:"composite",minZoom:x,maxZoom:S,interpolationType:f}:{kind:"camera",minZoom:x,maxZoom:S,minSize:a.evaluate(new uo(x)),maxSize:a.evaluate(new uo(S)),interpolationType:f}}}function e1(o,{uSize:r,uSizeT:a},{lowerSize:u,upperSize:f}){return"source"===o.kind?u/uf:"composite"===o.kind?Fi(u/uf,f/uf,a):r}function cy(o,r){let a=0,u=0;if("constant"===o.kind)u=o.layoutSize;else if("source"!==o.kind){const{interpolationType:f,minZoom:g,maxZoom:v}=o,x=f?ir(ra.interpolationFactor(f,r,g,v),0,1):0;"camera"===o.kind?u=Fi(o.minSize,o.maxSize,x):a=x}return{uSizeT:a,uSize:u}}var WF=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:uf,evaluateSizeForFeature:e1,evaluateSizeForZoom:cy,getSizeData:s2});function oL(o,r,a){return o.sections.forEach(u=>{u.text=function(f,g,v){const x=g.layout.get("text-transform").evaluate(v,{});return"uppercase"===x?f=f.toLocaleUpperCase():"lowercase"===x&&(f=f.toLocaleLowerCase()),$l.applyArabicShaping&&(f=$l.applyArabicShaping(f)),f}(u.text,r,a)}),o}const uy={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function jT(o){return"\ufe36"===o||"\ufe48"===o||"\ufe38"===o||"\ufe44"===o||"\ufe42"===o||"\ufe3e"===o||"\ufe3c"===o||"\ufe3a"===o||"\ufe18"===o||"\ufe40"===o||"\ufe10"===o||"\ufe13"===o||"\ufe14"===o||"\uff40"===o||"\uffe3"===o||"\ufe11"===o||"\ufe12"===o}function Zc(o){return"\ufe35"===o||"\ufe47"===o||"\ufe37"===o||"\ufe43"===o||"\ufe41"===o||"\ufe3d"===o||"\ufe3b"===o||"\ufe39"===o||"\ufe17"===o||"\ufe3f"===o}var GT={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(o,r,a,u,f){var g,v,x=8*f-u-1,S=(1<<x)-1,T=S>>1,D=-7,O=a?f-1:0,z=a?-1:1,$=o[r+O];for(O+=z,g=$&(1<<-D)-1,$>>=-D,D+=x;D>0;g=256*g+o[r+O],O+=z,D-=8);for(v=g&(1<<-D)-1,g>>=-D,D+=u;D>0;v=256*v+o[r+O],O+=z,D-=8);if(0===g)g=1-T;else{if(g===S)return v?NaN:1/0*($?-1:1);v+=Math.pow(2,u),g-=T}return($?-1:1)*v*Math.pow(2,g-u)},write:function(o,r,a,u,f,g){var v,x,S,T=8*g-f-1,D=(1<<T)-1,O=D>>1,z=23===f?Math.pow(2,-24)-Math.pow(2,-77):0,$=u?0:g-1,K=u?1:-1,X=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(x=isNaN(r)?1:0,v=D):(v=Math.floor(Math.log(r)/Math.LN2),r*(S=Math.pow(2,-v))<1&&(v--,S*=2),(r+=v+O>=1?z/S:z*Math.pow(2,1-O))*S>=2&&(v++,S/=2),v+O>=D?(x=0,v=D):v+O>=1?(x=(r*S-1)*Math.pow(2,f),v+=O):(x=r*Math.pow(2,O-1)*Math.pow(2,f),v=0));f>=8;o[a+$]=255&x,$+=K,x/=256,f-=8);for(v=v<<f|x,T+=f;T>0;o[a+$]=255&v,$+=K,v/=256,T-=8);o[a+$-K]|=128*X}},ZF=no,hy=GT;function no(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}no.Varint=0,no.Fixed64=1,no.Bytes=2,no.Fixed32=5;var ym=4294967296,$T=1/ym,qT=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Zp(o){return o.type===no.Bytes?o.readVarint()+o.pos:o.pos+1}function vi(o,r,a){var u=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));a.realloc(u);for(var f=a.pos-1;f>=o;f--)a.buf[f+u]=a.buf[f]}function KT(o,r){for(var a=0;a<o.length;a++)r.writeVarint(o[a])}function XF(o,r){for(var a=0;a<o.length;a++)r.writeSVarint(o[a])}function aL(o,r){for(var a=0;a<o.length;a++)r.writeFloat(o[a])}function Wi(o,r){for(var a=0;a<o.length;a++)r.writeDouble(o[a])}function YF(o,r){for(var a=0;a<o.length;a++)r.writeBoolean(o[a])}function o2(o,r){for(var a=0;a<o.length;a++)r.writeFixed32(o[a])}function JF(o,r){for(var a=0;a<o.length;a++)r.writeSFixed32(o[a])}function e5(o,r){for(var a=0;a<o.length;a++)r.writeFixed64(o[a])}function a2(o,r){for(var a=0;a<o.length;a++)r.writeSFixed64(o[a])}function t1(o,r){return(o[r]|o[r+1]<<8|o[r+2]<<16)+16777216*o[r+3]}function V_(o,r,a){o[a]=r,o[a+1]=r>>>8,o[a+2]=r>>>16,o[a+3]=r>>>24}function WT(o,r){return(o[r]|o[r+1]<<8|o[r+2]<<16)+(o[r+3]<<24)}no.prototype={destroy:function(){this.buf=null},readFields:function(o,r,a){for(a=a||this.length;this.pos<a;){var u=this.readVarint(),f=u>>3,g=this.pos;this.type=7&u,o(f,r,this),this.pos===g&&this.skip(u)}return r},readMessage:function(o,r){return this.readFields(o,r,this.readVarint()+this.pos)},readFixed32:function(){var o=t1(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=WT(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=t1(this.buf,this.pos)+t1(this.buf,this.pos+4)*ym;return this.pos+=8,o},readSFixed64:function(){var o=t1(this.buf,this.pos)+WT(this.buf,this.pos+4)*ym;return this.pos+=8,o},readFloat:function(){var o=hy.read(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=hy.read(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var r,a,u=this.buf;return r=127&(a=u[this.pos++]),a<128?r:(r|=(127&(a=u[this.pos++]))<<7,a<128?r:(r|=(127&(a=u[this.pos++]))<<14,a<128?r:(r|=(127&(a=u[this.pos++]))<<21,a<128?r:function(f,g,v){var x,S,T=v.buf;if(x=(112&(S=T[v.pos++]))>>4,S<128||(x|=(127&(S=T[v.pos++]))<<3,S<128)||(x|=(127&(S=T[v.pos++]))<<10,S<128)||(x|=(127&(S=T[v.pos++]))<<17,S<128)||(x|=(127&(S=T[v.pos++]))<<24,S<128)||(x|=(1&(S=T[v.pos++]))<<31,S<128))return function vm(o,r,a){return a?4294967296*r+(o>>>0):4294967296*(r>>>0)+(o>>>0)}(f,x,g);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(a=u[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var o=this.readVarint()+this.pos,r=this.pos;return this.pos=o,o-r>=12&&qT?qT.decode(this.buf.subarray(r,o)):function(a,u,f){for(var g="",v=u;v<f;){var x,S,T,D=a[v],O=null,z=D>239?4:D>223?3:D>191?2:1;if(v+z>f)break;1===z?D<128&&(O=D):2===z?128==(192&(x=a[v+1]))&&(O=(31&D)<<6|63&x)<=127&&(O=null):3===z?(S=a[v+2],128==(192&(x=a[v+1]))&&128==(192&S)&&((O=(15&D)<<12|(63&x)<<6|63&S)<=2047||O>=55296&&O<=57343)&&(O=null)):4===z&&(S=a[v+2],T=a[v+3],128==(192&(x=a[v+1]))&&128==(192&S)&&128==(192&T)&&((O=(15&D)<<18|(63&x)<<12|(63&S)<<6|63&T)<=65535||O>=1114112)&&(O=null)),null===O?(O=65533,z=1):O>65535&&(O-=65536,g+=String.fromCharCode(O>>>10&1023|55296),O=56320|1023&O),g+=String.fromCharCode(O),v+=z}return g}(this.buf,r,o)},readBytes:function(){var o=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,o);return this.pos=o,r},readPackedVarint:function(o,r){if(this.type!==no.Bytes)return o.push(this.readVarint(r));var a=Zp(this);for(o=o||[];this.pos<a;)o.push(this.readVarint(r));return o},readPackedSVarint:function(o){if(this.type!==no.Bytes)return o.push(this.readSVarint());var r=Zp(this);for(o=o||[];this.pos<r;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==no.Bytes)return o.push(this.readBoolean());var r=Zp(this);for(o=o||[];this.pos<r;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==no.Bytes)return o.push(this.readFloat());var r=Zp(this);for(o=o||[];this.pos<r;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==no.Bytes)return o.push(this.readDouble());var r=Zp(this);for(o=o||[];this.pos<r;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==no.Bytes)return o.push(this.readFixed32());var r=Zp(this);for(o=o||[];this.pos<r;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==no.Bytes)return o.push(this.readSFixed32());var r=Zp(this);for(o=o||[];this.pos<r;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==no.Bytes)return o.push(this.readFixed64());var r=Zp(this);for(o=o||[];this.pos<r;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==no.Bytes)return o.push(this.readSFixed64());var r=Zp(this);for(o=o||[];this.pos<r;)o.push(this.readSFixed64());return o},skip:function(o){var r=7&o;if(r===no.Varint)for(;this.buf[this.pos++]>127;);else if(r===no.Bytes)this.pos=this.readVarint()+this.pos;else if(r===no.Fixed32)this.pos+=4;else{if(r!==no.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(o,r){this.writeVarint(o<<3|r)},realloc:function(o){for(var r=this.length||16;r<this.pos+o;)r*=2;if(r!==this.length){var a=new Uint8Array(r);a.set(this.buf),this.buf=a,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),V_(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),V_(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),V_(this.buf,-1&o,this.pos),V_(this.buf,Math.floor(o*$T),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),V_(this.buf,-1&o,this.pos),V_(this.buf,Math.floor(o*$T),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(r,a){var u,f,g,x;if(r>=0?(u=r%4294967296|0,f=r/4294967296|0):(f=~(-r/4294967296),4294967295^(u=~(-r%4294967296))?u=u+1|0:(u=0,f=f+1|0)),r>=0x10000000000000000||r<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),g=u,(x=a).buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,x.buf[x.pos]=127&(g>>>=7),function(g,v){var x=(7&g)<<4;v.buf[v.pos++]|=x|((g>>>=3)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g)))))}(f,a)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(!!o)},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var r=this.pos;this.pos=function(u,f,g){for(var v,x,S=0;S<f.length;S++){if((v=f.charCodeAt(S))>55295&&v<57344){if(!x){v>56319||S+1===f.length?(u[g++]=239,u[g++]=191,u[g++]=189):x=v;continue}if(v<56320){u[g++]=239,u[g++]=191,u[g++]=189,x=v;continue}v=x-55296<<10|v-56320|65536,x=null}else x&&(u[g++]=239,u[g++]=191,u[g++]=189,x=null);v<128?u[g++]=v:(v<2048?u[g++]=v>>6|192:(v<65536?u[g++]=v>>12|224:(u[g++]=v>>18|240,u[g++]=v>>12&63|128),u[g++]=v>>6&63|128),u[g++]=63&v|128)}return g}(this.buf,o,this.pos);var a=this.pos-r;a>=128&&vi(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeFloat:function(o){this.realloc(4),hy.write(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),hy.write(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var r=o.length;this.writeVarint(r),this.realloc(r);for(var a=0;a<r;a++)this.buf[this.pos++]=o[a]},writeRawMessage:function(o,r){this.pos++;var a=this.pos;o(r,this);var u=this.pos-a;u>=128&&vi(a,u,this),this.pos=a-1,this.writeVarint(u),this.pos+=u},writeMessage:function(o,r,a){this.writeTag(o,no.Bytes),this.writeRawMessage(r,a)},writePackedVarint:function(o,r){r.length&&this.writeMessage(o,KT,r)},writePackedSVarint:function(o,r){r.length&&this.writeMessage(o,XF,r)},writePackedBoolean:function(o,r){r.length&&this.writeMessage(o,YF,r)},writePackedFloat:function(o,r){r.length&&this.writeMessage(o,aL,r)},writePackedDouble:function(o,r){r.length&&this.writeMessage(o,Wi,r)},writePackedFixed32:function(o,r){r.length&&this.writeMessage(o,o2,r)},writePackedSFixed32:function(o,r){r.length&&this.writeMessage(o,JF,r)},writePackedFixed64:function(o,r){r.length&&this.writeMessage(o,e5,r)},writePackedSFixed64:function(o,r){r.length&&this.writeMessage(o,a2,r)},writeBytesField:function(o,r){this.writeTag(o,no.Bytes),this.writeBytes(r)},writeFixed32Field:function(o,r){this.writeTag(o,no.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(o,r){this.writeTag(o,no.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(o,r){this.writeTag(o,no.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(o,r){this.writeTag(o,no.Fixed64),this.writeSFixed64(r)},writeVarintField:function(o,r){this.writeTag(o,no.Varint),this.writeVarint(r)},writeSVarintField:function(o,r){this.writeTag(o,no.Varint),this.writeSVarint(r)},writeStringField:function(o,r){this.writeTag(o,no.Bytes),this.writeString(r)},writeFloatField:function(o,r){this.writeTag(o,no.Fixed32),this.writeFloat(r)},writeDoubleField:function(o,r){this.writeTag(o,no.Fixed64),this.writeDouble(r)},writeBooleanField:function(o,r){this.writeVarintField(o,!!r)}};var H_=Ta(ZF);const uw=3;function t5(o,r,a){r.glyphs=[],1===o&&a.readMessage(n5,r)}function n5(o,r,a){if(3===o){const{id:u,bitmap:f,width:g,height:v,left:x,top:S,advance:T}=a.readMessage(i5,{});r.glyphs.push({id:u,bitmap:new gh({width:g+2*uw,height:v+2*uw},f),metrics:{width:g,height:v,left:x,top:S,advance:T}})}else 4===o?r.ascender=a.readSVarint():5===o&&(r.descender=a.readSVarint())}function i5(o,r,a){1===o?r.id=a.readVarint():2===o?r.bitmap=a.readBytes():3===o?r.width=a.readVarint():4===o?r.height=a.readVarint():5===o?r.left=a.readSVarint():6===o?r.top=a.readSVarint():7===o&&(r.advance=a.readVarint())}const l2=uw,Xc={horizontal:1,vertical:2,horizontalOnly:3};class Ed{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,a){const u=new Ed;return u.scale=r||1,u.fontStack=a,u}static forImage(r){const a=new Ed;return a.imageName=r,a}}class rA{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,a){const u=new rA;for(let f=0;f<r.sections.length;f++){const g=r.sections[f];g.image?u.addImageSection(g):u.addTextSection(g,a)}return u}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCodePoint(r){return this.text.codePointAt(r)}verticalizePunctuation(r){this.text=function(a,u){let f="";for(let g=0;g<a.length;g++){const v=a.charCodeAt(g+1)||null,x=a.charCodeAt(g-1)||null;f+=!u&&(v&&$s(v)&&!uy[a[g+1]]||x&&$s(x)&&!uy[a[g-1]])||!uy[a[g]]?a[g]:uy[a[g]]}return f}(this.text,r)}trim(){let r=0;for(let u=0;u<this.text.length&&hw[this.text.charCodeAt(u)];u++)r++;let a=this.text.length;for(let u=this.text.length-1;u>=0&&u>=r&&hw[this.text.charCodeAt(u)];u--)a--;this.text=this.text.substring(r,a),this.sectionIndex=this.sectionIndex.slice(r,a)}substring(r,a){const u=new rA;return u.text=this.text.substring(r,a),u.sectionIndex=this.sectionIndex.slice(r,a),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,a)=>Math.max(r,this.sections[a].scale),0)}addTextSection(r,a){this.text+=r.text,this.sections.push(Ed.forText(r.scale,r.fontStack||a));const u=this.sections.length-1;for(let f=0;f<r.text.length;++f)this.sectionIndex.push(u)}addImageSection(r){const a=r.image?r.image.namePrimary:"";if(0===a.length)return void $o("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(Ed.forImage(a)),this.sectionIndex.push(this.sections.length-1)):$o("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function c2(o,r,a,u,f,g,v,x,S,T,D,O,z,$,K){const X=rA.fromFeature(o,f);O===Xc.vertical&&X.verticalizePunctuation(z);let ie=[];const ae=function(Oe,qe,rt,ht,It,At){if(!Oe)return[];const Kt=[],fn=function(an,Mn,on,ri,Kn,bn){let Hi=0;for(let Ei=0;Ei<an.length();Ei++){const hi=an.getSection(Ei);Hi+=u2(an.getCodePoint(Ei),hi,ri,Kn,Mn,bn)}return Hi/Math.max(1,Math.ceil(Hi/on))}(Oe,qe,rt,ht,It,At),Ut=Oe.text.indexOf("\u200b")>=0;let Dt=0;for(let an=0;an<Oe.length();an++){const Mn=Oe.getSection(an),on=Oe.getCodePoint(an);if(hw[on]||(Dt+=u2(on,Mn,ht,It,qe,At)),an<Oe.length()-1){const ri=!((Bt=on)<11904||!(gi["Bopomofo Extended"](Bt)||gi.Bopomofo(Bt)||gi["CJK Compatibility Forms"](Bt)||gi["CJK Compatibility Ideographs"](Bt)||gi["CJK Compatibility"](Bt)||gi["CJK Radicals Supplement"](Bt)||gi["CJK Strokes"](Bt)||gi["CJK Symbols and Punctuation"](Bt)||gi["CJK Unified Ideographs Extension A"](Bt)||gi["CJK Unified Ideographs"](Bt)||gi["Enclosed CJK Letters and Months"](Bt)||gi["Halfwidth and Fullwidth Forms"](Bt)||gi.Hiragana(Bt)||gi["Ideographic Description Characters"](Bt)||gi["Kangxi Radicals"](Bt)||gi["Katakana Phonetic Extensions"](Bt)||gi.Katakana(Bt)||gi["Vertical Forms"](Bt)||gi["Yi Radicals"](Bt)||gi["Yi Syllables"](Bt)));(ZT[on]||ri||Mn.imageName)&&Kt.push(r1(an+1,Dt,fn,Kt,n1(on,Oe.getCodePoint(an+1),ri&&Ut),!1))}}var Bt;return h2(r1(Oe.length(),Dt,fn,Kt,0,!0))}(X,T,g,r,u,$),{processBidirectionalText:be,processStyledBidirectionalText:Ce}=$l;if(be&&1===X.sections.length){const Oe=be(X.toString(),ae);for(const qe of Oe){const rt=new rA;rt.text=qe,rt.sections=X.sections;for(let ht=0;ht<qe.length;ht++)rt.sectionIndex.push(0);ie.push(rt)}}else if(Ce){const Oe=Ce(X.text,X.sectionIndex,ae);for(const qe of Oe){const rt=new rA;rt.text=qe[0],rt.sectionIndex=qe[1],rt.sections=X.sections,ie.push(rt)}}else ie=function(Oe,qe){const rt=[],ht=Oe.text;let It=0;for(const At of qe)rt.push(Oe.substring(It,At)),It=At;return It<ht.length&&rt.push(Oe.substring(It,ht.length)),rt}(X,ae);const Ee=[],Le={positionedLines:Ee,text:X.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:O,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Oe,qe,rt,ht,It,At,Kt,fn,Ut,Dt,Bt,an){let Mn=0,on=0,ri=0;const Kn="right"===fn?1:"left"===fn?0:.5;let bn=!1;for(const _r of It){const zi=_r.getSections();for(const Cr of zi){if(Cr.imageName)continue;const ur=qe[Cr.fontStack];if(ur&&(bn=void 0!==ur.ascender&&void 0!==ur.descender,!bn))break}if(!bn)break}let Hi=0;for(const _r of It){_r.trim();const zi=_r.getMaxScale(),Cr=(zi-1)*xc,ur={positionedGlyphs:[],lineOffset:0};Oe.positionedLines[Hi]=ur;const Yr=ur.positionedGlyphs;let Ar=0;if(!_r.length()){on+=At,++Hi;continue}let lo=0,hs=0;for(let Fs=0;Fs<_r.length();Fs++){const ds=_r.getSection(Fs),et=_r.getSectionIndex(Fs),Qs=_r.getCodePoint(Fs);let ma=ds.scale,vl=null,wr=null,Er=null,ho=xc,Rl=0;const Ol=!(Ut===Xc.horizontal||!Bt&&!U0(Qs)||Bt&&(hw[Qs]||(Ei=Qs,gi.Arabic(Ei)||gi["Arabic Supplement"](Ei)||gi["Arabic Extended-A"](Ei)||gi["Arabic Presentation Forms-A"](Ei)||gi["Arabic Presentation Forms-B"](Ei))));if(ds.imageName){const kl=ht[ds.imageName];if(!kl)continue;Er=ds.imageName,Oe.iconsInText=Oe.iconsInText||!0,wr=kl.paddedRect;const _o=kl.displaySize;ma=ma*xc/an,vl={width:_o[0],height:_o[1],left:0,top:-l2,advance:Ol?_o[1]:_o[0],localGlyph:!1},Rl=bn?-vl.height*ma:zi*xc-17-_o[1]*ma,ho=vl.advance;const _h=(Ol?_o[0]:_o[1])*ma-xc*zi;_h>0&&_h>Ar&&(Ar=_h)}else{const kl=rt[ds.fontStack];if(!kl)continue;kl[Qs]&&(wr=kl[Qs]);const _o=qe[ds.fontStack];if(!_o)continue;const _h=_o.glyphs[Qs];if(!_h)continue;if(vl=_h.metrics,ho=8203!==Qs?xc:0,bn){const ig=void 0!==_o.ascender?Math.abs(_o.ascender):0,_u=void 0!==_o.descender?Math.abs(_o.descender):0,yu=(ig+_u)*ma;lo<yu&&(lo=yu,hs=(ig-_u)/2*ma),Rl=-ig*ma}else Rl=(zi-ma)*xc-17}Ol?(Oe.verticalizable=!0,Yr.push({glyph:Qs,imageName:Er,x:Mn,y:on+Rl,vertical:Ol,scale:ma,localGlyph:vl.localGlyph,fontStack:ds.fontStack,sectionIndex:et,metrics:vl,rect:wr}),Mn+=ho*ma+Dt):(Yr.push({glyph:Qs,imageName:Er,x:Mn,y:on+Rl,vertical:Ol,scale:ma,localGlyph:vl.localGlyph,fontStack:ds.fontStack,sectionIndex:et,metrics:vl,rect:wr}),Mn+=vl.advance*ma+Dt)}0!==Yr.length&&(ri=Math.max(Mn-Dt,ri),bn?XT(Yr,Kn,Ar,hs,At*zi/2):XT(Yr,Kn,Ar,0,At/2)),Mn=0;const ns=At*zi+Ar;ur.lineOffset=Math.max(Ar,Cr),on+=ns,++Hi}var Ei;const hi=on,{horizontalAlign:xn,verticalAlign:ki}=fw(Kt);(function(_r,zi,Cr,ur,Yr,Ar){const lo=(zi-Cr)*Yr,hs=-Ar*ur;for(const ns of _r)for(const Fs of ns.positionedGlyphs)Fs.x+=lo,Fs.y+=hs})(Oe.positionedLines,Kn,xn,ki,ri,hi),Oe.top+=-ki*hi,Oe.bottom=Oe.top+hi,Oe.left+=-xn*ri,Oe.right=Oe.left+ri,Oe.hasBaseline=bn}(Le,r,a,u,ie,v,x,S,O,T,z,K),!function(Oe){for(const qe of Oe)if(0!==qe.positionedGlyphs.length)return!1;return!0}(Ee)&&Le}const hw={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ZT={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function u2(o,r,a,u,f,g){if(r.imageName){const v=u[r.imageName];return v?v.displaySize[0]*r.scale*xc/g+f:0}{const v=a[r.fontStack],x=v&&v.glyphs[o];return x?x.metrics.advance*r.scale+f:0}}function dw(o,r,a,u){const f=Math.pow(o-r,2);return u?o<r?f/2:2*f:f+Math.abs(a)*a}function n1(o,r,a){let u=0;return 10===o&&(u-=1e4),a&&(u+=150),40!==o&&65288!==o||(u+=50),41!==r&&65289!==r||(u+=50),u}function r1(o,r,a,u,f,g){let v=null,x=dw(r,a,f,g);for(const S of u){const T=dw(r-S.x,a,f,g)+S.badness;T<=x&&(v=S,x=T)}return{index:o,x:r,priorBreak:v,badness:x}}function h2(o){return o?h2(o.priorBreak).concat(o.index):[]}function fw(o){let r=.5,a=.5;switch(o){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:r,verticalAlign:a}}function XT(o,r,a,u,f){if(!(r||a||u||f))return;const g=o.length-1,v=o[g],x=(v.x+v.metrics.advance*v.scale)*r;for(let S=0;S<=g;S++)o[S].x-=x,o[S].y+=a+u+f}function r5(o,r,a,u){const{horizontalAlign:f,verticalAlign:g}=fw(u),v=a[0]-o.displaySize[0]*f,x=a[1]-o.displaySize[1]*g;return{imagePrimary:o,imageSecondary:r,top:x,bottom:x+o.displaySize[1],left:v,right:v+o.displaySize[0]}}function YT(o,r,a,u,f,g){const v=o.imagePrimary;let x;if(v.content){const ie=v.content,ae=v.pixelRatio||1;x=[ie[0]/ae,ie[1]/ae,v.displaySize[0]-ie[2]/ae,v.displaySize[1]-ie[3]/ae]}const S=r.left*g,T=r.right*g;let D,O,z,$;"width"===a||"both"===a?($=f[0]+S-u[3],O=f[0]+T+u[1]):($=f[0]+(S+T-v.displaySize[0])/2,O=$+v.displaySize[0]);const K=r.top*g,X=r.bottom*g;return"height"===a||"both"===a?(D=f[1]+K-u[0],z=f[1]+X+u[2]):(D=f[1]+(K+X-v.displaySize[1])/2,z=D+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:D,right:O,bottom:z,left:$,collisionPadding:x}}class Xp extends Nn{constructor(r,a,u,f,g){super(r,a),this.angle=f,this.z=u,void 0!==g&&(this.segment=g)}clone(){return new Xp(this.x,this.y,this.z,this.angle,this.segment)}}function d2(o,r,a,u,f){if(void 0===r.segment)return!0;let g=r,v=r.segment+1,x=0;for(;x>-a/2;){if(v--,v<0)return!1;x-=o[v].dist(g),g=o[v]}x+=o[v].dist(o[v+1]),v++;const S=[];let T=0;for(;x<a/2;){const D=o[v],O=o[v+1];if(!O)return!1;let z=o[v-1].angleTo(D)-D.angleTo(O);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:x,angleDelta:z}),T+=z;x-S[0].distance>u;)T-=S.shift().angleDelta;if(T>f)return!1;v++,x+=D.dist(O)}return!0}function s5(o){let r=0;for(let a=0;a<o.length-1;a++)r+=o[a].dist(o[a+1]);return r}function JT(o,r,a){return o?.6*r*a:0}function o5(o,r){return Math.max(o?o.right-o.left:0,r?r.right-r.left:0)}function lL(o,r,a,u,f,g){const v=JT(a,f,g),x=o5(a,u)*g;let S=0;const T=s5(o)/2;for(let D=0;D<o.length-1;D++){const O=o[D],z=o[D+1],$=O.dist(z);if(S+$>T){const K=(T-S)/$,X=Fi(O.x,z.x,K),ie=Fi(O.y,z.y,K),ae=new Xp(X,ie,0,z.angleTo(O),D);return!v||d2(o,ae,x,v,r)?ae:void 0}S+=$}}function eI(o,r,a,u,f,g,v,x,S){const T=JT(u,g,v),D=o5(u,f),O=D*v,z=0===o[0].x||o[0].x===S||0===o[0].y||o[0].y===S;return r-O<r/4&&(r=O+r/4),f2(o,z?r/2*x%r:(D/2+2*g)*v*x%r,r,T,a,O,z,!1,S)}function f2(o,r,a,u,f,g,v,x,S){const T=g/2,D=s5(o);let O=0,z=r-a,$=[];for(let K=0;K<o.length-1;K++){const X=o[K],ie=o[K+1],ae=X.dist(ie),be=ie.angleTo(X);for(;z+a<O+ae;){z+=a;const Ce=(z-O)/ae,Ee=Fi(X.x,ie.x,Ce),Le=Fi(X.y,ie.y,Ce);if(Ee>=0&&Ee<S&&Le>=0&&Le<S&&z-T>=0&&z+T<=D){const Oe=new Xp(Ee,Le,0,be,K);u&&!d2(o,Oe,g,u,f)||$.push(Oe)}}O+=ae}return x||$.length||v||($=f2(o,O/2,a,u,f,g,v,!0,S)),$}function a5(o,r,a,u,f){const g=[];for(let v=0;v<o.length;v++){const x=o[v];let S;for(let T=0;T<x.length-1;T++){let D=x[T],O=x[T+1];D.x<r&&O.x<r||(D.x<r?D=new Nn(r,D.y+(r-D.x)/(O.x-D.x)*(O.y-D.y))._round():O.x<r&&(O=new Nn(r,D.y+(r-D.x)/(O.x-D.x)*(O.y-D.y))._round()),D.y<a&&O.y<a||(D.y<a?D=new Nn(D.x+(a-D.y)/(O.y-D.y)*(O.x-D.x),a)._round():O.y<a&&(O=new Nn(D.x+(a-D.y)/(O.y-D.y)*(O.x-D.x),a)._round()),D.x>=u&&O.x>=u||(D.x>=u?D=new Nn(u,D.y+(u-D.x)/(O.x-D.x)*(O.y-D.y))._round():O.x>=u&&(O=new Nn(u,D.y+(u-D.x)/(O.x-D.x)*(O.y-D.y))._round()),D.y>=f&&O.y>=f||(D.y>=f?D=new Nn(D.x+(f-D.y)/(O.y-D.y)*(O.x-D.x),f)._round():O.y>=f&&(O=new Nn(D.x+(f-D.y)/(O.y-D.y)*(O.x-D.x),f)._round()),S&&D.equals(S[S.length-1])||(S=[D],g.push(S)),S.push(O)))))}}return g}function s1(o){let r=0,a=0;for(const v of o)r+=v.w*v.h,a=Math.max(a,v.w);o.sort((v,x)=>x.h-v.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),a),h:1/0}];let f=0,g=0;for(const v of o)for(let x=u.length-1;x>=0;x--){const S=u[x];if(!(v.w>S.w||v.h>S.h)){if(v.x=S.x,v.y=S.y,g=Math.max(g,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===S.w&&v.h===S.h){const T=u.pop();x<u.length&&(u[x]=T)}else v.h===S.h?(S.x+=v.w,S.w-=v.w):v.w===S.w?(S.y+=v.h,S.h-=v.h):(u.push({x:S.x+v.w,y:S.y,w:S.w-v.w,h:v.h}),S.y+=v.h,S.h-=v.h);break}}return{w:f,h:g,fill:r/(f*g)||0}}ai(Xp,"Anchor");const mh=1;class Aw{constructor(r,{pixelRatio:a,version:u,stretchX:f,stretchY:g,content:v}){this.paddedRect=r,this.pixelRatio=a,this.stretchX=f,this.stretchY=g,this.content=v,this.version=u}get tl(){return[this.paddedRect.x+mh,this.paddedRect.y+mh]}get br(){return[this.paddedRect.x+this.paddedRect.w-mh,this.paddedRect.y+this.paddedRect.h-mh]}get displaySize(){return[(this.paddedRect.w-2*mh)/this.pixelRatio,(this.paddedRect.h-2*mh)/this.pixelRatio]}}class tI{constructor(r,a){const u={},f={};this.haveRenderCallbacks=[];const g=[];this.addImages(r,u,g),this.addImages(a,f,g);const{w:v,h:x}=s1(g),S=new mu({width:v||1,height:x||1});for(const T in r){const D=r[T],O=u[T].paddedRect;mu.copy(D.data,S,{x:0,y:0},{x:O.x+mh,y:O.y+mh},D.data,D.sdf)}for(const T in a){const D=a[T],O=f[T].paddedRect,z=O.x+mh,$=O.y+mh,K=D.data.width,X=D.data.height;mu.copy(D.data,S,{x:0,y:0},{x:z,y:$},D.data),mu.copy(D.data,S,{x:0,y:X-1},{x:z,y:$-1},{width:K,height:1}),mu.copy(D.data,S,{x:0,y:0},{x:z,y:$+X},{width:K,height:1}),mu.copy(D.data,S,{x:K-1,y:0},{x:z-1,y:$},{width:1,height:X}),mu.copy(D.data,S,{x:0,y:0},{x:z+K,y:$},{width:1,height:X})}this.image=S,this.iconPositions=u,this.patternPositions=f}addImages(r,a,u){for(const f in r){const g=r[f],v={x:0,y:0,w:g.data.width+2*mh,h:g.data.height+2*mh};u.push(v),a[f]=new Aw(v,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(r,a,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>r.hasImage(f,u)),r.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const f in r.getUpdatedImages(u))this.patchUpdatedImage(this.iconPositions[f],r.getImage(f,u),a),this.patchUpdatedImage(this.patternPositions[f],r.getImage(f,u),a)}patchUpdatedImage(r,a,u){if(!r||!a||r.version===a.version)return;r.version=a.version;const[f,g]=r.tl,v=!!Object.keys(this.patternPositions).length;u.update(a.data,{useMipmap:v},{x:f,y:g})}}ai(Aw,"ImagePosition"),ai(tI,"ImageAtlas");const dy=1e20;function A2(o,r,a,u,f,g,v,x,S){for(let T=r;T<r+u;T++)Cs(o,a*g+T,g,f,v,x,S);for(let T=a;T<a+f;T++)Cs(o,T*g+r,1,u,v,x,S)}function Cs(o,r,a,u,f,g,v){g[0]=0,v[0]=-dy,v[1]=dy,f[0]=o[r];for(let x=1,S=0,T=0;x<u;x++){f[x]=o[r+x*a];const D=x*x;do{const O=g[S];T=(f[x]-f[O]+D-O*O)/(x-O)/2}while(T<=v[S]&&--S>-1);S++,g[S]=x,v[S]=T,v[S+1]=dy}for(let x=0,S=0;x<u;x++){for(;v[S+1]<x;)S++;const T=g[S],D=x-T;o[r+x*a]=f[T]+D*D}}const $e=2,pw={none:0,ideographs:1,all:2};class Ve{constructor(r,a,u){this.requestManager=r,this.localGlyphMode=a,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r,a){this.urls[a]=r}getGlyphs(r,a,u){const f=[],g=this.urls[a]||ar.GLYPHS_URL;for(const v in r)for(const x of r[v])f.push({stack:v,id:x});Hr(f,({stack:v,id:x},S)=>{let T=this.entries[v];T||(T=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let D=T.glyphs[x];if(void 0!==D)return void S(null,{stack:v,id:x,glyph:D});if(D=this._tinySDF(T,v,x),D)return T.glyphs[x]=D,void S(null,{stack:v,id:x,glyph:D});const O=Math.floor(x/256);if(256*O>65535)return void S(new Error("glyphs > 65535 not supported"));if(T.ranges[O])return void S(null,{stack:v,id:x,glyph:D});let z=T.requests[O];z||(z=T.requests[O]=[],Ve.loadGlyphRange(v,O,g,this.requestManager,($,K)=>{if(K){T.ascender=K.ascender,T.descender=K.descender;for(const X in K.glyphs)this._doesCharSupportLocalGlyph(+X)||(T.glyphs[+X]=K.glyphs[+X]);T.ranges[O]=!0}for(const X of z)X($,K);delete T.requests[O]})),z.push(($,K)=>{$?S($):K&&S(null,{stack:v,id:x,glyph:K.glyphs[x]||null})})},(v,x)=>{if(v)u(v);else if(x){const S={};for(const{stack:T,id:D,glyph:O}of x)void 0===S[T]&&(S[T]={}),void 0===S[T].glyphs&&(S[T].glyphs={}),S[T].glyphs[D]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics},S[T].ascender=this.entries[T].ascender,S[T].descender=this.entries[T].descender;u(null,S)}})}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==pw.none&&(this.localGlyphMode===pw.all?!!this.localFontFamily:!!this.localFontFamily&&(gi["CJK Unified Ideographs"](r)||gi["Hangul Syllables"](r)||gi.Hiragana(r)||gi.Katakana(r)||gi["CJK Symbols and Punctuation"](r)||gi["CJK Unified Ideographs Extension A"](r)||gi["CJK Unified Ideographs Extension B"](r)))}_tinySDF(r,a,u){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(u))return;let g=r.tinySDF;if(!g){let X="400";/bold/i.test(a)?X="900":/medium/i.test(a)?X="500":/light/i.test(a)&&(X="200"),g=r.tinySDF=new Ve.TinySDF({fontFamily:f,fontWeight:X,fontSize:24*$e,buffer:3*$e,radius:8*$e}),g.fontWeight=X}if(this.localGlyphs[g.fontWeight][u])return this.localGlyphs[g.fontWeight][u];const v=String.fromCodePoint(u),{data:x,width:S,height:T,glyphWidth:D,glyphHeight:O,glyphLeft:z,glyphTop:$,glyphAdvance:K}=g.draw(v);return this.localGlyphs[g.fontWeight][u]={id:u,bitmap:new gh({width:S,height:T},x),metrics:{width:D/$e,height:O/$e,left:z/$e,top:$/$e-27,advance:K/$e,localGlyph:!0}}}}Ve.loadGlyphRange=function(o,r,a,u,f){const g=256*r,v=g+255,x=u.transformRequest(u.normalizeGlyphsURL(a).replace("{fontstack}",o).replace("{range}",`${g}-${v}`),zl.Glyphs);Jt(x,(S,T)=>{if(S)f(S);else if(T){const D={},O=new H_(T).readFields(t5,{});for(const z of O.glyphs)D[z.id]=z;f(null,{glyphs:D,ascender:O.ascender,descender:O.descender})}})},Ve.TinySDF=class{constructor({fontSize:o=24,buffer:r=3,radius:a=8,cutoff:u=.25,fontFamily:f="sans-serif",fontWeight:g="normal",fontStyle:v="normal"}={}){this.buffer=r,this.cutoff=u,this.radius=a;const x=this.size=o+4*r,S=this._createCanvas(x),T=this.ctx=S.getContext("2d",{willReadFrequently:!0});T.font=`${v} ${g} ${o}px ${f}`,T.textBaseline="alphabetic",T.textAlign="left",T.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(o){const r=document.createElement("canvas");return r.width=r.height=o,r}draw(o){const{width:r,actualBoundingBoxAscent:a,actualBoundingBoxDescent:u,actualBoundingBoxLeft:f,actualBoundingBoxRight:g}=this.ctx.measureText(o),v=Math.ceil(a),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-f))),S=Math.min(this.size-this.buffer,v+Math.ceil(u)),T=x+2*this.buffer,D=S+2*this.buffer,O=Math.max(T*D,0),z=new Uint8ClampedArray(O),$={data:z,width:T,height:D,glyphWidth:x,glyphHeight:S,glyphTop:v,glyphLeft:0,glyphAdvance:r};if(0===x||0===S)return $;const{ctx:K,buffer:X,gridInner:ie,gridOuter:ae}=this;K.clearRect(X,X,x,S),K.fillText(o,X,X+v);const be=K.getImageData(X,X,x,S);ae.fill(dy,0,O),ie.fill(0,0,O);for(let Ce=0;Ce<S;Ce++)for(let Ee=0;Ee<x;Ee++){const Le=be.data[4*(Ce*x+Ee)+3]/255;if(0===Le)continue;const Oe=(Ce+X)*T+Ee+X;if(1===Le)ae[Oe]=0,ie[Oe]=dy;else{const qe=.5-Le;ae[Oe]=qe>0?qe*qe:0,ie[Oe]=qe<0?qe*qe:0}}A2(ae,0,0,T,D,T,this.f,this.v,this.z),A2(ie,X,X,x,S,T,this.f,this.v,this.z);for(let Ce=0;Ce<O;Ce++){const Ee=Math.sqrt(ae[Ce])-Math.sqrt(ie[Ce]);z[Ce]=Math.round(255-255*(Ee/this.radius+this.cutoff))}return $}};const Yp=mh;function nI(o,r,a,u){const f=[],g=o.imagePrimary,v=g.pixelRatio,x=g.paddedRect.w-2*Yp,S=g.paddedRect.h-2*Yp,T=o.right-o.left,D=o.bottom-o.top,O=g.stretchX||[[0,x]],z=g.stretchY||[[0,S]],$=(At,Kt)=>At+Kt[1]-Kt[0],K=O.reduce($,0),X=z.reduce($,0),ie=x-K,ae=S-X;let be=0,Ce=K,Ee=0,Le=X,Oe=0,qe=ie,rt=0,ht=ae;if(g.content&&u){const At=g.content;be=Q_(O,0,At[0]),Ee=Q_(z,0,At[1]),Ce=Q_(O,At[0],At[2]),Le=Q_(z,At[1],At[3]),Oe=At[0]-be,rt=At[1]-Ee,qe=At[2]-At[0]-Ce,ht=At[3]-At[1]-Le}const It=(At,Kt,fn,Ut)=>{const Dt=fy(At.stretch-be,Ce,T,o.left),Bt=bm(At.fixed-Oe,qe,At.stretch,K),an=fy(Kt.stretch-Ee,Le,D,o.top),Mn=bm(Kt.fixed-rt,ht,Kt.stretch,X),on=fy(fn.stretch-be,Ce,T,o.left),ri=bm(fn.fixed-Oe,qe,fn.stretch,K),Kn=fy(Ut.stretch-Ee,Le,D,o.top),bn=bm(Ut.fixed-rt,ht,Ut.stretch,X),Hi=new Nn(Dt,an),Ei=new Nn(on,an),hi=new Nn(on,Kn),xn=new Nn(Dt,Kn),ki=new Nn(Bt/v,Mn/v),_r=new Nn(ri/v,bn/v),zi=r*Math.PI/180;if(zi){const hs=Math.sin(zi),ns=Math.cos(zi),Fs=[ns,-hs,hs,ns];Hi._matMult(Fs),Ei._matMult(Fs),xn._matMult(Fs),hi._matMult(Fs)}const Cr=At.stretch+At.fixed,ur=fn.stretch+fn.fixed,Yr=Kt.stretch+Kt.fixed,Ar=Ut.stretch+Ut.fixed,lo=o.imageSecondary;return{tl:Hi,tr:Ei,bl:xn,br:hi,texPrimary:{x:g.paddedRect.x+Yp+Cr,y:g.paddedRect.y+Yp+Yr,w:ur-Cr,h:Ar-Yr},texSecondary:lo?{x:lo.paddedRect.x+Yp+Cr,y:lo.paddedRect.y+Yp+Yr,w:ur-Cr,h:Ar-Yr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ki,pixelOffsetBR:_r,minFontScaleX:qe/v/T,minFontScaleY:ht/v/D,isSDF:a}};if(u&&(g.stretchX||g.stretchY)){const At=j_(O,ie,K),Kt=j_(z,ae,X);for(let fn=0;fn<At.length-1;fn++){const Ut=At[fn],Dt=At[fn+1];for(let Bt=0;Bt<Kt.length-1;Bt++)f.push(It(Ut,Kt[Bt],Dt,Kt[Bt+1]))}}else f.push(It({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:S+1}));return f}function Q_(o,r,a){let u=0;for(const f of o)u+=Math.max(r,Math.min(a,f[1]))-Math.max(r,Math.min(a,f[0]));return u}function j_(o,r,a){const u=[{fixed:-Yp,stretch:0}];for(const[f,g]of o){const v=u[u.length-1];u.push({fixed:f-v.stretch,stretch:v.stretch}),u.push({fixed:f-v.stretch,stretch:v.stretch+(g-f)})}return u.push({fixed:r+Yp,stretch:a}),u}function fy(o,r,a,u){return o/r*a+u}function bm(o,r,a,u){return o-r*a/u}function iI(o,r,a,u){const f=r+o.positionedLines[u].lineOffset;return 0===u?a+f/2:a+(f+(r+o.positionedLines[u-1].lineOffset))/2}function p2(o,r=1,a=!1){let u=1/0,f=1/0,g=-1/0,v=-1/0;const x=o[0];for(let $=0;$<x.length;$++){const K=x[$];(!$||K.x<u)&&(u=K.x),(!$||K.y<f)&&(f=K.y),(!$||K.x>g)&&(g=K.x),(!$||K.y>v)&&(v=K.y)}const S=Math.min(g-u,v-f);let T=S/2;const D=new ou([],g2);if(0===S)return new Nn(u,f);for(let $=u;$<g;$+=S)for(let K=f;K<v;K+=S)D.push(new wm($+T,K+T,T,o));let O=function($){let K=0,X=0,ie=0;const ae=$[0];for(let be=0,Ce=ae.length,Ee=Ce-1;be<Ce;Ee=be++){const Le=ae[be],Oe=ae[Ee],qe=Le.x*Oe.y-Oe.x*Le.y;X+=(Le.x+Oe.x)*qe,ie+=(Le.y+Oe.y)*qe,K+=3*qe}return new wm(X/K,ie/K,0,$)}(o),z=D.length;for(;D.length;){const $=D.pop();($.d>O.d||!O.d)&&(O=$,a&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,z)),$.max-O.d<=r||(T=$.h/2,D.push(new wm($.p.x-T,$.p.y-T,T,o)),D.push(new wm($.p.x+T,$.p.y-T,T,o)),D.push(new wm($.p.x-T,$.p.y+T,T,o)),D.push(new wm($.p.x+T,$.p.y+T,T,o)),z+=4)}return a&&(console.log(`num probes: ${z}`),console.log(`best distance: ${O.d}`)),O.p}function g2(o,r){return r.max-o.max}class wm{constructor(r,a,u,f){this.p=new Nn(r,a),this.h=u,this.d=function(g,v){let x=!1,S=1/0;for(let T=0;T<v.length;T++){const D=v[T];for(let O=0,z=D.length,$=z-1;O<z;$=O++){const K=D[O],X=D[$];K.y>g.y!=X.y>g.y&&g.x<(X.x-K.x)*(g.y-K.y)/(X.y-K.y)+K.x&&(x=!x),S=Math.min(S,qc(g,K,X))}}return(x?1:-1)*Math.sqrt(S)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const gw=Number.POSITIVE_INFINITY,m2=Math.sqrt(2);function rI(o,[r,a]){let u=0,f=0;if(a===gw){r<0&&(r=0);const g=r/m2;switch(o){case"top-right":case"top-left":f=g-7;break;case"bottom-right":case"bottom-left":f=7-g;break;case"bottom":f=7-r;break;case"top":f=r-7}switch(o){case"top-right":case"bottom-right":u=-g;break;case"top-left":case"bottom-left":u=g;break;case"left":u=r;break;case"right":u=-r}}else{switch(r=Math.abs(r),a=Math.abs(a),o){case"top-right":case"top-left":case"top":f=a-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-a}switch(o){case"top-right":case"bottom-right":case"right":u=-r;break;case"top-left":case"bottom-left":case"left":u=r}}return[u,f]}function _2(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function l5(o,r,a,u,f,g,v,x,S,T,D,O,z,$,K){let X=g.textMaxSize.evaluate(r,{},O);void 0===X&&(X=v);const ie=o.layers[0].layout,ae=ie.get("icon-offset").evaluate(r,{},O),be=oI(a.horizontal)||a.vertical,Ce="globe"===z.name,Ee=xc,Le=v/Ee,Oe=o.tilePixelRatio*X/Ee,qe=(Dt=o.overscaling,o.zoom>18&&Dt>2&&(Dt>>=1),Math.max(Jn/(512*Dt),1)*ie.get("symbol-spacing")),rt=ie.get("text-padding")*o.tilePixelRatio,ht=ie.get("icon-padding")*o.tilePixelRatio,It=Sr(ie.get("text-max-angle")),At="map"===ie.get("text-rotation-alignment")&&"point"!==ie.get("symbol-placement"),Kt="map"===ie.get("icon-rotation-alignment")&&"point"!==ie.get("symbol-placement"),fn=ie.get("symbol-placement"),Ut=qe/2;var Dt;const Bt=ie.get("icon-text-fit").evaluate(r,{},O),an=ie.get("icon-text-fit-padding").evaluate(r,{},O),Mn="none"!==Bt;let on;!1===o.hasAnyIconTextFit&&Mn&&(o.hasAnyIconTextFit=!0),u&&Mn&&(o.allowVerticalPlacement&&a.vertical&&(on=YT(u,a.vertical,Bt,an,ae,Le)),be&&(u=YT(u,be,Bt,an,ae,Le)));const ri=(Kn,bn,Hi)=>{if(bn.x<0||bn.x>=Jn||bn.y<0||bn.y>=Jn)return;let Ei=null;if(Ce){const{x:hi,y:xn,z:ki}=z.projectTilePoint(bn.x,bn.y,Hi);Ei={anchor:new Xp(hi,xn,ki,0,void 0),up:z.upVector(Hi,bn.x,bn.y)}}!function(hi,xn,ki,_r,zi,Cr,ur,Yr,Ar,lo,hs,ns,Fs,ds,et,Qs,ma,vl,wr,Er,ho,Rl,Ol,kl,_o,_h,ig){const _u=hi.addToLineVertexArray(xn,_r);let yu,Sd,b1,jw,XI,YI,JI,eD=0,tD=0,nD=0,iD=0,H2=-1,Q2=-1;const tp={};let rD=Xf("");const n0=ki?ki.anchor:xn,j2="none"!==Ar.layout.get("icon-text-fit").evaluate(ho,{},_o);let G2=0,Gw=0;if(void 0===Ar._unevaluatedLayout.getValue("text-radial-offset")?[G2,Gw]=Ar.layout.get("text-offset").evaluate(ho,{},_o).map(yh=>yh*xc):(G2=Ar.layout.get("text-radial-offset").evaluate(ho,{},_o)*xc,Gw=gw),hi.allowVerticalPlacement&&zi.vertical){const yh=zi.vertical;if(et)YI=_w(yh),Yr&&(JI=_w(Yr));else{const vh=Ar.layout.get("text-rotate").evaluate(ho,{},_o)+90;b1=mw(lo,n0,xn,hs,ns,Fs,yh,ds,vh,Qs),Yr&&(jw=mw(lo,n0,xn,hs,ns,Fs,Yr,vl,vh))}}if(Cr){const yh=Ar.layout.get("icon-rotate").evaluate(ho,{},_o),vh=nI(Cr,yh,Ol,j2),r0=Yr?nI(Yr,yh,Ol,j2):void 0;Sd=mw(lo,n0,xn,hs,ns,Fs,Cr,vl,yh),eD=4*vh.length;const $2=hi.iconSizeData;let Mm=null;"source"===$2.kind?(Mm=[uf*Ar.layout.get("icon-size").evaluate(ho,{},_o)],Mm[0]>xm&&$o(`${hi.layerIds[0]}: Value for "icon-size" is >= ${Ay}. Reduce your "icon-size".`)):"composite"===$2.kind&&(Mm=[uf*Rl.compositeIconSizes[0].evaluate(ho,{},_o),uf*Rl.compositeIconSizes[1].evaluate(ho,{},_o)],(Mm[0]>xm||Mm[1]>xm)&&$o(`${hi.layerIds[0]}: Value for "icon-size" is >= ${Ay}. Reduce your "icon-size".`)),hi.addSymbols(hi.icon,vh,Mm,Er,wr,ho,!1,ki,xn,_u.lineStartIndex,_u.lineLength,-1,kl,_o,_h,ig),H2=hi.icon.placedSymbolArray.length-1,r0&&(tD=4*r0.length,hi.addSymbols(hi.icon,r0,Mm,Er,wr,ho,Xc.vertical,ki,xn,_u.lineStartIndex,_u.lineLength,-1,kl,_o,_h,ig),Q2=hi.icon.placedSymbolArray.length-1)}for(const yh in zi.horizontal){const vh=zi.horizontal[yh];yu||(rD=Xf(vh.text),et?XI=_w(vh):yu=mw(lo,n0,xn,hs,ns,Fs,vh,ds,Ar.layout.get("text-rotate").evaluate(ho,{},_o),Qs));const r0=1===vh.positionedLines.length;if(nD+=sI(hi,ki,xn,vh,ur,Ar,et,ho,Qs,_u,zi.vertical?Xc.horizontal:Xc.horizontalOnly,r0?Object.keys(zi.horizontal):[yh],tp,H2,Rl,kl,_o,_h),r0)break}zi.vertical&&(iD+=sI(hi,ki,xn,zi.vertical,ur,Ar,et,ho,Qs,_u,Xc.vertical,["vertical"],tp,Q2,Rl,kl,_o,_h));let rg=-1;const $w=(yh,vh)=>yh?Math.max(yh,vh):vh;rg=$w(XI,rg),rg=$w(YI,rg),rg=$w(JI,rg);const sD=rg>-1?1:0;hi.glyphOffsetArray.length>=65535&&$o("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==ho.sortKey&&hi.addToSortKeyRanges(hi.symbolInstances.length,ho.sortKey),hi.symbolInstances.emplaceBack(xn.x,xn.y,n0.x,n0.y,n0.z,tp.right>=0?tp.right:-1,tp.center>=0?tp.center:-1,tp.left>=0?tp.left:-1,tp.vertical>=0?tp.vertical:-1,H2,Q2,rD,void 0!==yu?yu:hi.collisionBoxArray.length,void 0!==yu?yu+1:hi.collisionBoxArray.length,void 0!==b1?b1:hi.collisionBoxArray.length,void 0!==b1?b1+1:hi.collisionBoxArray.length,void 0!==Sd?Sd:hi.collisionBoxArray.length,void 0!==Sd?Sd+1:hi.collisionBoxArray.length,jw||hi.collisionBoxArray.length,jw?jw+1:hi.collisionBoxArray.length,hs,nD,iD,eD,tD,sD,0,G2,Gw,rg,0,j2?1:0)}(o,bn,Ei,Kn,a,u,f,on,o.layers[0],o.collisionBoxArray,r.index,r.sourceLayerIndex,o.index,rt,At,S,0,ht,Kt,ae,r,g,T,D,O,$,K)};if("line"===fn)for(const Kn of a5(r.geometry,0,0,Jn,Jn)){const bn=eI(Kn,qe,It,a.vertical||be,u,Ee,Oe,o.overscaling,Jn);for(const Hi of bn)be&&aI(o,be.text,Ut,Hi)||ri(Kn,Hi,O)}else if("line-center"===fn){for(const Kn of r.geometry)if(Kn.length>1){const bn=lL(Kn,It,a.vertical||be,u,Ee,Oe);bn&&ri(Kn,bn,O)}}else if("Polygon"===r.type)for(const Kn of qC(r.geometry,0)){const bn=p2(Kn,16);ri(Kn[0],new Xp(bn.x,bn.y,0,0,void 0),O)}else if("LineString"===r.type)for(const Kn of r.geometry)ri(Kn,new Xp(Kn[0].x,Kn[0].y,0,0,void 0),O);else if("Point"===r.type)for(const Kn of r.geometry)for(const bn of Kn)ri([bn],new Xp(bn.x,bn.y,0,0,void 0),O)}const Ay=255,xm=Ay*uf;function sI(o,r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie,ae){const be=function(Le,Oe,qe,rt,ht,It,At,Kt){const fn=[];if(0===Oe.positionedLines.length)return fn;const Ut=rt.layout.get("text-rotate").evaluate(It,{})*Math.PI/180,Dt=function(ri){const Kn=ri[0],bn=ri[1],Hi=Kn*bn;return Hi>0?[Kn,-bn]:Hi<0?[-Kn,bn]:0===Kn?[bn,Kn]:[bn,-Kn]}(qe);let Bt=Math.abs(Oe.top-Oe.bottom);for(const ri of Oe.positionedLines)Bt-=ri.lineOffset;const an=Oe.positionedLines.length,Mn=Bt/an;let on=Oe.top-qe[1];for(let ri=0;ri<an;++ri){const Kn=Oe.positionedLines[ri];on=iI(Oe,Mn,on,ri);for(const bn of Kn.positionedGlyphs){if(!bn.rect)continue;const Hi=bn.rect||{};let Ei=l2+1,hi=!0,xn=1,ki=0;if(bn.imageName){const Er=At[bn.imageName];if(!Er)continue;if(Er.sdf){$o("SDF images are not supported in formatted text and will be ignored.");continue}hi=!1,xn=Er.pixelRatio,Ei=mh/xn}const _r=(ht||Kt)&&bn.vertical,zi=bn.metrics.advance*bn.scale/2,Cr=bn.metrics,ur=bn.rect;if(null===ur)continue;Kt&&Oe.verticalizable&&(ki=bn.imageName?zi-bn.metrics.width*bn.scale/2:0);const Yr=ht?[bn.x+zi,bn.y]:[0,0];let Ar=[0,0],lo=[0,0],hs=!1;ht||(_r?(lo=[bn.x+zi+Dt[0],bn.y+Dt[1]-ki],hs=!0):Ar=[bn.x+zi+qe[0],bn.y+qe[1]-ki]);const ns=ur.w*bn.scale/(xn*(bn.localGlyph?$e:1)),Fs=ur.h*bn.scale/(xn*(bn.localGlyph?$e:1));let ds,et,Qs,ma;if(_r){const Er=bn.y-on,ho=new Nn(-zi,zi-Er),Rl=-Math.PI/2,Ol=new Nn(...lo);ds=new Nn(-zi+Ar[0],Ar[1]),ds._rotateAround(Rl,ho)._add(Ol),ds.x+=-Er+zi,ds.y-=(Cr.left-Ei)*bn.scale;const kl=bn.imageName?Cr.advance*bn.scale:xc*bn.scale,_o=String.fromCodePoint(bn.glyph);jT(_o)?ds.x+=(1-Ei)*bn.scale:Zc(_o)?ds.x+=kl-Cr.height*bn.scale+(-Ei-1)*bn.scale:ds.x+=bn.imageName||Cr.width+2*Ei===ur.w&&Cr.height+2*Ei===ur.h?(kl-Fs)/2:(kl-(Cr.height+2*Ei)*bn.scale)/2,et=new Nn(ds.x,ds.y-ns),Qs=new Nn(ds.x+Fs,ds.y),ma=new Nn(ds.x+Fs,ds.y-ns)}else{const Er=(Cr.left-Ei)*bn.scale-zi+Ar[0],ho=(-Cr.top-Ei)*bn.scale+Ar[1],Rl=Er+ns,Ol=ho+Fs;ds=new Nn(Er,ho),et=new Nn(Rl,ho),Qs=new Nn(Er,Ol),ma=new Nn(Rl,Ol)}if(Ut){let Er;Er=ht?new Nn(0,0):hs?new Nn(Dt[0],Dt[1]):new Nn(qe[0],qe[1]),ds._rotateAround(Ut,Er),et._rotateAround(Ut,Er),Qs._rotateAround(Ut,Er),ma._rotateAround(Ut,Er)}const vl=new Nn(0,0),wr=new Nn(0,0);fn.push({tl:ds,tr:et,bl:Qs,br:ma,texPrimary:Hi,texSecondary:void 0,writingMode:Oe.writingMode,glyphOffset:Yr,sectionIndex:bn.sectionIndex,isSDF:hi,pixelOffsetTL:vl,pixelOffsetBR:wr,minFontScaleX:0,minFontScaleY:0})}}return fn}(0,u,S,g,v,x,f,o.allowVerticalPlacement),Ce=o.textSizeData;let Ee=null;"source"===Ce.kind?(Ee=[uf*g.layout.get("text-size").evaluate(x,{},ie)],Ee[0]>xm&&$o(`${o.layerIds[0]}: Value for "text-size" is >= ${Ay}. Reduce your "text-size".`)):"composite"===Ce.kind&&(Ee=[uf*K.compositeTextSizes[0].evaluate(x,{},ie),uf*K.compositeTextSizes[1].evaluate(x,{},ie)],(Ee[0]>xm||Ee[1]>xm)&&$o(`${o.layerIds[0]}: Value for "text-size" is >= ${Ay}. Reduce your "text-size".`)),o.addSymbols(o.text,be,Ee,S,v,x,D,r,a,T.lineStartIndex,T.lineLength,$,X,ie,ae,!1);for(const Le of O)z[Le]=o.text.placedSymbolArray.length-1;return 4*be.length}function oI(o){for(const r in o)return o[r];return null}function mw(o,r,a,u,f,g,v,x,S,T){let D=v.top,O=v.bottom,z=v.left,$=v.right;const K=v.collisionPadding;if(K&&(z-=K[0],D-=K[1],$+=K[2],O+=K[3]),S){const X=new Nn(z,D),ie=new Nn($,D),ae=new Nn(z,O),be=new Nn($,O),Ce=Sr(S);let Ee=new Nn(0,0);T&&(Ee=new Nn(T[0],T[1])),X._rotateAround(Ce,Ee),ie._rotateAround(Ce,Ee),ae._rotateAround(Ce,Ee),be._rotateAround(Ce,Ee),z=Math.min(X.x,ie.x,ae.x,be.x),$=Math.max(X.x,ie.x,ae.x,be.x),D=Math.min(X.y,ie.y,ae.y,be.y),O=Math.max(X.y,ie.y,ae.y,be.y)}return o.emplaceBack(r.x,r.y,r.z,a.x,a.y,z,D,$,O,x,u,f,g),o.length-1}function _w(o){o.collisionPadding&&(o.top-=o.collisionPadding[1],o.bottom+=o.collisionPadding[3]);const r=o.bottom-o.top;return r>0?Math.max(10,r):null}function aI(o,r,a,u){const f=o.compareText;if(r in f){const g=f[r];for(let v=g.length-1;v>=0;v--)if(u.dist(g[v])<a)return!0}else f[r]=[];return f[r].push(u),!1}function lI(o,r){const a=o.fovAboveCenter,u=o.elevation?o.elevation.getMinElevationBelowMSL()*r:0,f=(o._camera.position[2]*o.worldSize-u)/Math.cos(o._pitch),g=Math.sin(a)*f/Math.sin(Math.max(Math.PI/2-o._pitch-a,.01)),v=Math.sin(o._pitch)*g+f;return Math.min(1.01*v,f*(1/o._horizonShift))}function o1(o,r){if(!r.isReprojectedInTileSpace)return{scale:1<<o.z,x:o.x,y:o.y,x2:o.x+1,y2:o.y+1,projection:r};const a=Math.pow(2,-o.z),u=o.x*a,f=(o.x+1)*a,g=o.y*a,v=(o.y+1)*a,x=rr(u),S=rr(f),T=kr(g),D=kr(v),O=r.project(x,T),z=r.project(S,T),$=r.project(S,D),K=r.project(x,D);let X=Math.min(O.x,z.x,$.x,K.x),ie=Math.min(O.y,z.y,$.y,K.y),ae=Math.max(O.x,z.x,$.x,K.x),be=Math.max(O.y,z.y,$.y,K.y);const Ce=a/16;function Ee(Oe,qe,rt,ht,It,At){const Kt=(rt+It)/2,fn=(ht+At)/2,Ut=r.project(rr(Kt),kr(fn)),Dt=Math.max(0,X-Ut.x,ie-Ut.y,Ut.x-ae,Ut.y-be);X=Math.min(X,Ut.x),ae=Math.max(ae,Ut.x),ie=Math.min(ie,Ut.y),be=Math.max(be,Ut.y),Dt>Ce&&(Ee(Oe,Ut,rt,ht,Kt,fn),Ee(Ut,qe,Kt,fn,It,At))}Ee(O,z,u,g,f,g),Ee(z,$,f,g,f,v),Ee($,K,f,v,u,v),Ee(K,O,u,v,u,g),X-=Ce,ie-=Ce,ae+=Ce,be+=Ce;const Le=1/Math.max(ae-X,be-ie);return{scale:Le,x:X*Le,y:ie*Le,x2:ae*Le,y2:be*Le,projection:r}}function Zh(o,{x:r,y:a},u=0){return new Nn(((r-u)*o.scale-o.x)*Jn,(a*o.scale-o.y)*Jn)}const c5=p.a6.identity(new Float32Array(16));class Cm{constructor(r){this.spec=r,this.name=r.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(r,a){return{x:0,y:0,z:0}}unproject(r,a){return new ct(0,0)}projectTilePoint(r,a,u){return{x:r,y:a,z:0}}locationPoint(r,a,u=!0){return r._coordinatePoint(r.locationCoordinate(a),u)}pixelsPerMeter(r,a){return lr(1,r)*a}pixelSpaceConversion(r,a,u){return 1}farthestPixelDistance(r){return lI(r,r.pixelsPerMeter)}pointCoordinate(r,a,u,f){const g=r.horizonLineFromTop(!1),v=new Nn(a,Math.max(g,u));return r.rayIntersectionCoordinate(r.pointRayIntersection(v,f))}pointCoordinate3D(r,a,u){const f=new Nn(a,u);if(r.elevation)return r.elevation.pointCoordinate(f);{const g=this.pointCoordinate(r,f.x,f.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(r,a){if(r.elevation)return!this.pointCoordinate3D(r,a.x,a.y);const u=r.horizonLineFromTop();return a.y<u}createInversionMatrix(r,a){return c5}createTileMatrix(r,a,u){let f,g,v;const x=u.canonical,S=p.a6.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const T=o1(x,this);f=1,g=T.x+u.wrap*T.scale,v=T.y,p.a6.scale(S,S,[f/T.scale,f/T.scale,r.pixelsPerMeter/a])}else f=a/r.zoomScale(x.z),g=(x.x+Math.pow(2,x.z)*u.wrap)*f,v=x.y*f;return p.a6.translate(S,S,[g,v,0]),p.a6.scale(S,S,[f/Jn,f/Jn,1]),S}upVector(r,a,u){return[0,0,1]}upVectorScale(r,a,u){return{metersToTile:1}}}class cL extends Cm{constructor(r){super(r),this.range=[4,7],this.center=r.center||[-96,37.5];const[a,u]=this.parallels=r.parallels||[29.5,45.5],f=Math.sin(Sr(a));this.n=(f+Math.sin(Sr(u)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(r,a){const{n:u,c:f,r0:g}=this,v=Sr(r-this.center[0]),x=Sr(a),S=Math.sqrt(f-2*u*Math.sin(x))/u;return{x:S*Math.sin(v*u),y:S*Math.cos(v*u)-g,z:0}}unproject(r,a){const{n:u,c:f,r0:g}=this,v=g+a;let x=Math.atan2(r,Math.abs(v))*Math.sign(v);v*u<0&&(x-=Math.PI*Math.sign(r)*Math.sign(v));const S=Sr(this.center[0])*u;x=Xu(x,-Math.PI-S,Math.PI-S);const T=ir(Jo(x/u)+this.center[0],-180,180),D=Math.asin(ir((f-(r*r+v*v)*u*u)/(2*u),-1,1)),O=ir(Jo(D),-Fr,Fr);return new ct(T,O)}}const G_=1.340264,py=-.081106,a1=893e-6,l1=.003796,yw=Math.sqrt(3)/2;class cI extends Cm{project(r,a){a=a/180*Math.PI,r=r/180*Math.PI;const u=Math.asin(yw*Math.sin(a)),f=u*u,g=f*f*f;return{x:.5*(r*Math.cos(u)/(yw*(G_+3*py*f+g*(7*a1+9*l1*f)))/Math.PI+.5),y:1-.5*(u*(G_+py*f+g*(a1+l1*f))/Math.PI+1),z:0}}unproject(r,a){r=(2*r-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,f=u*u,g=f*f*f;for(let D,O,z,$=0;$<12&&(O=u*(G_+py*f+g*(a1+l1*f))-a,z=G_+3*py*f+g*(7*a1+9*l1*f),D=O/z,u=ir(u-D,-Math.PI/3,Math.PI/3),f=u*u,g=f*f*f,!(Math.abs(D)<1e-12));++$);const v=yw*r*(G_+3*py*f+g*(7*a1+9*l1*f))/Math.cos(u),x=Math.asin(Math.sin(u)/yw),S=ir(180*v/Math.PI,-180,180),T=ir(180*x/Math.PI,-Fr,Fr);return new ct(S,T)}}class u5 extends Cm{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0}project(r,a){return{x:.5+r/360,y:.5-a/360,z:0}}unproject(r,a){const u=360*(r-.5),f=ir(360*(.5-a),-Fr,Fr);return new ct(u,f)}}const gy=Math.PI/2;function my(o){return Math.tan((gy+o)/2)}class h5 extends Cm{constructor(r){super(r),this.center=r.center||[0,30];const[a,u]=this.parallels=r.parallels||[30,30];let f=Sr(a),g=Sr(u);this.southernCenter=f+g<0,this.southernCenter&&(f=-f,g=-g);const v=Math.cos(f),x=my(f);this.n=f===g?Math.sin(f):Math.log(v/Math.cos(g))/Math.log(my(g)/x),this.f=v*Math.pow(my(f),this.n)/this.n}project(r,a){a=Sr(a),this.southernCenter&&(a=-a),r=Sr(r-this.center[0]);const u=1e-6,{n:f,f:g}=this;g>0?a<-gy+u&&(a=-gy+u):a>gy-u&&(a=gy-u);const v=g/Math.pow(my(a),f);let x=v*Math.sin(f*r),S=g-v*Math.cos(f*r);return x=.5*(x/Math.PI+.5),S=.5*(S/Math.PI+.5),{x,y:this.southernCenter?S:1-S,z:0}}unproject(r,a){r=(2*r-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:u,f}=this,g=f-a,v=Math.sign(g),x=Math.sign(u)*Math.sqrt(r*r+g*g);let S=Math.atan2(r,Math.abs(g))*v;g*u<0&&(S-=Math.PI*Math.sign(r)*v);const T=ir(Jo(S/u)+this.center[0],-180,180),D=ir(Jo(2*Math.atan(Math.pow(f/x,1/u))-gy),-Fr,Fr);return new ct(T,this.southernCenter?-D:D)}}class uI extends Cm{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(r,a){return{x:gr(r),y:Ki(a),z:0}}unproject(r,a){const u=rr(r),f=kr(a);return new ct(u,f)}}const hI=Sr(Fr);class d5 extends Cm{project(r,a){const u=(a=Sr(a))*a,f=u*u;return{x:.5*((r=Sr(r))*(.8707-.131979*u+f*(f*(.003971*u-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+u*(.015085+f*(.028874*u-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(r,a){r=(2*r-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,f=25,g=0,v=u*u;do{v=u*u;const T=v*v;g=(u*(1.007226+v*(.015085+T*(.028874*v-.044475-.005916*T)))-a)/(1.007226+v*(.045255+T*(.259866*v-.311325-.005916*11*T))),u=ir(u-g,-hI,hI)}while(Math.abs(g)>1e-6&&--f>0);v=u*u;const x=ir(Jo(r/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),S=Jo(u);return new ct(x,S)}}const dI=Sr(Fr);class ep extends Cm{project(r,a){a=Sr(a),r=Sr(r);const u=Math.cos(a),f=2/Math.PI,g=Math.acos(u*Math.cos(r/2)),v=Math.sin(g)/g,x=.5*(r*f+2*u*Math.sin(r/2)/v)||0,S=.5*(a+Math.sin(a)/v)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(S/Math.PI+1),z:0}}unproject(r,a){let u=r=(2*r-.5)*Math.PI,f=a=(2*(1-a)-1)*Math.PI,g=25;const v=1e-6;let x=0,S=0;do{const T=Math.cos(f),D=Math.sin(f),O=2*D*T,z=D*D,$=T*T,K=Math.cos(u/2),X=Math.sin(u/2),ie=2*K*X,ae=X*X,be=1-$*K*K,Ce=be?1/be:0,Ee=be?Math.acos(T*K)*Math.sqrt(1/be):0,Le=.5*(2*Ee*T*X+2*u/Math.PI)-r,Oe=.5*(Ee*D+f)-a,qe=.5*Ce*($*ae+Ee*T*K*z)+1/Math.PI,rt=Ce*(ie*O/4-Ee*D*X),ht=.125*Ce*(O*X-Ee*D*$*ie),It=.5*Ce*(z*K+Ee*ae*T)+.5,At=rt*ht-It*qe;x=(Oe*rt-Le*It)/At,S=(Le*ht-Oe*qe)/At,u=ir(u-x,-Math.PI,Math.PI),f=ir(f-S,-dI,dI)}while((Math.abs(x)>v||Math.abs(S)>v)&&--g>0);return new ct(Jo(u),Jo(f))}}class vw extends Cm{constructor(r){super(r),this.center=r.center||[0,0],this.parallels=r.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Sr(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(r,a){const{scale:u,cosPhi:f}=this;return{x:Sr(r)*f*u+.5,y:-Math.sin(Sr(a))/f*u+.5,z:0}}unproject(r,a){const{scale:u,cosPhi:f}=this,g=-(a-.5)/u,v=ir(Jo((r-.5)/u)/f,-180,180),x=Math.asin(ir(g*f,-1,1)),S=ir(Jo(x),-Fr,Fr);return new ct(v,S)}}class f5 extends uI{constructor(r){super(r),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(r,a,u){const f=kv(r,a,u),g=Pv(tA(u));return p.N.transformMat4(f,f,g),{x:f[0],y:f[1],z:f[2]}}locationPoint(r,a){const u=Pt(a.lat,a.lng),f=p.N.normalize([],u),g=r.elevation?r.elevation.getAtPointOrZero(r.locationCoordinate(a),r._centerAltitude):r._centerAltitude,v=lr(1,0)*Jn*g;p.N.scaleAndAdd(u,u,f,v);const x=p.a6.identity(new Float64Array(16));return p.a6.multiply(x,r.pixelMatrix,r.globeMatrix),p.N.transformMat4(u,u,x),new Nn(u[0],u[1])}pixelsPerMeter(r,a){return lr(1,0)*a}pixelSpaceConversion(r,a,u){const f=lr(1,r)*a,g=Fi(lr(1,45)*a,f,u);return this.pixelsPerMeter(r,a)/g}createTileMatrix(r,a,u){const f=J0(tA(u.canonical));return p.a6.multiply(new Float64Array(16),r.globeMatrix,f)}createInversionMatrix(r,a){const{center:u}=r,f=Pv(tA(a));return p.a6.rotateY(f,f,Sr(u.lng)),p.a6.rotateX(f,f,Sr(u.lat)),p.a6.scale(f,f,[r._pixelsPerMercatorPixel,r._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(r,a,u,f){return PC(r,a,u,!0)||new Xr(0,0)}pointCoordinate3D(r,a,u){const f=this.pointCoordinate(r,a,u,0);return[f.x,f.y,f.z]}isPointAboveHorizon(r,a){return!PC(r,a.x,a.y,!1)}farthestPixelDistance(r){const a=function(f,g){const v=f.cameraToCenterDistance,x=f._centerAltitude*g,S=f._camera,T=f._camera.forward(),D=p.N.add([],p.N.scale([],T,-v),[0,0,x]),O=f.worldSize/(2*Math.PI),z=[0,0,-O],$=f.width/f.height,K=Math.tan(f.fovAboveCenter),X=p.N.scale([],S.up(),K),ie=p.N.scale([],S.right(),K*$),ae=p.N.normalize([],p.N.add([],p.N.add([],T,X),ie)),be=[];let Ce;if(new Kp(D,ae).closestPointOnSphere(z,O,be)){const Ee=p.N.add([],be,z),Le=p.N.sub([],Ee,D);Ce=Math.cos(f.fovAboveCenter)*p.N.length(Le)}else{const Ee=p.N.sub([],D,z),Le=p.N.sub([],z,D);p.N.normalize(Le,Le);const Oe=p.N.length(Ee)-O;Ce=Math.sqrt(Oe*(Oe+2*O));const qe=Math.acos(Ce/(O+Oe))-Math.acos(p.N.dot(T,Le));Ce*=Math.cos(qe)}return 1.01*Ce}(r,this.pixelsPerMeter(r.center.lat,r.worldSize)),u=gm(r.zoom);if(u>0){const f=lI(r,lr(1,r.center.lat)*r.worldSize),g=r.worldSize/(2*Math.PI),v=Math.max(r.width,r.height)/r.worldSize*Math.PI;return Fi(a,f+g*(1-Math.cos(v)),Math.pow(u,10))}return a}upVector(r,a,u){return kv(a,u,r,1)}upVectorScale(r){return{metersToTile:M_(kb(tA(r)))}}}function y2(o){const r=o.parallels,a=!!r&&Math.abs(r[0]+r[1])<.01;switch(o.name){case"mercator":return new uI(o);case"equirectangular":return new u5(o);case"naturalEarth":return new d5(o);case"equalEarth":return new cI(o);case"winkelTripel":return new ep(o);case"albers":return a?new vw(o):new cL(o);case"lambertConformalConic":return a?new vw(o):new h5(o);case"globe":return new f5(o)}throw new Error(`Invalid projection name: ${o.name}`)}const A5=JA.types,fI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function c1(o,r,a,u,f,g,v,x,S,T,D,O,z){const $=x?Math.min(xm,Math.round(x[0])):0,K=x?Math.min(xm,Math.round(x[1])):0;o.emplaceBack(r,a,Math.round(32*u),Math.round(32*f),g,v,($<<1)+(S?1:0),K,16*T,16*D,256*O,256*z)}function $_(o,r,a){o.emplaceBack(r,a)}function _y(o,r,a,u,f,g,v){o.emplaceBack(r,a,u,f,g,v)}function v2(o,r,a,u,f){o.emplaceBack(r,a,u,f),o.emplaceBack(r,a,u,f),o.emplaceBack(r,a,u,f),o.emplaceBack(r,a,u,f)}function AI(o){for(const r of o.sections)if(Zg(r.text))return!0;return!1}class bw{constructor(r){this.layoutVertexArray=new zp,this.indexArray=new el,this.programConfigurations=r,this.segments=new zo,this.dynamicLayoutVertexArray=new Hh,this.opacityVertexArray=new La,this.placedSymbolArray=new ti,this.iconTransitioningVertexArray=new fu,this.globeExtVertexArray=new p_,this.zOffsetVertexArray=new cm}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(r,a,u,f,g){this.isEmpty()||(u&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,GF.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,Jv.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,fI,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=r.createVertexBuffer(this.iconTransitioningVertexArray,n2.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,$F.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||g)&&(this.zOffsetVertexBuffer=r.createVertexBuffer(this.zOffsetVertexArray,qF.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||f)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}ai(bw,"SymbolBuffers");class ww{constructor(r,a,u){this.layoutVertexArray=new r,this.layoutAttributes=a,this.indexArray=new u,this.segments=new zo,this.collisionVertexArray=new lm,this.collisionVertexArrayExt=new Hh}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,sL.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,cw.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ai(ww,"CollisionBuffers");class u1{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=p.a6.identity([]),this.placementViewportMatrix=p.a6.identity([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=s2(this.zoom,a["text-size"]),this.iconSizeData=s2(this.zoom,a["icon-size"]);const u=this.layers[0].layout,f=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==g&&void 0!==f.constantOr(1),this.sortFeaturesByY=("viewport-y"===g||"auto"===g&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(v=>Xc[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=r.sourceID,this.projection=r.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate")}createArrays(){this.text=new bw(new le(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new bw(new le(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new y_,this.lineVertexArray=new vd,this.symbolInstances=new Dl}calculateGlyphDependencies(r,a,u,f,g){for(let v=0;v<r.length;v++){const x=r.codePointAt(v);if(void 0===x)break;if(a[x]=!0,f&&g&&x<=65535){const S=uy[r.charAt(v)];S&&(a[S.charCodeAt(0)]=!0)}}}populate(r,a,u,f){const g=this.layers[0],v=g.layout,x="globe"===this.projection.name,S=v.get("text-font"),T=v.get("text-field"),D=v.get("icon-image"),O=("constant"!==T.value.kind||T.value.value instanceof xo&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&("constant"!==S.value.kind||S.value.value.length>0),z="constant"!==D.value.kind||!!D.value.value||Object.keys(D.parameters).length>0,$=v.get("symbol-sort-key");if(this.features=[],!O&&!z)return;const K=a.iconDependencies,X=a.glyphDependencies,ie=a.availableImages,ae=new uo(this.zoom);for(const{feature:be,id:Ce,index:Ee,sourceLayerIndex:Le}of r){const Oe=g._featureFilter.needGeometry,qe=fa(be,Oe);if(!g._featureFilter.filter(ae,qe,u))continue;if(Oe||(qe.geometry=oo(be,u,f)),x&&1!==be.type&&u.z<=5){const At=qe.geometry,Kt=.98078528056,fn=(Ut,Dt)=>{const Bt=kv(Ut.x,Ut.y,u,1),an=kv(Dt.x,Dt.y,u,1);return p.N.dot(Bt,an)<Kt};for(let Ut=0;Ut<At.length;Ut++)At[Ut]=gl(At[Ut],fn)}let rt,ht;if(O){const At=g.getValueAndResolveTokens("text-field",qe,u,ie),Kt=xo.factory(At);AI(Kt)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Vh()||this.hasRTLText&&$l.isParsed())&&(rt=oL(Kt,g,qe))}if(z){const At=g.getValueAndResolveTokens("icon-image",qe,u,ie);ht=At instanceof Ri?At:Ri.fromString(At)}if(!rt&&!ht)continue;const It=this.sortFeaturesByKey?$.evaluate(qe,{},u):void 0;if(this.features.push({id:Ce,text:rt,icon:ht,index:Ee,sourceLayerIndex:Le,geometry:qe.geometry,properties:be.properties,type:A5[be.type],sortKey:It}),ht&&(K[ht.namePrimary]=!0,ht.nameSecondary&&(K[ht.nameSecondary]=!0)),rt){const At=S.evaluate(qe,{},u).join(","),Kt="map"===v.get("text-rotation-alignment")&&"point"!==v.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Xc.vertical)>=0;for(const fn of rt.sections)if(fn.image)K[fn.image.namePrimary]=!0;else{const Ut=zc(rt.toString()),Dt=fn.fontStack||At,Bt=X[Dt]=X[Dt]||{};this.calculateGlyphDependencies(fn.text,Bt,Kt,this.allowVerticalPlacement,Ut)}}}"line"===v.get("symbol-placement")&&(this.features=function(be){const Ce={},Ee={},Le=[];let Oe=0;function qe(At){Le.push(be[At]),Oe++}function rt(At,Kt,fn){const Ut=Ee[At];return delete Ee[At],Ee[Kt]=Ut,Le[Ut].geometry[0].pop(),Le[Ut].geometry[0]=Le[Ut].geometry[0].concat(fn[0]),Ut}function ht(At,Kt,fn){const Ut=Ce[Kt];return delete Ce[Kt],Ce[At]=Ut,Le[Ut].geometry[0].shift(),Le[Ut].geometry[0]=fn[0].concat(Le[Ut].geometry[0]),Ut}function It(At,Kt,fn){const Ut=fn?Kt[0][Kt[0].length-1]:Kt[0][0];return`${At}:${Ut.x}:${Ut.y}`}for(let At=0;At<be.length;At++){const Kt=be[At],fn=Kt.geometry,Ut=Kt.text?Kt.text.toString():null;if(!Ut){qe(At);continue}const Dt=It(Ut,fn),Bt=It(Ut,fn,!0);if(Dt in Ee&&Bt in Ce&&Ee[Dt]!==Ce[Bt]){const an=ht(Dt,Bt,fn),Mn=rt(Dt,Bt,Le[an].geometry);delete Ce[Dt],delete Ee[Bt],Ee[It(Ut,Le[Mn].geometry,!0)]=Mn,Le[an].geometry=null}else Dt in Ee?rt(Dt,Bt,fn):Bt in Ce?ht(Dt,Bt,fn):(qe(At),Ce[Dt]=Oe-1,Ee[Bt]=Oe-1)}return Le.filter(At=>At.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((be,Ce)=>be.sortKey-Ce.sortKey)}update(r,a,u,f,g){const v=0!==Object.keys(r).length;if(v&&!this.stateDependentLayers.length)return;const x=v?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(r,a,x,u,f,g),this.icon.programConfigurations.updatePaintArrays(r,a,x,u,f,g)}updateZOffset(){const r=(g,v,x)=>{u+=v,u>g.length&&g.resize(u);for(let S=-v;S<0;S++)g.emplace(S+u,x)},a=(g,v,x)=>{f+=v,f>g.length&&g.resize(f);for(let S=-v;S<0;S++)g.emplace(S+f,x)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,f=0;for(let g=0;g<this.symbolInstances.length;g++){const v=this.symbolInstances.get(g),{numHorizontalGlyphVertices:x,numVerticalGlyphVertices:S,numIconVertices:T}=v,D=v.zOffset,O=T>0;if((x>0||S>0)&&(r(this.text.zOffsetVertexArray,x,D),r(this.text.zOffsetVertexArray,S,D)),O){const{placedIconSymbolIndex:z,verticalPlacedIconSymbolIndex:$}=v;z>=0&&a(this.icon.zOffsetVertexArray,T,D),$>=0&&a(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,D)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=y2(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,a){const u=this.lineVertexArray.length;if(void 0!==r.segment)for(const{x:f,y:g}of a)this.lineVertexArray.emplaceBack(f,g);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(r,a,u,f,g,v,x,S,T,D,O,z,$,K,X,ie){const ae=r.indexArray,be=r.layoutVertexArray,Ce=r.globeExtVertexArray,Ee=r.segments.prepareSegment(4*a.length,be,ae,this.canOverlap?v.sortKey:void 0),Le=this.glyphOffsetArray.length,Oe=Ee.vertexLength,qe=this.allowVerticalPlacement&&x===Xc.vertical?Math.PI/2:0,rt=v.text&&v.text.sections;for(let It=0;It<a.length;It++){const{tl:At,tr:Kt,bl:fn,br:Ut,texPrimary:Dt,texSecondary:Bt,pixelOffsetTL:an,pixelOffsetBR:Mn,minFontScaleX:on,minFontScaleY:ri,glyphOffset:Kn,isSDF:bn,sectionIndex:Hi}=a[It],Ei=Ee.vertexLength,hi=Kn[1];if(c1(be,T.x,T.y,At.x,hi+At.y,Dt.x,Dt.y,u,bn,an.x,an.y,on,ri),c1(be,T.x,T.y,Kt.x,hi+Kt.y,Dt.x+Dt.w,Dt.y,u,bn,Mn.x,an.y,on,ri),c1(be,T.x,T.y,fn.x,hi+fn.y,Dt.x,Dt.y+Dt.h,u,bn,an.x,Mn.y,on,ri),c1(be,T.x,T.y,Ut.x,hi+Ut.y,Dt.x+Dt.w,Dt.y+Dt.h,u,bn,Mn.x,Mn.y,on,ri),S){const{x:xn,y:ki,z:_r}=S.anchor,[zi,Cr,ur]=S.up;_y(Ce,xn,ki,_r,zi,Cr,ur),_y(Ce,xn,ki,_r,zi,Cr,ur),_y(Ce,xn,ki,_r,zi,Cr,ur),_y(Ce,xn,ki,_r,zi,Cr,ur),v2(r.dynamicLayoutVertexArray,xn,ki,_r,qe)}else v2(r.dynamicLayoutVertexArray,T.x,T.y,T.z,qe);if(ie){const xn=Bt||Dt;$_(r.iconTransitioningVertexArray,xn.x,xn.y),$_(r.iconTransitioningVertexArray,xn.x+xn.w,xn.y),$_(r.iconTransitioningVertexArray,xn.x,xn.y+xn.h),$_(r.iconTransitioningVertexArray,xn.x+xn.w,xn.y+xn.h)}ae.emplaceBack(Ei,Ei+1,Ei+2),ae.emplaceBack(Ei+1,Ei+2,Ei+3),Ee.vertexLength+=4,Ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Kn[0]),It!==a.length-1&&Hi===a[It+1].sectionIndex||r.programConfigurations.populatePaintArrays(be.length,v,v.index,{},$,K,X,rt&&rt[Hi])}const ht=S?S.anchor:T;r.placedSymbolArray.emplaceBack(ht.x,ht.y,ht.z,T.x,T.y,Le,this.glyphOffsetArray.length-Le,Oe,D,O,T.segment,u?u[0]:0,u?u[1]:0,f[0],f[1],x,0,!1,0,z,0)}_commitLayoutVertex(r,a,u,f,g,v,x){r.emplaceBack(a,u,f,g,v,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(r,a,u,f,g,v,x){const S=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),T=S.vertexLength,D=x.tileAnchorX,O=x.tileAnchorY;for(let $=0;$<4;$++)u.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,a,r.padding,x.zOffset),this._commitLayoutVertex(u.layoutVertexArray,f,g,v,D,O,new Nn(r.x1,r.y1)),this._commitLayoutVertex(u.layoutVertexArray,f,g,v,D,O,new Nn(r.x2,r.y1)),this._commitLayoutVertex(u.layoutVertexArray,f,g,v,D,O,new Nn(r.x2,r.y2)),this._commitLayoutVertex(u.layoutVertexArray,f,g,v,D,O,new Nn(r.x1,r.y2)),S.vertexLength+=4;const z=u.indexArray;z.emplaceBack(T,T+1),z.emplaceBack(T+1,T+2),z.emplaceBack(T+2,T+3),z.emplaceBack(T+3,T),S.primitiveLength+=4}_addTextDebugCollisionBoxes(r,a,u,f,g,v){for(let x=f;x<g;x++){const S=u.get(x),T=this.getSymbolInstanceTextSize(r,v,a,x);this._addCollisionDebugVertices(S,T,this.textCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(r,a,u,f,g,v){for(let x=f;x<g;x++){const S=u.get(x),T=this.getSymbolInstanceIconSize(r,a,v.placedIconSymbolIndex);this._addCollisionDebugVertices(S,T,this.iconCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,v)}}generateCollisionDebugBuffers(r,a){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ww(jA,r2.members,fu),this.iconCollisionBox=new ww(jA,r2.members,fu);const u=cy(this.iconSizeData,r),f=cy(this.textSizeData,r);for(let g=0;g<this.symbolInstances.length;g++){const v=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(f,r,a,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(f,r,a,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(u,r,a,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(u,r,a,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(r,a,u,f){const g=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:f),v=e1(this.textSizeData,r,g)/xc;return this.tilePixelRatio*v}getSymbolInstanceIconSize(r,a,u){const f=this.icon.placedSymbolArray.get(u),g=e1(this.iconSizeData,r,f);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(r,a,u,f){r.emplaceBack(a,-u,-u,f),r.emplaceBack(a,u,-u,f),r.emplaceBack(a,u,u,f),r.emplaceBack(a,-u,u,f)}_updateTextDebugCollisionBoxes(r,a,u,f,g,v){for(let x=f;x<g;x++){const S=u.get(x),T=this.getSymbolInstanceTextSize(r,v,a,x);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,T,S.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(r,a,u,f,g,v){for(let x=f;x<g;x++){const S=u.get(x),T=this.getSymbolInstanceIconSize(r,a,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,S.padding,v.zOffset)}}updateCollisionDebugBuffers(r,a){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const u=cy(this.iconSizeData,r),f=cy(this.textSizeData,r);for(let g=0;g<this.symbolInstances.length;g++){const v=this.symbolInstances.get(g);this._updateTextDebugCollisionBoxes(f,r,a,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(f,r,a,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(u,r,a,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._updateIconDebugCollisionBoxes(u,r,a,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,a,u,f,g,v,x,S,T){const D={};if(a<u){const{x1:O,y1:z,x2:$,y2:K,padding:X,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:be,tileAnchorX:Ce,tileAnchorY:Ee,featureIndex:Le}=r.get(a);D.textBox={x1:O,y1:z,x2:$,y2:K,padding:X,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:be,tileAnchorX:Ce,tileAnchorY:Ee},D.textFeatureIndex=Le}if(f<g){const{x1:O,y1:z,x2:$,y2:K,padding:X,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:be,tileAnchorX:Ce,tileAnchorY:Ee,featureIndex:Le}=r.get(f);D.verticalTextBox={x1:O,y1:z,x2:$,y2:K,padding:X,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:be,tileAnchorX:Ce,tileAnchorY:Ee},D.verticalTextFeatureIndex=Le}if(v<x){const{x1:O,y1:z,x2:$,y2:K,padding:X,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:be,tileAnchorX:Ce,tileAnchorY:Ee,featureIndex:Le}=r.get(v);D.iconBox={x1:O,y1:z,x2:$,y2:K,padding:X,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:be,tileAnchorX:Ce,tileAnchorY:Ee},D.iconFeatureIndex=Le}if(S<T){const{x1:O,y1:z,x2:$,y2:K,padding:X,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:be,tileAnchorX:Ce,tileAnchorY:Ee,featureIndex:Le}=r.get(S);D.verticalIconBox={x1:O,y1:z,x2:$,y2:K,padding:X,projectedAnchorX:ie,projectedAnchorY:ae,projectedAnchorZ:be,tileAnchorX:Ce,tileAnchorY:Ee},D.verticalIconFeatureIndex=Le}return D}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const u=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(r,a){const u=r.placedSymbolArray.get(a),f=u.vertexStartIndex+4*u.numGlyphs;for(let g=u.vertexStartIndex;g<f;g+=4)r.indexArray.emplaceBack(g,g+1,g+2),r.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const a=Math.sin(r),u=Math.cos(r),f=[],g=[],v=[];for(let x=0;x<this.symbolInstances.length;++x){v.push(x);const S=this.symbolInstances.get(x);f.push(0|Math.round(a*S.tileAnchorX+u*S.tileAnchorY)),g.push(S.featureIndex)}return v.sort((x,S)=>f[x]-f[S]||g[S]-g[x]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let r=0;r<this.symbolInstances.length;++r)this.symbolInstanceIndexesSortedZOffset.push(r)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((r,a)=>this.symbolInstances.get(a).zOffset-this.symbolInstances.get(r).zOffset)}addToSortKeyRanges(r,a){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===a?u.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const u=this.symbolInstances.get(a);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:S,verticalPlacedIconSymbolIndex:T}=u;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),g>=0&&g!==f&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&v!==g&&v!==f&&this.addIndicesForPlacedSymbol(this.text,v),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}ai(u1,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),u1.addDynamicAttributes=v2;const b2=new ko({"symbol-placement":new Rn(bt.layout_symbol["symbol-placement"]),"symbol-spacing":new Rn(bt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Rn(bt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new wi(bt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Rn(bt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Rn(bt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Rn(bt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Rn(bt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Rn(bt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Rn(bt.layout_symbol["icon-rotation-alignment"]),"icon-size":new wi(bt.layout_symbol["icon-size"]),"icon-text-fit":new wi(bt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wi(bt.layout_symbol["icon-text-fit-padding"]),"icon-image":new wi(bt.layout_symbol["icon-image"]),"icon-rotate":new wi(bt.layout_symbol["icon-rotate"]),"icon-padding":new Rn(bt.layout_symbol["icon-padding"]),"icon-keep-upright":new Rn(bt.layout_symbol["icon-keep-upright"]),"icon-offset":new wi(bt.layout_symbol["icon-offset"]),"icon-anchor":new wi(bt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Rn(bt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Rn(bt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Rn(bt.layout_symbol["text-rotation-alignment"]),"text-field":new wi(bt.layout_symbol["text-field"]),"text-font":new wi(bt.layout_symbol["text-font"]),"text-size":new wi(bt.layout_symbol["text-size"]),"text-max-width":new wi(bt.layout_symbol["text-max-width"]),"text-line-height":new wi(bt.layout_symbol["text-line-height"]),"text-letter-spacing":new wi(bt.layout_symbol["text-letter-spacing"]),"text-justify":new wi(bt.layout_symbol["text-justify"]),"text-radial-offset":new wi(bt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Rn(bt.layout_symbol["text-variable-anchor"]),"text-anchor":new wi(bt.layout_symbol["text-anchor"]),"text-max-angle":new Rn(bt.layout_symbol["text-max-angle"]),"text-writing-mode":new Rn(bt.layout_symbol["text-writing-mode"]),"text-rotate":new wi(bt.layout_symbol["text-rotate"]),"text-padding":new Rn(bt.layout_symbol["text-padding"]),"text-keep-upright":new Rn(bt.layout_symbol["text-keep-upright"]),"text-transform":new wi(bt.layout_symbol["text-transform"]),"text-offset":new wi(bt.layout_symbol["text-offset"]),"text-allow-overlap":new Rn(bt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Rn(bt.layout_symbol["text-ignore-placement"]),"text-optional":new Rn(bt.layout_symbol["text-optional"]),visibility:new Rn(bt.layout_symbol.visibility)});var sA={paint:new ko({"icon-opacity":new wi(bt.paint_symbol["icon-opacity"]),"icon-emissive-strength":new wi(bt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new wi(bt.paint_symbol["text-emissive-strength"]),"icon-color":new wi(bt.paint_symbol["icon-color"]),"icon-halo-color":new wi(bt.paint_symbol["icon-halo-color"]),"icon-halo-width":new wi(bt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new wi(bt.paint_symbol["icon-halo-blur"]),"icon-translate":new Rn(bt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Rn(bt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new wi(bt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new wi(bt.paint_symbol["text-opacity"]),"text-color":new wi(bt.paint_symbol["text-color"],{runtimeType:Nr,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new wi(bt.paint_symbol["text-halo-color"]),"text-halo-width":new wi(bt.paint_symbol["text-halo-width"]),"text-halo-blur":new wi(bt.paint_symbol["text-halo-blur"]),"text-translate":new Rn(bt.paint_symbol["text-translate"]),"text-translate-anchor":new Rn(bt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Rn(bt.paint_symbol["icon-color-saturation"])}),layout:b2};class pI{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:cd,this.defaultValue=r}evaluate(r){if(r.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(r.formattedSection))return a.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ai(pI,"FormatSectionOverride",{omit:["defaultValue"]});class xw extends Vc{constructor(r,a,u){super(r,sA,a,u)}recalculate(r,a){super.recalculate(r,a),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const f=[];for(const g of u)f.indexOf(g)<0&&f.push(g);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(r,a,u,f){const g=this.layout.get(r).evaluate(a,{},u,f),v=this._unevaluatedLayout._values[r];return v.isDataDriven()||Bp(v.value)||!g?g:(x=a.properties,g.replace(/{([^{}]+)}/g,(T,D)=>D in x?String(x[D]):""));var x}createBucket(r){return new u1(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of sA.paint.overridableProperties){if(!xw.hasPaintOverride(this.layout,r))continue;const a=this.paint.get(r),u=new pI(a),f=new Gg(u,a.property.specification,this.scope,this.options);let g=null;g="constant"===a.value.kind||"source"===a.value.kind?new L0("source",f):new $g("composite",f,a.value.zoomStops,a.value._interpolationType),this.paint._values[r]=new Pp(a.property,g,a.parameters)}}_handleOverridablePaintPropertyUpdate(r,a,u){return!(!this.layout||a.isDataDriven()||u.isDataDriven())&&xw.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,a){const u=r.get("text-field"),f=sA.paint.properties[a];let g=!1;const v=x=>{for(const S of x)if(f.overrides&&f.overrides.hasOverride(S))return void(g=!0)};if("constant"===u.value.kind&&u.value.value instanceof xo)v(u.value.value.sections);else if("source"===u.value.kind){const x=T=>{g||(T instanceof Vd&&Oo(T.value)===Bf?v(T.value.sections):T instanceof _p?v(T.sections):T.eachChild(x))},S=u.value;S._styleExpression&&x(S._styleExpression.expression)}return g}getProgramIds(){const r=0!==this.paint.get("icon-opacity").constantOr(1),a=0!==this.paint.get("text-opacity").constantOr(1),u=[];return r&&u.push("symbolIcon"),a&&u.push("symbolSDF"),u}getDefaultProgramParams(r,a){return{config:new te(this,a),overrideFog:!1}}}const w2=new ko({visibility:new Rn(bt.layout_background.visibility)});var p5={paint:new ko({"background-color":new Rn(bt.paint_background["background-color"]),"background-pattern":new Rn(bt.paint_background["background-pattern"]),"background-opacity":new Rn(bt.paint_background["background-opacity"]),"background-emissive-strength":new Rn(bt.paint_background["background-emissive-strength"])}),layout:w2};const gI=new ko({visibility:new Rn(bt.layout_raster.visibility)});var g5={paint:new ko({"raster-opacity":new Rn(bt.paint_raster["raster-opacity"]),"raster-color":new Ah(bt.paint_raster["raster-color"]),"raster-color-mix":new Rn(bt.paint_raster["raster-color-mix"]),"raster-color-range":new Rn(bt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Rn(bt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Rn(bt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Rn(bt.paint_raster["raster-brightness-max"]),"raster-saturation":new Rn(bt.paint_raster["raster-saturation"]),"raster-contrast":new Rn(bt.paint_raster["raster-contrast"]),"raster-resampling":new Rn(bt.paint_raster["raster-resampling"]),"raster-fade-duration":new Rn(bt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Rn(bt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Rn(bt.paint_raster["raster-array-band"]),"raster-elevation":new Rn(bt.paint_raster["raster-elevation"])}),layout:gI},yy=bs([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class q_{constructor(r,a,u,f){this.context=r,this.format=u,this.texture=r.gl.createTexture(),this.update(a,f)}update(r,a,u){const{width:f,height:g}=r,{context:v}=this,{gl:x}=v;if(x.bindTexture(x.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA&&(!a||!1!==a.premultiply)),u||this.size&&this.size[0]===f&&this.size[1]===g){const{x:S,y:T}=u||{x:0,y:0};if(r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||ImageBitmap&&r instanceof ImageBitmap)x.texSubImage2D(x.TEXTURE_2D,0,S,T,x.RGBA,x.UNSIGNED_BYTE,r);else{let D=this.format,O=x.UNSIGNED_BYTE;this.format===x.R32F&&(D=x.RED,O=x.FLOAT),x.texSubImage2D(x.TEXTURE_2D,0,S,T,f,g,D,O,r.data)}}else if(this.size=[f,g],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||ImageBitmap&&r instanceof ImageBitmap){let S=this.format;this.format===x.R8&&(S=x.RED),x.texImage2D(x.TEXTURE_2D,0,this.format,S,x.UNSIGNED_BYTE,r)}else{let S=this.format,T=this.format,D=x.UNSIGNED_BYTE;this.format===x.DEPTH_COMPONENT&&(S=x.DEPTH_COMPONENT16,D=x.UNSIGNED_SHORT),this.format===x.R8&&(T=x.RED),this.format===x.R32F&&(D=x.FLOAT,T=x.RED),x.texImage2D(x.TEXTURE_2D,0,S,f,g,0,T,D,r.data)}this.useMipmap=!(!a||!a.useMipmap),this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(r,a,u=!1){const{context:f}=this,{gl:g}=f;g.bindTexture(g.TEXTURE_2D,this.texture),r!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,r),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap&&!u?r===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),a!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,a),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,a),this.wrapS=a)}bindExtraParam(r,a,u,f){const{context:g}=this,{gl:v}=g;v.bindTexture(v.TEXTURE_2D,this.texture),a!==this.magFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,a),this.magFilter=a),r!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?r===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),u!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),this.wrapS=u),f!==this.wrapT&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,f),this.wrapT=f)}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class h1{constructor(r,a){this.context=r,this.texture=a}bind(r,a){const{context:u}=this,{gl:f}=u;f.bindTexture(f.TEXTURE_2D,this.texture),r!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,r),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,r),this.minFilter=r),a!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,a),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,a),this.wrapS=a)}}function K_(o,r,a,u,f,g,v,x){const S=[o,r,1,a,u,1,f,g,1],T=[v,x,1],D=p.co.adjoint([],S),[O,z,$]=p.N.transformMat3(T,T,D);return p.co.multiply(S,S,[O,0,0,0,z,0,0,0,$])}function m5(o,r,a,u,f,g,v,x){const S=function(T,D,O,z,$,K,X,ie){const ae=K_(0,0,1,0,1,1,0,1),be=K_(T,D,O,z,$,K,X,ie),Ce=p.co.adjoint([],ae);return p.co.multiply(be,be,Ce)}(o,r,a,u,f,g,v,x);return[S[2]/S[8]/Jn,S[5]/S[8]/Jn]}function Cw(o){return[o[0],Math.min(Math.max(o[1],-Fr),Fr)]}class x2 extends ld{constructor(r,a,u,f){super(),this.id=r,this.dispatcher=u,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(f),this.options=a,this._dirty=!1}load(r,a){if(this._loaded=a||!1,this.fire(new Ud("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return r&&(this.coordinates=r),this._loaded=!0,void this._finishLoading();this._imageRequest=Gn(this.map._requestManager.transformRequest(this.url,zl.Image),(u,f)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new e_(u)):f&&(this.image=f instanceof HTMLImageElement?wn.getImageData(f):f,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading())})}loaded(){return this._loaded}updateImage(r){return r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}setTexture(r){if(!(r.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new h1(this.map.painter.context,r.handle),this.width=r.dimensions[0],this.height=r.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ud("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof h1||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(r){if(this.coordinates=r,this._boundsArray=void 0,this._unsupportedCoords=!1,!r.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let a=r[0][1],u=r[0][1];for(const g of r)g[1]>u&&(u=g[1]),g[1]<a&&(a=g[1]);const f=(u+a)/2;if(f>Fr?this.onNorthPole=!0:f<-Fr&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const g=r.map(Xr.fromLngLat);this.tileID=function(v){let x=1/0,S=1/0,T=-1/0,D=-1/0;for(const X of v)x=Math.min(x,X.x),S=Math.min(S,X.y),T=Math.max(T,X.x),D=Math.max(D,X.y);const O=Math.max(T-x,D-S),z=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),$=Math.pow(2,z);let K=Math.floor((x+T)/2*$);return K>1&&(K-=1),new An(z,K,Math.floor((S+D)/2*$))}(g),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ud("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(r){for(const ae in this.tiles){const be=this.tiles[ae];"loaded"!==be.state&&(be.state="loaded",be.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const a=o1(new An(0,0,0),this.map.transform.projection),u=[a.projection.project(this.coordinates[0][0],this.coordinates[0][1]),a.projection.project(this.coordinates[1][0],this.coordinates[1][1]),a.projection.project(this.coordinates[2][0],this.coordinates[2][1]),a.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ae){const be=ae[1].x-ae[0].x,Ce=ae[1].y-ae[0].y,Ee=ae[2].x-ae[1].x,Le=ae[2].y-ae[1].y,Oe=ae[3].x-ae[2].x,qe=ae[3].y-ae[2].y,rt=ae[0].x-ae[3].x,ht=ae[0].y-ae[3].y,It=be*Le-Ee*Ce,At=Ee*qe-Oe*Le,Kt=Oe*ht-rt*qe,fn=rt*Ce-be*ht;return It>0&&At>0&&Kt>0&&fn>0||It<0&&At<0&&Kt<0&&fn<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const f=o1(this.tileID,this.map.transform.projection),[g,v,x,S]=this.coordinates.map(ae=>{const be=f.projection.project(ae[0],ae[1]);return Zh(f,be)._round()});this.perspectiveTransform=m5(g.x,g.y,v.x,v.y,x.x,x.y,S.x,S.y);const T=this._boundsArray=new Hc;T.emplaceBack(g.x,g.y,0,0),T.emplaceBack(v.x,v.y,Jn,0),T.emplaceBack(S.x,S.y,0,Jn),T.emplaceBack(x.x,x.y,Jn,Jn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=r.createVertexBuffer(T,yy.members),this.boundsSegments=zo.simpleSegment(0,0,4,2);const D=[],O=[Cw((z=this.coordinates)[0]),Cw(z[1]),Cw(z[2]),Cw(z[3])];var z;const[$,K,X,ie]=function(ae){let be=ae[0][0],Ce=be,Ee=ae[0][1],Le=Ee;for(let Oe=1;Oe<ae.length;Oe++)ae[Oe][0]<be?be=ae[Oe][0]:ae[Oe][0]>Ce&&(Ce=ae[Oe][0]),ae[Oe][1]<Ee?Ee=ae[Oe][1]:ae[Oe][1]>Le&&(Le=ae[Oe][1]);return[be,Ee,Ce-be,Le-Ee]}(O);{const ae=new Hc,[be,Ce,Ee,Le]=function(an){let Mn=an[0].x,on=Mn,ri=an[0].y,Kn=ri;for(let bn=1;bn<an.length;bn++)an[bn].x<Mn?Mn=an[bn].x:an[bn].x>on&&(on=an[bn].x),an[bn].y<ri?ri=an[bn].y:an[bn].y>Kn&&(Kn=an[bn].y);return[Mn,ri,on-Mn,Kn-ri]}(u),Oe=an=>[(an.x-be)/Ee,(an.y-Ce)/Le],[qe,rt,ht,It]=u.map(Oe),At=function(an,Mn,on,ri,Kn,bn,Hi,Ei){const hi=K_(0,0,1,0,1,1,0,1),xn=K_(an,Mn,on,ri,Kn,bn,Hi,Ei),ki=p.co.adjoint([],xn);return p.co.multiply(hi,hi,ki)}(qe[0],qe[1],rt[0],rt[1],ht[0],ht[1],It[0],It[1]);this.elevatedGlobePerspectiveTransform=m5(qe[0],qe[1],rt[0],rt[1],ht[0],ht[1],It[0],It[1]);const Kt=(an,Mn)=>{D.push(an.lng);const on=Math.round((an.lng-$)/X*Jn),ri=Math.round((an.lat-K)/ie*Jn),Kn=Oe(Mn),bn=p.N.transformMat3([],[Kn[0],Kn[1],1],At),Hi=Math.round(bn[0]/bn[2]*Jn),Ei=Math.round(bn[1]/bn[2]*Jn);ae.emplaceBack(on,ri,Hi,Ei)},fn=u[3].x-u[0].x,Ut=u[3].y-u[0].y,Dt=u[2].x-u[1].x,Bt=u[2].y-u[1].y;for(let an=0;an<65;an++){const Mn=an/64,on=[u[0].x+Mn*fn,u[0].y+Mn*Ut],ri=[u[1].x+Mn*Dt,u[1].y+Mn*Bt],Kn=ri[0]-on[0],bn=ri[1]-on[1];for(let Hi=0;Hi<65;Hi++){const Ei=Hi/64,hi={x:on[0]+Kn*Ei,y:on[1]+bn*Ei,z:0};Kt(a.projection.unproject(hi.x,hi.y),hi)}}this.elevatedGlobeVertexBuffer=r.createVertexBuffer(ae,yy.members)}{this.maxLongitudeTriangleSize=0;let ae=[],be=new el;const Ce=(Ee,Le,Oe)=>{be.emplaceBack(Ee,Le,Oe);const qe=D[Ee],rt=D[Le],ht=D[Oe],It=Math.min(Math.min(qe,rt),ht),At=Math.max(Math.max(qe,rt),ht)-It;At>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=At),ae.push(It+At/2)};for(let Ee=0;Ee<64;Ee++)for(let Le=0;Le<64;Le++){const Oe=65*Ee+Le,qe=Oe+1,rt=Oe+65,ht=rt+1;Ce(Oe,rt,qe),Ce(qe,rt,ht)}[ae,be]=function(Ee,Le){const Oe=Array.from({length:Ee.length},(ht,It)=>It);Oe.sort((ht,It)=>Ee[ht]-Ee[It]);const qe=[],rt=new el;for(let ht=0;ht<Oe.length;ht++){const It=Oe[ht];qe.push(Ee[It]);const At=3*It,Kt=At+1;rt.emplaceBack(Le.uint16[At],Le.uint16[Kt],Le.uint16[Kt+1])}return[qe,rt]}(ae,be),this.elevatedGlobeTrianglesCenterLongitudes=ae,this.elevatedGlobeIndexBuffer=r.createIndexBuffer(be)}this.elevatedGlobeSegments=zo.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,X/Jn,0,ie/Jn,0,0,K,$,0])}prepare(){const r=0!==Object.keys(this.tiles).length;if(this.tileID&&!r)return;const a=this.map.painter.context,u=a.gl;!this._dirty||this.texture instanceof h1||(this.texture?this.texture.update(this.image):(this.texture=new q_(a,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),r&&this._prepareData(a)}loadTile(r,a){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},a(null)):(r.state="errored",a(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(r){const a=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!a)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let f=(D=r+180)+360*Math.round((u[0]-D)/360);var D;const g=new zo,v=(D,O)=>{g.segments.push({vertexOffset:0,primitiveOffset:D,vertexLength:a.segments[0].vertexLength,primitiveLength:O,sortKey:void 0,vaos:{}})},x=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-f)<=x){const D=Gt(u,0,u.length,f+x);return D===u.length||v(D,tt(u,D+1,u.length,f+360-x)-D),g}f<u[0]&&(f+=360);const S=tt(u,0,u.length,f-x);if(S===u.length)return v(0,u.length),g;v(0,S-0);const T=Gt(u,S+1,u.length,f+x);return T!==u.length&&v(T,u.length-T),g}}const mI=(Math.pow(256,2)-1)/16907520;class _I extends Vc{constructor(r,a,u){super(r,g5,a,u),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isLayerDraped(r){return!(r&&r._source instanceof x2&&(r._source.onNorthPole||r._source.onSouthPole))&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(r){"raster-color"!==r&&"raster-color-range"!==r||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(r){if(!this.hasColorMap()||!this._curRampRange)return;const a=this._transitionablePaint._values["raster-color"].value.expression,[u,f]=r||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(f)||u===this._curRampRange[0]&&f===this._curRampRange[1]||(this.colorRamp=Ub({expression:a,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:f}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,f])}}const _5=new ko({visibility:new Rn(bt["layout_raster-particle"].visibility)});var yI={paint:new ko({"raster-particle-array-band":new Rn(bt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Rn(bt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Ah(bt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Rn(bt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Rn(bt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Rn(bt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Rn(bt["paint_raster-particle"]["raster-particle-reset-rate-factor"])}),layout:_5};class C2 extends Vc{constructor(r,a,u){super(r,yI,a,u),this._updateColorRamp(),this.onRemove=f=>{this.colorRampTexture&&this.colorRampTexture.destroy(),this.transformFeedbackObject&&f.painter.context.gl.deleteTransformFeedback(this.transformFeedbackObject),this.tileFramebuffer&&this.tileFramebuffer.destroy()},this.lastInvalidatedAt=wn.now()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return"none"!==this.visibility}isLayerDraped(r){return!1}_handleSpecialPaintPropertyUpdate(r){"raster-particle-color"!==r&&"raster-particle-max-speed"!==r||(this._updateColorRamp(),this._invalidateAnimationState()),"raster-particle-count"===r&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const r=this._transitionablePaint._values["raster-particle-color"].value.expression,a=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Ub({expression:r,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:a}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=wn.now()}}class d1 extends Vc{constructor(r,a){super(r,{},a),this.implementation=r,r.slot&&(this.slot=r.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(r){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}const y5=new ko({visibility:new Rn(bt.layout_sky.visibility)});var vI={paint:new ko({"sky-type":new Rn(bt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Rn(bt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Rn(bt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Rn(bt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Rn(bt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ah(bt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Rn(bt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Rn(bt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Rn(bt.paint_sky["sky-opacity"])}),layout:y5};function Ew(o,r,a){const u=[0,0,1],f=p.bi.identity([]);return p.bi.rotateY(f,f,a?-Sr(o)+Math.PI:Sr(o)),p.bi.rotateX(f,f,-Sr(r)),p.N.transformQuat(u,u,f),p.N.normalize(u,u)}var v5={paint:new ko({})};function bI(o,r){const a=Sw(o.projection,o.zoom,o.width,o.height),u=function(g,v,x,S,T){const D=new ct(x.lng-180*Em,x.lat),O=new ct(x.lng+180*Em,x.lat),z=g.project(D.lng,D.lat),$=g.project(O.lng,O.lat),K=-Math.atan2($.y-z.y,$.x-z.x),X=Xr.fromLngLat(x);X.y=ir(X.y,-1+Em,1-Em);const ie=X.toLngLat(),ae=g.project(ie.lng,ie.lat),be=Xr.fromLngLat(ie);be.x+=Em;const Ce=be.toLngLat(),Ee=g.project(Ce.lng,Ce.lat),Le=xI(Ee.x-ae.x,Ee.y-ae.y,K),Oe=Xr.fromLngLat(ie);Oe.y+=Em;const qe=Oe.toLngLat(),rt=g.project(qe.lng,qe.lat),ht=xI(rt.x-ae.x,rt.y-ae.y,K),It=Math.abs(Le.x)/Math.abs(ht.y),At=p.a6.identity([]);p.a6.rotateZ(At,At,-K*(1-(T?0:S)));const Kt=p.a6.identity([]);return p.a6.scale(Kt,Kt,[1,1-(1-It)*S,1]),Kt[4]=-ht.x/ht.y*S,p.a6.rotateZ(Kt,Kt,K),p.a6.multiply(Kt,At,Kt),Kt}(o.projection,0,o.center,a,r),f=vy(o);return p.a6.scale(u,u,[f,f,1]),u}function vy(o){const r=o.projection,a=Sw(o.projection,o.zoom,o.width,o.height),u=wI(r,o.center),f=wI(r,ct.convert(r.center));return Math.pow(2,u*a+(1-a)*f)}function Sw(o,r,a,u,f=1/0){const g=o.range;if(!g)return 0;const v=Math.min(f,Math.max(a,u)),x=Math.log(v/1024)/Math.LN2;return Od(g[0]+x,g[1]+x,r)}const Em=1/4e4;function wI(o,r){const a=ir(r.lat,-Fr,Fr),u=new ct(r.lng-180*Em,a),f=new ct(r.lng+180*Em,a),g=o.project(u.lng,a),v=o.project(f.lng,a),x=Xr.fromLngLat(u),S=Xr.fromLngLat(f),T=v.x-g.x,D=v.y-g.y,O=S.x-x.x,z=S.y-x.y,$=Math.sqrt((O*O+z*z)/(T*T+D*D));return Math.log($)/Math.LN2}function xI(o,r,a){const u=Math.cos(a),f=Math.sin(a);return{x:o*u-r*f,y:o*f+r*u}}function CI(o,r,a){p.a6.identity(o),p.a6.rotateZ(o,o,Sr(r[2])),p.a6.rotateX(o,o,Sr(r[0])),p.a6.rotateY(o,o,Sr(r[1])),p.a6.scale(o,o,a),p.a6.multiply(o,o,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Tw(o,r,a,u,f,g,v,x){const S=[a[0]-r[0],a[1]-r[1],0],T=[u[0]-r[0],u[1]-r[1],0];if(p.N.length(S)<1e-12||p.N.length(T)<1e-12)return p.bi.identity(o);const D=p.N.cross([],S,T);p.N.normalize(D,D),p.N.subtract(T,u,r),S[2]=(g-f)*x,T[2]=(v-f)*x;const O=S;return p.N.cross(O,S,T),p.N.normalize(O,O),p.bi.rotationTo(o,D,O)}function E2(o,r,a=!1){const u=gm(r.zoom),f=function(g,v,x){const S=v.worldSize,T=[g[12],g[13],g[14]],D=kr(T[1]/S),O=rr(T[0]/S),z=p.a6.identity([]),$=lr(1,D)*S,K=lr(1,0)*S*Dr(D,v.zoom),X=1/Nv(S);let ie=K*X;if(x){const Ee=Sw(v.projection,v.zoom,v.width,v.height,1024);ie=X*v.projection.pixelSpaceConversion(v.center.lat,S,Ee)}const ae=Pt(D,O);p.N.add(ae,ae,p.N.scale([],p.N.normalize([],ae),$*ie*T[2]));const be=function(Ee){const Le=[Ee[0],Ee[1],Ee[2]];let Oe=[0,1,0];const qe=p.N.cross([],Oe,Le);return p.N.cross(Oe,Le,qe),0===p.N.squaredLength(Oe)&&(Oe=[0,1,0],p.N.cross(qe,Le,Oe)),p.N.normalize(qe,qe),p.N.normalize(Oe,Oe),p.N.normalize(Le,Le),[qe[0],qe[1],qe[2],0,Oe[0],Oe[1],Oe[2],0,Le[0],Le[1],Le[2],0,Ee[0],Ee[1],Ee[2],1]}(ae);p.a6.scale(z,z,[ie,ie,ie*$]),p.a6.translate(z,z,[-T[0],-T[1],-T[2]]);const Ce=p.a6.multiply([],v.globeMatrix,be);return p.a6.multiply(Ce,Ce,z),p.a6.multiply(Ce,Ce,g),Ce}(o,r,a);return u>0?function(v,x,S){const T=(K,X,ie)=>{const ae=p.N.length(K),be=p.N.length(X),Ce=nA(K,X,ie);return p.N.scale(Ce,Ce,1/p.N.length(Ce)*Fi(ae,be,ie))},D=T([v[0],v[1],v[2]],[x[0],x[1],x[2]],S),O=T([v[4],v[5],v[6]],[x[4],x[5],x[6]],S),z=T([v[8],v[9],v[10]],[x[8],x[9],x[10]],S),$=nA([v[12],v[13],v[14]],[x[12],x[13],x[14]],S);return[D[0],D[1],D[2],0,O[0],O[1],O[2],0,z[0],z[1],z[2],0,$[0],$[1],$[2],1]}(f,function(v,x){const S=x.worldSize,T=lr(1,0)*S*Dr(x.center.lat,x.zoom)/Nv(S),D=lr(1,x.center.lat)*S,O=p.a6.identity([]);return p.a6.rotateY(O,O,Sr(x.center.lng)),p.a6.rotateX(O,O,Sr(x.center.lat)),p.a6.translate(O,O,[0,0,xe]),p.a6.scale(O,O,[T,T,T*D]),p.a6.translate(O,O,[x.point.x-.5*S,x.point.y-.5*S,0]),p.a6.multiply(O,O,v),p.a6.multiply(O,x.globeMatrix,O)}(o,r),u):f}function EI(o,r,a,u){const f=ta.projectAabbCorners(u,a);let g=Number.MAX_VALUE,v=-1;for(let T=0;T<f.length;++T){const D=f[T];D[0]=(.5*D[0]+.5)*r.width,D[1]=(.5-.5*D[1])*r.height,D[2]<g&&(v=T,g=D[2])}const x=T=>new Nn(f[T][0],f[T][1]);let S;switch(v){case 0:case 6:S=[x(1),x(5),x(4),x(7),x(3),x(2),x(1)];break;case 1:case 7:S=[x(0),x(4),x(5),x(6),x(2),x(3),x(0)];break;case 3:case 5:S=[x(1),x(0),x(4),x(7),x(6),x(2),x(1)];break;default:S=[x(1),x(5),x(6),x(7),x(3),x(0),x(1)]}if(Si(o,S))return g}const SI=bs([{name:"a_pos_3f",components:3,type:"Float32"}]),Ho=bs([{name:"a_color_3f",components:3,type:"Float32"}]),b5=bs([{name:"a_color_4f",components:4,type:"Float32"}]),Iw=bs([{name:"a_uv_2f",components:2,type:"Float32"}]),w5=bs([{name:"a_normal_3f",components:3,type:"Float32"}]),x5=bs([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),C5=bs([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class TI{constructor(r,a){this.feature=r,this.instancedDataOffset=a,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class II{constructor(){this.instancedDataArray=new Zf,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class S2{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.fqid),this.projection=r.projection,this.index=r.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(r,a,u,f){this.tileToMeter=br(u);const g=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:x,index:S,sourceLayerIndex:T}of r){const D=fa(v,g);if(!this.layers[0]._featureFilter.filter(new uo(this.zoom),D,u))continue;const O={id:x,sourceLayerIndex:T,index:S,geometry:g?D.geometry:oo(v,u,f),properties:v.properties,type:v.type,patterns:{}},z=this.addFeature(O,O.geometry,D);z&&a.featureIndex.insert(v,O.geometry,S,T,this.index,this.instancesPerModel[z].instancedDataArray.length,Jn/32)}this.lookup=null}update(r,a,u,f){for(const g in this.instancesPerModel){const v=this.instancesPerModel[g];for(const x in r)v.idToFeaturesIndex.hasOwnProperty(x)&&this.evaluate(v.features[v.idToFeaturesIndex[x]],r[x],v,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let r=!1;for(const a in this.instancesPerModel){const u=this.instancesPerModel[a];for(const f of u.features){const g=this.layers[0],v=f.feature,x=this.canonical,S=g.paint.get("model-rotation").evaluate(v,{},x),T=g.paint.get("model-scale").evaluate(v,{},x),D=g.paint.get("model-translation").evaluate(v,{},x);p.N.exactEquals(f.rotation,S)&&p.N.exactEquals(f.scale,T)&&p.N.exactEquals(f.translation,D)||(this.evaluate(f,f.featureStates,u,!0),r=!0)}}return r}isEmpty(){for(const r in this.instancesPerModel)if(0!==this.instancesPerModel[r].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(r){if(!this.uploaded)for(const a in this.instancesPerModel){const u=this.instancesPerModel[a];u.instancedDataArray.length<0||0===u.instancedDataArray.length||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=r.createVertexBuffer(u.instancedDataArray,x5.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const r in this.instancesPerModel){const a=this.instancesPerModel[r];0!==a.instancedDataArray.length&&a.instancedDataBuffer&&a.instancedDataBuffer.destroy()}}addFeature(r,a,u){const f=this.layers[0],g=f.layout.get("model-id").evaluate(u,{},this.canonical);if(!g)return $o(`modelId is not evaluated for layer ${f.id} and it is not going to get rendered.`),g;this.instancesPerModel[g]||(this.instancesPerModel[g]=new II);const v=this.instancesPerModel[g],x=v.instancedDataArray,S=new TI(u,x.length);for(const T of a)for(const D of T){if(D.x<0||D.x>=Jn||D.y<0||D.y>=Jn)continue;const O=(this.lookupDim-1)/Jn,z=this.lookupDim*(D.y*O|0)+D.x*O|0;if(this.lookup){if(0!==this.lookup[z])continue;this.lookup[z]=1}this.instanceCount++;const $=x.length;x.resize($+1),v.instancesEvaluatedElevation.push(0),x.float32[16*$]=D.x,x.float32[16*$+1]=D.y}return S.instancedDataCount=v.instancedDataArray.length-S.instancedDataOffset,S.instancedDataCount>0&&(r.id&&(v.idToFeaturesIndex[r.id]=v.features.length),v.features.push(S),this.evaluate(S,{},v,!1)),g}evaluate(r,a,u,f){const g=this.layers[0],v=r.feature,x=this.canonical,S=r.rotation=g.paint.get("model-rotation").evaluate(v,a,x),T=r.scale=g.paint.get("model-scale").evaluate(v,a,x),D=r.translation=g.paint.get("model-translation").evaluate(v,a,x),O=g.paint.get("model-color").evaluate(v,a,x);O.a=g.paint.get("model-color-mix-intensity").evaluate(v,a,x);const z=[];this.maxVerticalOffset<D[2]&&(this.maxVerticalOffset=D[2]),this.maxScale=Math.max(Math.max(this.maxScale,T[0]),Math.max(T[1],T[2])),CI(z,S,T);const $=Math.round(100*O.a)+O.b/1.05;for(let K=0;K<r.instancedDataCount;++K){const X=r.instancedDataOffset+K,ie=16*X,ae=u.instancedDataArray.float32;let be=0;f&&(be=ae[ie+6]-u.instancesEvaluatedElevation[X]);const Ce=0|ae[ie+1];ae[ie]=(0|ae[ie])+O.r/1.05,ae[ie+1]=Ce+O.g/1.05,ae[ie+2]=$,ae[ie+3]=1/(x.z>10?this.tileToMeter:br(x,Ce)),ae[ie+4]=D[0],ae[ie+5]=D[1],ae[ie+6]=D[2]+be,ae[ie+7]=z[0],ae[ie+8]=z[1],ae[ie+9]=z[2],ae[ie+10]=z[4],ae[ie+11]=z[5],ae[ie+12]=z[6],ae[ie+13]=z[8],ae[ie+14]=z[9],ae[ie+15]=z[10],u.instancesEvaluatedElevation[X]=D[2]}}}ai(S2,"ModelBucket",{omit:["layers"]}),ai(II,"PerModelAttributes"),ai(TI,"ModelFeature");const f1=new ko({visibility:new Rn(bt.layout_model.visibility),"model-id":new wi(bt.layout_model["model-id"])});var DI={paint:new ko({"model-opacity":new Rn(bt.paint_model["model-opacity"]),"model-rotation":new wi(bt.paint_model["model-rotation"]),"model-scale":new wi(bt.paint_model["model-scale"]),"model-translation":new wi(bt.paint_model["model-translation"]),"model-color":new wi(bt.paint_model["model-color"]),"model-color-mix-intensity":new wi(bt.paint_model["model-color-mix-intensity"]),"model-type":new Rn(bt.paint_model["model-type"]),"model-cast-shadows":new Rn(bt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Rn(bt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Rn(bt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new wi(bt.paint_model["model-emissive-strength"]),"model-roughness":new wi(bt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new wi(bt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Rn(bt.paint_model["model-cutoff-fade-range"])}),layout:f1};const by={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function E5(o,r,a,u,f,g,v,x,S,T=!1){const D=a.zoom,O=a.project(u),z=Dr(u.lat,D),$=1/z;p.a6.identity(o),p.a6.translate(o,o,[O.x+v[0]*$,O.y+v[1]*$,v[2]]);let K=1,X=1;const ie=a.worldSize;if(T){if("mercator"===a.projection.name){let Ee=0;a.elevation&&(Ee=a.elevation.getAtPointOrZero(new Xr(O.x/ie,O.y/ie),0));const Le=p.a7.transformMat4([],[O.x,O.y,Ee,1],a.projMatrix)[3]/a.cameraToCenterDistance;K=Le,X=Le*Dr(a.center.lat,D)}else if("globe"===a.projection.name){const Ee=E2(o,a),Le=p.a6.multiply([],a.projMatrix,Ee),Oe=[0,0,0,1];p.a7.transformMat4(Oe,Oe,Le);const qe=Oe[3]/a.cameraToCenterDistance,rt=gm(D),ht=a.projection.pixelsPerMeter(u.lat,ie)*Dr(u.lat,D),It=a.projection.pixelsPerMeter(a.center.lat,ie)*Dr(a.center.lat,D);K=qe/Fi(ht,Po(a.center.lat),rt),X=qe*z/ht,K*=It,X*=It}}else K=$;p.a6.scale(o,o,[K,K,X]);const ae=[...o],be=r.orientation,Ce=[];if(CI(Ce,[be[0]+f[0],be[1]+f[1],be[2]+f[2]],g),p.a6.multiply(o,ae,Ce),x&&a.elevation){let Ee=0;const Le=[];if(S&&a.elevation){Ee=function(rt,ht,It,At,Kt){const fn=ht.elevation;if(!fn)return 0;const Ut=ta.projectAabbCorners(It,At),Dt=lr(1,Kt.lat)*ht.worldSize,Bt=function(ki,_r){const zi=[0,0,1],Cr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const ur of Cr){const Yr=ki[ur.corners[0]],Ar=ki[ur.corners[1]],lo=ki[ur.corners[2]],hs=[Ar[0]-Yr[0],Ar[1]-Yr[1],_r*(Ar[2]-Yr[2])],ns=p.N.cross(hs,hs,[lo[0]-Yr[0],lo[1]-Yr[1],_r*(lo[2]-Yr[2])]);p.N.normalize(ns,ns),ur.dotProductWithUp=p.N.dot(ns,zi)}return Cr.sort((ur,Yr)=>ur.dotProductWithUp-Yr.dotProductWithUp),Cr[0].corners}(Ut,Dt),an=Ut[Bt[0]],Mn=Ut[Bt[1]],on=Ut[Bt[2]],ri=Ut[Bt[3]],Kn=fn.getAtPointOrZero(new Xr(an[0]/ht.worldSize,an[1]/ht.worldSize),0),bn=fn.getAtPointOrZero(new Xr(Mn[0]/ht.worldSize,Mn[1]/ht.worldSize),0),Hi=fn.getAtPointOrZero(new Xr(on[0]/ht.worldSize,on[1]/ht.worldSize),0),Ei=fn.getAtPointOrZero(new Xr(ri[0]/ht.worldSize,ri[1]/ht.worldSize),0),hi=(Kn+Ei)/2,xn=(bn+Hi)/2;return hi>xn?bn<Hi?Tw(rt,Mn,ri,an,bn,Ei,Kn,Dt):Tw(rt,on,an,ri,Hi,Kn,Ei,Dt):Kn<Ei?Tw(rt,an,Mn,on,Kn,bn,Hi,Dt):Tw(rt,ri,on,Mn,Ei,Hi,bn,Dt),Math.max(hi,xn)}(Le,a,r.aabb,o,u);const Oe=p.a6.fromQuat([],Le),qe=p.a6.multiply([],Oe,Ce);p.a6.multiply(o,ae,qe)}else Ee=a.elevation.getAtPointOrZero(new Xr(O.x/ie,O.y/ie),0);0!==Ee&&(o[14]+=Ee)}}function wy(o,r,a=!1){o.uploaded||(o.gfxTexture=new q_(r,o.image,a?r.gl.R8:r.gl.RGBA,{useMipmap:o.sampler.minFilter>=r.gl.NEAREST_MIPMAP_NEAREST}),o.uploaded=!0,o.image=null)}function BI(o,r,a){o.indexBuffer=r.createIndexBuffer(o.indexArray,!1,!0),o.vertexBuffer=r.createVertexBuffer(o.vertexArray,SI.members,!1,!0),o.normalArray&&(o.normalBuffer=r.createVertexBuffer(o.normalArray,w5.members,!1,!0)),o.texcoordArray&&(o.texcoordBuffer=r.createVertexBuffer(o.texcoordArray,Iw.members,!1,!0)),o.colorArray&&(o.colorBuffer=r.createVertexBuffer(o.colorArray,(12===o.colorArray.bytesPerElement?Ho:b5).members,!1,!0)),o.featureArray&&(o.pbrBuffer=r.createVertexBuffer(o.featureArray,C5.members,!0)),o.segments=zo.simpleSegment(0,0,o.vertexArray.length,o.indexArray.length);const u=o.material;u.pbrMetallicRoughness.baseColorTexture&&wy(u.pbrMetallicRoughness.baseColorTexture,r),u.pbrMetallicRoughness.metallicRoughnessTexture&&wy(u.pbrMetallicRoughness.metallicRoughnessTexture,r),u.normalTexture&&wy(u.normalTexture,r),u.occlusionTexture&&wy(u.occlusionTexture,r,a),u.emissionTexture&&wy(u.emissionTexture,r)}function MI(o,r,a){if(o.meshes)for(const u of o.meshes)BI(u,r,a);if(o.children)for(const u of o.children)MI(u,r,a)}function W_(o){if(o.meshes)for(const r of o.meshes)r.indexArray.destroy(),r.vertexArray.destroy(),r.colorArray&&r.colorArray.destroy(),r.normalArray&&r.normalArray.destroy(),r.texcoordArray&&r.texcoordArray.destroy(),r.featureArray&&r.featureArray.destroy();if(o.children)for(const r of o.children)W_(r)}function T2(o){if(o.meshes)for(const a of o.meshes)a.vertexBuffer&&(a.vertexBuffer.destroy(),a.indexBuffer.destroy(),a.normalBuffer&&a.normalBuffer.destroy(),a.texcoordBuffer&&a.texcoordBuffer.destroy(),a.colorBuffer&&a.colorBuffer.destroy(),a.pbrBuffer&&a.pbrBuffer.destroy(),a.segments.destroy(),a.material&&((r=a.material).pbrMetallicRoughness.baseColorTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),r.pbrMetallicRoughness.metallicRoughnessTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),r.normalTexture&&r.normalTexture.gfxTexture&&r.normalTexture.gfxTexture.destroy(),r.emissionTexture&&r.emissionTexture.gfxTexture&&r.emissionTexture.gfxTexture.destroy(),r.occlusionTexture&&r.occlusionTexture.gfxTexture&&r.occlusionTexture.gfxTexture.destroy()));var r;if(o.children)for(const a of o.children)T2(a)}class S5{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class I2{constructor(){this.tasks={},this.taskQueue=[],ru(["process"],this),this.invoker=new S5(this.process),this.nextId=0}add(r,a){const u=this.nextId++,f=function({type:g,isSymbolTile:v,zoom:x}){return x=x||0,"message"===g?0:"maybePrepare"!==g||v?"parseTile"!==g||v?"parseTile"===g&&v?300-x:"maybePrepare"===g&&v?400-x:500:200-x:100-x}(a);if(0===f){Pc();try{r()}finally{}return null}return this.tasks[u]={fn:r,metadata:a,priority:f,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){Pc();try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const r=this.pick();if(null===r)return;const a=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let r=null,a=1/0;for(let f=0;f<this.taskQueue.length;f++){const g=this.tasks[this.taskQueue[f]];g.priority<a&&(a=g.priority,r=f)}if(null===r)return null;const u=this.taskQueue[r];return this.taskQueue.splice(r,1),u}remove(){this.invoker.remove()}}class FI{constructor(r,a,u){this.target=r,this.parent=a,this.mapId=u,this.callbacks={},this.cancelCallbacks={},ru(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new I2}send(r,a,u,f,g=!1,v){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=v,this.callbacks[x]=u);const S=new Set;return this.target.postMessage({id:x,type:r,hasCallback:!!u,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:qf(a,S)},S),{cancel:()=>{u&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(r){const a=r.data,u=a.id;if(u&&(!a.targetMapId||this.mapId===a.targetMapId))if("<cancel>"===a.type){const f=this.cancelCallbacks[u];delete this.cancelCallbacks[u],f&&f.cancel()}else if(a.mustQueue||Pc()){const f=this.callbacks[u],g=this.scheduler.add(()=>this.processTask(u,a),f&&f.metadata||{type:"message"});g&&(this.cancelCallbacks[u]=g)}else this.processTask(u,a)}processTask(r,a){if(delete this.cancelCallbacks[r],"<response>"===a.type){const u=this.callbacks[r];delete this.callbacks[r],u&&(a.error?u(NA(a.error)):u(null,NA(a.data)))}else{const u=new Set,f=a.hasCallback?(v,x)=>{this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:v?qf(v):null,data:qf(x,u)},u)}:v=>{},g=NA(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,g,f);else if(this.parent.getWorkerSource){const v=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,v[0],g.source,g.scope)[v[1]](g,f)}else f(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}let hf=(()=>{class o{constructor(a,u){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=kd();const f=this.workerPool.acquire(this.id);for(let g=0;g<f.length;g++){const v=new o.Actor(f[g],u,this.id);v.name=`Worker ${g}`,this.actors.push(v)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(a,u,f){Hr(this.actors,(g,v)=>{g.send(a,u,v)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(a=>{a.remove()}),this.actors=[],this.workerPool.release(this.id)}}return o.Actor=FI,o})();var Jp={workerUrl:"",workerClass:null,workerParams:void 0};function zu(){return null!=Jp.workerClass?new Jp.workerClass:new self.Worker(Jp.workerUrl,Jp.workerParams)}const eg="mapboxgl_preloaded_worker_pool";class Tm{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Tm.workerCount;)this.workers.push(new zu);return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.workers&&0===this.numActive()&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[eg]}numActive(){return Object.keys(this.active).length}}let Vu;function To(){return Vu||(Vu=new Tm),Vu}Tm.workerCount=2;let tg,Im,Hu,oA,Dm,aA=null;function Z_(){return Pc()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:Im||ar.DRACO_URL}function X_(){if(Pc()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(oA)return oA;const o=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if("object"!=typeof WebAssembly)throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return oA=WebAssembly.validate(o)?ar.MESHOPT_SIMD_URL:ar.MESHOPT_URL,oA}const ng={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},RI={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},xy={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function D2(o,r,a){const u=a.json.bufferViews.length,f=a.buffers.length;r.bufferView=u,a.json.bufferViews[u]={buffer:f,byteLength:o.byteLength},a.buffers[f]=o}const Dw="KHR_draco_mesh_compression";function OI(o,r){const a=o.extensions&&o.extensions[Dw];if(!a)return;const u=new Hu.Decoder,f=I5(r,a.bufferView),g=new Hu.Mesh;if(!u.DecodeArrayToMesh(f,f.byteLength,g))throw new Error("Failed to decode Draco mesh");const v=r.json.accessors[o.indices],x=ng[v.componentType],S=v.count*x.BYTES_PER_ELEMENT,T=Hu._malloc(S);x===Uint16Array?u.GetTrianglesUInt16Array(g,S,T):u.GetTrianglesUInt32Array(g,S,T),D2(Hu.memory.buffer.slice(T,T+S),v,r),Hu._free(T);for(const D of Object.keys(a.attributes)){const O=u.GetAttributeByUniqueId(g,a.attributes[D]),z=r.json.accessors[o.attributes[D]],$=RI[z.componentType],K=z.count*xy[z.type]*ng[z.componentType].BYTES_PER_ELEMENT,X=Hu._malloc(K);u.GetAttributeDataArrayForAllPoints(g,O,Hu[$],K,X),D2(Hu.memory.buffer.slice(X,X+K),z,r),Hu._free(X)}u.destroy(),g.destroy(),delete o.extensions[Dw]}const A1="EXT_meshopt_compression";function kI(o,r){if(!o.extensions||!o.extensions[A1])return;const a=o.extensions[A1],u=new Uint8Array(r.buffers[a.buffer],a.byteOffset||0,a.byteLength||0),f=new Uint8Array(a.count*a.byteStride);Dm.decodeGltfBuffer(f,a.count,a.byteStride,u,a.mode,a.filter),o.buffer=r.buffers.length,o.byteOffset=0,r.buffers[o.buffer]=f.buffer,delete o.extensions[A1]}const B2=1179937895,M2=new TextDecoder("utf8");function Bw(o,r){return new URL(o,r).href}function T5(o,r,a,u){return fetch(Bw(o.uri,u)).then(f=>f.arrayBuffer()).then(f=>{r.buffers[a]=f})}function I5(o,r){const a=o.json.bufferViews[r];return new Uint8Array(o.buffers[a.buffer],a.byteOffset||0,a.byteLength)}function uL(o,r,a,u){if(o.uri){const f=Bw(o.uri,u);return fetch(f).then(g=>g.blob()).then(g=>createImageBitmap(g)).then(g=>{r.images[a]=g})}if(void 0!==o.bufferView){const f=I5(r,o.bufferView),g=new Blob([f],{type:o.mimeType});return createImageBitmap(g).then(v=>{r.images[a]=v})}}function PI(o,r=0,a){const u={json:null,images:[],buffers:[]};if(new Uint32Array(o,r,1)[0]===B2){const D=new Uint32Array(o,r);let O=2;const z=(D[O++]>>2)-3,$=D[O++]>>2;if(O++,u.json=JSON.parse(M2.decode(D.subarray(O,O+$))),O+=$,O<z){const K=D[O++];O++;const X=r+(O<<2);u.buffers[0]=o.slice(X,X+K)}}else u.json=JSON.parse(M2.decode(new Uint8Array(o,r)));const{buffers:f,images:g,meshes:v,extensionsUsed:x,bufferViews:S}=u.json;let T=Promise.resolve();if(f){const D=[];for(let O=0;O<f.length;O++){const z=f[O];z.uri?D.push(T5(z,u,O,a)):u.buffers[O]||(u.buffers[O]=null)}T=Promise.all(D)}return T.then(()=>{const D=[],O=x&&x.includes(Dw),z=x&&x.includes(A1);if(O&&D.push(function(){if(!Hu)return tg||(tg=function($){let K,X=null;function ie(){K=new Uint8Array(X.buffer)}function ae(){throw new Error("Unexpected Draco error.")}const be={a:{a:ae,d:function(Ce,Ee,Le){return K.copyWithin(Ce,Ee,Ee+Le)},c:function(Ce){const Ee=K.length,Le=Math.max(Ce>>>0,Math.ceil(1.2*Ee)),Oe=Math.ceil((Le-Ee)/65536);try{return X.grow(Oe),ie(),!0}catch{return!1}},b:ae}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming($,be):$.then(Ce=>Ce.arrayBuffer()).then(Ce=>WebAssembly.instantiate(Ce,be))).then(Ce=>{const{Rb:Ee,Qb:Le,P:Oe,T:qe,X:rt,Ja:ht,La:It,Qa:At,Va:Kt,Wa:fn,eb:Ut,jb:Dt,f:Bt,e:an,yb:Mn,zb:on,Ab:ri,Bb:Kn,Db:bn,Gb:Hi}=Ce.instance.exports;X=an;const Ei=(()=>{let hi=0,xn=0,ki=0,_r=0;return zi=>{ki&&(Ee(_r),Ee(hi),xn+=ki,ki=hi=0),hi||(xn+=128,hi=Le(xn));const Cr=zi.length+7&-8;let ur=hi;Cr>=xn&&(ki=Cr,ur=_r=Le(Cr));for(let Yr=0;Yr<zi.length;Yr++)K[ur+Yr]=zi[Yr];return ur}})();return ie(),Bt(),{memory:an,_free:Ee,_malloc:Le,Mesh:class{constructor(){this.ptr=Oe()}destroy(){qe(this.ptr)}},Decoder:class{constructor(){this.ptr=ht()}destroy(){Dt(this.ptr)}DecodeArrayToMesh(hi,xn,ki){const _r=Ei(hi),zi=It(this.ptr,_r,xn,ki.ptr);return!!rt(zi)}GetAttributeByUniqueId(hi,xn){return{ptr:At(this.ptr,hi.ptr,xn)}}GetTrianglesUInt16Array(hi,xn,ki){Kt(this.ptr,hi.ptr,xn,ki)}GetTrianglesUInt32Array(hi,xn,ki){fn(this.ptr,hi.ptr,xn,ki)}GetAttributeDataArrayForAllPoints(hi,xn,ki,_r,zi){Ut(this.ptr,hi.ptr,xn.ptr,ki,_r,zi)}},DT_INT8:Mn(),DT_UINT8:on(),DT_INT16:ri(),DT_UINT16:Kn(),DT_UINT32:bn(),DT_FLOAT32:Hi()}})}(fetch(Z_())),tg.then($=>{Hu=$,tg=void 0}))}()),z&&D.push(function(){if(Dm)return;const $=function(K){let X;const ie=WebAssembly.instantiateStreaming(K,{}).then(Ce=>{X=Ce.instance,X.exports.__wasm_call_ctors()}),ae={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},be={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:ie,supported:!0,decodeGltfBuffer(Ce,Ee,Le,Oe,qe,rt){!function(ht,It,At,Kt,fn,Ut,Dt){const Bt=ht.exports.sbrk,an=Kt+3&-4,Mn=Bt(an*fn),on=Bt(Ut.length),ri=new Uint8Array(ht.exports.memory.buffer);ri.set(Ut,on);const Kn=It(Mn,Kt,fn,on,Ut.length);if(0===Kn&&Dt&&Dt(Mn,an,fn),At.set(ri.subarray(Mn,Mn+Kt*fn)),Bt(Mn-Bt(0)),0!==Kn)throw new Error(`Malformed buffer data: ${Kn}`)}(X,X.exports[be[qe]],Ce,Ee,Le,Oe,X.exports[ae[rt]])}}}(fetch(X_()));return $.ready.then(()=>{Dm=$})}()),g)for(let $=0;$<g.length;$++)D.push(uL(g[$],u,$,a));return(D.length?Promise.all(D):Promise.resolve()).then(()=>{if(O&&v)for(const{primitives:$}of v)for(const K of $)OI(K,u);if(z&&v&&S)for(const $ of S)kI($,u);return u})})}class NI{constructor(r,a,u){if(this.triangleCount=a.length/3,this.min=new Nn(0,0),this.max=new Nn(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===r.length||0===u)return;const f=r.map(D=>D.x),g=r.map(D=>D.y);this.min=new Nn(Math.min(...f),Math.min(...g)),this.max=new Nn(Math.max(...f),Math.max(...g));const v=this.max.sub(this.min);v.x=Math.max(v.x,1),v.y=Math.max(v.y,1);const x=Math.max(v.x,v.y)/u;this.cellsX=Math.max(1,Math.ceil(v.x/x)),this.cellsY=Math.max(1,Math.ceil(v.y/x)),this.xScale=1/x,this.yScale=1/x;const S=[];for(let D=0;D<this.triangleCount;D++){const O=r[a[3*D+0]].sub(this.min),z=r[a[3*D+1]].sub(this.min),$=r[a[3*D+2]].sub(this.min),K=Y_(Math.floor(Math.min(O.x,z.x,$.x)),this.xScale,this.cellsX),X=Y_(Math.floor(Math.max(O.x,z.x,$.x)),this.xScale,this.cellsX),ie=Y_(Math.floor(Math.min(O.y,z.y,$.y)),this.yScale,this.cellsY),ae=Y_(Math.floor(Math.max(O.y,z.y,$.y)),this.yScale,this.cellsY),be=new Nn(0,0),Ce=new Nn(0,0),Ee=new Nn(0,0),Le=new Nn(0,0);for(let Oe=ie;Oe<=ae;++Oe){be.y=Ce.y=Oe*x,Ee.y=Le.y=(Oe+1)*x;for(let qe=K;qe<=X;++qe)be.x=Ee.x=qe*x,Ce.x=Le.x=(qe+1)*x,(_b(O,z,$,be,Ce,Le)||_b(O,z,$,be,Le,Ee))&&S.push({cellIdx:Oe*this.cellsX+qe,triIdx:D})}}if(0===S.length)return;S.sort((D,O)=>D.cellIdx-O.cellIdx||D.triIdx-O.triIdx);let T=0;for(;T<S.length;){const D=S[T].cellIdx,O={start:this.payload.length,len:0};for(;T<S.length&&S[T].cellIdx===D;)++O.len,this.payload.push(S[T++].triIdx);this.cells[D]=O}}query(r,a,u){if(0===this.triangleCount||0===this.cells.length||r.x>this.max.x||this.min.x>a.x||r.y>this.max.y||this.min.y>a.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let S=0;S<this.lookup.length;S++)this.lookup[S]=0;const f=Y_(r.x-this.min.x,this.xScale,this.cellsX),g=Y_(a.x-this.min.x,this.xScale,this.cellsX),v=Y_(r.y-this.min.y,this.yScale,this.cellsY),x=Y_(a.y-this.min.y,this.yScale,this.cellsY);for(let S=v;S<=x;S++)for(let T=f;T<=g;T++){const D=this.cells[S*this.cellsX+T];if(D)for(let O=0;O<D.len;O++){const z=this.payload[D.start+O],$=Math.floor(z/8),K=1<<z%8;if(!(this.lookup[$]&K)&&(this.lookup[$]|=K,u.push(z),u.length===this.triangleCount))return}}}}function Y_(o,r,a){return Math.max(0,Math.min(a-1,Math.floor(o*r)))}function J_(o,r){const a=o.json.bufferViews[r.bufferView],u=ng[r.componentType];return new u(o.buffers[a.buffer],(r.byteOffset||0)+(a.byteOffset||0),r.count*(a.byteStride&&a.byteStride!==xy[r.type]*u.BYTES_PER_ELEMENT?a.byteStride/u.BYTES_PER_ELEMENT:xy[r.type]))}function LI(o,r,a,u){const f=ng[r.componentType],g=function(D){switch(D){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(f),v=o.json.bufferViews[r.bufferView],x=v.byteStride?v.byteStride/f.BYTES_PER_ELEMENT:xy[r.type],S=a.float32,T=S.length/a.capacity;for(let D=0,O=0;D<r.count*x;D+=x,O+=T)for(let z=0;z<T;z++)S[O+z]=u[D+z]*g;a._trim()}function D5(o,r,a){const u=o.indices,f=o.attributes,g={};g.indexArray=new el;const v=r.json.accessors[u],x=v.count/3;g.indexArray.reserve(x);const S=J_(r,v);for(let z=0;z<x;z++)g.indexArray.emplaceBack(S[3*z],S[3*z+1],S[3*z+2]);g.indexArray._trim(),g.vertexArray=new Au;const T=r.json.accessors[f.POSITION];g.vertexArray.reserve(T.count);const D=J_(r,T);for(let z=0;z<T.count;z++)g.vertexArray.emplaceBack(D[3*z],D[3*z+1],D[3*z+2]);if(g.vertexArray._trim(),g.aabb=new ta(T.min,T.max),g.centroid=function(z,$){const K=[0,0,0],X=z.length;if(X>0){for(let ie=0;ie<X;ie++){const ae=3*z[ie];K[0]+=$[ae],K[1]+=$[ae+1],K[2]+=$[ae+2]}K[0]/=X,K[1]/=X,K[2]/=X}return K}(S,D),void 0!==f.COLOR_0){const z=r.json.accessors[f.COLOR_0],$=xy[z.type],K=J_(r,z);g.colorArray=3===$?new Au:new Hh,g.colorArray.resize(z.count),LI(r,z,g.colorArray,K)}if(void 0!==f.NORMAL){g.normalArray=new Au;const z=r.json.accessors[f.NORMAL];g.normalArray.resize(z.count);const $=J_(r,z);LI(r,z,g.normalArray,$)}if(void 0!==f.TEXCOORD_0&&a.length>0){g.texcoordArray=new Ua;const z=r.json.accessors[f.TEXCOORD_0];g.texcoordArray.resize(z.count);const $=J_(r,z);LI(r,z,g.texcoordArray,$)}if(void 0!==f._FEATURE_ID_RGBA4444){const z=r.json.accessors[f._FEATURE_ID_RGBA4444];r.json.extensionsUsed&&r.json.extensionsUsed.includes("EXT_meshopt_compression")&&(g.featureData=J_(r,z))}void 0!==f._FEATURE_RGBA4444&&(g.featureData=new Uint32Array(J_(r,r.json.accessors[f._FEATURE_RGBA4444]).buffer));const O=o.material;return g.material=function(z,$){const{emissiveFactor:K=[0,0,0],alphaMode:X="OPAQUE",alphaCutoff:ie=.5,normalTexture:ae,occlusionTexture:be,emissiveTexture:Ce,doubleSided:Ee}=z,{baseColorFactor:Le=[1,1,1,1],metallicFactor:Oe=1,roughnessFactor:qe=1,baseColorTexture:rt,metallicRoughnessTexture:ht}=z.pbrMetallicRoughness||{},It=be?$[be.index]:void 0;if(be&&be.extensions&&be.extensions.KHR_texture_transform&&It){const At=be.extensions.KHR_texture_transform;It.offsetScale=[At.offset[0],At.offset[1],At.scale[0],At.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new so(...Le),metallicFactor:Oe,roughnessFactor:qe,baseColorTexture:rt?$[rt.index]:void 0,metallicRoughnessTexture:ht?$[ht.index]:void 0},doubleSided:Ee,emissiveFactor:K,alphaMode:X,alphaCutoff:ie,normalTexture:ae?$[ae.index]:void 0,occlusionTexture:It,emissionTexture:Ce?$[Ce.index]:void 0,defined:void 0===z.defined}}(void 0!==O?r.json.materials[O]:{defined:!1},a),g}function UI(o,r,a){const{matrix:u,rotation:f,translation:g,scale:v,mesh:x,extras:S,children:T}=o,D={};if(D.matrix=u||p.a6.fromRotationTranslationScale([],f||[0,0,0,1],g||[0,0,0],v||[1,1,1]),void 0!==x){D.meshes=a[x];const O=D.anchor=[0,0];for(const z of D.meshes){const{min:$,max:K}=z.aabb;O[0]+=$[0]+K[0],O[1]+=$[1]+K[1]}O[0]=Math.floor(O[0]/D.meshes.length/2),O[1]=Math.floor(O[1]/D.meshes.length/2)}if(S&&(S.id&&(D.id=S.id),S.lights&&(D.lights=function(O){if(!O.length)return[];const z=function(ae){const be=atob(ae),Ce=new Uint8Array(be.length);for(let Ee=0;Ee<be.length;Ee++)Ce[Ee]=be.codePointAt(Ee);return Ce}(O),$=[],K=z.length/24,X=new Uint16Array(z.buffer),ie=new Float32Array(z.buffer);for(let ae=0;ae<K;ae++){const be=X[2*ae*6]/30,Ce=X[2*ae*6+1]/30,Ee=X[2*ae*6+10]/100,Le=ie[6*ae+1],Oe=ie[6*ae+2],qe=ie[6*ae+3],rt=ie[6*ae+4],ht=qe-Le,It=rt-Oe,At=Math.hypot(ht,It);$.push({pos:[Le+.5*ht,Oe+.5*It,Ce],normal:[It/At,-ht/At,0],width:At,height:be,depth:Ee,points:[Le,Oe,qe,rt]})}return $}(S.lights))),T){const O=[];for(const z of T)O.push(UI(r.json.nodes[z],r,a));D.children=O}return D}function B5(o){if(0===o.vertices.length||0===o.indices.length)return null;const[r,a]=[o.vertices[0].clone(),o.vertices[0].clone()];for(let v=1;v<o.vertices.length;++v){const x=o.vertices[v];r.x=Math.min(r.x,x.x),r.y=Math.min(r.y,x.y),a.x=Math.max(a.x,x.x),a.y=Math.max(a.y,x.y)}const u=Math.ceil(Math.max(a.x-r.x,a.y-r.y)/256),f=Math.max(8,u),g=new NI(o.vertices,o.indices,f);return{vertices:o.vertices,indices:o.indices,grid:g,min:r,max:a}}function F2(o){if(!o.extras||!o.extras.ground)return null;const r=o.extras.ground;if(!r||!Array.isArray(r)||0===r.length)return null;const a=r[0];if(!a||!Array.isArray(a)||0===a.length)return null;const u=[];for(const v of a){if(!Array.isArray(v)||2!==v.length)continue;const x=v[0],S=v[1];"number"==typeof x&&"number"==typeof S&&u.push(new Nn(x,S))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let f=0;for(let v=0;v<u.length;v++){const x=u[v],S=u[(v+1)%u.length],T=u[(v+2)%u.length];f+=(x.x-S.x)*(T.y-S.y)-(T.x-S.x)*(x.y-S.y)}f>0&&u.reverse();const g=jb(u.flatMap(v=>[v.x,v.y]),[]);return 0===g.length?null:{vertices:u,indices:g}}function p1(o){const r=[],a=[];let u=0;for(const f of o){u=r.length;const g=f.vertexArray.float32,v=f.indexArray.uint16;for(let x=0;x<f.vertexArray.length;x++)r.push(new Nn(g[3*x+0],g[3*x+1]));for(let x=0;x<3*f.indexArray.length;x++)a.push(v[x]+u)}if(a.length%3!=0)return null;for(let f=0;f<a.length;f+=3){const g=r[a[f+0]],v=r[a[f+1]],x=r[a[f+2]];(g.x-v.x)*(x.y-v.y)-(x.x-v.x)*(g.y-v.y)>0&&([a[f+1],a[f+2]]=[a[f+2],a[f+1]])}return{vertices:r,indices:a}}function Mw(o){const a=function(S,T){const D=[];for(const O of S.json.meshes){const z=[];for(const $ of O.primitives)z.push(D5($,S,T));D.push(z)}return D}(o,function(S,T){const D=[],O=WebGL2RenderingContext;if(S.json.textures)for(const z of S.json.textures){const $={magFilter:O.LINEAR,minFilter:O.NEAREST,wrapS:O.REPEAT,wrapT:O.REPEAT};void 0!==z.sampler&&Object.assign($,S.json.samplers[z.sampler]),D.push({image:T[z.source],sampler:$,uploaded:!1})}return D}(o,o.images)),{scenes:u,scene:f,nodes:g}=o.json,v=u?u[f||0].nodes:g,x=[];for(const S of v)x.push(UI(g[S],o,a));return function(S,T,D){const O={},z=new Set;for(let $=0;$<S.length;$++){const K=D[T[$]];if(!K.extras)continue;const X=K.extras["mapbox:footprint:version"],ie=K.extras["mapbox:footprint:id"];(X||ie)&&z.add($),"1.0.0"===X&&ie&&(O[ie]=$)}for(let $=0;$<S.length;$++){if(z.has($))continue;const K=S[$],X=D[T[$]];if(!X.extras)continue;let ie=null;K.id in O&&(ie=p1(S[O[K.id]].meshes)),ie||(ie=F2(X)),ie&&(K.footprint=B5(ie))}if(z.size>0){const $=Array.from(z.values()).sort((K,X)=>K-X);for(let K=$.length-1;K>=0;K--)S.splice($[K],1)}}(x,v,o.json.nodes),x}function Fw(o){o.heightmap=new Float32Array(4096),o.heightmap.fill(-1);const r=o.vertexArray.float32,a=o.aabb.min[0]-1,u=o.aabb.min[1]-1,f=64/(o.aabb.max[0]-a+2),g=64/(o.aabb.max[1]-u+2);for(let v=0;v<r.length;v+=3){const x=r[v+2],S=(r[v+0]-a)*f|0,T=(r[v+1]-u)*g|0;x>o.heightmap[64*T+S]&&(o.heightmap[64*T+S]=x)}}function zI(o,r){const a={};a.indexArray=new el,a.indexArray.reserve(4*o.length),a.vertexArray=new Au,a.vertexArray.reserve(10*o.length),a.colorArray=new Hh,a.vertexArray.reserve(10*o.length);let u=0;for(const v of o){const x=Math.min(10,Math.max(4,1.3*v.height))*r,S=[-v.normal[1],v.normal[0],0],T=Math.min(.29,.1*v.width/v.depth),D=v.width-2*v.depth*r*(T+.01),O=p.N.scaleAndAdd([],v.pos,S,D/2),z=p.N.scaleAndAdd([],v.pos,S,-D/2),$=[O[0],O[1],O[2]+v.height],K=[z[0],z[1],z[2]+v.height],X=p.N.scaleAndAdd([],v.normal,S,T);p.N.scale(X,X,x);const ie=p.N.scaleAndAdd([],v.normal,S,-T);p.N.scale(ie,ie,x),p.N.add(X,O,X),p.N.add(ie,z,ie),O[2]+=.1,z[2]+=.1,a.vertexArray.emplaceBack(X[0],X[1],X[2]),a.vertexArray.emplaceBack(ie[0],ie[1],ie[2]),a.vertexArray.emplaceBack(O[0],O[1],O[2]),a.vertexArray.emplaceBack(z[0],z[1],z[2]),a.vertexArray.emplaceBack($[0],$[1],$[2]),a.vertexArray.emplaceBack(K[0],K[1],K[2]),a.vertexArray.emplaceBack(O[0],O[1],O[2]),a.vertexArray.emplaceBack(z[0],z[1],z[2]),a.vertexArray.emplaceBack(X[0],X[1],X[2]),a.vertexArray.emplaceBack(ie[0],ie[1],ie[2]);const ae=D/x/2;a.colorArray.emplaceBack(-ae-T,-1,ae,.8),a.colorArray.emplaceBack(ae+T,-1,ae,.8),a.colorArray.emplaceBack(-ae,0,ae,1.3),a.colorArray.emplaceBack(ae,0,ae,1.3),a.colorArray.emplaceBack(ae+T,-.8,ae,.7),a.colorArray.emplaceBack(ae+T,-.8,ae,.7),a.colorArray.emplaceBack(0,0,ae,1.3),a.colorArray.emplaceBack(0,0,ae,1.3),a.colorArray.emplaceBack(ae+T,-1.2,ae,.8),a.colorArray.emplaceBack(ae+T,-1.2,ae,.8),a.indexArray.emplaceBack(6+u,4+u,8+u),a.indexArray.emplaceBack(7+u,9+u,5+u),a.indexArray.emplaceBack(0+u,1+u,2+u),a.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const f={defined:!0,emissiveFactor:[0,0,0]},g={};return g.baseColorFactor=so.white,f.pbrMetallicRoughness=g,a.material=f,a.aabb=new ta([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),a}ai(NI,"TriangleGridIndex");class Cy{constructor(r){this._stringToNumber={},this._numberToString=[];for(let a=0;a<r.length;a++){const u=r[a];this._stringToNumber[u]=a,this._numberToString[a]=u}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}const VI=["tile","layer","source","sourceLayer","state"];class HI{constructor(r,a,u,f,g){this.type="Feature",this._vectorTileFeature=r,this._z=a,this._x=u,this._y=f,this.properties=r.properties,this.id=g}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(r.id=this.id);for(const a of VI)void 0!==this[a]&&(r[a]=this[a]);return r}}class Ey{constructor(r,a){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new hh(Jn,16,0),this.featureIndexArray=new hm,this.promoteId=a,this.is3DTile=!1}insert(r,a,u,f,g,v=0,x=0){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,f,g,v);const T=this.grid;for(let D=0;D<a.length;D++){const O=a[D],z=[1/0,1/0,-1/0,-1/0];for(let $=0;$<O.length;$++){const K=O[$];z[0]=Math.min(z[0],K.x),z[1]=Math.min(z[1],K.y),z[2]=Math.max(z[2],K.x),z[3]=Math.max(z[3],K.y)}0!==x&&(z[0]-=x,z[1]-=x,z[2]+=x,z[3]+=x),z[0]<Jn&&z[1]<Jn&&z[2]>=0&&z[3]>=0&&T.insert(S,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Kb(new H_(this.rawTileData)).layers,this.sourceLayerCoder=new Cy(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,a,u,f){this.loadVTLayers();const g=r.params||{},v=du(g.filter),x=r.tileResult,S=r.transform,T=x.bufferedTilespaceBounds,D=this.grid.query(T.min.x,T.min.y,T.max.x,T.max.y,(K,X,ie,ae)=>vC(x.bufferedTilespaceGeometry,K,X,ie,ae));D.sort(M5);let O=null;S.elevation&&D.length>0&&(O=Uu.create(S.elevation,this.tileID));const z={};let $;for(let K=0;K<D.length;K++){const X=D[K];if(X===$)continue;$=X;const ie=this.featureIndexArray.get(X);let ae=null;if(this.is3DTile){const be=this.bucketLayerIDs[0][0],Ce=a[be];if("model"!==Ce.type)continue;const{queryFeature:Ee,intersectionZ:Le}=Ce.queryIntersectsMatchingFeature(x,ie.featureIndex,v,S);Ee&&this.appendToResult(z,be,ie.featureIndex,Ee,Le)}else this.loadMatchingFeature(z,ie,v,g.layers,g.availableImages,a,u,f,(be,Ce,Ee,Le=0)=>(ae||(ae=oo(be,this.tileID.canonical,r.tileTransform)),Ce.queryIntersectsFeature(x,be,Ee,ae,this.z,r.transform,r.pixelPosMatrix,O,Le)))}return z}loadMatchingFeature(r,a,u,f,g,v,x,S,T){const{featureIndex:D,bucketIndex:O,sourceLayerIndex:z,layoutVertexArrayOffset:$}=a,K=this.bucketLayerIDs[O];if(f&&!function(be,Ce){for(let Ee=0;Ee<be.length;Ee++)if(Ce.indexOf(be[Ee])>=0)return!0;return!1}(f,K))return;const X=this.sourceLayerCoder.decode(z),ie=this.vtLayers[X].feature(D);if(u.needGeometry){const be=fa(ie,!0);if(!u.filter(new uo(this.tileID.overscaledZ),be,this.tileID.canonical))return}else if(!u.filter(new uo(this.tileID.overscaledZ),ie))return;const ae=this.getId(ie,X);for(let be=0;be<K.length;be++){const Ce=K[be];if(f&&f.indexOf(Ce)<0)continue;const Ee=v[Ce];if(!Ee)continue;let Le={};void 0!==ae&&S&&(Le=S.getState(Ee.sourceLayer||"_geojsonTileLayer",ae));const Oe=!T||T(ie,Ee,Le,$);if(!Oe)continue;const qe=new HI(ie,this.z,this.x,this.y,ae),rt=Oa({},x[Ce]);rt.paint=QI(rt.paint,Ee.paint,ie,Le,g),rt.layout=QI(rt.layout,Ee.layout,ie,Le,g),qe.layer=rt,this.appendToResult(r,Ce,D,qe,Oe)}}appendToResult(r,a,u,f,g){let v=r[a];void 0===v&&(v=r[a]=[]),v.push({featureIndex:u,feature:f,intersectionZ:g})}lookupSymbolFeatures(r,a,u,f,g,v,x,S){const T={};this.loadVTLayers();const D=du(g);for(const O of r)this.loadMatchingFeature(T,{bucketIndex:u,sourceLayerIndex:f,featureIndex:O,layoutVertexArrayOffset:0},D,v,x,S,a);return T}loadFeature(r){const{featureIndex:a,sourceLayerIndex:u}=r;this.loadVTLayers();const f=this.sourceLayerCoder.decode(u),g=this.vtFeatures[f];if(g[a])return g[a];const v=this.vtLayers[f].feature(a);return g[a]=v,v}hasLayer(r){for(const a of this.bucketLayerIDs)for(const u of a)if(r===u)return!0;return!1}getId(r,a){let u=r.id;if(this.promoteId){const f="string"==typeof this.promoteId?this.promoteId:this.promoteId[a];null!=f&&(u=r.properties[f]),"boolean"==typeof u&&(u=Number(u))}return u}}function QI(o,r,a,u,f){return Kr(o,(g,v)=>{const x=r instanceof LA?r.get(v):null;return x&&x.evaluate?x.evaluate(a,u,f):x})}function M5(o,r){return r-o}ai(Ey,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const R2=new Float32Array(262144),e0=new Uint8Array(262144);function Rw(o){let r=0;if(o.meshes)for(const a of o.meshes)r=Math.max(r,a.aabb.max[2]);if(o.children)for(const a of o.children)r=Math.max(r,Rw(a));return r}function g1(o,r,a){if(o.meshes)for(const u of o.meshes)u.aabb.min[0]!==1/0&&a.insert(r,u.aabb.min[0],u.aabb.min[1],u.aabb.max[0],u.aabb.max[1]);if(o.children)for(const u of o.children)g1(u,r,a)}const m1=["","wall","door","roof","window","lamp","logo"];class F5{constructor(r){this.node=r,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:r.id,geometry:[],properties:{height:Rw(r)}}}getLocalBounds(){if(!this.node.meshes)return new ta([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let r=0;const a=new ta([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==r&&a.encapsulate(u.aabb),r++;this.aabb=a}return this.aabb}}class Ow{constructor(r,a,u,f,g,v){this.id=a,this.modelTraits|=by.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,u&&(this.modelTraits|=by.HasMapboxMeshFeatures),f&&(this.modelTraits|=by.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=g,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const x of r)this.nodesInfo.push(new F5(x)),g1(x,v.featureIndexArray.length,v.grid),v.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,v.bucketLayerIDs.length-1,0)}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(r){if(!this.needsUpload)return;const a=this.getNodesInfo();for(const u of a){const f=u.node;this.uploaded?this.updatePbrBuffer(f):MI(f,r,!0)}for(const u of a)W_(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(r){let a=!1;if(!r.meshes)return a;for(const u of r.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),a=!0);return a}needsReEvaluation(r,a,u){const f=r.transform.projectionOptions,g=r.style.getBrightness(),v=this.brightness!==g;return!!(!this.uploaded||this.dirty||f.name!==this.projection.name||_1(u.paint.get("model-color").value,v)||_1(u.paint.get("model-color-mix-intensity").value,v)||_1(u.paint.get("model-roughness").value,v)||_1(u.paint.get("model-emissive-strength").value,v)||_1(u.paint.get("model-height-based-emissive-strength-multiplier").value,v))&&(this.projection=f,this.brightness=g,!0)}evaluateScale(r,a){if(r.transform.zoom===this.zoom)return;this.zoom=r.transform.zoom;const u=this.getNodesInfo(),f=this.id.canonical;for(const g of u){const v=g.feature;g.evaluatedScale=a.paint.get("model-scale").evaluate(v,{},f)}}evaluate(r){const a=this.getNodesInfo();for(const u of a){if(!u.node.meshes)continue;const f=u.feature,g=u.node.meshes&&u.node.meshes[0].featureData,v=u.evaluatedColor[2],x=u.evaluatedRMEA[2],S=this.id.canonical;if(u.hasTranslucentParts=!1,g){for(let T=0;T<m1.length;T++){const D=m1[T];D.length&&(f.properties.part=D);const O=r.paint.get("model-color").evaluate(f,{},S),z=r.paint.get("model-color-mix-intensity").evaluate(f,{},S);u.evaluatedColor[T]=[O.r,O.g,O.b,z],u.evaluatedRMEA[T][0]=r.paint.get("model-roughness").evaluate(f,{},S),u.evaluatedRMEA[T][2]=r.paint.get("model-emissive-strength").evaluate(f,{},S),u.evaluatedRMEA[T][3]=O.a,u.emissionHeightBasedParams[T]=r.paint.get("model-height-based-emissive-strength-multiplier").evaluate(f,{},S),!u.hasTranslucentParts&&O.a<1&&(u.hasTranslucentParts=!0)}delete f.properties.part,R5(u,v!==u.evaluatedColor[2]||x!==u.evaluatedRMEA[2],this.modelTraits)}else u.evaluatedRMEA[0][2]=r.paint.get("model-emissive-strength").evaluate(f,{},S);u.evaluatedScale=r.paint.get("model-scale").evaluate(f,{},S),this.updatePbrBuffer(u.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(r,a,u,f){const g=r.findDEMTileFor(u);if(g&&(g.tileID.canonical!==this.terrainTile||a!==this.terrainExaggeration)){if(g.dem&&g.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=g.tileID.overscaledZ;const v=Uu.create(r,u,g);if(!v)return;this.modelTraits&by.HasMapboxMeshFeatures&&this.updateDEM(r,v,u,f);for(const x of this.getNodesInfo()){const S=x.node;if(!S.footprint||!S.footprint.vertices||!S.footprint.vertices.length)continue;const T=S.footprint.vertices;let D=v.getElevationAt(T[0].x,T[0].y,!0,!0);for(let O=1;O<T.length;O++)D=Math.min(D,v.getElevationAt(T[O].x,T[O].y,!0,!0));S.elevation=D}}this.terrainTile=g.tileID.canonical,this.terrainExaggeration=a}}updateDEM(r,a,u,f){let g=a._dem._modifiedForSources[f];if(void 0===g&&(a._dem._modifiedForSources[f]=[],g=a._dem._modifiedForSources[f]),g.includes(u.canonical))return;const v=a._dem.dim;g.push(u.canonical);let x=!1;for(const S of this.getNodesInfo()){const T=S.node;if(!T.footprint||!T.footprint.grid)continue;const D=T.footprint.grid,O=a.tileCoordToPixel(D.min.x,D.min.y),z=a.tileCoordToPixel(D.max.x,D.max.y),$=Math.min(Math.min(v-z.y,O.x),Math.min(O.y,v-z.x));if($<0)continue;const K=ir($,2,5);let X=Math.max(0,O.x-K),ie=Math.max(0,O.y-K),ae=Math.min(z.x+K,v-1),be=Math.min(z.y+K,v-1);for(let Oe=ie;Oe<=be;++Oe)for(let qe=X;qe<=ae;++qe)e0[Oe*v+qe]=255;let Ce=0,Ee=0;for(let Oe=0;Oe<D.cellsY;++Oe)for(let qe=0;qe<D.cellsX;++qe){if(!D.cells[Oe*D.cellsX+qe])continue;const rt=a.tileCoordToPixel(D.min.x+qe/D.xScale,D.min.y+Oe/D.yScale),ht=a.tileCoordToPixel(D.min.x+(qe+1)/D.xScale,D.min.y+(Oe+1)/D.yScale);for(let It=rt.y;It<=Math.min(ht.y+1,v-1);++It)for(let At=rt.x;At<=Math.min(ht.x+1,v-1);++At)255===e0[It*v+At]&&(e0[It*v+At]=0,Ce+=a.getElevationAtPixel(At,It),Ee++)}const Le=Ce/Ee;X=Math.max(1,O.x-K),ie=Math.max(1,O.y-K),ae=Math.min(z.x+K,v-2),be=Math.min(z.y+K,v-2),x=!0;for(let Oe=ie;Oe<=be;++Oe)for(let qe=X;qe<=ae;++qe)0===e0[Oe*v+qe]&&(R2[Oe*v+qe]=a._dem.set(qe,Oe,Le));for(let Oe=1;Oe<K;++Oe){X=Math.max(1,O.x-Oe),ie=Math.max(1,O.y-Oe),ae=Math.min(z.x+Oe,v-2),be=Math.min(z.y+Oe,v-2);for(let qe=ie;qe<=be;++qe)for(let rt=X;rt<=ae;++rt){const ht=qe*v+rt;if(255===e0[ht]){let It=0,At=0,Kt=-1,fn=-1;for(let Ut=-1;Ut<=1;++Ut)for(let Dt=-1;Dt<=1;++Dt){const Bt=(qe+Ut)*v+rt+Dt;if(e0[Bt]>=Oe)continue;const an=R2[Bt],Mn=Math.abs(an);Mn>At&&(It=an,At=Mn,Kt=Dt,fn=Ut)}if(At>.1){const Ut=1-(Oe+.5*Math.abs(Kt*fn))/K;let Dt=a._dem.get(rt,qe)+It*Ut;const Bt=a._dem.get(rt+Kt,qe+fn),an=a._dem.get(rt-Kt,qe-fn,!0);(Dt-Bt)*(Dt-an)>0&&(Dt=(Bt+an)/2),R2[ht]=a._dem.set(rt,qe,Dt),e0[ht]=Oe}}}}}x&&(a._demTile.needsDEMTextureUpload=!0,a._dem._timestamp=wn.now())}getNodesInfo(){return this.nodesInfo}destroy(){const r=this.getNodesInfo();for(const a of r)W_(a.node),T2(a.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(r,a){if(a.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=a.updateTime;const u=a.getReplacementRegionsForTile(r.toUnwrapped()),f=this.getNodesInfo();for(let g=0;g<this.nodesInfo.length;g++){const v=f[g].node;f[g].hiddenByReplacement=!!v.footprint&&!u.find(x=>x.footprint===v.footprint)}}getHeightAtTileCoord(r,a){const u=this.getNodesInfo(),f=[];for(let g=0;g<this.nodesInfo.length;g++){const v=u[g],x=v.node.meshes[0];if(r<x.aabb.min[0]||a<x.aabb.min[1]||r>x.aabb.max[0]||a>x.aabb.max[1])continue;const S=(r-x.aabb.min[0])/(x.aabb.max[0]-x.aabb.min[0])*64|0,T=64*Math.min(63,(a-x.aabb.min[1])/(x.aabb.max[1]-x.aabb.min[1])*64|0)+Math.min(63,S);if(!(x.heightmap[T]<0&&v.node.footprint))return v.hiddenByReplacement?void 0:{height:x.heightmap[T],maxHeight:v.feature.properties.height,hidden:!1,verticalScale:v.evaluatedScale[2]};if(v.node.footprint.grid.query(new Nn(r,a),new Nn(r,a),f),f.length>0)return{height:void 0,maxHeight:v.feature.properties.height,hidden:v.hiddenByReplacement,verticalScale:v.evaluatedScale[2]}}}}function _1(o,r){return!o.isLightConstant&&r}function O2(o,r,a,u,f,g,v,x){let S=(61440&r|(61440&r)>>4)>>8,T=(3840&r|(3840&r)>>4)>>4,D=240&r|(240&r)>>4;a[3]>0&&(S=Fi(S,255*a[0],a[3]),T=Fi(T,255*a[1],a[3]),D=Fi(D,255*a[2],a[3]));const O=S<<8|T,z=D<<8|Math.floor(255*u[3]),$=function(Oe){const qe=ir(Oe,0,2);return Math.min(Math.round(.5*qe*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],K=ir(f[0],0,1),X=ir(f[1],0,1),ie=ir(f[2],0,1),ae=ir(f[3],0,1);let be,Ce,Ee,Le;if(K!==X&&v!==g&&X!==K){const Oe=v-g;Ce=1/(Oe*(X-K)),Ee=-(g+Oe*K)/(Oe*(X-K));const qe=ir(f[4],-1,1);Le=Math.pow(10,qe),be=255*ie<<8|255*ae}else be=65535,Ce=0,Ee=1,Le=1;if(o.emplaceBack(O,z,$,be,Ce,Ee,Le),x){const Oe=x.length;x.clear();for(let qe=0;qe<Oe;qe++)x.emplaceBack(O,z,$,be,Ce,Ee,Le)}}function R5(o,r,a){const u=o.node;let f=0;const g=a&by.HasMeshoptCompression;for(const v of u.meshes){if(u.lights&&u.lightMeshIndex===f||!v.featureData)continue;v.featureArray=new jp,v.featureArray.reserve(v.featureData.length);let x=r;for(const S of v.featureData){const T=g?65535&S:S>>16&65535,D=g?S>>16&65535:65535&S,O=(15&D)<8?15&D:0,z=o.evaluatedRMEA[O],$=o.evaluatedColor[O],K=o.emissionHeightBasedParams[O];let X;if(x&&2===O&&u.lights&&(X=new jp,X.resize(10*u.lights.length)),O2(v.featureArray,T,$,z,K,v.aabb.min[2],v.aabb.max[2],X),X&&x){x=!1;const ie=u.meshes[u.lightMeshIndex];ie.featureArray=X,ie.featureArray._trim()}}v.featureArray._trim(),f++}}function k2(o,r,a,u){const f=1<<o.z;r.lat=kr((u/Jn+o.y)/f),r.lng=rr((a/Jn+o.x)/f)}ai(Ow,"Tiled3dModelBucket",{omit:["layers"]}),ai(F5,"Tiled3dModelFeature");const O5={circle:class extends Vc{constructor(o,r,a){super(o,Ml,r,a)}createBucket(o){return new $c(o)}queryRadius(o){const r=o;return Am("circle-radius",this,r)+Am("circle-stroke-width",this,r)+bv(this.paint.get("circle-translate"))}queryIntersectsFeature(o,r,a,u,f,g,v,x){const S=yb(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),T=this.paint.get("circle-radius").evaluate(r,a)+this.paint.get("circle-stroke-width").evaluate(r,a);return VC(o,u,g,v,x,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),S,T)}getProgramIds(){return["circle"]}getDefaultProgramParams(o,r){const a=Lb(this);return{config:new te(this,r),defines:a,overrideFog:!1}}},heatmap:class extends Vc{createBucket(o){return new uT(o)}constructor(o,r,a){super(o,$N,r,a),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"heatmap-color"===o&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ub({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(o){return Am("heatmap-radius",this,o)}queryIntersectsFeature(o,r,a,u,f,g,v,x){const S=this.paint.get("heatmap-radius").evaluate(r,a);return VC(o,u,g,v,x,!0,!0,new Nn(0,0),S)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(o,r){return"heatmap"===o?{config:new te(this,r),overrideFog:!1}:{}}},hillshade:class extends Vc{constructor(o,r,a){super(o,KN,r,a)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(o,r){return{overrideFog:!1}}},fill:class extends Vc{constructor(o,r,a){super(o,kF,r,a)}getProgramIds(){const o=this.paint.get("fill-pattern"),r=o&&o.constantOr(1),a=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getDefaultProgramParams(o,r){return{config:new te(this,r),overrideFog:!1}}recalculate(o,r){super.recalculate(o,r);const a=this.paint._values["fill-outline-color"];"constant"===a.value.kind&&void 0===a.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new WC(o)}queryRadius(){return bv(this.paint.get("fill-translate"))}queryIntersectsFeature(o,r,a,u,f,g){return!o.queryGeometry.isAboveHorizon&&wc(WA(o.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}},"fill-extrusion":class extends Vc{constructor(o,r,a){super(o,HF,r,a),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(o){return new ly(o)}queryRadius(){return bv(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(o,r,a,u,f,g,v,x,S){const T=yb(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),D=this.paint.get("fill-extrusion-height").evaluate(r,a),O=this.paint.get("fill-extrusion-base").evaluate(r,a),z=[0,0],$=x&&g.elevation,K=g.elevation?g.elevation.exaggeration():1,X=o.tile.getBucket(this);if($&&X instanceof ly){const Ee=X.centroidVertexArray,Le=S+1;Le<Ee.length&&(z[0]=Ee.geta_centroid_pos0(Le),z[1]=Ee.geta_centroid_pos1(Le))}if(0===z[0]&&1===z[1])return!1;"globe"===g.projection.name&&(u=sw([u],[new Nn(0,0),new Nn(Jn,Jn)],o.tileID.canonical).map(Ee=>Ee.polygon).flat());const ie=$?x:null,[ae,be]=(Le=u,Oe=O,qe=D,rt=T,ht=v,It=ie,At=z,Kt=K,fn=g.center.lat,"globe"===(Ee=g).projection.name?function(Dt,Bt,an,Mn,on,ri,Kn,bn,Hi,Ei,hi){const xn=[],ki=[],_r=Dt.projection.upVectorScale(hi,Dt.center.lat,Dt.worldSize).metersToTile,zi=[0,0,0,1],Cr=[0,0,0,1],ur=(Ar,lo,hs,ns)=>{Ar[0]=lo,Ar[1]=hs,Ar[2]=ns,Ar[3]=1},Yr=PT();an>0&&(an+=Yr),Mn+=Yr;for(const Ar of Bt){const lo=[],hs=[];for(const ns of Ar){const Fs=ns.x+on.x,ds=ns.y+on.y,et=Dt.projection.projectTilePoint(Fs,ds,hi),Qs=Dt.projection.upVector(hi,ns.x,ns.y);let ma=an,vl=Mn;if(Kn){const wr=ow(Fs,ds,an,Mn,Kn,bn,Hi,Ei);ma+=wr.base,vl+=wr.top}0!==an?ur(zi,et.x+Qs[0]*_r*ma,et.y+Qs[1]*_r*ma,et.z+Qs[2]*_r*ma):ur(zi,et.x,et.y,et.z),ur(Cr,et.x+Qs[0]*_r*vl,et.y+Qs[1]*_r*vl,et.z+Qs[2]*_r*vl),p.N.transformMat4(zi,zi,ri),p.N.transformMat4(Cr,Cr,ri),lo.push(new Wv(zi[0],zi[1],zi[2])),hs.push(new Wv(Cr[0],Cr[1],Cr[2]))}xn.push(lo),ki.push(hs)}return[xn,ki]}(Ee,Le,Oe,qe,rt,ht,It,At,Kt,fn,o.tileID.canonical):It?function(Dt,Bt,an,Mn,on,ri,Kn,bn,Hi){const Ei=[],hi=[],xn=[0,0,0,1];for(const ki of Dt){const _r=[],zi=[];for(const Cr of ki){const ur=Cr.x+Mn.x,Yr=Cr.y+Mn.y,Ar=ow(ur,Yr,Bt,an,ri,Kn,bn,Hi);xn[0]=ur,xn[1]=Yr,xn[2]=Ar.base,xn[3]=1,p.a7.transformMat4(xn,xn,on),xn[3]=Math.max(xn[3],1e-5);const lo=new Wv(xn[0]/xn[3],xn[1]/xn[3],xn[2]/xn[3]);xn[0]=ur,xn[1]=Yr,xn[2]=Ar.top,xn[3]=1,p.a7.transformMat4(xn,xn,on),xn[3]=Math.max(xn[3],1e-5);const hs=new Wv(xn[0]/xn[3],xn[1]/xn[3],xn[2]/xn[3]);_r.push(lo),zi.push(hs)}Ei.push(_r),hi.push(zi)}return[Ei,hi]}(Le,Oe,qe,rt,ht,It,At,Kt,fn):function(Dt,Bt,an,Mn,on){const ri=[],Kn=[],bn=on[8]*Bt,Hi=on[9]*Bt,Ei=on[10]*Bt,hi=on[11]*Bt,xn=on[8]*an,ki=on[9]*an,_r=on[10]*an,zi=on[11]*an;for(const Cr of Dt){const ur=[],Yr=[];for(const Ar of Cr){const lo=Ar.x+Mn.x,hs=Ar.y+Mn.y,ns=on[0]*lo+on[4]*hs+on[12],Fs=on[1]*lo+on[5]*hs+on[13],ds=on[2]*lo+on[6]*hs+on[14],et=on[3]*lo+on[7]*hs+on[15],Qs=ns+bn,ma=Fs+Hi,vl=ds+Ei,wr=Math.max(et+hi,1e-5),Er=ns+xn,ho=Fs+ki,Rl=ds+_r,Ol=Math.max(et+zi,1e-5);ur.push(new Wv(Qs/wr,ma/wr,vl/wr)),Yr.push(new Wv(Er/Ol,ho/Ol,Rl/Ol))}ri.push(ur),Kn.push(Yr)}return[ri,Kn]}(Le,Oe,qe,rt,ht)),Ce=o.queryGeometry;var Ee,Le,Oe,qe,rt,ht,It,At,Kt,fn;return function(Ee,Le,Oe){let qe=1/0;wc(Oe,Le)&&(qe=Xv(Oe,Le[0]));for(let rt=0;rt<Le.length;rt++){const ht=Le[rt],It=Ee[rt];for(let At=0;At<ht.length-1;At++){const Kt=ht[At],fn=[Kt,ht[At+1],It[At+1],It[At],Kt];Si(Oe,fn)&&(qe=Math.min(qe,Xv(Oe,fn)))}}return qe!==1/0&&qe}(ae,be,Ce.isPointQuery()?Ce.screenBounds:Ce.screenGeometry)}},line:class extends Vc{constructor(o,r,a){super(o,VT,r,a),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(o){if("line-gradient"===o){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof Cp,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(o,r){super.recalculate(o,r),this.paint._values["line-floorwidth"]=z_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new lw(o)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(o,r){const a=ao(this);return{config:new te(this,r),defines:a,overrideFog:!1}}queryRadius(o){const r=o,a=Wh(Am("line-width",this,r),Am("line-gap-width",this,r)),u=Am("line-offset",this,r);return a/2+Math.abs(u)+bv(this.paint.get("line-translate"))}queryIntersectsFeature(o,r,a,u,f,g){if(o.queryGeometry.isAboveHorizon)return!1;const v=WA(o.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),x=o.pixelToTileUnitsFactor/2*Wh(this.paint.get("line-width").evaluate(r,a),this.paint.get("line-gap-width").evaluate(r,a)),S=this.paint.get("line-offset").evaluate(r,a);return S&&(u=function(T,D){const O=[],z=new Nn(0,0);for(let $=0;$<T.length;$++){const K=T[$],X=[];for(let ie=0;ie<K.length;ie++){const ae=K[ie],be=K[ie+1],Ce=0===ie?z:ae.sub(K[ie-1])._unit()._perp(),Ee=ie===K.length-1?z:be.sub(ae)._unit()._perp(),Le=Ce._add(Ee)._unit();Le._mult(1/(Le.x*Ee.x+Le.y*Ee.y)),X.push(Le._mult(D)._add(ae))}O.push(X)}return O}(u,S*o.pixelToTileUnitsFactor)),function(T,D,O){for(let z=0;z<D.length;z++){const $=D[z];if(T.length>=3)for(let K=0;K<$.length;K++)if(Fu(T,$[K]))return!0;if(Va(T,$,O))return!0}return!1}(v,u,x)}isTileClipped(){return!0}},symbol:xw,background:class extends Vc{constructor(o,r,a){super(o,p5,r,a)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(o,r){return{overrideFog:!1}}},raster:_I,"raster-particle":C2,sky:class extends Vc{constructor(o,r,a){super(o,vI,r,a),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"sky-gradient"===o?this._updateColorRamp():"sky-atmosphere-sun"!==o&&"sky-atmosphere-halo-color"!==o&&"sky-atmosphere-color"!==o&&"sky-atmosphere-sun-intensity"!==o||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Ub({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(o){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=o.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}return!1}getCenter(o,r){if("atmosphere"===this.paint.get("sky-type")){const u=this.paint.get("sky-atmosphere-sun"),f=!u,g=o.style.light,v=g.properties.get("position");return f&&"viewport"===g.properties.get("anchor")&&$o("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?Ew(v.azimuthal,90-v.polar,r):Ew(u[0],90-u[1],r)}const a=this.paint.get("sky-gradient-center");return Ew(a[0],90-a[1],r)}isSky(){return!0}markSkyboxValid(o){this._skyboxInvalidated=!1,this._lightPosition=o.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const o=this.paint.get("sky-type");return"atmosphere"===o?["skyboxCapture","skybox"]:"gradient"===o?["skyboxGradient"]:null}},slot:class extends Vc{constructor(o,r,a){super(o,v5,r)}},model:class extends Vc{constructor(o,r,a){super(o,DI,r,a),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(o){return new S2(o)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(o){return o instanceof Ow?Jn-1:0}queryIntersectsFeature(o,r,a,u,f,g){if(!this.modelManager)return!1;const v=this.modelManager,x=o.tile.getBucket(this);if(!(x&&x instanceof S2))return!1;const S=x;for(const T in S.instancesPerModel){const D=S.instancesPerModel[T];if(D.idToFeaturesIndex.hasOwnProperty(r.id)){const O=D.features[D.idToFeaturesIndex[r.id]],z=v.getModel(T,this.scope);if(!z)return!1;let $=p.a6.create();const K=new ct(0,0),X=S.canonical;let ie=Number.MAX_VALUE;for(let ae=0;ae<O.instancedDataCount;++ae){const be=16*(O.instancedDataOffset+ae),Ce=D.instancedDataArray.float32,Ee=[Ce[be+4],Ce[be+5],Ce[be+6]];k2(X,K,Ce[be],0|Ce[be+1]),E5($,z,g,K,O.rotation,O.scale,Ee,!1,!1,!1),"globe"===g.projection.name&&($=E2($,g));const Le=p.a6.multiply([],g.projMatrix,$),Oe=o.queryGeometry,qe=EI(Oe.isPointQuery()?Oe.screenBounds:Oe.screenGeometry,g,Le,z.aabb);null!=qe&&(ie=Math.min(qe,ie))}return ie!==Number.MAX_VALUE&&ie}}return!1}_handleOverridablePaintPropertyUpdate(o,r,a){return!(!this.layout||r.isDataDriven()||a.isDataDriven()||"model-color"!==o&&"model-color-mix-intensity"!==o&&"model-rotation"!==o&&"model-scale"!==o&&"model-translation"!==o&&"model-emissive-strength"!==o)}_isPropertyZoomDependent(o){const r=this._transitionablePaint._values[o];return null!=r&&null!=r.value&&null!=r.value.expression&&r.value.expression instanceof $g}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(o,r,a,u){const f=o.tile,g=f.getBucket(this);let v=null,x=Number.MAX_VALUE;if(!(g&&g instanceof Ow))return{queryFeature:v,intersectionZ:x};const S=g.getNodesInfo()[r];if(S.hiddenByReplacement||!S.node.meshes||!a.filter(new uo(f.tileID.overscaledZ),S.feature,f.tileID.canonical))return{queryFeature:v,intersectionZ:x};const T=S.node,D=u.calculatePosMatrix(f.tileID.toUnwrapped(),u.worldSize),O=S.evaluatedScale;let z=0;u.elevation&&T.elevation&&(z=T.elevation*u.elevation.exaggeration()),p.a6.translate(D,D,[(T.anchor?T.anchor[0]:0)*(O[0]-1),(T.anchor?T.anchor[1]:0)*(O[1]-1),z]),p.a6.scale(D,D,O),p.a6.multiply(D,D,T.matrix);const $=o.queryGeometry,K=$.isPointQuery()?$.screenBounds:$.screenGeometry,X=function(ae){const be=p.a6.multiply([],D,ae.matrix),Ce=p.a6.multiply(be,u.expandedFarZProjMatrix,be);for(let Ee=0;Ee<ae.meshes.length;++Ee){const Le=ae.meshes[Ee];if(Ee===ae.lightMeshIndex)continue;const Oe=EI(K,u,Ce,Le.aabb);null!=Oe&&(x=Math.min(Oe,x))}if(ae.children)for(const Ee of ae.children)X(Ee)};if(X(T),x===Number.MAX_VALUE)return{queryFeature:v,intersectionZ:x};const ie=new ct(0,0);return k2(f.tileID.canonical,ie,S.node.anchor[0],S.node.anchor[1]),v={type:"Feature",geometry:{type:"Point",coordinates:[ie.lng,ie.lat]},properties:S.feature.properties,id:S.feature.id,state:{},layer:this.serialize()},{queryFeature:v,intersectionZ:x}}}},mr={read:function(o,r){return o.readFields(mr._readField,{header_length:0,x:0,y:0,z:0,layers:[]},r)},_readField:function(o,r,a){1===o?r.header_length=a.readFixed32():2===o?r.x=a.readVarint():3===o?r.y=a.readVarint():4===o?r.z=a.readVarint():5===o&&r.layers.push(mr.Layer.read(a,a.readVarint()+a.pos))},PixelFormat:{PIXEL_FORMAT_UNKNOWN:{value:0,options:{}},PIXEL_FORMAT_UINT32:{value:1,options:{}},PIXEL_FORMAT_UINT16:{value:2,options:{}},PIXEL_FORMAT_UINT8:{value:3,options:{}}},Filter:{}};mr.Filter.read=function(o,r){return o.readFields(mr.Filter._readField,{delta_filter:null,filter:null,zigzag_filter:null,bitshuffle_filter:null,byteshuffle_filter:null},r)},mr.Filter._readField=function(o,r,a){1===o?(r.delta_filter=mr.Filter.Delta.read(a,a.readVarint()+a.pos),r.filter="delta_filter"):2===o?(r.zigzag_filter=mr.Filter.Zigzag.read(a,a.readVarint()+a.pos),r.filter="zigzag_filter"):3===o?(r.bitshuffle_filter=mr.Filter.BitShuffle.read(a,a.readVarint()+a.pos),r.filter="bitshuffle_filter"):4===o&&(r.byteshuffle_filter=mr.Filter.ByteShuffle.read(a,a.readVarint()+a.pos),r.filter="byteshuffle_filter")},mr.Filter.Delta={},mr.Filter.Delta.read=function(o,r){return o.readFields(mr.Filter.Delta._readField,{block_size:0},r)},mr.Filter.Delta._readField=function(o,r,a){1===o&&(r.block_size=a.readVarint())},mr.Filter.Zigzag={},mr.Filter.Zigzag.read=function(o,r){return o.readFields(mr.Filter.Zigzag._readField,{},r)},mr.Filter.Zigzag._readField=function(o,r,a){},mr.Filter.BitShuffle={},mr.Filter.BitShuffle.read=function(o,r){return o.readFields(mr.Filter.BitShuffle._readField,{},r)},mr.Filter.BitShuffle._readField=function(o,r,a){},mr.Filter.ByteShuffle={},mr.Filter.ByteShuffle.read=function(o,r){return o.readFields(mr.Filter.ByteShuffle._readField,{},r)},mr.Filter.ByteShuffle._readField=function(o,r,a){},mr.Codec={},mr.Codec.read=function(o,r){return o.readFields(mr.Codec._readField,{gzip_data:null,codec:null,jpeg_image:null,webp_image:null,png_image:null},r)},mr.Codec._readField=function(o,r,a){1===o?(r.gzip_data=mr.Codec.GzipData.read(a,a.readVarint()+a.pos),r.codec="gzip_data"):2===o?(r.jpeg_image=mr.Codec.JpegImage.read(a,a.readVarint()+a.pos),r.codec="jpeg_image"):3===o?(r.webp_image=mr.Codec.WebpImage.read(a,a.readVarint()+a.pos),r.codec="webp_image"):4===o&&(r.png_image=mr.Codec.PngImage.read(a,a.readVarint()+a.pos),r.codec="png_image")},mr.Codec.GzipData={},mr.Codec.GzipData.read=function(o,r){return o.readFields(mr.Codec.GzipData._readField,{},r)},mr.Codec.GzipData._readField=function(o,r,a){},mr.Codec.JpegImage={},mr.Codec.JpegImage.read=function(o,r){return o.readFields(mr.Codec.JpegImage._readField,{},r)},mr.Codec.JpegImage._readField=function(o,r,a){},mr.Codec.WebpImage={},mr.Codec.WebpImage.read=function(o,r){return o.readFields(mr.Codec.WebpImage._readField,{},r)},mr.Codec.WebpImage._readField=function(o,r,a){},mr.Codec.PngImage={},mr.Codec.PngImage.read=function(o,r){return o.readFields(mr.Codec.PngImage._readField,{},r)},mr.Codec.PngImage._readField=function(o,r,a){},mr.DataIndexEntry={},mr.DataIndexEntry.read=function(o,r){return o.readFields(mr.DataIndexEntry._readField,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},r)},mr.DataIndexEntry._readField=function(o,r,a){1===o?r.first_byte=a.readFixed64():2===o?r.last_byte=a.readFixed64():3===o?r.filters.push(mr.Filter.read(a,a.readVarint()+a.pos)):4===o?r.codec=mr.Codec.read(a,a.readVarint()+a.pos):5===o?r.offset=a.readFloat():6===o?r.scale=a.readFloat():7===o&&r.bands.push(a.readString())},mr.Layer={},mr.Layer.read=function(o,r){return o.readFields(mr.Layer._readField,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},r)},mr.Layer._readField=function(o,r,a){1===o?r.version=a.readVarint():2===o?r.name=a.readString():3===o?r.units=a.readString():4===o?r.tilesize=a.readVarint():5===o?r.buffer=a.readVarint():6===o?r.pixel_format=a.readVarint():7===o&&r.data_index.push(mr.DataIndexEntry.read(a,a.readVarint()+a.pos))};const En={read:function(o,r){return o.readFields(En._readField,{uint32_values:null,values:null,fixed32_values:null},r)},_readField:function(o,r,a){2===o?(r.uint32_values=En.Uint32Values.read(a,a.readVarint()+a.pos),r.values="uint32_values"):3===o&&(r.fixed32_values=En.Fixed32Values.read(a,a.readVarint()+a.pos),r.values="fixed32_values")},Uint32Values:{}};En.Uint32Values.read=function(o,r){return o.readFields(En.Uint32Values._readField,{values:[]},r)},En.Uint32Values._readField=function(o,r,a){1===o&&(r.readValuesInto=function(u){if(2!==u.type)throw new Error(`Unsupported pbf type "${u.type}"`);const f=2===(v=u).type?v.readVarint()+v.pos:v.pos+1,g=u.pos;var v;return u.pos=f,function(v){u.pos=g;let x=0;for(;u.pos<f;){const S=u.readVarint();v[x++]=S}return v}}(a))},En.Fixed32Values={},En.Fixed32Values.read=function(o,r){return o.readFields(En.Fixed32Values._readField,{values:[]},r)},En.Fixed32Values._readField=function(o,r,a){throw new Error("Not implemented")};class jI{constructor(r=0,a=0,u=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=r,this.resetTtl=u,this.size=0,this.ttl=a}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(r){if(this.has(r)){const a=this.items[r];delete this.items[r],this.size--,null!==a.prev&&(a.prev.next=a.next),null!==a.next&&(a.next.prev=a.prev),this.first===a&&(this.first=a.next),this.last===a&&(this.last=a.prev)}return this}entries(r=this.keys()){return r.map(a=>[a,this.get(a)])}evict(r=!1){if(r||this.size>0){const a=this.first;delete this.items[a.key],0==--this.size?(this.first=null,this.last=null):(this.first=a.next,this.first.prev=null)}return this}expiresAt(r){let a;return this.has(r)&&(a=this.items[r].expiry),a}get(r){let a;if(this.has(r)){const u=this.items[r];this.ttl>0&&u.expiry<=Date.now()?this.delete(r):(a=u.value,this.set(r,a,!0))}return a}has(r){return r in this.items}keys(){const r=[];let a=this.first;for(;null!==a;)r.push(a.key),a=a.next;return r}set(r,a,u=!1,f=this.resetTtl){let g;if(u||this.has(r)){if(g=this.items[r],g.value=a,!1===u&&f&&(g.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.last!==g){const v=this.last,x=g.next,S=g.prev;this.first===g&&(this.first=g.next),g.next=null,g.prev=this.last,v.next=g,null!==S&&(S.next=x),null!==x&&(x.prev=S)}}else this.max>0&&this.size===this.max&&this.evict(!0),g=this.items[r]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:r,prev:this.last,next:null,value:a},1==++this.size?this.first=g:this.last.next=g;return this.last=g,this}values(r=this.keys()){return r.map(a=>this.get(a))}}function GI(o,r){if(4!==r.length)throw new Error(`Expected data of dimension 4 but got ${r.length}.`);let a=r[3];for(let u=2;u>=1;u--){const f=1===u?1:0,g=2===u?1:0;for(let v=0;v<r[0];v++){const x=r[1]*v;for(let S=f;S<r[1];S++){const T=r[2]*(S+x);for(let D=g;D<r[2];D++){const O=r[3]*(D+T);for(let z=0;z<r[3];z++){const $=O+z;o[$]+=o[$-a]}}}}a*=r[u]}return o}function k5(o){for(let r=0,a=o.length;r<a;r++)o[r]=o[r]>>>1^-(1&o[r]);return o}function P5(o,r){switch(r){case"uint32":return o;case"uint16":for(let a=0;a<o.length;a+=2){const u=o[a],f=o[a+1];o[a]=(240&u)>>4|(61440&u)>>8|(240&f)<<4|61440&f,o[a+1]=15&u|(3840&u)>>4|(15&f)<<8|(3840&f)<<4}return o;case"uint8":for(let a=0;a<o.length;a+=4){const u=o[a],f=o[a+1],g=o[a+2],v=o[a+3];o[a+0]=(192&u)>>6|(192&f)>>4|(192&g)>>2|192&v,o[a+1]=(48&u)>>4|(48&f)>>2|48&g|(48&v)<<2,o[a+2]=(12&u)>>2|12&f|(12&g)<<2|(12&v)<<4,o[a+3]=3&u|(3&f)<<2|(3&g)<<4|(3&v)<<6}return o;default:throw new Error(`Invalid pixel format, "${r}"`)}}class Bm extends Error{constructor(r){super(r),this.name="MRTError"}}var ws=Uint8Array,st=Uint16Array,P2=Int32Array,$I=new ws([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),pe=new ws([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ye=new ws([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),oi=function(o,r){for(var a=new st(31),u=0;u<31;++u)a[u]=r+=1<<o[u-1];var f=new P2(a[30]);for(u=1;u<30;++u)for(var g=a[u];g<a[u+1];++g)f[g]=g-a[u]<<5|u;return{b:a,r:f}},N2=oi($I,2),qI=N2.b,N5=N2.r;qI[28]=258,N5[258]=28;for(var L5=oi(pe,0).b,Sy=new st(32768),ga=0;ga<32768;++ga){var t0=(43690&ga)>>1|(21845&ga)<<1;Sy[ga]=((65280&(t0=(61680&(t0=(52428&t0)>>2|(13107&t0)<<2))>>4|(3855&t0)<<4))>>8|(255&t0)<<8)>>1}var Ty=function(o,r,a){for(var u=o.length,f=0,g=new st(r);f<u;++f)o[f]&&++g[o[f]-1];var v,x=new st(r);for(f=1;f<r;++f)x[f]=x[f-1]+g[f-1]<<1;if(a){v=new st(1<<r);var S=15-r;for(f=0;f<u;++f)if(o[f])for(var T=f<<4|o[f],D=r-o[f],O=x[o[f]-1]++<<D,z=O|(1<<D)-1;O<=z;++O)v[Sy[O]>>S]=T}else for(v=new st(u),f=0;f<u;++f)o[f]&&(v[f]=Sy[x[o[f]-1]++]>>15-o[f]);return v},y1=new ws(288);for(ga=0;ga<144;++ga)y1[ga]=8;for(ga=144;ga<256;++ga)y1[ga]=9;for(ga=256;ga<280;++ga)y1[ga]=7;for(ga=280;ga<288;++ga)y1[ga]=8;var KI=new ws(32);for(ga=0;ga<32;++ga)KI[ga]=5;var xr=Ty(y1,9,1),v1=Ty(KI,5,1),kw=function(o){for(var r=o[0],a=1;a<o.length;++a)o[a]>r&&(r=o[a]);return r},Tt=function(o,r,a){var u=r/8|0;return(o[u]|o[u+1]<<8)>>(7&r)&a},Pw=function(o,r){var a=r/8|0;return(o[a]|o[a+1]<<8|o[a+2]<<16)>>(7&r)},U5=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],df=function(o,r,a){var u=new Error(r||U5[o]);if(u.code=o,Error.captureStackTrace&&Error.captureStackTrace(u,df),!a)throw u;return u},WI=new ws(0),ZI=typeof TextDecoder<"u"&&new TextDecoder;try{ZI.decode(WI,{stream:!0})}catch{}const dn={gzip_data:"gzip"},z5={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Nw={uint32:1,uint16:2,uint8:4},Lw={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};class Uw{constructor(r=1){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=r}getLayer(r){return this.layers[r]}getHeaderLength(r){const a=new Uint8Array(r),u=new DataView(r);if(13!==a[0])throw new Bm("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(r){const a=new Uint8Array(r),u=this.getHeaderLength(r);if(a.length<u)throw new Bm(`Expected header with length >= ${u} but got buffer of length ${a.length}`);const f=new H_(a.subarray(0,u)),g=mr.read(f);if(!isNaN(this.x)&&(this.x!==g.x||this.y!==g.y||this.z!==g.z))throw new Bm(`Invalid attempt to parse header ${g.z}/${g.x}/${g.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=g.x,this.y=g.y,this.z=g.z;for(const v of g.layers)this.layers[v.name]=new zw(v,{cacheSize:this._cacheSize});return this}createDecodingTask(r){const a=[],u=this.getLayer(r.layerName);for(let f=0;f<u.dataIndex.length;f++){const g=u.dataIndex[f],v=g.first_byte-r.firstByte,x=g.last_byte+1-r.firstByte;if(f<r.firstBlock||f>r.lastBlock||u._blocksInProgress.has(f))continue;const S={layerName:u.name,firstByte:v,lastByte:x,pixelFormat:u.pixelFormat,blockIndex:f,blockShape:[g.bands.length].concat(u.bandShape),buffer:u.buffer,codec:g.codec.codec,filters:g.filters.map(T=>T.filter)};u._blocksInProgress.add(f),a.push(S)}return new L2(a,()=>{a.forEach(f=>u._blocksInProgress.delete(f.blockIndex))},(f,g)=>{if(a.forEach(v=>u._blocksInProgress.delete(v.blockIndex)),f)throw f;g.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class zw{constructor({version:r,name:a,units:u,tilesize:f,pixel_format:g,buffer:v,data_index:x},S){if(this.version=r,1!==this.version)throw new Bm(`Cannot parse raster layer encoded with MRT version ${r}`);this.name=a,this.units=u,this.tileSize=f,this.buffer=v,this.pixelFormat=z5[g],this.dataIndex=x,this.bandShape=[f+2*v,f+2*v,Nw[this.pixelFormat]],this._decodedBlocks=function(T=1e3,D=0,O=!1){if(isNaN(T)||T<0)throw new TypeError("Invalid max value");if(isNaN(D)||D<0)throw new TypeError("Invalid ttl value");if("boolean"!=typeof O)throw new TypeError("Invalid resetTtl value");return new jI(T,D,O)}(S?S.cacheSize:5),this._blocksInProgress=new Set}processDecodedData(r){const a=r.blockIndex.toString();this._decodedBlocks.get(a)||this._decodedBlocks.set(a,r.data)}getBlockForBand(r){let a=0;switch(typeof r){case"string":for(const[u,f]of this.dataIndex.entries()){for(const[g,v]of f.bands.entries())if(v===r)return{bandIndex:a+g,blockIndex:u,blockBandIndex:g};a+=f.bands.length}break;case"number":for(const[u,f]of this.dataIndex.entries()){if(r>=a&&r<a+f.bands.length)return{bandIndex:r,blockIndex:u,blockBandIndex:r-a};a+=f.bands.length}break;default:throw new Bm(`Invalid band \`${JSON.stringify(r)}\`. Expected string or integer.`)}throw new Bm(`Band not found: ${JSON.stringify(r)}`)}getDataRange(r){let a=1/0,u=-1/0,f=1/0,g=-1/0;for(const v of r){const{blockIndex:x}=this.getBlockForBand(v);if(x<0)throw new Bm(`Invalid band: ${JSON.stringify(v)}`);const S=this.dataIndex[x];f=Math.min(f,x),g=Math.max(g,x),a=Math.min(a,S.first_byte),u=Math.max(u,S.last_byte)}return{layerName:this.name,firstByte:a,lastByte:u,firstBlock:f,lastBlock:g}}hasBand(r){const{blockIndex:a}=this.getBlockForBand(r);return a>=0}hasDataForBand(r){const{blockIndex:a}=this.getBlockForBand(r);return a>=0&&!!this._decodedBlocks.get(a.toString())}getBandView(r){const{blockIndex:a,blockBandIndex:u}=this.getBlockForBand(r),f=this._decodedBlocks.get(a.toString());if(!f)throw new Bm(`Data for band ${JSON.stringify(r)} of layer "${this.name}" not decoded.`);const g=this.dataIndex[a],v=this.bandShape.reduce((T,D)=>T*D,1),x=u*v,S=f.subarray(x,x+v);return{data:S,bytes:new Uint8Array(S.buffer).subarray(S.byteOffset,S.byteOffset+S.byteLength),tileSize:this.tileSize,buffer:this.buffer,offset:g.offset,scale:g.scale}}}class L2{constructor(r,a,u){this.tasks=r,this._onCancel=a,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(r,a){this._finalized||(this._onComplete(r,a),this._finalized=!0)}}Uw.performDecoding=function(o,r){return Promise.all(r.tasks.map(a=>{const{layerName:u,firstByte:f,lastByte:g,pixelFormat:v,blockShape:x,blockIndex:S,filters:T,codec:D}=a,O=new Uint8Array(o).subarray(f,g+1),z=new Uint32Array(x[0]*x[1]*x[2]);let $;if("gzip_data"!==D)throw new Error(`Unhandled codec: ${D}`);return $=function(K,X){if(!globalThis.DecompressionStream&&"gzip_data"===X)return Promise.resolve(((Ce=function(Oe){31==Oe[0]&&139==Oe[1]&&8==Oe[2]||df(6,"invalid gzip data");var qe=Oe[3],rt=10;4&qe&&(rt+=2+(Oe[10]|Oe[11]<<8));for(var ht=(qe>>3&1)+(qe>>4&1);ht>0;ht-=!Oe[rt++]);return rt+(2&qe)}(be=K))+8>be.length&&df(6,"invalid gzip data"),function(Oe,qe,rt,ht){var It=Oe.length;if(!It||qe.f&&!qe.l)return rt||new ws(0);var At=!rt,Kt=At||2!=qe.i,fn=qe.i;At&&(rt=new ws(3*It));var _u,yu,Sd,Ut=function(_u){var yu=rt.length;if(_u>yu){var Sd=new ws(Math.max(2*yu,_u));Sd.set(rt),rt=Sd}},Dt=qe.f||0,Bt=qe.p||0,an=qe.b||0,Mn=qe.l,on=qe.d,ri=qe.m,Kn=qe.n,bn=8*It;do{if(!Mn){Dt=Tt(Oe,Bt,1);var Hi=Tt(Oe,Bt+1,3);if(Bt+=3,!Hi){var Ei=Oe[(hs=4+((Bt+7)/8|0))-4]|Oe[hs-3]<<8,hi=hs+Ei;if(hi>It){fn&&df(0);break}Kt&&Ut(an+Ei),rt.set(Oe.subarray(hs,hi),an),qe.b=an+=Ei,qe.p=Bt=8*hi,qe.f=Dt;continue}if(1==Hi)Mn=xr,on=v1,ri=9,Kn=5;else if(2==Hi){var xn=Tt(Oe,Bt,31)+257,ki=Tt(Oe,Bt+10,15)+4,_r=xn+Tt(Oe,Bt+5,31)+1;Bt+=14;for(var zi=new ws(_r),Cr=new ws(19),ur=0;ur<ki;++ur)Cr[ye[ur]]=Tt(Oe,Bt+3*ur,7);Bt+=3*ki;var Yr=kw(Cr),Ar=(1<<Yr)-1,lo=Ty(Cr,Yr,1);for(ur=0;ur<_r;){var hs,ns=lo[Tt(Oe,Bt,Ar)];if(Bt+=15&ns,(hs=ns>>4)<16)zi[ur++]=hs;else{var Fs=0,ds=0;for(16==hs?(ds=3+Tt(Oe,Bt,3),Bt+=2,Fs=zi[ur-1]):17==hs?(ds=3+Tt(Oe,Bt,7),Bt+=3):18==hs&&(ds=11+Tt(Oe,Bt,127),Bt+=7);ds--;)zi[ur++]=Fs}}var et=zi.subarray(0,xn),Qs=zi.subarray(xn);ri=kw(et),Kn=kw(Qs),Mn=Ty(et,ri,1),on=Ty(Qs,Kn,1)}else df(1);if(Bt>bn){fn&&df(0);break}}Kt&&Ut(an+131072);for(var ma=(1<<ri)-1,vl=(1<<Kn)-1,wr=Bt;;wr=Bt){var Er=(Fs=Mn[Pw(Oe,Bt)&ma])>>4;if((Bt+=15&Fs)>bn){fn&&df(0);break}if(Fs||df(2),Er<256)rt[an++]=Er;else{if(256==Er){wr=Bt,Mn=null;break}var ho=Er-254;Er>264&&(ho=Tt(Oe,Bt,(1<<(kl=$I[ur=Er-257]))-1)+qI[ur],Bt+=kl);var Rl=on[Pw(Oe,Bt)&vl],Ol=Rl>>4;if(Rl||df(3),Bt+=15&Rl,Qs=L5[Ol],Ol>3){var kl=pe[Ol];Qs+=Pw(Oe,Bt)&(1<<kl)-1,Bt+=kl}if(Bt>bn){fn&&df(0);break}Kt&&Ut(an+131072);var _o=an+ho;if(an<Qs){var _h=0-Qs,ig=Math.min(Qs,_o);for(_h+an<0&&df(3);an<ig;++an)rt[an]=undefined[_h+an]}for(;an<_o;++an)rt[an]=rt[an-Qs]}}qe.l=Mn,qe.p=wr,qe.b=an,qe.f=Dt,Mn&&(Dt=1,qe.m=ri,qe.d=on,qe.n=Kn)}while(!Dt);return an!=rt.length&&At?(_u=rt,(null==(yu=0)||yu<0)&&(yu=0),(null==(Sd=an)||Sd>_u.length)&&(Sd=_u.length),new ws(_u.subarray(yu,Sd))):rt.subarray(0,an)}(be.subarray(Ce,-8),{i:2},new ws(((ie=be)[(ae=ie.length)-4]|ie[ae-3]<<8|ie[ae-2]<<16|ie[ae-1]<<24)>>>0))));var ie,ae,be,Ce;const Ee=dn[X];if(!Ee)throw new Error(`Unhandled codec: ${X}`);const Le=new globalThis.DecompressionStream(Ee);return new Response(new Blob([K]).stream().pipeThrough(Le)).arrayBuffer().then(Oe=>new Uint8Array(Oe))}(O,D).then(K=>{const X=En.read(new H_(K));if("uint32_values"===X.values)return X.uint32_values.readValuesInto(z),new Lw[v](z.buffer);throw new Error(`Unhandled numeric data "${X.values}"`)}),$.then(K=>{for(let X=T.length-1;X>=0;X--)switch(T[X]){case"delta_filter":GI(K,x);break;case"zigzag_filter":k5(K);break;case"bitshuffle_filter":P5(K,v);break;default:throw new Error(`Unhandled filter "${T[X]}"`)}return{layerName:u,blockIndex:S,data:K}}).catch(K=>{throw K})}))},ai(L2,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});const U2=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Vw{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,u]=new Uint8Array(r,0,2);if(219!==a)throw new Error("Data does not appear to be in a KDBush format.");const f=u>>4;if(1!==f)throw new Error(`Got v${f} data when expected v1.`);const g=U2[15&u];if(!g)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(r,2,1),[x]=new Uint32Array(r,4,1);return new Vw(x,v,g,r)}constructor(r,a=64,u=Float64Array,f){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=u,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const g=U2.indexOf(this.ArrayType),v=2*r*this.ArrayType.BYTES_PER_ELEMENT,x=r*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-x%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${u}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+x+S,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+v+x+S),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+x+S,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=r)}add(r,a){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=r,this.coords[this._pos++]=a,u}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return Hw(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,a,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:v,nodeSize:x}=this,S=[0,g.length-1,0],T=[];for(;S.length;){const D=S.pop()||0,O=S.pop()||0,z=S.pop()||0;if(O-z<=x){for(let ie=z;ie<=O;ie++){const ae=v[2*ie],be=v[2*ie+1];ae>=r&&ae<=u&&be>=a&&be<=f&&T.push(g[ie])}continue}const $=z+O>>1,K=v[2*$],X=v[2*$+1];K>=r&&K<=u&&X>=a&&X<=f&&T.push(g[$]),(0===D?r<=K:a<=X)&&(S.push(z),S.push($-1),S.push(1-D)),(0===D?u>=K:f>=X)&&(S.push($+1),S.push(O),S.push(1-D))}return T}within(r,a,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:g,nodeSize:v}=this,x=[0,f.length-1,0],S=[],T=u*u;for(;x.length;){const D=x.pop()||0,O=x.pop()||0,z=x.pop()||0;if(O-z<=v){for(let ie=z;ie<=O;ie++)V2(g[2*ie],g[2*ie+1],r,a)<=T&&S.push(f[ie]);continue}const $=z+O>>1,K=g[2*$],X=g[2*$+1];V2(K,X,r,a)<=T&&S.push(f[$]),(0===D?r-u<=K:a-u<=X)&&(x.push(z),x.push($-1),x.push(1-D)),(0===D?r+u>=K:a+u>=X)&&(x.push($+1),x.push(O),x.push(1-D))}return S}}function Hw(o,r,a,u,f,g){if(f-u<=a)return;const v=u+f>>1;z2(o,r,v,u,f,g),Hw(o,r,a,u,v-1,1-g),Hw(o,r,a,v+1,f,1-g)}function z2(o,r,a,u,f,g){for(;f>u;){if(f-u>600){const T=f-u+1,D=a-u+1,O=Math.log(T),z=.5*Math.exp(2*O/3),$=.5*Math.sqrt(O*z*(T-z)/T)*(D-T/2<0?-1:1);z2(o,r,a,Math.max(u,Math.floor(a-D*z/T+$)),Math.min(f,Math.floor(a+(T-D)*z/T+$)),g)}const v=r[2*a+g];let x=u,S=f;for(Iy(o,r,u,a),r[2*f+g]>v&&Iy(o,r,u,f);x<S;){for(Iy(o,r,x,S),x++,S--;r[2*x+g]<v;)x++;for(;r[2*S+g]>v;)S--}r[2*u+g]===v?Iy(o,r,u,S):(S++,Iy(o,r,S,f)),S<=a&&(u=S+1),a<=S&&(f=S-1)}}function Iy(o,r,a,u){Qw(o,a,u),Qw(r,2*a,2*u),Qw(r,2*a+1,2*u+1)}function Qw(o,r,a){const u=o[r];o[r]=o[a],o[a]=u}function V2(o,r,a,u){const f=o-a,g=r-u;return f*f+g*g}p.$=Zh,p.A=PA,p.B=P0,p.C=Or,p.D=bt,p.E=ld,p.F=ko,p.G=Rn,p.H=class{constructor(o){this.specification=o}possiblyEvaluate(o,r){return Eu(o.expression.evaluate(r))}interpolate(o,r,a){return{x:Fi(o.x,r.x,a),y:Fi(o.y,r.y,a),z:Fi(o.z,r.z,a),azimuthal:Fi(o.azimuthal,r.azimuthal,a),polar:Fi(o.polar,r.polar,a)}}},p.I=Aw,p.J=tf,p.K=uo,p.L=Xr,p.M=class{constructor(o,r,a,u){this.id=o,this.position=null!=r?new ct(r[0],r[1]):new ct(0,0),this.orientation=a??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new ta([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(o,r){if(p.a6.multiply(o.matrix,r,o.matrix),o.meshes)for(const a of o.meshes){const u=ta.applyTransform(a.aabb,o.matrix);this.aabb.encapsulate(u)}if(o.children)for(const a of o.children)this._applyTransformations(a,o.matrix)}computeBoundsAndApplyParent(){const o=p.a6.identity([]);for(const r of this.nodes)this._applyTransformations(r,o)}computeModelMatrix(o,r,a,u,f,g,v=!1){E5(this.matrix,this,o.transform,this.position,r,a,u,f,g,v)}upload(o){if(!this.uploaded){for(const r of this.nodes)MI(r,o);for(const r of this.nodes)W_(r);this.uploaded=!0}}destroy(){for(const o of this.nodes)T2(o)}},p.O=Od,p.P=Nn,p.Q=LA,p.R=zl,p.S=gm,p.T=q_,p.U=Fi,p.V=Jn,p.W=Bi,p.X=class{constructor(o){this.specification=o}possiblyEvaluate(o,r){return function([a,u]){const f=Eu([1,a,u]);return{x:f.x,y:f.y,z:f.z}}(o.expression.evaluate(r))}interpolate(o,r,a){return{x:Fi(o.x,r.x,a),y:Fi(o.y,r.y,a),z:Fi(o.z,r.z,a)}}},p.Y=function(o,r,a=0,u=!0){const f=new Nn(a,a),g=o.sub(f),v=r.add(f),x=[g,new Nn(v.x,g.y),v,new Nn(g.x,v.y)];return u&&x.push(g.clone()),x},p.Z=$g,p._=function(o,r){const a=[];for(let u=0;u<o.length;u++){const f=Xu(u-1,-1,o.length-1),g=Xu(u+1,-1,o.length-1),v=o[u],x=o[g],S=o[f].sub(v).unit(),T=x.sub(v).unit(),D=T.angleWithSep(S.x,S.y),O=S.add(T).unit().mult(-1*r/Math.sin(D/2));a.push(v.add(O))}return a},p.a=e_,p.a$=function(o){const r=[];for(const a in o)r.push(o[a]);return r},p.a0=vC,p.a1=function(o,r,a=0){return p.N.fromValues(((r.x-a)*o.scale-o.x)*Jn,(r.y*o.scale-o.y)*Jn,qs(r.z,r.y))},p.a2=Kp,p.a3=Yv,p.a4=function(o){let r=1/0,a=1/0,u=-1/0,f=-1/0;for(const g of o)r=Math.min(r,g.x),a=Math.min(a,g.y),u=Math.max(u,g.x),f=Math.max(f,g.y);return{min:new Nn(r,a),max:new Nn(u,f)}},p.a5=gr,p.a8=Fu,p.a9=zr,p.aA=Nh,p.aB=zo,p.aC=kd,p.aD=Qn,p.aE=u1,p.aF=function(){$l.isLoading()||$l.isLoaded()||"deferred"!==Vh()||Pi()},p.aG=du,p.aH=fa,p.aI=HI,p.aJ=zt,p.aK=lw,p.aL=WC,p.aM=oo,p.aN=Hs,p.aO=GA,p.aP=kC,p.aQ=jb,p.aR=yy,p.aS=function(o,r){const a=gm(r.zoom);if(0===a)return tA(o);const u=Ov(o),f=LC(u),g=gr(u.getWest())*r.worldSize,v=gr(u.getEast())*r.worldSize,x=Ki(u.getNorth())*r.worldSize,S=Ki(u.getSouth())*r.worldSize,T=[g,x,0],D=[v,x,0],O=[g,S,0],z=[v,S,0],$=p.a6.invert([],r.globeMatrix);return p.N.transformMat4(T,T,$),p.N.transformMat4(D,D,$),p.N.transformMat4(O,O,$),p.N.transformMat4(z,z,$),f[0]=nA(f[0],O,a),f[1]=nA(f[1],z,a),f[2]=nA(f[2],D,a),f[3]=nA(f[3],T,a),ta.fromPoints(f)},p.aT=Pv,p.aU=kv,p.aV=nA,p.aW=Al,p.aX=OC,p.aY=ru,p.aZ=Uw,p.a_=Jt,p.aa=ir,p.ab=xe,p.ac=function(o,r){const a={};for(let u=0;u<r.length;u++){const f=r[u];f in o&&(a[f]=o[f])}return a},p.ad=St,p.ae=Ki,p.af=class{constructor(o){this.entries={},this.scheduler=o}request(o,r,a,u){const f=this.entries[o]=this.entries[o]||{callbacks:[]};if(f.result){const[g,v]=f.result;return this.scheduler?this.scheduler.add(()=>{u(g,v)},r):u(g,v),()=>{}}return f.callbacks.push(u),f.cancel||(f.cancel=a((g,v)=>{f.result=[g,v];for(const x of f.callbacks)this.scheduler?this.scheduler.add(()=>{x(g,v)},r):x(g,v);setTimeout(()=>delete this.entries[o],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(g=>g!==u),f.callbacks.length||(f.cancel(),delete this.entries[o]))}}},p.ag=sm,p.ah=function(o,r,a){const u=JSON.stringify(o.request);return o.data&&(this.deduped.entries[u]={result:[null,o.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom},f=>{const g=Jt(o.request,(v,x,S,T)=>{v?f(v):x&&f(null,{vectorTile:a?void 0:new Kb(new H_(x)),rawData:x,cacheControl:S,expires:T})});return()=>{g.cancel(),f()}},r)},p.ai=function(o){as++,as>jn&&(o.getActor().send("enforceCacheSizeLimit",Vt),as=0)},p.aj=qo,p.ak=tn,p.al=function(o){return o<=1?1:Math.pow(2,Math.floor(Math.log(o)/Math.LN2))},p.am=Cn,p.an=_I,p.ao=C2,p.ap=x2,p.aq=function(o,r){const a=document.createElement("video");a.muted=!0,a.onloadstart=function(){r(null,a)};for(let u=0;u<o.length;u++){const f=document.createElement("source");Wt(o[u])||(a.crossOrigin="Anonymous"),f.src=o[u],a.appendChild(f)}return{cancel:()=>{}}},p.ar=h1,p.as=o1,p.at=rr,p.au=kr,p.av=Hc,p.aw=el,p.ax=so,p.ay=bs,p.az=Au,p.b=Ud,p.b$=Jg,p.b0=function(o,r){const a=[];for(const u in o)u in r||a.push(u);return a},p.b1=Hr,p.b2=["type","source","source-layer","minzoom","maxzoom","filter","layout"],p.b3=function(o,r){const{x:a,y:u}=o.point,f=aT(a,u,o.worldSize/o._pixelsPerMercatorPixel,0,0);return p.a6.multiply(f,f,J0(tA(r)))},p.b5=cy,p.b6=Xc,p.b7=e1,p.b8=function(o,r,a,u,f){const g=5*r+2;o.float32[g+0]=a,o.float32[g+1]=u,o.float32[g+2]=f},p.b9=v2,p.bA=Sw,p.bB=bI,p.bC=function(o){const r=bI(o,!0);return p.b4.invert([],[r[0],r[1],r[4],r[5]])},p.bD=Ob,p.bE=function(o){const{x:r,y:a}=o.point,{lng:u,lat:f}=o._center;return aT(r,a,o.worldSize,u,f)},p.bF=Jo,p.bG=Be,p.bH=function(o){const r=Math.round((o+45+360)%360/90)%4;return EA[r]},p.bI=45,p.bJ=ci,p.bK=y,p.bL=bd,p.bM=w_,p.bN=Bl,p.bO=Yf,p.bP=_,p.bQ=function(o,r,a){const u=Math.sqrt(o*o+r*r+a*a),f=u>0?Math.acos(a/u)*od:0;let g=0!==o||0!==r?Math.atan2(-r,-o)*od+90:0;return g<0&&(g+=360),[u,g,f]},p.bR=br,p.bS=ta,p.bT=Eu,p.bU=function(o){return[Math.pow(o[0],1/2.2),Math.pow(o[1],1/2.2),Math.pow(o[2],1/2.2)]},p.bV=function(o){return o({pluginStatus:vc,pluginURL:zh}),tm.on("pluginStateChange",o),o},p.bW=hf,p.bX=To,p.bY=Ve,p.bZ=pw,p.b_=ha,p.ba=a5,p.bb=Si,p.bc=xc,p.bd=rI,p.be=_2,p.bf=fw,p.bg=Vw,p.bh=Xu,p.bj=Sr,p.bk=Re,p.bl=lr,p.bm=function(o,r,a){o[4*r+0]=a[0],o[4*r+1]=a[1],o[4*r+2]=a[2],o[4*r+3]=a[3]},p.bn=ct,p.bo=y2,p.bp=Tn,p.bq=RC,p.br=vy,p.bs=An,p.bt=oT,p.bu=function(o,r,a,u,f,g,v,x,S){if("globe"===S.name)return oT(o,r,new An(a,u,f),!1);const T=o1({z:a,x:u,y:f},S);return new ta([(g+T.x/T.scale)*r,r*(T.y/T.scale),v],[(g+T.x2/T.scale)*r,r*(T.y2/T.scale),x])},p.bv=function(o,r,a){let u=0;for(let f=0;f<2;++f){const g=a?a[f]:0;o[f]>g&&(u+=(o[f]-g)*(o[f]-g)),r[f]<g&&(u+=(g-r[f])*(g-r[f]))}return u},p.bw=Fr,p.bx=ge,p.by=function(o){const r=p.a6.identity(new Float64Array(16));p.a6.multiply(r,o.pixelMatrix,o.globeMatrix);const a=[0,nt,0],u=[0,dt,0];return p.N.transformMat4(a,a,r),p.N.transformMat4(u,u,r),[a[0]>0&&a[0]<=o.width&&a[1]>0&&a[1]<=o.height&&!zC(o,new ct(o.center.lat,90)),u[0]>0&&u[0]<=o.width&&u[1]>0&&u[1]<=o.height&&!zC(o,new ct(o.center.lat,-90))]},p.bz=function(o,r){const{scale:a}=o.tileTransform,u=a*Jn/(o.tileSize*Math.pow(2,r.zoom-o.tileID.overscaledZ+o.tileID.canonical.z));return p.b4.scale(new Float32Array(4),r.inverseAdjustmentMatrix,[u,u])},p.c=Mw,p.c$=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},p.c0=Di,p.c1=Ht,p.c2=function(o,r,a){return"custom"===o.type?new d1(o,r):new O5[o.type](o,r,a)},p.c3=function(o){const r=o.indexOf("\x1f");return r>=0?o.slice(0,r):o},p.c4=function(o){return o.indexOf("\x1f")>=0},p.c5=function(o){const r=o.indexOf("\x1f");return r>=0?o.slice(r+1):""},p.c6=function(o){const r=[],a=o.id;return void 0===a&&r.push({message:`layers.${a}: missing required property "id"`}),void 0===o.render&&r.push({message:`layers.${a}: missing required method "render"`}),o.renderingMode&&"2d"!==o.renderingMode&&"3d"!==o.renderingMode&&r.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),r},p.c7=dc,p.c8=tm,p.c9=Zt,p.cA=ao,p.cB=(o,r,a,u,f,g)=>{const v=o.transform;return{u_matrix:U_(o,r,a,u),u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:v.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:f,u_image:0,u_tile_units_to_pixels:HT(r,v),u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:g}},p.cC=(o,r,a,u,f,g,v)=>{const x=o.transform,S=x.calculatePixelsToTileUnitsMatrix(r);return{u_matrix:U_(o,r,a,u),u_pixels_to_tile_units:S,u_device_pixel_ratio:g,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:f,u_texsize:QT(a)&&r.lineAtlasTexture?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:HT(r,o.transform),u_alpha_discard_threshold:0,u_trim_offset:v,u_emissive_strength:a.paint.get("line-emissive-strength")}},p.cD=Li,p.cE=Ub,p.cF=PT,p.cG=li,p.cH=ly,p.cI=iA,p.cJ=450,p.cK=7,p.cL=mI,p.cM=256,p.cN=J0,p.cO=nf,p.cP=um,p.cQ=function(o,r,a,u,f){return ir((o-r)/(a-r)*(f-u)+u,u,f)},p.cR=Dr,p.cS=E2,p.cT=[1,1,1],p.cU=Uu,p.cV=by,p.cW=fu,p.cX=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(o){const r=Zb(new Nn(0,0),new Nn(Jn,Jn),o),a=[];for(const u of this._activeRegions){if(u.hiddenByOverlap||!TT(r,u))continue;const f=Xb(u.min,u.max,o);a.push({min:f.min,max:f.max,sourceId:this._sourceIds[u.priority],footprint:u.footprint,footprintTileId:u.tileId})}return a}setSources(o){this._setSources(o.map(r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const a=[];for(const u of r.cache.getVisibleCoordinates()){const f=r.cache.getTile(u).buckets[r.layer];if(f)for(const g of f.getNodesInfo()){const v=g.node;v.footprint&&a.push({footprint:v.footprint,id:u.toUnwrapped()})}}return a}})))}_addSource(o){const r=o.getFootprints();if(0!==r.length){for(const a of r){if(!a.footprint)continue;const u=Zb(a.footprint.min,a.footprint.max,a.id);this._activeRegions.push({min:u.min,max:u.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:a.id,footprint:a.footprint})}this._sourceIds.push(o.getSourceId())}}_computeReplacement(){this._activeRegions.sort((r,a)=>r.priority-a.priority||ry(r.min,a.min)||ry(r.max,a.max));let o=this._activeRegions.length!==this._prevRegions.length;if(!o){let r=0,a=0;for(;!o&&r!==this._activeRegions.length;){const u=this._activeRegions[r],f=this._prevRegions[a];o=u.priority!==f.priority||!Gv(u,f),++r,++a}}if(o){++this._updateTime;const r=a=>{const u=this._activeRegions;if(a>=u.length)return a;const f=u[a].priority;for(;a<u.length&&u[a].priority===f;)++a;return a};if(this._sourceIds.length>1){let a=0,u=r(a);for(;a!==u;){let f=a;const g=a;for(;f!==u;){const v=this._activeRegions[f];v.hiddenByOverlap=!1;for(let x=0;x<g;x++){const S=this._activeRegions[x];if(!S.hiddenByOverlap&&TT(v,S)&&(v.hiddenByOverlap=O_(v.footprint,v.tileId,S.footprint,S.tileId),v.hiddenByOverlap))break}++f}a=u,u=r(a)}}}}_setSources(o){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=o.length-1;r>=0;r--)this._addSource(o[r]);this._computeReplacement()}},p.cY=class{constructor(o){this._createGrid(o),this._createPoles(o)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const o of this._poleSegments)o.destroy();for(const o of this._gridSegments)o.withSkirts.destroy(),o.withoutSkirts.destroy()}_fillGridMeshWithLods(o,r){const a=new Hs,u=new el,f=[],g=o+1+2,v=r[0]+1,x=r[0]+1+(1+r.length),S=(T,D,O)=>{let z=T===g-1?T-2:0===T?T:T-1;return z+=O?24575:0,[z,D]};for(let T=0;T<g;++T)a.emplaceBack(...S(T,0,!0));for(let T=0;T<v;++T)for(let D=0;D<g;++D)a.emplaceBack(...S(D,T,(0===D||D===g-1)&&!0));for(let T=0;T<r.length;++T){const D=r[T];for(let O=0;O<g;++O)a.emplaceBack(...S(O,D,!0))}for(let T=0;T<r.length;++T){const D=u.length,O=r[T]+1+2,z=new el;for(let X=0;X<O-1;X++){const ie=X===O-2,ae=ie?g*(x-r.length+T-X):g;for(let be=0;be<g-1;be++){const Ce=X*g+be;0===X||ie||0===be||be===g-2?(z.emplaceBack(Ce+1,Ce,Ce+ae),z.emplaceBack(Ce+ae,Ce+ae+1,Ce+1)):(u.emplaceBack(Ce+1,Ce,Ce+ae),u.emplaceBack(Ce+ae,Ce+ae+1,Ce+1))}}const $=zo.simpleSegment(0,D,a.length,u.length-D);for(let X=0;X<z.uint16.length;X+=3)u.emplaceBack(z.uint16[X],z.uint16[X+1],z.uint16[X+2]);const K=zo.simpleSegment(0,D,a.length,u.length-D);f.push({withoutSkirts:$,withSkirts:K})}return{vertices:a,indices:u,segments:f}}_createGrid(o){const r=this._fillGridMeshWithLods(64,Ge);this._gridSegments=r.segments,this._gridBuffer=o.createVertexBuffer(r.vertices,kC.members),this._gridIndexBuffer=o.createIndexBuffer(r.indices,!0)}_createPoles(o){const r=new el;for(let v=0;v<=64;v++)r.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=o.createIndexBuffer(r,!0);const a=new nf,u=new nf,f=new nf,g=new nf;this._poleSegments=[];for(let v=0,x=0;v<Be;v++){const S=360/(1<<v);a.emplaceBack(0,-xe,0,.5,0),u.emplaceBack(0,-xe,0,.5,1),f.emplaceBack(0,-xe,0,.5,.5),g.emplaceBack(0,-xe,0,.5,.5);for(let T=0;T<=64;T++){let D=T/64,O=0;const z=Fi(0,S,D),[$,K,X]=ot(MF,ey,z,xe);a.emplaceBack($,K,X,D,O),u.emplaceBack($,K,X,D,1-O);const ie=Sr(z);D=.5+.5*Math.sin(ie),O=.5+.5*Math.cos(ie),f.emplaceBack($,K,X,D,O),g.emplaceBack($,K,X,D,1-O)}this._poleSegments.push(zo.simpleSegment(x,0,66,64)),x+=66}this._poleNorthVertexBuffer=o.createVertexBuffer(a,Fv,!1),this._poleSouthVertexBuffer=o.createVertexBuffer(u,Fv,!1),this._texturedPoleNorthVertexBuffer=o.createVertexBuffer(f,Fv,!1),this._texturedPoleSouthVertexBuffer=o.createVertexBuffer(g,Fv,!1)}getGridBuffers(o,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[o].withSkirts:this._gridSegments[o].withoutSkirts]}getPoleBuffers(o,r){return[r?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,r?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[o]]}},p.cZ=function(o){return fc.has(o)},p.c_=kc,p.ca=c,p.cb=class extends pu{constructor(o){super(o),this.current=w}set(o,r,a){if(this.fetchUniformLocation(o,r))for(let u=0;u<9;u++)if(a[u]!==this.current[u]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}},p.cc=ei,p.cd=function(o,r,a){const u=gm(a.zoom),f=o.style.map._antialias,g=r.options.extStandardDerivativesForceOff||o.terrain&&o.terrain.exaggeration()>0;return 0===u&&!f&&!g},p.ce=function(o){const r=o.pixelsPerMeter,a=r/lr(1,o.center.lat),u=p.a6.identity(new Float64Array(16));return p.a6.translate(u,u,[o.point.x,o.point.y,0]),p.a6.scale(u,u,[a,a,r]),Float32Array.from(u)},p.cf=Ov,p.cg=function(o){const r=Fr-5;o=ir(o,-r,r)/r*90;const a=Math.pow(Math.abs(Math.sin(Sr(o))),3);return Math.round(a*(Ge.length-1))},p.ch=function(o,r,a,u){const f=r.getNorth(),g=r.getSouth(),v=r.getWest(),x=r.getEast(),S=1<<o.z,T=x-v,D=f-g,O=T/64,z=-D/Ge[a],$=[0,O,0,z,0,0,f,v,0];if(o.z>0){const K=180/u;p.co.multiply($,$,[K/T+1,0,0,0,K/D+1,0,-.5*K/O,.5*K/z,1])}return $[2]=S,$[5]=o.x,$[8]=o.y,$},p.ci=tA,p.cj=function(o,r,a){const u=p.a6.identity(new Float64Array(16)),f=(r/(1<<o)-.5)*Math.PI*2;return p.a6.rotateY(u,a.globeMatrix,f),Float32Array.from(u)},p.ck=class{isDataAvailableAtPoint(o){const r=this._source();if(this.isUsingMockSource()||!r||o.y<0||o.y>1)return!1;const a=r.getSource().maxzoom,u=1<<a,f=Math.floor(o.x),g=Math.floor((o.x-f)*u),v=Math.floor(o.y*u),x=this.findDEMTileFor(new Cn(a,f,a,g,v));return!(!x||!x.dem)}getAtPointOrZero(o,r=0){return this.getAtPoint(o,r)||0}getAtPoint(o,r,a=!0){if(this.isUsingMockSource())return null;null==r&&(r=null);const u=this._source();if(!u||o.y<0||o.y>1)return r;const f=u.getSource().maxzoom,g=1<<f,v=Math.floor(o.x),x=o.x-v,S=new Cn(f,v,f,Math.floor(x*g),Math.floor(o.y*g)),T=this.findDEMTileFor(S);if(!T||!T.dem)return r;const D=T.dem,O=1<<T.tileID.canonical.z,z=(x*O-T.tileID.canonical.x)*D.dim,$=(o.y*O-T.tileID.canonical.y)*D.dim,K=Math.floor(z),X=Math.floor($);return(a?this.exaggeration():1)*Fi(Fi(D.get(K,X),D.get(K,X+1),$-X),Fi(D.get(K+1,X),D.get(K+1,X+1),$-X),z-K)}getAtTileOffset(o,r,a){const u=1<<o.canonical.z;return this.getAtPointOrZero(new Xr(o.wrap+(o.canonical.x+r/Jn)/u,(o.canonical.y+a/Jn)/u))}getAtTileOffsetFunc(o,r,a,u){return f=>{const g=this.getAtTileOffset(o,f.x,f.y),v=u.upVector(o.canonical,f.x,f.y),x=u.upVectorScale(o.canonical,r,a).metersToTile;return p.N.scale(v,v,g*x),v}}getForTilePoints(o,r,a,u){if(this.isUsingMockSource())return!1;const f=Uu.create(this,o,u);return!!f&&(r.forEach(g=>{g[2]=this.exaggeration()*f.getElevationAt(g[0],g[1],a)}),!0)}getMinMaxForTile(o){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(o);if(!r||!r.dem)return null;const a=r.dem.tree,u=r.tileID,f=1<<o.canonical.z-u.canonical.z;let g=o.canonical.x/f-u.canonical.x,v=o.canonical.y/f-u.canonical.y,x=0;for(let S=0;S<o.canonical.z-u.canonical.z&&!a.leaves[x];S++){g*=2,v*=2;const T=2*Math.floor(v)+Math.floor(g);x=a.childOffsets[x]+T,g%=1,v%=1}return{min:this.exaggeration()*a.minimums[x],max:this.exaggeration()*a.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(o,r,a){throw new Error("Pure virtual method called.")}pointCoordinate(o){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(o){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const o=this.visibleDemTiles;if(0===o.length)return null;let r=!1,a=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const f of o){const g=this.getMinMaxForTile(f.tileID);g&&(a=Math.min(a,g.min),u=Math.max(u,g.max),r=!0)}return r?{min:a,max:u}:null}},p.cl=M_,p.cm=fT,p.cn=function(o,r){return[Math.pow(o[0],2.2)*r,Math.pow(o[1],2.2)*r,Math.pow(o[2],2.2)*r]},p.cp=F_,p.cq=256,p.cr=function(o,r){const a=[0,0,0],u=Pv(tA(r.canonical));return p.N.transformMat4(a,a,u),p.N.transformMat4(a,a,o),a},p.cs=o=>({u_camera_to_center_distance:new Bl(o),u_extrude_scale:new I(o),u_device_pixel_ratio:new Bl(o),u_matrix:new y(o),u_inv_rot_matrix:new y(o),u_merc_center:new bd(o),u_tile_id:new w_(o),u_zoom_transition:new Bl(o),u_up_dir:new w_(o),u_emissive_strength:new Bl(o)}),p.ct=o=>({u_matrix:new y(o),u_pixels_to_tile_units:new I(o),u_device_pixel_ratio:new Bl(o),u_units_to_pixels:new bd(o),u_dash_image:new Yf(o),u_gradient_image:new Yf(o),u_image_height:new Bl(o),u_texsize:new bd(o),u_tile_units_to_pixels:new Bl(o),u_alpha_discard_threshold:new Bl(o),u_trim_offset:new bd(o),u_emissive_strength:new Bl(o)}),p.cu=o=>({u_matrix:new y(o),u_texsize:new bd(o),u_pixels_to_tile_units:new I(o),u_device_pixel_ratio:new Bl(o),u_image:new Yf(o),u_units_to_pixels:new bd(o),u_tile_units_to_pixels:new Bl(o),u_alpha_discard_threshold:new Bl(o),u_trim_offset:new bd(o)}),p.cv=Vp,p.cw=KF,p.cx=WF,p.cy=Lb,p.cz=(o,r,a,u,f,g)=>{const v=o.transform,x="globe"===v.projection.name;let S;if("map"===g.paint.get("circle-pitch-alignment"))if(x){const D=F_(v.zoom,r.canonical)*v._pixelsPerMercatorPixel;S=Float32Array.from([D,0,0,D])}else S=v.calculatePixelsToTileUnitsMatrix(a);else S=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const T={u_camera_to_center_distance:o.transform.getCameraToCenterDistance(v.projection),u_matrix:o.translatePosMatrix(r.projMatrix,a,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_device_pixel_ratio:wn.devicePixelRatio,u_extrude_scale:S,u_inv_rot_matrix:Nb,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:g.paint.get("circle-emissive-strength")};if(x){T.u_inv_rot_matrix=u,T.u_merc_center=f,T.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],T.u_zoom_transition=gm(v.zoom);const D=f[0]*Jn,O=f[1]*Jn;T.u_up_dir=v.projection.upVector(new An(0,0,0),D,O)}return T},p.d=Gn,p.d0=ll,p.d1=jr,p.d2=Pt,p.d3=function([o,r,a]){const u=Math.hypot(o,r,a),f=Math.atan2(o,a),g=.5*Math.PI-Math.acos(-r/u);return new ct(Jo(f),Jo(g))},p.d4=Rt,p.d5=ar,p.d6=zC,p.d7=BF,p.d8=function(o){const r=[0,0,0],a=p.a6.identity(new Float64Array(16));return p.a6.multiply(a,o.pixelMatrix,o.globeMatrix),p.N.transformMat4(r,r,a),new Nn(r[0],r[1])},p.d9=function(o){const r=o.navigator?o.navigator.userAgent:null;return!!function(a){if(null==kt){const u=a.navigator?a.navigator.userAgent:null;kt=!!a.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return kt}(o)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},p.dA=$e,p.dB=Cy,p.dC=Ey,p.dD=UT,p.dE=Kr,p.dF=tI,p.dG=function(o,r,a,u,f,g,v,x,S,T,D){o.createArrays(),o.tilePixelRatio=Jn/(512*o.overscaling),o.compareText={},o.iconsNeedLinear=!1;const O=o.layers[0].layout,z=o.layers[0]._unevaluatedLayout._values,$={};if("composite"===o.textSizeData.kind){const{minZoom:ae,maxZoom:be}=o.textSizeData;$.compositeTextSizes=[z["text-size"].possiblyEvaluate(new uo(ae),x),z["text-size"].possiblyEvaluate(new uo(be),x)]}if("composite"===o.iconSizeData.kind){const{minZoom:ae,maxZoom:be}=o.iconSizeData;$.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new uo(ae),x),z["icon-size"].possiblyEvaluate(new uo(be),x)]}$.layoutTextSize=z["text-size"].possiblyEvaluate(new uo(S+1),x),$.layoutIconSize=z["icon-size"].possiblyEvaluate(new uo(S+1),x),$.textMaxSize=z["text-size"].possiblyEvaluate(new uo(18),x);const K="map"===O.get("text-rotation-alignment")&&"point"!==O.get("symbol-placement"),X=O.get("text-size");let ie=!1;for(const ae of o.features)if(ae.icon&&ae.icon.nameSecondary){ie=!0;break}for(const ae of o.features){const be=O.get("text-font").evaluate(ae,{},x).join(","),Ce=X.evaluate(ae,{},x),Ee=$.layoutTextSize.evaluate(ae,{},x),Le=($.layoutIconSize.evaluate(ae,{},x),{horizontal:{},vertical:void 0}),Oe=ae.text;let qe,rt=[0,0];if(Oe){const At=Oe.toString(),Kt=O.get("text-letter-spacing").evaluate(ae,{},x)*xc,fn=O.get("text-line-height").evaluate(ae,{},x)*xc,Ut=ef(At)?Kt:0,Dt=O.get("text-anchor").evaluate(ae,{},x),Bt=O.get("text-variable-anchor");if(!Bt){const Kn=O.get("text-radial-offset").evaluate(ae,{},x);rt=Kn?rI(Dt,[Kn*xc,gw]):O.get("text-offset").evaluate(ae,{},x).map(bn=>bn*xc)}let an=K?"center":O.get("text-justify").evaluate(ae,{},x);const Mn="point"===O.get("symbol-placement"),on=Mn?O.get("text-max-width").evaluate(ae,{},x)*xc:1/0,ri=Kn=>{o.allowVerticalPlacement&&zc(At)&&(Le.vertical=c2(Oe,r,a,f,be,on,fn,Dt,Kn,Ut,rt,Xc.vertical,!0,Ee,Ce))};if(!K&&Bt){const Kn="auto"===an?Bt.map(Hi=>_2(Hi)):[an];let bn=!1;for(let Hi=0;Hi<Kn.length;Hi++){const Ei=Kn[Hi];if(!Le.horizontal[Ei])if(bn)Le.horizontal[Ei]=Le.horizontal[0];else{const hi=c2(Oe,r,a,f,be,on,fn,"center",Ei,Ut,rt,Xc.horizontal,!1,Ee,Ce);hi&&(Le.horizontal[Ei]=hi,bn=1===hi.positionedLines.length)}}ri("left")}else{if("auto"===an&&(an=_2(Dt)),Mn||O.get("text-writing-mode").indexOf("horizontal")>=0||!zc(At)){const Kn=c2(Oe,r,a,f,be,on,fn,Dt,an,Ut,rt,Xc.horizontal,!1,Ee,Ce);Kn&&(Le.horizontal[an]=Kn)}ri(Mn?"left":an)}}let ht=!1;if(ae.icon&&ae.icon.namePrimary){const At=u[ae.icon.namePrimary];At&&(qe=r5(f[ae.icon.namePrimary],ae.icon.nameSecondary?f[ae.icon.nameSecondary]:void 0,O.get("icon-offset").evaluate(ae,{},x),O.get("icon-anchor").evaluate(ae,{},x)),ht=At.sdf,void 0===o.sdfIcons?o.sdfIcons=At.sdf:o.sdfIcons!==At.sdf&&$o("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(At.pixelRatio!==o.pixelRatio||0!==O.get("icon-rotate").constantOr(1))&&(o.iconsNeedLinear=!0))}const It=oI(Le.horizontal)||Le.vertical;o.iconsInText||(o.iconsInText=!!It&&It.iconsInText),(It||qe)&&l5(o,ae,Le,qe,u,$,Ee,0,rt,ht,v,x,T,D,ie)}g&&o.generateCollisionDebugBuffers(S,o.collisionBoxArray)},p.dH=Kb,p.dI=H_,p.dJ=$v,p.dK=Ta,p.dL=JA,p.dM=jv,p.dN=Ul,p.dO=ZF,p.dP=function(o){let r=0;if(new Uint32Array(o,0,1)[0]!==B2){const a=new Uint32Array(o,0,7),[,,u,f,g,v]=a;r=a.byteLength+f+g+v+g,(u!==o.byteLength||r>=o.byteLength)&&$o("Invalid b3dm header information.")}return PI(o,r)},p.dQ=function(o,r){const a=Mw(o);for(const u of a){for(const f of u.meshes)Fw(f);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(zI(u.lights,r)))}return a},p.dR=Ow,p.dS=FI,p.dT=$l,p.dU=function(o){os(),Zn&&Zn.then(r=>{r.keys().then(a=>{for(let u=0;u<a.length-o;u++)r.delete(a[u])})})},p.da=class{constructor(o,r,a){this._transformRequestFn=o,this._customAccessToken=r,this._silenceAuthErrors=!!a,this._createSkuToken()}_createSkuToken(){const o=function(){let r="";for(let a=0;a<10;a++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ln,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,r){return this._transformRequestFn&&this._transformRequestFn(o,r)||{url:o}}normalizeStyleURL(o,r){if(!Di(o))return o;const a=ji(o);return a.params.push(`sdk=js-${Ai}`),a.path=`/styles/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||r)}normalizeGlyphsURL(o,r){if(!Di(o))return o;const a=ji(o);return a.path=`/fonts/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||r)}normalizeModelURL(o,r){if(!Di(o))return o;const a=ji(o);return a.path=`/models/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||r)}normalizeSourceURL(o,r,a,u){if(!Di(o))return o;const f=ji(o);return f.path=`/v4/${f.authority}.json`,f.params.push("secure"),a&&f.params.push(`language=${a}`),u&&f.params.push(`worldview=${u}`),this._makeAPIURL(f,this._customAccessToken||r)}normalizeSpriteURL(o,r,a,u){const f=ji(o);return Di(o)?(f.path=`/styles/v1${f.path}/sprite${r}${a}`,this._makeAPIURL(f,this._customAccessToken||u)):(f.path+=`${r}${a}`,Ur(f))}normalizeTileURL(o,r,a){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!Di(o))return o;const u=ji(o);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||a&&"raster"!==u.authority&&512===a?"@2x":""}${ls.supported?".webp":"$1"}`),"raster"===u.authority?u.path=`/${ar.RASTER_URL_PREFIX}${u.path}`:"rasterarrays"===u.authority?u.path=`/${ar.RASTERARRAYS_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${ar.TILE_URL_VERSION}${u.path}`);const f=this._customAccessToken||function(g){for(const v of g){const x=v.match(/^access_token=(.*)$/);if(x)return x[1]}return null}(u.params)||ar.ACCESS_TOKEN;return ar.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,f)}canonicalizeTileURL(o,r){const a=ji(o);if(!a.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!a.path.match(/\.[\w]+$/))return o;let u="mapbox://";a.path.match(/^\/raster\/v1\//)?u+=`raster/${a.path.replace(`/${ar.RASTER_URL_PREFIX}/`,"")}`:a.path.match(/^\/rasterarrays\/v1\//)?u+=`rasterarrays/${a.path.replace(`/${ar.RASTERARRAYS_URL_PREFIX}/`,"")}`:u+=`tiles/${a.path.replace(`/${ar.TILE_URL_VERSION}/`,"")}`;let f=a.params;return r&&(f=f.filter(g=>!g.match(/^access_token=/))),f.length&&(u+=`?${f.join("&")}`),u}canonicalizeTileset(o,r){const a=!!r&&Di(r),u=[];for(const f of o.tiles||[])El(f)?u.push(this.canonicalizeTileURL(f,a)):u.push(f);return u}_makeAPIURL(o,r){const a="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",u=ji(ar.API_URL);if(o.protocol=u.protocol,o.authority=u.authority,"http"===o.protocol){const f=o.params.indexOf("secure");f>=0&&o.params.splice(f,1)}if("/"!==u.path&&(o.path=`${u.path}${o.path}`),!ar.REQUIRE_ACCESS_TOKEN)return Ur(o);if(r=r||ar.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${a}`);if("s"===r[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${a}`)}return o.params=o.params.filter(f=>-1===f.indexOf("access_token")),o.params.push(`access_token=${r||""}`),Ur(o)}},p.db=function(o,r){r?fc.add(o):fc.delete(o)},p.dc=ls,p.dd=Su,p.de=ad,p.df=ii,p.dg=_s,p.dh=function(o){fc.delete(o)},p.di=da,p.dj=Fo,p.dk=Ai,p.dl=function(o,r){Vt=o,jn=r},p.dm=function(o,r,a=!1){if(vc===Xg||vc===Yg||vc===Op)throw new Error("setRTLTextPlugin cannot be called multiple times.");zh=wn.resolveURL(o),vc=Xg,kp=r,em(),a||Pi()},p.dn=Vh,p.dp=function(){To().acquire(eg)},p.dq=function(){const o=Vu;o&&(o.isPreloaded()&&1===o.numActive()?(o.release(eg),Vu=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},p.dr=Tm,p.ds=function(o){const r=vr();if(!r)return;const a=r.delete(zn);o&&a.catch(o).then(()=>o())},p.dt=Jp,p.du=Z_,p.dv=function(o){Im=wn.resolveURL(o),aA||(aA=new hf(To(),new ld)),aA.broadcast("setDracoUrl",Im)},p.dw=X_,p.dx=function(o){oA=wn.resolveURL(o),aA||(aA=new hf(To(),new ld)),aA.broadcast("setMeshoptUrl",oA)},p.dy=ai,p.dz=gh,p.e=Oa,p.f=wn,p.g=function(o,r){return Zt(Oa(o,{type:"json"}),r)},p.h=mu,p.i=qi,p.j=mp,p.k=Ya,p.l=function(o){return fetch(o).then(r=>r.arrayBuffer()).then(r=>PI(r,0,o))},p.m=_c,p.n=Bp,p.o=UA,p.p=s1,p.q=h_,p.r=u_,p.s=Gl,p.t=Hl,p.u=im,p.v=ul,p.w=$o,p.x=rh,p.z=zA}),Mo(0,function(p){function Ai(kt){const _e=kt?kt.url.toString():void 0;return _e?performance.getEntriesByName(_e):[]}function Ra(kt){if("number"==typeof kt||"boolean"==typeof kt||"string"==typeof kt||null==kt)return JSON.stringify(kt);if(Array.isArray(kt)){let Re="[";for(const tt of kt)Re+=`${Ra(tt)},`;return`${Re}]`}let _e="{";for(const Re of Object.keys(kt).sort())_e+=`${Re}:${Ra(kt[Re])},`;return`${_e}}`}function ar(kt){let _e="";for(const Re of p.b2)_e+=`/${Ra(kt[Re])}`;return _e}class El{constructor(_e){this.keyCache={},this._layers={},this._layerConfigs={},_e&&this.replace(_e)}replace(_e,Re){this._layerConfigs={},this._layers={},this.update(_e,[],Re)}update(_e,Re,tt){this._options=tt;for(const tn of _e)this._layerConfigs[tn.id]=tn,(this._layers[tn.id]=p.c2(tn,this.scope,this._options)).compileFilter(),this.keyCache[tn.id]&&delete this.keyCache[tn.id];for(const tn of Re)delete this.keyCache[tn],delete this._layerConfigs[tn],delete this._layers[tn];this.familiesBySource={};const Gt=function(tn,wn){const zn={};for(let jn=0;jn<tn.length;jn++){const Zn=wn&&wn[tn[jn].id]||ar(tn[jn]);wn&&(wn[tn[jn].id]=Zn);let ui=zn[Zn];ui||(ui=zn[Zn]=[]),ui.push(tn[jn])}const Vt=[];for(const jn in zn)Vt.push(zn[jn]);return Vt}(p.a$(this._layerConfigs),this.keyCache);for(const tn of Gt){const wn=tn.map(vr=>this._layers[vr.id]),zn=wn[0];if("none"===zn.visibility)continue;const Vt=zn.source||"";let jn=this.familiesBySource[Vt];jn||(jn=this.familiesBySource[Vt]={});const Zn=zn.sourceLayer||"_geojsonTileLayer";let ui=jn[Zn];ui||(ui=jn[Zn]=[]),ui.push(wn)}}}const Di=1*p.dA;class ia{constructor(_e){const Re={},tt=[];for(const zn in _e){const Vt=_e[zn],jn=Re[zn]={};for(const Zn in Vt.glyphs){const ui=Vt.glyphs[+Zn];if(!ui||0===ui.bitmap.width||0===ui.bitmap.height)continue;const vr=ui.metrics.localGlyph?Di:1,os={x:0,y:0,w:ui.bitmap.width+2*vr,h:ui.bitmap.height+2*vr};tt.push(os),jn[Zn]=os}}const{w:Gt,h:tn}=p.p(tt),wn=new p.dz({width:Gt||1,height:tn||1});for(const zn in _e){const Vt=_e[zn];for(const jn in Vt.glyphs){const Zn=Vt.glyphs[+jn];if(!Zn||0===Zn.bitmap.width||0===Zn.bitmap.height)continue;const ui=Re[zn][jn],vr=Zn.metrics.localGlyph?Di:1;p.dz.copy(Zn.bitmap,wn,{x:0,y:0},{x:ui.x+vr,y:ui.y+vr},Zn.bitmap)}}this.image=wn,this.positions=Re}}p.dy(ia,"GlyphAtlas");class Wa{constructor(_e){this.tileID=new p.am(_e.tileID.overscaledZ,_e.tileID.wrap,_e.tileID.canonical.z,_e.tileID.canonical.x,_e.tileID.canonical.y),this.tileZoom=_e.tileZoom,this.uid=_e.uid,this.zoom=_e.zoom,this.canonical=_e.tileID.canonical,this.pixelRatio=_e.pixelRatio,this.tileSize=_e.tileSize,this.source=_e.source,this.scope=_e.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=_e.showCollisionBoxes,this.collectResourceTiming=!!_e.collectResourceTiming,this.promoteId=_e.promoteId,this.isSymbolTile=_e.isSymbolTile,this.tileTransform=p.as(_e.tileID.canonical,_e.projection),this.projection=_e.projection,this.brightness=_e.brightness,this.extraShadowCaster=!!_e.extraShadowCaster}parse(_e,Re,tt,Gt,tn){this.status="parsing",this.data=_e,this.collisionBoxArray=new p.aD;const wn=new p.dB(Object.keys(_e.layers).sort()),zn=new p.dC(this.tileID,this.promoteId);zn.bucketLayerIDs=[];const Vt={},jn=new p.dD(256,256),Zn={featureIndex:zn,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:jn,availableImages:tt,brightness:this.brightness},ui=Re.familiesBySource[this.source];for(const Ss in ui){const ro=_e.layers[Ss];if(!ro)continue;let ca=!1,fo=!1,Za=!1;for(const ua of ui[Ss])"symbol"===ua[0].type?ca=!0:fo=!0,ua[0].is3D()&&"model"!==ua[0].type&&(Za=!0);if(this.extraShadowCaster&&!Za||!0===this.isSymbolTile&&!ca||!1===this.isSymbolTile&&!fo)continue;1===ro.version&&p.w(`Vector tile source "${this.source}" layer "${Ss}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Xa=wn.encode(Ss),zl=[];for(let ua=0;ua<ro.length;ua++){const ha=ro.feature(ua),Zt=zn.getId(ha,Ss);zl.push({feature:ha,id:Zt,index:ua,sourceLayerIndex:Xa})}for(const ua of ui[Ss]){const ha=ua[0];(!this.extraShadowCaster||ha.is3D()&&"model"!==ha.type)&&(void 0!==this.isSymbolTile&&"symbol"===ha.type!==this.isSymbolTile||ha.minzoom&&this.zoom<Math.floor(ha.minzoom)||ha.maxzoom&&this.zoom>=ha.maxzoom||"none"!==ha.visibility&&(Sa(ua,this.zoom,Zn.brightness,tt),(Vt[ha.id]=ha.createBucket({index:zn.bucketLayerIDs.length,layers:ua,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xa,sourceID:this.source,projection:this.projection.spec})).populate(zl,Zn,this.tileID.canonical,this.tileTransform),zn.bucketLayerIDs.push(ua.map(Zt=>Zt.id))))}}let vr,os,bo,Os;jn.trim();const as={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ls=()=>{if(vr)return this.status="done",tn(vr);if(this.extraShadowCaster)this.status="done",tn(null,{buckets:p.a$(Vt).filter(Ss=>!Ss.isEmpty()),featureIndex:zn,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Zn.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(os&&bo&&Os){const Ss=new ia(os),ro=new p.dF(bo,Os);for(const ca in Vt){const fo=Vt[ca];fo instanceof p.aE?(Sa(fo.layers,this.zoom,Zn.brightness,tt),p.dG(fo,os,Ss.positions,bo,ro.iconPositions,this.showCollisionBoxes,tt,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):fo.hasPattern&&(fo instanceof p.aK||fo instanceof p.aL||fo instanceof p.cH)&&(Sa(fo.layers,this.zoom,Zn.brightness,tt),fo.addFeatures(Zn,this.tileID.canonical,ro.patternPositions,tt,this.tileTransform,this.brightness))}this.status="done",tn(null,{buckets:p.a$(Vt).filter(ca=>!ca.isEmpty()),featureIndex:zn,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ss.image,lineAtlas:jn,imageAtlas:ro,brightness:Zn.brightness})}};if(!this.extraShadowCaster){const Ss=p.dE(Zn.glyphDependencies,fo=>Object.keys(fo).map(Number));Object.keys(Ss).length?Gt.send("getGlyphs",{uid:this.uid,stacks:Ss,scope:this.scope},(fo,Za)=>{vr||(vr=fo,os=Za,ls())},void 0,!1,as):os={};const ro=Object.keys(Zn.iconDependencies);ro.length?Gt.send("getImages",{icons:ro,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(fo,Za)=>{vr||(vr=fo,bo=Za,ls())},void 0,!1,as):bo={};const ca=Object.keys(Zn.patternDependencies);ca.length?Gt.send("getImages",{icons:ca,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(fo,Za)=>{vr||(vr=fo,Os=Za,ls())},void 0,!1,as):Os={}}ls()}}function Sa(kt,_e,Re,tt){const Gt=new p.K(_e,{brightness:Re});for(const tn of kt)tn.recalculate(Gt,tt)}class Ih extends p.E{constructor(_e,Re,tt,Gt,tn,wn){super(),this.actor=_e,this.layerIndex=Re,this.availableImages=tt,this.loadVectorData=tn||p.ah,this.loading={},this.loaded={},this.deduped=new p.af(_e.scheduler),this.isSpriteLoaded=Gt,this.scheduler=_e.scheduler,this.brightness=wn}loadTile(_e,Re){const tt=_e.uid,Gt=_e&&_e.request,tn=Gt&&Gt.collectResourceTiming,wn=this.loading[tt]=new Wa(_e);wn.abort=this.loadVectorData(_e,(zn,Vt)=>{const jn=!this.loading[tt];if(delete this.loading[tt],jn||zn||!Vt)return wn.status="done",jn||(this.loaded[tt]=wn),Re(zn);const Zn=Vt.rawData,ui={};Vt.expires&&(ui.expires=Vt.expires),Vt.cacheControl&&(ui.cacheControl=Vt.cacheControl),wn.vectorTile=Vt.vectorTile||new p.dH(new p.dI(Zn));const vr=()=>{wn.parse(wn.vectorTile,this.layerIndex,this.availableImages,this.actor,(os,bo)=>{if(os||!bo)return Re(os);const Os={};if(tn){const as=Ai(Gt);as.length>0&&(Os.resourceTiming=JSON.parse(JSON.stringify(as)))}Re(null,p.e({rawTileData:Zn.slice(0)},bo,ui,Os))})};this.isSpriteLoaded?vr():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(vr,{type:"parseTile",isSymbolTile:_e.isSymbolTile,zoom:_e.tileZoom}):vr()}),this.loaded=this.loaded||{},this.loaded[tt]=wn})}reloadTile(_e,Re){const tt=this.loaded,Gt=_e.uid,tn=this;if(tt&&tt[Gt]){const wn=tt[Gt];wn.showCollisionBoxes=_e.showCollisionBoxes,wn.projection=_e.projection,wn.brightness=_e.brightness,wn.tileTransform=p.as(_e.tileID.canonical,_e.projection),wn.extraShadowCaster=_e.extraShadowCaster;const zn=(Vt,jn)=>{const Zn=wn.reloadCallback;Zn&&(delete wn.reloadCallback,wn.parse(wn.vectorTile,tn.layerIndex,this.availableImages,tn.actor,Zn)),Re(Vt,jn)};"parsing"===wn.status?wn.reloadCallback=zn:"done"===wn.status&&(wn.vectorTile?wn.parse(wn.vectorTile,this.layerIndex,this.availableImages,this.actor,zn):zn())}else Re(null,void 0)}abortTile(_e,Re){const tt=_e.uid,Gt=this.loading[tt];Gt&&(Gt.abort&&Gt.abort(),delete this.loading[tt]),Re()}removeTile(_e,Re){const tt=this.loaded,Gt=_e.uid;tt&&tt[Gt]&&delete tt[Gt],Re()}}class Dh{loadTile(_e,Re){const{uid:tt,encoding:Gt,rawImageData:tn,padding:wn}=_e,zn=ImageBitmap&&tn instanceof ImageBitmap?this.getImageData(tn,wn):tn;Re(null,new p.dJ(tt,zn,Gt,wn<1))}getImageData(_e,Re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(_e.width,_e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=_e.width,this.offscreenCanvas.height=_e.height,this.offscreenCanvasContext.drawImage(_e,0,0,_e.width,_e.height);const tt=this.offscreenCanvasContext.getImageData(-Re,-Re,_e.width+2*Re,_e.height+2*Re);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),tt}}class Ta{decodeRasterArray({task:_e,buffer:Re},tt){p.aZ.performDecoding(Re,_e).then(Gt=>{tt(null,Gt)},Gt=>{tt(Gt)})}}function Bh(kt,_e){if(0!==kt.length){ec(kt[0],_e);for(var Re=1;Re<kt.length;Re++)ec(kt[Re],!_e)}}function ec(kt,_e){for(var Re=0,tt=0,Gt=0,tn=kt.length,wn=tn-1;Gt<tn;wn=Gt++){var zn=(kt[Gt][0]-kt[wn][0])*(kt[wn][1]+kt[Gt][1]),Vt=Re+zn;tt+=Math.abs(Re)>=Math.abs(zn)?Re-Vt+zn:zn-Vt+Re,Re=Vt}Re+tt>=0!=!!_e&&kt.reverse()}var Oc=p.dK(function kt(_e,Re){var tt,Gt=_e&&_e.type;if("FeatureCollection"===Gt)for(tt=0;tt<_e.features.length;tt++)kt(_e.features[tt],Re);else if("GeometryCollection"===Gt)for(tt=0;tt<_e.geometries.length;tt++)kt(_e.geometries[tt],Re);else if("Feature"===Gt)kt(_e.geometry,Re);else if("Polygon"===Gt)Bh(_e.coordinates,Re);else if("MultiPolygon"===Gt)for(tt=0;tt<_e.coordinates.length;tt++)Bh(_e.coordinates[tt],Re);return _e});const Ul=p.dL.prototype.toGeoJSON;var Sl={exports:{}},od=p.dN,Sr=p.dM.VectorTileFeature,Jo=EA;function EA(kt,_e){this.options=_e||{},this.features=kt,this.length=kt.length}function ei(kt,_e){this.id="number"==typeof kt.id?kt.id:void 0,this.type=kt.type,this.rawGeometry=1===kt.type?[kt.geometry]:kt.geometry,this.properties=kt.tags,this.extent=_e||4096}EA.prototype.feature=function(kt){return new ei(this.features[kt],this.options.extent)},ei.prototype.loadGeometry=function(){var kt=this.rawGeometry;this.geometry=[];for(var _e=0;_e<kt.length;_e++){for(var Re=kt[_e],tt=[],Gt=0;Gt<Re.length;Gt++)tt.push(new od(Re[Gt][0],Re[Gt][1]));this.geometry.push(tt)}return this.geometry},ei.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var kt=this.geometry,_e=1/0,Re=-1/0,tt=1/0,Gt=-1/0,tn=0;tn<kt.length;tn++)for(var wn=kt[tn],zn=0;zn<wn.length;zn++){var Vt=wn[zn];_e=Math.min(_e,Vt.x),Re=Math.max(Re,Vt.x),tt=Math.min(tt,Vt.y),Gt=Math.max(Gt,Vt.y)}return[_e,tt,Re,Gt]},ei.prototype.toGeoJSON=Sr.prototype.toGeoJSON;var kc=p.dO,ll=Jo;function ir(kt){var _e=new kc;return function(Re,tt){for(var Gt in Re.layers)tt.writeMessage(3,Od,Re.layers[Gt])}(kt,_e),_e.finish()}function Od(kt,_e){var Re;_e.writeVarintField(15,kt.version||1),_e.writeStringField(1,kt.name||""),_e.writeVarintField(5,kt.extent||4096);var tt={keys:[],values:[],keycache:{},valuecache:{}};for(Re=0;Re<kt.length;Re++)tt.feature=kt.feature(Re),_e.writeMessage(2,Xu,tt);var Gt=tt.keys;for(Re=0;Re<Gt.length;Re++)_e.writeStringField(3,Gt[Re]);var tn=tt.values;for(Re=0;Re<tn.length;Re++)_e.writeMessage(4,Pd,tn[Re])}function Xu(kt,_e){var Re=kt.feature;void 0!==Re.id&&_e.writeVarintField(1,Re.id),_e.writeMessage(2,Hr,kt),_e.writeVarintField(3,Re.type),_e.writeMessage(4,kd,Re)}function Hr(kt,_e){var Re=kt.feature,tt=kt.keys,Gt=kt.values,tn=kt.keycache,wn=kt.valuecache;for(var zn in Re.properties){var Vt=Re.properties[zn],jn=tn[zn];if(null!==Vt){void 0===jn&&(tt.push(zn),tn[zn]=jn=tt.length-1),_e.writeVarint(jn);var Zn=typeof Vt;"string"!==Zn&&"boolean"!==Zn&&"number"!==Zn&&(Vt=JSON.stringify(Vt));var ui=Zn+":"+Vt,vr=wn[ui];void 0===vr&&(Gt.push(Vt),wn[ui]=vr=Gt.length-1),_e.writeVarint(vr)}}}function Oa(kt,_e){return(_e<<3)+(7&kt)}function Mh(kt){return kt<<1^kt>>31}function kd(kt,_e){for(var Re=kt.loadGeometry(),tt=kt.type,Gt=0,tn=0,wn=Re.length,zn=0;zn<wn;zn++){var Vt=Re[zn],jn=1;1===tt&&(jn=Vt.length),_e.writeVarint(Oa(1,jn));for(var Zn=3===tt?Vt.length-1:Vt.length,ui=0;ui<Zn;ui++){1===ui&&1!==tt&&_e.writeVarint(Oa(2,Zn-1));var vr=Vt[ui].x-Gt,os=Vt[ui].y-tn;_e.writeVarint(Mh(vr)),_e.writeVarint(Mh(os)),Gt+=vr,tn+=os}3===tt&&_e.writeVarint(Oa(7,1))}}function Pd(kt,_e){var Re=typeof kt;"string"===Re?_e.writeStringField(1,kt):"boolean"===Re?_e.writeBooleanField(7,kt):"number"===Re&&(kt%1!=0?_e.writeDoubleField(3,kt):kt<0?_e.writeSVarintField(6,kt):_e.writeVarintField(5,kt))}Sl.exports=ir,Sl.exports.fromVectorTileJs=ir,Sl.exports.fromGeojsonVt=function(kt,_e){_e=_e||{};var Re={};for(var tt in kt)Re[tt]=new ll(kt[tt].features,_e),Re[tt].name=tt,Re[tt].version=_e.version,Re[tt].extent=_e.extent;return ir({layers:Re})},Sl.exports.GeoJSONWrapper=ll;var Li=p.dK(Sl.exports);const Tf={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:kt=>kt},ru=Math.fround||(Xs=new Float32Array(1),kt=>(Xs[0]=+kt,Xs[0]));var Xs;const Kr=3,dc=5,Ht=6;class Nd{constructor(_e){this.options=Object.assign(Object.create(Tf),_e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(_e){const{log:Re,minZoom:tt,maxZoom:Gt}=this.options;Re&&console.time("total time");const tn=`prepare ${_e.length} points`;Re&&console.time(tn),this.points=_e;const wn=[];for(let Vt=0;Vt<_e.length;Vt++){const jn=_e[Vt];if(!jn.geometry)continue;const[Zn,ui]=jn.geometry.coordinates,vr=ru(Cu(Zn)),os=ru(Eu(ui));wn.push(vr,os,1/0,Vt,-1,1),this.options.reduce&&wn.push(0)}let zn=this.trees[Gt+1]=this._createTree(wn);Re&&console.timeEnd(tn);for(let Vt=Gt;Vt>=tt;Vt--){const jn=+Date.now();zn=this.trees[Vt]=this._createTree(this._cluster(zn,Vt)),Re&&console.log("z%d: %d clusters in %dms",Vt,zn.numItems,+Date.now()-jn)}return Re&&console.timeEnd("total time"),this}getClusters(_e,Re){let tt=((_e[0]+180)%360+360)%360-180;const Gt=Math.max(-90,Math.min(90,_e[1]));let tn=180===_e[2]?180:((_e[2]+180)%360+360)%360-180;const wn=Math.max(-90,Math.min(90,_e[3]));if(_e[2]-_e[0]>=360)tt=-180,tn=180;else if(tt>tn){const ui=this.getClusters([tt,Gt,180,wn],Re),vr=this.getClusters([-180,Gt,tn,wn],Re);return ui.concat(vr)}const zn=this.trees[this._limitZoom(Re)],Vt=zn.range(Cu(tt),Eu(wn),Cu(tn),Eu(Gt)),jn=zn.data,Zn=[];for(const ui of Vt){const vr=this.stride*ui;Zn.push(jn[vr+dc]>1?$o(jn,vr,this.clusterProps):this.points[jn[vr+Kr]])}return Zn}getChildren(_e){const Re=this._getOriginId(_e),tt=this._getOriginZoom(_e),Gt="No cluster with the specified id.",tn=this.trees[tt];if(!tn)throw new Error(Gt);const wn=tn.data;if(Re*this.stride>=wn.length)throw new Error(Gt);const zn=this.options.radius/(this.options.extent*Math.pow(2,tt-1)),Vt=tn.within(wn[Re*this.stride],wn[Re*this.stride+1],zn),jn=[];for(const Zn of Vt){const ui=Zn*this.stride;wn[ui+4]===_e&&jn.push(wn[ui+dc]>1?$o(wn,ui,this.clusterProps):this.points[wn[ui+Kr]])}if(0===jn.length)throw new Error(Gt);return jn}getLeaves(_e,Re,tt){const Gt=[];return this._appendLeaves(Gt,_e,Re=Re||10,tt=tt||0,0),Gt}getTile(_e,Re,tt){const Gt=this.trees[this._limitZoom(_e)],tn=Math.pow(2,_e),{extent:wn,radius:zn}=this.options,Vt=zn/wn,jn=(tt-Vt)/tn,Zn=(tt+1+Vt)/tn,ui={features:[]};return this._addTileFeatures(Gt.range((Re-Vt)/tn,jn,(Re+1+Vt)/tn,Zn),Gt.data,Re,tt,tn,ui),0===Re&&this._addTileFeatures(Gt.range(1-Vt/tn,jn,1,Zn),Gt.data,tn,tt,tn,ui),Re===tn-1&&this._addTileFeatures(Gt.range(0,jn,Vt/tn,Zn),Gt.data,-1,tt,tn,ui),ui.features.length?ui:null}getClusterExpansionZoom(_e){let Re=this._getOriginZoom(_e)-1;for(;Re<=this.options.maxZoom;){const tt=this.getChildren(_e);if(Re++,1!==tt.length)break;_e=tt[0].properties.cluster_id}return Re}_appendLeaves(_e,Re,tt,Gt,tn){const wn=this.getChildren(Re);for(const zn of wn){const Vt=zn.properties;if(Vt&&Vt.cluster?tn+Vt.point_count<=Gt?tn+=Vt.point_count:tn=this._appendLeaves(_e,Vt.cluster_id,tt,Gt,tn):tn<Gt?tn++:_e.push(zn),_e.length===tt)break}return tn}_createTree(_e){const Re=new p.bg(_e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let tt=0;tt<_e.length;tt+=this.stride)Re.add(_e[tt],_e[tt+1]);return Re.finish(),Re.data=_e,Re}_addTileFeatures(_e,Re,tt,Gt,tn,wn){for(const zn of _e){const Vt=zn*this.stride,jn=Re[Vt+dc]>1;let Zn,ui,vr;if(jn)Zn=nc(Re,Vt,this.clusterProps),ui=Re[Vt],vr=Re[Vt+1];else{const Os=this.points[Re[Vt+Kr]];Zn=Os.properties;const[as,ls]=Os.geometry.coordinates;ui=Cu(as),vr=Eu(ls)}const os={type:1,geometry:[[Math.round(this.options.extent*(ui*tn-tt)),Math.round(this.options.extent*(vr*tn-Gt))]],tags:Zn};let bo;bo=jn||this.options.generateId?Re[Vt+Kr]:this.points[Re[Vt+Kr]].id,void 0!==bo&&(os.id=bo),wn.features.push(os)}}_limitZoom(_e){return Math.max(this.options.minZoom,Math.min(Math.floor(+_e),this.options.maxZoom+1))}_cluster(_e,Re){const{radius:tt,extent:Gt,reduce:tn,minPoints:wn}=this.options,zn=tt/(Gt*Math.pow(2,Re)),Vt=_e.data,jn=[],Zn=this.stride;for(let ui=0;ui<Vt.length;ui+=Zn){if(Vt[ui+2]<=Re)continue;Vt[ui+2]=Re;const vr=Vt[ui],os=Vt[ui+1],bo=_e.within(Vt[ui],Vt[ui+1],zn),Os=Vt[ui+dc];let as=Os;for(const ls of bo){const Ss=ls*Zn;Vt[Ss+2]>Re&&(as+=Vt[Ss+dc])}if(as>Os&&as>=wn){let ls,Ss=vr*Os,ro=os*Os,ca=-1;const fo=(ui/Zn<<5)+(Re+1)+this.points.length;for(const Za of bo){const Xa=Za*Zn;if(Vt[Xa+2]<=Re)continue;Vt[Xa+2]=Re;const zl=Vt[Xa+dc];Ss+=Vt[Xa]*zl,ro+=Vt[Xa+1]*zl,Vt[Xa+4]=fo,tn&&(ls||(ls=this._map(Vt,ui,!0),ca=this.clusterProps.length,this.clusterProps.push(ls)),tn(ls,this._map(Vt,Xa)))}Vt[ui+4]=fo,jn.push(Ss/as,ro/as,1/0,fo,-1,as),tn&&jn.push(ca)}else{for(let ls=0;ls<Zn;ls++)jn.push(Vt[ui+ls]);if(as>1)for(const ls of bo){const Ss=ls*Zn;if(!(Vt[Ss+2]<=Re)){Vt[Ss+2]=Re;for(let ro=0;ro<Zn;ro++)jn.push(Vt[Ss+ro])}}}}return jn}_getOriginId(_e){return _e-this.points.length>>5}_getOriginZoom(_e){return(_e-this.points.length)%32}_map(_e,Re,tt){if(_e[Re+dc]>1){const wn=this.clusterProps[_e[Re+Ht]];return tt?Object.assign({},wn):wn}const Gt=this.points[_e[Re+Kr]].properties,tn=this.options.map(Gt);return tt&&tn===Gt?Object.assign({},tn):tn}}function $o(kt,_e,Re){return{type:"Feature",id:kt[_e+Kr],properties:nc(kt,_e,Re),geometry:{type:"Point",coordinates:[(tt=kt[_e],360*(tt-.5)),Pc(kt[_e+1])]}};var tt}function nc(kt,_e,Re){const tt=kt[_e+dc],Gt=tt>=1e4?`${Math.round(tt/1e3)}k`:tt>=1e3?Math.round(tt/100)/10+"k":tt,tn=kt[_e+Ht],wn=-1===tn?{}:Object.assign({},Re[tn]);return Object.assign(wn,{cluster:!0,cluster_id:kt[_e+Kr],point_count:tt,point_count_abbreviated:Gt})}function Cu(kt){return kt/360+.5}function Eu(kt){const _e=Math.sin(kt*Math.PI/180),Re=.5-.25*Math.log((1+_e)/(1-_e))/Math.PI;return Re<0?0:Re>1?1:Re}function Pc(kt){const _e=(180-360*kt)*Math.PI/180;return 360*Math.atan(Math.exp(_e))/Math.PI-90}var zt={exports:{}};zt.exports=function(){function kt(Zt,Jt,Wt,On){for(var Bn,gn=On,Gn=Wt-Jt>>1,Ln=Wt-Jt,ii=Zt[Jt],Vn=Zt[Jt+1],ji=Zt[Wt],Ur=Zt[Wt+1],Ci=Jt+3;Ci<Wt;Ci+=3){var Jr=_e(Zt[Ci],Zt[Ci+1],ii,Vn,ji,Ur);if(Jr>gn)Bn=Ci,gn=Jr;else if(Jr===gn){var wo=Math.abs(Ci-Gn);wo<Ln&&(Bn=Ci,Ln=wo)}}gn>On&&(Bn-Jt>3&&kt(Zt,Jt,Bn,On),Zt[Bn+2]=gn,Wt-Bn>3&&kt(Zt,Bn,Wt,On))}function _e(Zt,Jt,Wt,On,Bn,gn){var Gn=Bn-Wt,Ln=gn-On;if(0!==Gn||0!==Ln){var ii=((Zt-Wt)*Gn+(Jt-On)*Ln)/(Gn*Gn+Ln*Ln);ii>1?(Wt=Bn,On=gn):ii>0&&(Wt+=Gn*ii,On+=Ln*ii)}return(Gn=Zt-Wt)*Gn+(Ln=Jt-On)*Ln}function Re(Zt,Jt,Wt,On){var Bn={id:void 0===Zt?null:Zt,type:Jt,geometry:Wt,tags:On,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(gn){var Gn=gn.geometry,Ln=gn.type;if("Point"===Ln||"MultiPoint"===Ln||"LineString"===Ln)tt(gn,Gn);else if("Polygon"===Ln||"MultiLineString"===Ln)for(var ii=0;ii<Gn.length;ii++)tt(gn,Gn[ii]);else if("MultiPolygon"===Ln)for(ii=0;ii<Gn.length;ii++)for(var Vn=0;Vn<Gn[ii].length;Vn++)tt(gn,Gn[ii][Vn])}(Bn),Bn}function tt(Zt,Jt){for(var Wt=0;Wt<Jt.length;Wt+=3)Zt.minX=Math.min(Zt.minX,Jt[Wt]),Zt.minY=Math.min(Zt.minY,Jt[Wt+1]),Zt.maxX=Math.max(Zt.maxX,Jt[Wt]),Zt.maxY=Math.max(Zt.maxY,Jt[Wt+1])}function Gt(Zt,Jt,Wt,On){if(Jt.geometry){var Bn=Jt.geometry.coordinates,gn=Jt.geometry.type,Gn=Math.pow(Wt.tolerance/((1<<Wt.maxZoom)*Wt.extent),2),Ln=[],ii=Jt.id;if(Wt.promoteId?ii=Jt.properties[Wt.promoteId]:Wt.generateId&&(ii=On||0),"Point"===gn)tn(Bn,Ln);else if("MultiPoint"===gn)for(var Vn=0;Vn<Bn.length;Vn++)tn(Bn[Vn],Ln);else if("LineString"===gn)wn(Bn,Ln,Gn,!1);else if("MultiLineString"===gn){if(Wt.lineMetrics){for(Vn=0;Vn<Bn.length;Vn++)wn(Bn[Vn],Ln=[],Gn,!1),Zt.push(Re(ii,"LineString",Ln,Jt.properties));return}zn(Bn,Ln,Gn,!1)}else if("Polygon"===gn)zn(Bn,Ln,Gn,!0);else{if("MultiPolygon"!==gn){if("GeometryCollection"===gn){for(Vn=0;Vn<Jt.geometry.geometries.length;Vn++)Gt(Zt,{id:ii,geometry:Jt.geometry.geometries[Vn],properties:Jt.properties},Wt,On);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Vn=0;Vn<Bn.length;Vn++){var ji=[];zn(Bn[Vn],ji,Gn,!0),Ln.push(ji)}}Zt.push(Re(ii,gn,Ln,Jt.properties))}}function tn(Zt,Jt){Jt.push(Vt(Zt[0])),Jt.push(jn(Zt[1])),Jt.push(0)}function wn(Zt,Jt,Wt,On){for(var Bn,gn,Gn=0,Ln=0;Ln<Zt.length;Ln++){var ii=Vt(Zt[Ln][0]),Vn=jn(Zt[Ln][1]);Jt.push(ii),Jt.push(Vn),Jt.push(0),Ln>0&&(Gn+=On?(Bn*Vn-ii*gn)/2:Math.sqrt(Math.pow(ii-Bn,2)+Math.pow(Vn-gn,2))),Bn=ii,gn=Vn}var ji=Jt.length-3;Jt[2]=1,kt(Jt,0,ji,Wt),Jt[ji+2]=1,Jt.size=Math.abs(Gn),Jt.start=0,Jt.end=Jt.size}function zn(Zt,Jt,Wt,On){for(var Bn=0;Bn<Zt.length;Bn++){var gn=[];wn(Zt[Bn],gn,Wt,On),Jt.push(gn)}}function Vt(Zt){return Zt/360+.5}function jn(Zt){var Jt=Math.sin(Zt*Math.PI/180),Wt=.5-.25*Math.log((1+Jt)/(1-Jt))/Math.PI;return Wt<0?0:Wt>1?1:Wt}function Zn(Zt,Jt,Wt,On,Bn,gn,Gn,Ln){if(On/=Jt,gn>=(Wt/=Jt)&&Gn<On)return Zt;if(Gn<Wt||gn>=On)return null;for(var ii=[],Vn=0;Vn<Zt.length;Vn++){var ji=Zt[Vn],Ur=ji.geometry,Ci=ji.type,Jr=0===Bn?ji.minX:ji.minY,wo=0===Bn?ji.maxX:ji.maxY;if(Jr>=Wt&&wo<On)ii.push(ji);else if(!(wo<Wt||Jr>=On)){var es=[];if("Point"===Ci||"MultiPoint"===Ci)ui(Ur,es,Wt,On,Bn);else if("LineString"===Ci)vr(Ur,es,Wt,On,Bn,!1,Ln.lineMetrics);else if("MultiLineString"===Ci)bo(Ur,es,Wt,On,Bn,!1);else if("Polygon"===Ci)bo(Ur,es,Wt,On,Bn,!0);else if("MultiPolygon"===Ci)for(var qo=0;qo<Ur.length;qo++){var Fo=[];bo(Ur[qo],Fo,Wt,On,Bn,!0),Fo.length&&es.push(Fo)}if(es.length){if(Ln.lineMetrics&&"LineString"===Ci){for(qo=0;qo<es.length;qo++)ii.push(Re(ji.id,Ci,es[qo],ji.tags));continue}"LineString"!==Ci&&"MultiLineString"!==Ci||(1===es.length?(Ci="LineString",es=es[0]):Ci="MultiLineString"),"Point"!==Ci&&"MultiPoint"!==Ci||(Ci=3===es.length?"Point":"MultiPoint"),ii.push(Re(ji.id,Ci,es,ji.tags))}}}return ii.length?ii:null}function ui(Zt,Jt,Wt,On,Bn){for(var gn=0;gn<Zt.length;gn+=3){var Gn=Zt[gn+Bn];Gn>=Wt&&Gn<=On&&(Jt.push(Zt[gn]),Jt.push(Zt[gn+1]),Jt.push(Zt[gn+2]))}}function vr(Zt,Jt,Wt,On,Bn,gn,Gn){for(var Ln,ii,Vn=os(Zt),ji=0===Bn?as:ls,Ur=Zt.start,Ci=0;Ci<Zt.length-3;Ci+=3){var Jr=Zt[Ci],wo=Zt[Ci+1],es=Zt[Ci+2],qo=Zt[Ci+3],Fo=Zt[Ci+4],_s=0===Bn?Jr:wo,su=0===Bn?qo:Fo,Su=!1;Gn&&(Ln=Math.sqrt(Math.pow(Jr-qo,2)+Math.pow(wo-Fo,2))),_s<Wt?su>Wt&&(ii=ji(Vn,Jr,wo,qo,Fo,Wt),Gn&&(Vn.start=Ur+Ln*ii)):_s>On?su<On&&(ii=ji(Vn,Jr,wo,qo,Fo,On),Gn&&(Vn.start=Ur+Ln*ii)):Os(Vn,Jr,wo,es),su<Wt&&_s>=Wt&&(ii=ji(Vn,Jr,wo,qo,Fo,Wt),Su=!0),su>On&&_s<=On&&(ii=ji(Vn,Jr,wo,qo,Fo,On),Su=!0),!gn&&Su&&(Gn&&(Vn.end=Ur+Ln*ii),Jt.push(Vn),Vn=os(Zt)),Gn&&(Ur+=Ln)}var da=Zt.length-3;Jr=Zt[da],wo=Zt[da+1],es=Zt[da+2],(_s=0===Bn?Jr:wo)>=Wt&&_s<=On&&Os(Vn,Jr,wo,es),da=Vn.length-3,gn&&da>=3&&(Vn[da]!==Vn[0]||Vn[da+1]!==Vn[1])&&Os(Vn,Vn[0],Vn[1],Vn[2]),Vn.length&&Jt.push(Vn)}function os(Zt){var Jt=[];return Jt.size=Zt.size,Jt.start=Zt.start,Jt.end=Zt.end,Jt}function bo(Zt,Jt,Wt,On,Bn,gn){for(var Gn=0;Gn<Zt.length;Gn++)vr(Zt[Gn],Jt,Wt,On,Bn,gn,!1)}function Os(Zt,Jt,Wt,On){Zt.push(Jt),Zt.push(Wt),Zt.push(On)}function as(Zt,Jt,Wt,On,Bn,gn){var Gn=(gn-Jt)/(On-Jt);return Zt.push(gn),Zt.push(Wt+(Bn-Wt)*Gn),Zt.push(1),Gn}function ls(Zt,Jt,Wt,On,Bn,gn){var Gn=(gn-Wt)/(Bn-Wt);return Zt.push(Jt+(On-Jt)*Gn),Zt.push(gn),Zt.push(1),Gn}function Ss(Zt,Jt){for(var Wt=[],On=0;On<Zt.length;On++){var Bn,gn=Zt[On],Gn=gn.type;if("Point"===Gn||"MultiPoint"===Gn||"LineString"===Gn)Bn=ro(gn.geometry,Jt);else if("MultiLineString"===Gn||"Polygon"===Gn){Bn=[];for(var Ln=0;Ln<gn.geometry.length;Ln++)Bn.push(ro(gn.geometry[Ln],Jt))}else if("MultiPolygon"===Gn)for(Bn=[],Ln=0;Ln<gn.geometry.length;Ln++){for(var ii=[],Vn=0;Vn<gn.geometry[Ln].length;Vn++)ii.push(ro(gn.geometry[Ln][Vn],Jt));Bn.push(ii)}Wt.push(Re(gn.id,Gn,Bn,gn.tags))}return Wt}function ro(Zt,Jt){var Wt=[];Wt.size=Zt.size,void 0!==Zt.start&&(Wt.start=Zt.start,Wt.end=Zt.end);for(var On=0;On<Zt.length;On+=3)Wt.push(Zt[On]+Jt,Zt[On+1],Zt[On+2]);return Wt}function ca(Zt,Jt){if(Zt.transformed)return Zt;var Wt,On,Bn,gn=1<<Zt.z,Gn=Zt.x,Ln=Zt.y;for(Wt=0;Wt<Zt.features.length;Wt++){var ii=Zt.features[Wt],Vn=ii.geometry,ji=ii.type;if(ii.geometry=[],1===ji)for(On=0;On<Vn.length;On+=2)ii.geometry.push(fo(Vn[On],Vn[On+1],Jt,gn,Gn,Ln));else for(On=0;On<Vn.length;On++){var Ur=[];for(Bn=0;Bn<Vn[On].length;Bn+=2)Ur.push(fo(Vn[On][Bn],Vn[On][Bn+1],Jt,gn,Gn,Ln));ii.geometry.push(Ur)}}return Zt.transformed=!0,Zt}function fo(Zt,Jt,Wt,On,Bn,gn){return[Math.round(Wt*(Zt*On-Bn)),Math.round(Wt*(Jt*On-gn))]}function Za(Zt,Jt,Wt,On,Bn){for(var gn=Jt===Bn.maxZoom?0:Bn.tolerance/((1<<Jt)*Bn.extent),Gn={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Wt,y:On,z:Jt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ln=0;Ln<Zt.length;Ln++){Gn.numFeatures++,Xa(Gn,Zt[Ln],gn,Bn);var ii=Zt[Ln].minX,Vn=Zt[Ln].minY,ji=Zt[Ln].maxX,Ur=Zt[Ln].maxY;ii<Gn.minX&&(Gn.minX=ii),Vn<Gn.minY&&(Gn.minY=Vn),ji>Gn.maxX&&(Gn.maxX=ji),Ur>Gn.maxY&&(Gn.maxY=Ur)}return Gn}function Xa(Zt,Jt,Wt,On){var Bn=Jt.geometry,gn=Jt.type,Gn=[];if("Point"===gn||"MultiPoint"===gn)for(var Ln=0;Ln<Bn.length;Ln+=3)Gn.push(Bn[Ln]),Gn.push(Bn[Ln+1]),Zt.numPoints++,Zt.numSimplified++;else if("LineString"===gn)zl(Gn,Bn,Zt,Wt,!1,!1);else if("MultiLineString"===gn||"Polygon"===gn)for(Ln=0;Ln<Bn.length;Ln++)zl(Gn,Bn[Ln],Zt,Wt,"Polygon"===gn,0===Ln);else if("MultiPolygon"===gn)for(var ii=0;ii<Bn.length;ii++){var Vn=Bn[ii];for(Ln=0;Ln<Vn.length;Ln++)zl(Gn,Vn[Ln],Zt,Wt,!0,0===Ln)}if(Gn.length){var ji=Jt.tags||null;if("LineString"===gn&&On.lineMetrics){for(var Ur in ji={},Jt.tags)ji[Ur]=Jt.tags[Ur];ji.mapbox_clip_start=Bn.start/Bn.size,ji.mapbox_clip_end=Bn.end/Bn.size}var Ci={geometry:Gn,type:"Polygon"===gn||"MultiPolygon"===gn?3:"LineString"===gn||"MultiLineString"===gn?2:1,tags:ji};null!==Jt.id&&(Ci.id=Jt.id),Zt.features.push(Ci)}}function zl(Zt,Jt,Wt,On,Bn,gn){var Gn=On*On;if(On>0&&Jt.size<(Bn?Gn:On))Wt.numPoints+=Jt.length/3;else{for(var Ln=[],ii=0;ii<Jt.length;ii+=3)(0===On||Jt[ii+2]>Gn)&&(Wt.numSimplified++,Ln.push(Jt[ii]),Ln.push(Jt[ii+1])),Wt.numPoints++;Bn&&function(Vn,ji){for(var Ur=0,Ci=0,Jr=Vn.length,wo=Jr-2;Ci<Jr;wo=Ci,Ci+=2)Ur+=(Vn[Ci]-Vn[wo])*(Vn[Ci+1]+Vn[wo+1]);if(Ur>0===ji)for(Ci=0,Jr=Vn.length;Ci<Jr/2;Ci+=2){var es=Vn[Ci],qo=Vn[Ci+1];Vn[Ci]=Vn[Jr-2-Ci],Vn[Ci+1]=Vn[Jr-1-Ci],Vn[Jr-2-Ci]=es,Vn[Jr-1-Ci]=qo}}(Ln,gn),Zt.push(Ln)}}function ua(Zt,Jt){var Wt=(Jt=this.options=function(Bn,gn){for(var Gn in gn)Bn[Gn]=gn[Gn];return Bn}(Object.create(this.options),Jt)).debug;if(Wt&&console.time("preprocess data"),Jt.maxZoom<0||Jt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Jt.promoteId&&Jt.generateId)throw new Error("promoteId and generateId cannot be used together.");var Bn,gn,Gn,Ln,ii,Vn,On=function(Bn,gn){var Gn=[];if("FeatureCollection"===Bn.type)for(var Ln=0;Ln<Bn.features.length;Ln++)Gt(Gn,Bn.features[Ln],gn,Ln);else Gt(Gn,"Feature"===Bn.type?Bn:{geometry:Bn},gn);return Gn}(Zt,Jt);this.tiles={},this.tileCoords=[],Wt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Jt.indexMaxZoom,Jt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Bn=On,gn=Jt,Gn=gn.buffer/gn.extent,Ln=Bn,ii=Zn(Bn,1,-1-Gn,Gn,0,-1,2,gn),Vn=Zn(Bn,1,1-Gn,2+Gn,0,-1,2,gn),(ii||Vn)&&(Ln=Zn(Bn,1,-Gn,1+Gn,0,-1,2,gn)||[],ii&&(Ln=Ss(ii,1).concat(Ln)),Vn&&(Ln=Ln.concat(Ss(Vn,-1)))),On=Ln).length&&this.splitTile(On,0,0,0),Wt&&(On.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ha(Zt,Jt,Wt){return 32*((1<<Zt)*Wt+Jt)+Zt}return ua.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ua.prototype.splitTile=function(Zt,Jt,Wt,On,Bn,gn,Gn){for(var Ln=[Zt,Jt,Wt,On],ii=this.options,Vn=ii.debug;Ln.length;){On=Ln.pop(),Wt=Ln.pop(),Jt=Ln.pop(),Zt=Ln.pop();var ji=1<<Jt,Ur=ha(Jt,Wt,On),Ci=this.tiles[Ur];if(!Ci&&(Vn>1&&console.time("creation"),Ci=this.tiles[Ur]=Za(Zt,Jt,Wt,On,ii),this.tileCoords.push({z:Jt,x:Wt,y:On}),Vn)){Vn>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Jt,Wt,On,Ci.numFeatures,Ci.numPoints,Ci.numSimplified),console.timeEnd("creation"));var Jr="z"+Jt;this.stats[Jr]=(this.stats[Jr]||0)+1,this.total++}if(Ci.source=Zt,Bn){if(Jt===ii.maxZoom||Jt===Bn)continue;var wo=1<<Bn-Jt;if(Wt!==Math.floor(gn/wo)||On!==Math.floor(Gn/wo))continue}else if(Jt===ii.indexMaxZoom||Ci.numPoints<=ii.indexMaxPoints)continue;if(Ci.source=null,0!==Zt.length){Vn>1&&console.time("clipping");var es,qo,Fo,_s,su,Su,da=.5*ii.buffer/ii.extent,ad=.5-da,fc=.5+da,If=1+da;es=qo=Fo=_s=null,su=Zn(Zt,ji,Wt-da,Wt+fc,0,Ci.minX,Ci.maxX,ii),Su=Zn(Zt,ji,Wt+ad,Wt+If,0,Ci.minX,Ci.maxX,ii),Zt=null,su&&(es=Zn(su,ji,On-da,On+fc,1,Ci.minY,Ci.maxY,ii),qo=Zn(su,ji,On+ad,On+If,1,Ci.minY,Ci.maxY,ii),su=null),Su&&(Fo=Zn(Su,ji,On-da,On+fc,1,Ci.minY,Ci.maxY,ii),_s=Zn(Su,ji,On+ad,On+If,1,Ci.minY,Ci.maxY,ii),Su=null),Vn>1&&console.timeEnd("clipping"),Ln.push(es||[],Jt+1,2*Wt,2*On),Ln.push(qo||[],Jt+1,2*Wt,2*On+1),Ln.push(Fo||[],Jt+1,2*Wt+1,2*On),Ln.push(_s||[],Jt+1,2*Wt+1,2*On+1)}}},ua.prototype.getTile=function(Zt,Jt,Wt){var On=this.options,Bn=On.extent,gn=On.debug;if(Zt<0||Zt>24)return null;var Gn=1<<Zt,Ln=ha(Zt,Jt=(Jt%Gn+Gn)%Gn,Wt);if(this.tiles[Ln])return ca(this.tiles[Ln],Bn);gn>1&&console.log("drilling down to z%d-%d-%d",Zt,Jt,Wt);for(var ii,Vn=Zt,ji=Jt,Ur=Wt;!ii&&Vn>0;)Vn--,ji=Math.floor(ji/2),Ur=Math.floor(Ur/2),ii=this.tiles[ha(Vn,ji,Ur)];return ii&&ii.source?(gn>1&&console.log("found parent tile z%d-%d-%d",Vn,ji,Ur),gn>1&&console.time("drilling down"),this.splitTile(ii.source,Vn,ji,Ur,Zt,Jt,Wt),gn>1&&console.timeEnd("drilling down"),this.tiles[Ln]?ca(this.tiles[Ln],Bn):null):null},function(Zt,Jt){return new ua(Zt,Jt)}}();var Ct=p.dK(zt.exports);function vn(kt,_e){const Re=kt.tileID.canonical;if(!this._geoJSONIndex)return _e(null,null);const tt=this._geoJSONIndex.getTile(Re.z,Re.x,Re.y);if(!tt)return _e(null,null);const Gt=new class{constructor(kt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.V,this.length=kt.length,this._features=kt}feature(kt){return new class{constructor(kt){this._feature=kt,this.extent=p.V,this.type=kt.type,this.properties=kt.tags,"id"in kt&&!isNaN(kt.id)&&(this.id=parseInt(kt.id,10))}loadGeometry(){if(1===this._feature.type){const kt=[];for(const _e of this._feature.geometry)kt.push([new p.P(_e[0],_e[1])]);return kt}{const kt=[];for(const _e of this._feature.geometry){const Re=[];for(const tt of _e)Re.push(new p.P(tt[0],tt[1]));kt.push(Re)}return kt}}toGeoJSON(kt,_e,Re){return Ul.call(this,kt,_e,Re)}}(this._features[kt])}}(tt.features);let tn=Li(Gt);0===tn.byteOffset&&tn.byteLength===tn.buffer.byteLength||(tn=new Uint8Array(tn)),_e(null,{vectorTile:Gt,rawData:tn.buffer})}class Hn extends Ih{constructor(_e,Re,tt,Gt,tn,wn){super(_e,Re,tt,Gt,vn,wn),tn&&(this.loadGeoJSON=tn)}loadData(_e,Re){const tt=_e&&_e.request,Gt=tt&&tt.collectResourceTiming;this.loadGeoJSON(_e,(tn,wn)=>{if(tn||!wn)return Re(tn);if("object"!=typeof wn)return Re(new Error(`Input data given to '${_e.source}' is not a valid GeoJSON object.`));{Oc(wn,!0);try{if(_e.filter){const Vt=p.r(_e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Vt.result)throw new Error(Vt.value.map(Zn=>`${Zn.key}: ${Zn.message}`).join(", "));wn={type:"FeatureCollection",features:wn.features.filter(Zn=>Vt.value.evaluate({zoom:0},Zn))}}this._geoJSONIndex=_e.cluster?new Nd(function({superclusterOptions:Vt,clusterProperties:jn}){if(!jn||!Vt)return Vt;const Zn={},ui={},vr={accumulated:null,zoom:0},os={properties:null},bo=Object.keys(jn);for(const Os of bo){const[as,ls]=jn[Os],Ss=p.r(ls),ro=p.r("string"==typeof as?[as,["accumulated"],["get",Os]]:as);Zn[Os]=Ss.value,ui[Os]=ro.value}return Vt.map=Os=>{os.properties=Os;const as={};for(const ls of bo)as[ls]=Zn[ls].evaluate(vr,os);return as},Vt.reduce=(Os,as)=>{os.properties=as;for(const ls of bo)vr.accumulated=Os[ls],Os[ls]=ui[ls].evaluate(vr,os)},Vt}(_e)).load(wn.features):Ct(wn,_e.geojsonVtOptions)}catch(Vt){return Re(Vt)}this.loaded={};const zn={};if(Gt){const Vt=Ai(tt);Vt&&(zn.resourceTiming={},zn.resourceTiming[_e.source]=JSON.parse(JSON.stringify(Vt)))}Re(null,zn)}})}reloadTile(_e,Re){const tt=this.loaded;return tt&&tt[_e.uid]?super.reloadTile(_e,Re):this.loadTile(_e,Re)}loadGeoJSON(_e,Re){if(_e.request)p.g(_e.request,Re);else{if("string"!=typeof _e.data)return Re(new Error(`Input data given to '${_e.source}' is not a valid GeoJSON object.`));try{return Re(null,JSON.parse(_e.data))}catch{return Re(new Error(`Input data given to '${_e.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(_e,Re){try{Re(null,this._geoJSONIndex.getClusterExpansionZoom(_e.clusterId))}catch(tt){Re(tt)}}getClusterChildren(_e,Re){try{Re(null,this._geoJSONIndex.getChildren(_e.clusterId))}catch(tt){Re(tt)}}getClusterLeaves(_e,Re){try{Re(null,this._geoJSONIndex.getLeaves(_e.clusterId,_e.limit,_e.offset))}catch(tt){Re(tt)}}}class _i{constructor(_e,Re){this.tileID=new p.am(_e.tileID.overscaledZ,_e.tileID.wrap,_e.tileID.canonical.z,_e.tileID.canonical.x,_e.tileID.canonical.y),this.tileZoom=_e.tileZoom,this.uid=_e.uid,this.zoom=_e.zoom,this.canonical=_e.tileID.canonical,this.pixelRatio=_e.pixelRatio,this.tileSize=_e.tileSize,this.source=_e.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=_e.projection,this.brightness=Re}parse(_e,Re,tt,Gt){this.status="parsing";const tn=new p.am(tt.tileID.overscaledZ,tt.tileID.wrap,tt.tileID.canonical.z,tt.tileID.canonical.x,tt.tileID.canonical.y),wn={},zn=Re.familiesBySource[tt.source],Vt=new p.dC(tn,tt.promoteId);return Vt.bucketLayerIDs=[],Vt.is3DTile=!0,p.dP(_e).then(jn=>{if(!jn)return Gt(new Error("Could not parse tile"));const Zn=p.dQ(jn,1/p.bR(tt.tileID.canonical)),ui=jn.json.extensionsUsed&&jn.json.extensionsUsed.includes("MAPBOX_mesh_features")||jn.json.asset.extras&&jn.json.asset.extras.MAPBOX_mesh_features,vr=jn.json.extensionsUsed&&jn.json.extensionsUsed.includes("EXT_meshopt_compression"),os=new p.K(this.zoom,{brightness:this.brightness});for(const bo in zn)for(const Os of zn[bo]){const as=Os[0];Vt.bucketLayerIDs.push(Os.map(Ss=>Ss.id)),as.recalculate(os,[]);const ls=new p.dR(Zn,tn,ui,vr,this.brightness,Vt);ui||(ls.needsUpload=!0),wn[as.fqid]=ls,ls.evaluate(as)}this.status="done",Gt(null,{buckets:wn,featureIndex:Vt})}).catch(jn=>Gt(new Error(jn.message)))}}class Mi{constructor(_e,Re,tt,Gt,tn,wn){this.actor=_e,this.layerIndex=Re,this.brightness=wn,this.loading={},this.loaded={}}loadTile(_e,Re){const tt=_e.uid,Gt=this.loading[tt]=new _i(_e,this.brightness);p.a_(_e.request,(tn,wn)=>{const zn=!this.loading[tt];return delete this.loading[tt],zn||tn?(Gt.status="done",zn||(this.loaded[tt]=Gt),Re(tn)):wn&&0!==wn.byteLength?void Gt.parse(wn,this.layerIndex,_e,(Vt,jn)=>{Gt.status="done",this.loaded=this.loaded||{},this.loaded[tt]=Gt,Vt||!jn?Re(Vt):Re(null,jn)}):(Gt.status="done",this.loaded[tt]=Gt,Re())})}reloadTile(_e,Re){const tt=this.loaded,Gt=_e.uid;if(tt&&tt[Gt]){const tn=tt[Gt];tn.projection=_e.projection,tn.brightness=_e.brightness;const wn=(zn,Vt)=>{tn.reloadCallback&&(delete tn.reloadCallback,this.loadTile(_e,Re)),Re(zn,Vt)};"parsing"===tn.status?tn.reloadCallback=wn:"done"===tn.status&&this.loadTile(_e,Re)}}abortTile(_e,Re){const tt=_e.uid;this.loading[tt]&&delete this.loading[tt],Re()}removeTile(_e,Re){const tt=this.loaded,Gt=_e.uid;tt&&tt[Gt]&&delete tt[Gt],Re()}}class Lo{constructor(_e){this.self=_e,this.actor=new p.dS(_e,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=p.bo({name:"mercator"}),this.workerSourceTypes={vector:Ih,geojson:Hn,"batched-model":Mi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Re,tt)=>{if(this.workerSourceTypes[Re])throw new Error(`Worker source with name "${Re}" already registered.`);this.workerSourceTypes[Re]=tt},this.self.registerRTLTextPlugin=Re=>{if(p.dT.isParsed())throw new Error("RTL text plugin already registered.");p.dT.applyArabicShaping=Re.applyArabicShaping,p.dT.processBidirectionalText=Re.processBidirectionalText,p.dT.processStyledBidirectionalText=Re.processStyledBidirectionalText}}clearCaches(_e,Re,tt){delete this.layerIndexes[_e],delete this.availableImages[_e],delete this.workerSources[_e],delete this.demWorkerSources[_e],delete this.rasterArrayWorkerSource,tt()}checkIfReady(_e,Re,tt){tt()}setReferrer(_e,Re){this.referrer=Re}spriteLoaded(_e,{scope:Re,isLoaded:tt}){if(this.isSpriteLoaded[_e]||(this.isSpriteLoaded[_e]={}),this.isSpriteLoaded[_e][Re]=tt,this.workerSources[_e]&&this.workerSources[_e][Re])for(const Gt in this.workerSources[_e][Re]){const tn=this.workerSources[_e][Re][Gt];for(const wn in tn)tn[wn]instanceof Ih&&(tn[wn].isSpriteLoaded=tt,tn[wn].fire(new p.b("isSpriteLoaded")))}}setImages(_e,{scope:Re,images:tt},Gt){if(this.availableImages[_e]||(this.availableImages[_e]={}),this.availableImages[_e][Re]=tt,this.workerSources[_e]&&this.workerSources[_e][Re]){for(const tn in this.workerSources[_e][Re]){const wn=this.workerSources[_e][Re][tn];for(const zn in wn)wn[zn].availableImages=tt}Gt()}else Gt()}setProjection(_e,Re){this.projections[_e]=p.bo(Re)}setBrightness(_e,Re,tt){this.brightness=Re,tt()}setLayers(_e,Re,tt){this.getLayerIndex(_e,Re.scope).replace(Re.layers,Re.options),tt()}updateLayers(_e,Re,tt){this.getLayerIndex(_e,Re.scope).update(Re.layers,Re.removedIds,Re.options),tt()}loadTile(_e,Re,tt){Re.projection=this.projections[_e]||this.defaultProjection,this.getWorkerSource(_e,Re.type,Re.source,Re.scope).loadTile(Re,tt)}loadDEMTile(_e,Re,tt){this.getDEMWorkerSource(_e,Re.source,Re.scope).loadTile(Re,tt)}decodeRasterArray(_e,Re,tt){this.getRasterArrayWorkerSource().decodeRasterArray(Re,tt)}reloadTile(_e,Re,tt){Re.projection=this.projections[_e]||this.defaultProjection,this.getWorkerSource(_e,Re.type,Re.source,Re.scope).reloadTile(Re,tt)}abortTile(_e,Re,tt){this.getWorkerSource(_e,Re.type,Re.source,Re.scope).abortTile(Re,tt)}removeTile(_e,Re,tt){this.getWorkerSource(_e,Re.type,Re.source,Re.scope).removeTile(Re,tt)}removeSource(_e,Re,tt){if(!(this.workerSources[_e]&&this.workerSources[_e][Re.scope]&&this.workerSources[_e][Re.scope][Re.type]&&this.workerSources[_e][Re.scope][Re.type][Re.source]))return;const Gt=this.workerSources[_e][Re.scope][Re.type][Re.source];delete this.workerSources[_e][Re.scope][Re.type][Re.source],void 0!==Gt.removeSource?Gt.removeSource(Re,tt):tt()}loadWorkerSource(_e,Re,tt){try{this.self.importScripts(Re.url),tt()}catch(Gt){tt(Gt.toString())}}syncRTLPluginState(_e,Re,tt){try{p.dT.setState(Re);const Gt=p.dT.getPluginURL();if(p.dT.isLoaded()&&!p.dT.isParsed()&&null!=Gt){this.self.importScripts(Gt);const tn=p.dT.isParsed();tt(tn?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Gt}`),tn)}}catch(Gt){tt(Gt.toString())}}setDracoUrl(_e,Re){this.dracoUrl=Re}getAvailableImages(_e,Re){this.availableImages[_e]||(this.availableImages[_e]={});let tt=this.availableImages[_e][Re];return tt||(tt=[]),tt}getLayerIndex(_e,Re){this.layerIndexes[_e]||(this.layerIndexes[_e]={});let tt=this.layerIndexes[_e][Re];return tt||(tt=this.layerIndexes[_e][Re]=new El,tt.scope=Re),tt}getWorkerSource(_e,Re,tt,Gt){return this.workerSources[_e]||(this.workerSources[_e]={}),this.workerSources[_e][Gt]||(this.workerSources[_e][Gt]={}),this.workerSources[_e][Gt][Re]||(this.workerSources[_e][Gt][Re]={}),this.isSpriteLoaded[_e]||(this.isSpriteLoaded[_e]={}),this.workerSources[_e][Gt][Re][tt]||(this.workerSources[_e][Gt][Re][tt]=new this.workerSourceTypes[Re]({send:(wn,zn,Vt,jn,Zn,ui)=>{this.actor.send(wn,zn,Vt,_e,Zn,ui)},scheduler:this.actor.scheduler},this.getLayerIndex(_e,Gt),this.getAvailableImages(_e,Gt),this.isSpriteLoaded[_e][Gt],void 0,this.brightness)),this.workerSources[_e][Gt][Re][tt]}getDEMWorkerSource(_e,Re,tt){return this.demWorkerSources[_e]||(this.demWorkerSources[_e]={}),this.demWorkerSources[_e][tt]||(this.demWorkerSources[_e][tt]={}),this.demWorkerSources[_e][tt][Re]||(this.demWorkerSources[_e][tt][Re]=new Dh),this.demWorkerSources[_e][tt][Re]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new Ta),this.rasterArrayWorkerSource}enforceCacheSizeLimit(_e,Re){p.dU(Re)}getWorkerPerformanceMetrics(_e,Re,tt){tt(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Lo(self)),Lo}),Mo(0,function(p){function Ai(_,c){if(Array.isArray(_)){if(!Array.isArray(c)||_.length!==c.length)return!1;for(let d=0;d<_.length;d++)if(!Ai(_[d],c[d]))return!1;return!0}if("object"==typeof _&&null!==_&&null!==c){if("object"!=typeof c||Object.keys(_).length!==Object.keys(c).length)return!1;for(const d in _)if(!Ai(_[d],c[d]))return!1;return!0}return _===c}var Ra=ar;function ar(_){return c=_,!(typeof window>"u"||typeof document>"u"||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,w,C=new Blob([""],{type:"text/javascript"}),I=URL.createObjectURL(C);try{w=new Worker(I),y=!0}catch{y=!1}return w&&w.terminate(),URL.revokeObjectURL(I),y}()||!function(){var y=document.createElement("canvas");y.width=y.height=1;var w=y.getContext("2d");if(!w)return!1;var C=w.getImageData(0,0,1,1);return C&&C.width===y.width}()||(void 0===El[d=c&&c.failIfMajorPerformanceCaveat]&&(El[d]=function(y){var w,I,B,P,C=(I=y,B=document.createElement("canvas"),(P=Object.create(ar.webGLContextAttributes)).failIfMajorPerformanceCaveat=I,B.getContext("webgl2",P));if(!C)return!1;try{w=C.createShader(C.VERTEX_SHADER)}catch{return!1}return!(!w||C.isContextLost())&&(C.shaderSource(w,"void main() {}"),C.compileShader(w),!0===C.getShaderParameter(w,C.COMPILE_STATUS))}(d)),!El[d]||document.documentMode));var c,d}var El={};function Di(_,c,d){const y=document.createElement(_);return null!=c&&(y.className=c),d&&d.appendChild(y),y}function ia(_,c,d){const y=document.createElementNS("http://www.w3.org/2000/svg",_);for(const w of Object.keys(c))y.setAttributeNS(null,w,String(c[w]));return d&&d.appendChild(y),y}ar.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Wa=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Sa=Wa&&void 0!==Wa.userSelect?"userSelect":"WebkitUserSelect";let Ih;function Dh(){Wa&&Sa&&(Ih=Wa[Sa],Wa[Sa]="none")}function Ta(){Wa&&Sa&&(Wa[Sa]=Ih)}function Bh(_){_.preventDefault(),_.stopPropagation(),window.removeEventListener("click",Bh,!0)}function ec(){window.addEventListener("click",Bh,!0),window.setTimeout(()=>{window.removeEventListener("click",Bh,!0)},0)}function Oc(_,c){const d=_.getBoundingClientRect();return Nn(_,d,c)}function Ul(_,c){const d=_.getBoundingClientRect(),y=[];for(let w=0;w<c.length;w++)y.push(Nn(_,d,c[w]));return y}function tc(_){return void 0!==window.InstallTrigger&&2===_.button&&_.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button}function Nn(_,c,d){const y=_.offsetWidth===c.width?1:_.offsetWidth/c.width;return new p.P((d.clientX-c.left)*y,(d.clientY-c.top)*y)}class Sl{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(c,d){this._updatedSourceCaches[c]=d,this.setDirty()}discardSourceCacheUpdate(c){delete this._updatedSourceCaches[c]}updateLayer(c){const d=c.scope;this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._updatedLayers[d].add(c.id),this.setDirty()}removeLayer(c){const d=c.scope;this._removedLayers[d]=this._removedLayers[d]||{},this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._removedLayers[d][c.id]=c,this._updatedLayers[d].delete(c.id),this._updatedPaintProps.delete(c.fqid),this.setDirty()}getRemovedLayer(c){return this._removedLayers[c.scope]?this._removedLayers[c.scope][c.id]:null}discardLayerRemoval(c){this._removedLayers[c.scope]&&delete this._removedLayers[c.scope][c.id]}getLayerUpdatesByScope(){const c={};for(const d in this._updatedLayers)c[d]=c[d]||{},c[d].updatedIds=Array.from(this._updatedLayers[d].values());for(const d in this._removedLayers)c[d]=c[d]||{},c[d].removedIds=Object.keys(this._removedLayers[d]);return c}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(c){this._updatedPaintProps.add(c.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(c){this._updatedImages.add(c),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}class od extends p.E{constructor(c){super(),this.requestManager=c,this.models={"":{}},this.numModelsLoading={}}loadModel(c,d){return p.l(this.requestManager.transformRequest(d,p.R.Model).url).then(y=>{if(!y)return;const w=p.c(y),C=new p.M(c,void 0,void 0,w);return C.computeBoundsAndApplyParent(),C}).catch(y=>{this.fire(new p.a(new Error(`Could not load model ${c} from ${d}: ${y.message}`)))})}load(c,d){this.models[d]||(this.models[d]={});const y=Object.keys(c);this.numModelsLoading[d]=(this.numModelsLoading[d]||0)+y.length;const w=[];for(const C of y)w.push(this.loadModel(C,c[C]));Promise.allSettled(w).then(C=>{for(let I=0;I<C.length;I++){const{status:B,value:P}=C[I];"fulfilled"===B&&P&&(this.models[d][y[I]]=P)}this.numModelsLoading[d]-=y.length,this.fire(new p.b("data",{dataType:"style"}))}).catch(C=>{this.fire(new p.a(new Error(`Could not load models: ${C.message}`)))})}isLoaded(){for(const c in this.numModelsLoading)if(this.numModelsLoading[c]>0)return!1;return!0}hasModel(c,d){return!!this.getModel(c,d)}getModel(c,d){return this.models[d]||(this.models[d]={}),this.models[d][c]}addModel(c,d,y){this.models[y]||(this.models[y]={}),this.hasModel(c,y)&&this.removeModel(c,y),this.load({[c]:this.requestManager.normalizeModelURL(d)},y)}addModels(c,d){const y={};for(const w in c)y[w]=this.requestManager.normalizeModelURL(c[w]);this.load(y,d)}removeModel(c,d){this.models[d]||(this.models[d]={});const y=this.models[d][c];delete this.models[d][c],y.destroy()}listModels(c){return this.models[c]||(this.models[c]={}),Object.keys(this.models[c])}upload(c,d){this.models[d]||(this.models[d]={});for(const y in this.models[d])this.models[d][y].upload(c.context)}}class Sr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,d,y){const w=String(d);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][w]=this.stateChanges[c][w]||{},p.e(this.stateChanges[c][w],y),null===this.deletedStates[c]){this.deletedStates[c]={};for(const C in this.state[c])C!==w&&(this.deletedStates[c][C]=null)}else if(this.deletedStates[c]&&null===this.deletedStates[c][w]){this.deletedStates[c][w]={};for(const C in this.state[c][w])y[C]||(this.deletedStates[c][w][C]=null)}else for(const C in y)this.deletedStates[c]&&this.deletedStates[c][w]&&null===this.deletedStates[c][w][C]&&delete this.deletedStates[c][w][C]}removeFeatureState(c,d,y){if(null===this.deletedStates[c])return;const w=String(d);if(this.deletedStates[c]=this.deletedStates[c]||{},y&&void 0!==d)null!==this.deletedStates[c][w]&&(this.deletedStates[c][w]=this.deletedStates[c][w]||{},this.deletedStates[c][w][y]=null);else if(void 0!==d)if(this.stateChanges[c]&&this.stateChanges[c][w])for(y in this.deletedStates[c][w]={},this.stateChanges[c][w])this.deletedStates[c][w][y]=null;else this.deletedStates[c][w]=null;else this.deletedStates[c]=null}getState(c,d){const y=String(d),w=p.e({},(this.state[c]||{})[y],(this.stateChanges[c]||{})[y]);if(null===this.deletedStates[c])return{};if(this.deletedStates[c]){const C=this.deletedStates[c][d];if(null===C)return{};for(const I in C)delete w[I]}return w}initializeTileState(c,d){c.setFeatureState(this.state,d)}coalesceChanges(c,d){const y={};for(const w in this.stateChanges){this.state[w]=this.state[w]||{};const C={};for(const I in this.stateChanges[w])this.state[w][I]||(this.state[w][I]={}),p.e(this.state[w][I],this.stateChanges[w][I]),C[I]=this.state[w][I];y[w]=C}for(const w in this.deletedStates){this.state[w]=this.state[w]||{};const C={};if(null===this.deletedStates[w])for(const I in this.state[w])C[I]={},this.state[w][I]={};else for(const I in this.deletedStates[w]){if(null===this.deletedStates[w][I])this.state[w][I]={};else if(this.state[w][I])for(const B of Object.keys(this.deletedStates[w][I]))delete this.state[w][I][B];C[I]=this.state[w][I]}y[w]=y[w]||{},p.e(y[w],C)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(y).length)for(const w in c)c[w].setFeatureState(y,d)}}function Jo(_){const{userImage:c}=_;return!!(c&&c.render&&c.render())&&(_.data.replace(new Uint8Array(c.data.buffer)),!0)}class EA extends p.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(c){this.images[c]={},this.loaded[c]=!1,this.updatedImages[c]={},this.patterns[c]={},this.callbackDispatchedThisFrame[c]={},this.atlasImage[c]=new p.h({width:1,height:1})}isLoaded(){for(const c in this.loaded)if(!this.loaded[c])return!1;return!0}setLoaded(c,d){if(this.loaded[d]!==c&&(this.loaded[d]=c,c)){for(const{ids:y,callback:w}of this.requestors)this._notify(y,d,w);this.requestors=[]}}hasImage(c,d){return!!this.getImage(c,d)}getImage(c,d){return this.images[d][c]}addImage(c,d,y){this._validate(c,y)&&(this.images[d][c]=y)}_validate(c,d){let y=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new p.a(new Error(`Image "${c}" has invalid "stretchX" value`))),y=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new p.a(new Error(`Image "${c}" has invalid "stretchY" value`))),y=!1),this._validateContent(d.content,d)||(this.fire(new p.a(new Error(`Image "${c}" has invalid "content" value`))),y=!1),y}_validateStretch(c,d){if(!c)return!0;let y=0;for(const w of c){if(w[0]<y||w[1]<w[0]||d<w[1])return!1;y=w[1]}return!0}_validateContent(c,d){return!(c&&(4!==c.length||c[0]<0||d.data.width<c[0]||c[1]<0||d.data.height<c[1]||c[2]<0||d.data.width<c[2]||c[3]<0||d.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,d,y){y.version=this.images[d][c].version+1,this.images[d][c]=y,this.updatedImages[d][c]=!0}removeImage(c,d){const y=this.images[d][c];delete this.images[d][c],delete this.patterns[d][c],y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(c){return Object.keys(this.images[c])}getImages(c,d,y){let w=!0;const C=!!this.loaded[d];if(!C)for(const I of c)this.images[d][I]||(w=!1);C||w?this._notify(c,d,y):this.requestors.push({ids:c,scope:d,callback:y})}getUpdatedImages(c){return this.updatedImages[c]}_notify(c,d,y){const w={};for(const C of c){this.images[d][C]||this.fire(new p.b("styleimagemissing",{id:C}));const I=this.images[d][C];I?w[C]={data:I.data.clone(),pixelRatio:I.pixelRatio,sdf:I.sdf,version:I.version,stretchX:I.stretchX,stretchY:I.stretchY,content:I.content,hasRenderCallback:!(!I.userImage||!I.userImage.render)}:p.w(`Image "${C}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}y(null,w)}getPixelSize(c){const{width:d,height:y}=this.atlasImage[c];return{width:d,height:y}}getPattern(c,d){const y=this.patterns[d][c],w=this.getImage(c,d);if(!w)return null;if(y&&y.position.version===w.version)return y.position;if(y)y.position.version=w.version;else{const C={w:w.data.width+2,h:w.data.height+2,x:0,y:0},I=new p.I(C,w);this.patterns[d][c]={bin:C,position:I}}return this._updatePatternAtlas(d),this.patterns[d][c].position}bind(c,d){const y=c.gl;let w=this.atlasTexture[d];w?this.dirty&&(w.update(this.atlasImage[d]),this.dirty=!1):(w=new p.T(c,this.atlasImage[d],y.RGBA),this.atlasTexture[d]=w),w.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(c){const d=[];for(const I in this.patterns[c])d.push(this.patterns[c][I].bin);const{w:y,h:w}=p.p(d),C=this.atlasImage[c];C.resize({width:y||1,height:w||1});for(const I in this.patterns[c]){const{bin:B}=this.patterns[c][I],P=B.x+1,Q=B.y+1,j=this.images[c][I].data,q=j.width,J=j.height;p.h.copy(j,C,{x:0,y:0},{x:P,y:Q},{width:q,height:J}),p.h.copy(j,C,{x:0,y:J-1},{x:P,y:Q-1},{width:q,height:1}),p.h.copy(j,C,{x:0,y:0},{x:P,y:Q+J},{width:q,height:1}),p.h.copy(j,C,{x:q-1,y:0},{x:P-1,y:Q},{width:1,height:J}),p.h.copy(j,C,{x:0,y:0},{x:P+q,y:Q},{width:1,height:J})}this.dirty=!0}beginFrame(){for(const c in this.images)this.callbackDispatchedThisFrame[c]={}}dispatchRenderCallbacks(c,d){for(const y of c){if(this.callbackDispatchedThisFrame[d][y])continue;this.callbackDispatchedThisFrame[d][y]=!0;const w=this.images[d][y];Jo(w)&&this.updateImage(y,d,w)}}}class ei{constructor(c,d,y,w){this.message=(c?`${c}: `:"")+y,w&&(this.identifier=w),null!=d&&d.__line__&&(this.line=d.__line__)}}class kc extends ei{}function ll(_){const c=_.key,d=_.value,y=_.valueSpec||{},w=_.objectElementValidators||{},C=_.style,I=_.styleSpec;let B=[];const P=p.i(d);if("object"!==P)return[new ei(c,d,`object expected, ${P} found`)];for(const Q in d){const j=Q.split(".")[0];let q;w[j]?q=w[j]:y[j]?q=Ct:w["*"]?q=w["*"]:y["*"]&&(q=Ct),q?B=B.concat(q({key:(c&&`${c}.`)+Q,value:d[Q],valueSpec:y[j]||y["*"],style:C,styleSpec:I,object:d,objectKey:Q},d)):B.push(new kc(c,d[Q],`unknown property "${Q}"`))}for(const Q in y)w[Q]||y[Q].required&&void 0===y[Q].default&&void 0===d[Q]&&B.push(new ei(c,d,`missing required property "${Q}"`));return B}function ir(_){const c=_.value,d=_.valueSpec,y=_.style,w=_.styleSpec,C=_.key,I=_.arrayElementValidator||Ct;if("array"!==p.i(c))return[new ei(C,c,`array expected, ${p.i(c)} found`)];if(d.length&&c.length!==d.length)return[new ei(C,c,`array length ${d.length} expected, length ${c.length} found`)];if(d["min-length"]&&c.length<d["min-length"])return[new ei(C,c,`array length at least ${d["min-length"]} expected, length ${c.length} found`)];let B={type:d.value,values:d.values,minimum:d.minimum,maximum:d.maximum,function:void 0};w.$version<7&&(B.function=d.function),"object"===p.i(d.value)&&(B=d.value);let P=[];for(let Q=0;Q<c.length;Q++)P=P.concat(I({array:c,arrayIndex:Q,value:c[Q],valueSpec:B,style:y,styleSpec:w,key:`${C}[${Q}]`},!0));return P}function Od(_){const c=_.key,d=_.value,y=_.valueSpec;let w=p.i(d);if("number"===w&&d!=d&&(w="NaN"),"number"!==w)return[new ei(c,d,`number expected, ${w} found`)];if("minimum"in y){let C=y.minimum;if("array"===p.i(y.minimum)&&(C=y.minimum[_.arrayIndex]),d<C)return[new ei(c,d,`${d} is less than the minimum value ${C}`)]}if("maximum"in y){let C=y.maximum;if("array"===p.i(y.maximum)&&(C=y.maximum[_.arrayIndex]),d>C)return[new ei(c,d,`${d} is greater than the maximum value ${C}`)]}return[]}function Xu(_){const c=_.valueSpec,d=p.u(_.value.type);let y,w,C,I={};const B="categorical"!==d&&void 0===_.value.property,P=!B,Q="array"===p.i(_.value.stops)&&"array"===p.i(_.value.stops[0])&&"object"===p.i(_.value.stops[0][0]),j=ll({key:_.key,value:_.value,valueSpec:_.styleSpec.function,style:_.style,styleSpec:_.styleSpec,objectElementValidators:{stops:function(te){if("identity"===d)return[new ei(te.key,te.value,'identity function may not have a "stops" property')];let le=[];const ce=te.value;return le=le.concat(ir({key:te.key,value:ce,valueSpec:te.valueSpec,style:te.style,styleSpec:te.styleSpec,arrayElementValidator:q})),"array"===p.i(ce)&&0===ce.length&&le.push(new ei(te.key,ce,"array must have at least one stop")),le},default:function(te){return Ct({key:te.key,value:te.value,valueSpec:c,style:te.style,styleSpec:te.styleSpec})}}});return"identity"===d&&B&&j.push(new ei(_.key,_.value,'missing required property "property"')),"identity"===d||_.value.stops||j.push(new ei(_.key,_.value,'missing required property "stops"')),"exponential"===d&&_.valueSpec.expression&&!p.s(_.valueSpec)&&j.push(new ei(_.key,_.value,"exponential functions not supported")),_.styleSpec.$version>=8&&(P&&!p.k(_.valueSpec)?j.push(new ei(_.key,_.value,"property functions not supported")):B&&!p.m(_.valueSpec)&&j.push(new ei(_.key,_.value,"zoom functions not supported"))),"categorical"!==d&&!Q||void 0!==_.value.property||j.push(new ei(_.key,_.value,'"property" property is required')),j;function q(te){let le=[];const ce=te.value,Ae=te.key;if("array"!==p.i(ce))return[new ei(Ae,ce,`array expected, ${p.i(ce)} found`)];if(2!==ce.length)return[new ei(Ae,ce,`array length 2 expected, length ${ce.length} found`)];if(Q){if("object"!==p.i(ce[0]))return[new ei(Ae,ce,`object expected, ${p.i(ce[0])} found`)];if(void 0===ce[0].zoom)return[new ei(Ae,ce,"object stop key must have zoom")];if(void 0===ce[0].value)return[new ei(Ae,ce,"object stop key must have value")];const se=p.u(ce[0].zoom);if("number"!=typeof se)return[new ei(Ae,ce[0].zoom,"stop zoom values must be numbers")];if(C&&C>se)return[new ei(Ae,ce[0].zoom,"stop zoom values must appear in ascending order")];se!==C&&(C=se,w=void 0,I={}),le=le.concat(ll({key:`${Ae}[0]`,value:ce[0],valueSpec:{zoom:{}},style:te.style,styleSpec:te.styleSpec,objectElementValidators:{zoom:Od,value:J}}))}else le=le.concat(J({key:`${Ae}[0]`,value:ce[0],valueSpec:{},style:te.style,styleSpec:te.styleSpec},ce));return p.n(p.o(ce[1]))?le.concat([new ei(`${Ae}[1]`,ce[1],"expressions are not allowed in function stops.")]):le.concat(Ct({key:`${Ae}[1]`,value:ce[1],valueSpec:c,style:te.style,styleSpec:te.styleSpec}))}function J(te,le){const ce=p.i(te.value),Ae=p.u(te.value),se=null!==te.value?te.value:le;if(y){if(ce!==y)return[new ei(te.key,se,`${ce} stop domain type must match previous stop domain type ${y}`)]}else y=ce;if("number"!==ce&&"string"!==ce&&"boolean"!==ce&&"number"!=typeof Ae&&"string"!=typeof Ae&&"boolean"!=typeof Ae)return[new ei(te.key,se,"stop domain value must be a number, string, or boolean")];if("number"!==ce&&"categorical"!==d){let me=`number expected, ${ce} found`;return p.k(c)&&void 0===d&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ei(te.key,se,me)]}return"categorical"!==d||"number"!==ce||"number"==typeof Ae&&isFinite(Ae)&&Math.floor(Ae)===Ae?"categorical"!==d&&"number"===ce&&"number"==typeof Ae&&"number"==typeof w&&void 0!==w&&Ae<w?[new ei(te.key,se,"stop domain values must appear in ascending order")]:(w=Ae,"categorical"===d&&Ae in I?[new ei(te.key,se,"stop domain values must be unique")]:(I[Ae]=!0,[])):[new ei(te.key,se,`integer expected, found ${String(Ae)}`)]}}function Hr(_){const c=("property"===_.expressionContext?p.q:p.r)(p.o(_.value),_.valueSpec);if("error"===c.result)return c.value.map(y=>new ei(`${_.key}${y.key}`,_.value,y.message));const d=c.value.expression||c.value._styleExpression.expression;if("property"===_.expressionContext&&"text-font"===_.propertyKey&&!d.outputDefined())return[new ei(_.key,_.value,`Invalid data expression for "${_.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===_.expressionContext&&"layout"===_.propertyType&&!p.t(d))return[new ei(_.key,_.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===_.expressionContext)return Oa(d,_);if(_.expressionContext&&0===_.expressionContext.indexOf("cluster")){if(!p.v(d,["zoom","feature-state"]))return[new ei(_.key,_.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===_.expressionContext&&!p.x(d))return[new ei(_.key,_.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Oa(_,c){const d=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(c.valueSpec&&c.valueSpec.expression)for(const w of c.valueSpec.expression.parameters)d.delete(w);if(0===d.size)return[];const y=[];return _ instanceof p.C&&d.has(_.name)?[new ei(c.key,c.value,`["${_.name}"] expression is not supported in a filter for a ${c.object.type} layer with id: ${c.object.id}`)]:(_.eachChild(w=>{y.push(...Oa(w,c))}),y)}function Mh(_){const c=_.key,d=_.value,y=_.valueSpec,w=[];return Array.isArray(y.values)?-1===y.values.indexOf(p.u(d))&&w.push(new ei(c,d,`expected one of [${y.values.join(", ")}], ${JSON.stringify(d)} found`)):-1===Object.keys(y.values).indexOf(p.u(d))&&w.push(new ei(c,d,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(d)} found`)),w}function kd(_){return p.z(p.o(_.value))?Hr(p.j({},_,{expressionContext:"filter",valueSpec:_.styleSpec[`filter_${_.layerType||"fill"}`]})):Pd(_)}function Pd(_){const c=_.value,d=_.key;if("array"!==p.i(c))return[new ei(d,c,`array expected, ${p.i(c)} found`)];const y=_.styleSpec;let w,C=[];if(c.length<1)return[new ei(d,c,"filter array must have at least 1 element")];switch(C=C.concat(Mh({key:`${d}[0]`,value:c[0],valueSpec:y.filter_operator,style:_.style,styleSpec:_.styleSpec})),p.u(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&"$type"===p.u(c[1])&&C.push(new ei(d,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":3!==c.length&&C.push(new ei(d,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(w=p.i(c[1]),"string"!==w&&C.push(new ei(`${d}[1]`,c[1],`string expected, ${w} found`)));for(let I=2;I<c.length;I++)w=p.i(c[I]),"$type"===p.u(c[1])?C=C.concat(Mh({key:`${d}[${I}]`,value:c[I],valueSpec:y.geometry_type,style:_.style,styleSpec:_.styleSpec})):"string"!==w&&"number"!==w&&"boolean"!==w&&C.push(new ei(`${d}[${I}]`,c[I],`string, number, or boolean expected, ${w} found`));break;case"any":case"all":case"none":for(let I=1;I<c.length;I++)C=C.concat(Pd({key:`${d}[${I}]`,value:c[I],style:_.style,styleSpec:_.styleSpec}));break;case"has":case"!has":w=p.i(c[1]),2!==c.length?C.push(new ei(d,c,`filter array for "${c[0]}" operator must have 2 elements`)):"string"!==w&&C.push(new ei(`${d}[1]`,c[1],`string expected, ${w} found`))}return C}function Li(_,c){const d=_.key,y=_.style,w=_.layer,C=_.styleSpec,I=_.value,B=_.objectKey,P=C[`${c}_${_.layerType}`];if(!P)return[];const Q=B.match(/^(.*)-transition$/);if("paint"===c&&Q&&P[Q[1]]&&P[Q[1]].transition)return Ct({key:d,value:I,valueSpec:C.transition,style:y,styleSpec:C});const j=_.valueSpec||P[B];if(!j)return[new kc(d,I,`unknown property "${B}"`)];let q;if("string"===p.i(I)&&p.k(j)&&!j.tokens&&(q=/^{([^}]+)}$/.exec(I))){const te=`\`{ "type": "identity", "property": ${q?JSON.stringify(q[1]):'"_"'} }\``;return[new ei(d,I,`"${B}" does not support interpolation syntax\nUse an identity property function instead: ${te}.`)]}const J=[];if("symbol"===_.layerType)"text-field"!==B||!y||y.glyphs||y.imports||J.push(new ei(d,I,'use of "text-field" requires a style "glyphs" property')),"text-font"===B&&p.A(p.o(I))&&"identity"===p.u(I.type)&&J.push(new ei(d,I,'"text-font" does not support identity functions'));else if("model"===_.layerType&&"paint"===c&&w&&w.layout&&w.layout.hasOwnProperty("model-id")&&p.k(j)&&(p.B(j)||p.m(j))){const te=p.q(p.o(I),j),le=te.value.expression||te.value._styleExpression.expression;le&&!p.v(le,["measure-light"])&&("model-emissive-strength"===B&&p.x(le)&&p.t(le)||J.push(new ei(d,I,`${B} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return J.concat(Ct({key:_.key,value:I,valueSpec:j,style:y,styleSpec:C,expressionContext:"property",propertyType:c,propertyKey:B}))}function Tf(_){return Li(_,"paint")}function ru(_){return Li(_,"layout")}function Xs(_){let c=[];const d=_.value,y=_.key,w=_.style,C=_.styleSpec;d.type||d.ref||c.push(new ei(y,d,'either "type" or "ref" is required'));let I=p.u(d.type);const B=p.u(d.ref);if(d.id){const P=p.u(d.id);for(let Q=0;Q<_.arrayIndex;Q++){const j=w.layers[Q];p.u(j.id)===P&&c.push(new ei(y,d.id,`duplicate layer id "${d.id}", previously used at line ${j.id.__line__}`))}}if("ref"in d){let P;["type","source","source-layer","filter","layout"].forEach(Q=>{Q in d&&c.push(new ei(y,d[Q],`"${Q}" is prohibited for ref layers`))}),w.layers.forEach(Q=>{p.u(Q.id)===B&&(P=Q)}),P?P.ref?c.push(new ei(y,d.ref,"ref cannot reference another ref layer")):I=p.u(P.type):"string"==typeof B&&c.push(new ei(y,d.ref,`ref layer "${B}" not found`))}else if("background"!==I&&"sky"!==I&&"slot"!==I)if(d.source){const P=w.sources&&w.sources[d.source],Q=P&&p.u(P.type);P?"vector"===Q&&"raster"===I?c.push(new ei(y,d.source,`layer "${d.id}" requires a raster source`)):"raster"===Q&&"raster"!==I?c.push(new ei(y,d.source,`layer "${d.id}" requires a vector source`)):"vector"!==Q||d["source-layer"]?"raster-dem"===Q&&"hillshade"!==I?c.push(new ei(y,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):"raster-array"!==Q||["raster","raster-particle"].includes(I)?"line"!==I||!d.paint||!d.paint["line-gradient"]&&!d.paint["line-trim-offset"]||"geojson"===Q&&P.lineMetrics?"raster-particle"===I&&"raster-array"!==Q&&c.push(new ei(y,d.source,`layer "${d.id}" requires a 'raster-array' source.`)):c.push(new ei(y,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new ei(y,d.source,"raster-array source can only be used with layer type 'raster'.")):c.push(new ei(y,d,`layer "${d.id}" must specify a "source-layer"`)):c.push(new ei(y,d.source,`source "${d.source}" not found`))}else c.push(new ei(y,d,'missing required property "source"'));return c=c.concat(ll({key:y,value:d,valueSpec:C.layer,style:_.style,styleSpec:_.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ct({key:`${y}.type`,value:d.type,valueSpec:C.layer.type,style:_.style,styleSpec:_.styleSpec,object:d,objectKey:"type"}),filter:P=>kd(p.j({layerType:I},P)),layout:P=>ll({layer:d,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":Q=>ru(p.j({layerType:I},Q))}}),paint:P=>ll({layer:d,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":Q=>Tf(p.j({layerType:I,layer:d},Q))}})}})),c}function Kr(_){const c=_.value,d=_.key,y=p.i(c);return"string"!==y?[new ei(d,c,`string expected, ${y} found`)]:[]}const dc={promoteId:function({key:_,value:c}){if("string"===p.i(c))return Kr({key:_,value:c});{const d=[];for(const y in c)d.push(...Kr({key:`${_}.${y}`,value:c[y]}));return d}}};function Ht(_){const c=_.value,d=_.key,y=_.styleSpec,w=_.style;if(!c.type)return[new ei(d,c,'"type" is required')];const C=p.u(c.type);let I=[];switch(["vector","raster","raster-dem","raster-array"].includes(C)&&(c.url||c.tiles||I.push(new kc(d,c,'Either "url" or "tiles" is required.'))),C){case"vector":case"raster":case"raster-dem":case"raster-array":return I=I.concat(ll({key:d,value:c,valueSpec:y[`source_${C.replace("-","_")}`],style:_.style,styleSpec:y,objectElementValidators:dc})),I;case"geojson":if(I=ll({key:d,value:c,valueSpec:y.source_geojson,style:w,styleSpec:y,objectElementValidators:dc}),c.cluster)for(const B in c.clusterProperties){const[P,Q]=c.clusterProperties[B],j="string"==typeof P?[P,["accumulated"],["get",B]]:P;I.push(...Hr({key:`${d}.${B}.map`,value:Q,expressionContext:"cluster-map"})),I.push(...Hr({key:`${d}.${B}.reduce`,value:j,expressionContext:"cluster-reduce"}))}return I;case"video":return ll({key:d,value:c,valueSpec:y.source_video,style:w,styleSpec:y});case"image":return ll({key:d,value:c,valueSpec:y.source_image,style:w,styleSpec:y});case"canvas":return[new ei(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Mh({key:`${d}.type`,value:c.type,valueSpec:{values:Nd(y)},style:w,styleSpec:y})}}function Nd(_){return _.source.reduce((c,d)=>{const y=_[d];return"enum"===y.type.type&&(c=c.concat(Object.keys(y.type.values))),c},[])}function $o(_){const c=_.value;let d=[];if(!c)return d;const y=p.i(c);return"string"!==y?(d=d.concat([new ei(_.key,c,`string expected, "${y}" found`)]),d):(function(w){const C=-1===w.indexOf("://");try{return new URL(w,C?"http://example.com":void 0),!0}catch{return!1}}(c)||(d=d.concat([new ei(_.key,c,`invalid url "${c}"`)])),d)}function nc(_){const c=_.value,d=_.styleSpec,y=d.light,w=_.style;let C=[];const I=p.i(c);if(void 0===c)return C;if("object"!==I)return C=C.concat([new ei("light",c,`object expected, ${I} found`)]),C;for(const B in c){const P=B.match(/^(.*)-transition$/);C=C.concat(P&&y[P[1]]&&y[P[1]].transition?Ct({key:B,value:c[B],valueSpec:d.transition,style:w,styleSpec:d}):y[B]?Ct({key:B,value:c[B],valueSpec:y[B],style:w,styleSpec:d}):[new ei(B,c[B],`unknown property "${B}"`)])}return C}function Cu(_){const c=_.value;let d=[];if(!c)return d;const y=p.i(c);if("object"!==y)return d=d.concat([new ei("light-3d",c,`object expected, ${y} found`)]),d;const w=_.styleSpec,C=w["light-3d"],I=_.key,B=_.style,P=_.style.lights;for(const q of["type","id"])if(!(q in c))return d=d.concat([new ei("light-3d",c,`missing property ${q} on light`)]),d;if(c.type&&P)for(let q=0;q<_.arrayIndex;q++){const J=p.u(c.type),te=P[q];p.u(te.type)===J&&d.push(new ei(I,c.id,`duplicate light type "${c.type}", previously defined at line ${te.id.__line__}`))}const Q=`properties_light_${c.type}`;if(!(Q in w))return d=d.concat([new ei("light-3d",c,`Invalid light type ${c.type}`)]),d;const j=w[Q];for(const q in c)if("properties"===q){const J=c[q],te=p.i(J);if("object"!==te)return d=d.concat([new ei("properties",J,`object expected, ${te} found`)]),d;for(const le in J)d=d.concat(j[le]?Ct({key:le,value:J[le],valueSpec:j[le],style:B,styleSpec:w}):[new kc(_.key,J[le],`unknown property "${le}"`)])}else{const J=q.match(/^(.*)-transition$/);d=d.concat(J&&C[J[1]]&&C[J[1]].transition?Ct({key:q,value:c[q],valueSpec:w.transition,style:B,styleSpec:w}):C[q]?Ct({key:q,value:c[q],valueSpec:C[q],style:B,styleSpec:w}):[new kc(q,c[q],`unknown property "${q}"`)])}return d}function Eu(_){const c=_.value,d=_.key,y=_.style,w=_.styleSpec,C=w.terrain;let I=[];const B=p.i(c);if(void 0===c||"null"===B)return I;if("object"!==B)return I=I.concat([new ei("terrain",c,`object expected, ${B} found`)]),I;for(const P in c){const Q=P.match(/^(.*)-transition$/);I=I.concat(Q&&C[Q[1]]&&C[Q[1]].transition?Ct({key:P,value:c[P],valueSpec:w.transition,style:y,styleSpec:w}):C[P]?Ct({key:P,value:c[P],valueSpec:C[P],style:y,styleSpec:w}):[new kc(P,c[P],`unknown property "${P}"`)])}if(c.source){const P=y.sources&&y.sources[c.source],Q=P&&p.u(P.type);P?"raster-dem"!==Q&&I.push(new ei(d,c.source,`terrain cannot be used with a source of type ${String(Q)}, it only be used with a "raster-dem" source type`)):I.push(new ei(d,c.source,`source "${c.source}" not found`))}else I.push(new ei(d,c,'terrain is missing required property "source"'));return I}function Pc(_){const c=_.value,d=_.style,y=_.styleSpec,w=y.fog;let C=[];const I=p.i(c);if(void 0===c)return C;if("object"!==I)return C=C.concat([new ei("fog",c,`object expected, ${I} found`)]),C;for(const B in c){const P=B.match(/^(.*)-transition$/);C=C.concat(P&&w[P[1]]&&w[P[1]].transition?Ct({key:B,value:c[B],valueSpec:y.transition,style:d,styleSpec:y}):w[B]?Ct({key:B,value:c[B],valueSpec:w[B],style:d,styleSpec:y}):[new kc(B,c[B],`unknown property "${B}"`)])}return C}const zt={"*":()=>[],array:ir,boolean:function(_){const c=_.value,d=_.key,y=p.i(c);return"boolean"!==y?[new ei(d,c,`boolean expected, ${y} found`)]:[]},number:Od,color:function(_){const c=_.key,d=_.value,y=p.i(d);return"string"!==y?[new ei(c,d,`color expected, ${y} found`)]:null===p.y(d)?[new ei(c,d,`color expected, "${d}" found`)]:[]},enum:Mh,filter:kd,function:Xu,layer:Xs,object:ll,source:Ht,model:$o,light:nc,"light-3d":Cu,terrain:Eu,fog:Pc,string:Kr,formatted:function(_){return 0===Kr(_).length?[]:Hr(_)},resolvedImage:function(_){return 0===Kr(_).length?[]:Hr(_)},projection:function(_){const c=_.value,d=_.styleSpec,y=d.projection,w=_.style;let C=[];const I=p.i(c);if("object"===I)for(const B in c)C=C.concat(Ct({key:B,value:c[B],valueSpec:y[B],style:w,styleSpec:d}));else"string"!==I&&(C=C.concat([new ei("projection",c,`object or string expected, ${I} found`)]));return C},import:function(_){const{value:c,styleSpec:d}=_,{data:y,...w}=c;Object.defineProperty(w,"__line__",{value:c.__line__,enumerable:!1});let C=ll(p.j({},_,{value:w,valueSpec:d.import}));return""===p.u(w.id)&&C.push(new ei(`${_.key}.id`,w,"import id can't be an empty string")),y&&(C=C.concat(Hn(y,d,{key:`${_.key}.data`}))),C}};function Ct(_,c=!1){const d=_.value,y=_.valueSpec,w=_.styleSpec;if(y.expression&&p.A(p.u(d)))return Xu(_);if(y.expression&&p.n(p.o(d)))return Hr(_);if(y.type&&zt[y.type]){const C=zt[y.type](_);return!0===c&&C.length>0&&"array"===p.i(_.value)?Hr(_):C}return ll(p.j({},_,{valueSpec:y.type?w[y.type]:y}))}function vn(_){const c=_.value,d=_.key,y=Kr(_);return y.length||(-1===c.indexOf("{fontstack}")&&y.push(new ei(d,c,'"glyphs" url must include a "{fontstack}" token')),-1===c.indexOf("{range}")&&y.push(new ei(d,c,'"glyphs" url must include a "{range}" token'))),y}function Hn(_,c=p.D,d={}){return Ct({key:d.key||"",value:_,valueSpec:c.$root,styleSpec:c,style:_,objectElementValidators:{glyphs:vn,"*":()=>[]}})}function _i(_,c=p.D){return Vt(Hn(_,c))}const Mi=_=>Vt(Ht(_)),Lo=_=>Vt(nc(_)),kt=_=>Vt(Cu(_)),_e=_=>Vt(Eu(_)),Re=_=>Vt(Pc(_)),tt=_=>Vt(Xs(_)),Gt=_=>Vt(kd(_)),tn=_=>Vt(Tf(_)),wn=_=>Vt(ru(_)),zn=_=>Vt($o(_));function Vt(_){return _.slice().sort((c,d)=>c.line&&d.line?c.line-d.line:0)}function jn(_,c){let d=!1;if(c&&c.length)for(const y of c)y instanceof kc?p.w(y.message):(_.fire(new p.a(new Error(y.message))),d=!0);return d}const Zn=new p.F({anchor:new p.G(p.D.light.anchor),position:new p.H(p.D.light.position),color:new p.G(p.D.light.color),intensity:new p.G(p.D.light.intensity)});class ui extends p.E{constructor(c,d="flat"){super(),this._transitionable=new p.J(Zn),this.setLight(c,d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,d,y={}){this._validate(Lo,c,y)||(this._transitionable.setTransitionOrValue(c),this.id=d)}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,d,y){return(!y||!1!==y.validate)&&jn(this,c.call(_i,p.e({value:d,style:{glyphs:!0,sprite:!0},styleSpec:p.D})))}}const vr=new p.F({source:new p.G(p.D.terrain.source),exaggeration:new p.G(p.D.terrain.exaggeration)});let os=class extends p.E{constructor(_,c,d,y){super(),this.scope=d,this._transitionable=new p.J(vr,d,y),this._transitionable.setTransitionOrValue(_,y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(_,c){this._transitionable.setTransitionOrValue(_,c)}updateTransitions(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(_){this.properties=this._transitioning.possiblyEvaluate(_)}getExaggeration(_){return this._transitioning.possiblyEvaluate(new p.K(_)).get("exaggeration")}isZoomDependent(){const _=this._transitionable._values.exaggeration;return null!=_&&null!=_.value&&null!=_.value.expression&&_.value.expression instanceof p.Z}};const bo=45,Os=65,as=.05;function ls(_,c,d,y){const w=p.O(bo,Os,d),[C,I]=Ss(_,y);let B=1-Math.min(1,Math.exp((c-C)/(I-C)*-6));return B*=B*B,B=Math.min(1,1.00747*B),B*w*_.alpha}function Ss(_,c){const d=.5/Math.tan(.5*c);return[_.range[0]+d,_.range[1]+d]}function ro(_,c,d,y,w){const C=p.N.transformMat4([],[c,d,y],w.mercatorFogMatrix);return ls(_,p.N.length(C),w.pitch,w._fov)}function ca(_,c,d,y,w,C,I){const B=[[d,y,0],[w,y,0],[w,C,0],[d,C,0]];let P=Number.MAX_VALUE,Q=-Number.MAX_VALUE;for(const j of B){const q=p.N.transformMat4([],j,c),J=p.N.length(q);P=Math.min(P,J),Q=Math.max(Q,J)}return[ls(_,P,I.pitch,I._fov),ls(_,Q,I.pitch,I._fov)]}const fo=new p.F({range:new p.G(p.D.fog.range),color:new p.G(p.D.fog.color),"high-color":new p.G(p.D.fog["high-color"]),"space-color":new p.G(p.D.fog["space-color"]),"horizon-blend":new p.G(p.D.fog["horizon-blend"]),"star-intensity":new p.G(p.D.fog["star-intensity"]),"vertical-range":new p.G(p.D.fog["vertical-range"])});class Za extends p.E{constructor(c,d,y,w){super(),this._transitionable=new p.J(fo,y,new Map(w)),this.set(c,w),this._transitioning=this._transitionable.untransitioned(),this._transform=d,this.properties=new p.Q(fo)}get state(){const c=this._transform,d="globe"===c.projection.name,y=p.S(c.zoom),w=this.properties.get("range"),C=[.5,3];return{range:d?[p.U(C[0],w[0],y),p.U(C[1],w[1],y)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,d,y={}){if(this._validate(Re,c,y))return;const w=p.e({},c);for(const C of Object.keys(p.D.fog))void 0===w[C]&&(w[C]=p.D.fog[C].default);this._options=w,this._transitionable.setTransitionOrValue(this._options,d)}getOpacity(c){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:p.O(bo,Os,c))*d.a}getOpacityAtLatLng(c,d){return this._transform.projection.supportsFog?function(y,w,C){const I=p.L.fromLngLat(w),B=C.elevation?C.elevation.getAtPointOrZero(I):0;return ro(y,I.x,I.y,B,C)}(this.state,c,d):0}getOpacityForTile(c){if(!this._transform.projection.supportsFog)return[1,1];const d=this._transform.calculateFogTileMatrix(c.toUnwrapped());return ca(this.state,d,0,0,p.V,p.V,this._transform)}getOpacityForBounds(c,d,y,w,C){return this._transform.projection.supportsFog?ca(this.state,c,d,y,w,C,this._transform):[1,1]}getFovAdjustedRange(c){return this._transform.projection.supportsFog?Ss(this.state,c):[0,1]}isVisibleOnFrustum(c){if(!this._transform.projection.supportsFog)return!1;const d=[4,5,6,7];for(const y of d){const w=c.points[y];let C;if(w[2]>=0)C=w;else{const I=c.points[y-4];C=p.W(I,w,I[2]/(I[2]-w[2]))}if(ro(this.state,C[0],C[1],0,this._transform)>=as)return!0}return!1}updateConfig(c){this._transitionable.setTransitionOrValue(this._options,new Map(c))}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,d,y){return(!y||!1!==y.validate)&&jn(this,c.call(_i,p.e({value:d,style:{glyphs:!0,sprite:!0},styleSpec:p.D})))}}class Xa extends p.E{constructor(c,d,y,w){super(),this.scope=y,this._options=c,this.properties=new p.Q(d),this._transitionable=new p.J(d,y,new Map(w)),this._transitionable.setTransitionOrValue(c.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(c){this._transitionable.setTransitionOrValue(this._options.properties,new Map(c))}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(c,d){this._options=c,this._transitionable.setTransitionOrValue(c.properties,d)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}const zl=new p.F({color:new p.G(p.D.properties_light_ambient.color),intensity:new p.G(p.D.properties_light_ambient.intensity)}),ua=new p.F({direction:new p.X(p.D.properties_light_directional.direction),color:new p.G(p.D.properties_light_directional.color),intensity:new p.G(p.D.properties_light_directional.intensity),"cast-shadows":new p.G(p.D.properties_light_directional["cast-shadows"]),"shadow-intensity":new p.G(p.D.properties_light_directional["shadow-intensity"])});class ha{constructor(c,d,y,w){this.screenBounds=c,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(c,d){let y,w;if(c instanceof p.P||"number"==typeof c[0]){const C=p.P.convert(c);y=[C],w=d.isPointAboveHorizon(C)}else{const C=p.P.convert(c[0]),I=p.P.convert(c[1]);y=[C,I],w=p.Y(C,I).every(B=>d.isPointAboveHorizon(B))}return new ha(y,d.getCameraPoint(),w,d)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(c){return p.Y(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const d=this.screenBounds[0],y=1===this.screenBounds.length?this.screenBounds[0].add(new p.P(1,1)):this.screenBounds[1],w=p.Y(d,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<y.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?w[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(w[3]=this.cameraPoint)),p._(w,c)}bufferedCameraGeometryGlobe(c){const d=this.screenBounds[0],y=1===this.screenBounds.length?this.screenBounds[0].add(new p.P(1,1)):this.screenBounds[1],w=p.Y(d,y,c),C=this.cameraPoint.clone();switch(3*((C.y>d.y)+(C.y>y.y))+((C.x>d.x)+(C.x>y.x))){case 0:w[0]=C,w[4]=C.clone();break;case 1:w.splice(1,0,C);break;case 2:w[1]=C;break;case 3:w.splice(4,0,C);break;case 5:w.splice(2,0,C);break;case 6:w[3]=C;break;case 7:w.splice(3,0,C);break;case 8:w[2]=C}return w}containsTile(c,d,y,w=0){const C=c.queryPadding/d._pixelsPerMercatorPixel+1,I=y?this._bufferedCameraMercator(C,d):this._bufferedScreenMercator(C,d);let B=c.tileID.wrap+(I.unwrapped?w:0);const P=I.polygon.map(Ae=>p.$(c.tileTransform,Ae,B));if(!p.a0(P,0,0,p.V,p.V))return;B=c.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const Q=this.screenGeometryMercator.polygon.map(Ae=>p.a1(c.tileTransform,Ae,B)),j=Q.map(Ae=>new p.P(Ae[0],Ae[1])),q=d.getFreeCameraOptions().position||new p.L(0,0,0),J=p.a1(c.tileTransform,q,B),te=Q.map(Ae=>{const se=p.N.sub(Ae,Ae,J);return p.N.normalize(se,se),new p.a2(J,se)}),le=p.a3(c,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:j,tilespaceRays:te,bufferedTilespaceGeometry:P,bufferedTilespaceBounds:(ce=p.a4(P),ce.min.x=p.aa(ce.min.x,0,p.V),ce.min.y=p.aa(ce.min.y,0,p.V),ce.max.x=p.aa(ce.max.x,0,p.V),ce.max.y=p.aa(ce.max.y,0,p.V),ce),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:le};var ce}_bufferedScreenMercator(c,d){const y=Wt(c);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let w;return w="globe"===d.projection.name?this._projectAndResample(this.bufferedScreenGeometry(c),d):{polygon:this.bufferedScreenGeometry(c).map(C=>d.pointCoordinate3D(C)),unwrapped:!0},this._screenRaycastCache[y]=w,w}}_bufferedCameraMercator(c,d){const y=Wt(c);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let w;return w="globe"===d.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(c),d):{polygon:this.bufferedCameraGeometry(c).map(C=>d.pointCoordinate3D(C)),unwrapped:!0},this._cameraRaycastCache[y]=w,w}}_projectAndResample(c,d){const y=function(C,I){const B=p.a6.multiply([],I.pixelMatrix,I.globeMatrix),P=[0,-p.ab,0,1],Q=[0,p.ab,0,1],j=[0,0,0,1];p.a7.transformMat4(P,P,B),p.a7.transformMat4(Q,Q,B),p.a7.transformMat4(j,j,B);const q=new p.P(P[0]/P[3],P[1]/P[3]),J=new p.P(Q[0]/Q[3],Q[1]/Q[3]),te=p.a8(C,q)&&P[3]<j[3],le=p.a8(C,J)&&Q[3]<j[3];if(!te&&!le)return null;const ce=function(Me,He,Ge){for(let nt=1;nt<Me.length;nt++){const dt=Jt(He.pointCoordinate3D(Me[nt-1]).x),ot=Jt(He.pointCoordinate3D(Me[nt]).x);if(Ge<0){if(dt<ot)return{idx:nt,t:-dt/(ot-1-dt)}}else if(ot<dt)return{idx:nt,t:(1-dt)/(ot+1-dt)}}return null}(C,I,te?-1:1);if(!ce)return null;const{idx:Ae,t:se}=ce;let me=Ae>1?Zt(C.slice(0,Ae),I):[],Ie=Ae<C.length?Zt(C.slice(Ae),I):[];me=me.map(Me=>new p.P(Jt(Me.x),Me.y)),Ie=Ie.map(Me=>new p.P(Jt(Me.x),Me.y));const xe=[...me];0===xe.length&&xe.push(Ie[Ie.length-1]);const Be=p.U(xe[xe.length-1].y,(0===Ie.length?me[0]:Ie[0]).y,se);let ge;return ge=te?[new p.P(0,Be),new p.P(0,0),new p.P(1,0),new p.P(1,Be)]:[new p.P(1,Be),new p.P(1,1),new p.P(0,1),new p.P(0,Be)],xe.push(...ge),0===Ie.length?xe.push(me[0]):xe.push(...Ie),{polygon:xe.map(Me=>new p.L(Me.x,Me.y)),unwrapped:!1}}(c,d);if(y)return y;const w=function(C,I){let B=!1,P=-1/0,Q=0;for(let q=0;q<C.length-1;q++)C[q].x>P&&(P=C[q].x,Q=q);for(let q=0;q<C.length-1;q++){const J=(Q+q)%(C.length-1),te=C[J],le=C[J+1];Math.abs(te.x-le.x)>.5&&(te.x<le.x?(te.x+=1,0===J&&(C[C.length-1].x+=1)):(le.x+=1,J+1===C.length-1&&(C[0].x+=1)),B=!0)}const j=p.a5(I.center.lng);return B&&j<Math.abs(j-1)&&C.forEach(q=>{q.x-=1}),{polygon:C,unwrapped:B}}(Zt(c,d).map(C=>new p.P(Jt(C.x),C.y)),d);return{polygon:w.polygon.map(C=>new p.L(C.x,C.y)),unwrapped:w.unwrapped}}}function Zt(_,c){return p.a9(_,d=>{const y=c.pointCoordinate3D(d);d.x=y.x,d.y=y.y},1/256)}function Jt(_){return _<0?1+_%1:_%1}function Wt(_){return 100*_|0}function On(_,c,d,y,w){const C=function(I,B){if(I)return w(I);if(B){_.url&&B.tiles&&_.tiles&&delete _.tiles;const P=p.ac(p.e(B,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);B.vector_layers&&(P.vectorLayers=B.vector_layers,P.vectorLayerIds=P.vectorLayers.map(Q=>Q.id)),B.raster_layers&&(P.rasterLayers=B.raster_layers,P.rasterLayerIds=P.rasterLayers.map(Q=>Q.id)),P.tiles=c.canonicalizeTileset(P,_.url),w(null,P)}};return _.url?p.g(c.transformRequest(c.normalizeSourceURL(_.url,null,d,y),p.R.Source),C):p.f.frame(()=>C(null,_))}class Bn{constructor(c,d,y){this.bounds=p.ad.convert(this.validateBounds(c)),this.minzoom=d||0,this.maxzoom=y||24}validateBounds(c){return Array.isArray(c)&&4===c.length?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const d=Math.pow(2,c.z),y=Math.floor(p.a5(this.bounds.getWest())*d),w=Math.floor(p.ae(this.bounds.getNorth())*d),C=Math.ceil(p.a5(this.bounds.getEast())*d),I=Math.ceil(p.ae(this.bounds.getSouth())*d);return c.x>=y&&c.x<C&&c.y>=w&&c.y<I}}class gn extends p.E{constructor(c,d,y,w){if(super(),this.id=c,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,p.e(this,p.ac(d,["url","scheme","tileSize","promoteId"])),this._options=p.e({type:"vector"},d),this._collectResourceTiming=!!d.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new p.af}load(c){this._loaded=!1,this.fire(new p.b("dataloading",{dataType:"source"}));const d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map._worldview;this._tileJSONRequest=On(this._options,this.map._requestManager,d,y,(w,C)=>{this._tileJSONRequest=null,this._loaded=!0,w?(d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),y&&2!==y.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new p.a(w))):C&&(p.e(this,C),C.bounds&&(this.tileBounds=new Bn(C.bounds,this.minzoom,this.maxzoom)),p.aj(C.tiles,this.map._requestManager._customAccessToken),this.fire(new p.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.b("data",{dataType:"source",sourceDataType:"content"}))),c&&c(w)})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest();const c=p.ag(this.id,this.scope);this.load(()=>this.map.style.clearSource(c))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return p.e({},this._options)}loadTile(c,d){const y=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(y,p.R.Tile),data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:p.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:c.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:c.isExtraShadowCaster};if(w.request.collectResourceTiming=this._collectResourceTiming,c.actor&&"expired"!==c.state)"loading"===c.state?c.reloadCallback=d:c.request=c.actor.send("reloadTile",w,C.bind(this));else if(c.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)c.request=c.actor.send("loadTile",w,C.bind(this),void 0,!0);else{const I=p.ah.call({deduped:this._deduped},w,(B,P)=>{B||!P?C.call(this,B):(w.data={cacheControl:P.cacheControl,expires:P.expires,rawData:P.rawData.slice(0)},c.actor&&c.actor.send("loadTile",w,C.bind(this),void 0,!0))},!0);c.request={cancel:I}}function C(I,B){return delete c.request,c.aborted?d(null):I&&404!==I.status?d(I):(B&&B.resourceTiming&&(c.resourceTiming=B.resourceTiming),this.map._refreshExpiredTiles&&B&&c.setExpiryData(B),c.loadVectorData(B,this.map.painter),p.ai(this.dispatcher),d(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(c){c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id,scope:this.scope}),c.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Gn extends p.E{constructor(c,d,y,w){super(),this.id=c,this.dispatcher=y,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=p.e({type:"raster"},d),p.e(this,p.ac(d,["url","scheme","tileSize"]))}load(c){this._loaded=!1,this.fire(new p.b("dataloading",{dataType:"source"})),this._tileJSONRequest=On(this._options,this.map._requestManager,null,null,(d,y)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new p.a(d)):y&&(p.e(this,y),y.bounds&&(this.tileBounds=new Bn(y.bounds,this.minzoom,this.maxzoom)),p.aj(y.tiles),this.fire(new p.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.b("data",{dataType:"source",sourceDataType:"content"}))),c&&c(d)})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest();const c=p.ag(this.id,this.scope);this.load(()=>this.map.style.clearSource(c))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return p.e({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,d){const y=p.f.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);c.request=p.d(this.map._requestManager.transformRequest(w,p.R.Tile),(C,I,B,P)=>(delete c.request,c.aborted?(c.state="unloaded",d(null)):C?(c.state="errored",d(C)):I?(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:B,expires:P}),c.setTexture(I,this.map.painter),c.state="loaded",p.ai(this.dispatcher),void d(null)):d(null)))}abortTile(c,d){c.request&&(c.request.cancel(),delete c.request),d()}unloadTile(c,d){c.texture&&c.texture instanceof p.T?(c.destroy(!0),c.texture&&c.texture instanceof p.T&&this.map.painter.saveTileTexture(c.texture)):c.destroy(),d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ln extends Gn{constructor(c,d,y,w){super(c,d,y,w),this.type="raster-array",this.maxzoom=22,this._options=p.e({type:"raster-array"},d)}triggerRepaint(c){const d=this.map.painter._terrain,y=this.map.style.getSourceCache(this.id);d&&d.enabled&&y&&d._clearRenderCacheForTile(y.id,c.tileID),this.map.triggerRepaint()}loadTile(c,d){const y=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),w=this.map._requestManager.transformRequest(y,p.R.Tile);c.requestParams=w,c.actor||(c.actor=this.dispatcher.getActor()),c.request=c.fetchHeader(void 0,(C,I,B,P)=>(delete c.request,c.aborted?(c.state="unloaded",d(null)):C?20===C.code?void 0:(c.state="errored",d(C)):(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:B,expires:P}),c.state="empty",void d(null))))}unloadTile(c){const d=c.texture;d&&d instanceof p.T?(c.destroy(!0),this.map.painter.saveTileTexture(d)):(c.destroy(),c.flushQueues(),c._isHeaderLoaded=!1,delete c._mrt,delete c.textureDescriptor),c.fbo&&(c.fbo.destroy(),delete c.fbo),delete c.request,delete c.requestParams,delete c.neighboringTiles,c.state="unloaded"}prepareTile(c,d,y){c._isHeaderLoaded&&("empty"!==c.state&&(c.state="reloading"),c.fetchBand(d,y,(w,C)=>{if(w)return c.state="errored",this.fire(new p.a(w)),void this.triggerRepaint(c);C&&(c.setTexture(C,this.map.painter),c.state="loaded",this.triggerRepaint(c))}))}getInitialBand(c){if(!this.rasterLayers)return 0;const d=this.rasterLayers.find(({id:C})=>C===c),y=d&&d.fields,w=y&&y.bands&&y.bands;return w?w[0]:0}getTextureDescriptor(c,d,y){if(!c)return;const w=d.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!w)return;let C=null;d instanceof p.an?C=d.paint.get("raster-array-band"):d instanceof p.ao&&(C=d.paint.get("raster-particle-array-band"));const I=C||this.getInitialBand(w);if(null!=I)if(c.textureDescriptor){if(!c.updateNeeded(w,I)||y)return Object.assign({},c.textureDescriptor,{texture:c.texture})}else this.prepareTile(c,w,I)}}const ji=new Uint16Array(8184);for(let _=0;_<2046;_++){let c=_+2,d=0,y=0,w=0,C=0,I=0,B=0;for(1&c?w=C=I=32:d=y=B=32;(c>>=1)>1;){const Q=d+w>>1,j=y+C>>1;1&c?(w=d,C=y,d=I,y=B):(d=w,y=C,w=I,C=B),I=Q,B=j}const P=4*_;ji[P+0]=d,ji[P+1]=y,ji[P+2]=w,ji[P+3]=C}const Ur=new Uint16Array(2178),Ci=new Uint8Array(1089),Jr=new Uint16Array(1089);function wo(_){return 0===_?-.03125:32===_?.03125:0}let es=(()=>{class _{constructor(d,y,w,C){this.id=_.uniqueIdxCounter,_.uniqueIdxCounter++,this.context=d;const I=d.gl;this.buffer=I.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),I.bufferData(I.ELEMENT_ARRAY_BUFFER,y.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||C||y.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(d){this.id=_.uniqueIdxCounter,_.uniqueIdxCounter++;const y=this.context.gl;this.context.unbindVAO(),this.bind(),y.bufferSubData(y.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}return _.uniqueIdxCounter=0,_})();const qo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Fo{constructor(c,d,y,w,C,I){this.length=d.length,this.attributes=y,this.itemSize=d.bytesPerElement,this.dynamicDraw=w,this.instanceCount=I,this.context=c;const B=c.gl;this.buffer=B.createBuffer(),c.bindVertexBuffer.set(this.buffer),B.bufferData(B.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?B.DYNAMIC_DRAW:B.STATIC_DRAW),this.dynamicDraw||C||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,d){for(let y=0;y<this.attributes.length;y++){const w=d.attributes[this.attributes[y].name];void 0!==w&&c.enableVertexAttribArray(w)}}setVertexAttribPointers(c,d,y){for(let w=0;w<this.attributes.length;w++){const C=this.attributes[w],I=d.attributes[C.name];void 0!==I&&c.vertexAttribPointer(I,C.components,c[qo[C.type]],!1,this.itemSize,C.offset+this.itemSize*(y||0))}}setVertexAttribDivisor(c,d,y){for(let w=0;w<this.attributes.length;w++){const C=d.attributes[this.attributes[w].name];void 0!==C&&this.instanceCount&&this.instanceCount>0&&c.vertexAttribDivisor(C,y)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _s{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class su extends _s{getDefault(){return p.ax.transparent}set(c){const d=this.current;(c.r!==d.r||c.g!==d.g||c.b!==d.b||c.a!==d.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Su extends _s{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class da extends _s{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class ad extends _s{getDefault(){return[!0,!0,!0,!0]}set(c){const d=this.current;(c[0]!==d[0]||c[1]!==d[1]||c[2]!==d[2]||c[3]!==d[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class fc extends _s{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class If extends _s{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Ld extends _s{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const d=this.current;(c.func!==d.func||c.ref!==d.ref||c.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class Ud extends _s{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const d=this.current;(c[0]!==d[0]||c[1]!==d[1]||c[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class e_ extends _s{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;c?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=c,this.dirty=!1}}class ld extends _s{getDefault(){return[0,1]}set(c){const d=this.current;(c[0]!==d[0]||c[1]!==d[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class SA extends _s{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;c?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=c,this.dirty=!1}}class Og extends _s{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class kg extends _s{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;c?d.enable(d.BLEND):d.disable(d.BLEND),this.current=c,this.dirty=!1}}class Pg extends _s{getDefault(){const c=this.gl;return[c.ONE,c.ZERO,c.ONE,c.ZERO]}set(c){const d=this.current;(c[0]!==d[0]||c[1]!==d[1]||c[2]!==d[2]||c[3]!==d[3]||this.dirty)&&(this.gl.blendFuncSeparate(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class TA extends _s{getDefault(){return p.ax.transparent}set(c){const d=this.current;(c.r!==d.r||c.g!==d.g||c.b!==d.b||c.a!==d.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Gs extends _s{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(c,c),this.current=c,this.dirty=!1)}}class so extends _s{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;c?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=c,this.dirty=!1}}class Fi extends _s{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class Bi extends _s{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}let gp=class extends _s{getDefault(){return null}set(_){(_!==this.current||this.dirty)&&(this.gl.useProgram(_),this.current=_,this.dirty=!1)}};class mp extends _s{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class cl extends _s{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const d=this.current;(c[0]!==d[0]||c[1]!==d[1]||c[2]!==d[2]||c[3]!==d[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Tl extends _s{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class t_ extends _s{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Ro extends _s{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class cd extends _s{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Un extends _s{getDefault(){return null}set(c){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Wr extends _s{getDefault(){return null}set(c){this.gl&&(c!==this.current||this.dirty)&&(this.gl.bindVertexArray(c),this.current=c,this.dirty=!1)}}class ys extends _s{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class Nr extends _s{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class Br extends _s{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class Qr extends _s{constructor(c,d){super(c),this.context=c,this.parent=d}getDefault(){return null}}class Df extends Qr{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class Bf extends Qr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Tu extends Qr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,this.attachment(),d.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class ln extends Bf{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ko{constructor(c,d,y,w,C){this.context=c,this.width=d,this.height=y;const I=this.framebuffer=c.gl.createFramebuffer();w&&(this.colorAttachment=new Df(c,I)),C&&(this.depthAttachmentType=C,this.depthAttachment="renderbuffer"===C?new Bf(c,I):new Tu(c,I))}destroy(){const c=this.context.gl;if(this.colorAttachment){const d=this.colorAttachment.get();d&&c.deleteTexture(d)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const d=this.depthAttachment.get();d&&c.deleteRenderbuffer(d)}else{const d=this.depthAttachment.get();d&&c.deleteTexture(d)}c.deleteFramebuffer(this.framebuffer)}}class kn{constructor(c,d,y){this.func=c,this.mask=d,this.range=y}}kn.ReadOnly=!1,kn.ReadWrite=!0,kn.disabled=new kn(519,kn.ReadOnly,[0,1]);class or{constructor(c,d,y,w,C,I){this.test=c,this.ref=d,this.mask=y,this.fail=w,this.depthFail=C,this.pass=I}}or.disabled=new or({func:519,mask:0},0,0,7680,7680,7680);class Tr{constructor(c,d,y,w){this.blendFunction=c,this.blendColor=d,this.mask=y,this.blendEquation=w}}Tr.Replace=[1,0,1,0],Tr.disabled=new Tr(Tr.Replace,p.ax.transparent,[!1,!1,!1,!1]),Tr.unblended=new Tr(Tr.Replace,p.ax.transparent,[!0,!0,!0,!0]),Tr.alphaBlended=new Tr([1,771,1,771],p.ax.transparent,[!0,!0,!0,!0]),Tr.multiply=new Tr([774,0,774,0],p.ax.transparent,[!0,!0,!0,!0]);class Ri{constructor(c,d,y){this.enable=c,this.mode=d,this.frontFace=y}}Ri.disabled=new Ri(!1,1029,2305),Ri.backCCW=new Ri(!0,1029,2305),Ri.backCW=new Ri(!0,1029,2304),Ri.frontCW=new Ri(!0,1028,2304),Ri.frontCCW=new Ri(!0,1028,2305);class Yu{constructor(c,d){this.gl=c,this.clearColor=new su(this),this.clearDepth=new Su(this),this.clearStencil=new da(this),this.colorMask=new ad(this),this.depthMask=new fc(this),this.stencilMask=new If(this),this.stencilFunc=new Ld(this),this.stencilOp=new Ud(this),this.stencilTest=new e_(this),this.depthRange=new ld(this),this.depthTest=new SA(this),this.depthFunc=new Og(this),this.blend=new kg(this),this.blendFunc=new Pg(this),this.blendColor=new TA(this),this.blendEquation=new Gs(this),this.cullFace=new so(this),this.cullFaceSide=new Fi(this),this.frontFace=new Bi(this),this.program=new gp(this),this.activeTexture=new mp(this),this.viewport=new cl(this),this.bindFramebuffer=new Tl(this),this.bindRenderbuffer=new t_(this),this.bindTexture=new Ro(this),this.bindVertexBuffer=new cd(this),this.bindElementBuffer=new Un(this),this.bindVertexArrayOES=new Wr(this),this.pixelStoreUnpack=new ys(this),this.pixelStoreUnpackPremultiplyAlpha=new Nr(this),this.pixelStoreUnpackFlipY=new Br(this),this.options=d?{...d}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=c.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=c.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=c.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=c.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE),this.maxPointSize=c.getParameter(c.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,d,y){return new es(this,c,d,y)}createVertexBuffer(c,d,y,w,C){return new Fo(this,c,d,y,w,C)}createRenderbuffer(c,d,y){const w=this.gl,C=w.createRenderbuffer();return this.bindRenderbuffer.set(C),w.renderbufferStorage(w.RENDERBUFFER,c,d,y),this.bindRenderbuffer.set(null),C}createFramebuffer(c,d,y,w){return new Ko(this,c,d,y,w)}clear({color:c,depth:d,stencil:y,colorMask:w}){const C=this.gl;let I=0;c&&(I|=C.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set(w||[!0,!0,!0,!0])),void 0!==d&&(I|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),void 0!==y&&(I|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),C.clear(I)}setCullFace(c){!1===c.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){Ai(c.blendFunction,Tr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor),c.blendEquation?this.blendEquation.set(c.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(c.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}var Ff=p.ay([{name:"a_pos",type:"Float32",components:3}]);class Oo{constructor(c,d,y,w){const C={width:y[0],height:y[1],data:null},I=c.gl;this.targetColorTexture=new p.T(c,C,I.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new p.T(c,C,I.RGBA,{useMipmap:!1}),this.context=c,this.setNumParticles(d,w),this.lastInvalidatedAt=0}setNumParticles(c,d){if(this.numParticles===d)return;(this.particleVertices0||this.particleVertices1||this.particleSegment)&&(this.particleVertices0.destroy(),this.particleVertices1.destroy(),this.particleSegment.destroy());const y=new p.az;y.reserve(Math.round(d));const w=p.aA(c.key);for(let C=0;C<d;C++)y.emplaceBack(w(),w(),w());this.particleVertices0=this.context.createVertexBuffer(y,Ff.members,!0),this.particleVertices1=this.context.createVertexBuffer(y,Ff.members,!0),this.particleSegment=p.aB.simpleSegment(0,0,this.particleVertices0.length,0),this.numParticles=d}update(c){return!(this.lastInvalidatedAt<c&&(this.lastInvalidatedAt=p.f.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleVertices0.destroy(),this.particleVertices1.destroy(),this.particleSegment.destroy()}}const Iu={type:2,extent:p.V,loadGeometry:()=>[[new p.P(0,0),new p.P(p.V+1,0),new p.P(p.V+1,p.V+1),new p.P(0,p.V+1),new p.P(0,0)]]};class Rf{constructor(c,d,y,w,C){this.tileID=c,this.uid=p.aC(),this.uses=0,this.tileSize=d,this.tileZoom=y,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=C,w&&w.style&&(this._lastUpdatedBrightness=w.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",w&&w.transform&&(this.projection=w.transform.projection)}registerFadeDuration(c){const d=c+this.timeAdded;d<p.f.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=p.as(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(c,d,y){if(this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(w,C){const I={};if(!C)return I;for(const B of w){const P=B.layerIds.map(Q=>C.getLayer(Q)).filter(Boolean);if(0!==P.length){B.layers=P,B.stateDependentLayerIds&&(B.stateDependentLayers=B.stateDependentLayerIds.map(Q=>P.filter(j=>j.id===Q)[0]));for(const Q of P)I[Q.fqid]=B}}return I}(c.buckets,d.style),this.hasSymbolBuckets=!1;for(const w in this.buckets){const C=this.buckets[w];if(C instanceof p.aE){if(this.hasSymbolBuckets=!0,!y)break;C.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const w in this.buckets){const C=this.buckets[w];if(C instanceof p.aE&&C.hasRTLText){this.hasRTLText=!0,p.aF();break}}this.queryPadding=0;for(const w in this.buckets){const C=this.buckets[w],I=d.style.getOwnLayer(w);if(!I)continue;const B=I.queryRadius(C);this.queryPadding=Math.max(this.queryPadding,B)}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage),c.lineAtlas&&(this.lineAtlas=c.lineAtlas),this._lastUpdatedBrightness=c.brightness}else this.collisionBoxArray=new p.aD}unloadVectorData(){if(this.hasData()){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(c){return this.buckets[c.fqid]}upload(c){for(const w in this.buckets){const C=this.buckets[w];C.uploadPending()&&C.upload(c)}const d=c.gl,y=this.imageAtlas;if(y&&!y.uploaded){const w=!!Object.keys(y.patternPositions).length;this.imageAtlasTexture=new p.T(c,y.image,d.RGBA,{useMipmap:w}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new p.T(c,this.glyphAtlasImage,d.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new p.T(c,this.lineAtlas.image,d.R8),this.lineAtlas.uploaded=!0)}prepare(c,d,y){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture,y),!d||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const w=d.style.getBrightness();(this._lastUpdatedBrightness||w)&&(this._lastUpdatedBrightness&&w&&Math.abs(this._lastUpdatedBrightness-w)<.001||(this._lastUpdatedBrightness=w,this.updateBuckets(void 0,d)))}queryRenderedFeatures(c,d,y,w,C,I,B,P){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:w,pixelPosMatrix:B,transform:I,params:C,tileTransform:this.tileTransform},c,d,y):{}}querySourceFeatures(c,d){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const w=y.loadVTLayers(),C=d?d.sourceLayer:"",I=w._geojsonTileLayer||w[C];if(!I)return;const B=p.aG(d&&d.filter),{z:P,x:Q,y:j}=this.tileID.canonical,q={z:P,x:Q,y:j};for(let J=0;J<I.length;J++){const te=I.feature(J);if(B.needGeometry){const Ae=p.aH(te,!0);if(!B.filter(new p.K(this.tileID.overscaledZ),Ae,this.tileID.canonical))continue}else if(!B.filter(new p.K(this.tileID.overscaledZ),te))continue;const le=y.getId(te,C),ce=new p.aI(te,P,Q,j,le);ce.tile=q,c.push(ce)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}bucketsLoaded(){for(const c in this.buckets)if(this.buckets[c].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){const d=this.expirationTime;if(c.cacheControl){const y=p.aJ(c.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const y=Date.now();let w=!1;if(this.expirationTime>y)w=!1;else if(d)if(this.expirationTime<d)w=!0;else{const C=this.expirationTime-d;C?this.expirationTime=y+Math.max(C,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(c,d){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(c).length&&d&&this.updateBuckets(c,d)}updateBuckets(c,d){if(!this.latestFeatureIndex)return;const y=this.latestFeatureIndex.loadVTLayers(),w=d.style.listImages(),C=d.style.getBrightness();for(const I in this.buckets){if(!d.style.hasLayer(I))continue;const B=this.buckets[I],P=B.layers[0].sourceLayer||"_geojsonTileLayer",Q=y[P];let j={};if(c&&(j=c[P],!Q||!j||0===Object.keys(j).length))continue;if(B.update(j,Q,w,this.imageAtlas&&this.imageAtlas.patternPositions||{},C),B instanceof p.aK||B instanceof p.aL){const J=d.style.getOwnSourceCache(B.layers[0].source);d._terrain&&d._terrain.enabled&&J&&B.programConfigurations.needsUpload&&d._terrain._clearRenderCacheForTile(J.id,this.tileID)}const q=d&&d.style&&d.style.getOwnLayer(I);q&&(this.queryPadding=Math.max(this.queryPadding,q.queryRadius(B)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<p.f.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=p.f.now()+c}setTexture(c,d){const y=d.context,w=y.gl;this.texture=this.texture||d.getTileTexture(c.width),this.texture&&this.texture instanceof p.T?this.texture.update(c,{useMipmap:!0}):(this.texture=new p.T(y,c,w.RGBA,{useMipmap:!0}),this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE))}setDependencies(c,d){const y={};for(const w of d)y[w]=!0;this.dependencies[c]=y}hasDependency(c,d){for(const y of c){const w=this.dependencies[y];if(w)for(const C of d)if(w[C])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(c,d){if(!d||"mercator"===d.name||this._tileDebugBuffer)return;const y=p.aM(Iu,this.tileID.canonical,this.tileTransform)[0],w=new p.aN,C=new p.aO;for(let I=0;I<y.length;I++){const{x:B,y:P}=y[I];w.emplaceBack(B,P),C.emplaceBack(I)}C.emplaceBack(0),this._tileDebugIndexBuffer=c.createIndexBuffer(C),this._tileDebugBuffer=c.createVertexBuffer(w,p.aP.members),this._tileDebugSegments=p.aB.simpleSegment(0,0,w.length,C.length)}_makeTileBoundsBuffers(c,d){if(this._tileBoundsBuffer||!d||"mercator"===d.name)return;const y=p.aM(Iu,this.tileID.canonical,this.tileTransform)[0];let w,C;if(this.isRaster){const I=function(B,P){const Q=p.as(B,P),j=Math.pow(2,B.z);for(let Ae=0;Ae<33;Ae++)for(let se=0;se<33;se++){const me=p.at((B.x+(se+wo(se))/32)/j),Ie=p.au((B.y+(Ae+wo(Ae))/32)/j),xe=P.project(me,Ie),Be=33*Ae+se;Ur[2*Be+0]=Math.round((xe.x*Q.scale-Q.x)*p.V),Ur[2*Be+1]=Math.round((xe.y*Q.scale-Q.y)*p.V)}Ci.fill(0),Jr.fill(0);for(let Ae=2045;Ae>=0;Ae--){const se=4*Ae,me=ji[se+0],Ie=ji[se+1],xe=ji[se+2],Be=ji[se+3],ge=me+xe>>1,Me=Ie+Be>>1,He=ge+Me-Ie,Ge=Me+me-ge,nt=33*Ie+me,dt=33*Be+xe,ot=33*Me+ge,Pt=Math.hypot((Ur[2*nt+0]+Ur[2*dt+0])/2-Ur[2*ot+0],(Ur[2*nt+1]+Ur[2*dt+1])/2-Ur[2*ot+1])>=16;Ci[ot]=Ci[ot]||(Pt?1:0),Ae<1022&&(Ci[ot]=Ci[ot]||Ci[33*(Ie+Ge>>1)+(me+He>>1)]||Ci[33*(Be+Ge>>1)+(xe+He>>1)])}const q=new p.av,J=new p.aw;let te=0;function le(Ae,se){const me=33*se+Ae;return 0===Jr[me]&&(q.emplaceBack(Ur[2*me+0],Ur[2*me+1],Ae*p.V/32,se*p.V/32),Jr[me]=++te),Jr[me]-1}function ce(Ae,se,me,Ie,xe,Be){const ge=Ae+me>>1,Me=se+Ie>>1;if(Math.abs(Ae-xe)+Math.abs(se-Be)>1&&Ci[33*Me+ge])ce(xe,Be,Ae,se,ge,Me),ce(me,Ie,xe,Be,ge,Me);else{const He=le(Ae,se),Ge=le(me,Ie),nt=le(xe,Be);J.emplaceBack(He,Ge,nt)}}return ce(0,0,32,32,32,0),ce(32,32,0,0,0,32),{vertices:q,indices:J}}(this.tileID.canonical,d);w=I.vertices,C=I.indices}else{w=new p.av,C=new p.aw;for(const{x:B,y:P}of y)w.emplaceBack(B,P,0,0);const I=p.aQ(w.int16,void 0,4);for(let B=0;B<I.length;B+=3)C.emplaceBack(I[B],I[B+1],I[B+2])}this._tileBoundsBuffer=c.createVertexBuffer(w,p.aR.members),this._tileBoundsIndexBuffer=c.createIndexBuffer(C),this._tileBoundsSegments=p.aB.simpleSegment(0,0,w.length,C.length)}_makeGlobeTileDebugBuffers(c,d){const y=d.projection;if(!y||"globe"!==y.name||d.freezeTileCoverage)return;const w=this.tileID.canonical,C=p.aS(w,d),I=p.aT(C),B=p.S(d.zoom);let P;B>0&&(P=p.a6.invert(new Float64Array(16),d.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(c,w,d,I,P,B),this._makeGlobeTileDebugTextBuffer(c,w,d,I,P,B)}_globePoint(c,d,y,w,C,I,B){let P=p.aU(c,d,y);if(I){const Q=1<<y.z,j=p.a5(w.center.lng),q=p.ae(w.center.lat),J=(y.x+.5)/Q-j;let te=0;J>.5?te=-1:J<-.5&&(te=1);let le=(c/p.V+y.x)/Q+te,ce=(d/p.V+y.y)/Q;le=(le-j)*w._pixelsPerMercatorPixel+j,ce=(ce-q)*w._pixelsPerMercatorPixel+q;const Ae=[le*w.worldSize,ce*w.worldSize,0];p.N.transformMat4(Ae,Ae,I),P=p.aV(P,Ae,B)}return p.N.transformMat4(P,P,C)}_makeGlobeTileDebugBorderBuffer(c,d,y,w,C,I){const B=new p.aN,P=new p.aO,Q=new p.aW,j=(J,te,le,ce,Ae)=>{const se=(le-J)/(Ae-1),me=(ce-te)/(Ae-1),Ie=B.length;for(let xe=0;xe<Ae;xe++){const Be=J+xe*se,ge=te+xe*me;B.emplaceBack(Be,ge);const Me=this._globePoint(Be,ge,d,y,w,C,I);Q.emplaceBack(Me[0],Me[1],Me[2]),P.emplaceBack(Ie+xe)}},q=p.V;j(0,0,q,0,16),j(q,0,q,q,16),j(q,q,0,q,16),j(0,q,0,0,16),this._tileDebugIndexBuffer=c.createIndexBuffer(P),this._tileDebugBuffer=c.createVertexBuffer(B,p.aP.members),this._globeTileDebugBorderBuffer=c.createVertexBuffer(Q,p.aX.members),this._tileDebugSegments=p.aB.simpleSegment(0,0,B.length,P.length)}_makeGlobeTileDebugTextBuffer(c,d,y,w,C,I){const B=p.V/4,P=new p.aN,Q=new p.aw,j=new p.aW,q=25;Q.reserve(32),P.reserve(q),j.reserve(q);const J=(te,le)=>q*te+le;for(let te=0;te<q;te++){const le=te*B;for(let ce=0;ce<q;ce++){const Ae=ce*B;P.emplaceBack(Ae,le);const se=this._globePoint(Ae,le,d,y,w,C,I);j.emplaceBack(se[0],se[1],se[2])}}for(let te=0;te<4;te++)for(let le=0;le<4;le++){const ce=J(te,le),Ae=J(te,le+1),se=J(te+1,le),me=J(te+1,le+1);Q.emplaceBack(ce,Ae,se),Q.emplaceBack(se,Ae,me)}this._tileDebugTextIndexBuffer=c.createIndexBuffer(Q),this._tileDebugTextBuffer=c.createVertexBuffer(P,p.aP.members),this._globeTileDebugTextBuffer=c.createVertexBuffer(j,p.aX.members),this._tileDebugTextSegments=p.aB.simpleSegment(0,0,q,32)}destroy(c=!1){for(const d in this.buckets)this.buckets[d].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!c&&this.texture&&this.texture instanceof p.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}const Vd={vector:gn,raster:Gn,"raster-dem":class extends Gn{constructor(_,c,d,y){super(_,c,d,y),this.type="raster-dem",this.maxzoom=22,this._options=p.e({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(_,c){const d=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(w,C){w&&(_.state="errored",c(w)),C&&(_.dem=C,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",c(null))}_.request=p.d(this.map._requestManager.transformRequest(d,p.R.Tile),function(w,C,I,B){if(delete _.request,_.aborted)_.state="unloaded",c(null);else if(w)_.state="errored",c(w);else if(C){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:I,expires:B});const P=ImageBitmap&&C instanceof ImageBitmap&&p.ak(),Q=1-(C.width-p.al(C.width))/2;Q<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const j=P?C:p.f.getImageData(C,Q),q={uid:_.uid,coord:_.tileID,source:this.id,scope:this.scope,rawImageData:j,encoding:this.encoding,padding:Q};_.actor&&"expired"!==_.state||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",q,y.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(_){const c=_.canonical,d=Math.pow(2,c.z),y=(c.x-1+d)%d,w=0===c.x?_.wrap-1:_.wrap,C=(c.x+1+d)%d,I=c.x+1===d?_.wrap+1:_.wrap,B={};return B[new p.am(_.overscaledZ,w,c.z,y,c.y).key]={backfilled:!1},B[new p.am(_.overscaledZ,I,c.z,C,c.y).key]={backfilled:!1},c.y>0&&(B[new p.am(_.overscaledZ,w,c.z,y,c.y-1).key]={backfilled:!1},B[new p.am(_.overscaledZ,_.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},B[new p.am(_.overscaledZ,I,c.z,C,c.y-1).key]={backfilled:!1}),c.y+1<d&&(B[new p.am(_.overscaledZ,w,c.z,y,c.y+1).key]={backfilled:!1},B[new p.am(_.overscaledZ,_.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},B[new p.am(_.overscaledZ,I,c.z,C,c.y+1).key]={backfilled:!1}),B}},"raster-array":Ln,geojson:class extends p.E{constructor(_,c,d,y){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(y),this._data=c.data,this._options=p.e({},c),this._collectResourceTiming=c.collectResourceTiming,void 0!==c.maxzoom&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const w=p.V/this.tileSize;this.workerOptions=p.e({source:this.id,scope:this.scope,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(void 0!==c.buffer?c.buffer:128)*w,tolerance:(void 0!==c.tolerance?c.tolerance:.375)*w,extent:p.V,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:void 0!==c.clusterMaxZoom?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:p.V,radius:(void 0!==c.clusterRadius?c.clusterRadius:50)*w,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id,scope:this.scope},c),this}getClusterChildren(_,c){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id,scope:this.scope},c),this}getClusterLeaves(_,c,d,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:_,limit:c,offset:d},y),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new p.b("dataloading",{dataType:"source"})),this._loaded=!1;const _=p.e({},this.workerOptions);_.scope=this.scope;const c=this._data;"string"==typeof c?(_.request=this.map._requestManager.transformRequest(p.f.resolveURL(c),p.R.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,(d,y)=>{if(this._loaded=!0,this._pendingLoad=null,d)this.fire(new p.a(d));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(w.resourceTiming=y.resourceTiming[this.id]),this.fire(new p.b("data",w)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(_,c){const d=_.actor?"reloadTile":"loadTile";_.actor=this.actor;const y={type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:p.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};_.request=this.actor.send(d,y,(w,C)=>(delete _.request,_.destroy(),_.aborted?c(null):w?c(w):(_.loadVectorData(C,this.map.painter,"reloadTile"===d),c(null))),void 0,"loadTile"===d)}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id,scope:this.scope}),_.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return p.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends p.ap{constructor(_,c,d,y){super(_,c,d,y),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const c of _.urls)this.urls.push(this.map._requestManager.transformRequest(c,p.R.Source).url);p.aq(this.urls,(c,d)=>{this._loaded=!0,c?this.fire(new p.a(c)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const c=this.video.seekable;_<c.start(0)||_>c.end(0)?this.fire(new p.a(new ei(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const _=this.map.painter.context,c=_.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new p.T(_,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(_)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:p.ap,model:class extends p.E{constructor(_,c,d,y){super(),this.id=_,this.type="model",this.models=[],this._loaded=!1,this._options=c}load(){const _=[];for(const c in this._options.models){const d=this._options.models[c],y=p.l(this.map._requestManager.transformRequest(d.uri,p.R.Model).url).then(w=>{if(!w)return;const C=p.c(w),I=new p.M(c,d.position,d.orientation,C);I.computeBoundsAndApplyParent(),this.models.push(I)}).catch(w=>{this.fire(new p.a(new Error(`Could not load model ${c} from ${d.uri}: ${w.message}`)))});_.push(y)}return Promise.allSettled(_).then(()=>{this._loaded=!0,this.fire(new p.b("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(c=>{this.fire(new p.a(new Error(`Could not load models: ${c.message}`)))})}onAdd(_){this.map=_,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(_,c){}serialize(){return{type:"model"}}},"batched-model":class extends p.E{constructor(_,c,d,y){super(),this.type="batched-model",this.id=_,this.tileSize=512,this._options=c,this.tiles=this._options.tiles,this.maxzoom=c.maxzoom||19,this.minzoom=c.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=d,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(y)}onAdd(_){this.map=_,this.load()}load(_){this._loaded=!1,this.fire(new p.b("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,d=this.map._worldview;this._tileJSONRequest=On(this._options,this.map._requestManager,c,d,(y,w)=>{this._tileJSONRequest=null,this._loaded=!0,y?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),d&&2!==d.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new p.a(y))):w&&(p.e(this,w),w.bounds&&(this.tileBounds=new Bn(w.bounds,this.minzoom,this.maxzoom)),p.aj(w.tiles,this.map._requestManager._customAccessToken),this.fire(new p.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.b("data",{dataType:"source",sourceDataType:"content"}))),_&&_(y)})}hasTransition(){return!1}hasTile(_){return!this.tileBounds||this.tileBounds.contains(_.canonical)}loaded(){return this._loaded}loadTile(_,c){const d=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(d,p.R.Tile),data:void 0,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,tileSize:this.tileSize*_.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:_.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(_.actor&&"expired"!==_.state)if("loading"===_.state)_.reloadCallback=c;else{if(_.buckets){const C=Object.values(_.buckets);for(const I of C)I.dirty=!0;return void(_.state="loaded")}_.request=_.actor.send("reloadTile",y,w.bind(this))}else _.actor=this.dispatcher.getActor(),_.request=_.actor.send("loadTile",y,w.bind(this),void 0,!0);function w(C,I){return _.aborted?c(null):C&&404!==C.status?c(C):(I&&(I.resourceTiming&&(_.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&_.setExpiryData(I),_.buckets={..._.buckets,...I.buckets},I.featureIndex&&(_.latestFeatureIndex=I.featureIndex)),_.state="loaded",void c(null))}}serialize(){return p.e({},this._options)}},canvas:class extends p.ap{constructor(_,c,d,y){super(_,c,d,y),c.coordinates?Array.isArray(c.coordinates)&&4===c.coordinates.length&&!c.coordinates.some(w=>!Array.isArray(w)||2!==w.length||w.some(C=>"number"!=typeof C))||this.fire(new p.a(new ei(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new p.a(new ei(`sources.${_}`,null,'missing required property "coordinates"'))),c.animate&&"boolean"!=typeof c.animate&&this.fire(new p.a(new ei(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),c.canvas?"string"==typeof c.canvas||c.canvas instanceof HTMLCanvasElement||this.fire(new p.a(new ei(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new p.a(new ei(`sources.${_}`,null,'missing required property "canvas"'))),this.options=c,this.animate=void 0===c.animate||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new p.a(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const c=this.map.painter.context;this.texture?!_&&!this._playing||this.texture instanceof p.ar||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new p.T(c,this.canvas,c.gl.RGBA,{premultiply:!0}),this._prepareData(c)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}},custom:class extends p.E{constructor(_,c,d,y){super(),this.id=_,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=c,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new p.a(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new p.a(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Bn(this._implementation.bounds,this.minzoom,this.maxzoom)),c.update=this._update.bind(this),c.clearTiles=this._clearTiles.bind(this),c.coveringTiles=this._coveringTiles.bind(this),p.e(this,p.ac(c,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return p.ac(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new p.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.b("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(_){this._map=_,this._loaded=!1,this.fire(new p.b("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(_),this.load()}onRemove(_){this._implementation.onRemove&&this._implementation.onRemove(_)}hasTile(_){if(this._implementation.hasTile){const{x:c,y:d,z:y}=_.canonical;return this._implementation.hasTile({x:c,y:d,z:y})}return!this.tileBounds||this.tileBounds.contains(_.canonical)}loadTile(_,c){const{x:d,y,z:w}=_.tileID.canonical,C=new AbortController;_.request=Promise.resolve(this._implementation.loadTile({x:d,y,z:w},{signal:C.signal})).then(function(I){return delete _.request,_.aborted?(_.state="unloaded",c(null)):void 0===I?(_.state="errored",c(null)):null===I?(this.loadTileData(_,{width:this.tileSize,height:this.tileSize,data:null}),_.state="loaded",c(null)):(B=I)instanceof ImageData||B instanceof HTMLCanvasElement||B instanceof ImageBitmap||B instanceof HTMLImageElement?(this.loadTileData(_,I),_.state="loaded",void c(null)):(_.state="errored",c(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var B}.bind(this)).catch(I=>{20!==I.code&&(_.state="errored",c(I))}),_.request.cancel=()=>C.abort()}loadTileData(_,c){_.setTexture(c,this._map.painter)}unloadTile(_,c){if(_.texture&&_.texture instanceof p.T?(_.destroy(!0),_.texture&&_.texture instanceof p.T&&this._map.painter.saveTileTexture(_.texture)):_.destroy(),this._implementation.unloadTile){const{x:d,y,z:w}=_.tileID.canonical;this._implementation.unloadTile({x:d,y,z:w})}c()}abortTile(_,c){_.request&&_.request.cancel&&(_.request.cancel(),delete _.request),c()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(_=>({x:_.canonical.x,y:_.canonical.y,z:_.canonical.z}))}_clearTiles(){const _=p.ag(this.id,this.scope);this._map.style.clearSource(_)}_update(){this.fire(new p.b("data",{dataType:"source",sourceDataType:"content"}))}}},ka=function(_,c,d,y){const w=new Vd[c.type](_,c,d,y);if(w.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${w.id}`);return p.aY(["load","abort","unload","serialize","prepare"],w),w};function Ng(_,c){const d=p.a6.identity([]);return p.a6.scale(d,d,[.5*_.width,.5*-_.height,1]),p.a6.translate(d,d,[1,-1,0]),p.a6.multiply(d,d,_.calculateProjMatrix(c.toUnwrapped())),Float32Array.from(d)}function n_(_,c,d,y,w,C,I,B=!1){const P=_.tilesIn(y,I,B);P.sort(_p);const Q=[];for(const q of P)Q.push({wrappedTileID:q.tile.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(c,d,_._state,q,w,C,Ng(_.transform,q.tile.tileID),B)});const j=function(q){const J={},te={};for(const le of q){const ce=le.queryResults,Ae=le.wrappedTileID,se=te[Ae]=te[Ae]||{};for(const me in ce){const Ie=ce[me],xe=se[me]=se[me]||{},Be=J[me]=J[me]||[];for(const ge of Ie)xe[ge.featureIndex]||(xe[ge.featureIndex]=!0,Be.push(ge))}}return J}(Q);for(const q in j)j[q].forEach(J=>{const te=J.feature,le=te.layer;le&&"background"!==le.type&&"sky"!==le.type&&"slot"!==le.type&&(te.source=le.source,le["source-layer"]&&(te.sourceLayer=le["source-layer"]),te.state=void 0!==te.id?_.getFeatureState(le["source-layer"],te.id):{})});return j}function Fh(_,c){const d=_.getRenderableIds().map(C=>_.getTileByID(C)),y=[],w={};for(let C=0;C<d.length;C++){const I=d[C],B=I.tileID.canonical.key;w[B]||(w[B]=!0,I.querySourceFeatures(y,c))}return y}function _p(_,c){const d=_.tileID,y=c.tileID;return d.overscaledZ-y.overscaledZ||d.canonical.y-y.canonical.y||d.wrap-y.wrap||d.canonical.x-y.canonical.x}class Il extends Rf{constructor(c,d,y,w,C){super(c,d,y,w,C),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(c,d){const y=d.context,w=y.gl;this.texture=this.texture||d.getTileTexture(c.width),this.texture&&this.texture instanceof p.T?this.texture.update(c,{useMipmap:!1,premultiply:!1}):this.texture=new p.T(y,c,w.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(c=16384,d){const y=this._mrt=new p.aZ(30),w=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(c-1)}});return this.entireBuffer=null,this.request=p.a_(w,(C,I,B,P)=>{if(C)d(C);else try{const Q=y.getHeaderLength(I);if(Q>c)return void(this.request=this.fetchHeader(Q,d));y.parseHeader(I),this._isHeaderLoaded=!0;let j=0;for(const q of Object.values(y.layers))j=Math.max(j,q.dataIndex[q.dataIndex.length-1].last_byte);I.byteLength>=j&&(this.entireBuffer=I),d(null,this.entireBuffer||I,B,P)}catch(Q){d(Q)}}),this.request}fetchBand(c,d,y){const w=this._mrt;if(!this._isHeaderLoaded||!w)return void y(new Error("Tile header is not ready"));const C=this.actor;if(!C)return void y(new Error("Can't fetch tile band without an actor"));let I;const B=(q,J)=>{I.complete(q,J),q?y(q):(this.updateTextureDescriptor(c,d),y(null,this.textureDescriptor&&this.textureDescriptor.img))},P=(q,J)=>{if(q)return y(q);const te=C.send("decodeRasterArray",{buffer:J,task:I},B,void 0,!0);this._workQueue.push(()=>{te&&te.cancel(),I.cancel()})},Q=w.getLayer(c);if(!Q)return void y(new Error(`Unknown sourceLayer "${c}"`));if(Q.hasDataForBand(d))return this.updateTextureDescriptor(c,d),void y(null,this.textureDescriptor?this.textureDescriptor.img:null);const j=Q.getDataRange([d]);if(I=w.createDecodingTask(j),!I||I.tasks.length)if(this.flushQueues(),this.entireBuffer)P(null,this.entireBuffer.slice(j.firstByte,j.lastByte+1));else{const q=Object.assign({},this.requestParams,{headers:{Range:`bytes=${j.firstByte}-${j.lastByte}`}}),J=p.a_(q,P);this._fetchQueue.push(()=>{J.cancel(),I.cancel()})}else y(null)}updateNeeded(c,d){return(!this.textureDescriptor||this.textureDescriptor.band!==d||this.textureDescriptor.layer!==c)&&"errored"!==this.state}updateTextureDescriptor(c,d){if(!this._mrt)return;const y=this._mrt.getLayer(c);if(!y||!y.hasBand(d)||!y.hasDataForBand(d))return;const{bytes:w,tileSize:C,buffer:I,offset:B,scale:P}=y.getBandView(d),Q=C+2*I,j={data:w,width:Q,height:Q},q=this.texture;q&&q instanceof p.T&&q.update(j,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:c,band:d,img:j,buffer:I,offset:B,tileSize:C,format:y.pixelFormat,mix:[P,256*P,65536*P,16777216*P]}}}class qi{constructor(c,d){this.max=c,this.onRemove=d,this.reset()}reset(){for(const c in this.data)for(const d of this.data[c])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(c,d,y){const w=c.wrapped().key;void 0===this.data[w]&&(this.data[w]=[]);const C={value:d,timeout:void 0};if(void 0!==y&&(C.timeout=setTimeout(()=>{this.remove(c,C)},y)),this.data[w].push(C),this.order.push(w),this.order.length>this.max){const I=this._getAndRemoveByKey(this.order[0]);I&&this.onRemove(I)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){const d=this.data[c].shift();return d.timeout&&clearTimeout(d.timeout),0===this.data[c].length&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),d.value}getByKey(c){const d=this.data[c];return d?d[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,d){if(!this.has(c))return this;const y=c.wrapped().key,w=void 0===d?0:this.data[y].indexOf(d),C=this.data[y][w];return this.data[y].splice(w,1),C.timeout&&clearTimeout(C.timeout),0===this.data[y].length&&delete this.data[y],this.onRemove(C.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(c){const d=[];for(const y in this.data)for(const w of this.data[y])c(w.value)||d.push(w);for(const y of d)this.remove(y.value.tileID,y)}}class Rh extends p.E{constructor(c,d,y){super(),this.id=c,this._onlySymbols=y,d.on("data",w=>{"source"===w.dataType&&"metadata"===w.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===w.dataType&&"content"===w.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),d.on("error",()=>{this._sourceErrored=!0}),this._source=d,this._tiles={},this._cache=new qi(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Sr,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"raster-array"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(c){this.map=c,this._minTileCacheSize=void 0===this._minTileCacheSize&&c?c._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&c?c._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const c in this._tiles){const d=this._tiles[c];if("errored"!==d.state&&("loaded"!==d.state||!d.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(c,d){return c.isSymbolTile=this._onlySymbols,c.isExtraShadowCaster=this._shadowCasterTiles[c.tileID.key],this._source.loadTile(c,d)}_unloadTile(c){if(this._source.unloadTile)return this._source.unloadTile(c,()=>{})}_abortTile(c){if(this._source.abortTile)return this._source.abortTile(c,()=>{})}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const y=this._tiles[d];y.upload(c),y.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return p.a$(this._tiles).map(c=>c.tileID).sort(Hd).map(c=>c.key)}getRenderableIds(c,d){const y=[];for(const w in this._tiles)this._isIdRenderable(+w,c,d)&&y.push(this._tiles[w]);return c?y.sort((w,C)=>{const I=w.tileID,B=C.tileID,P=new p.P(I.canonical.x,I.canonical.y)._rotate(this.transform.angle),Q=new p.P(B.canonical.x,B.canonical.y)._rotate(this.transform.angle);return I.overscaledZ-B.overscaledZ||Q.y-P.y||Q.x-P.x}).map(w=>w.tileID.key):y.map(w=>w.tileID).sort(Hd).map(w=>w.key)}hasRenderableParent(c){const d=this.findLoadedParent(c,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(c,d,y){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(d||!this._tiles[c].holdingForFade())&&(y||!this._shadowCasterTiles[c])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)"errored"!==this._tiles[c].state&&this._reloadTile(+c,"reloading")}}_reloadTile(c,d){const y=this._tiles[c];y&&("loading"!==y.state&&(y.state=d),this._loadTile(y,this._tileLoaded.bind(this,y,c,d)))}_tileLoaded(c,d,y,w){if(w)if(c.state="errored",404!==w.status)this._source.fire(new p.a(w,{tile:c}));else{if(!(c.tileID.key in this._loadedParentTiles))return void this._source.fire(new p.b("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const C=this.map.painter.terrain;this.update(this.transform,C.getScaledDemTileSize(),!0),C.resetTileLookupCache(this.id)}else this.update(this.transform)}else c.timeAdded=p.f.now(),"expired"===y&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(d,c),"raster-dem"===this._source.type&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),this._source.fire(new p.b("data",{dataType:"source",tile:c,coord:c.tileID,sourceCacheId:this.id}))}_backfillDEM(c){const d=this.getRenderableIds();for(let w=0;w<d.length;w++){const C=d[w];if(c.neighboringTiles&&c.neighboringTiles[C]){const I=this.getTileByID(C);y(c,I),y(I,c)}}function y(w,C){if(!w.dem||w.dem.borderReady)return;w.needsHillshadePrepare=!0,w.needsDEMTextureUpload=!0;let I=C.tileID.canonical.x-w.tileID.canonical.x;const B=C.tileID.canonical.y-w.tileID.canonical.y,P=Math.pow(2,w.tileID.canonical.z),Q=C.tileID.key;0===I&&0===B||Math.abs(B)>1||(Math.abs(I)>1&&(1===Math.abs(I+P)?I+=P:1===Math.abs(I-P)&&(I-=P)),C.dem&&w.dem&&(w.dem.backfillBorder(C.dem,I,B),w.neighboringTiles&&w.neighboringTiles[Q]&&(w.neighboringTiles[Q].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,d,y,w){for(const C in this._tiles){let I=this._tiles[C];if(w[C]||!I.hasData()||I.tileID.overscaledZ<=d||I.tileID.overscaledZ>y)continue;let B=I.tileID;for(;I&&I.tileID.overscaledZ>d+1;){const Q=I.tileID.scaledTo(I.tileID.overscaledZ-1);I=this._tiles[Q.key],I&&I.hasData()&&(B=Q)}let P=B;for(;P.overscaledZ>d;)if(P=P.scaledTo(P.overscaledZ-1),c[P.key]){w[B.key]=B;break}}}findLoadedParent(c,d){if(c.key in this._loadedParentTiles){const y=this._loadedParentTiles[c.key];return y&&y.tileID.overscaledZ>=d?y:null}for(let y=c.overscaledZ-1;y>=d;y--){const w=c.scaledTo(y),C=this._getLoadedTile(w);if(C)return C}}_getLoadedTile(c){const d=this._tiles[c.key];return d&&d.hasData()?d:this._cache.getByKey(this._source.reparseOverscaled?c.wrapped().key:c.canonical.key)}updateCacheSize(c,d){d=d||this._source.tileSize;const y=Math.ceil(c.width/d)+1,w=Math.ceil(c.height/d)+1,C=Math.floor(y*w*5),I="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,C):C,B="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,I):I;this._cache.setMaxSize(B)}handleWrapJump(c){const d=Math.round((c-(void 0===this._prevLng?c:this._prevLng))/360);if(this._prevLng=c,d){const y={};for(const w in this._tiles){const C=this._tiles[w];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+d),y[C.tileID.key]=C}this._tiles=y;for(const w in this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(const w in this._tiles)this._setTileReloadTimer(+w,this._tiles[w])}}update(c,d,y,w){if(this.transform=c,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!y)return;let C;if(this.updateCacheSize(c,d),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain)if(this._source.tileID)C=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(P=>new p.am(P.canonical.z,P.wrap,P.canonical.z,P.canonical.x,P.canonical.y));else if(0!==this.tileCoverLift){const P=c.clone();P.tileCoverLift=this.tileCoverLift,C=P.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.minzoom<=1&&"globe"===c.projection.name&&(C.push(new p.am(1,0,1,0,0)),C.push(new p.am(1,0,1,1,0)),C.push(new p.am(1,0,1,0,1)),C.push(new p.am(1,0,1,1,1)))}else C=c.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(C=C.filter(P=>this._source.hasTile(P)));else C=[];if(C.length>0&&this.castsShadows&&w&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!Qd(this._source.type)){const P=c.coveringZoomLevel({tileSize:d||this._source.tileSize,roundZoom:this._source.roundZoom&&!y}),Q=Math.min(P,this._source.maxzoom),j=c.extendTileCoverForShadows(C,w,Q);for(const q of j)this._shadowCasterTiles[q.key]=!0,C.push(q)}const I=this._updateRetainedTiles(C);if(Qd(this._source.type)&&0!==C.length){const P={},Q={},j=Object.keys(I);for(const J of j){const te=I[J],le=this._tiles[J];if(!le||le.fadeEndTime&&le.fadeEndTime<=p.f.now())continue;const ce=this.findLoadedParent(te,Math.max(te.overscaledZ-Rh.maxOverzooming,this._source.minzoom));ce&&(this._addTile(ce.tileID),P[ce.tileID.key]=ce.tileID),Q[J]=te}const q=C[C.length-1].overscaledZ;for(const J in this._tiles){const te=this._tiles[J];if(I[J]||!te.hasData())continue;let le=te.tileID;for(;le.overscaledZ>q;){le=le.scaledTo(le.overscaledZ-1);const ce=this._tiles[le.key];if(ce&&ce.hasData()&&Q[le.key]){I[J]=te.tileID;break}}}for(const J in P)I[J]||(this._coveredTiles[J]=!0,I[J]=P[J])}for(const P in I)this._tiles[P].clearFadeHold();const B=p.b0(this._tiles,I);for(const P of B){const Q=this._tiles[P];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile(+P)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(+c)}_updateRetainedTiles(c){const d={};if(0===c.length)return d;const y={},w=c.reduce((Q,j)=>Math.min(Q,j.overscaledZ),1/0),C=c[0].overscaledZ,I=Math.max(C-Rh.maxOverzooming,this._source.minzoom),B=Math.max(C+Rh.maxUnderzooming,this._source.minzoom),P={};for(const Q of c){const j=this._addTile(Q);d[Q.key]=Q,j.hasData()||w<this._source.maxzoom&&(P[Q.key]=Q)}this._retainLoadedChildren(P,w,B,d);for(const Q of c){let j=this._tiles[Q.key];if(j.hasData())continue;if(Q.canonical.z>=this._source.maxzoom){const J=Q.children(this._source.maxzoom)[0],te=this.getTile(J);if(te&&te.hasData()){d[J.key]=J;continue}}else{const J=Q.children(this._source.maxzoom);if(d[J[0].key]&&d[J[1].key]&&d[J[2].key]&&d[J[3].key])continue}let q=j.wasRequested();for(let J=Q.overscaledZ-1;J>=I;--J){const te=Q.scaledTo(J);if(y[te.key]||(y[te.key]=!0,j=this.getTile(te),!j&&q&&(j=this._addTile(te)),j&&(d[te.key]=te,q=j.wasRequested(),j.hasData())))break}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const c in this._tiles){const d=[];let y,w=this._tiles[c].tileID;for(;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){y=this._loadedParentTiles[w.key];break}d.push(w.key);const C=w.scaledTo(w.overscaledZ-1);if(y=this._getLoadedTile(C),y)break;w=C}for(const C of d)this._loadedParentTiles[C]=y}}_addTile(c){let d=this._tiles[c.key];if(d)return!0!==d.isExtraShadowCaster||this._shadowCasterTiles[c.key]||this._reloadTile(c.key,"reloading"),d;d=this._cache.getAndRemove(c),d&&(this._setTileReloadTimer(c.key,d),d.tileID=c,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,d)));const y=!!d;if(!y){const w=this.map?this.map.painter:null,C=this._source.tileSize*c.overscaleFactor();d="raster-array"===this._source.type?new Il(c,C,this.transform.tileZoom,w,this._isRaster):new Rf(c,C,this.transform.tileZoom,w,this._isRaster),this._loadTile(d,this._tileLoaded.bind(this,d,c.key,d.state))}return d?(d.uses++,this._tiles[c.key]=d,y||this._source.fire(new p.b("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d):null}_setTileReloadTimer(c,d){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);const y=d.getExpiryTimeout();y&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},y))}_removeTile(c){const d=this._tiles[c];d&&(d.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),d.uses>0||(d.hasData()&&"reloading"!==d.state||"empty"===d.state?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c in this._tiles)this._removeTile(+c);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(c,d,y){const w=[],C=this.transform;if(!C)return w;const I="globe"===C.projection.name,B=p.a5(C.center.lng);for(const P in this._tiles){const Q=this._tiles[P];if(y&&Q.clearQueryDebugViz(),Q.holdingForFade())continue;let j;if(I){const q=Q.tileID.canonical;if(0===q.z){const J=[Math.abs(p.aa(B,...Pn(q,-1))-B),Math.abs(p.aa(B,...Pn(q,1))-B)];j=[0,2*J.indexOf(Math.min(...J))-1]}else{const J=[Math.abs(p.aa(B,...Pn(q,-1))-B),Math.abs(p.aa(B,...Pn(q,0))-B),Math.abs(p.aa(B,...Pn(q,1))-B)];j=[J.indexOf(Math.min(...J))-1]}}else j=[0];for(const q of j){const J=c.containsTile(Q,C,d,q);J&&w.push(J)}}return w}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(c){return this._getRenderableCoordinates(c)}_getRenderableCoordinates(c,d){const y=this.getRenderableIds(c,d).map(C=>this._tiles[C].tileID),w="globe"===this.transform.projection.name;for(const C of y)C.projMatrix=this.transform.calculateProjMatrix(C.toUnwrapped()),C.expandedProjMatrix=w?this.transform.calculateProjMatrix(C.toUnwrapped(),!1,!0):C.projMatrix;return y}sortCoordinatesByDistance(c){const d=c.slice(),y=this.transform._camera.position,w=this.transform._camera.forward(),C={};for(const I of d){const B=1/(1<<I.canonical.z);C[I.key]=((I.canonical.x+.5)*B+I.wrap-y[0])*w[0]+((I.canonical.y+.5)*B-y[1])*w[1]-y[2]*w[2]}return d.sort((I,B)=>C[I.key]-C[B.key]),d}hasTransition(){if(this._source.hasTransition())return!0;if(Qd(this._source.type))for(const c in this._tiles){const d=this._tiles[c];if(void 0!==d.fadeEndTime&&d.fadeEndTime>=p.f.now())return!0}return!1}setFeatureState(c,d,y){this._state.updateState(c=c||"_geojsonTileLayer",d,y)}removeFeatureState(c,d,y){this._state.removeFeatureState(c=c||"_geojsonTileLayer",d,y)}getFeatureState(c,d){return this._state.getState(c=c||"_geojsonTileLayer",d)}setDependencies(c,d,y){const w=this._tiles[c];w&&w.setDependencies(d,y)}reloadTilesForDependencies(c,d){for(const y in this._tiles)this._tiles[y].hasDependency(c,d)&&this._reloadTile(+y,"reloading");this._cache.filter(y=>!y.hasDependency(c,d))}_preloadTiles(c,d){if(!this._sourceLoaded){const P=()=>{this._sourceLoaded&&(this._source.off("data",P),this._preloadTiles(c,d))};return void this._source.on("data",P)}const y=new Map,w=Array.isArray(c)?c:[c],C=this.map.painter.terrain,I=this.usedForTerrain&&C?C.getScaledDemTileSize():this._source.tileSize;for(const P of w){const Q=P.coveringTiles({tileSize:I,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const j of Q)y.set(j.key,j);this.usedForTerrain&&P.updateElevation(!1)}const B=Array.from(y.values());p.b1(B,(P,Q)=>{const j=new Rf(P,this._source.tileSize*P.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(j,q=>{"raster-dem"===this._source.type&&j.dem&&this._backfillDEM(j),Q(q,j)})},d)}}function Hd(_,c){const d=Math.abs(2*_.wrap)-+(_.wrap<0),y=Math.abs(2*c.wrap)-+(c.wrap<0);return _.overscaledZ-c.overscaledZ||y-d||c.canonical.y-_.canonical.y||c.canonical.x-_.canonical.x}function Qd(_){return"raster"===_||"image"===_||"video"===_||"custom"===_}function Pn(_,c){const d=1<<_.z;return[_.x/d+c,(_.x+1)/d+c]}Rh.maxOverzooming=10,Rh.maxUnderzooming=3;class pv{constructor(c){this.style=c,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];for(const y in this.style._mergedLayers){const w=this.style._mergedLayers[y];if("fill-extrusion"===w.type)this.layers.push({layer:w,visible:false,visibilityChanged:false});else if("model"===w.type){const C=this.style.getLayerSource(w);C&&"batched-model"===C.type&&this.layers.push({layer:w,visible:false,visibilityChanged:false})}}}onNewFrame(c){this.layersGotHidden=!1;for(const d of this.layers){const y=d.layer;let w=!1;"fill-extrusion"===y.type?w=!y.isHidden(c)&&y.paint.get("fill-extrusion-opacity")>0:"model"===y.type&&(w=!y.isHidden(c)&&y.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!w&&d.visible,d.visible=w}}updateZOffset(c,d){this.currentBuildingBuckets=[];for(const w of this.layers){const C=w.layer,I=this.style.getLayerSourceCache(C);let B=1;"fill-extrusion"===C.type&&(B=w.visible?C.paint.get("fill-extrusion-vertical-scale"):0);let P=I?I.getTile(d):null;if(!P&&I&&d.canonical.z>I.getSource().minzoom){let Q=d.scaledTo(Math.min(I.getSource().maxzoom,d.overscaledZ-1));for(;Q.overscaledZ>=I.getSource().minzoom&&(P=I.getTile(Q),!P&&0!==Q.overscaledZ);)Q=Q.scaledTo(Q.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:P?P.getBucket(C):null,tileID:P?P.tileID:d,verticalScale:B})}c.hasAnyZOffset=!1;let y=!1;for(let w=0;w<c.symbolInstances.length;w++){const C=c.symbolInstances.get(w),I=C.zOffset,B=this._getHeightAtTileOffset(d,C.tileAnchorX,C.tileAnchorY);C.zOffset=B!==Number.NEGATIVE_INFINITY?B:I,y||I===C.zOffset||(y=!0),c.hasAnyZOffset||0===C.zOffset||(c.hasAnyZOffset=!0)}y&&(c.zOffsetBuffersNeedUpload=!0,c.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(c,d,y,w){let C=d,I=y;if(c.canonical.z!==w.canonical.z){const B=w.canonical,P=1/(1<<c.canonical.z-B.z);C=(d+c.canonical.x*p.V)*P-B.x*p.V|0,I=(y+c.canonical.y*p.V)*P-B.y*p.V|0}return{tileX:C,tileY:I}}_getHeightAtTileOffset(c,d,y){let w,C;for(let I=0;I<this.layers.length;++I){if("fill-extrusion"!==this.layers[I].layer.type)continue;const{bucket:B,tileID:P,verticalScale:Q}=this.currentBuildingBuckets[I];if(!B)continue;const{tileX:j,tileY:q}=this._mapCoordToOverlappingTile(c,d,y,P),J=B.getHeightAtTileCoord(j,q);J&&void 0!==J.height&&(J.hidden?w=J.height:C=Math.max(J.height*Q,C||0))}if(void 0!==C)return C;for(let I=0;I<this.layers.length;++I){const B=this.layers[I];if("model"!==B.layer.type||!B.visible)continue;const{bucket:P,tileID:Q}=this.currentBuildingBuckets[I];if(!P)continue;const{tileX:j,tileY:q}=this._mapCoordToOverlappingTile(c,d,y,Q),J=P.getHeightAtTileCoord(j,q);if(J&&!J.hidden)return void 0===J.height&&void 0!==w?Math.min(J.maxHeight,w)*J.verticalScale:(J.height||0)*J.verticalScale}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function cs(_,c){const d={};for(const y in _)"ref"!==y&&(d[y]=_[y]);return p.b2.forEach(y=>{y in c&&(d[y]=c[y])}),d}function jd(_){_=_.slice();const c=Object.create(null);for(let d=0;d<_.length;d++)c[_[d].id]=_[d];for(let d=0;d<_.length;d++)"ref"in _[d]&&(_[d]=cs(_[d],c[_[d].ref]));return _}const Or={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Of(_,c,d){d.push({command:Or.addSource,args:[_,c[_]]})}function i_(_,c,d){c.push({command:Or.removeSource,args:[_]}),d[_]=!0}function Ju(_,c,d,y){i_(_,d,y),Of(_,c,d)}function kf(_,c,d){let y;for(y in _[d])if(_[d].hasOwnProperty(y)&&"data"!==y&&!Ai(_[d][y],c[d][y]))return!1;for(y in c[d])if(c[d].hasOwnProperty(y)&&"data"!==y&&!Ai(_[d][y],c[d][y]))return!1;return!0}function Du(_,c,d,y,w,C){let I;for(I in c=c||{},_=_||{})_.hasOwnProperty(I)&&(Ai(_[I],c[I])||d.push({command:C,args:[y,I,c[I],w]}));for(I in c)c.hasOwnProperty(I)&&!_.hasOwnProperty(I)&&(Ai(_[I],c[I])||d.push({command:C,args:[y,I,c[I],w]}))}function ud(_){return _.id}function Lg(_,c){return _[c.id]=c,_}class vs{constructor(c,d){this.reset(c,d)}reset(c,d){this.points=c||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(1===this.points.length)return this.points[0];c=p.aa(c,0,1);let d=1,y=this._distances[d];const w=c*this.paddedLength+this.padding;for(;y<w&&d<this._distances.length;)y=this._distances[++d];const C=d-1,I=this._distances[C],B=y-I,P=B>0?(w-I)/B:0;return this.points[C].mult(1-P).add(this.points[d].mult(P))}}class yp{constructor(c,d,y){const w=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(c/y),this.yCellCount=Math.ceil(d/y);for(let I=0;I<this.xCellCount*this.yCellCount;I++)w.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=d,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,d,y,w,C){this._forEachCell(d,y,w,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(w),this.bboxes.push(C)}insertCircle(c,d,y,w){this._forEachCell(d-w,y-w,d+w,y+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(d),this.circles.push(y),this.circles.push(w)}_insertBoxCell(c,d,y,w,C,I){this.boxCells[C].push(I)}_insertCircleCell(c,d,y,w,C,I){this.circleCells[C].push(I)}_query(c,d,y,w,C,I){if(y<0||c>this.width||w<0||d>this.height)return!C&&[];const B=[];if(c<=0&&d<=0&&this.width<=y&&this.height<=w){if(C)return!0;for(let P=0;P<this.boxKeys.length;P++)B.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const Q=this.circles[3*P],j=this.circles[3*P+1],q=this.circles[3*P+2];B.push({key:this.circleKeys[P],x1:Q-q,y1:j-q,x2:Q+q,y2:j+q})}return I?B.filter(I):B}return this._forEachCell(c,d,y,w,this._queryCell,B,{hitTest:C,seenUids:{box:{},circle:{}}},I),C?B.length>0:B}_queryCircle(c,d,y,w,C){const I=c-y,B=c+y,P=d-y,Q=d+y;if(B<0||I>this.width||Q<0||P>this.height)return!w&&[];const j=[];return this._forEachCell(I,P,B,Q,this._queryCellCircle,j,{hitTest:w,circle:{x:c,y:d,radius:y},seenUids:{box:{},circle:{}}},C),w?j.length>0:j}query(c,d,y,w,C){return this._query(c,d,y,w,!1,C)}hitTest(c,d,y,w,C){return this._query(c,d,y,w,!0,C)}hitTestCircle(c,d,y,w){return this._queryCircle(c,d,y,!0,w)}_queryCell(c,d,y,w,C,I,B,P){const Q=B.seenUids,j=this.boxCells[C];if(null!==j){const J=this.bboxes;for(const te of j)if(!Q.box[te]){Q.box[te]=!0;const le=4*te;if(c<=J[le+2]&&d<=J[le+3]&&y>=J[le+0]&&w>=J[le+1]&&(!P||P(this.boxKeys[te]))){if(B.hitTest)return I.push(!0),!0;I.push({key:this.boxKeys[te],x1:J[le],y1:J[le+1],x2:J[le+2],y2:J[le+3]})}}}const q=this.circleCells[C];if(null!==q){const J=this.circles;for(const te of q)if(!Q.circle[te]){Q.circle[te]=!0;const le=3*te;if(this._circleAndRectCollide(J[le],J[le+1],J[le+2],c,d,y,w)&&(!P||P(this.circleKeys[te]))){if(B.hitTest)return I.push(!0),!0;{const ce=J[le],Ae=J[le+1],se=J[le+2];I.push({key:this.circleKeys[te],x1:ce-se,y1:Ae-se,x2:ce+se,y2:Ae+se})}}}}}_queryCellCircle(c,d,y,w,C,I,B,P){const Q=B.circle,j=B.seenUids,q=this.boxCells[C];if(null!==q){const te=this.bboxes;for(const le of q)if(!j.box[le]){j.box[le]=!0;const ce=4*le;if(this._circleAndRectCollide(Q.x,Q.y,Q.radius,te[ce+0],te[ce+1],te[ce+2],te[ce+3])&&(!P||P(this.boxKeys[le])))return I.push(!0),!0}}const J=this.circleCells[C];if(null!==J){const te=this.circles;for(const le of J)if(!j.circle[le]){j.circle[le]=!0;const ce=3*le;if(this._circlesCollide(te[ce],te[ce+1],te[ce+2],Q.x,Q.y,Q.radius)&&(!P||P(this.circleKeys[le])))return I.push(!0),!0}}}_forEachCell(c,d,y,w,C,I,B,P){const Q=this._convertToXCellCoord(c),j=this._convertToYCellCoord(d),q=this._convertToXCellCoord(y),J=this._convertToYCellCoord(w);for(let te=Q;te<=q;te++)for(let le=j;le<=J;le++)if(C.call(this,c,d,y,w,this.xCellCount*le+te,I,B,P))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,d,y,w,C,I){const B=w-c,P=C-d,Q=y+I;return Q*Q>B*B+P*P}_circleAndRectCollide(c,d,y,w,C,I,B){const P=(I-w)/2,Q=Math.abs(c-(w+P));if(Q>P+y)return!1;const j=(B-C)/2,q=Math.abs(d-(C+j));if(q>j+y)return!1;if(Q<=P||q<=j)return!0;const J=Q-P,te=q-j;return J*J+te*te<=y*y}}const Oh={unknown:0,flipRequired:1,flipNotRequired:2},Pa=Math.tan(85*Math.PI/180);function IA(_,c,d,y,w,C,I){const B=p.a6.create();if(d)if("globe"===C.name){const P=p.b3(w,c);p.a6.multiply(B,B,P)}else{const P=p.b4.invert([],I);B[0]=P[0],B[1]=P[1],B[4]=P[2],B[5]=P[3],y||p.a6.rotateZ(B,B,w.angle)}else p.a6.multiply(B,w.labelPlaneMatrix,_);return B}function D0(_,c,d,y,w,C,I){const B=IA(_,c,d,y,w,C,I);return"globe"===C.name&&d||(B[2]=B[6]=B[10]=B[14]=0),B}function Uo(_,c,d,y,w,C,I){if(d){if("globe"===C.name){const B=IA(_,c,d,y,w,C,I);return p.a6.invert(B,B),p.a6.multiply(B,_,B),B}{const B=p.a6.clone(_),P=p.a6.identity([]);return P[0]=I[0],P[1]=I[1],P[4]=I[2],P[5]=I[3],p.a6.multiply(B,B,P),y||p.a6.rotateZ(B,B,-w.angle),B}}return w.glCoordMatrix}function eh(_,c,d,y){const w=[_,c,d,1];d?p.a7.transformMat4(w,w,y):B0(w,w,y);const C=w[3];return w[0]/=C,w[1]/=C,w[2]/=C,w}function gv(_,c){return Math.min(.5+_/c*.5,1.5)}function pi(_,c){const d=_[0]/_[3],y=_[1]/_[3];return d>=-c[0]&&d<=c[0]&&y>=-c[1]&&y<=c[1]}function Gd(_,c,d,y,w,C,I,B,P,Q){const j=d.transform,q=y?_.textSizeData:_.iconSizeData,J=p.b5(q,d.transform.zoom),te="globe"===j.projection.name,le=[256/d.width*2+1,256/d.height*2+1],ce=y?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;ce.clear();let Ae=null;te&&(Ae=y?_.text.globeExtVertexArray:_.icon.globeExtVertexArray);const se=_.lineVertexArray,me=y?_.text.placedSymbolArray:_.icon.placedSymbolArray,Ie=d.transform.width/d.transform.height;let xe,Be=!1;for(let ge=0;ge<me.length;ge++){const Me=me.get(ge),{numGlyphs:He,writingMode:Ge}=Me;if(Ge!==p.b6.vertical||Be||xe===p.b6.horizontal||(Be=!0),xe=Ge,(Me.hidden||Ge===p.b6.vertical)&&!Be){Pf(He,ce);continue}Be=!1;const nt=new p.P(Me.tileAnchorX,Me.tileAnchorY);let{x:dt,y:ot,z:Pt}=j.projection.projectTilePoint(nt.x,nt.y,Q.canonical);if(P){const[$n,li,xi]=P(nt);dt+=$n,ot+=li,Pt+=xi}const Rt=[dt,ot,Pt,1];if(p.a7.transformMat4(Rt,Rt,c),!pi(Rt,le)){Pf(He,ce);continue}const cn=Rt[3],ct=gv(d.transform.getCameraToCenterDistance(j.projection),cn),St=p.b7(q,J,Me),Ze=I?St/ct:St*ct,gt=eh(dt,ot,Pt,w);if(gt[3]<=0){Pf(He,ce);continue}let An={};const Tn=I?null:P,Cn=bp(Me,Ze,!1,B,c,w,C,_.glyphOffsetArray,se,ce,Ae,gt,nt,An,Ie,Tn,j.projection,Q,I);Be=Cn.useVertical,Tn&&Cn.needsFlipping&&(An={}),(Cn.notEnoughRoom||Be||Cn.needsFlipping&&bp(Me,Ze,!0,B,c,w,C,_.glyphOffsetArray,se,ce,Ae,gt,nt,An,Ie,Tn,j.projection,Q,I).notEnoughRoom)&&Pf(He,ce)}y?(_.text.dynamicLayoutVertexBuffer.updateData(ce),Ae&&_.text.globeExtVertexBuffer&&_.text.globeExtVertexBuffer.updateData(Ae)):(_.icon.dynamicLayoutVertexBuffer.updateData(ce),Ae&&_.icon.globeExtVertexBuffer&&_.icon.globeExtVertexBuffer.updateData(Ae))}function vp(_,c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce){const{lineStartIndex:Ae,glyphStartIndex:se,segment:me}=B,Ie=se+B.numGlyphs,xe=Ae+B.lineLength,Be=c.getoffsetX(se),ge=c.getoffsetX(Ie-1),Me=zg(_*Be,d,y,w,C,I,me,Ae,xe,P,Q,j,q,J,!0,te,le,ce);if(!Me)return null;const He=zg(_*ge,d,y,w,C,I,me,Ae,xe,P,Q,j,q,J,!0,te,le,ce);return He?{first:Me,last:He}:null}function Ug(_,c,d,y){return _===p.b6.horizontal&&Math.abs(y)>Math.abs(d)?{useVertical:!0}:_===p.b6.vertical?y>0?{needsFlipping:!0}:null:c!==Oh.unknown&&(0===(w=d)||Math.abs(y/w)>Pa)?c===Oh.flipRequired?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null;var w}function bp(_,c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce,Ae,se,me){const Ie=c/24,xe=_.lineOffsetX*Ie,Be=_.lineOffsetY*Ie,{lineStartIndex:ge,glyphStartIndex:Me,numGlyphs:He,segment:Ge,writingMode:nt,flipState:dt}=_,ot=ge+_.lineLength,Pt=Rt=>{if(j){const[Ze,gt,An]=Rt.up,Tn=Q.length;p.b8(j,Tn+0,Ze,gt,An),p.b8(j,Tn+1,Ze,gt,An),p.b8(j,Tn+2,Ze,gt,An),p.b8(j,Tn+3,Ze,gt,An)}const[cn,ct,St]=Rt.point;p.b9(Q,cn,ct,St,Rt.angle)};if(He>1){const Rt=vp(Ie,B,xe,Be,d,q,J,_,P,C,te,ce,!1,Ae,se,me);if(!Rt)return{notEnoughRoom:!0};if(y&&!d){let[cn,ct,St]=Rt.first.point,[Ze,gt,An]=Rt.last.point;[cn,ct]=eh(cn,ct,St,I),[Ze,gt]=eh(Ze,gt,An,I);const Tn=Ug(nt,dt,(Ze-cn)*le,gt-ct);if(_.flipState=Tn&&Tn.needsFlipping?Oh.flipRequired:Oh.flipNotRequired,Tn)return Tn}Pt(Rt.first);for(let cn=Me+1;cn<Me+He-1;cn++){const ct=zg(Ie*B.getoffsetX(cn),xe,Be,d,q,J,Ge,ge,ot,P,C,te,ce,!1,!1,Ae,se,me);if(!ct)return Q.length-=4*(cn-Me),{notEnoughRoom:!0};Pt(ct)}Pt(Rt.last)}else{if(y&&!d){const cn=eh(J.x,J.y,0,w),ct=ge+Ge+1,St=new p.P(P.getx(ct),P.gety(ct)),Ze=eh(St.x,St.y,0,w),gt=Ze[3]>0?Ze:BA(J,St,cn,1,w,void 0,Ae,se.canonical),An=Ug(nt,dt,(gt[0]-cn[0])*le,gt[1]-cn[1]);if(_.flipState=An&&An.needsFlipping?Oh.flipRequired:Oh.flipNotRequired,An)return An}const Rt=zg(Ie*B.getoffsetX(Me),xe,Be,d,q,J,Ge,ge,ot,P,C,te,ce,!1,!1,Ae,se,me);if(!Rt)return{notEnoughRoom:!0};Pt(Rt)}return{}}function DA(_,c,d,y,w){const{x:C,y:I,z:B}=y.projectTilePoint(_.x,_.y,c);if(!w)return eh(C,I,B,d);const[P,Q,j]=w(_);return eh(C+P,I+Q,B+j,d)}function BA(_,c,d,y,w,C,I,B){const P=DA(_.sub(c)._unit()._add(_),B,w,I,C);return p.N.sub(P,d,P),p.N.normalize(P,P),p.N.scaleAndAdd(P,d,P,y)}function zg(_,c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce,Ae,se){const me=y?_-c:_+c;let Ie=me>0?1:-1,xe=0;y&&(Ie*=-1,xe=Math.PI),Ie<0&&(xe+=Math.PI);let Be=B+I+(Ie>0?0:1)|0,ge=w,Me=w,He=0,Ge=0;const nt=Math.abs(me),dt=[],ot=[];let Pt=C,Rt=Pt;const cn=()=>BA(Rt,Pt,Me,nt-He+1,j,J,ce,Ae.canonical);for(;He+Ge<=nt;){if(Be+=Ie,Be<B||Be>=P)return null;if(Me=ge,Rt=Pt,dt.push(Me),te&&ot.push(Rt),Pt=new p.P(Q.getx(Be),Q.gety(Be)),ge=q[Be],!ge){const li=DA(Pt,Ae.canonical,j,ce,J);ge=li[3]>0?q[Be]=li:cn()}He+=Ge,Ge=p.N.distance(Me,ge)}le&&J&&(q[Be]&&(ge=cn(),Ge=p.N.distance(Me,ge)),q[Be]=ge);const ct=(nt-He)/Ge,St=Pt.sub(Rt)._mult(ct)._add(Rt),Ze=p.N.sub([],ge,Me),gt=p.N.scaleAndAdd([],Me,Ze,ct);let An=[0,0,1],Tn=Ze[0],Cn=Ze[1];if(se&&(An=ce.upVector(Ae.canonical,St.x,St.y),0!==An[0]||0!==An[1]||1!==An[2])){const li=[An[2],0,-An[0]],xi=p.N.cross([],An,li);p.N.normalize(li,li),p.N.normalize(xi,xi),Tn=p.N.dot(Ze,li),Cn=p.N.dot(Ze,xi)}if(d){const li=p.N.cross([],An,Ze);p.N.normalize(li,li),p.N.scaleAndAdd(gt,gt,li,d*Ie)}const $n=xe+Math.atan2(Cn,Tn);return dt.push(gt),te&&ot.push(St),{point:gt,angle:$n,path:dt,tilePath:ot,up:An}}function Pf(_,c){const d=c.length,y=d+4*_;c.resize(y),c.float32.fill(-1/0,4*d,4*y)}function B0(_,c,d){const y=c[0],w=c[1];return _[0]=d[0]*y+d[4]*w+d[12],_[1]=d[1]*y+d[5]*w+d[13],_[3]=d[3]*y+d[7]*w+d[15],_}const ou=100;class Jn{constructor(c,d,y=new yp(c.width+200,c.height+200,25),w=new yp(c.width+200,c.height+200,25)){this.transform=c,this.grid=y,this.ignoredGrid=w,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+ou,this.screenBottomBoundary=c.height+ou,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=d}placeCollisionBox(c,d,y,w,C,I,B,P){let Q=y.projectedAnchorX,j=y.projectedAnchorY,q=y.projectedAnchorZ;const J=y.elevation,te=y.tileID,le=c.getProjection();if(J&&te){const[ge,Me,He]=le.upVector(te.canonical,y.tileAnchorX,y.tileAnchorY),Ge=le.upVectorScale(te.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;Q+=ge*J*Ge,j+=Me*J*Ge,q+=He*J*Ge}const ce=this.projectAndGetPerspectiveRatio(B,Q,j,q,y.tileID,"globe"===le.name||!!J||this.transform.pitch>0,le),Ae=I*ce.perspectiveRatio,se=(y.x1*d+w.x-y.padding)*Ae+ce.point.x,me=(y.y1*d+w.y-y.padding)*Ae+ce.point.y,Ie=(y.x2*d+w.x+y.padding)*Ae+ce.point.x,xe=(y.y2*d+w.y+y.padding)*Ae+ce.point.y,Be=ce.perspectiveRatio<=.55||ce.occluded;return!this.isInsideGrid(se,me,Ie,xe)||!C&&this.grid.hitTest(se,me,Ie,xe,P)||Be?{box:[],offscreen:!1,occluded:ce.occluded}:{box:[se,me,Ie,xe],offscreen:this.isOffscreen(se,me,Ie,xe),occluded:!1}}placeCollisionCircles(c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce){const Ae=[],se=this.transform.elevation,me=c.getProjection(),Ie=se?se.getAtTileOffsetFunc(ce,this.transform.center.lat,this.transform.worldSize,me):null,xe=new p.P(y.tileAnchorX,y.tileAnchorY);let{x:Be,y:ge,z:Me}=me.projectTilePoint(xe.x,xe.y,ce.canonical);if(Ie){const[St,Ze,gt]=Ie(xe);Be+=St,ge+=Ze,Me+=gt}const He="globe"===me.name,Ge=this.projectAndGetPerspectiveRatio(B,Be,ge,Me,ce,He||!!se||this.transform.pitch>0,me),{perspectiveRatio:nt}=Ge,dt=(q?I/nt:I*nt)/p.bc,ot=eh(Be,ge,Me,P),Pt=Ge.signedDistanceFromCamera>0?vp(dt,C,y.lineOffsetX*dt,y.lineOffsetY*dt,!1,ot,xe,y,w,P,{},se&&!q?Ie:null,q&&!!se,me,ce,q):null;let Rt=!1,cn=!1,ct=!0;if(Pt&&!Ge.occluded){const St=.5*te*nt+le,Ze=new p.P(-100,-100),gt=new p.P(this.screenRightBoundary,this.screenBottomBoundary),An=new vs,{first:Tn,last:Cn}=Pt,$n=Tn.path.length;let li=[];for(let ci=$n-1;ci>=1;ci--)li.push(Tn.path[ci]);for(let ci=1;ci<Cn.path.length;ci++)li.push(Cn.path[ci]);const xi=2.5*St;Q&&(li=li.map(([ci,gr,Ki],lr)=>(Ie&&!He&&(Ki=Ie(lr<$n-1?Tn.tilePath[$n-1-lr]:Cn.tilePath[lr-$n+2])[2]),eh(ci,gr,Ki,Q))),li.some(ci=>ci[3]<=0)&&(li=[]));let yi=[];if(li.length>0){let ci=1/0,gr=-1/0,Ki=1/0,lr=-1/0;for(const rr of li)ci=Math.min(ci,rr[0]),Ki=Math.min(Ki,rr[1]),gr=Math.max(gr,rr[0]),lr=Math.max(lr,rr[1]);gr>=Ze.x&&ci<=gt.x&&lr>=Ze.y&&Ki<=gt.y&&(yi=[li.map(rr=>new p.P(rr[0],rr[1]))],(ci<Ze.x||gr>gt.x||Ki<Ze.y||lr>gt.y)&&(yi=p.ba(yi,Ze.x,Ze.y,gt.x,gt.y)))}for(const ci of yi){An.reset(ci,.25*St);let gr=0;gr=An.length<=.5*St?1:Math.ceil(An.paddedLength/xi)+1;for(let Ki=0;Ki<gr;Ki++){const lr=Ki/Math.max(gr-1,1),rr=An.lerp(lr),kr=rr.x+ou,qs=rr.y+ou;Ae.push(kr,qs,St,0);const Fr=kr-St,Po=qs-St,Dr=kr+St,jr=qs+St;if(ct=ct&&this.isOffscreen(Fr,Po,Dr,jr),cn=cn||this.isInsideGrid(Fr,Po,Dr,jr),!d&&this.grid.hitTestCircle(kr,qs,St,J)&&(Rt=!0,!j))return{circles:[],offscreen:!1,collisionDetected:Rt,occluded:!1}}}}return{circles:!j&&Rt||!cn?[]:Ae,offscreen:ct,collisionDetected:Rt,occluded:Ge.occluded}}queryRenderedSymbols(c){if(0===c.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const d=[];let y=1/0,w=1/0,C=-1/0,I=-1/0;for(const j of c){const q=new p.P(j.x+ou,j.y+ou);y=Math.min(y,q.x),w=Math.min(w,q.y),C=Math.max(C,q.x),I=Math.max(I,q.y),d.push(q)}const B=this.grid.query(y,w,C,I).concat(this.ignoredGrid.query(y,w,C,I)),P={},Q={};for(const j of B){const q=j.key;if(void 0===P[q.bucketInstanceId]&&(P[q.bucketInstanceId]={}),P[q.bucketInstanceId][q.featureIndex])continue;const J=[new p.P(j.x1,j.y1),new p.P(j.x2,j.y1),new p.P(j.x2,j.y2),new p.P(j.x1,j.y2)];p.bb(d,J)&&(P[q.bucketInstanceId][q.featureIndex]=!0,void 0===Q[q.bucketInstanceId]&&(Q[q.bucketInstanceId]=[]),Q[q.bucketInstanceId].push(q.featureIndex))}return Q}insertCollisionBox(c,d,y,w,C){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:w,collisionGroupID:C},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,d,y,w,C){const I=d?this.ignoredGrid:this.grid,B={bucketInstanceId:y,featureIndex:w,collisionGroupID:C};for(let P=0;P<c.length;P+=4)I.insertCircle(B,c[P],c[P+1],c[P+2])}projectAndGetPerspectiveRatio(c,d,y,w,C,I,B){const P=[d,y,w,1];let Q=!1;w||this.transform.pitch>0?(p.a7.transformMat4(P,P,c),this.fogState&&C&&"globe"!==B.name&&(Q=function(J,te,le,ce,Ae,se){const me=se.calculateFogTileMatrix(Ae),Ie=[te,le,ce];return p.N.transformMat4(Ie,Ie,me),ls(J,p.N.length(Ie),se.pitch,se._fov)}(this.fogState,d,y,w,C.toUnwrapped(),this.transform)>.9)):B0(P,P,c);const j=P[3];return{point:new p.P((P[0]/j+1)/2*this.transform.width+ou,(-P[1]/j+1)/2*this.transform.height+ou),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(B)/j*.5,1.5),signedDistanceFromCamera:j,occluded:I&&P[2]>j||Q}}isOffscreen(c,d,y,w){return y<ou||c>=this.screenRightBoundary||w<ou||d>this.screenBottomBoundary}isInsideGrid(c,d,y,w){return y>=0&&c<this.gridRightBoundary&&w>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const c=p.a6.identity([]);return p.a6.translate(c,c,[-100,-100,0]),c}}function hd(_,c,d){const y=c.createTileMatrix(_,_.worldSize,d.toUnwrapped());return p.a6.multiply(new Float32Array(16),_.projMatrix,y)}function dd(_,c,d){if(c.projection.name===d.projection.name)return _.projMatrix;const y=d.clone();return y.setProjection(c.projection),hd(y,c.getProjection(),_)}function au(_,c,d){return c.name===d.projection.name?_.projMatrix:hd(d,c,_)}class Co{constructor(c,d,y,w){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?d:-d))):w&&y?1:0,this.placed=y}isHidden(){return 0===this.opacity&&!this.placed}}class $d{constructor(c,d,y,w,C,I=!1){this.text=new Co(c?c.text:null,d,y,C),this.icon=new Co(c?c.icon:null,d,w,C),this.clipped=I}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class lu{constructor(c,d,y,w=!1){this.text=c,this.icon=d,this.skipFade=y,this.clipped=w}}class wp{constructor(){this.invProjMatrix=p.a6.create(),this.viewportMatrix=p.a6.create(),this.circles=[]}}class Vl{constructor(c,d,y,w,C){this.bucketInstanceId=c,this.featureIndex=d,this.sourceLayerIndex=y,this.bucketIndex=w,this.tileID=C}}class cu{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const d=++this.maxGroupID;this.collisionGroups[c]={ID:d,predicate:y=>y.collisionGroupID===d}}return this.collisionGroups[c]}}function Nc(_,c,d,y,w){const{horizontalAlign:C,verticalAlign:I}=p.bf(_),B=-(C-.5)*c,P=-(I-.5)*d,Q=p.bd(_,y);return new p.P(B+Q[0]*w,P+Q[1]*w)}function kh(_,c,d,y,w){const C=new p.P(_,c);return d&&C._rotate(y?w:-w),C}class Xt{constructor(c,d,y,w,C,I){this.transform=c.clone(),this.projection=c.projection.name,this.collisionIndex=new Jn(this.transform,C),this.buildingIndex=I,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new cu(y),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,d,y,w){const C=y.getBucket(d),I=y.latestFeatureIndex;if(!C||!I||d.fqid!==C.layerIds[0])return;const B=C.layers[0].layout,P=y.collisionBoxArray,Q=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),j=y.tileSize/p.V,q=y.tileID.toUnwrapped();this.transform.setProjection(C.projection);const J=(te=y.tileID,le=C.getProjection(),ce=this.transform,le.name===this.projection?ce.calculateProjMatrix(te.toUnwrapped()):hd(ce,le,te));var te,le,ce;const Ae="map"===B.get("text-pitch-alignment"),se="map"===B.get("text-rotation-alignment");d.compileFilter();const me=d.dynamicFilter(),Ie=d.dynamicFilterNeedsFeature(),xe=this.transform.calculatePixelsToTileUnitsMatrix(y),Be=D0(J,y.tileID.canonical,Ae,se,this.transform,C.getProjection(),xe);let ge=null;if(Ae){const Ge=Uo(J,y.tileID.canonical,Ae,se,this.transform,C.getProjection(),xe);ge=p.a6.multiply([],this.transform.labelPlaneMatrix,Ge)}let Me=null;me&&y.latestFeatureIndex&&(Me={unwrappedTileID:q,dynamicFilter:me,dynamicFilterNeedsFeature:Ie,featureIndex:y.latestFeatureIndex}),this.retainedQueryData[C.bucketInstanceId]=new Vl(C.bucketInstanceId,I,C.sourceLayerIndex,C.index,y.tileID);const He={bucket:C,layout:B,posMatrix:J,textLabelPlaneMatrix:Be,labelToScreenMatrix:ge,clippingData:Me,scale:Q,textPixelRatio:j,holdingForFade:y.holdingForFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:p.b5(C.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:p.b5(C.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(w)for(const Ge of C.sortKeyRanges){const{sortKey:nt,symbolInstanceStart:dt,symbolInstanceEnd:ot}=Ge;c.push({sortKey:nt,symbolInstanceStart:dt,symbolInstanceEnd:ot,parameters:He})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:He})}attemptAnchorPlacement(c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce,Ae,se,me){const{textOffset0:Ie,textOffset1:xe,crossTileID:Be}=J,ge=[Ie,xe],Me=Nc(c,y,w,ge,C),He=this.collisionIndex.placeCollisionBox(le,C,d,kh(Me.x,Me.y,I,B,this.transform.angle),q,P,Q,j.predicate);if(Ae){const Ge=le.getSymbolInstanceIconSize(me,this.transform.zoom,J.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(le,Ge,Ae,kh(Me.x,Me.y,I,B,this.transform.angle),q,P,Q,j.predicate).box.length)return}if(He.box.length>0){let Ge;return this.prevPlacement&&this.prevPlacement.variableOffsets[Be]&&this.prevPlacement.placements[Be]&&this.prevPlacement.placements[Be].text&&(Ge=this.prevPlacement.variableOffsets[Be].anchor),this.variableOffsets[Be]={textOffset:ge,width:y,height:w,anchor:c,textScale:C,prevAnchor:Ge},this.markUsedJustification(le,c,J,ce),le.allowVerticalPlacement&&(this.markUsedOrientation(le,ce,J),this.placedOrientations[Be]=ce),{shift:Me,placedGlyphBoxes:He}}}placeLayerBucketPart(c,d,y,w){const{bucket:C,layout:I,posMatrix:B,textLabelPlaneMatrix:P,labelToScreenMatrix:Q,clippingData:j,textPixelRatio:q,holdingForFade:J,collisionBoxArray:te,partiallyEvaluatedTextSize:le,partiallyEvaluatedIconSize:ce,collisionGroup:Ae}=c.parameters,se=I.get("text-optional"),me=I.get("icon-optional"),Ie=I.get("text-allow-overlap"),xe=I.get("icon-allow-overlap"),Be="map"===I.get("text-rotation-alignment"),ge="map"===I.get("text-pitch-alignment"),Me="viewport-y"===I.get("symbol-z-order"),He=I.get("symbol-z-elevate");this.transform.setProjection(C.projection);let Ge=Ie&&(xe||!C.hasIconData()||me),nt=xe&&(Ie||!C.hasTextData()||se);!C.collisionArrays&&te&&C.deserializeCollisionBoxes(te),y&&w&&C.updateCollisionDebugBuffers(this.transform.zoom,te);const dt=(ot,Pt,Rt)=>{const{crossTileID:cn,numVerticalGlyphVertices:ct}=ot;if(j){const Dr={zoom:this.transform.zoom,pitch:this.transform.pitch};let jr=null;if(j.dynamicFilterNeedsFeature){const br=this.retainedQueryData[C.bucketInstanceId];jr=j.featureIndex.loadFeature({featureIndex:ot.featureIndex,bucketIndex:br.bucketIndex,sourceLayerIndex:br.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,j.dynamicFilter)(Dr,jr,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new p.P(ot.tileAnchorX,ot.tileAnchorY),this.transform.calculateDistanceTileData(j.unwrappedTileID)))return this.placements[cn]=new lu(!1,!1,!1,!0),void d.add(cn)}if(d.has(cn))return;if(J)return void(this.placements[cn]=new lu(!1,!1,!1));let St=!1,Ze=!1,gt=!0,An=!1,Tn=!1,Cn=null,$n={box:null,offscreen:null,occluded:null},li={box:null,offscreen:null,occluded:null},xi=null,yi=null,ci=null,gr=0,Ki=0,lr=0;Rt.textFeatureIndex?gr=Rt.textFeatureIndex:ot.useRuntimeCollisionCircles&&(gr=ot.featureIndex),Rt.verticalTextFeatureIndex&&(Ki=Rt.verticalTextFeatureIndex);const rr=Dr=>{Dr.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const jr=this.transform.elevation;Dr.elevation=ot.zOffset+(jr?jr.getAtTileOffset(Dr.tileID,Dr.tileAnchorX,Dr.tileAnchorY):0)},kr=Rt.textBox;if(kr){rr(kr);const Dr=br=>{let Xr=p.b6.horizontal;if(C.allowVerticalPlacement&&!br&&this.prevPlacement){const eo=this.prevPlacement.placedOrientations[cn];eo&&(this.placedOrientations[cn]=eo,Xr=eo,this.markUsedOrientation(C,Xr,ot))}return Xr},jr=(br,Xr)=>{if(C.allowVerticalPlacement&&ct>0&&Rt.verticalTextBox){for(const eo of C.writingModes)if(eo===p.b6.vertical?($n=Xr(),li=$n):$n=br(),$n&&$n.box&&$n.box.length)break}else $n=br()};if(I.get("text-variable-anchor")){let br=I.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[cn]){const zr=this.prevPlacement.variableOffsets[cn];br.indexOf(zr.anchor)>0&&(br=br.filter(za=>za!==zr.anchor),br.unshift(zr.anchor))}const Xr=(zr,za,gl)=>{const bc=C.getSymbolInstanceTextSize(le,ot,this.transform.zoom,Pt),jc=(zr.x2-zr.x1)*bc+2*zr.padding,Gc=(zr.y2-zr.y1)*bc+2*zr.padding,oo=ot.hasIconTextFit&&!xe?za:null;oo&&rr(oo);let fa={box:[],offscreen:!1,occluded:!1};const Ms=Ie?2*br.length:br.length;for(let ml=0;ml<Ms;++ml){const $c=this.attemptAnchorPlacement(br[ml%br.length],zr,jc,Gc,bc,Be,ge,q,B,Ae,ml>=br.length,ot,Pt,C,gl,oo,le,ce);if($c&&(fa=$c.placedGlyphBoxes,fa&&fa.box&&fa.box.length)){St=!0,Cn=$c.shift;break}}return fa};jr(()=>Xr(kr,Rt.iconBox,p.b6.horizontal),()=>{const zr=Rt.verticalTextBox;return zr&&rr(zr),C.allowVerticalPlacement&&!($n&&$n.box&&$n.box.length)&&ct>0&&zr?Xr(zr,Rt.verticalIconBox,p.b6.vertical):{box:null,offscreen:null,occluded:null}}),$n&&(St=$n.box,gt=$n.offscreen,An=$n.occluded);const eo=Dr(!(!$n||!$n.box));if(!St&&this.prevPlacement){const zr=this.prevPlacement.variableOffsets[cn];zr&&(this.variableOffsets[cn]=zr,this.markUsedJustification(C,zr.anchor,ot,eo))}}else{const br=(Xr,eo)=>{const zr=C.getSymbolInstanceTextSize(le,ot,this.transform.zoom,Pt),za=this.collisionIndex.placeCollisionBox(C,zr,Xr,new p.P(0,0),Ie,q,B,Ae.predicate);return za&&za.box&&za.box.length&&(this.markUsedOrientation(C,eo,ot),this.placedOrientations[cn]=eo),za};jr(()=>br(kr,p.b6.horizontal),()=>{const Xr=Rt.verticalTextBox;return C.allowVerticalPlacement&&ct>0&&Xr?(rr(Xr),br(Xr,p.b6.vertical)):{box:null,offscreen:null,occluded:null}}),Dr(!!($n&&$n.box&&$n.box.length))}}if(xi=$n,St=xi&&xi.box&&xi.box.length>0,gt=xi&&xi.offscreen,An=xi&&xi.occluded,ot.useRuntimeCollisionCircles){const Dr=C.text.placedSymbolArray.get(ot.centerJustifiedTextSymbolIndex>=0?ot.centerJustifiedTextSymbolIndex:ot.verticalPlacedTextSymbolIndex),jr=p.b7(C.textSizeData,le,Dr),br=I.get("text-padding");yi=this.collisionIndex.placeCollisionCircles(C,Ie,Dr,C.lineVertexArray,C.glyphOffsetArray,jr,B,P,Q,y,ge,Ae.predicate,ot.collisionCircleDiameter*jr/p.bc,br,this.retainedQueryData[C.bucketInstanceId].tileID),St=Ie||yi.circles.length>0&&!yi.collisionDetected,gt=gt&&yi.offscreen,An=yi.occluded}if(Rt.iconFeatureIndex&&(lr=Rt.iconFeatureIndex),Rt.iconBox){const Dr=jr=>{rr(jr);const br=ot.hasIconTextFit&&Cn?kh(Cn.x,Cn.y,Be,ge,this.transform.angle):new p.P(0,0),Xr=C.getSymbolInstanceIconSize(ce,this.transform.zoom,ot.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,Xr,jr,br,xe,q,B,Ae.predicate)};li&&li.box&&li.box.length&&Rt.verticalIconBox?(ci=Dr(Rt.verticalIconBox),Ze=ci.box.length>0):(ci=Dr(Rt.iconBox),Ze=ci.box.length>0),gt=gt&&ci.offscreen,Tn=ci.occluded}const qs=se||0===ot.numHorizontalGlyphVertices&&0===ct,Fr=me||0===ot.numIconVertices;if(qs||Fr?Fr?qs||(Ze=Ze&&St):St=Ze&&St:Ze=St=Ze&&St,St&&xi&&xi.box&&this.collisionIndex.insertCollisionBox(xi.box,I.get("text-ignore-placement"),C.bucketInstanceId,li&&li.box&&Ki?Ki:gr,Ae.ID),Ze&&ci&&this.collisionIndex.insertCollisionBox(ci.box,I.get("icon-ignore-placement"),C.bucketInstanceId,lr,Ae.ID),yi&&(St&&this.collisionIndex.insertCollisionCircles(yi.circles,I.get("text-ignore-placement"),C.bucketInstanceId,gr,Ae.ID),y)){const Dr=C.bucketInstanceId;let jr=this.collisionCircleArrays[Dr];void 0===jr&&(jr=this.collisionCircleArrays[Dr]=new wp);for(let br=0;br<yi.circles.length;br+=4)jr.circles.push(yi.circles[br+0]),jr.circles.push(yi.circles[br+1]),jr.circles.push(yi.circles[br+2]),jr.circles.push(yi.collisionDetected?1:0)}const Po="globe"!==C.projection.name;Ge=Ge&&(Po||!An),nt=nt&&(Po||!Tn),this.placements[cn]=new lu(St||Ge,Ze||nt,gt||C.justReloaded),d.add(cn)};if(He&&this.buildingIndex&&(this.buildingIndex.updateZOffset(C,this.retainedQueryData[C.bucketInstanceId].tileID),C.updateZOffset()),Me){const ot=C.getSortedSymbolIndexes(this.transform.angle);for(let Pt=ot.length-1;Pt>=0;--Pt){const Rt=ot[Pt];dt(C.symbolInstances.get(Rt),Rt,C.collisionArrays[Rt])}C.hasAnyZOffset&&p.w(`${C.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(C.hasAnyZOffset){const ot=C.getSortedIndexesByZOffset();for(let Pt=0;Pt<ot.length;++Pt){const Rt=ot[Pt];dt(C.symbolInstances.get(Rt),Rt,C.collisionArrays[Rt])}}else for(let ot=c.symbolInstanceStart;ot<c.symbolInstanceEnd;ot++)dt(C.symbolInstances.get(ot),ot,C.collisionArrays[ot]);if(y&&C.bucketInstanceId in this.collisionCircleArrays){const ot=this.collisionCircleArrays[C.bucketInstanceId];p.a6.invert(ot.invProjMatrix,B),ot.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(c,d,y,w){const{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:B,verticalPlacedTextSymbolIndex:P,crossTileID:Q}=y,j=p.be(d),q=w===p.b6.vertical?P:"left"===j?C:"center"===j?I:"right"===j?B:-1;C>=0&&(c.text.placedSymbolArray.get(C).crossTileID=q>=0&&C!==q?0:Q),I>=0&&(c.text.placedSymbolArray.get(I).crossTileID=q>=0&&I!==q?0:Q),B>=0&&(c.text.placedSymbolArray.get(B).crossTileID=q>=0&&B!==q?0:Q),P>=0&&(c.text.placedSymbolArray.get(P).crossTileID=q>=0&&P!==q?0:Q)}markUsedOrientation(c,d,y){const w=d===p.b6.horizontal||d===p.b6.horizontalOnly?d:0,C=d===p.b6.vertical?d:0,{leftJustifiedTextSymbolIndex:I,centerJustifiedTextSymbolIndex:B,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:Q}=y,j=c.text.placedSymbolArray;I>=0&&(j.get(I).placedOrientation=w),B>=0&&(j.get(B).placedOrientation=w),P>=0&&(j.get(P).placedOrientation=w),Q>=0&&(j.get(Q).placedOrientation=C)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let y=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const w=d?d.symbolFadeChange(c):1,C=d?d.opacities:{},I=d?d.variableOffsets:{},B=d?d.placedOrientations:{};for(const P in this.placements){const Q=this.placements[P],j=C[P];j?(this.opacities[P]=new $d(j,w,Q.text,Q.icon,null,Q.clipped),y=y||Q.text!==j.text.placed||Q.icon!==j.icon.placed):(this.opacities[P]=new $d(null,w,Q.text,Q.icon,Q.skipFade,Q.clipped),y=y||Q.text||Q.icon)}for(const P in C){const Q=C[P];if(!this.opacities[P]){const j=new $d(Q,w,!1,!1);j.isHidden()||(this.opacities[P]=j,y=y||Q.text.placed||Q.icon.placed)}}for(const P in I)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=I[P]);for(const P in B)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=B[P]);y?this.lastPlacementChangeTime=c:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:c)}updateLayerOpacities(c,d){const y=new Set;for(const w of d){const C=w.getBucket(c);C&&w.latestFeatureIndex&&c.fqid===C.layerIds[0]&&(this.updateBucketOpacities(C,y,w.collisionBoxArray),C.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(C,w.tileID),C.updateZOffset()))}}updateBucketOpacities(c,d,y){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const w=c.layers[0].layout,C=!!c.layers[0].dynamicFilter(),I=new $d(null,0,!1,!1,!0),B=w.get("text-allow-overlap"),P=w.get("icon-allow-overlap"),Q=w.get("text-variable-anchor"),j="map"===w.get("text-rotation-alignment"),q="map"===w.get("text-pitch-alignment"),J=new $d(null,0,B&&(P||!c.hasIconData()||w.get("icon-optional")),P&&(B||!c.hasTextData()||w.get("text-optional")),!0);!c.collisionArrays&&y&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(y);const te=(ce,Ae,se)=>{for(let me=0;me<Ae/4;me++)ce.opacityVertexArray.emplaceBack(se)};let le=0;for(let ce=0;ce<c.symbolInstances.length;ce++){const Ae=c.symbolInstances.get(ce),{numHorizontalGlyphVertices:se,numVerticalGlyphVertices:me,crossTileID:Ie,numIconVertices:xe}=Ae,Be=d.has(Ie);let ge=this.opacities[Ie];Be?ge=I:ge||(ge=J,this.opacities[Ie]=ge),d.add(Ie);const Me=se>0||me>0,He=xe>0,Ge=this.placedOrientations[Ie],nt=Ge===p.b6.vertical,dt=Ge===p.b6.horizontal||Ge===p.b6.horizontalOnly;if(!Me&&!He||ge.isHidden()||le++,Me){const ot=ih(ge.text);te(c.text,se,nt?fd:ot),te(c.text,me,dt?fd:ot);const Pt=ge.text.isHidden(),{leftJustifiedTextSymbolIndex:Rt,centerJustifiedTextSymbolIndex:cn,rightJustifiedTextSymbolIndex:ct,verticalPlacedTextSymbolIndex:St}=Ae,Ze=c.text.placedSymbolArray,gt=Pt||nt?1:0;Rt>=0&&(Ze.get(Rt).hidden=gt),cn>=0&&(Ze.get(cn).hidden=gt),ct>=0&&(Ze.get(ct).hidden=gt),St>=0&&(Ze.get(St).hidden=Pt||dt?1:0);const An=this.variableOffsets[Ie];An&&this.markUsedJustification(c,An.anchor,Ae,Ge);const Tn=this.placedOrientations[Ie];Tn&&(this.markUsedJustification(c,"left",Ae,Tn),this.markUsedOrientation(c,Tn,Ae))}if(He){const ot=ih(ge.icon),{placedIconSymbolIndex:Pt,verticalPlacedIconSymbolIndex:Rt}=Ae,cn=c.icon.placedSymbolArray,ct=ge.icon.isHidden()?1:0;Pt>=0&&(te(c.icon,xe,nt?fd:ot),cn.get(Pt).hidden=ct),Rt>=0&&(te(c.icon,Ae.numVerticalIconVertices,dt?fd:ot),cn.get(Rt).hidden=ct)}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const ot=c.collisionArrays[ce];if(ot){let Pt=new p.P(0,0),Rt=!0;if(ot.textBox||ot.verticalTextBox){if(Q){const ct=this.variableOffsets[Ie];ct?(Pt=Nc(ct.anchor,ct.width,ct.height,ct.textOffset,ct.textScale),j&&Pt._rotate(q?this.transform.angle:-this.transform.angle)):Rt=!1}C&&(Rt=!ge.clipped),ot.textBox&&qd(c.textCollisionBox.collisionVertexArray,ge.text.placed,!Rt||nt,Pt.x,Pt.y),ot.verticalTextBox&&qd(c.textCollisionBox.collisionVertexArray,ge.text.placed,!Rt||dt,Pt.x,Pt.y)}const cn=Rt&&!(dt||!ot.verticalIconBox);ot.iconBox&&qd(c.iconCollisionBox.collisionVertexArray,ge.icon.placed,cn,Ae.hasIconTextFit?Pt.x:0,Ae.hasIconTextFit?Pt.y:0),ot.verticalIconBox&&qd(c.iconCollisionBox.collisionVertexArray,ge.icon.placed,!cn,Ae.hasIconTextFit?Pt.x:0,Ae.hasIconTextFit?Pt.y:0)}}}if(c.fullyClipped=0===le,c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const ce=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=ce.invProjMatrix,c.placementViewportMatrix=ce.viewportMatrix,c.collisionCircleArray=ce.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return 0===this.fadeDuration?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,d){const y=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*y>c}setStale(){this.stale=!0}}function qd(_,c,d,y,w){_.emplaceBack(c?1:0,d?1:0,y||0,w||0),_.emplaceBack(c?1:0,d?1:0,y||0,w||0),_.emplaceBack(c?1:0,d?1:0,y||0,w||0),_.emplaceBack(c?1:0,d?1:0,y||0,w||0)}const In=Math.pow(2,25),Nf=Math.pow(2,24),th=Math.pow(2,17),nh=Math.pow(2,16),ea=Math.pow(2,9),M0=Math.pow(2,8),F0=Math.pow(2,1);function ih(_){if(0===_.opacity&&!_.placed)return 0;if(1===_.opacity&&_.placed)return 4294967295;const c=_.placed?1:0,d=Math.floor(127*_.opacity);return d*In+c*Nf+d*th+c*nh+d*ea+c*M0+d*F0+c}const fd=0;class Ac{constructor(c){this._sortAcrossTiles="viewport-y"!==c.layout.get("symbol-z-order")&&void 0!==c.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(c,d,y,w,C){const I=this._bucketParts;for(;this._currentTileIndex<c.length;)if(d.getBucketParts(I,w,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort((B,P)=>B.sortKey-P.sortKey));this._currentPartIndex<I.length;){const B=I[this._currentPartIndex];if(d.placeLayerBucketPart(B,this._seenCrossTileIDs,y,0===B.symbolInstanceStart),this._currentPartIndex++,C())return!0}return!1}}class Lc{constructor(c,d,y,w,C,I,B,P,Q){this.placement=new Xt(c,C,I,B,P,Q),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(c,d,y,w){const C=p.f.now(),I=()=>{const B=p.f.now()-C;return!this._forceFullPlacement&&B>2};for(;this._currentPlacementIndex>=0;){const B=d[c[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if("symbol"===B.type&&(!B.minzoom||B.minzoom<=P)&&(!B.maxzoom||B.maxzoom>P)){const Q=B,j=Q.layout.get("symbol-z-elevate"),q=this._inProgressLayer=this._inProgressLayer||new Ac(Q),J=p.ag(B.source,B.scope);if(q.continuePlacement(j?w[J]:y[J],this.placement,this._showCollisionBoxes,B,I))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const Ys=512/p.V/2;class ic{constructor(c,d,y){this.tileID=c,this.bucketInstanceId=y,this.index=new p.bg(d.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=c.canonical.x*p.V,C=c.canonical.y*p.V;for(let I=0;I<d.length;I++){const{key:B,crossTileID:P,tileAnchorX:Q,tileAnchorY:j}=d.get(I),q=Math.floor((w+Q)*Ys),J=Math.floor((C+j)*Ys);this.index.add(q,J),this.keys.push(B),this.crossTileIDs.push(P)}this.index.finish()}findMatches(c,d,y){const w=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),C=Ys/Math.pow(2,d.canonical.z-this.tileID.canonical.z),I=d.canonical.x*p.V,B=d.canonical.y*p.V;for(let P=0;P<c.length;P++){const Q=c.get(P);if(Q.crossTileID)continue;const{key:j,tileAnchorX:q,tileAnchorY:J}=Q,te=Math.floor((I+q)*C),le=Math.floor((B+J)*C),ce=this.index.range(te-w,le-w,te+w,le+w);for(const Ae of ce){const se=this.crossTileIDs[Ae];if(this.keys[Ae]===j&&!y.has(se)){y.add(se),Q.crossTileID=se;break}}}}}class Bu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class uu{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const d=Math.round((c-this.lng)/360);if(0!==d)for(const y in this.indexes){const w=this.indexes[y],C={};for(const I in w){const B=w[I];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+d),C[B.tileID.key]=B}this.indexes[y]=C}this.lng=c}addBucket(c,d,y){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let C=0;C<d.symbolInstances.length;C++)d.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]=new Set);const w=this.usedCrossTileIDs[c.overscaledZ];for(const C in this.indexes){const I=this.indexes[C];if(Number(C)>c.overscaledZ)for(const B in I){const P=I[B];P.tileID.isChildOf(c)&&P.findMatches(d.symbolInstances,c,w)}else{const B=I[c.scaledTo(Number(C)).key];B&&B.findMatches(d.symbolInstances,c,w)}}for(let C=0;C<d.symbolInstances.length;C++){const I=d.symbolInstances.get(C);I.crossTileID||(I.crossTileID=y.generate(),w.add(I.crossTileID))}return void 0===this.indexes[c.overscaledZ]&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new ic(c,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(c,d){for(const y of d.crossTileIDs)this.usedCrossTileIDs[c].delete(y)}removeStaleBuckets(c){let d=!1;for(const y in this.indexes){const w=this.indexes[y];for(const C in w)c[w[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,w[C]),delete w[C],d=!0)}return d}}class Na{constructor(){this.layerIndexes={},this.crossTileIDs=new Bu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,d,y,w){let C=this.layerIndexes[c.fqid];void 0===C&&(C=this.layerIndexes[c.fqid]=new uu);let I=!1;const B={};"globe"!==w.name&&C.handleWrapJump(y);for(const P of d){const Q=P.getBucket(c);Q&&c.fqid===Q.layerIds[0]&&(Q.bucketInstanceId||(Q.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(P.tileID,Q,this.crossTileIDs)&&(I=!0),B[Q.bucketInstanceId]=!0)}return C.removeStaleBuckets(B)&&(I=!0),I}pruneUnusedLayers(c){const d={};c.forEach(y=>{d[y]=!0});for(const y in this.layerIndexes)d[y]||delete this.layerIndexes[y]}}class Ia{constructor(c=0,d=0,y=0,w=0){if(isNaN(c)||c<0||isNaN(d)||d<0||isNaN(y)||y<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=d,this.left=y,this.right=w}interpolate(c,d,y){return null!=d.top&&null!=c.top&&(this.top=p.U(c.top,d.top,y)),null!=d.bottom&&null!=c.bottom&&(this.bottom=p.U(c.bottom,d.bottom,y)),null!=d.left&&null!=c.left&&(this.left=p.U(c.left,d.left,y)),null!=d.right&&null!=c.right&&(this.right=p.U(c.right,d.right,y)),this}getCenter(c,d){const y=p.aa((this.left+c-this.right)/2,0,c),w=p.aa((this.top+d-this.bottom)/2,0,d);return new p.P(y,w)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Ia(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ad(_,c){const d=p.bk(_,3);p.a6.fromQuat(_,c),p.bm(_,3,d)}function Lf(_,c){const d=p.bi.identity([]);return p.bi.rotateZ(d,d,-c),p.bi.rotateX(d,d,-_),d}function MA(_,c){const d=[_[0],_[1],0],y=[c[0],c[1],0];if(p.N.length(d)>=1e-15){const I=p.N.normalize([],d);p.N.scale(y,I,p.N.dot(y,I)),c[0]=y[0],c[1]=y[1]}const w=p.N.cross([],c,_);if(p.N.len(w)<1e-15)return null;const C=Math.atan2(-w[1],w[0]);return Lf(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),C)}class Kd{constructor(c,d){this.position=c,this.orientation=d}get position(){return this._position}set position(c){if(c){const d=c instanceof p.L?c:new p.L(c[0],c[1],c[2]);this._renderWorldCopies&&(d.x=p.bh(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(c,d){if(this.orientation=null,!this.position)return;const y=this.position,w=this._elevation?this._elevation.getAtPointOrZero(p.L.fromLngLat(c)):0,C=p.L.fromLngLat(c,w),I=[C.x-y.x,C.y-y.y,C.z-y.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=MA(I,d)}setPitchBearing(c,d){this.orientation=Lf(p.bj(c),p.bj(-d))}}class Uf{constructor(c,d){this._transform=p.a6.identity([]),this.orientation=d,this.position=c}get mercatorPosition(){const c=this.position;return new p.L(c[0],c[1],c[2])}get position(){const c=p.bk(this._transform,3);return[c[0],c[1],c[2]]}set position(c){var d;c&&p.bm(this._transform,3,[(d=c)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(c){this._orientation=c||p.bi.identity([]),c&&Ad(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,d){this._orientation=Lf(c,d),Ad(this._transform,this._orientation)}forward(){const c=p.bk(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=p.bk(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=p.bk(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,d){const y=new Float64Array(16);return p.a6.invert(y,this.getWorldToCamera(c,d)),y}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(c,d,y){const w=this.position;p.N.scale(w,w,-c);const C=new Float64Array(16);return p.a6.fromScaling(C,[y,y,y]),p.a6.translate(C,C,w),C[10]*=d,C}getWorldToCamera(c,d){const y=new Float64Array(16),w=new Float64Array(4),C=this.position;return p.bi.conjugate(w,this._orientation),p.N.scale(C,C,-c),p.a6.fromQuat(y,w),p.a6.translate(y,y,C),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=d,y[9]*=d,y[10]*=d,y[11]*=d,y}getCameraToClipPerspective(c,d,y,w){const C=new Float64Array(16);return p.a6.perspective(C,c,d,y,w),C}getCameraToClipOrthographic(c,d,y,w,C,I){const B=new Float64Array(16);return p.a6.ortho(B,c,d,y,w,C,I),B}getDistanceToElevation(c,d=!1){const y=0===c?0:p.bl(c,d?p.au(this.position[1]):this.position[1]),w=this.forward();return(y-this.position[2])/w[2]}clone(){return new Uf([...this.position],[...this.orientation])}}const rh=(_,c,d)=>(1-d)*_+d*c,Hl=_=>_*_*_*_*_;class FA{constructor(c,d,y,w,C,I,B){this.tileSize=512,this._renderWorldCopies=void 0===C||C,this._minZoom=c||0,this._maxZoom=d||22,this._minPitch=y??0,this._maxPitch=w??60,this.setProjection(I),this.setMaxBounds(B),this.width=0,this.height=0,this._center=new p.bn(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ia,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Uf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const c=new FA(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,c.tileSize=this.tileSize,c.mercatorFromTransition=this.mercatorFromTransition,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._seaLevelZoom=this._seaLevelZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._nearZ=this._nearZ,c._farZ=this._farZ,c._averageElevation=this._averageElevation,c._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c.frustumCorners=this.frustumCorners,c}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(c,d=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||y)&&this._updateCameraOnTerrain(),(c||y)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return p.ac(this.projection,["name","center","parallels"])}setProjection(c){this.projectionOptions=c||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=p.bo(this.projectionOptions);const y=!Ai(d,this.getProjection());return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setOrthographicProjectionAtLowPitch(c){return this._orthographicProjectionAtLowPitch!==c&&(this._orthographicProjectionAtLowPitch=c,this._calcMatrices(),!0)}setMercatorFromTransition(){const c=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=p.bo({name:"mercator"});const d=c!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(c){void 0===c?c=!0:null===c&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return p.bl(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new p.P(this.width,this.height)}get bearing(){return p.bh(this.rotation,-180,180)}set bearing(c){this.rotation=c}get rotation(){return-this.angle/Math.PI*180}set rotation(c){const d=-c*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=p.b4.create(),p.b4.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const d=p.aa(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const c=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/c)}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=p.bj(c),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(c){const d=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(c){this._tileCoverLift!==c&&(this._tileCoverLift=c)}_updateCameraOnTerrain(){const c=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,d=this.elevation&&c===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||c===Number.NEGATIVE_INFINITY&&(!d||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const y=this._elevation;d||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&y.exaggeration()&&this._centerAltitudeValidForExaggeration!==y.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*y.exaggeration(),this._centerAltitudeValidForExaggeration=y.exaggeration()):(this._centerAltitude=c||0,this._centerAltitudeValidForExaggeration=y.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let w=0,C=0;for(let I=0;I<d.length;I++){const B=new p.P(d[I][0]*this.width,y+d[I][1]*(this.height-y)),P=c.pointCoordinate(B);if(!P)continue;const Q=1/Math.hypot(P[0]-this._camera.position[0],P[1]-this._camera.position[1]);w+=P[3]*Q,C+=Q}return 0===C?NaN:w/C}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const c=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*d,w=this._mercatorZfromZoom(c),C=this._mercatorZfromZoom(this._maxZoom),I=Math.max(w-y,C);this._setZoom(this._zoomFromMercatorZ(I))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let y;y=c.z<this._camera.position[2]?[d.x,d.y,d.z]:[c.x,c.y,c.z];const w=p.N.length(p.N.sub([],this._camera.position,y));return p.aa(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let d=!1;if(c.orientation&&!p.bi.exactEquals(c.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(c.orientation)),c.position){const y=[c.position.x,c.position.y,c.position.z];p.N.exactEquals(y,this._camera.position)||(this._setCameraPosition(y),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,d=new Kd;return d.position=new p.L(c[0],c[1],c[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(c){if(!p.bi.length(c))return!1;p.bi.normalize(c,c);const d=p.N.transformQuat([],[0,0,-1],c),y=p.N.transformQuat([],[0,-1,0],c);if(y[2]<0)return!1;const w=MA(d,y);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(c){const d=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;c[2]=p.aa(c[2],w/y,w/d),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,d,y){this._unmodified=!1,this._edgeInsets.interpolate(c,d,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const d=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(c){const d=[new p.bp(0,c)];if(this.renderWorldCopies){const y=this.pointCoordinate(new p.P(0,0)),w=this.pointCoordinate(new p.P(this.width,0)),C=this.pointCoordinate(new p.P(this.width,this.height)),I=this.pointCoordinate(new p.P(0,this.height)),B=Math.floor(Math.min(y.x,w.x,C.x,I.x)),P=Math.floor(Math.max(y.x,w.x,C.x,I.x)),Q=1;for(let j=B-Q;j<=P+Q;j++)0!==j&&d.push(new p.bp(j,c))}return d}isLODDisabled(c){return(!c||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(c,d,y){let w=[];if(0===d[0]&&0===d[1])return w;for(const I of c){const B=I.canonical,P=I.overscaledZ,Q=I.wrap,j=1<<B.z,q=B.x+1<j,J=B.x>0,te=B.y+1<j,le=B.y>0,ce=I.wrap-(J?0:1),Ae=I.wrap+(q?0:1),se=J?B.x-1:j-1,me=q?B.x+1:0;d[0]<0?(w.push(new p.am(P,Ae,B.z,me,B.y)),d[1]<0&&te&&(w.push(new p.am(P,Q,B.z,B.x,B.y+1)),w.push(new p.am(P,Ae,B.z,me,B.y+1))),d[1]>0&&le&&(w.push(new p.am(P,Q,B.z,B.x,B.y-1)),w.push(new p.am(P,Ae,B.z,me,B.y-1)))):d[0]>0?(w.push(new p.am(P,ce,B.z,se,B.y)),d[1]<0&&te&&(w.push(new p.am(P,Q,B.z,B.x,B.y+1)),w.push(new p.am(P,ce,B.z,se,B.y+1))),d[1]>0&&le&&(w.push(new p.am(P,Q,B.z,B.x,B.y-1)),w.push(new p.am(P,ce,B.z,se,B.y-1)))):d[1]<0&&te?w.push(new p.am(P,Q,B.z,B.x,B.y+1)):le&&w.push(new p.am(P,Q,B.z,B.x,B.y-1))}if(w.length>1){w.sort((P,Q)=>P.overscaledZ-Q.overscaledZ||P.wrap-Q.wrap||P.canonical.z-Q.canonical.z||P.canonical.x-Q.canonical.x||P.canonical.y-Q.canonical.y);let I=0,B=0;for(;B<w.length;)w[B].equals(w[I])?++B:w[++I]=w[B++];w.length=I+1}const C=[];for(const I of w)w.some(B=>I.isChildOf(B))||C.push(I);return w=C.filter(I=>!c.some(B=>!!(I.overscaledZ<y&&B.isChildOf(I))||I.equals(B)||I.isChildOf(B))),w}coveringTiles(c){let d=this.coveringZoomLevel(c);const y=d,w=this.elevation&&this.elevation.exaggeration(),C=w&&!c.isTerrainDEM,I="mercator"===this.projection.name;if(void 0!==c.minzoom&&d<c.minzoom)return[];void 0!==c.maxzoom&&d>c.maxzoom&&(d=c.maxzoom);const B=this.locationCoordinate(this.center),P=this.center.lat,Q=1<<d,j=[Q*B.x,Q*B.y,0],q="globe"===this.projection.name,J=!q,te=p.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,J),le=q?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ce=Q*p.bl(1,this.center.lat),Ae=this._camera.position[2]/p.bl(1,this.center.lat),se=[Q*le.x,Q*le.y,Ae*(J?1:ce)],me=q||w,Ie=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),xe=this.isLODDisabled(!0)?d:0;let Be;if(this._elevation&&c.isTerrainDEM)Be=1e4*this._elevation.exaggeration();else if(this._elevation){const Ze=this._elevation.getMinMaxForVisibleTiles();Be=Ze?Ze.max:this._centerAltitude}else Be=this._centerAltitude;const ge=c.isTerrainDEM?-Be:this._elevation?this._elevation.getMinElevationBelowMSL():0,Me=this.projection.isReprojectedInTileSpace?p.br(this):1,He=Ze=>{const An=new p.L(Ze.x+25e-6,Ze.y,Ze.z),Tn=new p.L(Ze.x,Ze.y+25e-6,Ze.z),Cn=Ze.toLngLat(),$n=An.toLngLat(),li=Tn.toLngLat(),xi=this.locationCoordinate(Cn),yi=this.locationCoordinate($n),ci=this.locationCoordinate(li),gr=Math.hypot(yi.x-xi.x,yi.y-xi.y),Ki=Math.hypot(ci.x-xi.x,ci.y-xi.y);return Math.sqrt(gr*Ki)*Me/25e-6},Ge=Ze=>{const gt=Be,An=ge;return{aabb:p.bu(this,Q,0,0,0,Ze,An,gt,this.projection),zoom:0,x:0,y:0,minZ:An,maxZ:gt,wrap:Ze,fullyVisible:!1}},nt=[];let dt=[];const ot=d,Pt=c.reparseOverscaled?y:d,Rt=Ze=>Ze*Ze,cn=Rt((Ae-this._centerAltitude)*ce),ct=Ze=>{if(!this._elevation||!Ze.tileID||!I)return;const gt=this._elevation.getMinMaxForTile(Ze.tileID),An=Ze.aabb;gt?(An.min[2]=gt.min,An.max[2]=gt.max,An.center[2]=(An.min[2]+An.max[2])/2):(Ze.shouldSplit=St(Ze),Ze.shouldSplit||(An.min[2]=An.max[2]=An.center[2]=this._centerAltitude))},St=Ze=>{if(Ze.zoom<xe)return!0;if(Ze.zoom===ot)return!1;if(null!=Ze.shouldSplit)return Ze.shouldSplit;const gt=Ze.aabb.distanceX(se),An=Ze.aabb.distanceY(se);let Tn=cn,Cn=1;if(q){Tn=Rt(Ze.aabb.distanceZ(se));const xi=Math.pow(2,Ze.zoom),yi=p.au((Ze.y+1)/xi),ci=p.au(Ze.y/xi),gr=Math.min(Math.max(P,yi),ci),Ki=p.bJ(gr)/p.bJ(P);if(Cn=gr===P?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ki/this._mercatorScaleRatio),this.zoom<=p.bG&&Ze.zoom===ot-1&&Ki>=.9)return!0}else if(C&&(Tn=Rt(Ze.aabb.distanceZ(se)*ce)),this.projection.isReprojectedInTileSpace&&y<=5){const xi=Math.pow(2,Ze.zoom),yi=He(new p.L((Ze.x+.5)/xi,(Ze.y+.5)/xi));Cn=yi>.85?1:yi}const $n=gt*gt+An*An+Tn;return $n<Rt((1<<ot-Ze.zoom)*Ie*Cn*((xi,yi)=>{if(yi*Rt(.707)<xi)return 1;const ci=Math.sqrt(yi/xi);return ci/(1.4144271570014144+(Math.pow(1.1,ci-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Tn,cn),$n))};if(this.renderWorldCopies)for(let Ze=1;Ze<=3;Ze++)nt.push(Ge(-Ze)),nt.push(Ge(Ze));for(nt.push(Ge(0));nt.length>0;){const Ze=nt.pop(),gt=Ze.x,An=Ze.y;let Tn=Ze.fullyVisible;const Cn=()=>"globe"===this.projection.name&&(0===Ze.y||Ze.y===(1<<Ze.zoom)-1);if(!Tn){let $n=me?Ze.aabb.intersects(te):Ze.aabb.intersectsFlat(te);if(0===$n&&Cn()){const li=new p.bs(Ze.zoom,gt,An);$n=p.bt(this,Q,li,!0).intersects(te)}if(0===$n)continue;Tn=2===$n}if(Ze.zoom!==ot&&St(Ze))for(let $n=0;$n<4;$n++){const li=(gt<<1)+$n%2,xi=(An<<1)+($n>>1),yi={aabb:I?Ze.aabb.quadrant($n):p.bu(this,Q,Ze.zoom+1,li,xi,Ze.wrap,Ze.minZ,Ze.maxZ,this.projection),zoom:Ze.zoom+1,x:li,y:xi,wrap:Ze.wrap,fullyVisible:Tn,tileID:void 0,shouldSplit:void 0,minZ:Ze.minZ,maxZ:Ze.maxZ};C&&!q&&(yi.tileID=new p.am(Ze.zoom+1===ot?Pt:Ze.zoom+1,Ze.wrap,Ze.zoom+1,li,xi),ct(yi)),nt.push(yi)}else{const $n=Ze.zoom===ot?Pt:Ze.zoom;if(c.minzoom&&c.minzoom>$n)continue;if(!Tn){let ci=me?Ze.aabb.intersectsPrecise(te):Ze.aabb.intersectsPreciseFlat(te);if(0===ci&&Cn()){const gr=new p.bs(Ze.zoom,gt,An);ci=p.bt(this,Q,gr,!0).intersectsPrecise(te)}if(0===ci)continue}const li=j[0]-(.5+gt+(Ze.wrap<<Ze.zoom))*(1<<d-Ze.zoom),xi=j[1]-.5-An,yi=Ze.tileID?Ze.tileID:new p.am($n,Ze.wrap,Ze.zoom,gt,An);dt.push({tileID:yi,distanceSq:li*li+xi*xi})}}if(this.fogCullDistSq){const Ze=this.fogCullDistSq,gt=this.horizonLineFromTop();dt=dt.filter(An=>{const Tn=[0,0,0,1],Cn=[p.V,p.V,0,1],$n=this.calculateFogTileMatrix(An.tileID.toUnwrapped());p.a7.transformMat4(Tn,Tn,$n),p.a7.transformMat4(Cn,Cn,$n);const li=p.a7.min([],Tn,Cn),xi=p.a7.max([],Tn,Cn),yi=p.bv(li,xi);if(0===yi)return!0;let ci=!1;const gr=this._elevation;if(gr&&yi>Ze&&0!==gt){const Ki=this.calculateProjMatrix(An.tileID.toUnwrapped());let lr;c.isTerrainDEM||(lr=gr.getMinMaxForTile(An.tileID)),lr||(lr={min:ge,max:Be});const rr=p.bH(this.rotation),kr=[rr[0]*p.V,rr[1]*p.V,lr.max];p.N.transformMat4(kr,kr,Ki),ci=(1-kr[1])*this.height*.5<gt}return yi<Ze||ci})}return dt.sort((Ze,gt)=>Ze.distanceSq-gt.distanceSq).map(Ze=>Ze.tileID)}resize(c,d){this.width=c,this.height=d,this.pixelsToGLUnits=[2/c,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const d=p.aa(c.lat,-p.bw,p.bw),y=this.projection.project(c.lng,d);return new p.P(y.x*this.worldSize,y.y*this.worldSize)}unproject(c){return this.projection.unproject(c.x/this.worldSize,c.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/p.bl(1,this.center.lat)/this.worldSize}setLocationAtPoint(c,d){let y,w;const C=this.centerPoint;if("globe"===this.projection.name){const B=this.worldSize;y=(d.x-C.x)/B,w=(d.y-C.y)/B}else{const B=this.pointCoordinate(d),P=this.pointCoordinate(C);y=B.x-P.x,w=B.y-P.y}const I=this.locationCoordinate(c);this.setLocation(new p.L(I.x-y,I.y-w))}setLocation(c){this.center=this.coordinateLocation(c),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(c){return this.projection.locationPoint(this,c)}locationPoint3D(c){return this.projection.locationPoint(this,c,!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c){return this.coordinateLocation(this.pointCoordinate3D(c))}locationCoordinate(c,d){const y=d?p.bl(d,c.lat):void 0,w=this.projection.project(c.lng,c.lat);return new p.L(w.x,w.y,y)}coordinateLocation(c){return this.projection.unproject(c.x,c.y)}pointRayIntersection(c,d){const y=d??this._centerAltitude,w=[c.x,c.y,0,1],C=[c.x,c.y,1,1];p.a7.transformMat4(w,w,this.pixelMatrixInverse),p.a7.transformMat4(C,C,this.pixelMatrixInverse);const I=C[3];p.a7.scale(w,w,1/w[3]),p.a7.scale(C,C,1/I);const B=w[2],P=C[2];return{p0:w,p1:C,t:B===P?0:(y-B)/(P-B)}}screenPointToMercatorRay(c){const d=[c.x,c.y,0,1],y=[c.x,c.y,1,1];return p.a7.transformMat4(d,d,this.pixelMatrixInverse),p.a7.transformMat4(y,y,this.pixelMatrixInverse),p.a7.scale(d,d,1/d[3]),p.a7.scale(y,y,1/y[3]),d[2]=p.bl(d[2],this._center.lat)*this.worldSize,y[2]=p.bl(y[2],this._center.lat)*this.worldSize,p.a7.scale(d,d,1/this.worldSize),p.a7.scale(y,y,1/this.worldSize),new p.a2([d[0],d[1],d[2]],p.N.normalize([],p.N.sub([],y,d)))}rayIntersectionCoordinate(c){const{p0:d,p1:y,t:w}=c,C=p.bl(d[2],this._center.lat),I=p.bl(y[2],this._center.lat);return new p.L(p.U(d[0],y[0],w)/this.worldSize,p.U(d[1],y[1],w)/this.worldSize,p.U(C,I,w))}pointCoordinate(c,d=this._centerAltitude){return this.projection.pointCoordinate(this,c.x,c.y,d)}pointCoordinate3D(c){if(!this.elevation)return this.pointCoordinate(c);let d=this.projection.pointCoordinate3D(this,c.x,c.y);if(d)return new p.L(d[0],d[1],d[2]);let y=0,w=this.horizonLineFromTop();if(c.y>w)return this.pointCoordinate(c);const C=.02*w,I=c.clone();for(let B=0;B<10&&w-y>C;B++){I.y=p.U(y,w,.66);const P=this.projection.pointCoordinate3D(this,I.x,I.y);P?(w=I.y,d=P):y=I.y}return d?new p.L(d[0],d[1],d[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){return this.projection.isPointAboveHorizon(this,c)}isPointOnSurface(c){if(c.y<0||c.y>this.height||c.x<0||c.x>this.width)return!1;if(this.elevation||this.zoom>=p.bx)return!this.isPointAboveHorizon(c);const d=this.pointCoordinate(c);return d.y>=0&&d.y<=1}_coordinatePoint(c,d){const y=d&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,w=[c.x*this.worldSize,c.y*this.worldSize,y+c.toAltitude(),1];return p.a7.transformMat4(w,w,this.pixelMatrix),w[3]>0?new p.P(w[0]/w[3],w[1]/w[3]):new p.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:c,left:d}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,C=this.pointLocation3D(new p.P(d,c)),I=this.pointLocation3D(new p.P(w,c)),B=this.pointLocation3D(new p.P(w,y)),P=this.pointLocation3D(new p.P(d,y));let Q=Math.min(C.lng,I.lng,B.lng,P.lng),j=Math.max(C.lng,I.lng,B.lng,P.lng),q=Math.min(C.lat,I.lat,B.lat,P.lat),J=Math.max(C.lat,I.lat,B.lat,P.lat);const te=Math.pow(2,-this.zoom)/16*270,le="globe"===this.projection.name?1:4,ce=(Ae,se,me,Ie,xe)=>{const Be=(Ae+me)/2,ge=(se+Ie)/2,Me=new p.P(Be,ge),{lng:He,lat:Ge}=this.pointLocation3D(Me),nt=Math.max(0,Q-He,q-Ge,He-j,Ge-J);Q=Math.min(Q,He),j=Math.max(j,He),q=Math.min(q,Ge),J=Math.max(J,Ge),(xe<le||nt>te)&&(ce(Ae,se,Be,ge,xe+1),ce(Be,ge,me,Ie,xe+1))};if(ce(d,c,w,c,1),ce(w,c,w,y,1),ce(w,y,d,y,1),ce(d,y,d,c,1),"globe"===this.projection.name){const[Ae,se]=p.by(this);Ae?(J=90,j=180,Q=-180):se&&(q=-90,j=180,Q=-180)}return new p.ad(new p.bn(Q,q),new p.bn(j,J))}_getBoundsRectangular(c,d){const{top:y,left:w}=this._edgeInsets,C=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,B=new p.P(w,y),P=new p.P(I,y),Q=new p.P(I,C),j=new p.P(w,C);let q=this.pointCoordinate(B,c),J=this.pointCoordinate(P,c);const te=this.pointCoordinate(Q,d),le=this.pointCoordinate(j,d),ce=(Ae,se)=>(se.y-Ae.y)/(se.x-Ae.x);return q.y>1&&J.y>=0?q=new p.L((1-le.y)/ce(le,q)+le.x,1):q.y<0&&J.y<=1&&(q=new p.L(-le.y/ce(le,q)+le.x,0)),J.y>1&&q.y>=0?J=new p.L((1-te.y)/ce(te,J)+te.x,1):J.y<0&&q.y<=1&&(J=new p.L(-te.y/ce(te,J)+te.x,0)),(new p.ad).extend(this.coordinateLocation(q)).extend(this.coordinateLocation(J)).extend(this.coordinateLocation(le)).extend(this.coordinateLocation(te))}_getBoundsRectangularTerrain(){const c=this.elevation;if(!c.visibleDemTiles.length||c.isUsingMockSource())return this._getBoundsRectangular(0,0);const d=c.visibleDemTiles.reduce((y,w)=>{if(w.dem){const C=w.dem.tree;y.min=Math.min(y.min,C.minimums[0]),y.max=Math.max(y.max,C.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*c.exaggeration(),d.max*c.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(c=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,y=this.height/2-d*(1-this._horizonShift);return c?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(c){this.maxBounds=c,this.minLat=-p.bw,this.maxLat=p.bw,this.minLng=-180,this.maxLng=180,c&&(this.minLat=c.getSouth(),this.maxLat=c.getNorth(),this.minLng=c.getWest(),this.maxLng=c.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=p.a5(this.minLng)*this.tileSize,this.worldMaxX=p.a5(this.maxLng)*this.tileSize,this.worldMinY=p.ae(this.maxLat)*this.tileSize,this.worldMaxY=p.ae(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(c,d){return this.projection.createTileMatrix(this,d,c)}calculateDistanceTileData(c){const d=c.key,y=this._distanceTileDataCache;if(y[d])return y[d];const w=c.canonical,C=1/this.height,I=this.cameraWorldSize,B=I/this.zoomScale(w.z),P=(w.x+Math.pow(2,w.z)*c.wrap)*B,Q=w.y*B,j=this.point;j.x*=I/this.worldSize,j.y*=I/this.worldSize;const q=this.angle,J=Math.sin(-q),te=-Math.cos(-q);return y[d]={bearing:[J,te],center:[(j.x-P)*C,(j.y-Q)*C],scale:B/p.V*C},y[d]}calculateFogTileMatrix(c){const d=c.key,y=this._fogTileMatrixCache;if(y[d])return y[d];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,c);return p.a6.multiply(w,this.worldToFogMatrix,w),y[d]=new Float32Array(w),y[d]}calculateProjMatrix(c,d=!1,y=!1){const w=c.key;let C;if(C=y?this._expandedProjMatrixCache:d?this._alignedProjMatrixCache:this._projMatrixCache,C[w])return C[w];const I=this.calculatePosMatrix(c,this.worldSize);let B;return B=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:y?this.expandedFarZProjMatrix:d?this.alignedProjMatrix:this.projMatrix,p.a6.multiply(I,B,I),C[w]=new Float32Array(I),C[w]}calculatePixelsToTileUnitsMatrix(c){const d=c.tileID.key,y=this._pixelsToTileUnitsCache;if(y[d])return y[d];const w=p.bz(c,this);return y[d]=w,y[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const c=1/this.worldSize,d=p.a6.fromScaling([],[c,c,c]);return p.a6.multiply(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const c=this._elevation;this._updateCameraState();const d=p.bl(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(d),w=this._camera.forward(),C=p.bl(1,this._center.lat);y[2]/=C,w[2]/=C,p.N.normalize(w,w);const I=c.raycast(y,w,c.exaggeration());if(I){const B=p.N.scaleAndAdd([],y,w,I),P=new p.L(B[0],B[1],p.bl(B[2],p.au(B[1]))),Q=(P.z+p.N.length([P.x-y[0],P.y-y[1],P.z-y[2]*C]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(Q),this._centerAltitude=P.toAltitude(),this._center=this.coordinateLocation(P),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(c=!1){if(!this._elevation)return;const d=this._elevation,y=p.bl(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(y),C=d.getAtPointOrZero(new p.L(...w)),I=this.pixelsPerMeter/this.worldSize*C,B=this._minimumHeightOverTerrain(),P=w[2]-I;if(P<=B)if(P<0||c){const Q=this.locationCoordinate(this._center,this._centerAltitude),j=[w[0],w[1],Q.z-w[2]],q=p.N.length(j);j[2]-=(B-P)/this._pixelsPerMercatorPixel;const J=p.N.length(j);if(0===J)return;p.N.scale(j,j,q/J*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],Q.z*this._pixelsPerMercatorPixel-j[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||c){const J=this.center;return J.lat=p.aa(J.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!c)&&(J.lng=p.aa(J.lng,this.minLng,this.maxLng)),this.center=J,void(this._constraining=!1)}const d=this._unmodified,{x:y,y:w}=this.point;let C=0,I=y,B=w;const P=this.width/2,Q=this.height/2,j=this.worldMinY*this.scale,q=this.worldMaxY*this.scale;if(w-Q<j&&(B=j+Q),w+Q>q&&(B=q-Q),q-j<this.height&&(C=Math.max(C,this.height/(q-j)),B=(q+j)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const J=this.worldMinX*this.scale,te=this.worldMaxX*this.scale,le=this.worldSize/2-(J+te)/2;I=(y+le+this.worldSize)%this.worldSize-le,I-P<J&&(I=J+P),I+P>te&&(I=te-P),te-J<this.width&&(C=Math.max(C,this.width/(te-J)),I=(te+J)/2)}I===y&&B===w||(this.center=this.unproject(new p.P(I,B))),C&&(this.zoom+=this.scaleZoom(C)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let c=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(c=Math.max(c,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),c}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,d="globe"===this.projection.name,y=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=p.bl(1,this.center.lat)/p.bl(1,p.bI));const w=p.bA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,w),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const C="meters"===this.projection.zAxisUnit?y:1,I=this._camera.getWorldToCamera(this.worldSize,C);let B;const P=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(P[8]=2*-c.x/this.width,P[9]=2*c.y/this.height,this.isOrthographic){let Ge=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),nt=Ge*this.aspect,dt=-nt,ot=-Ge;nt-=c.x,dt-=c.x,Ge+=c.y,ot+=c.y,B=this._camera.getCameraToClipOrthographic(dt,nt,ot,Ge,this._nearZ,this._farZ),((Pt,Rt,cn,ct)=>{for(let St=0;St<16;St++)Pt[St]=rh(Rt[St],cn[St],ct)})(B,B,P,Hl(this.pitch>=15?1:this.pitch/15))}else B=P;const Q=p.a6.mul([],P,I);let j=p.a6.mul([],B,I);if(this.projection.isReprojectedInTileSpace){const Ge=this.locationCoordinate(this.center),nt=p.a6.identity([]);p.a6.translate(nt,nt,[Ge.x*this.worldSize,Ge.y*this.worldSize,0]),p.a6.multiply(nt,nt,p.bB(this)),p.a6.translate(nt,nt,[-Ge.x*this.worldSize,-Ge.y*this.worldSize,0]),p.a6.multiply(j,j,nt),p.a6.multiply(Q,Q,nt),this.inverseAdjustmentMatrix=p.bC(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=p.a6.scale([],j,[this.worldSize,this.worldSize,this.worldSize/C,1]),this.projMatrix=j,this.invProjMatrix=p.a6.invert(new Float64Array(16),this.projMatrix),d){const Ge=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ge[8]=2*-c.x/this.width,Ge[9]=2*c.y/this.height,this.expandedFarZProjMatrix=p.a6.mul([],Ge,I)}else this.expandedFarZProjMatrix=this.projMatrix;const q=p.a6.invert([],B);this.frustumCorners=p.bD.fromInvProjectionMatrix(q,this.horizonLineFromTop(),this.height),this.cameraFrustum=p.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!d);const J=new Float32Array(16);p.a6.identity(J),p.a6.scale(J,J,[1,-1,1]),p.a6.rotateX(J,J,this._pitch),p.a6.rotateZ(J,J,this.angle);const te=p.a6.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=p.a6.clone(te);const le=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;te[8]=2*-c.x/this.width,te[9]=2*(c.y+le)/this.height,this.skyboxMatrix=p.a6.multiply(J,te,J);const ce=this.point,Ae=ce.x,se=ce.y,me=this.width%2/2,Ie=this.height%2/2,xe=Math.cos(this.angle),Be=Math.sin(this.angle),ge=Ae-Math.round(Ae)+xe*me+Be*Ie,Me=se-Math.round(se)+xe*Ie+Be*me,He=new Float64Array(j);if(p.a6.translate(He,He,[ge>.5?ge-1:ge,Me>.5?Me-1:Me,0]),this.alignedProjMatrix=He,j=p.a6.create(),p.a6.scale(j,j,[this.width/2,-this.height/2,1]),p.a6.translate(j,j,[1,-1,0]),this.labelPlaneMatrix=j,j=p.a6.create(),p.a6.scale(j,j,[1,-1,1]),p.a6.translate(j,j,[-1,-1,0]),p.a6.scale(j,j,[2/this.width,2/this.height,1]),this.glCoordMatrix=j,this.pixelMatrix=p.a6.multiply(new Float64Array(16),this.labelPlaneMatrix,Q),this._calcFogMatrices(),this._distanceTileDataCache={},j=p.a6.invert(new Float64Array(16),this.pixelMatrix),!j)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=j,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=p.bE(this);const Ge=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=p.N.transformMat4(Ge,Ge,I),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=j;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,y=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,C=[c,c,d];p.N.scale(C,C,w),p.N.scale(y,y,-1),p.N.multiply(y,y,C);const I=p.a6.create();p.a6.translate(I,I,y),p.a6.scale(I,I,C),this.mercatorFogMatrix=I,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,d,w)}_computeCameraPosition(c){const d=(c=c||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),w=this.point,C=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-c/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-y[0]*C,w.y/this.worldSize-y[1]*C,c/this.worldSize*this._centerAltitude-y[2]*C]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(c){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],w=c[2];let C=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(C=Math.min((d-y)/w,1)),this._camera.position=p.N.scaleAndAdd([],this._camera.position,c,C),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,d=this._camera.forward(),{pitch:y,bearing:w}=this._camera.getPitchBearing(),C=p.bl(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,I=this._mercatorZfromZoom(this._maxZoom)*Math.cos(p.bj(this._maxPitch)),B=Math.max((c[2]-C)/Math.cos(y),I),P=this._zoomFromMercatorZ(B);p.N.scaleAndAdd(c,c,d,B),this._pitch=p.aa(y,p.bj(this.minPitch),p.bj(this.maxPitch)),this.angle=p.bh(w,-Math.PI,Math.PI),this._setZoom(p.aa(P,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new p.L(c[0],c[1],c[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min(null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}zoomFromMercatorZAdjusted(c){let d=0,y=p.bx,w=0,C=1/0;for(;y-d>1e-6&&y>d;){const I=d+.5*(y-d),B=this.tileSize*Math.pow(2,I),P=this.getCameraToCenterDistance(this.projection,I,B),Q=this.scaleZoom(P/(c*this.tileSize)),j=Math.abs(I-Q);j<C&&(C=j,w=I),I<Q?d=I:y=I}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(p.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(c,d){const y=Math.min(c.x,d.x),w=Math.max(c.x,d.x),C=Math.min(c.y,d.y),I=Math.max(c.y,d.y);if(C<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const B=[new p.P(y,C),new p.P(w,I),new p.P(y,I),new p.P(w,C)],P=this.renderWorldCopies?-3:0,Q=this.renderWorldCopies?4:1;for(const j of B){const q=this.pointRayIntersection(j);if(q.t<0)return!0;const J=this.rayIntersectionCoordinate(q);if(J.x<P||J.y<0||J.x>Q||J.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+p.bF(this.fovAboveCenter)>88||this.anyCornerOffEdge(new p.P(0,0),new p.P(this.width,this.height))}zoomDeltaToMovement(c,d){const y=p.N.length(p.N.sub([],this._camera.position,c)),w=this._zoomFromMercatorZ(y)+d;return y-this._mercatorZfromZoom(w)}getCameraPoint(){if("globe"===this.projection.name){const c=function([d,y,w],C){const I=[d,y,w,1];p.a7.transformMat4(I,I,C);const B=I[3]=Math.max(I[3],1e-6);return I[0]/=B,I[1]/=B,I[2]/=B,I}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new p.P(c[0],c[1])}{const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new p.P(0,c))}}getCameraToCenterDistance(c,d=this.zoom,y=this.worldSize){const w=p.bA(c,d,this.width,this.height,1024),C=c.pixelSpaceConversion(this.center.lat,y,w);let I=.5/Math.tan(.5*this._fov)*this.height*C;return this.isOrthographic&&(I=rh(1,I,Hl(this.pitch>=15?1:this.pitch/15))),I}getWorldToCameraMatrix(){const c=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&p.a6.multiply(c,c,this.globeMatrix),c}getFrustum(c){return p.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,"meters"===this.projection.zAxisUnit)}}const ul={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},sh=(_,c)=>{if(c>0&&_.terrain&&p.w("Cutoff is currently disabled on terrain"),c<=0||_.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const d=_.transform,y=Math.max(Math.abs(d._zoom-(_.minCutoffZoom-1)),1),w=d.isLODDisabled(!1)?p.O(60,45,d.pitch):p.O(30,15,d.pitch),C=d._farZ-d._nearZ,I=c*d.height,B=((1-(P=w))*d.cameraToCenterDistance+P*(d._farZ+I))*y;var P;return{shouldRenderCutoff:w<1,uniformValues:{u_cutoff_params:[d._nearZ,d._farZ,(B-d._nearZ)/C,(B-I-d._nearZ)/C]}}},Ql={cascadeCount:2,shadowMapResolution:2048};class r_{constructor(c,d){this.aabb=c,this.lastCascade=d}}class R0{add(c,d){const y=this.receivers[c.key];void 0!==y?(y.aabb.min[0]=Math.min(y.aabb.min[0],d.min[0]),y.aabb.min[1]=Math.min(y.aabb.min[1],d.min[1]),y.aabb.min[2]=Math.min(y.aabb.min[2],d.min[2]),y.aabb.max[0]=Math.max(y.aabb.max[0],d.max[0]),y.aabb.max[1]=Math.max(y.aabb.max[1],d.max[1]),y.aabb.max[2]=Math.max(y.aabb.max[2],d.max[2])):this.receivers[c.key]=new r_(d,null)}clear(){this.receivers={}}get(c){return this.receivers[c.key]}computeRequiredCascades(c,d,y){const w=p.bS.fromPoints(c.points);let C=0;for(const I in this.receivers){const B=this.receivers[I];if(!B||!w.intersectsAabb(B.aabb))continue;B.aabb.min=w.closestPoint(B.aabb.min),B.aabb.max=w.closestPoint(B.aabb.max);const P=B.aabb.getCorners();for(let Q=0;Q<y.length;Q++){let j=!0;for(const q of P){const J=[q[0]*d,q[1]*d,q[2]];if(p.N.transformMat4(J,J,y[Q].matrix),J[0]<-1||J[0]>1||J[1]<-1||J[1]>1){j=!1;break}}if(B.lastCascade=Q,C=Math.max(C,Q),j)break}}return C+1}}class va{constructor(c){this.painter=c,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new R0,this._depthMode=new kn(c.context.gl.LEQUAL,kn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1,c.tp.registerParameter(Ql,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),c.tp.registerParameter(Ql,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32})}destroy(){for(const c of this._cascades)c.texture.destroy(),c.framebuffer.destroy();this._cascades=[]}updateShadowParameters(c,d){const y=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!d||!d.properties)return;const w=d.properties.get("shadow-intensity");if(!d.shadowsEnabled()||w<=0||(this._shadowLayerCount=y.style.order.reduce((le,ce)=>{const Ae=y.style._mergedLayers[ce];return le+(Ae.hasShadowPass()&&!Ae.isHidden(c.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const C=y.context,I=Ql.shadowMapResolution,B=Ql.shadowMapResolution;if(0===this._cascades.length||Ql.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let le=0;le<Ql.cascadeCount;++le){const ce=y._shadowMapDebug,Ae=C.gl,se=C.createFramebuffer(I,B,ce,"texture"),me=new p.T(C,{width:I,height:B,data:null},Ae.DEPTH_COMPONENT);if(se.depthAttachment.set(me.texture),ce){const Ie=new p.T(C,{width:I,height:B,data:null},Ae.RGBA);se.colorAttachment.set(Ie.texture)}this._cascades.push({framebuffer:se,texture:me,matrix:[],far:0,boundingSphereRadius:0,frustum:new p.bq,scale:0})}}this.shadowDirection=xp(d);let P=0;if(c.elevation){const le=c.elevation,ce=[1e4,-1e4];le.visibleDemTiles.filter(Ae=>Ae.dem).forEach(Ae=>{const se=Ae.dem.tree;ce[0]=Math.min(ce[0],se.minimums[0]),ce[1]=Math.max(ce[1],se.maximums[0])}),1e4!==ce[0]&&(P=(ce[1]-ce[0])*le.exaggeration())}const Q=1.5*c.cameraToCenterDistance,j=3*Q,q=new Float64Array(16);for(let le=0;le<this._cascades.length;++le){const ce=this._cascades[le];let Ae=c.height/50,se=1;1===Ql.cascadeCount?se=j:0===le?se=Q:(Ae=Q,se=j);const[me,Ie]=Ep(c,this.shadowDirection,Ae,se,Ql.shadowMapResolution,P);ce.scale=c.scale,ce.matrix=me,ce.boundingSphereRadius=Ie,p.a6.invert(q,ce.matrix),ce.frustum=p.bq.fromInvProjectionMatrix(q,1,0,!0),ce.far=se}const J=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[J].far,this._cascades[J].far],this._uniformValues.u_shadow_intensity=w,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Ql.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Ql.shadowMapResolution,this._uniformValues.u_shadowmap_0=ul.ShadowMap0,this._uniformValues.u_shadowmap_1=ul.ShadowMap0+1,this._groundShadowTiles=y.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const te=y.transform.elevation;for(const le of this._groundShadowTiles){let ce={min:0,max:0};if(te){const Ae=te.getMinMaxForTile(le);Ae&&(ce=Ae)}this.addShadowReceiver(le.toUnwrapped(),ce.min,ce.max)}}get enabled(){return this._enabled}set enabled(c){this._enabled=c}drawShadowPass(c,d){if(!this._enabled)return;const y=this.painter,w=y.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(y.transform.getFrustum(0),y.transform.worldSize,this._cascades),w.viewport.set([0,0,Ql.shadowMapResolution,Ql.shadowMapResolution]);for(let C=0;C<this._numCascadesToRender;++C){y.currentShadowCascade=C,w.bindFramebuffer.set(this._cascades[C].framebuffer.framebuffer),w.clear({color:p.ax.white,depth:1});for(const I of c.order){const B=c._mergedLayers[I];if(!B.hasShadowPass()||B.isHidden(y.transform.zoom))continue;const P=c.getLayerSourceCache(B),Q=P?d[P.id]:void 0;("model"===B.type||Q&&Q.length)&&y.renderLayer(y,P,B,Q)}}y.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const c=this.painter,d=c.style,y=c.context,w=d.directionalLight,C=d.ambientLight;if(!w||!C)return;const I=[],B=sh(c,c.longestCutoffRange);B.shouldRenderCutoff&&I.push("RENDER_CUTOFF");const P=Cp(w,C),Q=new kn(y.gl.LEQUAL,kn.ReadOnly,c.depthRangeFor3D);for(const j of this._groundShadowTiles){const q=j.toUnwrapped(),J=c.isTileAffectedByFog(j),te=c.getOrCreateProgram("groundShadow",{defines:I,overrideFog:J});this.setupShadows(q,te),c.uploadCommonUniforms(y,te,q,null,B);const le={u_matrix:c.transform.calculateProjMatrix(q),u_ground_shadow_factor:P};te.draw(c,y.gl.TRIANGLES,Q,or.disabled,Tr.multiply,Ri.disabled,le,"ground_shadow",c.tileExtentBuffer,c.quadTriangleIndexBuffer,c.tileExtentSegments,{},c.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Tr.unblended:Tr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(c){const d=this.painter.transform,y=d.calculatePosMatrix(c,d.worldSize);return p.a6.multiply(y,this._cascades[this.painter.currentShadowCascade].matrix,y),Float32Array.from(y)}calculateShadowPassMatrixFromMatrix(c){return p.a6.multiply(c,this._cascades[this.painter.currentShadowCascade].matrix,c),Float32Array.from(c)}setupShadows(c,d,y,w=0){if(!this._enabled)return;const C=this.painter.transform,I=this.painter.context,B=I.gl,P=this._uniformValues,Q=new Float64Array(16),j=C.calculatePosMatrix(c,C.worldSize);for(let q=0;q<this._cascades.length;q++)p.a6.multiply(Q,this._cascades[q].matrix,j),P[0===q?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(Q),I.activeTexture.set(B.TEXTURE0+ul.ShadowMap0+q),this._cascades[q].texture.bind(B.NEAREST,B.CLAMP_TO_EDGE);if(this.useNormalOffset=!!y,this.useNormalOffset){const q=p.bR(c.canonical),J=2/C.tileSize*p.V/Ql.shadowMapResolution,te=J*this._cascades[0].boundingSphereRadius,le=J*this._cascades[this._cascades.length-1].boundingSphereRadius,ce=("vector-tile"===y?1:3)/Math.pow(2,w-c.canonical.z-(1-C.zoom+Math.floor(C.zoom)));P.u_shadow_normal_offset=[q,te*ce,le*ce],P.u_shadow_bias=[6e-5,.0012,.012]}else P.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(I,P)}setupShadowsFromMatrix(c,d,y=!1){if(!this._enabled)return;const w=this.painter.context,C=w.gl,I=this._uniformValues,B=new Float64Array(16);for(let P=0;P<Ql.cascadeCount;P++)p.a6.multiply(B,this._cascades[P].matrix,c),I[0===P?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(B),w.activeTexture.set(C.TEXTURE0+ul.ShadowMap0+P),this._cascades[P].texture.bind(C.NEAREST,C.CLAMP_TO_EDGE);this.useNormalOffset=y,y?(I.u_shadow_normal_offset=[1,5,5],I.u_shadow_bias=[6e-5,.0012,.012]):I.u_shadow_bias=[36e-5,.0012,.012],d.setShadowUniformValues(w,I)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(c,d,y,w){if(w[2]>=0)return{};const C=function(P,Q,j){const q=j/(1<<P.canonical.z);return new p.bS([P.canonical.x*q+P.wrap*j,P.canonical.y*q+P.wrap*j,0],[(P.canonical.x+1)*q+P.wrap*j,(P.canonical.y+1)*q+P.wrap*j,Q])}(c,d,y).getCorners(),I=d/-w[2];w[0]<0?(p.N.add(C[0],C[0],[w[0]*I,0,0]),p.N.add(C[3],C[3],[w[0]*I,0,0])):w[0]>0&&(p.N.add(C[1],C[1],[w[0]*I,0,0]),p.N.add(C[2],C[2],[w[0]*I,0,0])),w[1]<0?(p.N.add(C[0],C[0],[0,w[1]*I,0]),p.N.add(C[1],C[1],[0,w[1]*I,0])):w[1]>0&&(p.N.add(C[2],C[2],[0,w[1]*I,0]),p.N.add(C[3],C[3],[0,w[1]*I,0]));const B={};return B.vertices=C,B.planes=[Wd(C[1],C[0],C[4]),Wd(C[2],C[1],C[5]),Wd(C[3],C[2],C[6]),Wd(C[0],C[3],C[7])],B}addShadowReceiver(c,d,y){this._receivers.add(c,p.bS.fromTileIdAndHeight(c,d,y))}getMaxCascadeForTile(c){const d=this._receivers.get(c);return d&&d.lastCascade?d.lastCascade:0}}function Wd(_,c,d){const y=p.N.sub([],d,c),w=p.N.sub([],_,c),C=p.N.cross([],y,w),I=p.N.length(C);return 0===I?[0,0,1,0]:(p.N.scale(C,C,1/I),[C[0],C[1],C[2],-p.N.dot(C,c)])}function xp(_){const c=_.properties.get("direction"),d=p.bQ(c.x,c.y,c.z);d[2]=p.aa(d[2],0,75);const y=p.bT([d[0],d[1],d[2]]);return p.N.fromValues(y.x,y.y,y.z)}function Cp(_,c){const d=_.properties.get("color"),y=_.properties.get("intensity"),w=_.properties.get("direction"),C=[w.x,w.y,w.z],I=c.properties.get("color"),B=c.properties.get("intensity"),P=Math.max(p.N.dot([0,0,1],C),0),Q=[0,0,0];p.N.scale(Q,I.toArray01Linear().slice(0,3),B);const j=[0,0,0];return p.N.scale(j,d.toArray01Linear().slice(0,3),P*y),p.bU([Q[0]>0?Q[0]/(Q[0]+j[0]):0,Q[1]>0?Q[1]/(Q[1]+j[1]):0,Q[2]>0?Q[2]/(Q[2]+j[2]):0])}function Ep(_,c,d,y,w,C){const I=_.zoom,B=_.scale,P=_.worldSize,Q=1/P,j=_.aspect,q=Math.sqrt(1+j*j)*Math.tan(.5*_.fovX),J=q*q,te=y-d,le=y+d;let ce,Ae;J>te/le?(ce=y,Ae=y*q):(ce=.5*le*(1+J),Ae=.5*Math.sqrt(te*te+2*(y*y+d*d)*J+le*le*J*J));const se=_.projection.pixelsPerMeter(_.center.lat,P),me=_._camera.getCameraToWorldMercator(),Ie=[0,0,-ce*Q];p.N.transformMat4(Ie,Ie,me);let xe=Ae*Q;const Be=_._edgeInsets;if(!(0===Be.left&&0===Be.top&&0===Be.right&&0===Be.bottom||Be.left===Be.right&&Be.top===Be.bottom)){const Tn=_._camera.getWorldToCamera(_.worldSize,"meters"===_.projection.zAxisUnit?se:1),Cn=_._camera.getCameraToClipPerspective(_._fov,_.width/_.height,d,y);Cn[8]=2*-_.centerOffset.x/_.width,Cn[9]=2*_.centerOffset.y/_.height;const $n=new Float64Array(16);p.a6.mul($n,Cn,Tn);const li=new Float64Array(16);p.a6.invert(li,$n);const xi=p.bq.fromInvProjectionMatrix(li,P,I,!0);for(const yi of xi.points){const ci=((ge=yi)[0]/=B,ge[1]/=B,ge[2]=p.bl(ge[2],_._center.lat),ge);xe=Math.max(xe,p.N.len(p.N.subtract([],Ie,ci)))}}var ge;xe*=w/(w-1);const Me=Math.acos(c[2]),He=Math.atan2(-c[0],-c[1]),Ge=new Uf;Ge.position=Ie,Ge.setPitchBearing(Me,He);const nt=Ge.getWorldToCamera(P,se),dt=xe*P,ot=Math.min(_._mercatorZfromZoom(17)*P*-2,-2*dt),Pt=Ge.getCameraToClipOrthographic(-dt,dt,-dt,dt,ot,(dt+C*se)/c[2]),Rt=new Float64Array(16);p.a6.multiply(Rt,Pt,nt);const cn=p.N.fromValues(Math.floor(1e6*Ie[0])/1e6*P,Math.floor(1e6*Ie[1])/1e6*P,0),ct=.5*w,St=[0,0,0];p.N.transformMat4(St,cn,Rt),p.N.scale(St,St,ct);const Ze=[Math.floor(St[0]),Math.floor(St[1]),Math.floor(St[2])],gt=[0,0,0];p.N.sub(gt,St,Ze),p.N.scale(gt,gt,-1/ct);const An=new Float64Array(16);return p.a6.identity(An),p.a6.translate(An,An,gt),p.a6.multiply(Rt,An,Rt),[Rt,dt]}const Zd=(_,c)=>jn(_,c&&c.filter(d=>"source.canvas"!==d.identifier)),s_=p.ac(Or,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),Xd=p.ac(Or,["setCenter","setZoom","setBearing","setPitch"]),Vg={version:8,layers:[],sources:{}},o_={duration:300,delay:0},O0=new Set(["fill","line","background","hillshade","raster"]);class Mr extends p.E{constructor(c,d={}){super(),this.map=c,this.scope=d.scope||"",this.fragments=[],this.importDepth=d.importDepth||0,this.importsCache=d.importsCache||new Map,this.resolvedImports=d.resolvedImports||new Set,this.transition=p.e({},o_),this._buildingIndex=new pv(this),this.crossTileSymbolIndex=new Na,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=d.styleChanges||new Sl,this.dispatcher=d.dispatcher?d.dispatcher:new p.bW(p.bX(),this),d.imageManager?this.imageManager=d.imageManager:(this.imageManager=new EA,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=d.glyphManager?d.glyphManager:new p.bY(c._requestManager,d.localFontFamily?p.bZ.all:d.localIdeographFontFamily?p.bZ.ideographs:p.bZ.none,d.localFontFamily||d.localIdeographFontFamily),d.modelManager?this.modelManager=d.modelManager:(this.modelManager=new od(c._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=d.configOptions?d.configOptions:new Map,this._configDependentLayers=d.configDependentLayers?d.configDependentLayers:new Set,this._config=d.config,this.dispatcher.broadcast("setReferrer",p.b_());const y=this;this._rtlTextPluginCallback=Mr.registerForPluginStateChange(w=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(C,I)=>{if(p.b$(C),I&&I.every(B=>B))for(const B in y._sourceCaches){const P=y._sourceCaches[B],Q=P.getSource().type;"vector"!==Q&&"geojson"!==Q||P.reload()}})}),this.on("data",w=>{if("source"!==w.dataType||"metadata"!==w.sourceDataType)return;const C=this.getOwnSource(w.sourceId);if(C&&C.vectorLayerIds)for(const I in this._layers){const B=this._layers[I];B.source===C.id&&this._validateLayer(B)}})}loadURL(c,d={}){this.fire(new p.b("dataloading",{dataType:"style"}));const y="boolean"==typeof d.validate?d.validate:!p.c0(c);c=this.map._requestManager.normalizeStyleURL(c,d.accessToken),this.resolvedImports.add(c);const w=this.importsCache.get(c);if(w)return this._load(w,y);const C=this.map._requestManager.transformRequest(c,p.R.Style);this._request=p.g(C,(I,B)=>{if(this._request=null,I)this.fire(new p.a(I));else if(B)return this.importsCache.set(c,B),this._load(B,y)})}loadJSON(c,d={}){this.fire(new p.b("dataloading",{dataType:"style"})),this._request=p.f.frame(()=>{this._request=null,this._load(c,!1!==d.validate)})}loadEmpty(){this.fire(new p.b("dataloading",{dataType:"style"})),this._load(Vg,!1)}_loadImports(c,d,y){if(this.importDepth>=4)return p.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const w=[];for(const C of c){const I=this._createFragmentStyle(C),B=new Promise(j=>{I.once("style.import.load",j),I.once("error",j)}).then(()=>this.mergeAll());if(w.push(B),this.resolvedImports.has(C.url)){I.loadEmpty();continue}const P=C.data||this.importsCache.get(C.url);P?I.loadJSON(P,{validate:d}):C.url?I.loadURL(C.url,{validate:d}):I.loadEmpty();const Q={style:I,id:C.id,config:C.config};if(y){const j=this.fragments.findIndex(({id:q})=>q===y);this.fragments=this.fragments.slice(0,j).concat(Q).concat(this.fragments.slice(j))}else this.fragments.push(Q)}return Promise.allSettled(w)}_createFragmentStyle(c){const d=this.scope?p.ag(c.id,this.scope):c.id,y=new Mr(this.map,{scope:d,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:c.config,configOptions:this.options,configDependentLayers:this._configDependentLayers});return y.setEventedParent(this.map,{style:y}),y}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const c=this.isRootStyle();this._shouldPrecompile=c,this.fire(new p.b(c?"style.load":"style.import.load"))}_load(c,d){const y=c.schema;if(this.isRootStyle()&&(c.fragment||y&&!1!==c.fragment)){const I=p.e({},Vg,{imports:[{id:"basemap",data:c,url:""}]});return void this._load(I,d)}if(this.setConfig(this._config,y),d&&Zd(this,_i(c)))return;this._loaded=!0,this.stylesheet=p.c1(c);for(const I in c.sources)this.addSource(I,c.sources[I],{validate:!1,isInitialLoad:!0});c.sprite?this._loadSprite(c.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(c.glyphs,this.scope);const w=jd(this.stylesheet.layers);if(this._order=w.map(I=>I.id),this.stylesheet.light&&p.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const I=this.stylesheet.lights[0];this.light=new ui(I.properties,I.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new ui(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const I of w){const B=p.c2(I,this.scope,this.options);B.isConfigDependent&&this._configDependentLayers.add(B.fqid),B.setEventedParent(this,{layer:{id:B.id}}),this._layers[B.id]=B,this._serializedLayers[B.id]=B.serialize();const P=this.getOwnLayerSourceCache(B),Q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();P&&B.canCastShadows()&&Q&&(P.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const C=this.stylesheet.terrain;C&&(void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=p.f.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?p.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(C,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new p.b("data",{dataType:"style"})),c.imports?this._loadImports(c.imports,d).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return 0===this.importDepth}mergeAll(){let c,d,y,w,C,I,B,P;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Q=>{if(Q.stylesheet){if(null!=Q.light&&(c=Q.light),Q.stylesheet.lights)for(const j of Q.stylesheet.lights)"ambient"===j.type&&null!=Q.ambientLight&&(d=Q.ambientLight),"directional"===j.type&&null!=Q.directionalLight&&(y=Q.directionalLight);w=this._prioritizeTerrain(w,Q.terrain,Q.stylesheet.terrain),Q.stylesheet.fog&&null!=Q.fog&&(C=Q.fog),null!=Q.stylesheet.camera&&(P=Q.stylesheet.camera),null!=Q.stylesheet.projection&&(I=Q.stylesheet.projection),null!=Q.stylesheet.transition&&(B=Q.stylesheet.transition)}}),this.light=c,this.ambientLight=d,this.directionalLight=y,this.fog=C,null===w?delete this.terrain:this.terrain=w,this.camera=P||{"camera-projection":"perspective"},this.projection=I||{name:"mercator"},this.transition=p.e({},o_,B),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(c){const d=y=>{for(const w of y.fragments)d(w.style);c(y)};d(this)}_prioritizeTerrain(c,d,y){const w=c&&0===c.drapeRenderMode;return null===y?d&&0===d.drapeRenderMode?d:w?c:null:null!=d&&(!c||w||d&&1===d.drapeRenderMode)?d:c}mergeTerrain(){let c;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(d=>{c=this._prioritizeTerrain(c,d.terrain,d.stylesheet.terrain)}),null===c?delete this.terrain:this.terrain=c}mergeProjection(){let c;this.forEachFragmentStyle(d=>{null!=d.stylesheet.projection&&(c=d.stylesheet.projection)}),this.projection=c||{name:"mercator"}}mergeSources(){const c={},d={},y={};this.forEachFragmentStyle(w=>{for(const C in w._sourceCaches){const I=p.ag(C,w.scope);c[I]=w._sourceCaches[C]}for(const C in w._otherSourceCaches){const I=p.ag(C,w.scope);d[I]=w._otherSourceCaches[C]}for(const C in w._symbolSourceCaches){const I=p.ag(C,w.scope);y[I]=w._symbolSourceCaches[C]}}),this._mergedSourceCaches=c,this._mergedOtherSourceCaches=d,this._mergedSymbolSourceCaches=y}mergeLayers(){const c={},d=[],y={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(C=>{for(const I of C._order){const B=C._layers[I];if("slot"===B.type){const P=p.c3(I);if(c[P])continue;c[P]=[]}B.slot&&c[B.slot]?c[B.slot].push(B):d.push(B)}}),this._mergedOrder=[];const w=(C=[])=>{for(const I of C)if("slot"===I.type){const B=p.c3(I.id);c[B]&&w(c[B])}else{const B=p.ag(I.id,I.scope);this._mergedOrder.push(B),y[B]=I,I.is3D()&&(this._has3DLayers=!0),"circle"===I.type&&(this._hasCircleLayers=!0),"symbol"===I.type&&(this._hasSymbolLayers=!0)}};w(d),this._mergedLayers=y,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(c){return this.stylesheet.camera=p.e({},this.stylesheet.camera,c),this.camera=this.stylesheet.camera,this}setProjection(c){c?this.stylesheet.projection=c:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(c){this._spriteRequest=function(d,y,w){let C,I,B;const P=p.f.devicePixelRatio>1?"@2x":"";let Q=p.g(y.transformRequest(y.normalizeSpriteURL(d,P,".json"),p.R.SpriteJSON),(J,te)=>{Q=null,B||(B=J,C=te,q())}),j=p.d(y.transformRequest(y.normalizeSpriteURL(d,P,".png"),p.R.SpriteImage),(J,te)=>{j=null,B||(B=J,I=te,q())});function q(){if(B)w(B);else if(C&&I){const J=p.f.getImageData(I),te={};for(const le in C){const{width:ce,height:Ae,x:se,y:me,sdf:Ie,pixelRatio:xe,stretchX:Be,stretchY:ge,content:Me}=C[le],He=new p.h({width:ce,height:Ae});p.h.copy(J,He,{x:se,y:me},{x:0,y:0},{width:ce,height:Ae}),te[le]={data:He,pixelRatio:xe,sdf:Ie,stretchX:Be,stretchY:ge,content:Me}}w(null,te)}}return{cancel(){Q&&(Q.cancel(),Q=null),j&&(j.cancel(),j=null)}}}(c,this.map._requestManager,(d,y)=>{if(this._spriteRequest=null,d)this.fire(new p.a(d));else if(y)for(const w in y)this.imageManager.addImage(w,this.scope,y[w]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new p.b("data",{dataType:"style"}))})}_validateLayer(c){const d=this.getOwnSource(c.source);if(!d)return;const y=c.sourceLayer;y&&("geojson"===d.type||d.vectorLayerIds&&-1===d.vectorLayerIds.indexOf(y))&&this.fire(new p.a(new Error(`Source layer "${y}" does not exist on source "${d.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:c}of this.fragments)if(!c.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((c,d)=>{const y=this.fragments[d];return y&&y.style&&(c.data=y.style.serialize()),c})}_serializeSources(){const c={};for(const d in this._sourceCaches){const y=this._sourceCaches[d].getSource();c[y.id]||(c[y.id]=y.serialize())}return c}_serializeLayers(c){const d=[];for(const y of c){const w=this._layers[y];w&&"custom"!==w.type&&d.push(w.serialize())}return d}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(c){return!!this.terrain&&("function"==typeof c.isLayerDraped?c.isLayerDraped(this.getLayerSourceCache(c)):O0.has(c.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(c){const d=this.getOwnLayer(c);if(d)return d;this.fire(new p.a(new Error(`The layer '${c}' does not exist in the map's style.`)))}_checkSource(c){const d=this.getOwnSource(c);if(d)return d;this.fire(new p.a(new Error(`The source '${c}' does not exist in the map's style.`)))}update(c){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(c),this.directionalLight&&this.directionalLight.recalculate(c);const d=this.calculateLightsBrightness();c.brightness=d||0,d!==this._brightness&&(this._brightness=d,this.dispatcher.broadcast("setBrightness",d));const y=this._changes.isDirty();if(this._changes.isDirty()){const C=this._changes.getLayerUpdatesByScope();for(const I in C){const{updatedIds:B,removedIds:P}=C[I];(B||P)&&this._updateWorkerLayers(I,B,P)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(c),this.light&&this.light.updateTransitions(c),this.ambientLight&&this.ambientLight.updateTransitions(c),this.directionalLight&&this.directionalLight.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this._changes.reset()}const w={};for(const C in this._mergedSourceCaches){const I=this._mergedSourceCaches[C];w[C]=I.used,I.used=!1,I.tileCoverLift=0}for(const C of this._mergedOrder){const I=this._mergedLayers[C];if(I.recalculate(c,this._availableImages),!I.isHidden(c.zoom)){const B=this.getLayerSourceCache(I);B&&(B.used=!0,B.tileCoverLift=Math.max(B.tileCoverLift,I.tileCoverLift()))}if(!this._precompileDone&&this._shouldPrecompile)for(let B=I.minzoom||0;B<(I.maxzoom||25.5);B++){const P=this.map.painter;if(P){const Q=I.getProgramIds();if(!Q)continue;for(const j of Q){const q=I.getDefaultProgramParams(j,c.zoom);q&&(P.style=this,this.fog&&(P._fogVisible=!0,q.overrideFog=!0,P.getOrCreateProgram(j,q)),P._fogVisible=!1,q.overrideFog=!1,P.getOrCreateProgram(j,q),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(q.overrideRtt=!0,P.getOrCreateProgram(j,q)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const C in w){const I=this._mergedSourceCaches[C];w[C]!==I.used&&I.getSource().fire(new p.b("data",{sourceDataType:"visibility",dataType:"source",sourceId:I.getSource().id}))}this.light&&this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),y&&this.fire(new p.b("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=this._changes.getUpdatedImages();if(c.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],c);this._changes.resetUpdatedImages()}}_updateWorkerLayers(c,d,y){const w=this.getFragmentStyle(c);w&&this.dispatcher.broadcast("updateLayers",{layers:d?w._serializeLayers(d):[],scope:c,removedIds:y||[],options:w.options})}setState(c){if(this._checkLoaded(),Zd(this,_i(c)))return!1;(c=p.c1(c)).layers=jd(c.layers);const d=function(w,C){if(!w)return[{command:Or.setStyle,args:[C]}];let I=[];try{if(!Ai(w.version,C.version))return[{command:Or.setStyle,args:[C]}];Ai(w.center,C.center)||I.push({command:Or.setCenter,args:[C.center]}),Ai(w.zoom,C.zoom)||I.push({command:Or.setZoom,args:[C.zoom]}),Ai(w.bearing,C.bearing)||I.push({command:Or.setBearing,args:[C.bearing]}),Ai(w.pitch,C.pitch)||I.push({command:Or.setPitch,args:[C.pitch]}),Ai(w.sprite,C.sprite)||I.push({command:Or.setSprite,args:[C.sprite]}),Ai(w.glyphs,C.glyphs)||I.push({command:Or.setGlyphs,args:[C.glyphs]}),Ai(w.imports,C.imports)||function(q=[],J=[],te){J=J||[];const le=(q=q||[]).map(ud),ce=J.map(ud),Ae=q.reduce(Lg,{}),se=J.reduce(Lg,{}),me=le.slice();let Ie,xe,Be,ge;for(Ie=0,xe=0;Ie<le.length;Ie++)Be=le[Ie],se.hasOwnProperty(Be)?xe++:(te.push({command:Or.removeImport,args:[Be]}),me.splice(me.indexOf(Be,xe),1));for(Ie=0,xe=0;Ie<ce.length;Ie++)Be=ce[ce.length-1-Ie],me[me.length-1-Ie]!==Be&&(Ae.hasOwnProperty(Be)?(te.push({command:Or.removeImport,args:[Be]}),me.splice(me.lastIndexOf(Be,me.length-xe),1)):xe++,ge=me[me.length-Ie],te.push({command:Or.addImport,args:[se[Be],ge]}),me.splice(me.length-Ie,0,Be));for(const Me of J){const He=Ae[Me.id];He&&!Ai(He,Me)&&te.push({command:Or.updateImport,args:[Me.id,Me]})}}(w.imports,C.imports,I),Ai(w.transition,C.transition)||I.push({command:Or.setTransition,args:[C.transition]}),Ai(w.light,C.light)||I.push({command:Or.setLight,args:[C.light]}),Ai(w.fog,C.fog)||I.push({command:Or.setFog,args:[C.fog]}),Ai(w.projection,C.projection)||I.push({command:Or.setProjection,args:[C.projection]}),Ai(w.lights,C.lights)||I.push({command:Or.setLights,args:[C.lights]}),Ai(w.camera,C.camera)||I.push({command:Or.setCamera,args:[C.camera]});const B={},P=[];!function(q,J,te,le){let ce;for(ce in J=J||{},q=q||{})q.hasOwnProperty(ce)&&(J.hasOwnProperty(ce)||i_(ce,te,le));for(ce in J){if(!J.hasOwnProperty(ce))continue;const Ae=J[ce];q.hasOwnProperty(ce)?Ai(q[ce],Ae)||("geojson"===q[ce].type&&"geojson"===Ae.type&&kf(q,J,ce)?te.push({command:Or.setGeoJSONSourceData,args:[ce,Ae.data]}):Ju(ce,J,te,le)):Of(ce,J,te)}}(w.sources,C.sources,P,B);const Q=[];w.layers&&w.layers.forEach(q=>{q.source&&B[q.source]?I.push({command:Or.removeLayer,args:[q.id]}):Q.push(q)});let j=w.terrain;j&&B[j.source]&&(I.push({command:Or.setTerrain,args:[void 0]}),j=void 0),I=I.concat(P),Ai(j,C.terrain)||I.push({command:Or.setTerrain,args:[C.terrain]}),function(q,J,te){J=J||[];const le=(q=q||[]).map(ud),ce=J.map(ud),Ae=q.reduce(Lg,{}),se=J.reduce(Lg,{}),me=le.slice(),Ie=Object.create(null);let xe,Be,ge,Me,He,Ge,nt;for(xe=0,Be=0;xe<le.length;xe++)ge=le[xe],se.hasOwnProperty(ge)?Be++:(te.push({command:Or.removeLayer,args:[ge]}),me.splice(me.indexOf(ge,Be),1));for(xe=0,Be=0;xe<ce.length;xe++)ge=ce[ce.length-1-xe],me[me.length-1-xe]!==ge&&(Ae.hasOwnProperty(ge)?(te.push({command:Or.removeLayer,args:[ge]}),me.splice(me.lastIndexOf(ge,me.length-Be),1)):Be++,Ge=me[me.length-xe],te.push({command:Or.addLayer,args:[se[ge],Ge]}),me.splice(me.length-xe,0,ge),Ie[ge]=!0);for(xe=0;xe<ce.length;xe++)if(ge=ce[xe],Me=Ae[ge],He=se[ge],!Ie[ge]&&!Ai(Me,He))if(Ai(Me.source,He.source)&&Ai(Me["source-layer"],He["source-layer"])&&Ai(Me.type,He.type)){for(nt in Du(Me.layout,He.layout,te,ge,null,Or.setLayoutProperty),Du(Me.paint,He.paint,te,ge,null,Or.setPaintProperty),Ai(Me.slot,He.slot)||te.push({command:Or.setSlot,args:[ge,He.slot]}),Ai(Me.filter,He.filter)||te.push({command:Or.setFilter,args:[ge,He.filter]}),Ai(Me.minzoom,He.minzoom)&&Ai(Me.maxzoom,He.maxzoom)||te.push({command:Or.setLayerZoomRange,args:[ge,He.minzoom,He.maxzoom]}),Me)Me.hasOwnProperty(nt)&&"layout"!==nt&&"paint"!==nt&&"filter"!==nt&&"metadata"!==nt&&"minzoom"!==nt&&"maxzoom"!==nt&&"slot"!==nt&&(0===nt.indexOf("paint.")?Du(Me[nt],He[nt],te,ge,nt.slice(6),Or.setPaintProperty):Ai(Me[nt],He[nt])||te.push({command:Or.setLayerProperty,args:[ge,nt,He[nt]]}));for(nt in He)He.hasOwnProperty(nt)&&!Me.hasOwnProperty(nt)&&"layout"!==nt&&"paint"!==nt&&"filter"!==nt&&"metadata"!==nt&&"minzoom"!==nt&&"maxzoom"!==nt&&"slot"!==nt&&(0===nt.indexOf("paint.")?Du(Me[nt],He[nt],te,ge,nt.slice(6),Or.setPaintProperty):Ai(Me[nt],He[nt])||te.push({command:Or.setLayerProperty,args:[ge,nt,He[nt]]}))}else te.push({command:Or.removeLayer,args:[ge]}),Ge=me[me.lastIndexOf(ge)+1],te.push({command:Or.addLayer,args:[He,Ge]})}(Q,C.layers,I)}catch(B){console.warn("Unable to compute style diff:",B),I=[{command:Or.setStyle,args:[C]}]}return I}(this.serialize(),c).filter(w=>!(w.command in Xd));if(0===d.length)return!1;const y=d.filter(w=>!(w.command in s_));if(y.length>0)throw new Error(`Unimplemented: ${y.map(w=>w.command).join(", ")}.`);return d.forEach(w=>{this[w.command].apply(this,w.args)}),this.stylesheet=c,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(c,d){return this.getImage(c)?this.fire(new p.a(new Error("An image with this name already exists."))):(this.imageManager.addImage(c,this.scope,d),this._afterImageUpdated(c),this)}updateImage(c,d){this.imageManager.updateImage(c,this.scope,d)}getImage(c){return this.imageManager.getImage(c,this.scope)}removeImage(c){return this.getImage(c)?(this.imageManager.removeImage(c,this.scope),this._afterImageUpdated(c),this):this.fire(new p.a(new Error("No image with this name exists.")))}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(c),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new p.b("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(c,d,y={}){return this._checkLoaded(),this._validate(zn,`models.${c}`,d,null,y)||(this.modelManager.addModel(c,d,this.scope),this._changes.setDirty()),this}hasModel(c){return this.modelManager.hasModel(c,this.scope)}removeModel(c){return this.hasModel(c)?(this.modelManager.removeModel(c,this.scope),this):this.fire(new p.a(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(c,d,y={}){if(this._checkLoaded(),void 0!==this.getOwnSource(c))throw new Error(`There is already a source with ID "${c}".`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(Mi,`sources.${c}`,d,null,y))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const w=ka(c,d,this.dispatcher,this);w.scope=this.scope,w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(w.id),source:w.serialize(),sourceId:w.id}));const C=I=>{const B=(I?"symbol:":"other:")+w.id,P=p.ag(B,this.scope),Q=this._sourceCaches[B]=new Rh(P,w,I);(I?this._symbolSourceCaches:this._otherSourceCaches)[w.id]=Q,Q.onAdd(this.map)};C(!1),"vector"!==d.type&&"geojson"!==d.type||C(!0),w.onAdd&&w.onAdd(this.map),y.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(c){this._checkLoaded();const d=this.getOwnSource(c);if(!d)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===c)return this.fire(new p.a(new Error(`Source "${c}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===c)return this.fire(new p.a(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));const y=this.getOwnSourceCaches(c);for(const w of y){const C=p.c3(w.id);delete this._sourceCaches[C],this._changes.discardSourceCacheUpdate(w.id),w.fire(new p.b("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles()}return delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],this.mergeSources(),d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(c,d){this._checkLoaded(),this.getOwnSource(c).setData(d),this._changes.setDirty()}getOwnSource(c){const d=this.getOwnSourceCache(c);return d&&d.getSource()}getOwnSources(){const c=[];for(const d in this._otherSourceCaches){const y=this.getOwnSourceCache(d);y&&c.push(y.getSource())}return c}areTilesLoaded(){const c=this._mergedSourceCaches;for(const d in c){const y=c[d]._tiles;for(const w in y){const C=y[w];if("loaded"!==C.state&&"errored"!==C.state)return!1}}return!0}setLights(c){if(this._checkLoaded(),!c)return delete this.ambientLight,void delete this.directionalLight;const d=this._getTransitionParameters();for(const w of c){if(this._validate(kt,"lights",w))return;switch(w.type){case"ambient":if(this.ambientLight){const C=this.ambientLight;C.set(w),C.updateTransitions(d)}else this.ambientLight=new Xa(w,zl,this.scope,this.options);break;case"directional":if(this.directionalLight){const C=this.directionalLight;C.set(w),C.updateTransitions(d)}else this.directionalLight=new Xa(w,ua,this.scope,this.options)}}const y=new p.K(this.z||0,d);this.ambientLight&&this.ambientLight.recalculate(y),this.directionalLight&&this.directionalLight.recalculate(y),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const c=this.directionalLight,d=this.ambientLight;if(!c||!d)return;const y=q=>.2126*(q[0]<=.03928?q[0]/12.92:Math.pow((q[0]+.055)/1.055,2.4))+.7152*(q[1]<=.03928?q[1]/12.92:Math.pow((q[1]+.055)/1.055,2.4))+.0722*(q[2]<=.03928?q[2]/12.92:Math.pow((q[2]+.055)/1.055,2.4)),w=c.properties.get("color").toArray01(),C=c.properties.get("intensity"),I=c.properties.get("direction"),B=1-p.bQ(I.x,I.y,I.z)[2]/90,P=y(w)*C*B,Q=d.properties.get("color").toArray01(),j=d.properties.get("intensity");return(P+y(Q)*j)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const c=[];return this.directionalLight&&c.push(this.directionalLight.get()),this.ambientLight&&c.push(this.ambientLight.get()),c}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(c){if(!c)return this;if(p.c4(c)){const d=p.c5(c),y=this.fragments.find(({id:C})=>C===d);if(!y)throw new Error(`Style import not found: ${c}`);const w=p.c3(c);return y.style.getFragmentStyle(w)}{const d=this.fragments.find(({id:y})=>y===c);if(!d)throw new Error(`Style import not found: ${c}`);return d.style}}getConfigProperty(c,d){const y=this.getFragmentStyle(c);if(!y)return null;const w=p.ag(d,y.scope),C=y.options.get(w),I=C?C.value||C.default:null;return I?I.serialize():null}setConfigProperty(c,d,y){const w=p.r(y);if("success"!==w.result)return void Zd(this,w.value);const C=w.value.expression,I=this.getFragmentStyle(c);if(!I)return;const B=p.ag(d,I.scope),P=I.options.get(B);P&&(this.options.set(B,{...P,value:C}),this.updateConfigDependencies())}setConfig(c,d){if(this._config=c,c||d)if(d)for(const y in d){let w,C;const I=p.r(d[y].default);if("success"===I.result&&(w=I.value.expression),c&&void 0!==c[y]){const J=p.r(c[y]);"success"===J.result&&(C=J.value.expression)}const{minValue:B,maxValue:P,stepValue:Q,type:j,values:q}=d[y];if(w){const J=p.ag(y,this.scope);this.options.set(J,{default:w,value:C,minValue:B,maxValue:P,stepValue:Q,type:j,values:q})}else this.fire(new p.a(new Error(`No schema defined for config option "${y}".`)))}else this.fire(new p.a(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const c of this._configDependentLayers){const d=this.getLayer(c);d&&(d.possiblyEvaluateVisibility(),this._updateLayer(d))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this._changes.setDirty()}addLayer(c,d,y={}){this._checkLoaded();const w=c.id;if(this._layers[w])return void this.fire(new p.a(new Error(`Layer with id "${w}" already exists on this map`)));let C;if("custom"===c.type){if(Zd(this,p.c6(c)))return;C=p.c2(c,this.scope,this.options)}else{if("object"==typeof c.source&&(this.addSource(w,c.source),c=p.c1(c),c=p.e(c,{source:w})),this._validate(tt,`layers.${w}`,c,{arrayIndex:-1},y))return;C=p.c2(c,this.scope,this.options),this._validateLayer(C),C.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[C.id]=C.serialize()}C.isConfigDependent&&this._configDependentLayers.add(C.fqid);let I=this._order.length;if(d){const j=this._order.indexOf(d);if(-1===j)return void this.fire(new p.a(new Error(`Layer with id "${d}" does not exist on this map.`)));C.slot===this._layers[d].slot?I=j:p.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(I,0,w),this._layerOrderChanged=!0,this._layers[w]=C;const B=this.getOwnLayerSourceCache(C),P=!!this.directionalLight&&this.directionalLight.shadowsEnabled();B&&C.canCastShadows()&&P&&(B.castsShadows=!0);const Q=this._changes.getRemovedLayer(C);if(Q&&C.source&&B&&"custom"!==C.type){this._changes.discardLayerRemoval(C);const j=p.ag(C.source,C.scope);Q.type!==C.type?this._changes.updateSourceCache(j,"clear"):(this._changes.updateSourceCache(j,"reload"),B.pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map),C.scope=this.scope,this.mergeLayers()}moveLayer(c,d){this._checkLoaded();const y=this._checkLayer(c);if(!y||c===d)return;const w=this._order.indexOf(c);this._order.splice(w,1);let C=this._order.length;if(d){const I=this._order.indexOf(d);if(-1===I)return void this.fire(new p.a(new Error(`Layer with id "${d}" does not exist on this map.`)));y.slot===this._layers[d].slot?C=I:p.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(C,0,c),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(c){this._checkLoaded();const d=this._checkLayer(c);if(!d)return;d.setEventedParent(null);const y=this._order.indexOf(c);this._order.splice(y,1),delete this._layers[c],delete this._serializedLayers[c],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(d.fqid),this._changes.removeLayer(d);const w=this.getOwnLayerSourceCache(d);if(w&&w.castsShadows){let C=!1;for(const I in this._layers)if(this._layers[I].source===d.source&&this._layers[I].canCastShadows()){C=!0;break}w.castsShadows=C}d.onRemove&&d.onRemove(this.map),this.mergeLayers()}getOwnLayer(c){return this._layers[c]}hasLayer(c){return c in this._mergedLayers}hasLayerType(c){for(const d in this._layers)if(this._layers[d].type===c)return!0;return!1}setLayerZoomRange(c,d,y){this._checkLoaded();const w=this._checkLayer(c);w&&(w.minzoom===d&&w.maxzoom===y||(null!=d&&(w.minzoom=d),null!=y&&(w.maxzoom=y),this._updateLayer(w)))}setSlot(c,d){this._checkLoaded();const y=this._checkLayer(c);y&&y.slot!==d&&(y.slot=d,this._updateLayer(y))}setFilter(c,d,y={}){this._checkLoaded();const w=this._checkLayer(c);if(w&&!Ai(w.filter,d))return null==d?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(Gt,`layers.${w.id}.filter`,d,{layerType:w.type},y)||(w.filter=p.c1(d),this._updateLayer(w)))}getFilter(c){const d=this._checkLayer(c);if(d)return p.c1(d.filter)}setLayoutProperty(c,d,y,w={}){this._checkLoaded();const C=this._checkLayer(c);if(C&&!Ai(C.getLayoutProperty(d),y)){if(null!=y&&(!w||!1!==w.validate)&&Zd(C,wn.call(_i,{key:`layers.${c}.layout.${d}`,layerType:C.type,objectKey:d,value:y,styleSpec:p.D,style:{glyphs:!0,sprite:!0}})))return;C.setLayoutProperty(d,y),C.isConfigDependent&&this._configDependentLayers.add(C.fqid),this._updateLayer(C)}}getLayoutProperty(c,d){const y=this._checkLayer(c);if(y)return y.getLayoutProperty(d)}setPaintProperty(c,d,y,w={}){this._checkLoaded();const C=this._checkLayer(c);if(!C||Ai(C.getPaintProperty(d),y)||null!=y&&(!w||!1!==w.validate)&&Zd(C,tn.call(_i,{key:`layers.${c}.paint.${d}`,layerType:C.type,objectKey:d,value:y,styleSpec:p.D})))return;const I=C.setPaintProperty(d,y);C.isConfigDependent&&this._configDependentLayers.add(C.fqid),I&&this._updateLayer(C),this._changes.updatePaintProperties(C)}getPaintProperty(c,d){const y=this._checkLayer(c);if(y)return y.getPaintProperty(d)}setFeatureState(c,d){this._checkLoaded();const y=c.source,w=c.sourceLayer,C=this._checkSource(y);if(!C)return;const I=C.type;if("geojson"===I&&w)return void this.fire(new p.a(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===I&&!w)return void this.fire(new p.a(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===c.id&&this.fire(new p.a(new Error("The feature id parameter must be provided.")));const B=this.getOwnSourceCaches(y);for(const P of B)P.setFeatureState(w,c.id,d)}removeFeatureState(c,d){this._checkLoaded();const y=c.source,w=this._checkSource(y);if(!w)return;const C=w.type,I="vector"===C?c.sourceLayer:void 0;if("vector"===C&&!I)return void this.fire(new p.a(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&"string"!=typeof c.id&&"number"!=typeof c.id)return void this.fire(new p.a(new Error("A feature id is required to remove its specific state property.")));const B=this.getOwnSourceCaches(y);for(const P of B)P.removeFeatureState(I,c.id,d)}getFeatureState(c){this._checkLoaded();const d=c.source,y=c.sourceLayer,w=this._checkSource(d);if(w){if("vector"!==w.type||y)return void 0===c.id&&this.fire(new p.a(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(d)[0].getFeatureState(y,c.id);this.fire(new p.a(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(c){return this.stylesheet.transition=p.e({},this.stylesheet.transition,c),this.transition=this.stylesheet.transition,this}getTransition(){return p.e({},this.stylesheet.transition)}serialize(){this._checkLoaded();const c=this.getTerrain(),d=c&&this.terrain&&this.terrain.scope===this.scope?c:this.stylesheet.terrain;return p.c7({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:d,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},y=>void 0!==y)}_updateLayer(c){this._changes.updateLayer(c);const d=this.getLayerSourceCache(c),y=p.ag(c.source,c.scope),w=this._changes.getUpdatedSourceCaches();c.source&&!w[y]&&d&&"raster"!==d.getSource().type&&(this._changes.updateSourceCache(y,"reload"),d.pause()),c.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(c){const d=B=>"fill-extrusion"===this._mergedLayers[B].type||"model"===this._mergedLayers[B].type,y=this.order,w={},C=[];for(let B=y.length-1;B>=0;B--){const P=y[B];if(d(P)){w[P]=B;for(const Q of c){const j=Q[P];if(j)for(const q of j)C.push(q)}}}C.sort((B,P)=>P.intersectionZ-B.intersectionZ);const I=[];for(let B=y.length-1;B>=0;B--){const P=y[B];if(d(P))for(let Q=C.length-1;Q>=0;Q--){const j=C[Q].feature;if(w[j.layer.id]<B)break;I.push(j),C.pop()}else for(const Q of c){const j=Q[P];if(j)for(const q of j)I.push(q.feature)}}return I}queryRenderedFeatures(c,d,y){d&&d.filter&&this._validate(Gt,"queryRenderedFeatures.filter",d.filter,null,d),d.scope=this.scope,d.availableImages=this._availableImages,d.serializedLayers=this._serializedLayers;const w={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new p.a(new Error("parameters.layers must be an Array."))),[];for(const Q of d.layers){const j=this._mergedLayers[Q];if(!j)return this.fire(new p.a(new Error(`The layer '${Q}' does not exist in the map's style and cannot be queried for features.`))),[];w[j.source]=!0}}const C=[],I=d.serializedLayers||{},B=d&&d.layers?d.layers.some(Q=>{const j=this.getLayer(Q);return j&&j.is3D()}):this.has3DLayers(),P=ha.createFromScreenPoints(c,y);for(const Q in this._mergedSourceCaches){const j=this._mergedSourceCaches[Q].getSource();if(!j||j.scope!==d.scope)continue;const q=this._mergedSourceCaches[Q].getSource().id;d.layers&&!w[q]||C.push(n_(this._mergedSourceCaches[Q],this._mergedLayers,I,P,d,y,B,!!this.map._showQueryGeometry))}return this.placement&&C.push(function(Q,j,q,J,te,le,ce){const Ae={},se=le.queryRenderedSymbols(J),me=[];for(const Ie of Object.keys(se).map(Number))me.push(ce[Ie]);me.sort(_p);for(const Ie of me){const xe=Ie.featureIndex.lookupSymbolFeatures(se[Ie.bucketInstanceId],j,Ie.bucketIndex,Ie.sourceLayerIndex,te.filter,te.layers,te.availableImages,Q);for(const Be in xe){const ge=Ae[Be]=Ae[Be]||[],Me=xe[Be];Me.sort((He,Ge)=>{const nt=Ie.featureSortOrder;if(nt){const dt=nt.indexOf(He.featureIndex);return nt.indexOf(Ge.featureIndex)-dt}return Ge.featureIndex-He.featureIndex});for(const He of Me)ge.push(He)}}for(const Ie in Ae)Ae[Ie].forEach(xe=>{const Be=xe.feature,ge=q(Q[Ie]);if(!ge)return;const Me=ge.getFeatureState(Be.layer["source-layer"],Be.id);Be.source=Be.layer.source,Be.layer["source-layer"]&&(Be.sourceLayer=Be.layer["source-layer"]),Be.state=Me});return Ae}(this._mergedLayers,I,this.getLayerSourceCache.bind(this),P.screenGeometry,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(C)}querySourceFeatures(c,d){d&&d.filter&&this._validate(Gt,"querySourceFeatures.filter",d.filter,null,d);const y=this.getOwnSourceCaches(c);let w=[];for(const C of y)w=w.concat(Fh(C,d));return w}addSourceType(c,d,y){return Mr.getSourceType(c)?y(new Error(`A source type called "${c}" already exists.`)):(Mr.setSourceType(c,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:d.workerSourceURL},y):y(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(c,d,y={}){this._checkLoaded();const w=this.light.getLight();let C=!1;for(const B in c)if(!Ai(c[B],w[B])){C=!0;break}if(!C)return;const I=this._getTransitionParameters();this.light.setLight(c,d,y),this.light.updateTransitions(I)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(c,d=1){if(this._checkLoaded(),!c)return this.terrainSetForDrapingOnly()&&0!==d||delete this.terrain,null===c?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let y=c;const w=null==c.source;if(1===d){if("object"==typeof y.source){const B="terrain-dem-src";this.addSource(B,y.source),y=p.c1(y),y=p.e(y,{source:B})}const C=p.e({},y),I={};if(this.terrain&&w){C.source=this.terrain.get().source;const B=this.terrain?this.getFragmentStyle(this.terrain.scope):null;B&&(I.style=B.serialize())}if(this._validate(_e,"terrain",C,I))return}if(!this.terrain||this.terrain.scope!==this.scope&&!w||this.terrain&&d!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,d),this.fire(new p.b("data",{dataType:"style"}))}else{const C=this.terrain,I=C.get();for(const B of Object.keys(p.D.terrain))!y.hasOwnProperty(B)&&p.D.terrain[B].default&&(y[B]=p.D.terrain[B].default);for(const B in c)if(!Ai(c[B],I[B])){C.set(c,this.options),this.stylesheet.terrain=c;const P=this._getTransitionParameters({duration:0});C.updateTransitions(P),this.fire(new p.b("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(c){const d=this.fog=new Za(c,this.map.transform,this.scope,this.options);this.stylesheet.fog=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog;if(!Ai(d.get(),c)){d.set(c,this.options),this.stylesheet.fog=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}}else this._createFog(c);this._markersNeedUpdate=!0}_getTransitionParameters(c){return{now:p.f.now(),transition:p.e(this.transition,c)}}updateDrapeFirstLayers(){if(!this.terrain)return;const c=[],d=[];for(const y in this._mergedLayers)this.isLayerDraped(this._mergedLayers[y])?c.push(y):d.push(y);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...d)}_createTerrain(c,d){const y=this.terrain=new os(c,d,this.scope,this.options);1===d&&(this.stylesheet.terrain=c),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const w=this._getTransitionParameters({duration:0});y.updateTransitions(w)}_force3DLayerUpdate(){for(const c in this._layers){const d=this._layers[c];"fill-extrusion"===d.type&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const c in this._layers){const d=this._layers[c];"symbol"===d.type&&this._updateLayer(d)}}_validate(c,d,y,w,C={}){if(C&&!1===C.validate)return!1;const I=p.e({},this.serialize());return Zd(this,c.call(_i,p.e({key:d,style:I,value:y,styleSpec:p.D},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),p.c8.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._mergedLayers)this._mergedLayers[c].setEventedParent(null);for(const c in this._mergedSourceCaches)this._mergedSourceCaches[c].clearTiles(),this._mergedSourceCaches[c].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(c){const d=this.getSourceCaches(c);for(const y of d)y.clearTiles()}clearSources(){for(const c in this._mergedSourceCaches)this._mergedSourceCaches[c].clearTiles()}reloadSource(c){const d=this.getSourceCaches(c);for(const y of d)y.resume(),y.reload()}reloadSources(){for(const c of this.getSources())c.reload&&c.reload()}updateSources(c){let d;this.directionalLight&&(d=xp(this.directionalLight));for(const y in this._mergedSourceCaches)this._mergedSourceCaches[y].update(c,void 0,void 0,d)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const d=this._sourceCaches[c];d.resume(),d.reload()}}_updatePlacement(c,d,y,w,C=!1){let I=!1,B=!1;const P={},Q={};for(const j of this._mergedOrder){const q=this._mergedLayers[j];if("symbol"!==q.type)continue;const J=p.ag(q.source,q.scope);let te=P[J];if(!te){const ce=this.getLayerSourceCache(q);if(!ce)continue;const Ae=ce.getRenderableIds(!0).map(se=>ce.getTileByID(se));Q[J]=Ae.slice(),te=P[J]=Ae.sort((se,me)=>me.tileID.overscaledZ-se.tileID.overscaledZ||(se.tileID.isLessThan(me.tileID)?-1:1))}const le=this.crossTileSymbolIndex.addLayer(q,te,c.center.lng,c.projection);I=I||le}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),C=C||this._layerOrderChanged||0===y,this._layerOrderChanged&&this.fire(new p.b("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(p.f.now(),c.zoom))&&(this.pauseablePlacement=new Lc(c,this._mergedOrder,C,d,y,w,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,P,Q),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(p.f.now()),B=!0),I&&this.pauseablePlacement.placement.setStale()),B||I){this._buildingIndex.onNewFrame(c.zoom);for(const j of this._mergedOrder){const q=this._mergedLayers[j];"symbol"===q.type&&this.placement.updateLayerOpacities(q,P[p.ag(q.source,q.scope)])}}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(p.f.now())}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}addImport(c,d){this._checkLoaded();const y=this.stylesheet.imports=this.stylesheet.imports||[];if(-1!==y.findIndex(({id:C})=>C===c.id))return this.fire(new p.a(new Error(`Import with id '${c.id}' already exists in the map's style.`)));if(!d)return y.push(c),this._loadImports([c],!0),this;const w=y.findIndex(({id:C})=>C===d);return-1===w?this.fire(new p.a(new Error(`Import with id "${d}" does not exist on this map.`))):(this.stylesheet.imports=y.slice(0,w).concat(c).concat(y.slice(w)),this._loadImports([c],!0,d),this)}updateImport(c,d){this._checkLoaded();const y=this.stylesheet.imports||[],w=this.getImportIndex(c);return-1===w?this:"string"==typeof d?(this.setImportUrl(c,d),this):(d.url&&d.url!==y[w].url&&this.setImportUrl(c,d.url),Ai(d.config,y[w].config)||this.setImportConfig(c,d.config),Ai(d.data,y[w].data)||this.setImportData(c,d.data),this)}moveImport(c,d){this._checkLoaded();let y=this.stylesheet.imports||[];const w=this.getImportIndex(c);if(-1===w)return this;const C=this.getImportIndex(d);if(-1===C)return this;const I=y[w],B=this.fragments[w];return y=y.filter(({id:P})=>P!==c),this.fragments=this.fragments.filter(({id:P})=>P!==c),this.stylesheet.imports=y.slice(0,C).concat(I).concat(y.slice(C)),this.fragments=this.fragments.slice(0,C).concat(B).concat(this.fragments.slice(C)),this.mergeLayers(),this}setImportUrl(c,d){this._checkLoaded();const y=this.stylesheet.imports||[],w=this.getImportIndex(c);if(-1===w)return this;y[w].url=d;const C=this.fragments[w];return C.style=this._createFragmentStyle(y[w]),C.style.on("style.import.load",()=>this.mergeAll()),C.style.loadURL(d),this}setImportData(c,d){this._checkLoaded();const y=this.getImportIndex(c),w=this.stylesheet.imports||[];return-1===y?this:d?(this.fragments[y].style.setState(d),this._reloadImports(),this):(delete w[y].data,this.setImportUrl(c,w[y].url))}setImportConfig(c,d){this._checkLoaded();const y=this.getImportIndex(c),w=this.stylesheet.imports||[];if(-1===y)return this;d?w[y].config=d:delete w[y].config;const C=this.fragments[y],I=C.style.stylesheet&&C.style.stylesheet.schema;return C.config=d,C.style.setConfig(d,I),this.updateConfigDependencies(),this}removeImport(c){this._checkLoaded();const d=this.stylesheet.imports||[],y=this.getImportIndex(c);return-1===y||(d.splice(y,1),this.fragments[y].style._remove(),this.fragments.splice(y,1),this._reloadImports()),this}getImportIndex(c){const d=(this.stylesheet.imports||[]).findIndex(y=>y.id===c);return-1===d&&this.fire(new p.a(new Error(`Import '${c}' does not exist in the map's style and cannot be updated.`))),d}getLayer(c){return this._mergedLayers[c]}getSources(){const c=[];for(const d in this._mergedOtherSourceCaches){const y=this._mergedOtherSourceCaches[d];y&&c.push(y.getSource())}return c}getSource(c,d){const y=this.getSourceCache(c,d);return y&&y.getSource()}getLayerSource(c){const d=this.getLayerSourceCache(c);return d&&d.getSource()}getSourceCache(c,d){const y=p.ag(c,d);return this._mergedOtherSourceCaches[y]}getLayerSourceCache(c){const d=p.ag(c.source,c.scope);return"symbol"===c.type?this._mergedSymbolSourceCaches[d]:this._mergedOtherSourceCaches[d]}getSourceCaches(c){const d=[];return this._mergedOtherSourceCaches[c]&&d.push(this._mergedOtherSourceCaches[c]),this._mergedSymbolSourceCaches[c]&&d.push(this._mergedSymbolSourceCaches[c]),d}updateSourceCaches(){const c=this._changes.getUpdatedSourceCaches();for(const d in c){const y=c[d];"reload"===y?this.reloadSource(d):"clear"===y&&this.clearSource(d)}}updateLayers(c){const d=this._changes.getUpdatedPaintProperties();for(const y of d){const w=this.getLayer(y);w&&w.updateTransitions(c)}}getImages(c,d,y){this.imageManager.getImages(d.icons,d.scope,y),this._updateTilesForChangedImages();const w=C=>{C&&C.setDependencies(d.tileID.key,d.type,d.icons)};w(this._otherSourceCaches[d.source]),w(this._symbolSourceCaches[d.source])}getGlyphs(c,d,y){this.glyphManager.getGlyphs(d.stacks,d.scope,y)}getResource(c,d,y){return p.c9(d,y)}getOwnSourceCache(c){return this._otherSourceCaches[c]}getOwnLayerSourceCache(c){return"symbol"===c.type?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}getOwnSourceCaches(c){const d=[];return this._otherSourceCaches[c]&&d.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&d.push(this._symbolSourceCaches[c]),d}_isSourceCacheLoaded(c){const d=this.getOwnSourceCaches(c);return 0===d.length?(this.fire(new p.a(new Error(`There is no source with ID '${c}'`))),!1):d.every(y=>y.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(c=>{c.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Mr.getSourceType=function(_){return Vd[_]},Mr.setSourceType=function(_,c){Vd[_]=c},Mr.registerForPluginStateChange=p.bV;var RA="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",Sp="\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color) {\n#ifdef INDICATOR_CUTOUT\nfloat holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif\nvec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}",Hg="\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}",ps="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",a_="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Qg="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Xn="highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {\n#ifdef FOG_DITHERING\nvec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);\n#else\nreturn color;\n#endif\n}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",hl="#ifdef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)\n);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)\n);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",Is="#ifdef RASTER_ARRAY\nuniform sampler2D u_velocity;uniform vec2 u_velocity_res;uniform float u_max_speed;const vec2 INVALID_VELOCITY=vec2(-1);uniform vec2 u_texture_offset;uniform float u_data_offset;uniform vec4 u_data_scale;vec2 lookup_velocity(vec2 uv) {uv=u_texture_offset.x+u_texture_offset.y*uv;vec2 fxy;ivec4 c=_raTexLinearCoord(uv,u_velocity_res,fxy);vec4 tl=texelFetch(u_velocity,c.yz,0);vec4 tr=texelFetch(u_velocity,c.xz,0);vec4 bl=texelFetch(u_velocity,c.yw,0);vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NODATA) {return INVALID_VELOCITY;}if (tr==NODATA) {return INVALID_VELOCITY;}if (bl==NODATA) {return INVALID_VELOCITY;}if (br==NODATA) {return INVALID_VELOCITY;}vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);\n#ifdef DATA_FORMAT_UINT32\nvec2 velocity=vec2(u_data_offset+dot(t,u_data_scale),0);return velocity;\n#else\nvec2 velocity=vec2(u_data_offset+dot(t.rg,u_data_scale.yx),-(u_data_offset+dot(t.ba,u_data_scale.yx)));\n#endif\nreturn velocity/max(u_max_speed,length(velocity));}\n#endif",dl="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",fl="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef NATIVE\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const oh=[];ah(RA,oh),ah(Hg,oh),ah(Sp,oh);const ra={"_prelude_fog.vertex.glsl":Qg,"_prelude_terrain.vertex.glsl":a_,"_prelude_shadow.vertex.glsl":dl,"_prelude_fog.fragment.glsl":Xn,"_prelude_shadow.fragment.glsl":fl,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":hl,"_prelude_raster_particle.glsl":Is},zf={};Zi("",a_),Zi(Xn,Qg),Zi(fl,dl),Zi(hl,""),Zi(Is,"");const Yd=Zi(Sp,Hg),Vf=RA;var l_={background:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:Zi("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Zi('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:Zi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Zi("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:Zi("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Zi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutline:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin highp vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nuniform float u_emissive_strength;in float v_height;void main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat cutoff=1.0;vec3 scaled_pos=pos;\n#ifdef RENDER_CUTOFF\nvec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),fillExtrusionDepth:Zi("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nout vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:Zi('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:Zi("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;\n#endif\nHANDLE_WIREFRAME_DEBUG;\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:Zi("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    \nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),linePattern:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 v_uv;\n#endif\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float pattern_x=v_linesofar/pattern_size.x*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}\n#endif\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_ground(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 a_packed;\n#endif\nin float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nout highp vec4 v_uv;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nfloat a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),raster:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nin float v_split_fade;\n#endif\nuniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;\n#ifdef GLOBE_POLES\ncolor.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);\n#endif\nvec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef PROJECTION_GLOBE_VIEW\nglFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));\n#endif\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nout float v_split_fade;\n#endif\nvoid main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    \nv_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\ngl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),rasterParticle:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\nin vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;vec2 uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\nvec2 uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}'),rasterParticleDraw:Zi("precision highp float;uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",'precision highp float;\n#include "_prelude_raster_array.glsl"\n#include "_prelude_raster_particle.glsl"\nin vec3 a_pos;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {vec2 pos=a_pos.xy+u_tile_offset;vec2 tex_coords=fract(pos);gl_PointSize=1.0;vec2 velocity=lookup_velocity(tex_coords);if (velocity==INVALID_VELOCITY) {v_particle_speed=0.0;gl_Position=vec4(2.0,2.0,2.0,1.0);} else {v_particle_speed=length(velocity);gl_Position=vec4(2.0*pos-vec2(1.0),0.0,1.0);}}'),rasterParticleTexture:Zi("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {v_tex_pos=0.5*a_pos+vec2(0.5);gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Zi("void main() {}",'#include "_prelude_raster_array.glsl"\n#include "_prelude_raster_particle.glsl"\nin vec3 a_pos;uniform float u_speed_factor;uniform float u_lifetime_delta;uniform float u_rand_seed;out vec3 v_new_particle;const vec3 rand_constants=vec3(12.9898,78.233,4375.85453);float rand(const vec2 co) {float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {float lifetime=a_pos.z;vec2 pos=a_pos.xy;vec2 uv=clamp(pos,vec2(0.0),vec2(1.0));vec2 velocity=lookup_velocity(uv);float next_lifetime=lifetime-u_lifetime_delta;float t=step(0.0,next_lifetime);\n#ifdef DATA_FORMAT_UINT32\nvec2 dp=vec2(0);\n#else\nvec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;\n#endif\nvec2 seed=pos*u_rand_seed;vec2 next_pos=pos+dp;vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));v_new_particle=vec3(\nvec2(mix(random_pos,next_pos,t)),mix(1.0,next_lifetime,t)\n);}'),symbolIcon:Zi('#include "_prelude_lighting.glsl"\nuniform sampler2D u_texture;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\nin float v_fade_opacity;in vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\nuniform mediump float u_icon_saturation;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nlowp float alpha=opacity*v_fade_opacity;vec4 out_color;\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;\n#else\nout_color=texture(u_texture,v_tex_a)*alpha;\n#endif\n#ifdef SATURATION\nvec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nv_tex_a=a_tex/u_texsize;\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\nv_fade_opacity=out_fade_opacity;}'),symbolSDF:Zi('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\nuniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}'),symbolTextAndIcon:Zi('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nfloat out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}'),terrainRaster:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);\n#endif\n}'),terrainDepth:Zi("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:Zi('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',ps),skyboxGradient:Zi('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',ps),skyboxCapture:Zi("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:Zi('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;\n#ifndef NATIVE\nc=dither(c,gl_FragCoord.xy+u_temporal_offset);\n#endif\nglFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:Zi('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nuniform vec4 u_occlusionTextureTransform;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\nif(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}\n#endif\nreturn vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nvec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;\n#else\nvec2 uv=uv_2f;\n#endif\nao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 shadow_pos=local_pos;\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:Zi("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:Zi("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}")};function ah(_,c){const d=_.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let y of d)if(y=y.trim(),"#"===y[0]&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=y.split(" ");for(const C of w)c.includes(C)||c.push(C)}}function Zi(_,c){const d=/#include\s+"([^"]+)"/g,y=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let w=c.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);w&&(w=w.map(Q=>{const j=Q.split(" ");return j[j.length-1]}),w=[...new Set(w)]);const C={},I=[],B=[];if(_=_.replace(d,(Q,j)=>(B.push(j),"")),(c=c.replace(d,(Q,j)=>(I.push(j),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let P=[...oh];ah(_,P),ah(c,P);for(const Q of[...I,...B])ra[Q]||console.error(`Undefined include: ${Q}`),zf[Q]||(zf[Q]=[],ah(ra[Q],zf[Q])),P=[...P,...zf[Q]];return{fragmentSource:_=_.replace(y,(Q,j,q,J,te)=>(C[te]=!0,"define"===j?`\n#ifndef HAS_UNIFORM_u_${te}\nin ${q} ${J} ${te};\n#else\nuniform ${q} ${J} u_${te};\n#endif\n`:"initialize"===j?`\n#ifdef HAS_UNIFORM_u_${te}\n    ${q} ${J} ${te} = u_${te};\n#endif\n`:"define-attribute"===j?`\n#ifdef HAS_ATTRIBUTE_a_${te}\n    in ${q} ${J} ${te};\n#endif\n`:"initialize-attribute"===j?"":void 0)),vertexSource:c=c.replace(y,(Q,j,q,J,te)=>{const le="float"===J?"vec2":J,ce=te.match(/color/)?"color":le;return"define-attribute-vertex-shader-only"===j?`\n#ifdef HAS_ATTRIBUTE_a_${te}\nin ${q} ${J} a_${te};\n#endif\n`:C[te]?"define"===j?`\n#ifndef HAS_UNIFORM_u_${te}\nuniform lowp float u_${te}_t;\nin ${q} ${le} a_${te};\nout ${q} ${J} ${te};\n#else\nuniform ${q} ${J} u_${te};\n#endif\n`:"initialize"===j?"vec4"===ce?`\n#ifndef HAS_UNIFORM_u_${te}\n    ${te} = a_${te};\n#else\n    ${q} ${J} ${te} = u_${te};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${te}\n    ${te} = unpack_mix_${ce}(a_${te}, u_${te}_t);\n#else\n    ${q} ${J} ${te} = u_${te};\n#endif\n`:"define-attribute"===j?`\n#ifdef HAS_ATTRIBUTE_a_${te}\n    in ${q} ${J} a_${te};\n    out ${q} ${J} ${te};\n#endif\n`:"initialize-attribute"===j?`\n#ifdef HAS_ATTRIBUTE_a_${te}\n    ${te} = a_${te};\n#endif\n`:void 0:"define"===j?`\n#ifndef HAS_UNIFORM_u_${te}\nuniform lowp float u_${te}_t;\nin ${q} ${le} a_${te};\n#else\nuniform ${q} ${J} u_${te};\n#endif\n`:"define-instanced"===j?"mat4"===ce?`\n#ifdef INSTANCED_ARRAYS\nin vec4 a_${te}0;\nin vec4 a_${te}1;\nin vec4 a_${te}2;\nin vec4 a_${te}3;\n#else\nuniform ${q} ${J} u_${te};\n#endif\n`:`\n#ifdef INSTANCED_ARRAYS\nin ${q} ${le} a_${te};\n#else\nuniform ${q} ${J} u_${te};\n#endif\n`:"initialize-attribute-custom"===j?`\n#ifdef HAS_ATTRIBUTE_a_${te}\n    ${q} ${J} ${te} = a_${te};\n#endif\n`:"vec4"===ce?`\n#ifndef HAS_UNIFORM_u_${te}\n    ${q} ${J} ${te} = a_${te};\n#else\n    ${q} ${J} ${te} = u_${te};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${te}\n    ${q} ${J} ${te} = unpack_mix_${ce}(a_${te}, u_${te}_t);\n#else\n    ${q} ${J} ${te} = u_${te};\n#endif\n`}),staticAttributes:w,usedDefines:P,vertexIncludes:I,fragmentIncludes:B}}class Oi{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(c,d,y,w,C,I,B,P){this.context=c;let Q=this.boundPaintVertexBuffers.length!==w.length;for(let q=0;!Q&&q<w.length;q++)this.boundPaintVertexBuffers[q]!==w[q]&&(Q=!0);let j=this.boundDynamicVertexBuffers.length!==B.length;for(let q=0;!j&&q<B.length;q++)this.boundDynamicVertexBuffers[q]!==B[q]&&(j=!0);if(!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==y||Q||j||this.boundIndexBuffer!==C||this.boundVertexOffset!==I)this.freshBind(d,y,w,C,I,B,P);else{c.bindVertexArrayOES.set(this.vao);for(const q of B)q&&(q.bind(),P&&q.instanceCount&&q.setVertexAttribDivisor(c.gl,d,P));C&&C.dynamicDraw&&C.bind()}}freshBind(c,d,y,w,C,I,B){const P=c.numAttributes,Q=this.context,j=Q.gl;this.vao&&this.destroy(),this.vao=Q.gl.createVertexArray(),Q.bindVertexArrayOES.set(this.vao),this.boundProgram=c,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=w,this.boundVertexOffset=C,this.boundDynamicVertexBuffers=I,d.enableAttributes(j,c),d.bind(),d.setVertexAttribPointers(j,c,C);for(const q of y)q.enableAttributes(j,c),q.bind(),q.setVertexAttribPointers(j,c,C);for(const q of I)q&&(q.enableAttributes(j,c),q.bind(),q.setVertexAttribPointers(j,c,C),B&&q.instanceCount&&q.setVertexAttribDivisor(j,c,B));w&&w.bind(),Q.currentNumAttributes=P}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function gs(_,c){const d=Math.pow(2,c.canonical.z),y=c.canonical.y;return[new p.L(0,y/d).toLngLat().lat,new p.L(0,(y+1)/d).toLngLat().lat]}function Wo(_,c,d,y,w,C,I){const B=_.context,P=B.gl,Q=d.hillshadeFBO;if(!Q)return;_.prepareDrawTile();const j=_.isTileAffectedByFog(c),q=_.getOrCreateProgram("hillshade",{overrideFog:j});B.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,Q.colorAttachment.get());const J=((Ae,se,me,Ie)=>{const xe=me.paint.get("hillshade-shadow-color"),Be=me.paint.get("hillshade-highlight-color"),ge=me.paint.get("hillshade-accent-color"),Me=me.paint.get("hillshade-emissive-strength");let He=p.bj(me.paint.get("hillshade-illumination-direction"));if("viewport"===me.paint.get("hillshade-illumination-anchor"))He-=Ae.transform.angle;else if(Ae.style&&Ae.style.enable3dLights()&&Ae.style.directionalLight){const nt=Ae.style.directionalLight.properties.get("direction"),dt=p.bQ(nt.x,nt.y,nt.z);He=p.bj(dt[1])}const Ge=!Ae.options.moving;return{u_matrix:Ie||Ae.transform.calculateProjMatrix(se.tileID.toUnwrapped(),Ge),u_image:0,u_latrange:gs(0,se.tileID),u_light:[me.paint.get("hillshade-exaggeration"),He],u_shadow:xe,u_highlight:Be,u_emissive_strength:Me,u_accent:ge}})(_,d,y,_.terrain?c.projMatrix:null);_.uploadCommonUniforms(B,q,c.toUnwrapped());const{tileBoundsBuffer:te,tileBoundsIndexBuffer:le,tileBoundsSegments:ce}=_.getTileBoundsBuffers(d);q.draw(_,P.TRIANGLES,w,C,I,Ri.disabled,J,y.id,te,le,ce)}function pc(_,c,d){if(!c.needsDEMTextureUpload)return;const y=_.context,w=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||_.getTileTexture(d.stride);const C=d.getPixels();c.demTexture?c.demTexture.update(C,{premultiply:!1}):c.demTexture=new p.T(y,C,w.R32F,{premultiply:!1}),c.needsDEMTextureUpload=!1}function Hf(_,c,d){const y=_.context,w=y.gl;if(!c.dem)return;const C=c.dem;if(y.activeTexture.set(w.TEXTURE1),pc(_,c,C),!c.demTexture)return;c.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);const I=C.dim;y.activeTexture.set(w.TEXTURE0);let B=c.hillshadeFBO;if(!B){const J=new p.T(y,{width:I,height:I,data:null},w.RGBA);J.bind(w.LINEAR,w.CLAMP_TO_EDGE),B=c.hillshadeFBO=y.createFramebuffer(I,I,!0,"renderbuffer"),B.colorAttachment.set(J.texture)}y.bindFramebuffer.set(B.framebuffer),y.viewport.set([0,0,I,I]);const{tileBoundsBuffer:P,tileBoundsIndexBuffer:Q,tileBoundsSegments:j}=_.getMercatorTileBoundsBuffers(),q=[];_.linearFloatFilteringSupported()&&q.push("TERRAIN_DEM_FLOAT_FORMAT"),_.getOrCreateProgram("hillshadePrepare",{defines:q}).draw(_,w.TRIANGLES,kn.disabled,or.disabled,Tr.unblended,Ri.disabled,((J,te)=>{const le=te.stride,ce=p.a6.create();return p.a6.ortho(ce,0,p.V,-p.V,0,0,1),p.a6.translate(ce,ce,[0,-p.V,0]),{u_matrix:ce,u_image:1,u_dimension:[le,le],u_zoom:J.overscaledZ}})(c.tileID,C),d.id,P,Q,j),c.needsHillshadePrepare=!1}const jl=_=>({u_matrix:new p.bK(_),u_image0:new p.bO(_),u_skirt_height:new p.bN(_),u_ground_shadow_factor:new p.bM(_)}),pd=(_,c,d)=>({u_matrix:_,u_image0:0,u_skirt_height:c,u_ground_shadow_factor:d}),Da=(_,c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:c,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:d,u_zoom_transition:w,u_merc_center:C,u_image0:0,u_frustum_tl:I,u_frustum_tr:B,u_frustum_br:P,u_frustum_bl:Q,u_globe_pos:j,u_globe_radius:q,u_viewport:J,u_grid_matrix:ce?Float32Array.from(ce):new Float32Array(9),u_skirt_height:te,u_far_z_cutoff:le});function gc(_,c){return null!=_&&null!=c&&!(!_.hasData()||!c.hasData())&&null!=_.demTexture&&null!=c.demTexture&&_.tileID.key!==c.tileID.key}const lh=new class{constructor(){this.operations={}}newMorphing(_,c,d,y,w){if(_ in this.operations){const C=this.operations[_];C.to.tileID.key!==d.tileID.key&&(C.queued=d)}else this.operations[_]={startTime:y,phase:0,duration:w,from:c,to:d,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const c=this.operations[_];return{from:c.from,to:c.to,phase:c.phase}}update(_){for(const c in this.operations){const d=this.operations[c];for(d.phase=(_-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,_)){delete this.operations[c];break}}}_nextOp(_,c){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=c,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},Zr={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Qf(_,c,d){if(0===c)return 0;const y=c<1&&514===d?.25/c:1;return 6*Math.pow(1.5,22-_)*Math.max(c,1)*y}function jf(_,c){const d=1<<_.z;return!c&&(0===_.x||_.x===d-1)||0===_.y||_.y===d-1}const ch=_=>({u_matrix:_});function ba(_,c,d,y,w){if(w>0){const C=p.f.now(),I=(C-_.timeAdded)/w,B=c?(C-c.timeAdded)/w:-1,P=d.getSource(),Q=y.coveringZoomLevel({tileSize:P.tileSize,roundZoom:P.roundZoom}),j=!c||Math.abs(c.tileID.overscaledZ-Q)>Math.abs(_.tileID.overscaledZ-Q),q=j&&_.refreshedUponExpiration?1:p.aa(j?I:1-B,0,1);return _.refreshedUponExpiration&&I>=1&&(_.refreshedUponExpiration=!1),c?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}class Tp extends Rh{constructor(c){const d={type:"raster-dem",maxzoom:c.transform.maxZoom},y=new p.bW(p.bX(),null),w=ka("mock-dem",d,y,c.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(c,d){c.state="loaded",d(null)}}class OA extends Rh{constructor(c){const d=ka("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new p.bW(p.bX(),null),c.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,d,y){if(c.freezeTileCoverage)return;this.transform=c;const w=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((C,I)=>{if(C[I.key]="",!this._tiles[I.key]){const B=new Rf(I,this._source.tileSize*I.overscaleFactor(),c.tileZoom);B.state="loaded",this._tiles[I.key]=B}return C},{});for(const C in this._tiles)C in w||(this.freeFBO(C),this._tiles[C].unloadVectorData(),delete this._tiles[C])}freeFBO(c){const d=this.proxyCachedFBO[c];if(void 0!==d){const y=Object.values(d);this.renderCachePool.push(...y),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class uh extends p.am{constructor(c,d,y){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=d,this.projMatrix=y}}class Ip extends p.ck{constructor(c,d){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},c.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),c.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),c.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,w,C]=function(P){const Q=new p.aN,j=new p.aw,q=131;Q.reserve(17161),j.reserve(33800);const J=p.V/128,te=p.V+J/2,le=te+J;for(let Ae=-J;Ae<le;Ae+=J)for(let se=-J;se<le;se+=J){const me=se<0||se>te||Ae<0||Ae>te?24575:0,Ie=p.aa(Math.round(se),0,p.V),xe=p.aa(Math.round(Ae),0,p.V);Q.emplaceBack(Ie+me,xe)}const ce=(Ae,se)=>{const me=se*q+Ae;j.emplaceBack(me+1,me,me+q),j.emplaceBack(me+q,me+q+1,me+1)};for(let Ae=1;Ae<129;Ae++)for(let se=1;se<129;se++)ce(se,Ae);return[0,129].forEach(Ae=>{for(let se=0;se<130;se++)ce(se,Ae),ce(Ae,se)}),[Q,j,32768]}(),I=c.context;this.gridBuffer=I.createVertexBuffer(y,p.aP.members),this.gridIndexBuffer=I.createIndexBuffer(w),this.gridSegments=p.aB.simpleSegment(0,0,y.length,w.length),this.gridNoSkirtSegments=p.aB.simpleSegment(0,0,y.length,C),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new OA(d.map),this.orthoMatrix=p.a6.create(),p.a6.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,p.V,0,p.V,0,1);const B=I.gl;this._overlapStencilMode=new or({func:B.GEQUAL,mask:255},0,255,B.KEEP,B.KEEP,B.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Tp(d.map),this._pendingGroundEffectLayers=[]}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),this._style=c,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(c,d,y){if(c&&c.terrain){this._style!==c&&(this.style=c,this._evaluationZoom=void 0);const w=c.terrain.properties,C=0===c.terrain.drapeRenderMode,I=c.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=p.f.now();const B=c.terrain&&c.terrain.scope,P=w.get("source"),Q=C?this._mockSourceCache:c.getSourceCache(P,B);if(!Q)return void p.w(`Couldn't find terrain source "${P}".`);if(this.sourceCache=Q,this._exaggeration=I?this.calculateExaggeration(d):w.get("exaggeration"),!d.projection.requiresDraping&&I&&0===this._exaggeration)return void this._disable();this.enabled=!0;const j=()=>{this.sourceCache.used&&p.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const q=this.getScaledDemTileSize();this.sourceCache.update(d,q,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,j(),this._initializing=!0),j(),d.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0,this._previousZoom=d.zoom}else this._disable()}calculateExaggeration(c){const d=this._previousCameraAltitude,y=c.getFreeCameraOptions().position.z/c.pixelsPerMeter*c.worldSize;this._previousCameraAltitude=y;const w=null!=d?y-d:Number.MAX_VALUE;if(Math.abs(w)<2)return this._exaggeration;const C=c.zoom,I=this._style.terrain;if(!this._previousUpdateTimestamp)return I.getExaggeration(C);let B=C-this._previousZoom;const P=this._previousUpdateTimestamp;let Q=C;null!=this._evaluationZoom&&(Q=this._evaluationZoom,Math.abs(C-Q)>.5&&(B=.5*(C-Q+B)),B*w<0&&(Q+=B)),this._evaluationZoom=Q;const j=I.getExaggeration(Q),q=j===I.getExaggeration(Math.max(0,Q-.1));if(q&&Math.abs(j-this._exaggeration)<.01)return j;let J=Math.min(.1,.00375*(this._updateTimestamp-P));return(q||j<.1||Math.abs(B)<1e-4)&&(J=Math.min(.2,4*J)),p.U(this._exaggeration,j,J)}resetTileLookupCache(c){this._findCoveringTileCache[c]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(c){c.coord&&"source"===c.dataType?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):"style"===c.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._mergedSourceCaches)this._style._mergedSourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=0===y._centerAltitude&&-1===this.getAtPointOrZero(p.L.fromLngLat(y.center),-1),this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=d.getIds().map(P=>{const Q=d.getTileByID(P).tileID;return Q.projMatrix=y.calculateProjMatrix(Q.toUnwrapped()),Q});!function(P,Q){const j=Q.transform.pointCoordinate(Q.transform.getCameraPoint()),q=new p.P(j.x,j.y);P.sort((J,te)=>{if(te.overscaledZ-J.overscaledZ)return te.overscaledZ-J.overscaledZ;const le=new p.P(J.canonical.x+(1<<J.canonical.z)*J.wrap,J.canonical.y),ce=new p.P(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),Ae=q.mult(1<<J.canonical.z);return Ae.x-=.5,Ae.y-=.5,Ae.distSqr(le)-Ae.distSqr(ce)})}(w,this.painter);const C=this.proxyToSource||{};this.proxyToSource={},w.forEach(P=>{this.proxyToSource[P.key]={}}),this.terrainTileForTile={};const I=this._style._mergedSourceCaches;for(const P in I){const Q=I[P];if(!Q.used||(Q!==this.sourceCache&&this.resetTileLookupCache(Q.id),this._setupProxiedCoordsForOrtho(Q,c[P],C),Q.usedForTerrain))continue;const j=c[P];Q.getSource().reparseOverscaled&&this._assignTerrainTiles(j)}this.proxiedCoords[d.id]=w.map(P=>new uh(P,P.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(C),this.renderingToTexture=!1;const B={};this._visibleDemTiles=[];for(const P of this.proxyCoords){const Q=this.terrainTileForTile[P.key];if(!Q)continue;const j=Q.tileID.key;j in B||(this._visibleDemTiles.push(Q),B[j]=j)}}_assignTerrainTiles(c){this._initializing||c.forEach(d=>{if(this.terrainTileForTile[d.key])return;const y=this._findTileCoveringTileID(d,this.sourceCache);y&&(this.terrainTileForTile[d.key]=y)})}_prepareDEMTextures(){const c=this.painter.context,d=c.gl;for(const y in this.terrainTileForTile){const w=this.terrainTileForTile[y],C=w.dem;!C||w.demTexture&&!w.needsDEMTextureUpload||(c.activeTexture.set(d.TEXTURE1),pc(this.painter,w,C))}}_prepareDemTileUniforms(c,d,y,w){if(!d||null==d.demTexture)return!1;const C=c.tileID.canonical,I=Math.pow(2,d.tileID.canonical.z-C.z),B=w||"";return y[`u_dem_tl${B}`]=[C.x*I%1,C.y*I%1],y[`u_dem_scale${B}`]=I,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const c=this.painter.context,d=c.gl;if(!this._emptyDepthBufferTexture){const y=new p.h({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new p.T(c,y,d.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let c=0;const d=this._visibleDemTiles.reduce((y,w)=>{if(!w.dem)return y;const C=w.dem.tree.minimums[0];return C>0&&c++,y+C},0);return c?d/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,d=c.gl;c.activeTexture.set(d.TEXTURE2);const y=this._getLoadedAreaMinimum(),[w,C]=(()=>{const B=new p.cm({width:1,height:1},new Float32Array([y]));return[d.R32F,B]})();this._emptyDEMTextureDirty=!1;let I=this._emptyDEMTexture;return I?I.update(C,{premultiply:!1}):I=this._emptyDEMTexture=new p.T(c,C,w,{premultiply:!1}),I}setupElevationDraw(c,d,y){const w=this.painter.context,C=w.gl,I={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};I.u_exaggeration=this.exaggeration();let B=null,P=null,Q=1;if(y&&y.morphing&&this._useVertexMorphing){const J=y.morphing.srcDemTile,te=y.morphing.dstDemTile;Q=y.morphing.phase,J&&te&&(this._prepareDemTileUniforms(c,J,I,"_prev")&&(P=J),this._prepareDemTileUniforms(c,te,I)&&(B=te))}const j=J=>J&&J.demTexture&&this.painter.linearFloatFilteringSupported()?C.LINEAR:C.NEAREST,q=J=>{I.u_dem_size=1===J.size[0]?1:J.size[0]-2};if(P&&B)w.activeTexture.set(C.TEXTURE2),B.demTexture.bind(j(B),C.CLAMP_TO_EDGE),w.activeTexture.set(C.TEXTURE4),P.demTexture.bind(j(P),C.CLAMP_TO_EDGE),B.demTexture&&q(B.demTexture),I.u_dem_lerp=Q;else{B=this.terrainTileForTile[c.tileID.key],w.activeTexture.set(C.TEXTURE2);const J=this._prepareDemTileUniforms(c,B,I)?B.demTexture:this.emptyDEMTexture;J.bind(j(B),C.CLAMP_TO_EDGE),q(J)}if(w.activeTexture.set(C.TEXTURE3),y&&y.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),this._depthFBO&&(I.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),I.u_depth_size_inv=[1,1]),y&&y.useMeterToDem&&B){const J=(1<<B.tileID.canonical.z)*p.bl(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;I.u_meter_to_dem=J}if(y&&y.labelPlaneMatrixInv&&(I.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),d.setTerrainUniformValues(w,I),"globe"===this.painter.transform.projection.name){const J=this.globeUniformValues(this.painter.transform,c.tileID.canonical,y&&y.useDenormalizedUpVectorScale);d.setGlobeUniformValues(w,J)}}globeUniformValues(c,d,y){const w=c.projection;return{u_tile_tl_up:w.upVector(d,0,0),u_tile_tr_up:w.upVector(d,p.V,0),u_tile_br_up:w.upVector(d,p.V,p.V),u_tile_bl_up:w.upVector(d,0,p.V),u_tile_up_scale:y?p.cl(1):w.upVectorScale(d,c.center.lat,c.worldSize).metersToTile}}renderToBackBuffer(c){const d=this.painter,y=this.painter.context;0!==c.length&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,C,I,B,P){if("globe"===w.transform.projection.name)!function(Q,j,q,J,te){const le=Q.context,ce=le.gl;let Ae,se;const me=Q.transform,Ie=p.cd(Q,le,me),xe=(Pt,Rt)=>{if(se===Rt)return;const cn=[Zr[Rt],"PROJECTION_GLOBE_VIEW"];Ie&&cn.push("CUSTOM_ANTIALIASING");const ct=Q.isTileAffectedByFog(Pt);Ae=Q.getOrCreateProgram("globeRaster",{defines:cn,overrideFog:ct}),se=Rt},Be=Q.colorModeForRenderPass(),ge=new kn(ce.LEQUAL,kn.ReadWrite,Q.depthRangeFor3D);lh.update(te);const Me=p.ce(me),He=[p.a5(me.center.lng),p.ae(me.center.lat)],Ge=Q.globeSharedBuffers,nt=[me.width*p.f.devicePixelRatio,me.height*p.f.devicePixelRatio],dt=Float32Array.from(me.globeMatrix),ot={useDenormalizedUpVectorScale:!0};{const Pt=Q.transform,Rt=Qf(Pt.zoom,j.exaggeration(),j.sourceCache._source.tileSize);se=-1;const cn=ce.TRIANGLES;for(const ct of J){const St=q.getTile(ct),Ze=or.disabled,gt=j.prevTerrainTileForTile[ct.key],An=j.terrainTileForTile[ct.key];gc(gt,An)&&lh.newMorphing(ct.key,gt,An,te,250),le.activeTexture.set(ce.TEXTURE0),St.texture&&St.texture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const Tn=lh.getMorphValuesForProxy(ct.key),Cn=Tn?1:0;Tn&&p.j(ot,{morphing:{srcDemTile:Tn.from,dstDemTile:Tn.to,phase:p.cc(Tn.phase)}});const $n=p.cf(ct.canonical),li=p.cg($n.getCenter().lat),xi=p.ch(ct.canonical,$n,li,Pt.worldSize/Pt._pixelsPerMercatorPixel),yi=p.aT(p.ci(ct.canonical)),ci=Da(Pt.expandedFarZProjMatrix,dt,Me,yi,p.S(Pt.zoom),He,Pt.frustumCorners.TL,Pt.frustumCorners.TR,Pt.frustumCorners.BR,Pt.frustumCorners.BL,Pt.globeCenterInViewSpace,Pt.globeRadius,nt,Rt,Pt._farZ,xi);if(xe(ct,Cn),Ae&&(j.setupElevationDraw(St,Ae,ot),Q.uploadCommonUniforms(le,Ae,ct.toUnwrapped()),Ge)){const[gr,Ki,lr]=Ge.getGridBuffers(li,0!==Rt);Ae.draw(Q,cn,ge,Ze,Be,Ri.backCCW,ci,"globe_raster",gr,Ki,lr)}}}if(Ge&&(Q.renderDefaultNorthPole||Q.renderDefaultSouthPole)){const Pt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ie&&Pt.push("CUSTOM_ANTIALIASING"),Ae=Q.getOrCreateProgram("globeRaster",{defines:Pt});for(const Rt of J){const{x:cn,y:ct,z:St}=Rt.canonical,Ze=0===ct,gt=ct===(1<<St)-1,[An,Tn,Cn,$n]=Ge.getPoleBuffers(St,!1);if($n&&(Ze||gt)){const li=q.getTile(Rt);le.activeTexture.set(ce.TEXTURE0),li.texture&&li.texture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);let xi=p.cj(St,cn,me);const yi=p.aT(p.ci(Rt.canonical)),ci=(gr,Ki)=>gr.draw(Q,ce.TRIANGLES,ge,or.disabled,Be,Ri.disabled,Da(me.expandedFarZProjMatrix,xi,xi,yi,0,He,me.frustumCorners.TL,me.frustumCorners.TR,me.frustumCorners.BR,me.frustumCorners.BL,me.globeCenterInViewSpace,me.globeRadius,nt,0,me._farZ),"globe_pole_raster",Ki,Cn,$n);j.setupElevationDraw(li,Ae,ot),Q.uploadCommonUniforms(le,Ae,Rt.toUnwrapped()),Ze&&Q.renderDefaultNorthPole&&ci(Ae,An),gt&&Q.renderDefaultSouthPole&&(xi=p.a6.scale(p.a6.create(),xi,[1,-1,1]),ci(Ae,Tn))}}}}(w,C,I,B,P);else{const Q=w.context,j=Q.gl;let q,J;const te=w.shadowRenderer,le=sh(w,w.longestCutoffRange),ce=Be=>{if(J===Be)return;const ge=[];ge.push(Zr[Be]),le.shouldRenderCutoff&&ge.push("RENDER_CUTOFF"),q=w.getOrCreateProgram("terrainRaster",{defines:ge}),J=Be},Ae=w.colorModeForRenderPass(),se=new kn(j.LEQUAL,kn.ReadWrite,w.depthRangeFor3D);lh.update(P);const me=w.transform,Ie=Qf(me.zoom,C.exaggeration(),C.sourceCache._source.tileSize);let xe=[0,0,0];if(te){const Be=w.style.directionalLight,ge=w.style.ambientLight;Be&&ge&&(xe=Cp(Be,ge))}{J=-1;const Be=j.TRIANGLES,[ge,Me]=[C.gridIndexBuffer,C.gridSegments];for(const He of B){const Ge=I.getTile(He),nt=or.disabled,dt=C.prevTerrainTileForTile[He.key],ot=C.terrainTileForTile[He.key];gc(dt,ot)&&lh.newMorphing(He.key,dt,ot,P,250),Q.activeTexture.set(j.TEXTURE0),Ge.texture&&Ge.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const Pt=lh.getMorphValuesForProxy(He.key),Rt=Pt?1:0;let cn;Pt&&(cn={morphing:{srcDemTile:Pt.from,dstDemTile:Pt.to,phase:p.cc(Pt.phase)}});const ct=pd(He.projMatrix,jf(He.canonical,me.renderWorldCopies)?Ie/10:Ie,xe);if(ce(Rt),!q)continue;C.setupElevationDraw(Ge,q,cn);const St=He.toUnwrapped();te&&te.setupShadows(St,q),w.uploadCommonUniforms(Q,q,St,null,le),q.draw(w,Be,se,nt,Ae,Ri.backCCW,ct,"terrain_raster",C.gridBuffer,ge,Me)}}}}(d,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),c.splice(0,c.length))}renderBatch(c){if(0===this._drapedRenderBatches.length)return c+1;this.renderingToTexture=!0;const d=this.painter,y=this.painter.context,w=this.proxySourceCache,C=this.proxiedCoords[w.id],I=this._drapedRenderBatches.shift(),B=d.style.order,P=[];let Q=0;for(const j of C){const q=w.getTileByID(j.proxyTileKey),J=w.proxyCachedFBO[j.key]?w.proxyCachedFBO[j.key][c]:void 0,te=void 0!==J?w.renderCache[J]:this.pool[Q++],le=void 0!==J;if(q.texture=te.tex,le&&!te.dirty){P.push(q.tileID);continue}let ce;y.bindFramebuffer.set(te.fb.framebuffer),this.renderedToTile=!1,te.dirty&&(y.clear({color:p.ax.transparent,stencil:0}),te.dirty=!1);for(let Ae=I.start;Ae<=I.end;++Ae){const se=d.style._mergedLayers[B[Ae]];if(se.isHidden(d.transform.zoom))continue;const me=d.style.getLayerSourceCache(se),Ie=me?this.proxyToSource[j.key][me.id]:[j];if(!Ie)continue;const xe=Ie;y.viewport.set([0,0,te.fb.width,te.fb.height]),ce!==(me?me.id:null)&&(this._setupStencil(te,Ie,se,me),ce=me?me.id:null),d.renderLayer(d,me,se,xe)}if(0===this._drapedRenderBatches.length)for(const Ae of this._pendingGroundEffectLayers){const se=d.style._mergedLayers[B[Ae]];if(se.isHidden(d.transform.zoom))continue;const me=d.style.getLayerSourceCache(se),Ie=me?this.proxyToSource[j.key][me.id]:[j];if(!Ie)continue;const xe=Ie;y.viewport.set([0,0,te.fb.width,te.fb.height]),ce!==(me?me.id:null)&&(this._setupStencil(te,Ie,se,me),ce=me?me.id:null),d.renderLayer(d,me,se,xe)}this.renderedToTile?(te.dirty=!0,P.push(q.tileID)):le||--Q,5===Q&&(Q=0,this.renderToBackBuffer(P))}return this.renderToBackBuffer(P),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,d.width,d.height]),I.end+1}postRender(){}isLayerOrderingCorrect(c){const d=c.order.length;let y=-1,w=d;for(let C=0;C<d;++C)this._style.isLayerDraped(c._mergedLayers[c.order[C]])?y=Math.max(y,C):w=Math.min(w,C);return w>y}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{c=Math.min(c,d.dem.tree.minimums[0])}),0===c?c:(c-30)*this._exaggeration}raycast(c,d,y){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(C=>C.dem).map(C=>{const I=C.tileID,B=1<<I.overscaledZ,{x:P,y:Q}=I.canonical,j=P/B,q=(P+1)/B,J=Q/B,te=(Q+1)/B;return{minx:j,miny:J,maxx:q,maxy:te,t:C.dem.tree.raycastRoot(j,J,q,te,c,d,y),tile:C}});w.sort((C,I)=>(null!==C.t?C.t:Number.MAX_VALUE)-(null!==I.t?I.t:Number.MAX_VALUE));for(const C of w){if(null==C.t)return null;const I=C.tile.dem.tree.raycast(C.minx,C.miny,C.maxx,C.maxy,c,d,y);if(null!=I)return I}return null}_createFBO(){const c=this.painter.context,d=c.gl,y=this.drapeBufferSize;c.activeTexture.set(d.TEXTURE0);const w=new p.T(c,{width:y[0],height:y[1],data:null},d.RGBA);w.bind(d.LINEAR,d.CLAMP_TO_EDGE);const C=c.createFramebuffer(y[0],y[1],!0,null);return C.colorAttachment.set(w.texture),C.depthAttachment=new ln(c,C.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,C.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):C.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:C,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const c in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const d=this._style._mergedLayers[c],y=d.isHidden(this.painter.transform.zoom);return"custom"===d.type?!y&&d.shouldRedrape():!y&&d.hasTransition()})}_clearLineLayersFromRenderCache(){let c=!1;for(const y of this._style.getSources())if(y instanceof gn){c=!0;break}if(!c)return;const d={};for(let y=0;y<this._style.order.length;++y){const w=this._style._mergedLayers[this._style.order[y]],C=this._style.getLayerSourceCache(w);if(C&&!d[C.id]&&!w.isHidden(this.painter.transform.zoom)&&"line"===w.type&&w.widthExpression()instanceof p.Z){d[C.id]=!0;for(const I of this.proxyCoords){const B=this.proxyToSource[I.key][C.id];if(B)for(const P of B)this._clearRenderCacheForTile(C.id,P)}}}}_clearRasterLayersFromRenderCache(){let c=!1;for(const y in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[y]._source instanceof Gn){c=!0;break}if(!c)return;const d={};for(let y=0;y<this._style.order.length;++y){const w=this._style._mergedLayers[this._style.order[y]],C=this._style.getLayerSourceCache(w);if(!C||d[C.id]||w.isHidden(this.painter.transform.zoom)||"raster"!==w.type)continue;const I=w.paint.get("raster-fade-duration");for(const B of this.proxyCoords){const P=this.proxyToSource[B.key][C.id];if(P)for(const Q of P){const j=ba(C.getTile(Q),C.findLoadedParent(Q,0),C,this.painter.transform,I);(1!==j.opacity||0!==j.mix)&&this._clearRenderCacheForTile(C.id,Q)}}}}_setupDrapedRenderBatches(){const c=this._style.order,d=c.length;if(0===d)return;const y=[];this._pendingGroundEffectLayers=[];let w,C=0,I=this._style._mergedLayers[c[C]];for(;!this._style.isLayerDraped(I)&&I.isHidden(this.painter.transform.zoom)&&++C<d;)I=this._style._mergedLayers[c[C]];for(;C<d;++C){const B=this._style._mergedLayers[c[C]];B.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(B)?void 0===w&&(w=C):("fill-extrusion"===B.type&&this._pendingGroundEffectLayers.push(C),void 0!==w&&(y.push({start:w,end:C-1}),w=void 0)))}if(void 0!==w&&y.push({start:w,end:C-1}),0!==y.length){const B=y[y.length-1];this._pendingGroundEffectLayers.every(P=>P>B.end)||p.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=y}_setupRenderCache(c){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const I=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let B=0;B<I.length;++B){const P=Object.values(I[B]);d.renderCachePool.push(...P)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,w=this._tilesDirty;for(let I=y.length-1;I>=0;I--){const B=y[I];if(d.getTileByID(B.key),void 0!==d.proxyCachedFBO[B.key]){const P=c[B.key],Q=this.proxyToSource[B.key];let j=0;for(const q in Q){const J=Q[q],te=P[q];if(!te||te.length!==J.length||J.some((le,ce)=>le!==te[ce]||w[q]&&w[q].hasOwnProperty(le.key))){j=-1;break}++j}for(const q in d.proxyCachedFBO[B.key])d.renderCache[d.proxyCachedFBO[B.key][q]].dirty=j<0||j!==Object.values(P).length}}const C=[...this._drapedRenderBatches];C.sort((I,B)=>B.end-B.start-(I.end-I.start));for(const I of C)for(const B of y){if(d.proxyCachedFBO[B.key])continue;let P=d.renderCachePool.pop();void 0===P&&d.renderCache.length<50&&(P=d.renderCache.length,d.renderCache.push(this._createFBO())),void 0!==P&&(d.proxyCachedFBO[B.key]={},d.proxyCachedFBO[B.key][I.start]=P,d.renderCache[P].dirty=!0)}this._tilesDirty={}}_setupStencil(c,d,y,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const C=this.painter.context,I=C.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let B;if(y.isTileClipped())B=d.length,this._overlapStencilMode.test={func:I.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);B=1,this._overlapStencilMode.test={func:I.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+B>255&&(C.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=B,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):or.disabled}_renderTileClippingMasks(c,d){const y=this.painter,w=this.painter.context,C=w.gl;y._tileClippingMaskIDs={},w.setColorMode(Tr.disabled),w.setDepthMode(kn.disabled);const I=y.getOrCreateProgram("clippingMask");for(const B of c){const P=y._tileClippingMaskIDs[B.key]=--d;I.draw(y,C.TRIANGLES,kn.disabled,new or({func:C.ALWAYS,mask:0},P,255,C.KEEP,C.KEEP,C.REPLACE),Tr.disabled,Ri.disabled,ch(B.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(c){const d=this.painter.transform;if(c.x<0||c.x>d.width||c.y<0||c.y>d.height)return null;const y=[c.x,c.y,1,1];p.a7.transformMat4(y,y,d.pixelMatrixInverse),p.a7.scale(y,y,1/y[3]),y[0]/=d.worldSize,y[1]/=d.worldSize;const w=d._camera.position,C=p.bl(1,d.center.lat),I=[w[0],w[1],w[2]/C,0],B=p.N.subtract([],y.slice(0,3),I);p.N.normalize(B,B);const P=this.raycast(I,B,this._exaggeration);return null!==P&&P?(p.N.scaleAndAdd(I,I,B,P),I[3]=I[2],I[2]*=C,I):null}drawDepth(){const c=this.painter,d=c.context,y=this.proxySourceCache,w=Math.ceil(c.width),C=Math.ceil(c.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===C||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const I=d.gl,B=d.createFramebuffer(w,C,!0,"renderbuffer");d.activeTexture.set(I.TEXTURE0);const P=new p.T(d,{width:w,height:C,data:null},I.RGBA);P.bind(I.NEAREST,I.CLAMP_TO_EDGE),B.colorAttachment.set(P.texture);const Q=d.createRenderbuffer(d.gl.DEPTH_COMPONENT16,w,C);B.depthAttachment.set(Q),this._depthFBO=B,this._depthTexture=P}d.bindFramebuffer.set(this._depthFBO.framebuffer),d.viewport.set([0,0,w,C]),function(I,B,P,Q){if("globe"===I.transform.projection.name)return;const j=I.context,q=j.gl;j.clear({depth:1});const J=I.getOrCreateProgram("terrainDepth"),te=new kn(q.LESS,kn.ReadWrite,I.depthRangeFor3D);for(const le of Q){const ce=P.getTile(le),Ae=pd(le.projMatrix,0,[0,0,0]);B.setupElevationDraw(ce,J),J.draw(I,q.TRIANGLES,te,or.disabled,Tr.unblended,Ri.backCCW,Ae,"terrain_depth",B.gridBuffer,B.gridIndexBuffer,B.gridNoSkirtSegments)}}(c,this,y,this.proxyCoords)}_setupProxiedCoordsForOrtho(c,d,y){if(c.getSource()instanceof p.ap)return this._setupProxiedCoordsForImageSource(c,d,y);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const w=this.proxiedCoords[c.id]=[],C=this.proxyCoords;for(let P=0;P<C.length;P++){const Q=C[P],j=this._findTileCoveringTileID(Q,c);if(j){const q=this._createProxiedId(Q,j,y[Q.key]&&y[Q.key][c.id]);w.push(q),this.proxyToSource[Q.key][c.id]=[q]}}let I=!1;const B=new Set;for(let P=0;P<d.length;P++){const Q=c.getTile(d[P]);if(!Q||!Q.hasData())continue;const j=this._findTileCoveringTileID(Q.tileID,this.proxySourceCache);if(j&&j.tileID.canonical.z!==Q.tileID.canonical.z){const q=this.proxyToSource[j.tileID.key][c.id],J=this._createProxiedId(j.tileID,Q,y[j.tileID.key]&&y[j.tileID.key][c.id]);q?q.splice(q.length-1,0,J):this.proxyToSource[j.tileID.key][c.id]=[J];const te=this.proxyToSource[j.tileID.key][c.id];B.has(te)||B.add(te),w.push(J),I=!0}}if(this._sourceTilesOverlap[c.id]=I,I&&this._debugParams.sortTilesHiZFirst)for(const P of B)P.sort((Q,j)=>j.overscaledZ-Q.overscaledZ)}_setupProxiedCoordsForImageSource(c,d,y){if(!c.getSource().loaded())return;const w=this.proxiedCoords[c.id]=[],C=this.proxyCoords,I=c.getSource(),B=I.tileID;if(!B)return;const P=new p.P(B.x,B.y)._div(1<<B.z),Q=I.coordinates.map(p.L.fromLngLat).reduce((q,J)=>(q.min.x=Math.min(q.min.x,J.x-P.x),q.min.y=Math.min(q.min.y,J.y-P.y),q.max.x=Math.max(q.max.x,J.x-P.x),q.max.y=Math.max(q.max.y,J.y-P.y),q),{min:new p.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new p.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),j=(q,J)=>{const te=q.wrap+q.canonical.x/(1<<q.canonical.z),le=q.canonical.y/(1<<q.canonical.z),ce=p.V/(1<<q.canonical.z),Ae=J.wrap+J.canonical.x/(1<<J.canonical.z),se=J.canonical.y/(1<<J.canonical.z);return te+ce<Ae+Q.min.x||te>Ae+Q.max.x||le+ce<se+Q.min.y||le>se+Q.max.y};for(let q=0;q<C.length;q++){const J=C[q];for(let te=0;te<d.length;te++){const le=c.getTile(d[te]);if(!le||!le.hasData()||j(J,le.tileID))continue;const ce=this._createProxiedId(J,le,y[J.key]&&y[J.key][c.id]),Ae=this.proxyToSource[J.key][c.id];Ae?Ae.push(ce):this.proxyToSource[J.key][c.id]=[ce],w.push(ce)}}}_createProxiedId(c,d,y){let w=this.orthoMatrix;if(y){const C=y.find(I=>I.key===d.tileID.key);if(C)return C}if(d.tileID.key!==c.key){const C=c.canonical.z-d.tileID.canonical.z;let I,B,P;w=p.a6.create();const Q=d.tileID.wrap-c.wrap<<c.overscaledZ;C>0?(I=p.V>>C,B=I*((d.tileID.canonical.x<<C)-c.canonical.x+Q),P=I*((d.tileID.canonical.y<<C)-c.canonical.y)):(I=p.V<<-C,B=p.V*(d.tileID.canonical.x-(c.canonical.x+Q<<-C)),P=p.V*(d.tileID.canonical.y-(c.canonical.y<<-C))),p.a6.ortho(w,0,I,0,I,0,1),p.a6.translate(w,w,[B,P,0])}return new uh(d.tileID,c.key,w)}_findTileCoveringTileID(c,d){let y=d.getTile(c);if(y&&y.hasData())return y;const w=this._findCoveringTileCache[d.id],C=w[c.key];if(y=C?d.getTileByID(C):null,y&&y.hasData()||null===C)return y;let I=y?y.tileID:c,B=I.overscaledZ;const P=d.getSource().minzoom,Q=[];if(!C){const q=d.getSource().maxzoom;if(c.canonical.z>=q){const J=c.canonical.z-q;d.getSource().reparseOverscaled?(B=Math.max(c.canonical.z+2,d.transform.tileZoom),I=new p.am(B,c.wrap,q,c.canonical.x>>J,c.canonical.y>>J)):0!==J&&(B=q,I=new p.am(B,c.wrap,q,c.canonical.x>>J,c.canonical.y>>J))}I.key!==c.key&&(Q.push(I.key),y=d.getTile(I))}const j=q=>{Q.forEach(J=>{w[J]=q}),Q.length=0};for(B-=1;B>=P&&(!y||!y.hasData());B--){y&&j(y.tileID.key);const q=I.calculateScaledKey(B);if(y=d.getTileByID(q),y&&y.hasData())break;const J=w[q];if(null===J)break;void 0===J?Q.push(q):y=d.getTileByID(J)}return j(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(c,d){let y=this._tilesDirty[c];y||(y=this._tilesDirty[c]={}),y[d.key]=!0}}function jg(_,c,d){const y=function(B,P,Q){const j=p.N.dot(P,B),q=p.N.dot(Q,[.2126,.7152,.0722]),J=(le,ce,Ae)=>(1-Ae)*le+Ae*ce,te=J(1-.3*Math.min(q,1),1,Math.min(j+1,1));return J(.92,1,Math.asin(p.aa(P[2],-1,1))/Math.PI+.5)*te}(_,[0,0,1],c),w=[0,0,0];p.N.scale(w,d.slice(0,3),y);const C=[0,0,0];p.N.scale(C,c.slice(0,3),_[2]);const I=[0,0,0];return p.N.add(I,w,C),p.bU(I)}const Ph=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Nh=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class Gf{static cacheKey(c,d,y,w){let C=`${d}${w?w.cacheKey:""}`;for(const I of y)c.usedDefines.includes(I)&&(C+=`/${I}`);return C}constructor(c,d,y,w,C,I,B){const P=c.gl;this.program=P.createProgram(),this.configuration=w,this.name=d,this.fixedDefines=[...I];const Q=w?w.getBinderAttributes():[],j=(y.staticAttributes||[]).concat(Q);let q=w?w.defines():[];q=q.concat(I.map(se=>`#define ${se}`));const J="#version 300 es\n";let te=J+q.concat("precision mediump float;",Vf,Yd.fragmentSource).join("\n");for(const se of y.fragmentIncludes)te+=`\n${ra[se]}`;te+=`\n${y.fragmentSource}`;let le=J+q.concat("precision highp float;",Vf,Yd.vertexSource).join("\n");for(const se of y.vertexIncludes)le+=`\n${ra[se]}`;le+=`\n${y.vertexSource}`;const ce=P.createShader(P.FRAGMENT_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);P.shaderSource(ce,te),P.compileShader(ce),P.attachShader(this.program,ce);const Ae=P.createShader(P.VERTEX_SHADER);if(P.isContextLost())this.failedToCreate=!0;else{P.shaderSource(Ae,le),P.compileShader(Ae),P.attachShader(this.program,Ae),this.attributes={},this.numAttributes=j.length;for(let se=0;se<this.numAttributes;se++)if(j[se]){const me=j[se].startsWith("a_")?j[se]:`a_${j[se]}`;P.bindAttribLocation(this.program,se,me),this.attributes[me]=se}B&&B.shaderVaryings.length>0&&P.transformFeedbackVaryings(this.program,B.shaderVaryings,B.bufferMode),P.linkProgram(this.program),P.deleteShader(Ae),P.deleteShader(ce),this.fixedUniforms=C(c),this.binderUniforms=w?w.getUniforms(c):[],I.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new p.bO(se=c),u_dem_prev:new p.bO(se),u_dem_tl:new p.bL(se),u_dem_scale:new p.bN(se),u_dem_tl_prev:new p.bL(se),u_dem_scale_prev:new p.bN(se),u_dem_size:new p.bN(se),u_dem_lerp:new p.bN(se),u_exaggeration:new p.bN(se),u_depth:new p.bO(se),u_depth_size_inv:new p.bL(se),u_meter_to_dem:new p.bN(se),u_label_plane_matrix_inv:new p.bK(se)}),I.includes("GLOBE")&&(this.globeUniforms=(se=>({u_tile_tl_up:new p.bM(se),u_tile_tr_up:new p.bM(se),u_tile_br_up:new p.bM(se),u_tile_bl_up:new p.bM(se),u_tile_up_scale:new p.bN(se)}))(c)),I.includes("FOG")&&(this.fogUniforms=(se=>({u_fog_matrix:new p.bK(se),u_fog_range:new p.bL(se),u_fog_color:new p.bP(se),u_fog_horizon_blend:new p.bN(se),u_fog_vertical_limit:new p.bL(se),u_fog_temporal_offset:new p.bN(se),u_frustum_tl:new p.bM(se),u_frustum_tr:new p.bM(se),u_frustum_br:new p.bM(se),u_frustum_bl:new p.bM(se),u_globe_pos:new p.bM(se),u_globe_radius:new p.bN(se),u_globe_transition:new p.bN(se),u_is_globe:new p.bO(se),u_viewport:new p.bL(se)}))(c)),I.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(se=>({u_cutoff_params:new p.bP(se)}))(c)),I.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(se=>({u_lighting_ambient_color:new p.bM(se),u_lighting_directional_dir:new p.bM(se),u_lighting_directional_color:new p.bM(se),u_ground_radiance:new p.bM(se)}))(c)),I.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(se=>({u_light_matrix_0:new p.bK(se),u_light_matrix_1:new p.bK(se),u_fade_range:new p.bL(se),u_shadow_normal_offset:new p.bM(se),u_shadow_intensity:new p.bN(se),u_shadow_texel_size:new p.bN(se),u_shadow_map_resolution:new p.bN(se),u_shadow_direction:new p.bM(se),u_shadow_bias:new p.bM(se),u_shadowmap_0:new p.bO(se),u_shadowmap_1:new p.bO(se)}))(c))}var se}setTerrainUniformValues(c,d){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in d)y[w]&&y[w].set(this.program,w,d[w])}}setGlobeUniformValues(c,d){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in d)y[w]&&y[w].set(this.program,w,d[w])}}setFogUniformValues(c,d){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in d)y[w].set(this.program,w,d[w])}}setCutoffUniformValues(c,d){if(!this.cutoffUniforms)return;const y=this.cutoffUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in d)y[w].set(this.program,w,d[w])}}setLightsUniformValues(c,d){if(!this.lightsUniforms)return;const y=this.lightsUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in d)y[w].set(this.program,w,d[w])}}setShadowUniformValues(c,d){if(this.failedToCreate||!this.shadowUniforms)return;const y=this.shadowUniforms;c.program.set(this.program);for(const w in d)y[w].set(this.program,w,d[w])}_drawDebugWireframe(c,d,y,w,C,I,B,P,Q,j){const q=c.options.wireframe;if(!1===q.terrain&&!1===q.layers2D&&!1===q.layers3D)return;const J=c.context;if(!(()=>!(!q.terrain||"terrainRaster"!==this.name&&"globeRaster"!==this.name)||!(!q.layers2D||c._terrain&&c._terrain.renderingToTexture||!Ph.includes(this.name))||!(!q.layers3D||!Nh.includes(this.name)))())return;const te=J.gl,le=c.wireframeDebugCache.getLinesFromTrianglesBuffer(c.frameCounter,C,J);if(!le)return;const ce=[...this.fixedDefines];ce.push("DEBUG_WIREFRAME");const Ae=c.getOrCreateProgram(this.name,{config:this.configuration,defines:ce});J.program.set(Ae.program);const se=(xe,Be,ge)=>{if(Be[xe]&&ge[xe])for(const Me in Be[xe])ge[xe][Me]&&ge[xe][Me].set(ge.program,Me,Be[xe][Me].current)};Q&&Q.setUniforms(Ae.program,J,Ae.binderUniforms,B,{zoom:P}),se("fixedUniforms",this,Ae),se("terrainUniforms",this,Ae),se("globeUniforms",this,Ae),se("fogUniforms",this,Ae),se("lightsUniforms",this,Ae),se("shadowUniforms",this,Ae),le.bind(),J.setColorMode(new Tr([te.ONE,te.ONE_MINUS_SRC_ALPHA,te.ZERO,te.ONE],p.ax.transparent,[!0,!0,!0,!1])),J.setDepthMode(new kn(d.func===te.LESS?te.LEQUAL:d.func,kn.ReadOnly,d.range)),J.setStencilMode(or.disabled);const me=3*I.primitiveLength*2,Ie=3*I.primitiveOffset*2*2;j&&j>1?te.drawElementsInstanced(te.LINES,me,te.UNSIGNED_SHORT,Ie,j):te.drawElements(te.LINES,me,te.UNSIGNED_SHORT,Ie),C.bind(),J.program.set(this.program),J.setDepthMode(d),J.setStencilMode(y),J.setColorMode(w)}draw(c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce,Ae,se){const me=c.context,Ie=me.gl;if(this.failedToCreate)return;me.program.set(this.program),me.setDepthMode(y),me.setStencilMode(w),me.setColorMode(C),me.setCullFace(I);for(const Me of Object.keys(this.fixedUniforms))this.fixedUniforms[Me].set(this.program,Me,B[Me]);le&&le.setUniforms(this.program,me,this.binderUniforms,J,{zoom:te});const xe={[Ie.POINTS]:1,[Ie.LINES]:2,[Ie.TRIANGLES]:3,[Ie.LINE_STRIP]:1}[d],Be=se&&se.length>0;if(Be){for(const Me of se)Ie.bindBufferBase(Ie.TRANSFORM_FEEDBACK_BUFFER,Me.targetIndex,Me.buffer.buffer);Ie.beginTransformFeedback(d)}const ge=Ae&&Ae>0?1:void 0;for(const Me of q.get()){const He=Me.vaos||(Me.vaos={});(He[P]||(He[P]=new Oi)).bind(me,this,Q,le?le.getPaintVertexBuffers():[],j,Me.vertexOffset,ce||[],ge),Ae&&Ae>1?Ie.drawElementsInstanced(d,Me.primitiveLength*xe,Ie.UNSIGNED_SHORT,Me.primitiveOffset*xe*2,Ae):j?Ie.drawElements(d,Me.primitiveLength*xe,Ie.UNSIGNED_SHORT,Me.primitiveOffset*xe*2):Ie.drawArrays(d,Me.vertexOffset,Me.vertexLength),d===Ie.TRIANGLES&&j&&this._drawDebugWireframe(c,y,w,C,j,Me,J,te,le,Ae)}Be&&Ie.endTransformFeedback()}}function $f(_,c){const d=Math.pow(2,c.tileID.overscaledZ),y=c.tileSize*Math.pow(2,_.transform.tileZoom)/d,w=y*(c.tileID.canonical.x+c.tileID.wrap*d),C=y*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture?c.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/p.a3(c,1,_.transform.tileZoom),u_pixel_coord_upper:[w>>16,C>>16],u_pixel_coord_lower:[65535&w,65535&C]}}const Ds=p.a6.create(),k0=(_,c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce)=>{const Ae=c.style.light,se=Ae.properties.get("position"),me=[se.x,se.y,se.z],Ie=p.co.create();"viewport"===Ae.properties.get("anchor")&&(p.co.fromRotation(Ie,-c.transform.angle),p.N.transformMat3(me,me,Ie));const xe=Ae.properties.get("color"),Be=c.transform,ge={u_matrix:_,u_lightpos:me,u_lightintensity:Ae.properties.get("intensity"),u_lightcolor:[xe.r,xe.g,xe.b],u_vertical_gradient:+d,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ds,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:w,u_edge_radius:C,u_flood_light_color:q,u_vertical_scale:J,u_flood_light_intensity:te,u_ground_shadow_factor:le,u_emissive_strength:ce};return"globe"===Be.projection.name&&(ge.u_tile_id=[I.canonical.x,I.canonical.y,1<<I.canonical.z],ge.u_zoom_transition=P,ge.u_inv_rot_matrix=j,ge.u_merc_center=Q,ge.u_up_dir=Be.projection.upVector(new p.bs(0,0,0),Q[0]*p.V,Q[1]*p.V),ge.u_height_lift=B),ge},Dp=(_,c,d)=>({u_matrix:_,u_edge_radius:c,u_vertical_scale:d}),gd=(_,c,d,y,w,C,I,B,P,Q,j,q,J,te)=>{const le=k0(_,c,d,y,w,C,I,P,Q,j,q,J,te,1,[0,0,0],0),ce={u_height_factor:-Math.pow(2,I.overscaledZ)/B.tileSize/8};return p.e(le,$f(c,B),ce)},mc=(_,c)=>({u_matrix:_,u_emissive_strength:c}),kA=(_,c,d,y)=>p.e(mc(_,c),$f(d,y)),Uc=(_,c,d)=>({u_matrix:_,u_world:d,u_emissive_strength:c}),md=(_,c,d,y,w)=>p.e(kA(_,c,d,y),{u_world:w}),Ya=(_,c,d,y)=>{const w=p.V/d.tileSize;return{u_matrix:_,u_camera_to_center_distance:c.getCameraToCenterDistance(y),u_extrude_scale:[c.pixelsToGLUnits[0]/w,c.pixelsToGLUnits[1]/w]}},P0=(_,c,d=1)=>({u_matrix:_,u_color:c,u_overlay:0,u_overlay_scale:d}),_c=p.a6.create(),Gl=(_,c,d,y,w,C,I)=>{const B=_.transform,P="globe"===B.projection.name,Q=P?p.cp(B.zoom,c.canonical)*B._pixelsPerMercatorPixel:p.a3(d,1,C),j={u_matrix:c.projMatrix,u_extrude_scale:Q,u_intensity:I,u_inv_rot_matrix:_c,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(P){j.u_inv_rot_matrix=y,j.u_merc_center=w,j.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],j.u_zoom_transition=p.S(B.zoom);const q=w[0]*p.V,J=w[1]*p.V;j.u_up_dir=B.projection.upVector(new p.bs(0,0,0),q,J)}return j};function PA(_,[c,d,y,w],[C,I]){if(C===I)return[0,0,0,0];const B=255*(_-1)/(_*(I-C));return[c*B,d*B,y*B,w*B]}function Jd(_,c,[d,y]){return d===y?0:.5/_+(c-d)*(_-1)/(_*(y-d))}const _d=(_,c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce,Ae,se,me,Ie,xe)=>{return{u_matrix:_,u_normalize_matrix:c,u_globe_matrix:d,u_merc_matrix:y,u_grid_matrix:w,u_tl_parent:C,u_scale_parent:Q,u_fade_t:j.mix,u_opacity:j.opacity*q.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:q.paint.get("raster-brightness-min"),u_brightness_high:q.paint.get("raster-brightness-max"),u_saturation_factor:(ge=q.paint.get("raster-saturation"),ge>0?1-1/(1.001-ge):-ge),u_contrast_factor:(Be=q.paint.get("raster-contrast"),Be>0?1/(1-Be):1+Be),u_spin_weights:yc(q.paint.get("raster-hue-rotate")),u_perspective_transform:J,u_raster_elevation:te,u_zoom_transition:I,u_merc_center:B,u_cutoff_params:P,u_colorization_mix:PA(p.cq,ce,se),u_colorization_offset:Jd(p.cq,Ae,se),u_color_ramp:le,u_texture_offset:[Ie/(me+2*Ie),me/(me+2*Ie)],u_texture_res:[me+2*Ie,me+2*Ie],u_emissive_strength:xe};var Be,ge};function yc(_){_*=Math.PI/180;const c=Math.sin(_),d=Math.cos(_);return[(2*d+1)/3,(-Math.sqrt(3)*c-d+1)/3,(Math.sqrt(3)*c-d+1)/3]}const c_=(_,c,d,y,w,C,I,B,P,Q,j,q)=>({u_matrix:_,u_normalize_matrix:c,u_globe_matrix:d,u_merc_matrix:y,u_grid_matrix:w,u_tl_parent:C,u_scale_parent:Q,u_fade_t:j.mix,u_opacity:j.opacity,u_image0:0,u_image1:1,u_raster_elevation:q,u_zoom_transition:I,u_merc_center:B,u_cutoff_params:P}),mv=(_,c,d,y,w,C,I,B)=>({u_tile_offset:_,u_velocity:c,u_color_ramp:y,u_velocity_res:d,u_max_speed:w,u_texture_offset:C,u_data_scale:I,u_data_offset:B}),N0=(_,c,d,y,w,C,I,B)=>({u_velocity:_,u_velocity_res:c,u_max_speed:d,u_speed_factor:y,u_lifetime_delta:w,u_rand_seed:Math.random(),u_texture_offset:C,u_data_scale:I,u_data_offset:B}),_v=p.a6.create(),Gg=(_,c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce,Ae,se)=>{const me=w.transform,Ie={u_is_size_zoom_constant:+("constant"===_||"source"===_),u_is_size_feature_constant:+("constant"===_||"camera"===_),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:me.getCameraToCenterDistance(ce),u_rotate_symbol:+d,u_aspect_ratio:me.width/me.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:I,u_coord_matrix:B,u_is_text:+P,u_pitch_with_map:+y,u_texsize:Q,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:_v,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:_v,u_up_vector:[0,-1,0],u_icon_transition:se||0,u_icon_saturation:Ae};return"globe"===ce.name&&(Ie.u_tile_id=[j.canonical.x,j.canonical.y,1<<j.canonical.z],Ie.u_zoom_transition=q,Ie.u_inv_rot_matrix=te,Ie.u_merc_center=J,Ie.u_camera_forward=me._camera.forward(),Ie.u_ecef_origin=p.cr(me.globeMatrix,j.toUnwrapped()),Ie.u_tile_matrix=Float32Array.from(me.globeMatrix),Ie.u_up_vector=le),Ie},Bp=(_,c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce,Ae)=>p.e(Gg(_,c,d,y,w,C,I,B,P,Q,q,J,te,le,ce,Ae,1),{u_gamma_scale:y?w.transform.getCameraToCenterDistance(Ae)*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:p.f.devicePixelRatio,u_is_halo:+j,undefined:void 0}),u_=(_,c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce)=>p.e(Bp(_,c,d,y,w,C,I,B,!0,P,!0,j,q,J,te,le,ce),{u_texsize_icon:Q,u_texture_icon:1}),L0=(_,c,d,y)=>({u_matrix:_,u_emissive_strength:c,u_opacity:d,u_color:y}),$g=(_,c,d,y,w,C,I)=>p.e(function(B,P,Q,j){const q=Q.imageManager.getPattern(B.toString(),P),{width:J,height:te}=Q.imageManager.getPixelSize(P),le=Math.pow(2,j.tileID.overscaledZ),ce=j.tileSize*Math.pow(2,Q.transform.tileZoom)/le,Ae=ce*(j.tileID.canonical.x+j.tileID.wrap*le),se=ce*j.tileID.canonical.y;return{u_image:0,u_pattern_tl:q.tl,u_pattern_br:q.br,u_texsize:[J,te],u_pattern_size:q.displaySize,u_tile_units_to_pixels:1/p.a3(j,1,Q.transform.tileZoom),u_pixel_coord_upper:[Ae>>16,se>>16],u_pixel_coord_lower:[65535&Ae,65535&se]}}(w,C,y,I),{u_matrix:_,u_emissive_strength:c,u_opacity:d}),h_=(_,c,d,y,w,C,I,B,P,Q,j,q,J=[0,0,0],te)=>{const le=y.style.light,ce=le.properties.get("position"),Ae=[-ce.x,-ce.y,ce.z],se=p.co.create();"viewport"===le.properties.get("anchor")&&(p.co.fromRotation(se,-y.transform.angle),p.N.transformMat3(Ae,Ae,se));const me="MASK"===Q.alphaMode,Ie=le.properties.get("color"),xe=q.paint.get("model-ambient-occlusion-intensity"),Be=q.paint.get("model-color").constantOr(p.ax.white),ge=q.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:_,u_lighting_matrix:c,u_normal_matrix:d,u_lightpos:Ae,u_lightintensity:le.properties.get("intensity"),u_lightcolor:[Ie.r,Ie.g,Ie.b],u_camera_pos:J,u_opacity:w,u_baseTextureIsAlpha:0,u_alphaMask:+me,u_alphaCutoff:Q.alphaCutoff,u_baseColorFactor:[C.r,C.g,C.b,C.a],u_emissiveFactor:[I[0],I[1],I[2],1],u_metallicFactor:B,u_roughnessFactor:P,u_baseColorTexture:ul.BaseColor,u_metallicRoughnessTexture:ul.MetallicRoughness,u_normalTexture:ul.Normal,u_occlusionTexture:ul.Occlusion,u_emissionTexture:ul.Emission,u_color_mix:[Be.r,Be.g,Be.b,ge],u_aoIntensity:xe,u_emissive_strength:j,u_occlusionTextureTransform:te||[0,0,0,0]}},qg=new Float32Array(16),Mp=(_,c=qg,d=qg)=>({u_matrix:_,u_instance:c,u_node_matrix:d}),gb={fillExtrusion:_=>({u_matrix:new p.bK(_),u_lightpos:new p.bM(_),u_lightintensity:new p.bN(_),u_lightcolor:new p.bM(_),u_vertical_gradient:new p.bN(_),u_opacity:new p.bN(_),u_edge_radius:new p.bN(_),u_ao:new p.bL(_),u_tile_id:new p.bM(_),u_zoom_transition:new p.bN(_),u_inv_rot_matrix:new p.bK(_),u_merc_center:new p.bL(_),u_up_dir:new p.bM(_),u_height_lift:new p.bN(_),u_flood_light_color:new p.bM(_),u_vertical_scale:new p.bN(_),u_flood_light_intensity:new p.bN(_),u_ground_shadow_factor:new p.bM(_),u_emissive_strength:new p.bN(_)}),fillExtrusionDepth:_=>({u_matrix:new p.bK(_),u_edge_radius:new p.bN(_),u_vertical_scale:new p.bN(_)}),fillExtrusionPattern:_=>({u_matrix:new p.bK(_),u_lightpos:new p.bM(_),u_lightintensity:new p.bN(_),u_lightcolor:new p.bM(_),u_vertical_gradient:new p.bN(_),u_height_factor:new p.bN(_),u_edge_radius:new p.bN(_),u_ao:new p.bL(_),u_tile_id:new p.bM(_),u_zoom_transition:new p.bN(_),u_inv_rot_matrix:new p.bK(_),u_merc_center:new p.bL(_),u_up_dir:new p.bM(_),u_height_lift:new p.bN(_),u_image:new p.bO(_),u_texsize:new p.bL(_),u_pixel_coord_upper:new p.bL(_),u_pixel_coord_lower:new p.bL(_),u_tile_units_to_pixels:new p.bN(_),u_opacity:new p.bN(_)}),fillExtrusionGroundEffect:_=>({u_matrix:new p.bK(_),u_opacity:new p.bN(_),u_ao_pass:new p.bN(_),u_meter_to_tile:new p.bN(_),u_ao:new p.bL(_),u_flood_light_intensity:new p.bN(_),u_flood_light_color:new p.bM(_),u_attenuation:new p.bN(_),u_edge_radius:new p.bN(_),u_fb:new p.bO(_),u_fb_size:new p.bN(_)}),fill:_=>({u_matrix:new p.bK(_),u_emissive_strength:new p.bN(_)}),fillPattern:_=>({u_matrix:new p.bK(_),u_emissive_strength:new p.bN(_),u_image:new p.bO(_),u_texsize:new p.bL(_),u_pixel_coord_upper:new p.bL(_),u_pixel_coord_lower:new p.bL(_),u_tile_units_to_pixels:new p.bN(_)}),fillOutline:_=>({u_matrix:new p.bK(_),u_emissive_strength:new p.bN(_),u_world:new p.bL(_)}),fillOutlinePattern:_=>({u_matrix:new p.bK(_),u_emissive_strength:new p.bN(_),u_world:new p.bL(_),u_image:new p.bO(_),u_texsize:new p.bL(_),u_pixel_coord_upper:new p.bL(_),u_pixel_coord_lower:new p.bL(_),u_tile_units_to_pixels:new p.bN(_)}),circle:p.cs,collisionBox:_=>({u_matrix:new p.bK(_),u_camera_to_center_distance:new p.bN(_),u_extrude_scale:new p.bL(_)}),collisionCircle:_=>({u_matrix:new p.bK(_),u_inv_matrix:new p.bK(_),u_camera_to_center_distance:new p.bN(_),u_viewport_size:new p.bL(_)}),debug:_=>({u_color:new p.ca(_),u_matrix:new p.bK(_),u_overlay:new p.bO(_),u_overlay_scale:new p.bN(_)}),clippingMask:_=>({u_matrix:new p.bK(_)}),heatmap:_=>({u_extrude_scale:new p.bN(_),u_intensity:new p.bN(_),u_matrix:new p.bK(_),u_inv_rot_matrix:new p.bK(_),u_merc_center:new p.bL(_),u_tile_id:new p.bM(_),u_zoom_transition:new p.bN(_),u_up_dir:new p.bM(_)}),heatmapTexture:_=>({u_image:new p.bO(_),u_color_ramp:new p.bO(_),u_opacity:new p.bN(_)}),hillshade:_=>({u_matrix:new p.bK(_),u_image:new p.bO(_),u_latrange:new p.bL(_),u_light:new p.bL(_),u_shadow:new p.ca(_),u_highlight:new p.ca(_),u_emissive_strength:new p.bN(_),u_accent:new p.ca(_)}),hillshadePrepare:_=>({u_matrix:new p.bK(_),u_image:new p.bO(_),u_dimension:new p.bL(_),u_zoom:new p.bN(_)}),line:p.ct,linePattern:p.cu,raster:_=>({u_matrix:new p.bK(_),u_normalize_matrix:new p.bK(_),u_globe_matrix:new p.bK(_),u_merc_matrix:new p.bK(_),u_grid_matrix:new p.cb(_),u_tl_parent:new p.bL(_),u_scale_parent:new p.bN(_),u_fade_t:new p.bN(_),u_opacity:new p.bN(_),u_image0:new p.bO(_),u_image1:new p.bO(_),u_brightness_low:new p.bN(_),u_brightness_high:new p.bN(_),u_saturation_factor:new p.bN(_),u_contrast_factor:new p.bN(_),u_spin_weights:new p.bM(_),u_perspective_transform:new p.bL(_),u_raster_elevation:new p.bN(_),u_zoom_transition:new p.bN(_),u_merc_center:new p.bL(_),u_cutoff_params:new p.bP(_),u_colorization_mix:new p.bP(_),u_colorization_offset:new p.bN(_),u_color_ramp:new p.bO(_),u_texture_offset:new p.bL(_),u_texture_res:new p.bL(_),u_emissive_strength:new p.bN(_)}),rasterParticle:_=>({u_matrix:new p.bK(_),u_normalize_matrix:new p.bK(_),u_globe_matrix:new p.bK(_),u_merc_matrix:new p.bK(_),u_grid_matrix:new p.cb(_),u_tl_parent:new p.bL(_),u_scale_parent:new p.bN(_),u_fade_t:new p.bN(_),u_opacity:new p.bN(_),u_image0:new p.bO(_),u_image1:new p.bO(_),u_raster_elevation:new p.bN(_),u_zoom_transition:new p.bN(_),u_merc_center:new p.bL(_),u_cutoff_params:new p.bP(_)}),rasterParticleTexture:_=>({u_texture:new p.bO(_),u_opacity:new p.bN(_)}),rasterParticleDraw:_=>({u_tile_offset:new p.bL(_),u_velocity:new p.bO(_),u_color_ramp:new p.bO(_),u_velocity_res:new p.bL(_),u_max_speed:new p.bN(_),u_texture_offset:new p.bL(_),u_data_scale:new p.bP(_),u_data_offset:new p.bN(_)}),rasterParticleUpdate:_=>({u_velocity:new p.bO(_),u_velocity_res:new p.bL(_),u_max_speed:new p.bN(_),u_speed_factor:new p.bN(_),u_lifetime_delta:new p.bN(_),u_rand_seed:new p.bN(_),u_texture_offset:new p.bL(_),u_data_scale:new p.bP(_),u_data_offset:new p.bN(_)}),symbolIcon:_=>({u_is_size_zoom_constant:new p.bO(_),u_is_size_feature_constant:new p.bO(_),u_size_t:new p.bN(_),u_size:new p.bN(_),u_camera_to_center_distance:new p.bN(_),u_rotate_symbol:new p.bO(_),u_aspect_ratio:new p.bN(_),u_fade_change:new p.bN(_),u_matrix:new p.bK(_),u_label_plane_matrix:new p.bK(_),u_coord_matrix:new p.bK(_),u_is_text:new p.bO(_),u_pitch_with_map:new p.bO(_),u_texsize:new p.bL(_),u_tile_id:new p.bM(_),u_zoom_transition:new p.bN(_),u_inv_rot_matrix:new p.bK(_),u_merc_center:new p.bL(_),u_camera_forward:new p.bM(_),u_tile_matrix:new p.bK(_),u_up_vector:new p.bM(_),u_ecef_origin:new p.bM(_),u_texture:new p.bO(_),u_icon_transition:new p.bN(_),u_icon_saturation:new p.bN(_)}),symbolSDF:_=>({u_is_size_zoom_constant:new p.bO(_),u_is_size_feature_constant:new p.bO(_),u_size_t:new p.bN(_),u_size:new p.bN(_),u_camera_to_center_distance:new p.bN(_),u_rotate_symbol:new p.bO(_),u_aspect_ratio:new p.bN(_),u_fade_change:new p.bN(_),u_matrix:new p.bK(_),u_label_plane_matrix:new p.bK(_),u_coord_matrix:new p.bK(_),u_is_text:new p.bO(_),u_pitch_with_map:new p.bO(_),u_texsize:new p.bL(_),u_texture:new p.bO(_),u_gamma_scale:new p.bN(_),u_device_pixel_ratio:new p.bN(_),u_tile_id:new p.bM(_),u_zoom_transition:new p.bN(_),u_inv_rot_matrix:new p.bK(_),u_merc_center:new p.bL(_),u_camera_forward:new p.bM(_),u_tile_matrix:new p.bK(_),u_up_vector:new p.bM(_),u_ecef_origin:new p.bM(_),u_is_halo:new p.bO(_)}),symbolTextAndIcon:_=>({u_is_size_zoom_constant:new p.bO(_),u_is_size_feature_constant:new p.bO(_),u_size_t:new p.bN(_),u_size:new p.bN(_),u_camera_to_center_distance:new p.bN(_),u_rotate_symbol:new p.bO(_),u_aspect_ratio:new p.bN(_),u_fade_change:new p.bN(_),u_matrix:new p.bK(_),u_label_plane_matrix:new p.bK(_),u_coord_matrix:new p.bK(_),u_is_text:new p.bO(_),u_pitch_with_map:new p.bO(_),u_texsize:new p.bL(_),u_texsize_icon:new p.bL(_),u_texture:new p.bO(_),u_texture_icon:new p.bO(_),u_gamma_scale:new p.bN(_),u_device_pixel_ratio:new p.bN(_),u_is_halo:new p.bO(_)}),background:_=>({u_matrix:new p.bK(_),u_emissive_strength:new p.bN(_),u_opacity:new p.bN(_),u_color:new p.ca(_)}),backgroundPattern:_=>({u_matrix:new p.bK(_),u_emissive_strength:new p.bN(_),u_opacity:new p.bN(_),u_image:new p.bO(_),u_pattern_tl:new p.bL(_),u_pattern_br:new p.bL(_),u_texsize:new p.bL(_),u_pattern_size:new p.bL(_),u_pixel_coord_upper:new p.bL(_),u_pixel_coord_lower:new p.bL(_),u_tile_units_to_pixels:new p.bN(_)}),terrainRaster:jl,terrainDepth:jl,skybox:_=>({u_matrix:new p.bK(_),u_sun_direction:new p.bM(_),u_cubemap:new p.bO(_),u_opacity:new p.bN(_),u_temporal_offset:new p.bN(_)}),skyboxGradient:_=>({u_matrix:new p.bK(_),u_color_ramp:new p.bO(_),u_center_direction:new p.bM(_),u_radius:new p.bN(_),u_opacity:new p.bN(_),u_temporal_offset:new p.bN(_)}),skyboxCapture:_=>({u_matrix_3f:new p.cb(_),u_sun_direction:new p.bM(_),u_sun_intensity:new p.bN(_),u_color_tint_r:new p.bP(_),u_color_tint_m:new p.bP(_),u_luminance:new p.bN(_)}),globeRaster:_=>({u_proj_matrix:new p.bK(_),u_globe_matrix:new p.bK(_),u_normalize_matrix:new p.bK(_),u_merc_matrix:new p.bK(_),u_zoom_transition:new p.bN(_),u_merc_center:new p.bL(_),u_image0:new p.bO(_),u_grid_matrix:new p.cb(_),u_skirt_height:new p.bN(_),u_far_z_cutoff:new p.bN(_),u_frustum_tl:new p.bM(_),u_frustum_tr:new p.bM(_),u_frustum_br:new p.bM(_),u_frustum_bl:new p.bM(_),u_globe_pos:new p.bM(_),u_globe_radius:new p.bN(_),u_viewport:new p.bL(_)}),globeAtmosphere:_=>({u_frustum_tl:new p.bM(_),u_frustum_tr:new p.bM(_),u_frustum_br:new p.bM(_),u_frustum_bl:new p.bM(_),u_horizon:new p.bN(_),u_transition:new p.bN(_),u_fadeout_range:new p.bN(_),u_color:new p.bP(_),u_high_color:new p.bP(_),u_space_color:new p.bP(_),u_temporal_offset:new p.bN(_),u_horizon_angle:new p.bN(_)}),model:_=>({u_matrix:new p.bK(_),u_lighting_matrix:new p.bK(_),u_normal_matrix:new p.bK(_),u_lightpos:new p.bM(_),u_lightintensity:new p.bN(_),u_lightcolor:new p.bM(_),u_camera_pos:new p.bM(_),u_opacity:new p.bN(_),u_baseColorFactor:new p.bP(_),u_emissiveFactor:new p.bP(_),u_metallicFactor:new p.bN(_),u_roughnessFactor:new p.bN(_),u_baseTextureIsAlpha:new p.bO(_),u_alphaMask:new p.bO(_),u_alphaCutoff:new p.bN(_),u_baseColorTexture:new p.bO(_),u_metallicRoughnessTexture:new p.bO(_),u_normalTexture:new p.bO(_),u_occlusionTexture:new p.bO(_),u_emissionTexture:new p.bO(_),u_color_mix:new p.bP(_),u_aoIntensity:new p.bN(_),u_emissive_strength:new p.bN(_),u_occlusionTextureTransform:new p.bP(_)}),modelDepth:_=>({u_matrix:new p.bK(_),u_instance:new p.bK(_),u_node_matrix:new p.bK(_)}),groundShadow:_=>({u_matrix:new p.bK(_),u_ground_shadow_factor:new p.bM(_)}),stars:_=>({u_matrix:new p.bK(_),u_up:new p.bM(_),u_right:new p.bM(_),u_intensity_multiplier:new p.bN(_)})};let Lh;function Uh(_,c,d,y,w,C,I){const B=_.context,P=B.gl,Q=_.transform,j=_.getOrCreateProgram("collisionBox"),q=[];let J=0,te=0;for(let xe=0;xe<y.length;xe++){const Be=y[xe],ge=c.getTile(Be),Me=ge.getBucket(d);if(!Me)continue;const He=dd(Be,Me,Q);let Ge=He;0===w[0]&&0===w[1]||(Ge=_.translatePosMatrix(He,ge,w,C));const nt=I?Me.textCollisionBox:Me.iconCollisionBox,dt=Me.collisionCircleArray;if(dt.length>0){const ot=p.a6.create(),Pt=Ge;p.a6.mul(ot,Me.placementInvProjMatrix,Q.glCoordMatrix),p.a6.mul(ot,ot,Me.placementViewportMatrix),q.push({circleArray:dt,circleOffset:te,transform:Pt,invTransform:ot,projection:Me.getProjection()}),J+=dt.length/4,te=J}nt&&(_.terrain&&_.terrain.setupElevationDraw(ge,j),j.draw(_,P.LINES,kn.disabled,or.disabled,_.colorModeForRenderPass(),Ri.disabled,Ya(Ge,Q,ge,Me.getProjection()),d.id,nt.layoutVertexBuffer,nt.indexBuffer,nt.segments,null,Q.zoom,null,[nt.collisionVertexBuffer,nt.collisionVertexBufferExt]))}if(!I||!q.length)return;const le=_.getOrCreateProgram("collisionCircle"),ce=new p.cv;ce.resize(4*J),ce._trim();let Ae=0;for(const xe of q)for(let Be=0;Be<xe.circleArray.length/4;Be++){const ge=4*Be,Me=xe.circleArray[ge+0],He=xe.circleArray[ge+1],Ge=xe.circleArray[ge+2],nt=xe.circleArray[ge+3];ce.emplace(Ae++,Me,He,Ge,nt,0),ce.emplace(Ae++,Me,He,Ge,nt,1),ce.emplace(Ae++,Me,He,Ge,nt,2),ce.emplace(Ae++,Me,He,Ge,nt,3)}(!Lh||Lh.length<2*J)&&(Lh=function(xe){const Be=2*xe,ge=new p.aw;ge.resize(Be),ge._trim();for(let Me=0;Me<Be;Me++){const He=6*Me;ge.uint16[He+0]=4*Me+0,ge.uint16[He+1]=4*Me+1,ge.uint16[He+2]=4*Me+2,ge.uint16[He+3]=4*Me+2,ge.uint16[He+4]=4*Me+3,ge.uint16[He+5]=4*Me+0}return ge}(J));const se=B.createIndexBuffer(Lh,!0),me=B.createVertexBuffer(ce,p.cw.members,!0);for(const xe of q){const Be={u_matrix:xe.transform,u_inv_matrix:xe.invTransform,u_camera_to_center_distance:(Ie=Q).getCameraToCenterDistance(xe.projection),u_viewport_size:[Ie.width,Ie.height]};le.draw(_,P.TRIANGLES,kn.disabled,or.disabled,_.colorModeForRenderPass(),Ri.disabled,Be,d.id,me,se,p.aB.simpleSegment(0,2*xe.circleOffset,xe.circleArray.length,xe.circleArray.length/2),null,Q.zoom)}var Ie;me.destroy(),se.destroy()}const hh=p.a6.create();function Kg(_){const c=_._camera.getWorldToCamera(_.worldSize,1),d=p.a6.multiply([],c,_.globeMatrix);p.a6.invert(d,d);const y=[0,0,0],w=[0,1,0,0];return p.a7.transformMat4(w,w,d),y[0]=w[0],y[1]=w[1],y[2]=w[2],p.N.normalize(y,y),y}function ai({width:_,height:c,anchor:d,textOffset:y,textScale:w},C){const{horizontalAlign:I,verticalAlign:B}=p.bf(d),P=-(I-.5)*_,Q=-(B-.5)*c,j=p.bd(d,y);return new p.P((P/w+j[0])*C,(Q/w+j[1])*C)}function Wg(_,c,d,y,w,C,I,B,P,Q,j){const q=_.text.placedSymbolArray,J=_.text.dynamicLayoutVertexArray,te=_.icon.dynamicLayoutVertexArray,le={},ce=_.getProjection(),Ae=au(B,ce,C),se=C.elevation,me=ce.upVectorScale(B.canonical,C.center.lat,C.worldSize).metersToTile;J.clear();for(let Ie=0;Ie<q.length;Ie++){const xe=q.get(Ie),{tileAnchorX:Be,tileAnchorY:ge,numGlyphs:Me}=xe,He=xe.hidden||!xe.crossTileID||_.allowVerticalPlacement&&!xe.placedOrientation?null:y[xe.crossTileID];if(He){let Ge=0,nt=0,dt=0;if(se){const An=se?se.getAtTileOffset(B,Be,ge):0,[Tn,Cn,$n]=ce.upVector(B.canonical,Be,ge);Ge=An*Tn*me,nt=An*Cn*me,dt=An*$n*me}let[ot,Pt,Rt,cn]=eh(xe.projectedAnchorX+Ge,xe.projectedAnchorY+nt,xe.projectedAnchorZ+dt,d?Ae:I);const ct=gv(C.getCameraToCenterDistance(ce),cn);let St=w.evaluateSizeForFeature(_.textSizeData,Q,xe)*ct/p.bc;d&&(St*=_.tilePixelRatio/P);const Ze=ai(He,St);d?(({x:ot,y:Pt,z:Rt}=ce.projectTilePoint(Be+Ze.x,ge+Ze.y,B.canonical)),[ot,Pt,Rt]=eh(ot+Ge,Pt+nt,Rt+dt,I)):(c&&Ze._rotate(-C.angle),ot+=Ze.x,Pt+=Ze.y,Rt=0);const gt=_.allowVerticalPlacement&&xe.placedOrientation===p.b6.vertical?Math.PI/2:0;for(let An=0;An<Me;An++)p.b9(J,ot,Pt,Rt,gt);j&&xe.associatedIconIndex>=0&&(le[xe.associatedIconIndex]={x:ot,y:Pt,z:Rt,angle:gt})}else Pf(Me,J)}if(j){te.clear();const Ie=_.icon.placedSymbolArray;for(let xe=0;xe<Ie.length;xe++){const Be=Ie.get(xe),{numGlyphs:ge}=Be,Me=le[xe];if(Be.hidden||!Me)Pf(ge,te);else{const{x:He,y:Ge,z:nt,angle:dt}=Me;for(let ot=0;ot<ge;ot++)p.b9(te,He,Ge,nt,dt)}}_.icon.dynamicLayoutVertexBuffer.updateData(te)}_.text.dynamicLayoutVertexBuffer.updateData(J)}function Fp(_,c,d,y,w,C,I={}){const B=d.paint.get("icon-translate"),P=d.paint.get("text-translate"),Q=d.paint.get("icon-translate-anchor"),j=d.paint.get("text-translate-anchor"),q=d.layout.get("icon-rotation-alignment"),J=d.layout.get("text-rotation-alignment"),te=d.layout.get("icon-pitch-alignment"),le=d.layout.get("text-pitch-alignment"),ce=d.layout.get("icon-keep-upright"),Ae=d.layout.get("text-keep-upright"),se=d.paint.get("icon-color-saturation"),me=_.context,Ie=me.gl,xe=_.transform,Be="map"===q,ge="map"===J,Me="map"===te,He="map"===le,Ge=void 0!==d.layout.get("symbol-sort-key").constantOr(1);let nt=!1;const dt=_.depthModeForSublayer(0,kn.ReadOnly),ot=[p.a5(xe.center.lng),p.ae(xe.center.lat)],Pt=d.layout.get("text-variable-anchor"),Rt="globe"===xe.projection.name,cn=[],ct=[0,-1,0];for(const St of y){const Ze=c.getTile(St),gt=Ze.getBucket(d);if(!gt||"mercator"===gt.projection.name&&Rt||gt.fullyClipped)continue;const An="globe"===gt.projection.name,Tn=An?p.S(xe.zoom):0,Cn=au(St,gt.getProjection(),xe),$n=xe.calculatePixelsToTileUnitsMatrix(Ze),li=Pt&&gt.hasTextData(),xi=gt.hasIconTextFit()&&li&&gt.hasIconData(),yi=gt.getProjection().createInversionMatrix(xe,St.canonical),ci=()=>{const Po=Be&&"point"!==d.layout.get("symbol-placement"),Dr=[],jr=Po||xi,br=d.paint.get("icon-image-cross-fade").constantOr(0);_.terrainRenderModeElevated()&&Me&&Dr.push("PITCH_WITH_MAP_TERRAIN"),An&&(Dr.push("PROJECTION_GLOBE_VIEW"),jr&&Dr.push("PROJECTED_POS_ON_VIEWPORT")),br>0&&Dr.push("ICON_TRANSITION"),gt.icon.zOffsetVertexBuffer&&Dr.push("Z_OFFSET"),se<1&&Dr.push("SATURATION");const Xr=gt.icon.programConfigurations.get(d.id),eo=_.getOrCreateProgram(gt.sdfIcons?"symbolSDF":"symbolIcon",{config:Xr,defines:Dr});let zr;const za=Ze.imageAtlasTexture?Ze.imageAtlasTexture.size:[0,0],gl=gt.iconSizeData,bc=p.b5(gl,xe.zoom),jc=Me||0!==xe.pitch,Gc=IA(Cn,Ze.tileID.canonical,Me,Be,xe,gt.getProjection(),$n),oo=Uo(Cn,Ze.tileID.canonical,Me,Be,xe,gt.getProjection(),$n),fa=_.translatePosMatrix(oo,Ze,B,Q,!0),Ms=_.translatePosMatrix(Cn,Ze,B,Q),ml=jr?hh:Gc,$c=Be&&!Me&&!Po;let Si=ct;!Rt&&!xe.mercatorFromTransition||Be||(Si=Kg(xe));const _l=An?Si:ct;zr=gt.sdfIcons&&!gt.iconsInText?Bp(gl.kind,bc,$c,Me,_,Ms,ml,fa,!1,za,!0,St,Tn,ot,yi,_l,gt.getProjection()):Gg(gl.kind,bc,$c,Me,_,Ms,ml,fa,!1,za,St,Tn,ot,yi,_l,gt.getProjection(),se,br);const wc=Ze.imageAtlasTexture?Ze.imageAtlasTexture:null,Va=1!==d.layout.get("icon-size").constantOr(0)||gt.iconsNeedLinear,Gh=gt.sdfIcons||_.options.rotating||_.options.zooming||Va||jc?Ie.LINEAR:Ie.NEAREST,Ao=gt.sdfIcons&&0!==d.paint.get("icon-halo-width").constantOr(1),Eo=_.terrain&&Me&&Po?p.a6.invert(p.a6.create(),Gc):hh;if(Po&&gt.icon){const qc=xe.elevation,x_=qc?qc.getAtTileOffsetFunc(St,xe.center.lat,xe.worldSize,gt.getProjection()):null,Fu=D0(Cn,Ze.tileID.canonical,Me,Be,xe,gt.getProjection(),$n);Gd(gt,Cn,_,!1,Fu,oo,Me,ce,x_,St)}return{program:eo,buffers:gt.icon,uniformValues:zr,atlasTexture:wc,atlasTextureIcon:null,atlasInterpolation:Gh,atlasInterpolationIcon:null,isSDF:gt.sdfIcons,hasHalo:Ao,tile:Ze,labelPlaneMatrixInv:Eo}},gr=()=>{const Po=ge&&"point"!==d.layout.get("symbol-placement"),Dr=[],jr=Po||Pt||xi;_.terrainRenderModeElevated()&&He&&Dr.push("PITCH_WITH_MAP_TERRAIN"),An&&(Dr.push("PROJECTION_GLOBE_VIEW"),jr&&Dr.push("PROJECTED_POS_ON_VIEWPORT")),gt.text.zOffsetVertexBuffer&&Dr.push("Z_OFFSET");const br=gt.text.programConfigurations.get(d.id),Xr=_.getOrCreateProgram(gt.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:br,defines:Dr});let eo,zr=[0,0],za=null;const gl=gt.textSizeData;gt.iconsInText&&(zr=Ze.imageAtlasTexture?Ze.imageAtlasTexture.size:[0,0],za=Ze.imageAtlasTexture?Ze.imageAtlasTexture:null,eo=He||0!==xe.pitch||_.options.rotating||_.options.zooming||"composite"===gl.kind||"camera"===gl.kind?Ie.LINEAR:Ie.NEAREST);const bc=Ze.glyphAtlasTexture?Ze.glyphAtlasTexture.size:[0,0],jc=p.b5(gl,xe.zoom),Gc=IA(Cn,Ze.tileID.canonical,He,ge,xe,gt.getProjection(),$n),oo=Uo(Cn,Ze.tileID.canonical,He,ge,xe,gt.getProjection(),$n),fa=_.translatePosMatrix(oo,Ze,P,j,!0),Ms=_.translatePosMatrix(Cn,Ze,P,j),ml=jr?hh:Gc,$c=ge&&!He&&!Po;let Si=ct;!Rt&&!xe.mercatorFromTransition||ge||(Si=Kg(xe));const _l=An?Si:ct;let wc;wc=gt.iconsInText?u_(gl.kind,jc,$c,He,_,Ms,ml,fa,bc,zr,St,Tn,ot,yi,_l,gt.getProjection()):Bp(gl.kind,jc,$c,He,_,Ms,ml,fa,!0,bc,!0,St,Tn,ot,yi,_l,gt.getProjection());const Va=Ze.glyphAtlasTexture?Ze.glyphAtlasTexture:null,Gh=Ie.LINEAR,Ao=0!==d.paint.get("text-halo-width").constantOr(1),Eo=_.terrain&&He&&Po?p.a6.invert(p.a6.create(),Gc):hh;if(Po&&gt.text){const qc=xe.elevation,x_=qc?qc.getAtTileOffsetFunc(St,xe.center.lat,xe.worldSize,gt.getProjection()):null,Fu=D0(Cn,Ze.tileID.canonical,He,ge,xe,gt.getProjection(),$n);Gd(gt,Cn,_,!0,Fu,oo,He,Ae,x_,St)}return{program:Xr,buffers:gt.text,uniformValues:wc,atlasTexture:Va,atlasTextureIcon:za,atlasInterpolation:Gh,atlasInterpolationIcon:eo,isSDF:!0,hasHalo:Ao,tile:Ze,labelPlaneMatrixInv:Eo}},Ki=gt.icon.segments.get().length,lr=gt.text.segments.get().length,rr=Ki&&!I.onlyText?ci():null,kr=lr&&!I.onlyIcons?gr():null,qs=d.paint.get("icon-opacity").constantOr(1),Fr=d.paint.get("text-opacity").constantOr(1);if(Ge&&gt.canOverlap){nt=!0;const Po=qs&&!I.onlyText?gt.icon.segments.get():[],Dr=Fr&&!I.onlyIcons?gt.text.segments.get():[];for(const jr of Po)cn.push({segments:new p.aB([jr]),sortKey:jr.sortKey,state:rr});for(const jr of Dr)cn.push({segments:new p.aB([jr]),sortKey:jr.sortKey,state:kr})}else I.onlyText||cn.push({segments:qs?gt.icon.segments:new p.aB([]),sortKey:0,state:rr}),I.onlyIcons||cn.push({segments:Fr?gt.text.segments:new p.aB([]),sortKey:0,state:kr})}nt&&cn.sort((St,Ze)=>St.sortKey-Ze.sortKey);for(const St of cn){const Ze=St.state;if(Ze)if(_.terrain&&_.terrain.setupElevationDraw(Ze.tile,Ze.program,{useDepthForOcclusion:xe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Ze.labelPlaneMatrixInv}),me.activeTexture.set(Ie.TEXTURE0),Ze.atlasTexture&&Ze.atlasTexture.bind(Ze.atlasInterpolation,Ie.CLAMP_TO_EDGE,!0),Ze.atlasTextureIcon&&(me.activeTexture.set(Ie.TEXTURE1),Ze.atlasTextureIcon&&Ze.atlasTextureIcon.bind(Ze.atlasInterpolationIcon,Ie.CLAMP_TO_EDGE,!0)),_.uploadCommonLightUniforms(_.context,Ze.program),Ze.hasHalo){const gt=Ze.uniformValues;gt.u_is_halo=1,qf(Ze.buffers,St.segments,d,_,Ze.program,dt,w,C,gt,2),gt.u_is_halo=0}else{if(Ze.isSDF){const gt=Ze.uniformValues;Ze.hasHalo&&(gt.u_is_halo=1,qf(Ze.buffers,St.segments,d,_,Ze.program,dt,w,C,gt,1)),gt.u_is_halo=0}qf(Ze.buffers,St.segments,d,_,Ze.program,dt,w,C,Ze.uniformValues,1)}}}function qf(_,c,d,y,w,C,I,B,P,Q){const j=[_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer,_.iconTransitioningVertexBuffer,_.globeExtVertexBuffer,_.zOffsetVertexBuffer];w.draw(y,y.context.gl.TRIANGLES,C,I,B,Ri.disabled,P,d.id,_.layoutVertexBuffer,_.indexBuffer,c,d.paint,y.transform.zoom,_.programConfigurations.get(d.id),j,Q)}function NA(_,c,d,y,w,C,I){const B=_.context.gl,P=d.paint.get("fill-pattern"),Q=P&&P.constantOr(1);let j,q,J,te,le;I?(q=Q&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=B.LINES):(q=Q?"fillPattern":"fill",j=B.TRIANGLES);for(const ce of y){const Ae=c.getTile(ce);if(Q&&!Ae.patternsLoaded())continue;const se=Ae.getBucket(d);if(!se)continue;_.prepareDrawTile();const me=se.programConfigurations.get(d.id),Ie=_.isTileAffectedByFog(ce),xe=_.getOrCreateProgram(q,{config:me,overrideFog:Ie});Q&&(_.context.activeTexture.set(B.TEXTURE0),Ae.imageAtlasTexture&&Ae.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),me.updatePaintBuffers());const Be=P.constantOr(null);if(Be&&Ae.imageAtlas){const He=Ae.imageAtlas.patternPositions[Be.toString()];He&&me.setConstantPatternPositions(He)}const ge=_.translatePosMatrix(ce.projMatrix,Ae,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor")),Me=d.paint.get("fill-emissive-strength");if(I){te=se.indexBuffer2,le=se.segments2;const He=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[B.drawingBufferWidth,B.drawingBufferHeight];J="fillOutlinePattern"===q&&Q?md(ge,Me,_,Ae,He):Uc(ge,Me,He)}else te=se.indexBuffer,le=se.segments,J=Q?kA(ge,Me,_,Ae):mc(ge,Me);_.uploadCommonUniforms(_.context,xe,ce.toUnwrapped()),xe.draw(_,j,w,_.stencilModeForClipping(ce),C,Ri.disabled,J,d.id,se.layoutVertexBuffer,te,le,d.paint,_.transform.zoom,me,void 0)}}function gi(_,c,d,y,w,C,I,B){d.resetLayerRenderingStats(_);const P=_.context,Q=P.gl,j=_.transform,q=d.paint.get("fill-extrusion-pattern"),J=q.constantOr(1),te=d.paint.get("fill-extrusion-opacity"),le=_.style.enable3dLights(),ce=d.paint.get(le&&!J?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Ae=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),ce],se=d.layout.get("fill-extrusion-edge-radius"),me=se>0&&!d.paint.get("fill-extrusion-rounded-roof"),Ie=me?0:se,xe="globe"===j.projection.name?p.cF():0,Be="globe"===j.projection.name,ge=Be?p.S(j.zoom):0,Me=[p.a5(j.center.lng),p.ae(j.center.lat)],He=d.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),Ge=d.paint.get("fill-extrusion-flood-light-intensity"),nt=d.paint.get("fill-extrusion-vertical-scale"),dt=sh(_,d.paint.get("fill-extrusion-cutoff-fade-range")),ot=d.paint.get("fill-extrusion-emissive-strength"),Pt=[];let Rt;Be&&Pt.push("PROJECTION_GLOBE_VIEW"),Ae[0]>0&&Pt.push("FAUX_AO"),me&&Pt.push("ZERO_ROOF_RADIUS"),B&&Pt.push("HAS_CENTROID"),Ge>0&&Pt.push("FLOOD_LIGHT"),dt.shouldRenderCutoff&&Pt.push("RENDER_CUTOFF");const cn="shadow"===_.renderPass,ct=_.shadowRenderer,St=cn&&!!ct;_.shadowRenderer&&(_.shadowRenderer.useNormalOffset=!0);let Ze=[0,0,0];if(ct){const Tn=_.style.directionalLight,Cn=_.style.ambientLight;Tn&&Cn&&(Ze=Cp(Tn,Cn)),Rt=Pt.concat(["SHADOWS_SINGLE_CASCADE"])}const gt=St?"fillExtrusionDepth":J?"fillExtrusionPattern":"fillExtrusion",An=d.getLayerRenderingStats();for(const Tn of y){const Cn=c.getTile(Tn),$n=Cn.getBucket(d);if(!$n||$n.projection.name!==j.projection.name)continue;let li=!1;ct&&(li=0===ct.getMaxCascadeForTile(Tn.toUnwrapped()));const xi=_.isTileAffectedByFog(Tn),yi=$n.programConfigurations.get(d.id),ci=_.getOrCreateProgram(gt,{config:yi,defines:li?Rt:Pt,overrideFog:xi});if(_.terrain&&_.terrain.setupElevationDraw(Cn,ci,{useMeterToDem:!0}),!$n.centroidVertexBuffer){const qs=ci.attributes.a_centroid_pos;void 0!==qs&&Q.vertexAttrib2f(qs,0,0)}!cn&&ct&&ct.setupShadows(Cn.tileID.toUnwrapped(),ci,"vector-tile",Cn.tileID.overscaledZ),J&&(_.context.activeTexture.set(Q.TEXTURE0),Cn.imageAtlasTexture&&Cn.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),yi.updatePaintBuffers());const gr=q.constantOr(null);if(gr&&Cn.imageAtlas){const qs=Cn.imageAtlas.patternPositions[gr.toString()];qs&&yi.setConstantPatternPositions(qs)}const Ki=d.paint.get("fill-extrusion-vertical-gradient");let lr;if(cn&&ct){if(Rp(Cn.tileID,$n,_))continue;const qs=ct.calculateShadowPassMatrixFromTile(Cn.tileID.toUnwrapped());lr=Dp(qs,Ie,nt)}else{const qs=_.translatePosMatrix(Tn.expandedProjMatrix,Cn,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Fr=j.projection.createInversionMatrix(j,Tn.canonical);lr=J?gd(qs,_,Ki,te,Ae,Ie,Tn,Cn,xe,ge,Me,Fr,He,nt):k0(qs,_,Ki,te,Ae,Ie,Tn,xe,ge,Me,Fr,He,nt,Ge,Ze,ot)}_.uploadCommonUniforms(P,ci,Tn.toUnwrapped(),null,dt);let rr=$n.segments;if("mercator"===j.projection.name&&!cn&&(rr=$n.getVisibleSegments(Cn.tileID,_.terrain,_.transform.getFrustum(0)),!rr.get().length))continue;if(An)if(cn)for(const qs of rr.get())An.numRenderedVerticesInShadowPass+=qs.primitiveLength;else for(const qs of rr.get())An.numRenderedVerticesInTransparentPass+=qs.primitiveLength;const kr=[];(_.terrain||B)&&kr.push($n.centroidVertexBuffer),Be&&kr.push($n.layoutVertexExtBuffer),ci.draw(_,P.gl.TRIANGLES,w,C,I,Ri.backCCW,lr,d.id,$n.layoutVertexBuffer,$n.indexBuffer,rr,d.paint,_.transform.zoom,yi,kr)}_.shadowRenderer&&(_.shadowRenderer.useNormalOffset=!1)}function zc(_,c,d,y,w,C,I,B,P,Q,j,q,J,te,le,ce,Ae,se,me){const Ie=_.context,xe=Ie.gl,Be=_.transform,ge=_.transform.zoom,Me=[],He=sh(_,d.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===Q?(Me.push("CLEAR_SUBPASS"),me&&(Me.push("CLEAR_FROM_TEXTURE"),Ie.activeTexture.set(xe.TEXTURE0),me.bind(xe.LINEAR,xe.CLAMP_TO_EDGE))):"sdf"===Q&&Me.push("SDF_SUBPASS"),Ae&&Me.push("HAS_CENTROID"),He.shouldRenderCutoff&&Me.push("RENDER_CUTOFF");const Ge=d.layout.get("fill-extrusion-edge-radius"),nt=(dt,ot,Pt,Rt,cn)=>{const ct=ot.programConfigurations.get(d.id),St=_.isTileAffectedByFog(dt),Ze=_.getOrCreateProgram("fillExtrusionGroundEffect",{config:ct,defines:Me,overrideFog:St}),gt={u_matrix:Rt,u_opacity:j,u_ao_pass:P?1:0,u_meter_to_tile:cn,u_ao:[q,J*cn],u_flood_light_intensity:te,u_flood_light_color:le,u_attenuation:ce,u_edge_radius:ge>=17?0:Ge*cn,u_fb:0,u_fb_size:me?me.size[0]:0},An=[];Ae&&An.push(ot.hiddenByLandmarkVertexBuffer),_.uploadCommonUniforms(Ie,Ze,dt.toUnwrapped(),null,He),Ze.draw(_,Ie.gl.TRIANGLES,w,C,I,B,gt,d.id,ot.vertexBuffer,ot.indexBuffer,Pt,d.paint,ge,ct,An)};for(const dt of y){const ot=c.getTile(dt),Pt=ot.getBucket(d);if(!Pt||Pt.projection.name!==Be.projection.name||!Pt.groundEffect||Pt.groundEffect&&!Pt.groundEffect.hasData())continue;const Rt=Pt.groundEffect,cn=1/Pt.tileToMeter;{const ct=_.translatePosMatrix(dt.projMatrix,ot,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),St=Rt.getDefaultSegment();nt(dt,Rt,St,ct,cn)}if(se)for(let ct=0;ct<4;ct++){const St=p.cG[ct](dt),Ze=c.getTile(St);if(!Ze)continue;const gt=Ze.getBucket(d);if(!gt||gt.projection.name!==Be.projection.name||!gt.groundEffect||gt.groundEffect&&!gt.groundEffect.hasData())continue;const An=gt.groundEffect;let Tn,Cn;0===ct?(Tn=[-p.V,0,0],Cn=1):1===ct?(Tn=[p.V,0,0],Cn=0):2===ct?(Tn=[0,-p.V,0],Cn=3):(Tn=[0,p.V,0],Cn=2);const $n=An.regionSegments[Cn];if(!$n)continue;const li=new Float32Array(16);p.a6.translate(li,dt.projMatrix,Tn),nt(dt,An,$n,_.translatePosMatrix(li,ot,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),cn)}}}function ef(_,c,d,y,w,C,I){0===y.centroidVertexArray.length&&y.createCentroidsBuffer();const B=C?C.findDEMTileFor(d):null;if(!(B&&B.dem||I))return;const P=se=>new p.P(Math.ceil((se+p.cJ)*p.cK),0),Q=se=>{const me=c.getSource().minzoom,Ie=Be=>{const ge=c.getTileByID(Be);if(ge&&ge.hasData())return ge.getBucket(w)},xe=[0,-1,1];for(const Be of xe){if(se.overscaledZ+Be<me)continue;const ge=Ie(se.calculateScaledKey(se.overscaledZ+Be));if(ge)return ge}},j=[0,0,0],q=(se,me)=>(j[0]=Math.min(se.min.y,me.min.y),j[1]=Math.max(se.max.y,me.max.y),j[2]=p.V-me.min.x>se.max.x?me.min.x-p.V:se.max.x,j),J=(se,me)=>(j[0]=Math.min(se.min.x,me.min.x),j[1]=Math.max(se.max.x,me.max.x),j[2]=p.V-me.min.y>se.max.y?me.min.y-p.V:se.max.y,j),te=[(se,me)=>q(se,me),(se,me)=>q(me,se),(se,me)=>J(se,me),(se,me)=>J(me,se)],le=(se,me,Ie,xe,Be,ge,Me)=>{if(!C)return 0;const He=[[ge?Ie:se,ge?se:Ie,0],[ge?Ie:me,ge?me:Ie,0]],Ge=Me<0?p.V+Me:Me,nt=[ge?Ge:(se+me)/2,ge?(se+me)/2:Ge,0];return 0===Ie&&Me<0||0!==Ie&&Me>0?C.getForTilePoints(Be,[nt],!0,xe):He.push(nt),C.getForTilePoints(d,He,!0,B),Math.max(He[0][2],He[1][2],nt[2])/C.exaggeration()};for(let se=0;se<4;se++){const me=y.borderFeatureIndices[se];if(0===me.length)continue;const Ie=p.cG[se](d),xe=Q(Ie);if(!(xe&&xe instanceof p.cH)||y.borderDoneWithNeighborZ[se]===xe.canonical.z)continue;0===xe.centroidVertexArray.length&&xe.createCentroidsBuffer();const Be=C?C.findDEMTileFor(Ie):null;if(!(Be&&Be.dem||I))continue;const ge=(se<2?1:5)-se,Me=xe.borderDoneWithNeighborZ[ge]!==y.canonical.z,He=xe.borderFeatureIndices[ge];let Ge=0;if(y.canonical.z!==xe.canonical.z){for(const nt of me)y.showCentroid(y.featuresOnBorder[nt]);if(Me)for(const nt of He)xe.showCentroid(xe.featuresOnBorder[nt]);y.borderDoneWithNeighborZ[se]=xe.canonical.z,xe.borderDoneWithNeighborZ[ge]=y.canonical.z}for(const nt of me){const dt=y.featuresOnBorder[nt],ot=y.centroidData[dt.centroidDataIndex],Pt=dt.borders[se];let Rt;for(;Ge<He.length;){Rt=xe.featuresOnBorder[He[Ge]];const cn=Rt.borders[ge];if(cn[1]>Pt[0]+3||cn[0]>Pt[0]-3)break;xe.showCentroid(Rt),Ge++}if(Rt&&Ge<He.length){const cn=Ge;let ct=0;for(;!(Rt.borders[ge][0]>Pt[1]-3)&&(ct++,++Ge!==He.length);)Rt=xe.featuresOnBorder[He[Ge]];if(Rt=xe.featuresOnBorder[He[cn]],ct>1){const gt=Rt.borders[ge];Math.abs(Pt[0]-gt[0])<3&&Math.abs(Pt[1]-gt[1])<3&&(ct=1,Ge=cn+1)}else if(0===ct){y.showCentroid(dt);continue}const St=xe.centroidData[Rt.centroidDataIndex];I&&1===ct&&(((ce=ot).flags|(Ae=St).flags)&p.cI?(ce.flags|=p.cI,Ae.flags|=p.cI):(ce.flags&=~p.cI,Ae.flags&=~p.cI));const Ze=dt.intersectsCount()>1||Rt.intersectsCount()>1;if(ct>1)Ge=cn,ot.centroidXY=St.centroidXY=new p.P(0,0);else if(Be&&Be.dem&&!Ze){const gt=te[se](ot,St),An=se%2?p.V-1:0,Tn=le(gt[0],Math.min(p.V-1,gt[1]),An,Be,Ie,se<2,gt[2]);ot.centroidXY=St.centroidXY=P(Tn)}else Ze?ot.centroidXY=St.centroidXY=new p.P(0,0):(ot.centroidXY=y.encodeBorderCentroid(dt),St.centroidXY=xe.encodeBorderCentroid(Rt));y.writeCentroidToBuffer(ot),xe.writeCentroidToBuffer(St)}else y.showCentroid(dt)}y.borderDoneWithNeighborZ[se]=xe.canonical.z,xe.borderDoneWithNeighborZ[ge]=y.canonical.z}var ce,Ae;(y.needsCentroidUpdate||!y.centroidVertexBuffer&&0!==y.centroidVertexArray.length)&&y.uploadCentroid(_)}const mb=[1,0,0],U0=[0,1,0],$s=[0,0,1];function Rp(_,c,d){const y=d.transform,w=d.shadowRenderer;if(!w)return!0;const C=_.toUnwrapped(),I=y.tileSize*w._cascades[d.currentShadowCascade].scale;let B=c.maxHeight;if(y.elevation){const ce=y.elevation.getMinMaxForTile(_);ce&&(B+=ce.max)}const P=[...w.shadowDirection];P[2]=-P[2];const Q=w.computeSimplifiedTileShadowVolume(C,B,I,P);if(!Q)return!1;const j=[mb,U0,$s,P,[P[0],0,P[2]],[0,P[1],P[2]]],q="globe"===y.projection.name,J=y.scaleZoom(I),te=p.bq.fromInvProjectionMatrix(y.invProjMatrix,y.worldSize,J,!q),le=w.getCurrentCascadeFrustum();return 0===te.intersectsPrecise(Q.vertices,Q.planes,j)||0===le.intersectsPrecise(Q.vertices,Q.planes,j)}function hu(_){return[_[0]*p.cL,_[1]*p.cL,_[2]*p.cL,0]}function Zg(_,c,d,y,w,C,I,B,P){const Q=y.getSource(),j=d.globeSharedBuffers;if(!j)return;let q,J,te;if(c&&(q=y.getTile(c)),Q instanceof p.ap?(J=Q.texture,te=p.cj(0,0,d.transform)):q&&c&&(J=q.texture,te=p.cj(c.canonical.z,c.canonical.x,d.transform)),!J||!te)return;_||(te=p.a6.scale(p.a6.create(),te,[1,-1,1]));const le=d.context,ce=le.gl,Ae="nearest"===w.paint.get("raster-resampling")?ce.NEAREST:ce.LINEAR,se=d.colorModeForDrapableLayerRenderPass(C),me=I.defines;me.push("GLOBE_POLES");const Ie=new kn(ce.LEQUAL,kn.ReadWrite,d.depthRangeFor3D),xe=Float32Array.from(d.transform.expandedFarZProjMatrix),Be=Float32Array.from(p.aT(p.ci(new p.bs(0,0,0))));d.terrain&&d.terrain.prepareDrawTile(),le.activeTexture.set(ce.TEXTURE0),J.bind(Ae,ce.CLAMP_TO_EDGE),le.activeTexture.set(ce.TEXTURE1),J.bind(Ae,ce.CLAMP_TO_EDGE),J.useMipmap&&le.extTextureFilterAnisotropic&&d.transform.pitch>20&&ce.texParameterf(ce.TEXTURE_2D,le.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,le.extTextureFilterAnisotropicMax);const[ge,Me,He,Ge]=c?j.getPoleBuffers(c.canonical.z,!1):j.getPoleBuffers(0,!0),nt=w.paint.get("raster-elevation");let dt;_?(dt=ge,d.renderDefaultNorthPole=0!==nt):(dt=Me,d.renderDefaultSouthPole=0!==nt);const ot=hu(I.mix),Pt=(cn=xe,ct=Be,St=te,Ze=p.S(d.transform.zoom),An=w,Cn=nt,li=ot,xi=I.offset,yi=I.range,ci=C,_d(cn,ct,St,new Float32Array(16),new Float32Array(9),[0,0],Ze,[0,0],[0,0,0,0],1,{opacity:1,mix:0},An,[0,0],Cn,2,li,xi,yi,1,0,ci)),Rt=d.getOrCreateProgram("raster",{defines:me});var cn,ct,St,Ze,An,Cn,li,xi,yi,ci;d.uploadCommonUniforms(le,Rt,null),Rt.draw(d,ce.TRIANGLES,Ie,P,se,B,Pt,w.id,dt,He,Ge)}function Xg(_){const c=_._nearZ,d=_.projection.farthestPixelDistance(_),y=d-c,w=.2*_.height,C=c+w;return[c,d,(C-w-c)/y,(C-c)/y]}function Yg(_,c,d,y){if(_)return c instanceof Ln&&_ instanceof Il?c.getTextureDescriptor(_,d,!0):{texture:_.texture,mix:hu(y.mix),offset:y.offset,buffer:0,tileSize:1}}function Op(_,c,d){if(!_)return null;const y=c.getTextureDescriptor(_,d,!0);if(!y)return null;let{texture:w,mix:C,offset:I,tileSize:B,buffer:P,format:Q}=y;if(!w||!Q)return null;let j=!1;return"uint32"===Q&&(j=!0,C[3]=0,C=PA(p.cM,C,[0,d.paint.get("raster-particle-max-speed")]),I=Jd(p.cM,I,[0,d.paint.get("raster-particle-max-speed")])),{texture:w,textureOffset:[P/(B+2*P),B/(B+2*P)],tileSize:B,scalarData:j,scale:C,offset:I,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[Q]]}}function kp(_){const c=_._nearZ,d=_.projection.farthestPixelDistance(_),y=d-c,w=.2*_.height,C=c+w;return[c,d,(C-w-c)/y,(C-c)/y]}const vc=new p.ax(1,0,0,1),zh=new p.ax(0,1,0,1),Jg=new p.ax(0,0,1,1),em=new p.ax(1,0,1,1),tm=new p.ax(0,1,1,1);function Vh(_,c,d,y,w,C,I){const B=_.context,P=_.transform,Q=B.gl,j="globe"===P.projection.name,q=j?["PROJECTION_GLOBE_VIEW"]:[];let J=p.a6.clone(d.projMatrix);if(j&&p.S(P.zoom)>0){const ot=p.aS(d.canonical,P),Pt=p.cN(ot);J=p.a6.multiply(new Float32Array(16),P.globeMatrix,Pt),p.a6.multiply(J,P.projMatrix,J)}const te=p.a6.create();te[12]+=2*w/(p.f.devicePixelRatio*P.width),te[13]+=2*C/(p.f.devicePixelRatio*P.height),p.a6.multiply(J,te,J);const le=_.getOrCreateProgram("debug",{defines:q}),ce=c.getTileByID(d.key);_.terrain&&_.terrain.setupElevationDraw(ce,le);const Ae=kn.disabled,se=or.disabled,me=_.colorModeForRenderPass();B.activeTexture.set(Q.TEXTURE0),_.emptyTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),j?ce._makeGlobeTileDebugBuffers(_.context,P):ce._makeDebugTileBoundsBuffers(_.context,P.projection);const xe=ce._tileDebugBuffer||_.debugBuffer,Be=ce._tileDebugIndexBuffer||_.debugIndexBuffer,ge=ce._tileDebugSegments||_.debugSegments;if(le.draw(_,Q.LINE_STRIP,Ae,se,me,Ri.disabled,P0(J,y),"$debug",xe,Be,ge,null,null,null,[ce._globeTileDebugBorderBuffer]),I){const ot=ce.latestRawTileData,Pt=Math.floor((ot&&ot.byteLength||0)/1024);let Rt=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(Rt+=` => ${d.overscaledZ}`),Rt+=` ${ce.state}`,Rt+=` ${Pt}kb`,function(cn,ct){cn.initDebugOverlayCanvas();const St=cn.debugOverlayCanvas,Ze=cn.context.gl,gt=cn.debugOverlayCanvas.getContext("2d");gt.clearRect(0,0,St.width,St.height),gt.shadowColor="white",gt.shadowBlur=2,gt.lineWidth=1.5,gt.strokeStyle="white",gt.textBaseline="top",gt.font="bold 36px Open Sans, sans-serif",gt.fillText(ct,5,5),gt.strokeText(ct,5,5),cn.debugOverlayTexture.update(St),cn.debugOverlayTexture.bind(Ze.LINEAR,Ze.CLAMP_TO_EDGE)}(_,Rt)}const Me=c.getTile(d).tileSize,He=512/Math.min(Me,512)*(d.overscaledZ/P.zoom)*.5,Ge=ce._tileDebugTextBuffer||_.debugBuffer,nt=ce._tileDebugTextIndexBuffer||_.quadTriangleIndexBuffer,dt=ce._tileDebugTextSegments||_.debugSegments;le.draw(_,Q.TRIANGLES,Ae,se,Tr.alphaBlended,Ri.disabled,P0(J,p.ax.transparent,He),"$debug",Ge,nt,dt,null,null,null,[ce._globeTileDebugTextBuffer])}function Pi(_,c,d,y){uo(_,0,c+d/2,_.transform.width,d,y)}function $l(_,c,d,y){uo(_,c-d/2,0,d,_.transform.height,y)}function uo(_,c,d,y,w,C){const I=_.context,B=I.gl;B.enable(B.SCISSOR_TEST),B.scissor(c*p.f.devicePixelRatio,d*p.f.devicePixelRatio,y*p.f.devicePixelRatio,w*p.f.devicePixelRatio),I.clear({color:C}),B.disable(B.SCISSOR_TEST)}const Kf=p.ay([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:dh}=Kf;function tf(_,c,d,y){_.emplaceBack(c,d,y)}class d_{constructor(c){this.vertexArray=new p.az,this.indices=new p.aw,tf(this.vertexArray,-1,-1,1),tf(this.vertexArray,1,-1,1),tf(this.vertexArray,-1,1,1),tf(this.vertexArray,1,1,1),tf(this.vertexArray,-1,-1,-1),tf(this.vertexArray,1,-1,-1),tf(this.vertexArray,-1,1,-1),tf(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,dh),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=p.aB.simpleSegment(0,0,36,12)}}function fh(_,c,d,y,w,C){const I=_.context.gl,B=c.paint.get("sky-atmosphere-color"),P=c.paint.get("sky-atmosphere-halo-color"),Q=c.paint.get("sky-atmosphere-sun-intensity"),j={u_matrix_3f:p.co.fromMat4(p.co.create(),y),u_sun_direction:w,u_sun_intensity:Q,u_color_tint_r:[(le=B).r,le.g,le.b,le.a],u_color_tint_m:[(ce=P).r,ce.g,ce.b,ce.a],u_luminance:5e-5};var le,ce;I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_CUBE_MAP_POSITIVE_X+C,c.skyboxTexture,0),d.draw(_,I.TRIANGLES,kn.disabled,or.disabled,Tr.unblended,Ri.frontCW,j,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const nm=p.ay([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Pp{constructor(c){const d=new p.cO;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const y=new p.aw;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=c.createVertexBuffer(d,nm.members),this.indexBuffer=c.createIndexBuffer(y),this.segments=p.aB.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const LA=p.ay([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Rn{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class wi{constructor(c){this.colorModeAlphaBlendedWriteRGB=new Tr([1,771,1,771],p.ax.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Tr([1,0,1,0],p.ax.transparent,[!1,!1,!1,!0]),this.params=new Rn,this.updateNeeded=!0,c.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),c.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),c.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),c.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(c){const d=c.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Pp(d);const y=this.params.sizeRange,w=this.params.intensityRange,C=function(j){const q=p.aA(30),J=[];for(let te=0;te<j;++te){const le=2*Math.PI*q(),ce=Math.acos(1-2*q())-.5*Math.PI;J.push(p.N.fromValues(Math.cos(ce)*Math.cos(le),Math.cos(ce)*Math.sin(le),Math.sin(ce)))}return J}(this.params.starsCount),I=p.aA(300),B=new p.cP,P=new p.aw;let Q=0;for(let j=0;j<C.length;++j){const q=p.N.scale([],C[j],200),J=Math.max(0,1+.01*y*(1*I()-.5)),te=Math.max(0,1+.01*w*(1*I()-.5));B.emplaceBack(q[0],q[1],q[2],-1,-1,J,te),B.emplaceBack(q[0],q[1],q[2],1,-1,J,te),B.emplaceBack(q[0],q[1],q[2],1,1,J,te),B.emplaceBack(q[0],q[1],q[2],-1,1,J,te),P.emplaceBack(Q+0,Q+1,Q+2),P.emplaceBack(Q+0,Q+2,Q+3),Q+=4}this.starsVx=d.createVertexBuffer(B,LA.members),this.starsIdx=d.createIndexBuffer(P),this.starsSegments=p.aB.simpleSegment(0,0,B.length,P.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(c,d){const y=c.context,w=y.gl,C=c.transform,I=new kn(w.LEQUAL,kn.ReadOnly,[0,1]),B=p.S(C.zoom),P=d.properties.get("color").toArray01(),Q=d.properties.get("high-color").toArray01(),j=d.properties.get("space-color").toArray01PremultipliedAlpha(),q=5e-4,J=p.cQ(d.properties.get("horizon-blend"),0,1,q,.25),te=p.cd(c,y,C)&&J===q?C.worldSize/(2*Math.PI*1.025)-1:C.globeRadius,le=c.frameCounter/1e3%1,ce=p.N.length(C.globeCenterInViewSpace),Ae=Math.sqrt(Math.pow(ce,2)-Math.pow(te,2)),se=Math.acos(Ae/ce),me=Ie=>{const xe="globe"===C.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ie&&xe.push("ALPHA_PASS");const Be=c.getOrCreateProgram("globeAtmosphere",{defines:xe}),ge={u_frustum_tl:C.frustumCorners.TL,u_frustum_tr:C.frustumCorners.TR,u_frustum_br:C.frustumCorners.BR,u_frustum_bl:C.frustumCorners.BL,u_horizon:C.frustumCorners.horizon,u_transition:B,u_fadeout_range:J,u_color:P,u_high_color:Q,u_space_color:j,u_temporal_offset:le,u_horizon_angle:se};c.uploadCommonUniforms(y,Be);const Me=this.atmosphereBuffer;Me&&Be.draw(c,w.TRIANGLES,I,or.disabled,Ie?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Ri.backCW,ge,Ie?"atmosphere_glow_alpha":"atmosphere_glow",Me.vertexBuffer,Me.indexBuffer,Me.segments)};me(!1),me(!0)}drawStars(c,d){const y=p.aa(d.properties.get("star-intensity"),0,1);if(0===y)return;const w=c.context,C=w.gl,I=c.transform,B=c.getOrCreateProgram("stars"),P=p.bi.identity([]);p.bi.rotateX(P,P,-I._pitch),p.bi.rotateZ(P,P,-I.angle),p.bi.rotateX(P,P,p.bj(I._center.lat)),p.bi.rotateY(P,P,-p.bj(I._center.lng));const Q=p.a6.fromQuat(new Float32Array(16),P),j=p.a6.multiply([],I.starsProjMatrix,Q),q=p.co.fromMat4([],Q),J=p.co.invert([],q),te=[0,1,0];p.N.transformMat3(te,te,J),p.N.scale(te,te,this.params.sizeMultiplier);const le=[1,0,0];p.N.transformMat3(le,le,J),p.N.scale(le,le,this.params.sizeMultiplier);const ce=(Ae=te,se=le,me=y,{u_matrix:Float32Array.from(j),u_up:Ae,u_right:se,u_intensity_multiplier:me});var Ae,se,me;c.uploadCommonUniforms(w,B),this.starsVx&&this.starsIdx&&B.draw(c,C.TRIANGLES,kn.disabled,or.disabled,this.colorModeAlphaBlendedWriteRGB,Ri.disabled,ce,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Ah(_,c){const d=[..._],y=c.cameraWorldSizeForFog/c.worldSize,w=p.a6.identity([]);return p.a6.scale(w,w,[y,y,1]),p.a6.multiply(d,w,d),p.a6.multiply(d,c.worldToFogMatrix,d),d}function ko(_,c,d,y){const w=d.material,C=y.context,{baseColorTexture:I,metallicRoughnessTexture:B}=w.pbrMetallicRoughness,{normalTexture:P,occlusionTexture:Q,emissionTexture:j}=w;function q(J,te,le){if(J&&(_.push(te),C.activeTexture.set(C.gl.TEXTURE0+le),J.gfxTexture)){const{minFilter:ce,magFilter:Ae,wrapS:se,wrapT:me}=J.sampler;J.gfxTexture.bindExtraParam(ce,Ae,se,me)}}q(I,"HAS_TEXTURE_u_baseColorTexture",ul.BaseColor),q(B,"HAS_TEXTURE_u_metallicRoughnessTexture",ul.MetallicRoughness),q(P,"HAS_TEXTURE_u_normalTexture",ul.Normal),q(Q,"HAS_TEXTURE_u_occlusionTexture",ul.Occlusion),q(j,"HAS_TEXTURE_u_emissionTexture",ul.Emission),d.texcoordBuffer&&(_.push("HAS_ATTRIBUTE_a_uv_2f"),c.push(d.texcoordBuffer)),d.colorBuffer&&(_.push(12===d.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),c.push(d.colorBuffer)),d.normalBuffer&&(_.push("HAS_ATTRIBUTE_a_normal_3f"),c.push(d.normalBuffer)),d.pbrBuffer&&(_.push("HAS_ATTRIBUTE_a_pbr"),_.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),c.push(d.pbrBuffer)),"OPAQUE"!==w.alphaMode&&"MASK"!==w.alphaMode||_.push("UNPREMULT_TEXTURE_IN_SHADER"),w.defined||_.push("DIFFUSE_SHADED"),_.push("USE_STANDARD_DERIVATIVES")}function im(_,c,d,y,w,C){const I=d.paint.get("model-opacity"),B=c.context,P=new kn(c.context.gl.LEQUAL,kn.ReadWrite,c.depthRangeFor3D),Q=c.transform,j=_.mesh,q=j.material,J=q.pbrMetallicRoughness,te=c.style.fog;let le;le="pixels"===c.transform.projection.zAxisUnit?[..._.nodeModelMatrix]:p.a6.multiply([],y.zScaleMatrix,_.nodeModelMatrix),p.a6.multiply(le,y.negCameraPosMatrix,le);const ce=p.a6.invert([],le);p.a6.transpose(ce,ce);const Ae=d.paint.get("model-emissive-strength").constantOr(0),se=h_(new Float32Array(_.worldViewProjection),new Float32Array(le),new Float32Array(ce),c,I,J.baseColorFactor,q.emissiveFactor,J.metallicFactor,J.roughnessFactor,q,Ae,d),me={defines:[]},Ie=[];ko(me.defines,Ie,j,c);const xe=c.shadowRenderer;xe&&(xe.useNormalOffset=!1);let Be=null;if(te){const He=Ah(_.nodeModelMatrix,c.transform);if(Be=new Float32Array(He),"globe"!==Q.projection.name){const Ge=j.aabb.min,nt=j.aabb.max,[dt,ot]=te.getOpacityForBounds(He,Ge[0],Ge[1],nt[0],nt[1]);me.overrideFog=dt>=as||ot>=as}}const ge=sh(c,d.paint.get("model-cutoff-fade-range"));ge.shouldRenderCutoff&&me.defines.push("RENDER_CUTOFF");const Me=c.getOrCreateProgram("model",me);c.uploadCommonUniforms(B,Me,null,Be,ge),"shadow"!==c.renderPass&&xe&&xe.setupShadowsFromMatrix(_.nodeModelMatrix,Me),Me.draw(c,B.gl.TRIANGLES,P,w,C,j.material.doubleSided?Ri.disabled:Ri.backCCW,se,d.id,j.vertexBuffer,j.indexBuffer,j.segments,d.paint,c.transform.zoom,void 0,Ie)}function UA(_,c,d,y,w,C,I){let B;B="globe"===_.projection.name?p.cS(d,_):[...d],p.a6.multiply(B,B,c.matrix);const P=p.a6.multiply([],y,B);if(c.meshes)for(const Q of c.meshes){if("BLEND"!==Q.material.alphaMode){I.push({mesh:Q,depth:0,modelIndex:w,worldViewProjection:P,nodeModelMatrix:B});continue}const j=p.N.transformMat4([],Q.centroid,P);j[2]>0&&C.push({mesh:Q,depth:j[2],modelIndex:w,worldViewProjection:P,nodeModelMatrix:B})}if(c.children)for(const Q of c.children)UA(_,Q,d,y,w,C,I)}function bt(_,c,d,y){const w=d.shadowRenderer;if(!w)return;const C=w.getShadowPassDepthMode(),I=w.getShadowPassColorMode(),B=w.calculateShadowPassMatrixFromMatrix(c),P=Mp(B);d.getOrCreateProgram("modelDepth",{defines:d._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(d,d.context.gl.TRIANGLES,C,or.disabled,I,Ri.backCCW,P,y.id,_.vertexBuffer,_.indexBuffer,_.segments,y.paint,d.transform.zoom,void 0,void 0)}function zA(_,c,d){const y=c.updateZoomBasedPaintProperties(),w=function(C,I,B){let P,Q,j,q=C.terrain?C.terrain.exaggeration():0;if(C.terrain&&q>0){const J=C.terrain,te=J.findDEMTileFor(B);te&&te.dem?P=p.cU.create(J,B,te):q=0}if(0===q&&(I.terrainElevationMin=0,I.terrainElevationMax=0),q===I.validForExaggeration&&(0===q||P&&P._demTile&&P._demTile.tileID===I.validForDEMTile.id&&P._dem._timestamp===I.validForDEMTile.timestamp))return!1;for(const J in I.instancesPerModel){const te=I.instancesPerModel[J];for(let le=0;le<te.instancedDataArray.length;++le){const ce=(P?q*P.getElevationAt(0|te.instancedDataArray.float32[16*le],0|te.instancedDataArray.float32[16*le+1],!0,!0):0)+te.instancesEvaluatedElevation[le];te.instancedDataArray.float32[16*le+6]=ce,Q=Q?Math.min(I.terrainElevationMin,ce):ce,j=j?Math.max(I.terrainElevationMax,ce):ce}}return I.terrainElevationMin=Q||0,I.terrainElevationMax=j||0,I.validForExaggeration=q,I.validForDEMTile=P&&P._demTile?{id:P._demTile.tileID,timestamp:P._dem._timestamp}:{id:void 0,timestamp:0},!0}(_,c,d);(y||w)&&(c.uploaded=!1,c.upload(_.context))}const du={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new p.bS([0,0,0],[p.V,p.V,0])};function z0(_,c){const d=1<<_.canonical.z,y=c.getFreeCameraOptions().position,w=c.elevation,C=_.canonical.x/d,I=(_.canonical.x+1)/d,B=_.canonical.y/d,P=(_.canonical.y+1)/d;let Q=c._centerAltitude;if(w){const te=w.getMinMaxForTile(_);te&&te.max>Q&&(Q=te.max)}const j=p.aa(y.x,C,I)-y.x,q=p.aa(y.y,B,P)-y.y,J=p.bl(Q,c.center.lat)-y.z;return c._zoomFromMercatorZ(Math.sqrt(j*j+q*q+J*J))}function f_(_,c,d,y,w,C,I){const B=_.context,P="shadow"===_.renderPass,Q=_.shadowRenderer,j=P&&Q?Q.getShadowPassDepthMode():new kn(B.gl.LEQUAL,kn.ReadWrite,_.depthRangeFor3D),q=_.isTileAffectedByFog(C);if(d.meshes)for(const J of d.meshes){const te=["MODEL_POSITION_ON_GPU"],le=[];let ce,Ae,se;y.instancedDataArray.length>20&&te.push("INSTANCED_ARRAYS");const me=sh(_,c.paint.get("model-cutoff-fade-range"));if(me.shouldRenderCutoff&&te.push("RENDER_CUTOFF"),P&&Q)ce=_.getOrCreateProgram("modelDepth",{defines:te}),Ae=Mp(I.shadowTileMatrix,I.shadowTileMatrix,Float32Array.from(d.matrix)),se=Q.getShadowPassColorMode();else{ko(te,le,J,_),ce=_.getOrCreateProgram("model",{defines:te,overrideFog:q});const xe=J.material,Be=xe.pbrMetallicRoughness,ge=c.paint.get("model-opacity"),Me=c.paint.get("model-emissive-strength").constantOr(0);Ae=h_(C.expandedProjMatrix,Float32Array.from(d.matrix),new Float32Array(16),_,ge,Be.baseColorFactor,xe.emissiveFactor,Be.metallicFactor,Be.roughnessFactor,xe,Me,c,w),Q&&(I.shadowUniformsInitialized?ce.setShadowUniformValues(B,Q.getShadowUniformValues()):(Q.setupShadows(C.toUnwrapped(),ce,"model-tile",C.overscaledZ),I.shadowUniformsInitialized=!0)),se=me.shouldRenderCutoff||ge<1||"OPAQUE"!==xe.alphaMode?Tr.alphaBlended:Tr.unblended}_.uploadCommonUniforms(B,ce,C.toUnwrapped(),null,me);const Ie=J.material.doubleSided?Ri.disabled:Ri.backCCW;if(y.instancedDataArray.length>20)le.push(y.instancedDataBuffer),ce.draw(_,B.gl.TRIANGLES,j,or.disabled,se,Ie,Ae,c.id,J.vertexBuffer,J.indexBuffer,J.segments,c.paint,_.transform.zoom,void 0,le,y.instancedDataArray.length);else{const xe=P?"u_instance":"u_normal_matrix";for(let Be=0;Be<y.instancedDataArray.length;++Be)Ae[xe]=new Float32Array(y.instancedDataArray.arrayBuffer,64*Be,16),ce.draw(_,B.gl.TRIANGLES,j,or.disabled,se,Ie,Ae,c.id,J.vertexBuffer,J.indexBuffer,J.segments,c.paint,_.transform.zoom,void 0,le)}}if(d.children)for(const J of d.children)f_(_,c,J,y,w,C,I)}const Wf=[1,-1,1];function yv(_,c,d,y){if(!d.modelManager)return!0;const w=d.modelManager;if(!d.shadowRenderer)return!0;const C=d.shadowRenderer,I=c.aabb;let B=!0,P=_.maxHeight;if(0===P){let j=0;for(const q in _.instancesPerModel){const J=w.getModel(q,y);J?j=Math.max(j,Math.max(Math.max(J.aabb.max[0],J.aabb.max[1]),J.aabb.max[2])):B=!1}P=_.maxScale*j*1.41+_.maxVerticalOffset,B&&(_.maxHeight=P)}I.max[2]=P,I.min[2]+=_.terrainElevationMin,I.max[2]+=_.terrainElevationMax,p.N.transformMat4(I.min,I.min,c.tileMatrix),p.N.transformMat4(I.max,I.max,c.tileMatrix);const Q=I.intersects(C.getCurrentCascadeFrustum());return 0===d.currentShadowCascade&&(_.isInsideFirstShadowMapFrustum=2===Q),0===Q}class V0{}class H0{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(c,d,y){{const q=this._storage.get(d.id);if(q)return q.lastUsedFrameIdx=c,q.buf}const w=y.gl,C=w.getBufferParameter(w.ELEMENT_ARRAY_BUFFER,w.BUFFER_SIZE),I=new ArrayBuffer(C),B=new Int16Array(I);w.getBufferSubData(w.ELEMENT_ARRAY_BUFFER,0,new Int16Array(I));const P=new p.cW;for(let q=0;q<C/2;q+=3){const J=B[q],te=B[q+1],le=B[q+2];P.emplaceBack(J,te),P.emplaceBack(te,le),P.emplaceBack(le,J)}const Q=y.bindVertexArrayOES.current,j=new V0;return j.buf=new es(y,P),j.lastUsedFrameIdx=c,this._storage.set(d.id,j),y.bindVertexArrayOES.set(Q),j.buf}update(c){for(const[d,y]of this._storage)c-y.lastUsedFrameIdx>30&&(y.buf.destroy(),this._storage.delete(d))}destroy(){for(const[c,d]of this._storage)d.buf.destroy(),this._storage.delete(c)}}class rm{registerParameter(c,d,y,w,C){}registerButton(c,d,y){}}const VA={symbol:function(_,c,d,y,w){if("translucent"!==_.renderPass)return;const C=or.disabled,I=_.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(Q,j,q,J,te,le,ce){const Ae=j.transform,se="map"===te,me="map"===le;for(const Ie of Q){const xe=J.getTile(Ie),Be=xe.getBucket(q);if(!Be||!Be.text||!Be.text.segments.get().length)continue;const ge=p.b5(Be.textSizeData,Ae.zoom),Me=au(Ie,Be.getProjection(),Ae),He=Ae.calculatePixelsToTileUnitsMatrix(xe),Ge=IA(Me,xe.tileID.canonical,me,se,Ae,Be.getProjection(),He),nt=Be.hasIconTextFit()&&Be.hasIconData();if(ge){const dt=Math.pow(2,Ae.zoom-xe.tileID.overscaledZ);Wg(Be,se,me,ce,p.cx,Ae,Ge,Ie,dt,ge,nt)}}}(y,_,d,c,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),w);const B=0!==d.paint.get("icon-opacity").constantOr(1),P=0!==d.paint.get("text-opacity").constantOr(1);void 0!==d.layout.get("symbol-sort-key").constantOr(1)&&(B||P)?Fp(_,c,d,y,C,I):(B&&Fp(_,c,d,y,C,I,{onlyIcons:!0}),P&&Fp(_,c,d,y,C,I,{onlyText:!0})),c.map.showCollisionBoxes&&(Uh(_,c,d,y,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),Uh(_,c,d,y,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(_,c,d,y){if("translucent"!==_.renderPass)return;const w=d.paint.get("circle-opacity"),C=d.paint.get("circle-stroke-width"),I=d.paint.get("circle-stroke-opacity"),B=void 0!==d.layout.get("circle-sort-key").constantOr(1),P=d.paint.get("circle-emissive-strength");if(0===w.constantOr(1)&&(0===C.constantOr(1)||0===I.constantOr(1)))return;const Q=_.context,j=Q.gl,q=_.transform,J=_.depthModeForSublayer(0,kn.ReadOnly),te=or.disabled,le=_.colorModeForDrapableLayerRenderPass(P),ce="globe"===q.projection.name,Ae=[p.a5(q.center.lng),p.ae(q.center.lat)],se=[];for(let Ie=0;Ie<y.length;Ie++){const xe=y[Ie],Be=c.getTile(xe),ge=Be.getBucket(d);if(!ge||ge.projection.name!==q.projection.name)continue;const Me=ge.programConfigurations.get(d.id),He=p.cy(d),Ge=_.isTileAffectedByFog(xe);ce&&He.push("PROJECTION_GLOBE_VIEW");const nt=_.getOrCreateProgram("circle",{config:Me,defines:He,overrideFog:Ge}),dt=ge.layoutVertexBuffer,ot=ge.globeExtVertexBuffer,Pt=ge.indexBuffer,Rt=q.projection.createInversionMatrix(q,xe.canonical),cn={programConfiguration:Me,program:nt,layoutVertexBuffer:dt,globeExtVertexBuffer:ot,indexBuffer:Pt,uniformValues:p.cz(_,xe,Be,Rt,Ae,d),tile:Be};if(B){const ct=ge.segments.get();for(const St of ct)se.push({segments:new p.aB([St]),sortKey:St.sortKey,state:cn})}else se.push({segments:ge.segments,sortKey:0,state:cn})}B&&se.sort((Ie,xe)=>Ie.sortKey-xe.sortKey);const me={useDepthForOcclusion:q.depthOcclusionForSymbolsAndCircles};for(const Ie of se){const{programConfiguration:xe,program:Be,layoutVertexBuffer:ge,globeExtVertexBuffer:Me,indexBuffer:He,uniformValues:Ge,tile:nt}=Ie.state,dt=Ie.segments;_.terrain&&_.terrain.setupElevationDraw(nt,Be,me),_.uploadCommonUniforms(Q,Be,nt.tileID.toUnwrapped()),Be.draw(_,j.TRIANGLES,J,te,le,Ri.disabled,Ge,d.id,ge,He,dt,d.paint,q.zoom,xe,[Me])}},heatmap:function(_,c,d,y){if(0!==d.paint.get("heatmap-opacity"))if("offscreen"===_.renderPass){const w=_.context,C=w.gl,I=or.disabled,B=new Tr([C.ONE,C.ONE,C.ONE,C.ONE],p.ax.transparent,[!0,!0,!0,!0]);(function(te,le,ce,Ae){const se=te.gl,me=le.width*Ae,Ie=le.height*Ae;te.activeTexture.set(se.TEXTURE1),te.viewport.set([0,0,me,Ie]);let xe=ce.heatmapFbo;if(!xe||xe&&(xe.width!==me||xe.height!==Ie)){xe&&xe.destroy();const Be=se.createTexture();se.bindTexture(se.TEXTURE_2D,Be),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.LINEAR),xe=ce.heatmapFbo=te.createFramebuffer(me,Ie,!0,null),function(ge,Me,He,Ge,nt,dt){const ot=ge.gl;ot.texImage2D(ot.TEXTURE_2D,0,ge.extRenderToTextureHalfFloat?ot.RGBA16F:ot.RGBA,nt,dt,0,ot.RGBA,ge.extRenderToTextureHalfFloat?ot.HALF_FLOAT:ot.UNSIGNED_BYTE,null),Ge.colorAttachment.set(He)}(te,0,Be,xe,me,Ie)}else se.bindTexture(se.TEXTURE_2D,xe.colorAttachment.get()),te.bindFramebuffer.set(xe.framebuffer)})(w,_,d,"globe"===_.transform.projection.name?.5:.25),w.clear({color:p.ax.transparent});const P=_.transform,Q="globe"===P.projection.name,j=Q?["PROJECTION_GLOBE_VIEW"]:[],q=Q?Ri.frontCCW:Ri.disabled,J=[p.a5(P.center.lng),p.ae(P.center.lat)];for(let te=0;te<y.length;te++){const le=y[te];if(c.hasRenderableParent(le))continue;const ce=c.getTile(le),Ae=ce.getBucket(d);if(!Ae||Ae.projection.name!==P.projection.name)continue;const se=_.isTileAffectedByFog(le),me=Ae.programConfigurations.get(d.id),Ie=_.getOrCreateProgram("heatmap",{config:me,defines:j,overrideFog:se}),{zoom:xe}=_.transform;_.terrain&&_.terrain.setupElevationDraw(ce,Ie),_.uploadCommonUniforms(w,Ie,le.toUnwrapped());const Be=P.projection.createInversionMatrix(P,le.canonical);Ie.draw(_,C.TRIANGLES,kn.disabled,I,B,q,Gl(_,le,ce,Be,J,xe,d.paint.get("heatmap-intensity")),d.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,d.paint,_.transform.zoom,me,Q?[Ae.globeExtVertexBuffer]:null)}w.viewport.set([0,0,_.width,_.height])}else"translucent"===_.renderPass&&(_.context.setColorMode(_.colorModeForRenderPass()),function(w,C){const I=w.context,B=I.gl,P=C.heatmapFbo;if(!P)return;I.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,P.colorAttachment.get()),I.activeTexture.set(B.TEXTURE1);let Q=C.colorRampTexture;Q||(Q=C.colorRampTexture=new p.T(I,C.colorRamp,B.RGBA)),Q.bind(B.LINEAR,B.CLAMP_TO_EDGE),w.getOrCreateProgram("heatmapTexture").draw(w,B.TRIANGLES,kn.disabled,or.disabled,w.colorModeForRenderPass(),Ri.disabled,{u_image:0,u_color_ramp:1,u_opacity:C.paint.get("heatmap-opacity")},C.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,C.paint,w.transform.zoom)}(_,d))},line:function(_,c,d,y){if("translucent"!==_.renderPass)return;const w=d.paint.get("line-opacity"),C=d.paint.get("line-width");if(0===w.constantOr(1)||0===C.constantOr(1))return;const I=d.paint.get("line-emissive-strength"),B=_.depthModeForSublayer(0,kn.ReadOnly),P=_.colorModeForDrapableLayerRenderPass(I),Q=_.terrain&&_.terrain.renderingToTexture?1:p.f.devicePixelRatio,j=d.paint.get("line-dasharray"),q=j.constantOr(1),J=d.layout.get("line-cap"),te=d.paint.get("line-pattern"),le=te.constantOr(1),ce=d.paint.get("line-pattern").constantOr(1),Ae=1!==d.paint.get("line-opacity").constantOr(1);let se=!ce&&Ae;const me=d.paint.get("line-gradient"),Ie=le?"linePattern":"line",xe=_.context,Be=xe.gl,ge=p.cA(d);_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(se=!1);for(const Me of y){const He=c.getTile(Me);if(le&&!He.patternsLoaded())continue;const Ge=He.getBucket(d);if(!Ge)continue;_.prepareDrawTile();const nt=Ge.programConfigurations.get(d.id),dt=_.isTileAffectedByFog(Me),ot=_.getOrCreateProgram(Ie,{config:nt,defines:ge,overrideFog:dt}),Pt=te.constantOr(null);if(Pt&&He.imageAtlas){const Tn=He.imageAtlas.patternPositions[Pt.toString()];Tn&&nt.setConstantPatternPositions(Tn)}const Rt=j.constantOr(null),cn=J.constantOr(null);if(!le&&Rt&&cn&&He.lineAtlas){const Tn=He.lineAtlas.getDash(Rt,cn);Tn&&nt.setConstantPatternPositions(Tn)}let[ct,St]=d.paint.get("line-trim-offset");("round"===cn||"square"===cn)&&ct!==St&&(0===ct&&(ct-=1),1===St&&(St+=1));const Ze=_.terrain?Me.projMatrix:null,gt=le?p.cB(_,He,d,Ze,Q,[ct,St]):p.cC(_,He,d,Ze,Ge.lineClipsArray.length,Q,[ct,St]);if(me){const Tn=Ge.gradients[d.id];let Cn=Tn.texture;if(d.gradientVersion!==Tn.version){let $n=256;if(d.stepInterpolant){const li=c.getSource().maxzoom,xi=Me.canonical.z===li?Math.ceil(1<<_.transform.maxZoom-Me.canonical.z):1;$n=p.aa(p.cD(Ge.maxLineLength/p.V*1024*xi),256,xe.maxTextureSize)}Tn.gradient=p.cE({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:$n,image:Tn.gradient||void 0,clips:Ge.lineClipsArray}),Tn.texture?Tn.texture.update(Tn.gradient):Tn.texture=new p.T(xe,Tn.gradient,Be.RGBA),Tn.version=d.gradientVersion,Cn=Tn.texture}xe.activeTexture.set(Be.TEXTURE1),Cn.bind(d.stepInterpolant?Be.NEAREST:Be.LINEAR,Be.CLAMP_TO_EDGE)}q&&(xe.activeTexture.set(Be.TEXTURE0),He.lineAtlasTexture&&He.lineAtlasTexture.bind(Be.LINEAR,Be.REPEAT),nt.updatePaintBuffers()),le&&(xe.activeTexture.set(Be.TEXTURE0),He.imageAtlasTexture&&He.imageAtlasTexture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),nt.updatePaintBuffers()),_.uploadCommonUniforms(xe,ot,Me.toUnwrapped());const An=Tn=>{ot.draw(_,Be.TRIANGLES,B,Tn,P,Ri.disabled,gt,d.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,d.paint,_.transform.zoom,nt,[Ge.layoutVertexBuffer2])};if(se){const Tn=_.stencilModeForClipping(Me).ref;0===Tn&&_.terrain&&xe.clear({stencil:0});const Cn={func:Be.EQUAL,mask:255};gt.u_alpha_discard_threshold=.8,An(new or(Cn,Tn,255,Be.KEEP,Be.KEEP,Be.INVERT)),gt.u_alpha_discard_threshold=0,An(new or(Cn,Tn,255,Be.KEEP,Be.KEEP,Be.KEEP))}else An(_.stencilModeForClipping(Me))}se&&(_.resetStencilClippingMasks(),_.terrain&&xe.clear({stencil:0}))},fill:function(_,c,d,y){const w=d.paint.get("fill-color"),C=d.paint.get("fill-opacity");if(0===C.constantOr(1))return;const I=d.paint.get("fill-emissive-strength"),B=_.colorModeForDrapableLayerRenderPass(I),P=d.paint.get("fill-pattern"),Q=_.opaquePassEnabledForLayer()&&!P.constantOr(1)&&1===w.constantOr(p.ax.transparent).a&&1===C.constantOr(0)?"opaque":"translucent";if(_.renderPass===Q){const j=_.depthModeForSublayer(1,"opaque"===_.renderPass?kn.ReadWrite:kn.ReadOnly);NA(_,c,d,y,j,B,!1)}if("translucent"===_.renderPass&&d.paint.get("fill-antialias")){const j=_.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,kn.ReadOnly);NA(_,c,d,y,j,B,!0)}},"fill-extrusion":function(_,c,d,y){const w=d.paint.get("fill-extrusion-opacity"),C=_.context,I=C.gl,B=_.terrain,P=B&&B.renderingToTexture;if(0===w)return;const Q=_.conflationActive&&_.layerUsedInConflation(d,c.getSource());if(Q&&function(j,q,J,te){for(const le of te){const ce=q.getTile(le).getBucket(J);ce&&(ce.updateReplacement(le,j.replacementSource),ce.uploadCentroid(j.context))}}(_,c,d,y),B||Q)for(const j of y){const q=c.getTile(j).getBucket(d);q&&ef(_.context,c,j,q,d,B,Q)}if("shadow"===_.renderPass&&_.shadowRenderer){const j=_.shadowRenderer;if(B&&w<.65&&d._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof p.Z)return;const q=j.getShadowPassDepthMode(),J=j.getShadowPassColorMode();gi(_,c,d,y,q,or.disabled,J,Q)}else if("translucent"===_.renderPass){const j=!d.paint.get("fill-extrusion-pattern").constantOr(1),q=d.paint.get("fill-extrusion-color").constantOr(p.ax.white);if(!P&&0!==q.a){const J=new kn(_.context.gl.LEQUAL,kn.ReadWrite,_.depthRangeFor3D);1===w&&j?gi(_,c,d,y,J,or.disabled,Tr.unblended,Q):(gi(_,c,d,y,J,or.disabled,Tr.disabled,Q),gi(_,c,d,y,J,_.stencilModeFor3D(),_.colorModeForRenderPass(),Q),_.resetStencilClippingMasks())}if(_.style.enable3dLights()&&j&&(!B&&"globe"!==_.transform.projection.name||P)){const J=d.paint.get("fill-extrusion-opacity"),te=d.paint.get("fill-extrusion-ambient-occlusion-intensity"),le=d.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ce=d.paint.get("fill-extrusion-flood-light-intensity"),Ae=d.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),se=te>0&&le>0,me=ce>0,Ie=(Be,ge,Me)=>(1-Me)*Be+Me*ge,xe=Be=>{const ge=_.depthModeForSublayer(1,kn.ReadOnly,I.LEQUAL,!0),Me=d.paint.get(Be?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),He=Ie(.1,3,Me),Ge=_._showOverdrawInspector;if(!Ge){const nt=new or({func:I.ALWAYS,mask:255},255,255,I.KEEP,I.KEEP,I.REPLACE),dt=new Tr([I.ONE,I.ONE,I.ONE,I.ONE],p.ax.transparent,[!1,!1,!1,!0],I.MIN);zc(_,c,d,y,ge,nt,dt,Ri.disabled,Be,"sdf",J,te,le,ce,Ae,He,Q,!1)}{const nt=Ge?or.disabled:new or({func:I.EQUAL,mask:255},255,255,I.KEEP,I.DECR,I.DECR),dt=Ge?_.colorModeForRenderPass():new Tr([I.ONE_MINUS_DST_ALPHA,I.DST_ALPHA,I.ONE,I.ONE],p.ax.transparent,[!0,!0,!0,!0]);zc(_,c,d,y,ge,nt,dt,Ri.disabled,Be,"color",J,te,le,ce,Ae,He,Q,!1)}};if(P){const Be=(ge,Me,He)=>{const Ge=_.depthModeForSublayer(1,kn.ReadOnly,I.LEQUAL,!1),nt=d.paint.get(ge?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),dt=Ie(.1,3,nt);{const ot=new Tr([I.ONE,I.ONE,I.ONE,I.ONE],p.ax.transparent,[!1,!1,!1,!0]);zc(_,c,d,y,Ge,or.disabled,ot,Ri.disabled,ge,"clear",J,te,le,ce,Ae,dt,Q,Me)}{const ot=new or({func:I.ALWAYS,mask:255},255,255,I.KEEP,I.KEEP,I.REPLACE),Pt=new Tr([I.ONE,I.ONE,I.ONE,I.ONE],p.ax.transparent,[!1,!1,!1,!0],I.MIN);zc(_,c,d,y,Ge,ot,Pt,Ri.disabled,ge,"sdf",J,te,le,ce,Ae,dt,Q,Me)}{const ot=ge?I.ZERO:I.ONE_MINUS_DST_ALPHA,Pt=new or({func:I.EQUAL,mask:255},255,255,I.KEEP,I.DECR,I.DECR),Rt=new Tr([ot,I.DST_ALPHA,I.ONE_MINUS_DST_ALPHA,I.ZERO],p.ax.transparent,[!0,!0,!0,!0]);zc(_,c,d,y,Ge,Pt,Rt,Ri.disabled,ge,"color",J,te,le,ce,Ae,dt,Q,Me)}{const ot=new Tr([I.ONE,I.ONE,I.ONE,ge?I.ZERO:I.ONE],p.ax.transparent,[!1,!1,!1,!0],ge?I.FUNC_ADD:I.MAX);zc(_,c,d,y,Ge,or.disabled,ot,Ri.disabled,ge,"clear",J,te,le,ce,Ae,dt,Q,Me,He)}};if(se||me){let ge;if(_.prepareDrawTile(),B){const Me=B.drapeBufferSize[0],He=B.drapeBufferSize[1];ge=B.framebufferCopyTexture,ge&&(!ge||ge.size[0]===Me&&ge.size[1]===He)||(ge&&ge.destroy(),ge=B.framebufferCopyTexture=new p.T(C,new p.h({width:Me,height:He}),I.RGBA)),ge.bind(I.LINEAR,I.CLAMP_TO_EDGE),I.copyTexImage2D(I.TEXTURE_2D,0,I.RGBA,0,0,Me,He,0)}se&&Be(!0,!1,ge),me&&Be(!1,!0,ge)}}else se&&xe(!0),me&&xe(!1)}}},hillshade:function(_,c,d,y){if("offscreen"!==_.renderPass&&"translucent"!==_.renderPass||_.style.disableElevatedTerrain)return;const w=_.context,C=_.terrain&&_.terrain.renderingToTexture,[I,B]="translucent"!==_.renderPass||C?[{},y]:_.stencilConfigForOverlap(y);for(const P of B){const Q=c.getTile(P);if(Q.needsHillshadePrepare&&"offscreen"===_.renderPass)Hf(_,Q,d);else if("translucent"===_.renderPass){const j=_.depthModeForSublayer(0,kn.ReadOnly),q=d.paint.get("hillshade-emissive-strength"),J=_.colorModeForDrapableLayerRenderPass(q),te=C&&_.terrain?_.terrain.stencilModeForRTTOverlap(P):I[P.overscaledZ];Wo(_,P,Q,d,j,te,J)}}w.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,c,d,y,w,C){if("translucent"!==_.renderPass||0===d.paint.get("raster-opacity"))return;const I="globe"===_.transform.projection.name,B=0!==d.paint.get("raster-elevation"),P=B&&I;if(_.renderElevatedRasterBackface&&!P)return;const Q=_.context,j=Q.gl,q=c.getSource(),J=function(ge,Me,He,Ge){const nt=Me.paint.get("raster-color"),dt="raster-array"===ge.type,ot=[],Pt=Me.paint.get("raster-resampling"),Rt=Me.paint.get("raster-color-mix");let cn=Me.paint.get("raster-color-range");const ct=[Rt[0],Rt[1],Rt[2],0],St=Rt[3];let Ze="nearest"===Pt?Ge.NEAREST:Ge.LINEAR;if(dt&&(ot.push("RASTER_ARRAY"),nt||ot.push("RASTER_COLOR"),"linear"===Pt&&ot.push("RASTER_ARRAY_LINEAR"),Ze=Ge.NEAREST,!cn&&ge.rasterLayers)){const gt=ge.rasterLayers.find(({id:An})=>An===Me.sourceLayer);gt&&gt.fields&&gt.fields.range&&(cn=gt.fields.range)}if(cn=cn||[0,1],nt){ot.push("RASTER_COLOR"),He.activeTexture.set(Ge.TEXTURE2),Me.updateColorRamp(cn);let gt=Me.colorRampTexture;gt||(gt=Me.colorRampTexture=new p.T(He,Me.colorRamp,Ge.RGBA)),gt.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE)}return{mix:ct,range:cn,offset:St,defines:ot,resampling:Ze}}(q,d,Q,j);if(q instanceof p.ap&&!y.length&&!I)return;const te=d.paint.get("raster-emissive-strength"),le=_.colorModeForDrapableLayerRenderPass(te),ce=_.terrain&&_.terrain.renderingToTexture,Ae=!_.options.moving,se="nearest"===d.paint.get("raster-resampling")?j.NEAREST:j.LINEAR;if(q instanceof p.ap&&!y.length&&(q.onNorthPole||q.onSouthPole)){const ge=B?_.stencilModeFor3D():or.disabled;return void Zg(!!q.onNorthPole,null,_,c,d,te,J,Ri.disabled,ge)}if(!y.length)return;const[me,Ie]=q instanceof p.ap||ce?[{},y]:_.stencilConfigForOverlap(y),xe=Ie[Ie.length-1].overscaledZ;P&&J.defines.push("PROJECTION_GLOBE_VIEW"),B&&J.defines.push("RENDER_CUTOFF");const Be=(ge,Me,He)=>{for(const Ge of ge){const nt=Ge.toUnwrapped(),dt=c.getTile(Ge);if(ce&&(!dt||!dt.hasData()))continue;Q.activeTexture.set(j.TEXTURE0);const ot=Yg(dt,q,d,J);if(!ot||!ot.texture)continue;const{texture:Pt,mix:Rt,offset:cn,tileSize:ct,buffer:St}=ot;let Ze,gt;ce?(Ze=kn.disabled,gt=Ge.projMatrix):B?(Ze=new kn(j.LEQUAL,kn.ReadWrite,_.depthRangeFor3D),gt=I?Float32Array.from(_.transform.expandedFarZProjMatrix):_.transform.calculateProjMatrix(nt,Ae)):(Ze=_.depthModeForSublayer(Ge.overscaledZ-xe,1===d.paint.get("raster-opacity")?kn.ReadWrite:kn.ReadOnly,j.LESS),gt=_.transform.calculateProjMatrix(nt,Ae));const An=_.terrain&&ce?_.terrain.stencilModeForRTTOverlap(Ge):me[Ge.overscaledZ],Tn=C?0:d.paint.get("raster-fade-duration");dt.registerFadeDuration(Tn);const Cn=c.findLoadedParent(Ge,0),$n=ba(dt,Cn,c,_.transform,Tn);let li,xi;_.terrain&&_.terrain.prepareDrawTile(),Q.activeTexture.set(j.TEXTURE0),Pt.bind(se,j.CLAMP_TO_EDGE),Q.activeTexture.set(j.TEXTURE1),Cn?(Cn.texture&&Cn.texture.bind(se,j.CLAMP_TO_EDGE),li=Math.pow(2,Cn.tileID.overscaledZ-dt.tileID.overscaledZ),xi=[dt.tileID.canonical.x*li%1,dt.tileID.canonical.y*li%1]):Pt.bind(se,j.CLAMP_TO_EDGE),Pt.useMipmap&&Q.extTextureFilterAnisotropic&&_.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,Q.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Q.extTextureFilterAnisotropicMax);const yi=_.transform;let ci;const gr=B?Xg(yi):[0,0,0,0];let Ki,lr,rr,kr,qs,Fr=0;if(P&&q instanceof p.ap&&q.coordinates.length>3)Ki=Float32Array.from(p.aT(p.ci(new p.bs(0,0,0)))),lr=Float32Array.from(yi.globeMatrix),rr=Float32Array.from(p.ce(yi)),kr=[p.a5(yi.center.lng),p.ae(yi.center.lat)],ci=q.elevatedGlobePerspectiveTransform,qs=q.elevatedGlobeGridMatrix||new Float32Array(9);else if(P){const br=p.cf(Ge.canonical);Fr=p.cg(br.getCenter().lat),Ki=Float32Array.from(p.aT(p.ci(Ge.canonical))),lr=Float32Array.from(yi.globeMatrix),rr=Float32Array.from(p.ce(yi)),kr=[p.a5(yi.center.lng),p.ae(yi.center.lat)],ci=[0,0],qs=Float32Array.from(p.ch(Ge.canonical,br,Fr,yi.worldSize/yi._pixelsPerMercatorPixel))}else ci=q instanceof p.ap?q.perspectiveTransform:[0,0],Ki=new Float32Array(16),lr=new Float32Array(9),rr=new Float32Array(16),kr=[0,0],qs=new Float32Array(9);const Po=_d(gt,Ki,lr,rr,qs,xi||[0,0],p.S(_.transform.zoom),kr,gr,li||1,$n,d,ci,B?d.paint.get("raster-elevation"):0,2,Rt,cn,J.range,ct,St,te),Dr=_.isTileAffectedByFog(Ge),jr=_.getOrCreateProgram("raster",{defines:J.defines,overrideFog:Dr});if(_.uploadCommonUniforms(Q,jr,nt),q instanceof p.ap){const br=q.elevatedGlobeVertexBuffer,Xr=q.elevatedGlobeIndexBuffer;if(ce||!I)q.boundsBuffer&&q.boundsSegments&&jr.draw(_,j.TRIANGLES,Ze,or.disabled,le,Ri.disabled,Po,d.id,q.boundsBuffer,_.quadTriangleIndexBuffer,q.boundsSegments);else if(br&&Xr){const eo=yi.zoom<=p.bG?q.elevatedGlobeSegments:q.getSegmentsForLongitude(yi.center.lng);eo&&jr.draw(_,j.TRIANGLES,Ze,or.disabled,le,Me,Po,d.id,br,Xr,eo)}}else if(P){Ze=new kn(j.LEQUAL,kn.ReadOnly,_.depthRangeFor3D);const br=_.globeSharedBuffers;if(br){const[Xr,eo,zr]=br.getGridBuffers(Fr,!1);jr.draw(_,j.TRIANGLES,Ze,He||An,_.colorModeForRenderPass(),Me,Po,d.id,Xr,eo,zr)}}else{const{tileBoundsBuffer:br,tileBoundsIndexBuffer:Xr,tileBoundsSegments:eo}=_.getTileBoundsBuffers(dt);jr.draw(_,j.TRIANGLES,Ze,An,le,Ri.disabled,Po,d.id,br,Xr,eo)}}if(!(q instanceof p.ap)&&P)for(const Ge of ge){const nt=Ge.canonical.y===(1<<Ge.canonical.z)-1;0===Ge.canonical.y&&Zg(!0,Ge,_,c,d,te,J,Me,He||or.disabled),nt&&Zg(!1,Ge,_,c,d,te,J,Me===Ri.frontCW?Ri.backCW:Ri.frontCW,He||or.disabled)}};P?Be(Ie,_.renderElevatedRasterBackface?Ri.backCW:Ri.frontCW,_.stencilModeFor3D()):Be(Ie,Ri.disabled,void 0),_.resetStencilClippingMasks()},"raster-particle":function(_,c,d,y,w,C){"offscreen"===_.renderPass&&function(I,B,P,Q){if(!Q.length)return;const j=I.context,q=j.gl,J=B.getSource();if(!(J instanceof Ln))return;const te=[];for(const Ae of Q){const se=B.getTile(Ae);if(!(se instanceof Il))continue;const me=Op(se,J,P);if(!me)continue;const Ie=[me.tileSize,me.tileSize];let xe=P.tileFramebuffer;xe||(xe=P.tileFramebuffer=j.createFramebuffer(Ie[0],Ie[1],!0,null));let Be=se.rasterParticleState;const ge=P.paint.get("raster-particle-count");Be||(Be=se.rasterParticleState=new Oo(j,Ae,Ie,ge));const Me=Be.update(P.lastInvalidatedAt);Be.numParticles!==ge&&Be.setNumParticles(Ae,ge);const He=Be.targetColorTexture;Be.targetColorTexture=Be.backgroundColorTexture,Be.backgroundColorTexture=He;const Ge=Be.particleVertices0;Be.particleVertices0=Be.particleVertices1,Be.particleVertices1=Ge,te.push([Ae,me,Be,Me])}if(0===te.length)return;const le=p.f.now(),ce=P.previousDrawTimestamp?.001*(le-P.previousDrawTimestamp):.0167;if(P.previousDrawTimestamp=le,P.hasColorMap()){j.activeTexture.set(q.TEXTURE0+2);let Ae=P.colorRampTexture;Ae||(Ae=P.colorRampTexture=new p.T(j,P.colorRamp,q.RGBA)),Ae.bind(q.LINEAR,q.CLAMP_TO_EDGE)}j.bindFramebuffer.set(P.tileFramebuffer.framebuffer),j.activeTexture.set(q.TEXTURE0),function(Ae,se,me){const Ie=Ae.context,xe=Ie.gl,Be=se.tileFramebuffer;Ie.activeTexture.set(xe.TEXTURE0);const ge={u_texture:0,u_opacity:1.05*(He=se.paint.get("raster-particle-fade-opacity-factor"))/(He+.05)},Me=Ae.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var He;for(const Ge of me){const[,,nt,dt]=Ge;Be.colorAttachment.set(nt.targetColorTexture.texture),Ie.viewport.set([0,0,Be.width,Be.height]),Ie.clear({color:p.ax.transparent}),dt&&(nt.backgroundColorTexture.bind(xe.NEAREST,xe.CLAMP_TO_EDGE),Me.draw(Ae,xe.TRIANGLES,kn.disabled,or.disabled,Tr.alphaBlended,Ri.disabled,ge,se.id,Ae.viewportBuffer,Ae.quadTriangleIndexBuffer,Ae.viewportSegments))}}(I,P,te),function(Ae,se,me,Ie){const xe=Ae.context.gl,Be=me.tileFramebuffer,ge="globe"===Ae.transform.projection.name,Me=me.paint.get("raster-particle-max-speed");for(const He of Ie){const[Ge,nt,dt]=He;nt.texture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),Be.colorAttachment.set(dt.targetColorTexture.texture);const ot=Ae.getOrCreateProgram("rasterParticleDraw",{defines:nt.defines,overrideFog:!1}),Pt=nt.scalarData?[]:[0,1,2,3].map(ct=>p.cG[ct](Ge));Pt.push(Ge);const Rt=Ge.canonical.x,cn=Ge.canonical.y;for(const ct of Pt){const St=se.getTile(ge?ct.wrapped():ct);if(!St)continue;const Ze=St.rasterParticleState;if(!Ze)continue;const gt=mv([ct.canonical.x+(1<<ct.canonical.z)*(ct.wrap-Ge.wrap)-Rt,ct.canonical.y-cn],0,nt.texture.size,2,Me,nt.textureOffset,nt.scale,nt.offset);ot.draw(Ae,xe.POINTS,kn.disabled,or.disabled,Tr.alphaBlended,Ri.disabled,gt,me.id,Ze.particleVertices0,void 0,Ze.particleSegment)}}}(I,B,P,te),function(Ae,se,me,Ie){const xe=Ae.context.gl;let Be=se.transformFeedbackObject;Be||(Be=se.transformFeedbackObject=xe.createTransformFeedback()),xe.bindTransformFeedback(xe.TRANSFORM_FEEDBACK,se.transformFeedbackObject);const ge=se.paint.get("raster-particle-max-speed"),Me=Ie*se.paint.get("raster-particle-speed-factor")*.3,He=(Ge=se.paint.get("raster-particle-reset-rate-factor"),Math.pow(Ge,6));var Ge;for(const nt of me){const[,dt,ot]=nt;dt.texture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE);const Pt=N0(0,dt.texture.size,ge,Me,He,dt.textureOffset,dt.scale,dt.offset);Ae.getOrCreateProgram("rasterParticleUpdate",{defines:dt.defines,transformFeedback:{bufferMode:xe.SEPARATE_ATTRIBS,shaderVaryings:["v_new_particle"]}}).draw(Ae,xe.POINTS,kn.disabled,or.disabled,Tr.disabled,Ri.disabled,Pt,se.id,ot.particleVertices0,void 0,ot.particleSegment,{},void 0,void 0,void 0,void 0,[{buffer:ot.particleVertices1,targetIndex:0}])}xe.bindTransformFeedback(xe.TRANSFORM_FEEDBACK,null)}(I,P,te,ce)}(_,c,d,y),"translucent"===_.renderPass&&(function(I,B,P,Q,j){const q=I.context,J=q.gl,te=!I.options.moving,le="globe"===I.transform.projection.name;if(!Q.length)return;const[ce,Ae]=I.stencilConfigForOverlap(Q),se=[];le&&se.push("PROJECTION_GLOBE_VIEW");for(const me of Ae){const Ie=me.toUnwrapped(),xe=B.getTile(me);if(!xe.rasterParticleState)continue;const Be=xe.rasterParticleState,ge=100;xe.registerFadeDuration(ge);const Me=B.findLoadedParent(me,0),He=ba(xe,Me,B,I.transform,ge);let Ge,nt;I.terrain&&I.terrain.prepareDrawTile(),q.activeTexture.set(J.TEXTURE0),Be.targetColorTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),q.activeTexture.set(J.TEXTURE1),Me&&Me.rasterParticleState?(Me.rasterParticleState.targetColorTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Ge=Math.pow(2,Me.tileID.overscaledZ-xe.tileID.overscaledZ),nt=[xe.tileID.canonical.x*Ge%1,xe.tileID.canonical.y*Ge%1]):Be.targetColorTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE);const dt=le?Float32Array.from(I.transform.expandedFarZProjMatrix):I.transform.calculateProjMatrix(Ie,te),ot=I.transform,Pt=kp(ot),Rt=p.cf(me.canonical),cn=p.cg(Rt.getCenter().lat);let ct,St,Ze,gt,An;le?(ct=Float32Array.from(p.aT(p.ci(me.canonical))),St=Float32Array.from(ot.globeMatrix),Ze=Float32Array.from(p.ce(ot)),gt=[p.a5(ot.center.lng),p.ae(ot.center.lat)],An=Float32Array.from(p.ch(me.canonical,Rt,cn,ot.worldSize/ot._pixelsPerMercatorPixel))):(ct=new Float32Array(16),St=new Float32Array(9),Ze=new Float32Array(16),gt=[0,0],An=new Float32Array(9));const Tn=c_(dt,ct,St,Ze,An,nt||[0,0],p.S(I.transform.zoom),gt,Pt,Ge||1,He,250),Cn=I.isTileAffectedByFog(me),$n=I.getOrCreateProgram("rasterParticle",{defines:se,overrideFog:Cn});if(I.uploadCommonUniforms(q,$n,Ie),le){const li=new kn(J.LEQUAL,kn.ReadWrite,I.depthRangeFor3D),xi=0,yi=I.globeSharedBuffers;if(yi){const[ci,gr,Ki]=yi.getGridBuffers(cn,0!==xi);$n.draw(I,J.TRIANGLES,li,or.disabled,Tr.alphaBlended,Ri.backCCW,Tn,P.id,ci,gr,Ki)}}else{const li=I.depthModeForSublayer(0,kn.ReadOnly),xi=ce[me.overscaledZ],{tileBoundsBuffer:yi,tileBoundsIndexBuffer:ci,tileBoundsSegments:gr}=I.getTileBoundsBuffers(xe);$n.draw(I,J.TRIANGLES,li,xi,Tr.alphaBlended,Ri.disabled,Tn,P.id,yi,ci,gr)}}I.resetStencilClippingMasks()}(_,c,d,y),_.style.map.triggerRepaint())},background:function(_,c,d,y){const w=d.paint.get("background-color"),C=d.paint.get("background-opacity"),I=d.paint.get("background-emissive-strength");if(0===C)return;const B=_.context,P=B.gl,Q=_.transform,j=Q.tileSize,q=d.paint.get("background-pattern");if(_.isPatternMissing(q,d.scope))return;const J=!q&&1===w.a&&1===C&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==J)return;const te=or.disabled,le=_.depthModeForSublayer(0,"opaque"===J?kn.ReadWrite:kn.ReadOnly),ce=_.colorModeForDrapableLayerRenderPass(I),Ae=q?"backgroundPattern":"background";let se,me=y;me||(se=_.getBackgroundTiles(),me=Object.values(se).map(Ie=>Ie.tileID)),q&&(B.activeTexture.set(P.TEXTURE0),_.imageManager.bind(_.context,d.scope));for(const Ie of me){const xe=_.isTileAffectedByFog(Ie),Be=_.getOrCreateProgram(Ae,{overrideFog:xe}),ge=Ie.toUnwrapped(),Me=y?Ie.projMatrix:_.transform.calculateProjMatrix(ge);_.prepareDrawTile();const He=c?c.getTile(Ie):se?se[Ie.key]:new Rf(Ie,j,Q.zoom,_),Ge=q?$g(Me,I,C,_,q,d.scope,{tileID:Ie,tileSize:j}):L0(Me,I,C,w);_.uploadCommonUniforms(B,Be,ge);const{tileBoundsBuffer:nt,tileBoundsIndexBuffer:dt,tileBoundsSegments:ot}=_.getTileBoundsBuffers(He);Be.draw(_,P.TRIANGLES,le,te,ce,Ri.disabled,Ge,d.id,nt,dt,ot)}},sky:function(_,c,d){const y=_._atmosphere?p.S(_.transform.zoom):1,w=d.paint.get("sky-opacity")*y;if(0===w)return;const C=_.context,I=d.paint.get("sky-type"),B=new kn(C.gl.LEQUAL,kn.ReadOnly,[0,1]),P=_.frameCounter/1e3%1;"atmosphere"===I?"offscreen"===_.renderPass?d.needsSkyboxCapture(_)&&(function(Q,j,q,J){const te=Q.context,le=te.gl;let ce=j.skyboxFbo;if(!ce){ce=j.skyboxFbo=te.createFramebuffer(32,32,!0,null),j.skyboxGeometry=new d_(te),j.skyboxTexture=te.gl.createTexture(),le.bindTexture(le.TEXTURE_CUBE_MAP,j.skyboxTexture),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_S,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_T,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MIN_FILTER,le.LINEAR),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MAG_FILTER,le.LINEAR);for(let Ie=0;Ie<6;++Ie)le.texImage2D(le.TEXTURE_CUBE_MAP_POSITIVE_X+Ie,0,le.RGBA,32,32,0,le.RGBA,le.UNSIGNED_BYTE,null)}te.bindFramebuffer.set(ce.framebuffer),te.viewport.set([0,0,32,32]);const Ae=j.getCenter(Q,!0),se=Q.getOrCreateProgram("skyboxCapture"),me=new Float64Array(16);p.a6.identity(me),p.a6.rotateY(me,me,.5*-Math.PI),fh(Q,j,se,me,Ae,0),p.a6.identity(me),p.a6.rotateY(me,me,.5*Math.PI),fh(Q,j,se,me,Ae,1),p.a6.identity(me),p.a6.rotateX(me,me,.5*-Math.PI),fh(Q,j,se,me,Ae,2),p.a6.identity(me),p.a6.rotateX(me,me,.5*Math.PI),fh(Q,j,se,me,Ae,3),p.a6.identity(me),fh(Q,j,se,me,Ae,4),p.a6.identity(me),p.a6.rotateY(me,me,Math.PI),fh(Q,j,se,me,Ae,5),te.viewport.set([0,0,Q.width,Q.height])}(_,d),d.markSkyboxValid(_)):"sky"===_.renderPass&&function(Q,j,q,J,te){const le=Q.context,ce=le.gl,Ae=Q.transform,se=Q.getOrCreateProgram("skybox");le.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_CUBE_MAP,j.skyboxTexture);const me={u_matrix:Ae.skyboxMatrix,u_sun_direction:j.getCenter(Q,!1),u_cubemap:0,u_opacity:J,u_temporal_offset:te};Q.uploadCommonUniforms(le,se),se.draw(Q,ce.TRIANGLES,q,or.disabled,Q.colorModeForRenderPass(),Ri.backCW,me,"skybox",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(_,d,B,w,P):"gradient"===I&&"sky"===_.renderPass&&function(Q,j,q,J,te){const le=Q.context,ce=le.gl,Ae=Q.transform,se=Q.getOrCreateProgram("skyboxGradient");j.skyboxGeometry||(j.skyboxGeometry=new d_(le)),le.activeTexture.set(ce.TEXTURE0);let me=j.colorRampTexture;me||(me=j.colorRampTexture=new p.T(le,j.colorRamp,ce.RGBA)),me.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const Ie=(xe=Ae.skyboxMatrix,Be=j.getCenter(Q,!1),ge=j.paint.get("sky-gradient-radius"),Me=J,He=te,{u_matrix:xe,u_color_ramp:0,u_center_direction:Be,u_radius:p.bj(ge),u_opacity:Me,u_temporal_offset:He});var xe,Be,ge,Me,He;Q.uploadCommonUniforms(le,se),se.draw(Q,ce.TRIANGLES,q,or.disabled,Q.colorModeForRenderPass(),Ri.backCW,Ie,"skyboxGradient",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(_,d,B,w,P)},debug:function(_,c,d,y,w,C){for(let I=0;I<d.length;I++)if(w){const Q=new p.ax(.8*y.r,.8*y.g,.8*y.b,1);Vh(_,c,d[I],y,-1,-1,C),Vh(_,c,d[I],y,-1,1,C),Vh(_,c,d[I],y,1,1,C),Vh(_,c,d[I],y,1,-1,C),Vh(_,c,d[I],Q,0,0,C)}else Vh(_,c,d[I],y,0,0,C)},custom:function(_,c,d,y){const w=_.context,C=d.implementation;if(!_.transform.projection.unsupportedLayers||!_.transform.projection.unsupportedLayers.includes("custom")||_.terrain&&(_.terrain.renderingToTexture||"offscreen"===_.renderPass)&&d.isLayerDraped(c)){if("offscreen"===_.renderPass){const I=C.prerender;if(I){if(_.setCustomLayerDefaults(),w.setColorMode(_.colorModeForRenderPass()),"globe"===_.transform.projection.name){const B=_.transform.pointMerc;I.call(C,w.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),p.S(_.transform.zoom),[B.x,B.y],_.transform.pixelsPerMeterRatio)}else I.call(C,w.gl,_.transform.customLayerMatrix());w.setDirty(),_.setBaseState()}}else if("translucent"===_.renderPass){if(_.terrain&&_.terrain.renderingToTexture){const B=C.renderToTile;if(B){const P=y[0].canonical,Q=new p.L(P.x+y[0].wrap*(1<<P.z),P.y,P.z);w.setDepthMode(kn.disabled),w.setStencilMode(or.disabled),w.setColorMode(_.colorModeForRenderPass()),_.setCustomLayerDefaults(),B.call(C,w.gl,Q),w.setDirty(),_.setBaseState()}return}_.setCustomLayerDefaults(),w.setColorMode(_.colorModeForRenderPass()),w.setStencilMode(or.disabled);const I="3d"===C.renderingMode?new kn(_.context.gl.LEQUAL,kn.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,kn.ReadOnly);if(w.setDepthMode(I),"globe"===_.transform.projection.name){const B=_.transform.pointMerc;C.render(w.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),p.S(_.transform.zoom),[B.x,B.y],_.transform.pixelsPerMeterRatio)}else C.render(w.gl,_.transform.customLayerMatrix());w.setDirty(),_.setBaseState(),w.bindFramebuffer.set(null)}}else p.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(_,c,d,y){if("opaque"===_.renderPass)return;const w=d.paint.get("model-opacity");if(0===w)return;const C=d.paint.get("model-cast-shadows");if("shadow"===_.renderPass&&(!C||_.terrain&&w<.65&&d._transitionablePaint._values["model-opacity"].value.expression instanceof p.Z))return;const I=_.shadowRenderer,B=d.paint.get("model-receive-shadows");I&&(I.useNormalOffset=!0,B||(I.enabled=!1));const P=()=>{I&&(I.useNormalOffset=!0,B||(I.enabled=!0))},Q=c.getSource();if("light-beam"===_.renderPass&&"batched-model"!==Q.type)return;if("vector"===Q.type||"geojson"===Q.type)return function(se,me,Ie,xe){const Be=se.transform;if("mercator"!==Be.projection.name)return void p.w(`Drawing 3D models for ${Be.projection.name} projection is not yet implemented`);const ge=Be.getFreeCameraOptions().position;if(!se.modelManager)return;const Me=se.modelManager;Ie.modelManager=Me;const He=se.shadowRenderer;if(!Ie._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ge=Ie._unevaluatedLayout._values["model-id"],nt={...Ie.layout.get("model-id").parameters};for(const dt of xe){const ot=me.getTile(dt).getBucket(Ie);if(!ot||ot.projection.name!==Be.projection.name)continue;const Pt=z0(dt,Be);nt.zoom=Pt;const Rt=Ge.possiblyEvaluate(nt);if(zA(se,ot,dt),du.shadowUniformsInitialized=!1,du.useSingleShadowCascade=!!He&&0===He.getMaxCascadeForTile(dt.toUnwrapped()),"shadow"===se.renderPass&&He){if(1===se.currentShadowCascade&&ot.isInsideFirstShadowMapFrustum)continue;const St=Be.calculatePosMatrix(dt.toUnwrapped(),Be.worldSize);if(du.tileMatrix.set(St),du.shadowTileMatrix=Float32Array.from(He.calculateShadowPassMatrixFromMatrix(St)),du.aabb.min.fill(0),du.aabb.max[0]=du.aabb.max[1]=p.V,du.aabb.max[2]=0,yv(ot,du,se,Ie.scope))continue}const cn=1<<dt.canonical.z,ct=[((ge.x-dt.wrap)*cn-dt.canonical.x)*p.V,(ge.y*cn-dt.canonical.y)*p.V,ge.z*cn*p.V];for(let St in ot.instancesPerModel){const Ze=ot.instancesPerModel[St];Ze.features.length>0&&(St=Rt.evaluate(Ze.features[0].feature,{}));const gt=Me.getModel(St,Ie.scope);if(gt&&gt.uploaded)for(const An of gt.nodes)f_(se,Ie,An,Ze,ct,dt,du)}}}(_,c,d,y),void P();if(!Q.loaded())return;if("batched-model"===Q.type)return function(se,me,Ie,xe){Ie.resetLayerRenderingStats(se);const Be=se.context,ge=se.transform,Me=se.style.fog,He=se.shadowRenderer;if("mercator"!==ge.projection.name)return void p.w(`Drawing 3D landmark models for ${ge.projection.name} projection is not yet implemented`);const Ge=se.transform.getFreeCameraOptions().position,nt=p.N.scale([],[Ge.x,Ge.y,Ge.z],se.transform.worldSize);p.N.negate(nt,nt);const dt=p.a6.identity([]),ot=p.cR(ge.center.lat,ge.zoom),Pt=p.a6.fromScaling([],[1,1,1/ot]);p.a6.translate(dt,dt,nt);const Rt=Ie.paint.get("model-opacity"),cn=new kn(Be.gl.LEQUAL,kn.ReadWrite,se.depthRangeFor3D),ct=new kn(Be.gl.LEQUAL,kn.ReadOnly,se.depthRangeFor3D),St=new p.bS([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Ze="shadow"===se.renderPass,gt=Ze&&He?He.getCurrentCascadeFrustum():ge.getFrustum(ge.scaleZoom(ge.worldSize)),An=Ie.getLayerRenderingStats(),Tn=function(Cn,$n){for(const li of xe){const xi=me.getTile(li).getBucket(Ie);if(!xi||!xi.uploaded)continue;let yi=!1;He&&(yi=0===He.getMaxCascadeForTile(li.toUnwrapped()));const ci=ge.calculatePosMatrix(li.toUnwrapped(),ge.worldSize),gr=xi.modelTraits;for(const Ki of xi.getNodesInfo()){if(Ki.hiddenByReplacement||!Ki.node.meshes)continue;const lr=Ki.evaluatedScale,rr=Ki.node;let kr=0;if(se.terrain&&rr.elevation&&(kr=rr.elevation*se.terrain.exaggeration()),lr[0]<=1&&lr[1]<=1&&lr[2]<=1&&0===(()=>{const eo=Ki.getLocalBounds();return St.min=[...eo.min],St.max=[...eo.max],St.min[2]+=kr,St.max[2]+=kr,p.N.transformMat4(St.min,St.min,ci),p.N.transformMat4(St.max,St.max,ci),St})().intersects(gt))continue;const qs="light-beam"===se.renderPass,Fr=[...ci];p.a6.translate(Fr,Fr,[(rr.anchor?rr.anchor[0]:0)*(lr[0]-1),(rr.anchor?rr.anchor[1]:0)*(lr[1]-1),kr]),p.N.exactEquals(lr,p.cT)||p.a6.scale(Fr,Fr,lr),p.a6.multiply(Fr,Fr,rr.matrix);const Po=p.a6.multiply([],Pt,Fr);p.a6.multiply(Po,dt,Po);const Dr=p.a6.invert([],Po);p.a6.transpose(Dr,Dr),p.a6.scale(Dr,Dr,Wf);const jr=p.a6.multiply([],ge.expandedFarZProjMatrix,Fr),br=gr&p.cV.HasMapboxMeshFeatures,Xr=br?0:Ki.evaluatedRMEA[0][2];for(let eo=0;eo<rr.meshes.length;++eo){const zr=rr.meshes[eo],za=eo===rr.lightMeshIndex;if(za){if(!qs&&!se.terrain&&se.shadowRenderer){se.currentLayer<se.firstLightBeamLayer&&(se.firstLightBeamLayer=se.currentLayer);continue}}else if(qs)continue;const gl={defines:[]},bc=[];if(ko(gl.defines,bc,zr,se),br||gl.defines.push("DIFFUSE_SHADED"),yi&&gl.defines.push("SHADOWS_SINGLE_CASCADE"),An&&(Ze?An.numRenderedVerticesInShadowPass+=zr.vertexArray.length:An.numRenderedVerticesInTransparentPass+=zr.vertexArray.length),Ze){bt(zr,Fr,se,Ie);continue}let jc=null;if(Me){const $c=Ah(Fr,se.transform);if(jc=new Float32Array($c),"globe"!==ge.projection.name){const Si=zr.aabb.min,_l=zr.aabb.max,[wc,Va]=Me.getOpacityForBounds($c,Si[0],Si[1],_l[0],_l[1]);gl.overrideFog=wc>=as||Va>=as}}const Gc=zr.material;let oo;Gc.occlusionTexture&&Gc.occlusionTexture.offsetScale&&(oo=Gc.occlusionTexture.offsetScale,gl.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!Ze&&He&&(He.useNormalOffset=!!zr.normalBuffer);const fa=se.getOrCreateProgram("model",gl);!Ze&&He&&He.setupShadowsFromMatrix(Fr,fa,He.useNormalOffset),se.uploadCommonUniforms(Be,fa,li.toUnwrapped(),jc);const Ms=Gc.pbrMetallicRoughness;Ms.metallicFactor=.9,Ms.roughnessFactor=.5;const ml=h_(new Float32Array(jr),new Float32Array(Po),new Float32Array(Dr),se,Rt,Ms.baseColorFactor,Gc.emissiveFactor,Ms.metallicFactor,Ms.roughnessFactor,Gc,Xr,Ie,[0,0,0],oo);fa.draw(se,Be.gl.TRIANGLES,$n&&!za?cn:ct,or.disabled,Cn?za||Rt<1||Ki.hasTranslucentParts?Tr.alphaBlended:Tr.unblended:Tr.disabled,Ri.backCCW,ml,Ie.id,zr.vertexBuffer,zr.indexBuffer,zr.segments,Ie.paint,se.transform.zoom,void 0,bc)}}}};(function(Cn,$n,li,xi){const yi=Cn.terrain?Cn.terrain.exaggeration():0,ci=Cn.transform.zoom;for(const gr of xi){const Ki=$n.getTile(gr).getBucket(li);Ki&&(Cn.conflationActive&&Ki.updateReplacement(gr,Cn.replacementSource),Ki.evaluateScale(Cn,li),Cn.terrain&&yi>0&&Ki.elevationUpdate(Cn.terrain,yi,gr,li.source),Ki.needsReEvaluation(Cn,ci,li)&&Ki.evaluate(li))}})(se,me,Ie,xe),1===Rt?Tn(!0,!0):(Tn(!1,!0),Tn(!0,!1))}(_,c,d,y),void P();const j=Q.getModels(),q=[],J=_.transform.getFreeCameraOptions().position,te=p.N.scale([],[J.x,J.y,J.z],_.transform.worldSize);p.N.negate(te,te);const le=[],ce=[];let Ae=0;for(const se of j){const me=d.paint.get("model-rotation").constantOr(null),Ie=d.paint.get("model-scale").constantOr(null),xe=d.paint.get("model-translation").constantOr(null);se.computeModelMatrix(_,me,Ie,xe,!0,!0,!1);const Be=p.a6.identity([]),ge=p.cR(se.position.lat,_.transform.zoom),Me=p.a6.fromScaling([],[1,1,1/ge]);p.a6.translate(Be,Be,te),q.push({zScaleMatrix:Me,negCameraPosMatrix:Be});for(const He of se.nodes)UA(_.transform,He,se.matrix,_.transform.expandedFarZProjMatrix,Ae,le,ce);Ae++}if(le.sort((se,me)=>me.depth-se.depth),"shadow"!==_.renderPass){if(1===w)for(const se of ce)im(se,_,d,q[se.modelIndex],or.disabled,_.colorModeForRenderPass());else{for(const se of ce)im(se,_,d,q[se.modelIndex],or.disabled,Tr.disabled);for(const se of ce)im(se,_,d,q[se.modelIndex],_.stencilModeFor3D(),_.colorModeForRenderPass());_.resetStencilClippingMasks()}for(const se of le)im(se,_,d,q[se.modelIndex],or.disabled,_.colorModeForRenderPass());P()}else{for(const se of ce)bt(se.mesh,se.nodeModelMatrix,_,d);for(const se of le)bt(se.mesh,se.nodeModelMatrix,_,d);P()}}},Zo={model:function(_,c,d){const y=_.scope,w=c.getSource();if(!w.loaded())return;if("vector"===w.type||"geojson"===w.type)return void(d.modelManager&&d.modelManager.upload(d,y));if("batched-model"===w.type)return;const C=w.getModels();for(const I of C)I.upload(d.context)},raster:function(_,c,d){const y=c.getSource();if(!(y instanceof Ln&&y.loaded()))return;const w=_.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!w)return;const C=_.paint.get("raster-array-band")||y.getInitialBand(w);if(null==C)return;const I=c.getIds().map(B=>c.getTileByID(B));for(const B of I)B.updateNeeded(w,C)&&y.prepareTile(B,w,C)},"raster-particle":function(_,c,d){const y=c.getSource();if(!(y instanceof Ln&&y.loaded()))return;const w=_.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!w)return;const C=_.paint.get("raster-particle-array-band")||y.getInitialBand(w);if(null==C)return;const I=c.getIds().map(B=>c.getTileByID(B));for(const B of I)B.updateNeeded(w,C)&&y.prepareTile(B,w,C)}};class A_{constructor(c,d,y,w){this.context=new Yu(c,d),this.transform=y,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._debugParams={showTerrainProxyTiles:!1},w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),this.setup(),this.numSublayers=Rh.maxUnderzooming+Rh.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new p.cX,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new va(this),this._wireframeDebugCache=new H0,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(c,d){const y=!!c&&!!c.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ip(this,c));const w=this._terrain;this.transform.elevation=y?w:null,w.update(c,this.transform,d),this.transform.elevation&&!w.enabled&&(this.transform.elevation=null)}_updateFog(c){const d=c.fog;if(!d||"globe"===this.transform.projection.name||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,w]=d.getFovAdjustedRange(this.transform._fov);if(y>w)return void(this.transform.fogCullDistSq=null);const C=y+.78*(w-y);this.transform.fogCullDistSq=C*C}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(c,d){if(this.width=c*p.f.devicePixelRatio,this.height=d*p.f.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._mergedLayers[y].resize()}setup(){const c=this.context,d=new p.aN;d.emplaceBack(0,0),d.emplaceBack(p.V,0),d.emplaceBack(0,p.V),d.emplaceBack(p.V,p.V),this.tileExtentBuffer=c.createVertexBuffer(d,p.aP.members),this.tileExtentSegments=p.aB.simpleSegment(0,0,4,2);const y=new p.aN;y.emplaceBack(0,0),y.emplaceBack(p.V,0),y.emplaceBack(0,p.V),y.emplaceBack(p.V,p.V),this.debugBuffer=c.createVertexBuffer(y,p.aP.members),this.debugSegments=p.aB.simpleSegment(0,0,4,5);const w=new p.aN;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(w,p.aP.members),this.viewportSegments=p.aB.simpleSegment(0,0,4,2);const C=new p.av;C.emplaceBack(0,0,0,0),C.emplaceBack(p.V,0,p.V,0),C.emplaceBack(0,p.V,0,p.V),C.emplaceBack(p.V,p.V,p.V,p.V),this.mercatorBoundsBuffer=c.createVertexBuffer(C,p.aR.members),this.mercatorBoundsSegments=p.aB.simpleSegment(0,0,4,2);const I=new p.aw;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(I);const B=new p.aO;for(const Q of[0,1,3,2,0])B.emplaceBack(Q);this.debugIndexBuffer=c.createIndexBuffer(B),this.emptyTexture=new p.T(c,new p.h({width:1,height:1},Uint8Array.of(0,0,0,0)),c.gl.RGBA),this.identityMat=p.a6.create();const P=this.context.gl;this.stencilClearMode=new or({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(c){return c._makeTileBoundsBuffers(this.context,this.transform.projection),c._tileBoundsBuffer?{tileBoundsBuffer:c._tileBoundsBuffer,tileBoundsIndexBuffer:c._tileBoundsIndexBuffer,tileBoundsSegments:c._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const c=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,c.TRIANGLES,kn.disabled,this.stencilClearMode,Tr.disabled,Ri.disabled,ch(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(c,d,y){if(!d||this.currentStencilSource===d.id||!c.isTileClipped()||!y||0===y.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let B=!1;for(const P of y)if(void 0===this._tileClippingMaskIDs[P.key]){B=!0;break}if(!B)return}this.currentStencilSource=d.id;const w=this.context,C=w.gl;this.nextStencilID+y.length>256&&this.clearStencil(),w.setColorMode(Tr.disabled),w.setDepthMode(kn.disabled);const I=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const B of y){const P=d.getTile(B),Q=this._tileClippingMaskIDs[B.key]=this.nextStencilID++,{tileBoundsBuffer:j,tileBoundsIndexBuffer:q,tileBoundsSegments:J}=this.getTileBoundsBuffers(P);I.draw(this,C.TRIANGLES,kn.disabled,new or({func:C.ALWAYS,mask:0},Q,255,C.KEEP,C.KEEP,C.REPLACE),Tr.disabled,Ri.disabled,ch(B.projMatrix),"$clipping",j,q,J)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,d=this.context.gl;return new or({func:d.NOTEQUAL,mask:255},c,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const d=this.context.gl;return new or({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(c){const d=this.context.gl,y=c.sort((I,B)=>B.overscaledZ-I.overscaledZ),w=y[y.length-1].overscaledZ,C=y[0].overscaledZ-w+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();const I={};for(let B=0;B<C;B++)I[B+w]=new or({func:d.GEQUAL,mask:255},B+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=C,[I,y]}return[{[w]:or.disabled},y]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new Tr([c.CONSTANT_COLOR,c.ONE,c.CONSTANT_COLOR,c.ONE],new p.ax(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Tr.unblended:Tr.alphaBlended}colorModeForDrapableLayerRenderPass(c){const d=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&"translucent"===this.renderPass?new Tr([d.ONE,d.ONE_MINUS_SRC_ALPHA,d.CONSTANT_ALPHA,d.ONE_MINUS_SRC_ALPHA],new p.ax(0,0,0,void 0===c?0:c),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(c,d,y,w=!1){if(!this.opaquePassEnabledForLayer()&&!w)return kn.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new kn(y||this.context.gl.LEQUAL,d,[C,C])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,d){this._wireframeDebugCache.update(this.frameCounter),this.style=c,this.options=d;const y=this.style._mergedLayers,w=this.style.order,C=w.map(ge=>y[ge]),I=this.style._mergedSourceCaches;this.imageManager=c.imageManager,this.modelManager=c.modelManager,this.symbolFadeChange=c.placement.symbolFadeChange(p.f.now()),this.imageManager.beginFrame();let B=0,P=!1;for(const ge in I){const Me=I[ge];Me.used&&(Me.prepare(this.context),Me.getSource().usedInConflation&&++B)}for(const ge of C)ge.isHidden(this.transform.zoom)||this.prepareLayer(ge);const Q={},j={},q={},J={},te={};for(const ge in I){const Me=I[ge];Q[ge]=Me.getVisibleCoordinates(),j[ge]=Q[ge].slice().reverse(),q[ge]=Me.getVisibleCoordinates(!0).reverse(),J[ge]=Me.getShadowCasterCoordinates(),te[ge]=Me.sortCoordinatesByDistance(Q[ge])}const le=ge=>{const Me=this.style.getLayerSourceCache(ge);return Me&&Me.used?Me.getSource():null};if(B){const ge=[];for(const Me of C)this.layerUsedInConflation(Me,le(Me))&&ge.push(Me);if(ge&&ge.length>1){const Me=[];for(const He of ge){const Ge=this.style.getLayerSourceCache(He);Ge&&Ge.used&&Ge.getSource().usedInConflation&&Me.push({layer:He.fqid,cache:Ge})}this.replacementSource.setSources(Me),P=!0}}P||this.replacementSource.clear(),this.conflationActive=P,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const ge of C){const Me=ge.cutoffRange();if(this.longestCutoffRange=Math.max(Me,this.longestCutoffRange),Me>0){const He=le(ge);He&&(this.minCutoffZoom=Math.max(He.minzoom,this.minCutoffZoom)),ge.minzoom&&(this.minCutoffZoom=Math.max(ge.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let ge=0;ge<C.length;ge++)if(C[ge].is3D()){this.opaquePassCutoff=ge;break}const ce=this.style&&this.style.fog;ce?(this._fogVisible=0!==ce.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=ce.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(q),this.opaquePassCutoff=0);const Ae=this._shadowRenderer;if(Ae){Ae.updateShadowParameters(this.transform,this.style.directionalLight);for(const ge in I)for(const Me of Q[ge]){let He={min:0,max:0};this.terrain&&(He=this.terrain.getMinMaxForTile(Me)||He),Ae.addShadowReceiver(Me.toUnwrapped(),He.min,He.max)}}if("globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new p.cY(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new wi(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!p.cZ(this.context.gl))return;this.renderPass="offscreen";for(const ge of C){const Me=c.getLayerSourceCache(ge);if(!ge.hasOffscreenPass()||ge.isHidden(this.transform.zoom))continue;const He=Me?j[Me.id]:void 0;("custom"===ge.type||"raster"===ge.type||"raster-particle"===ge.type||ge.isSky()||He&&He.length)&&this.renderLayer(this,Me,ge,He)}this.depthRangeFor3D=[0,1-(C.length+2)*this.numSublayers*this.depthEpsilon];const se=this.terrain;se&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&se.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,J)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const me="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),Ie=(()=>{if(d.showOverdrawInspector)return p.ax.black;if(this.style.fog&&this.transform.projection.supportsFog&&!me){const ge=this.style.fog.properties.get("color").toArray01();return new p.ax(...ge)}if(this.style.fog&&this.transform.projection.supportsFog&&me){const ge=this.style.fog.properties.get("space-color").toArray01();return new p.ax(...ge)}return p.ax.transparent})();if(this.context.clear({color:Ie,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&me&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const ge=C[this.currentLayer],Me=c.getLayerSourceCache(ge);if(ge.isSky())continue;const He=Me?(ge.is3D()?te:j)[Me.id]:void 0;this._renderTileClippingMasks(ge,Me,He),this.renderLayer(this,Me,ge,He)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&me&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||p.S(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const ge=C[this.currentLayer],Me=c.getLayerSourceCache(ge);ge.isSky()&&this.renderLayer(this,Me,ge,Me?j[Me.id]:void 0)}function xe(ge,Me){let He;return Me&&(He=("symbol"===ge.type?q:ge.is3D()?te:j)[Me.id]),He}if(this.renderPass="translucent","globe"===this.transform.projection.name){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<w.length;){const ge=C[this.currentLayer];if("raster"===ge.type){const Me=c.getLayerSourceCache(ge);this.renderLayer(this,Me,ge,xe(ge,Me))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Be=0;for(Ae&&(Be=Ae.getShadowCastingLayerCount());this.currentLayer<w.length;){const ge=C[this.currentLayer],Me=c.getLayerSourceCache(ge);if(ge.isSky())++this.currentLayer;else if(se&&this.style.isLayerDraped(ge)){if(ge.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=se.renderBatch(this.currentLayer)}else{if(this._renderTileClippingMasks(ge,Me,Me?Q[Me.id]:void 0),this.renderLayer(this,Me,ge,xe(ge,Me)),!se&&Ae&&Be>0&&ge.hasShadowPass()&&0==--Be&&(Ae.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const He=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=He;this.currentLayer++){const Ge=C[this.currentLayer];if(!Ge.hasLightBeamPass())continue;const nt=c.getLayerSourceCache(Ge);this.renderLayer(this,nt,Ge,nt?j[nt.id]:void 0)}this.currentLayer=He,this.renderPass="translucent"}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ge=null;C.forEach(Me=>{const He=c.getLayerSourceCache(Me);He&&!Me.isHidden(this.transform.zoom)&&He.getVisibleCoordinates().length&&(!ge||ge.getSource().maxzoom<He.getSource().maxzoom)&&(ge=He)}),ge&&this.options.showTileBoundaries&&VA.debug(this,ge,ge.getVisibleCoordinates(),p.ax.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&VA.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new p.ax(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ge){const Me=ge.transform.padding;Pi(ge,ge.transform.height-(Me.top||0),3,vc),Pi(ge,Me.bottom||0,3,zh),$l(ge,Me.left||0,3,Jg),$l(ge,ge.transform.width-(Me.right||0),3,em);const He=ge.transform.centerPoint;var Ge,nt,dt,ot;uo(Ge=ge,(nt=He.x)-1,(dt=ge.transform.height-He.y)-10,2,20,ot=tm),uo(Ge,nt-10,dt-1,20,2,ot)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),P||(this.conflationActive=!1)}prepareLayer(c){this.gpuTimingStart(c);const{unsupportedLayers:d}=this.transform.projection,y=!d||!d.includes(c.type);if(Zo[c.type]&&(y||this.terrain&&"custom"===c.type)){const w=this.style.getLayerSourceCache(c);Zo[c.type](c,w,this)}this.gpuTimingEnd()}renderLayer(c,d,y,w){y.isHidden(this.transform.zoom)||("background"===y.type||"sky"===y.type||"custom"===y.type||"model"===y.type||"raster"===y.type||"raster-particle"===y.type||w&&w.length)&&(this.id=y.id,this.gpuTimingStart(y),(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes(y.type)||c.terrain&&"custom"===y.type)&&VA[y.type](c,d,y,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery,y=this.context.gl;let w=this.gpuTimers[c.id];w||(w=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:y.createQuery()}),w.calls++,y.beginQuery(d.TIME_ELAPSED_EXT,w.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const c=this.context.extTimerQuery,d=this.context.gl,y=d.createQuery();this.deferredRenderGpuTimeQueries.push(y),d.beginQuery(c.TIME_ELAPSED_EXT,y)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}collectDeferredRenderGpuQueries(){const c=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],c}queryGpuTimers(c){const d={};for(const y in c){const w=c[y],C=this.context.extTimerQuery,I=C.getQueryParameter(w.query,this.context.gl.QUERY_RESULT)/1e6;C.deleteQueryEXT(w.query),d[y]=I}return d}queryGpuTimeDeferredRender(c){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.extTimerQuery,y=this.context.gl;let w=0;for(const C of c)w+=d.getQueryParameter(C,y.QUERY_RESULT)/1e6,d.deleteQueryEXT(C);return w}translatePosMatrix(c,d,y,w,C){if(!y[0]&&!y[1])return c;const I=C?"map"===w?this.transform.angle:0:"viewport"===w?-this.transform.angle:0;if(I){const Q=Math.sin(I),j=Math.cos(I);y=[y[0]*j-y[1]*Q,y[0]*Q+y[1]*j]}const B=[C?y[0]:p.a3(d,y[0],this.transform.zoom),C?y[1]:p.a3(d,y[1],this.transform.zoom),0],P=new Float32Array(16);return p.a6.translate(P,c,B),P}saveTileTexture(c){const d=c.size[0],y=this._tileTextures[d];y?y.push(c):this._tileTextures[d]=[c]}getTileTexture(c){const d=this._tileTextures[c];return d&&d.length>0?d.pop():null}isPatternMissing(c,d){return null===c||void 0!==c&&!this.imageManager.getPattern(c.toString(),d)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(c,d,y){const w=void 0===y?this.terrain&&this.terrain.renderingToTexture:y,C=this.terrain&&0===this.terrain.exaggeration(),I=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===c||"terrainRaster"===c?(I.push("LIGHTING_3D_MODE"),I.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):w||I.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass?this._shadowMapDebug||I.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?I.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):I.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(I.push("TERRAIN"),this.linearFloatFilteringSupported()&&I.push("TERRAIN_DEM_FLOAT_FORMAT"),C&&I.push("ZERO_EXAGGERATION")),"globe"===this.transform.projection.name&&I.push("GLOBE"),!this._fogVisible||w||void 0!==d&&!d||I.push("FOG","FOG_DITHERING"),w&&I.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&I.push("OVERDRAW_INSPECTOR"),I}getOrCreateProgram(c,d){this.cache=this.cache||{};const y=d&&d.defines||[],w=d&&d.config,C=d&&d.transformFeedback,I=this.currentGlobalDefines(c,d&&d.overrideFog,d&&d.overrideRtt).concat(y),B=Gf.cacheKey(l_[c],c,I,w);return this.cache[B]||(this.cache[B]=new Gf(this.context,c,l_[c],w,gb[c],I,C)),this.cache[B]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new p.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(c,d){if(this.style.enable3dLights()){const y=this.style.directionalLight,w=this.style.ambientLight;if(y&&w){const C=((I,B)=>{const P=I.properties.get("direction"),Q=I.properties.get("color").toArray01(),j=I.properties.get("intensity"),q=B.properties.get("color").toArray01(),J=B.properties.get("intensity"),te=[P.x,P.y,P.z],le=p.cn(q,J),ce=p.cn(Q,j);return{u_lighting_ambient_color:le,u_lighting_directional_dir:te,u_lighting_directional_color:ce,u_ground_radiance:jg(te,ce,le)}})(y,w);d.setLightsUniformValues(c,C)}}}uploadCommonUniforms(c,d,y,w,C){if(this.uploadCommonLightUniforms(c,d),this.terrain&&this.terrain.renderingToTexture)return;const I=this.style.fog;if(I){const B=I.getOpacity(this.transform.pitch),P=((Q,j,q,J,te,le,ce,Ae,se,me,Ie,xe)=>{const Be=Q.transform,ge=j.properties.get("color").toArray01();ge[3]=J;const Me=Q.frameCounter/1e3%1,[He,Ge]=j.properties.get("vertical-range");return{u_fog_matrix:q?Be.calculateFogTileMatrix(q):xe||Q.identityMat,u_fog_range:j.getFovAdjustedRange(Be._fov),u_fog_color:ge,u_fog_horizon_blend:j.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(He,Ge),Ge],u_fog_temporal_offset:Me,u_frustum_tl:te,u_frustum_tr:le,u_frustum_br:ce,u_frustum_bl:Ae,u_globe_pos:se,u_globe_radius:me,u_viewport:Ie,u_globe_transition:p.S(Be.zoom),u_is_globe:+("globe"===Be.projection.name)}})(this,I,y,B,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*p.f.devicePixelRatio,this.transform.height*p.f.devicePixelRatio],w);d.setFogUniformValues(c,P)}C&&d.setCutoffUniformValues(c,C.uniformValues)}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){const c=this.canvasCopy();c&&(this.frameCopies.push(c),this.tileLoaded=!1)}canvasCopy(){const c=this.context.gl,d=c.createTexture();return c.bindTexture(c.TEXTURE_2D,d),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&0!==c.getOpacity(this.transform.pitch)}getBackgroundTiles(){const c=this._backgroundTiles,d=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const w of y)d[w.key]=c[w.key]||new Rf(w,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(c,d){return!(!c.is3D()||c.minzoom&&c.minzoom>this.transform.zoom||"building"!==c.sourceLayer&&(!d||"batched-model"!==d.type))}isTileAffectedByFog(c){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let d=this._cachedTileFogOpacities[c.key];return d||(this._cachedTileFogOpacities[c.key]=d=this.style.fog.getOpacityForTile(c)),d[0]>=as||d[1]>=as}}function Np(_,c){let d=!1,y=null;const w=()=>{y=null,d&&(_(),y=setTimeout(w,c),d=!1)};return()=>(d=!0,y||w(),y)}class Lp{constructor(c){this._hashName=c&&encodeURIComponent(c),p.aY(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Np(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,window.addEventListener("hashchange",this._onHashChange,!1),c.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const c=this._map;if(!c)return"";const d=sm(c);if(this._hashName){const y=this._hashName;let w=!1;const C=location.hash.slice(1).split("&").map(I=>{const B=I.split("=")[0];return B===y?(w=!0,`${B}=${d}`):I}).filter(I=>I);return w||C.push(`${y}=${d}`),`#${C.join("&")}`}return`#${d}`}_getCurrentHash(){const c=location.hash.replace("#","");if(this._hashName){let d;return c.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(d=y)}),(d&&d[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._map;if(!c)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(y=>isNaN(y))){const y=c.dragRotate.isEnabled()&&c.touchZoomRotate.isEnabled()?+(d[3]||0):c.getBearing();return c.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:y,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function sm(_,c){const d=_.getCenter(),y=Math.round(100*_.getZoom())/100,w=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,w),I=Math.round(d.lng*C)/C,B=Math.round(d.lat*C)/C,P=_.getBearing(),Q=_.getPitch();let j=c?`/${I}/${B}/${y}`:`${y}/${B}/${I}`;return(P||Q)&&(j+="/"+Math.round(10*P)/10),Q&&(j+=`/${Math.round(Q)}`),j}const yd={linearity:.3,easing:p.c_(0,0,.3,1)},Vc=p.e({deceleration:2500,maxSpeed:1400},yd),Up=p.e({deceleration:20,maxSpeed:1400},yd),HA=p.e({deceleration:1e3,maxSpeed:360},yd),Bs=p.e({deceleration:1e3,maxSpeed:90},yd);class bs{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:p.f.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,d=p.f.now();for(;c.length>0&&d-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const d={zoom:0,bearing:0,pitch:0,pan:new p.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:C}of this._inertiaBuffer)d.zoom+=C.zoomDelta||0,d.bearing+=C.bearingDelta||0,d.pitch+=C.pitchDelta||0,C.panDelta&&d.pan._add(C.panDelta),C.around&&(d.around=C.around),C.pinchAround&&(d.pinchAround=C.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(d.pan.mag()){const C=Hs(d.pan.mag(),y,p.e({},Vc,c||{}));w.offset=d.pan.mult(C.amount/d.pan.mag()),w.center=this._map.transform.center,QA(w,C)}if(d.zoom){const C=Hs(d.zoom,y,Up);w.zoom=this._map.transform.zoom+C.amount,QA(w,C)}if(d.bearing){const C=Hs(d.bearing,y,HA);w.bearing=this._map.transform.bearing+p.aa(C.amount,-179,179),QA(w,C)}if(d.pitch){const C=Hs(d.pitch,y,Bs);w.pitch=this._map.transform.pitch+C.amount,QA(w,C)}if(w.zoom||w.bearing){const C=void 0===d.pinchAround?d.around:d.pinchAround;w.around=C?this._map.unproject(C):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function QA(_,c){(!_.duration||_.duration<c.duration)&&(_.duration=c.duration,_.easing=c.easing)}function Hs(_,c,d){const{maxSpeed:y,linearity:w,deceleration:C}=d,I=p.aa(_*w/(c/1e3),-y,y),B=Math.abs(I)/(C*w);return{easing:d.easing,duration:1e3*B,amount:I*(B/2)}}class Al extends p.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,d,y,w={}){const C=Oc(d.getCanvasContainer(),y),I=d.unproject(C);super(c,p.e({point:C,lngLat:I,originalEvent:y},w)),this._defaultPrevented=!1,this.target=d}}class Hc extends p.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,d,y){const w="touchend"===c?y.changedTouches:y.touches,C=Ul(d.getCanvasContainer(),w),I=C.map(P=>d.unproject(P)),B=C.reduce((P,Q,j,q)=>P.add(Q.div(q.length)),new p.P(0,0));super(c,{points:C,point:B,lngLats:I,lngLat:d.unproject(B),originalEvent:y}),this._defaultPrevented=!1}}class ql extends p.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,d,y){super(c,{originalEvent:y}),this._defaultPrevented=!1}}class om{constructor(c,d){this._map=c,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(c){return this._firePreventable(new ql(c.type,this._map,c))}mousedown(c,d){return this._mousedownPos=d,this._firePreventable(new Al(c.type,this._map,c))}mouseup(c){this._map.fire(new Al(c.type,this._map,c))}preclick(c){const d=p.e({},c);d.type="preclick",this._map.fire(new Al(d.type,this._map,d))}click(c,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(c),this._map.fire(new Al(c.type,this._map,c)))}dblclick(c){return this._firePreventable(new Al(c.type,this._map,c))}mouseover(c){this._map.fire(new Al(c.type,this._map,c))}mouseout(c){this._map.fire(new Al(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Hc(c.type,this._map,c))}touchmove(c){this._map.fire(new Hc(c.type,this._map,c))}touchend(c){this._map.fire(new Hc(c.type,this._map,c))}touchcancel(c){this._map.fire(new Hc(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hh{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(c){this._map.fire(new Al(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Al("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new Al(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Qc{constructor(c,d){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,d){this.isEnabled()&&c.shiftKey&&0===c.button&&(Dh(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(c,d){if(!this._active)return;const y=d,w=this._startPos,C=this._lastPos;if(!w||!C||C.equals(y)||!this._box&&y.dist(w)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=Di("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const I=Math.min(w.x,y.x),B=Math.max(w.x,y.x),P=Math.min(w.y,y.y),Q=Math.max(w.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${I}px,${P}px)`,this._box.style.width=B-I+"px",this._box.style.height=Q-P+"px")})}mouseupWindow(c,d){if(!this._active)return;const y=this._startPos,w=d;if(y&&0===c.button){if(this.reset(),ec(),y.x!==w.x||y.y!==w.y)return this._map.fire(new p.b("boxzoomend",{originalEvent:c})),{cameraAnimation:C=>C.fitScreenCoordinates(y,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}}keydown(c){this._active&&27===c.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",c))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Ta(),delete this._startPos,delete this._lastPos}_fireEvent(c,d){return this._map.fire(new p.b(c,{originalEvent:d}))}}function Ja(_,c){const d={};for(let y=0;y<_.length;y++)d[_[y].identifier]=c[y];return d}class am{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(c,d,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=c.timeStamp),y.length===this.numTouches&&(this.centroid=function(w){const C=new p.P(0,0);for(const I of w)C._add(I);return C.div(w.length)}(d),this.touches=Ja(y,d)))}touchmove(c,d,y){if(this.aborted||!this.centroid)return;const w=Ja(y,d);for(const C in this.touches){const I=w[C];(!I||I.dist(this.touches[C])>30)&&(this.aborted=!0)}}touchend(c,d,y){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),0===y.length){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class zp{constructor(c){this.singleTap=new am(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(c,d,y){this.singleTap.touchstart(c,d,y)}touchmove(c,d,y){this.singleTap.touchmove(c,d,y)}touchend(c,d,y){const w=this.singleTap.touchend(c,d,y);if(w){const C=c.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(w)<30;if(C&&I||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class p_{constructor(){this._zoomIn=new zp({numTouches:1,numTaps:2}),this._zoomOut=new zp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,d,y){this._zoomIn.touchstart(c,d,y),this._zoomOut.touchstart(c,d,y)}touchmove(c,d,y){this._zoomIn.touchmove(c,d,y),this._zoomOut.touchmove(c,d,y)}touchend(c,d,y){const w=this._zoomIn.touchend(c,d,y),C=this._zoomOut.touchend(c,d,y);return w?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()+1,around:I.unproject(w)},{originalEvent:c})}):C?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()-1,around:I.unproject(C)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const La={0:1,2:2};class fu{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(c,d){return!1}_move(c,d){return{}}mousedown(c,d){if(this._lastPoint)return;const y=tc(c);this._correctButton(c,y)&&(this._lastPoint=d,this._eventButton=y)}mousemoveWindow(c,d){const y=this._lastPoint;if(y)if(c.preventDefault(),null!=this._eventButton&&function(w,C){const I=La[C];return void 0===w.buttons||(w.buttons&I)!==I}(c,this._eventButton))this.reset();else if(this._moved||!(d.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(y,d)}mouseupWindow(c){this._lastPoint&&tc(c)===this._eventButton&&(this._moved&&ec(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class g_ extends fu{mousedown(c,d){super.mousedown(c,d),this._lastPoint&&(this._active=!0)}_correctButton(c,d){return 0===d&&!c.ctrlKey}_move(c,d){return{around:d,panDelta:d.sub(c)}}}class jA extends fu{_correctButton(c,d){return 0===d&&c.ctrlKey||2===d}_move(c,d){const y=.8*(d.x-c.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(c){c.preventDefault()}}class Vp extends fu{_correctButton(c,d){return 0===d&&c.ctrlKey||2===d}_move(c,d){const y=-.5*(d.y-c.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(c){c.preventDefault()}}class lm{constructor(c,d){this._map=c,this._el=c.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),p.aY(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new p.P(0,0)}touchstart(c,d,y){return this._calculateTransform(c,d,y)}touchmove(c,d,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===y.length&&!p.c$())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return c.cancelable&&c.preventDefault(),this._calculateTransform(c,d,y)}}touchend(c,d,y){this._calculateTransform(c,d,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,d,y){y.length>0&&(this._active=!0);const w=Ja(y,d),C=new p.P(0,0),I=new p.P(0,0);let B=0;for(const Q in w){const j=w[Q],q=this._touches[Q];q&&(C._add(j),I._add(j.sub(q)),B++,w[Q]=j)}if(this._touches=w,B<this._minTouches||!I.mag())return;const P=I.div(B);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:C.div(B),panDelta:P}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Di("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class el{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(c){}_move(c,d,y){return{}}touchstart(c,d,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([d[0],d[1]]))}touchmove(c,d,y){const w=this._firstTwoTouches;if(!w)return;c.preventDefault();const[C,I]=w,B=Ir(y,d,C),P=Ir(y,d,I);if(!B||!P)return;const Q=this._aroundCenter?null:B.add(P).div(2);return this._move([B,P],Q,c)}touchend(c,d,y){if(!this._firstTwoTouches)return;const[w,C]=this._firstTwoTouches,I=Ir(y,d,w),B=Ir(y,d,C);I&&B||(this._active&&ec(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ir(_,c,d){for(let y=0;y<_.length;y++)if(_[y].identifier===d)return c[y]}function Hp(_,c){return Math.log(_/c)/Math.LN2}class cm extends el{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,d){const y=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(Hp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Hp(this._distance,y),pinchAround:d}}}function nf(_,c){return 180*_.angleWith(c)/Math.PI}class um extends el{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,d){const y=this._vector;if(this._vector=c[0].sub(c[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:nf(this._vector,y),pinchAround:d}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const d=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const w=nf(c,y);return Math.abs(w)<d}}function Qp(_){return Math.abs(_.y)>Math.abs(_.x)}class GA extends el{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(c){this._lastPoints=c,Qp(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,d,y){const w=this._lastPoints;if(!w)return;const C=c[0].sub(w[0]),I=c[1].sub(w[1]);return this._map._cooperativeGestures&&!p.c$()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(C,I,y.timeStamp),!this._valid)?void 0:(this._lastPoints=c,this._active=!0,{pitchDelta:(C.y+I.y)/2*-.5})}gestureBeginsVertically(c,d,y){if(void 0!==this._valid)return this._valid;const w=c.mag()>=2,C=d.mag()>=2;if(!w&&!C)return;if(!w||!C)return null==this._firstMove&&(this._firstMove=y),y-this._firstMove<100&&void 0;const I=c.y>0==d.y>0;return Qp(c)&&Qp(d)&&I}}const Au={panStep:100,bearingStep:15,pitchStep:10};class Ua{constructor(){const c=Au;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let d=0,y=0,w=0,C=0,I=0;switch(c.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:c.shiftKey?y=-1:(c.preventDefault(),C=-1);break;case 39:c.shiftKey?y=1:(c.preventDefault(),C=1);break;case 38:c.shiftKey?w=1:(c.preventDefault(),I=-1);break;case 40:c.shiftKey?w=-1:(c.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(y=0,w=0),{cameraAnimation:B=>{const P=B.getZoom();B.easeTo({duration:300,easeId:"keyboardHandler",easing:Zf,zoom:d?Math.round(P)+d*(c.shiftKey?2:1):P,bearing:B.getBearing()+y*this._bearingStep,pitch:B.getPitch()+w*this._pitchStep,offset:[-C*this._panStep,-I*this._panStep],center:B.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Zf(_){return _*(2-_)}const jp=4.000244140625;class __{constructor(c,d){this._map=c,this._el=c.getCanvasContainer(),this._handler=d,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,p.aY(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(c.ctrlKey||c.metaKey||this.isZooming()||p.c$()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const y=p.f.now(),w=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,0!==d&&d%jp==0?this._type="wheel":0!==d&&Math.abs(d)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(w*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),c.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=c,this._delta-=d,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=Oc(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;"wheel"===this._type&&c.projection.wrap&&(c._center.lng>=180||c._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>c._terrainEnabled()&&this._aroundCoord?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(0!==this._delta){const Q="wheel"===this._type&&Math.abs(this._delta)>jp?this._wheelZoomRate:this._defaultZoomRate;let j=2/(1+Math.exp(-Math.abs(this._delta*Q)));this._delta<0&&0!==j&&(j=1/j);const q=d(),J=Math.pow(2,q),te="number"==typeof this._targetZoom?c.zoomScale(this._targetZoom):J;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(te*j))),"wheel"===this._type&&(this._startZoom=q,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const y="number"==typeof this._targetZoom?this._targetZoom:d(),w=this._startZoom,C=this._easing;let I,B=!1;if("wheel"===this._type&&w&&C){const Q=Math.min((p.f.now()-this._lastWheelEventTime)/200,1),j=C(Q);I=p.U(w,y,j),Q<1?this._frameId||(this._frameId=!0):B=!0}else I=y,B=!0;this._active=!0,B&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let P=I-d();return P*this._lastDelta<0&&(P=0),{noInertia:!0,needsRenderFrame:!B,zoomDelta:P,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let d=p.d0;if(this._prevEase){const y=this._prevEase,w=(p.f.now()-y.start)/y.duration,C=y.easing(w+.01)-y.easing(w),I=.27/Math.sqrt(C*C+1e-4)*.01,B=Math.sqrt(.0729-I*I);d=p.c_(I,B,.25,1)}return this._prevEase={start:p.f.now(),duration:c,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Di("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Qn{constructor(c,d){this._clickZoom=c,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Js{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(c,d){return c.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(c.shiftKey?-1:1),around:y.unproject(d)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ti{constructor(){this._tap=new zp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(c,d,y){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=d[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(c,d,y))}touchmove(c,d,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const w=d[0],C=w.y-this._swipePoint.y;return this._swipePoint=w,c.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(c,d,y)}touchend(c,d,y){this._tapTime?this._swipePoint&&0===y.length&&this.reset():this._tap.touchend(c,d,y)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ni{constructor(c,d,y){this._el=c,this._mousePan=d,this._touchPan=y}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Dl{constructor(c,d,y){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=d,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class y_{constructor(c,d,y,w){this._el=c,this._touchZoom=d,this._touchRotate=y,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const vd=_=>_.zoom||_.drag||_.pitch||_.rotate;class ph extends p.b{}class hm{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,d){const y=p.N.sub([],d,c);this.radius=p.N.length(y[2]<0?p.N.div([],y,this.constants):[y[0],y[1],0])}projectRay(c){p.N.div(c,c,this.constants),p.N.normalize(c,c),p.N.mul(c,c,this.constants);const d=p.N.scale([],c,this.radius);if(d[2]>0){const y=p.N.scale([],[0,0,1],p.N.dot(d,[0,0,1])),w=p.N.scale([],p.N.normalize([],[d[0],d[1],0]),this.radius),C=p.N.add([],d,p.N.scale([],p.N.sub([],p.N.add([],w,y),d),2));d[0]=C[0],d[1]=C[1]}return d}}function rf(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Q0{constructor(c,d){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bs(c),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new hm,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),p.aY(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[w,C,I]of this._listeners){const B=w===document?this.handleWindowEvent:this.handleEvent;w.addEventListener(C,B,I)}}destroy(){for(const[c,d,y]of this._listeners){const w=c===document?this.handleWindowEvent:this.handleEvent;c.removeEventListener(d,w,y)}}_addDefaultHandlers(c){const d=this._map,y=d.getCanvasContainer();this._add("mapEvent",new om(d,c));const w=d.boxZoom=new Qc(d,c);this._add("boxZoom",w);const C=new p_,I=new Js;d.doubleClickZoom=new Qn(I,C),this._add("tapZoom",C),this._add("clickZoom",I);const B=new ti;this._add("tapDragZoom",B);const P=d.touchPitch=new GA(d);this._add("touchPitch",P);const Q=new jA(c),j=new Vp(c);d.dragRotate=new Dl(c,Q,j),this._add("mouseRotate",Q,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);const q=new g_(c),J=new lm(d,c);d.dragPan=new ni(y,q,J),this._add("mousePan",q),this._add("touchPan",J,["touchZoom","touchRotate"]);const te=new um,le=new cm;d.touchZoomRotate=new y_(y,le,te,B),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",le,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Hh(d));const ce=d.scrollZoom=new __(d,this);this._add("scrollZoom",ce,["mousePan"]);const Ae=d.keyboard=new Ua;this._add("keyboard",Ae);for(const se of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[se]&&d[se].enable(c[se])}_add(c,d,y){this._handlers.push({handlerName:c,handler:d,allowed:y}),this._handlersById[c]=d}stop(c){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!vd(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(c,d,y){for(const w in c)if(w!==y&&(!d||d.indexOf(w)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const d=[];for(const y of c)this._el.contains(y.target)&&d.push(y);return d}handleEvent(c,d){this._updatingCamera=!0;const y="renderFrame"===c.type,w=y?void 0:c,C={needsRenderFrame:!1},I={},B={},P=c.touches?this._getMapTouches(c.touches):void 0,Q=P?Ul(this._el,P):y?void 0:Oc(this._el,c);for(const{handlerName:J,handler:te,allowed:le}of this._handlers){if(!te.isEnabled())continue;let ce;this._blockedByActive(B,le,J)?te.reset():te[d||c.type]&&(ce=te[d||c.type](c,Q,P),this.mergeHandlerResult(C,I,ce,J,w),ce&&ce.needsRenderFrame&&this._triggerRenderFrame()),(ce||te.isActive())&&(B[J]=te)}const j={};for(const J in this._previousActiveHandlers)B[J]||(j[J]=w);this._previousActiveHandlers=B,(Object.keys(j).length||rf(C))&&(this._changes.push([C,I,j]),this._triggerRenderFrame()),(Object.keys(B).length||rf(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=C;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))}mergeHandlerResult(c,d,y,w,C){if(!y)return;p.e(c,y);const I={handlerName:w,originalEvent:y.originalEvent||C};void 0!==y.zoomDelta&&(d.zoom=I),void 0!==y.panDelta&&(d.drag=I),void 0!==y.pitchDelta&&(d.pitch=I),void 0!==y.bearingDelta&&(d.rotate=I)}_applyChanges(){const c={},d={},y={};for(const[w,C,I]of this._changes)w.panDelta&&(c.panDelta=(c.panDelta||new p.P(0,0))._add(w.panDelta)),w.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+w.pitchDelta),void 0!==w.around&&(c.around=w.around),void 0!==w.aroundCoord&&(c.aroundCoord=w.aroundCoord),void 0!==w.pinchAround&&(c.pinchAround=w.pinchAround),w.noInertia&&(c.noInertia=w.noInertia),p.e(d,C),p.e(y,I);this._updateMapTransform(c,d,y),this._changes=[]}_updateMapTransform(c,d,y){const w=this._map,C=w.transform,I=me=>[me.x,me.y,me.z];if((me=>{const Ie=this._eventsInProgress.drag;return Ie&&!this._handlersById[Ie.handlerName].isActive()})()&&!rf(c)){const me=C.zoom;C.cameraElevationReference="sea",null!=this._originalZoom&&C._orthographicProjectionAtLowPitch&&"globe"!==C.projection.name&&0===C.pitch?(C.cameraElevationReference="ground",C.zoom=this._originalZoom):(C.recenterOnTerrain(),C.cameraElevationReference="ground"),me!==C.zoom&&this._map._update(!0)}if(C._isCameraConstrained&&w._stop(!0),!rf(c))return void this._fireEvents(d,y,!0);let{panDelta:B,zoomDelta:P,bearingDelta:Q,pitchDelta:j,around:q,aroundCoord:J,pinchAround:te}=c;C._isCameraConstrained&&(P>0&&(P=0),C._isCameraConstrained=!1),void 0!==te&&(q=te),(P||(me=>d.drag&&!this._eventsInProgress.drag)())&&q&&(this._dragOrigin=I(C.pointCoordinate3D(q)),this._originalZoom=C.zoom,this._trackingEllipsoid.setup(C._camera.position,this._dragOrigin)),C.cameraElevationReference="sea",w._stop(!0),q=q||w.transform.centerPoint,Q&&(C.bearing+=Q),j&&(C.pitch+=j),C._updateCameraState();const le=[0,0,0];if(B)if("mercator"===C.projection.name){const me=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(q).dir),Ie=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(q.sub(B)).dir);le[0]=Ie[0]-me[0],le[1]=Ie[1]-me[1]}else{const me=C.pointCoordinate(q);if("globe"===C.projection.name){B=B.rotate(-C.angle);const Ie=C._pixelsPerMercatorPixel/C.worldSize;le[0]=-B.x*p.d1(p.au(me.y))*Ie,le[1]=-B.y*p.d1(C.center.lat)*Ie}else{const Ie=C.pointCoordinate(q.sub(B));me&&Ie&&(le[0]=Ie.x-me.x,le[1]=Ie.y-me.y)}}const ce=C.zoom,Ae=[0,0,0];if(P){const me=I(J||C.pointCoordinate3D(q)),Ie={dir:p.N.normalize([],p.N.sub([],me,C._camera.position))};if(Ie.dir[2]<0){const xe=C.zoomDeltaToMovement(me,P);p.N.scale(Ae,Ie.dir,xe)}}const se=p.N.add(le,le,Ae);C._translateCameraConstrained(se),P&&Math.abs(C.zoom-ce)>1e-4&&C.recenterOnTerrain(),C.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(d,y,!0)}_fireEvents(c,d,y){const w=vd(this._eventsInProgress),C=vd(c),I={};for(const j in c){const{originalEvent:q}=c[j];this._eventsInProgress[j]||(I[`${j}start`]=q),this._eventsInProgress[j]=c[j]}!w&&C&&this._fireEvent("movestart",C.originalEvent);for(const j in I)this._fireEvent(j,I[j]);C&&this._fireEvent("move",C.originalEvent);for(const j in c){const{originalEvent:q}=c[j];this._fireEvent(j,q)}const B={};let P;for(const j in this._eventsInProgress){const{handlerName:q,originalEvent:J}=this._eventsInProgress[j];this._handlersById[q].isActive()||(delete this._eventsInProgress[j],P=d[q]||J,B[`${j}end`]=P)}for(const j in B)this._fireEvent(j,B[j]);const Q=vd(this._eventsInProgress);if(y&&(w||C)&&!Q){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=J=>0!==J&&-this._bearingSnap<J&&J<this._bearingSnap;j?(q(j.bearing||this._map.getBearing())&&(j.bearing=0),this._map.easeTo(j,{originalEvent:P})):(this._map.fire(new p.b("moveend",{originalEvent:P})),q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,d){this._map.fire(new p.b(c,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{this._frameId=void 0,this.handleEvent(new ph("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const j0="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class zo extends p.E{constructor(c,d){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=d.bearingSnap,this._respectPrefersReducedMotion=!1!==d.respectPrefersReducedMotion,p.aY(["_renderFrameCallback"],this)}getCenter(){return new p.bn(this.transform.center.lng,this.transform.center.lat)}setCenter(c,d){return this.jumpTo({center:c},d)}panBy(c,d,y){return c=p.P.convert(c).mult(-1),this.panTo(this.transform.center,p.e({offset:c},d),y)}panTo(c,d,y){return this.easeTo(p.e({center:c},d),y)}getZoom(){return this.transform.zoom}setZoom(c,d){return this.jumpTo({zoom:c},d),this}zoomTo(c,d,y){return this.easeTo(p.e({zoom:c},d),y)}zoomIn(c,d){return this.zoomTo(this.getZoom()+1,c,d),this}zoomOut(c,d){return this.zoomTo(this.getZoom()-1,c,d),this}getBearing(){return this.transform.bearing}setBearing(c,d){return this.jumpTo({bearing:c},d),this}getPadding(){return this.transform.padding}setPadding(c,d){return this.jumpTo({padding:c},d),this}rotateTo(c,d,y){return this.easeTo(p.e({bearing:c},d),y)}resetNorth(c,d){return this.rotateTo(0,p.e({duration:1e3},c),d),this}resetNorthPitch(c,d){return this.easeTo(p.e({bearing:0,pitch:0,duration:1e3},c),d),this}snapToNorth(c,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,d):this}getPitch(){return this.transform.pitch}setPitch(c,d){return this.jumpTo({pitch:c},d),this}cameraForBounds(c,d){c=p.ad.convert(c);const y=d&&d.bearing||0,w=d&&d.pitch||0,C=c.getNorthWest(),I=c.getSouthEast();return this._cameraForBounds(this.transform,C,I,y,w,d)}_extendCameraOptions(c){const d={top:0,bottom:0,right:0,left:0};if("number"==typeof(c=p.e({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding){const y=c.padding;c.padding={top:y,bottom:y,right:y,left:y}}return c.padding=p.e(d,c.padding),c}_minimumAABBFrustumDistance(c,d){const y=d.max[0]-d.min[0],w=d.max[1]-d.min[1];return y/w>c.aspect?y/(2*Math.tan(.5*c.fovX)*c.aspect):w/(2*Math.tan(.5*c.fovY)*c.aspect)}_cameraForBoundsOnGlobe(c,d,y,w,C,I){const B=c.clone(),P=this._extendCameraOptions(I);B.bearing=w,B.pitch=C;const Q=p.bn.convert(d),j=p.bn.convert(y),q=.5*(Q.lat+j.lat),J=.5*(Q.lng+j.lng),te=p.d2(q,J),le=p.N.normalize([],te),ce=p.N.normalize([],p.N.cross([],le,[0,1,0])),Ae=p.N.cross([],ce,le),se=[ce[0],ce[1],ce[2],0,Ae[0],Ae[1],Ae[2],0,le[0],le[1],le[2],0,0,0,0,1],me=[te,p.d2(Q.lat,Q.lng),p.d2(j.lat,Q.lng),p.d2(j.lat,j.lng),p.d2(Q.lat,j.lng),p.d2(q,Q.lng),p.d2(q,j.lng),p.d2(Q.lat,J),p.d2(j.lat,J)];let Ie=p.bS.fromPoints(me.map(gt=>[p.N.dot(ce,gt),p.N.dot(Ae,gt),p.N.dot(le,gt)]));const xe=p.N.transformMat4([],Ie.center,se);0===p.N.squaredLength(xe)&&p.N.set(xe,0,0,1),p.N.normalize(xe,xe),p.N.scale(xe,xe,p.ab),B.center=p.d3(xe);const Be=B.getWorldToCameraMatrix(),ge=p.a6.invert(new Float64Array(16),Be);Ie=p.bS.applyTransform(Ie,p.a6.multiply([],Be,se)),p.N.transformMat4(xe,xe,Be);const Me=.5*(Ie.max[2]-Ie.min[2]),He=this._minimumAABBFrustumDistance(B,Ie),Ge=p.N.scale([],[0,0,1],Me),nt=p.N.add(Ge,xe,Ge),dt=He+(0===B.pitch?0:p.N.distance(xe,nt)),ot=B.globeCenterInViewSpace,Pt=p.N.sub([],xe,[ot[0],ot[1],ot[2]]);p.N.normalize(Pt,Pt),p.N.scale(Pt,Pt,dt);const Rt=p.N.add([],xe,Pt);p.N.transformMat4(Rt,Rt,ge);const cn=p.d4/p.ab,ct=p.N.length(Rt),St=p.bl(Math.max(ct*cn-p.d4,Number.EPSILON),0),Ze=Math.min(B.zoomFromMercatorZAdjusted(St),P.maxZoom);return Ze>.5*(p.bG+p.bx)?(B.setProjection({name:"mercator"}),B.zoom=Ze,this._cameraForBounds(B,d,y,w,C,I)):{center:B.center,zoom:Ze,bearing:w,pitch:C}}queryTerrainElevation(c,d){const y=this.transform.elevation;return y?(d=p.e({},{exaggerated:!0},d),y.getAtPoint(p.L.fromLngLat(c),null,d.exaggerated)):null}_cameraForBounds(c,d,y,w,C,I){if("globe"===c.projection.name)return this._cameraForBoundsOnGlobe(c,d,y,w,C,I);const B=c.clone(),P=this._extendCameraOptions(I),Q=B.padding;B.bearing=w,B.pitch=C;const j=p.bn.convert(d),q=p.bn.convert(y),J=new p.bn(j.lng,q.lat),te=new p.bn(q.lng,j.lat),le=B.project(j),ce=B.project(q),Ae=this.queryTerrainElevation(j),se=this.queryTerrainElevation(q),me=this.queryTerrainElevation(J),Ie=this.queryTerrainElevation(te),xe=[[le.x,le.y,Math.min(Ae||0,se||0,me||0,Ie||0)],[ce.x,ce.y,Math.max(Ae||0,se||0,me||0,Ie||0)]];let Be=p.bS.fromPoints(xe);const ge=B.getWorldToCameraMatrix(),Me=p.a6.invert(new Float64Array(16),ge);Be=p.bS.applyTransform(Be,ge);const He=p.N.sub([],Be.max,Be.min),Ge=Q.left||0,nt=Q.right||0,dt=Q.bottom||0,ot=Q.top||0,{left:Pt,right:Rt,top:cn,bottom:ct}=P.padding,St=.5*(Ge+nt),Ze=.5*(ot+dt),gt=Math.min(B.scaleZoom(B.scale*Math.min((B.width-(Ge+nt+Pt+Rt))/He[0],(B.height-(dt+ot+ct+cn))/He[1])),P.maxZoom),An=B.scale/B.zoomScale(gt);Be=new p.bS([Be.min[0]-(Pt+St)*An,Be.min[1]-(ct+Ze)*An,Be.min[2]],[Be.max[0]+(Rt+St)*An,Be.max[1]+(cn+Ze)*An,Be.max[2]]);const Tn=.5*He[2],Cn=this._minimumAABBFrustumDistance(B,Be),$n=[0,0,1,0];p.a7.transformMat4($n,$n,ge),p.a7.normalize($n,$n);const li=p.N.scale([],$n,Cn+Tn),xi=p.N.add([],Be.center,li),yi=("number"==typeof P.offset.x&&"number"==typeof P.offset.y?new p.P(P.offset.x,P.offset.y):p.P.convert(P.offset)).rotate(-p.bj(w));Be.center[0]-=yi.x*An,Be.center[1]+=yi.y*An,p.N.transformMat4(Be.center,Be.center,Me),p.N.transformMat4(xi,xi,Me);const ci=[Be.center[0],Be.center[1],xi[2]*B.pixelsPerMeter];p.N.scale(ci,ci,1/B.worldSize);const gr=p.at(ci[0]),Ki=p.au(ci[1]),lr=Math.min(B._zoomFromMercatorZ(ci[2]),P.maxZoom),rr=new p.bn(gr,Ki);return B.mercatorFromTransition&&lr<.5*(p.bG+p.bx)?(B.setProjection({name:"globe"}),B.zoom=lr,this._cameraForBounds(B,d,y,w,C,I)):{center:rr,zoom:lr,bearing:w,pitch:C}}fitBounds(c,d,y){const w=this.cameraForBounds(c,d);return this._fitInternal(w,d,y)}fitScreenCoordinates(c,d,y,w,C){const I=p.P.convert(c),B=p.P.convert(d),P=new p.P(Math.min(I.x,B.x),Math.min(I.y,B.y)),Q=new p.P(Math.max(I.x,B.x),Math.max(I.y,B.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(I,B))return this;const j=this.transform.pointLocation3D(P),q=this.transform.pointLocation3D(Q),J=this.transform.pointLocation3D(new p.P(P.x,Q.y)),te=this.transform.pointLocation3D(new p.P(Q.x,P.y)),le=[Math.min(j.lng,q.lng,J.lng,te.lng),Math.min(j.lat,q.lat,J.lat,te.lat)],ce=[Math.max(j.lng,q.lng,J.lng,te.lng),Math.max(j.lat,q.lat,J.lat,te.lat)],Ae=w&&w.pitch?w.pitch:this.getPitch(),se=this._cameraForBounds(this.transform,le,ce,y,Ae,w);return this._fitInternal(se,w,C)}_fitInternal(c,d,y){return c?(delete(d=p.e(c,d)).padding,d.linear?this.easeTo(d,y):this.flyTo(d,y)):this}jumpTo(c,d){this.stop();const y=c.preloadOnly?this.transform.clone():this.transform;let w=!1,C=!1,I=!1;return"zoom"in c&&y.zoom!==+c.zoom&&(w=!0,y.zoom=+c.zoom),void 0!==c.center&&(y.center=p.bn.convert(c.center)),"bearing"in c&&y.bearing!==+c.bearing&&(C=!0,y.bearing=+c.bearing),"pitch"in c&&y.pitch!==+c.pitch&&(I=!0,y.pitch=+c.pitch),null==c.padding||y.isPaddingEqual(c.padding)||(y.padding=c.padding),c.preloadOnly?(this._preloadTiles(y),this):(this.fire(new p.b("movestart",d)).fire(new p.b("move",d)),w&&this.fire(new p.b("zoomstart",d)).fire(new p.b("zoom",d)).fire(new p.b("zoomend",d)),C&&this.fire(new p.b("rotatestart",d)).fire(new p.b("rotate",d)).fire(new p.b("rotateend",d)),I&&this.fire(new p.b("pitchstart",d)).fire(new p.b("pitch",d)).fire(new p.b("pitchend",d)),this.fire(new p.b("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||p.w(j0),this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,d){const y=this.transform;if(!y.projection.supportsFreeCamera)return p.w(j0),this;this.stop();const w=y.zoom,C=y.pitch,I=y.bearing;y.setFreeCameraOptions(c);const B=w!==y.zoom,P=C!==y.pitch,Q=I!==y.bearing;return this.fire(new p.b("movestart",d)).fire(new p.b("move",d)),B&&this.fire(new p.b("zoomstart",d)).fire(new p.b("zoom",d)).fire(new p.b("zoomend",d)),Q&&this.fire(new p.b("rotatestart",d)).fire(new p.b("rotate",d)).fire(new p.b("rotateend",d)),P&&this.fire(new p.b("pitchstart",d)).fire(new p.b("pitch",d)).fire(new p.b("pitchend",d)),this.fire(new p.b("moveend",d)),this}easeTo(c,d){this._stop(!1,c.easeId),(!1===(c=p.e({offset:[0,0],duration:500,easing:p.d0},c)).animate||this._prefersReducedMotion(c))&&(c.duration=0);const y=this.transform,w=this.getZoom(),C=this.getBearing(),I=this.getPitch(),B=this.getPadding(),P="zoom"in c?+c.zoom:w,Q="bearing"in c?this._normalizeBearing(c.bearing,C):C,j="pitch"in c?+c.pitch:I,q="padding"in c?c.padding:y.padding,J=p.P.convert(c.offset);let te,le,ce;if("globe"===y.projection.name){const Ge=p.L.fromLngLat(y.center),nt=J.rotate(-y.angle);Ge.x+=nt.x/y.worldSize,Ge.y+=nt.y/y.worldSize;const dt=Ge.toLngLat(),ot=p.bn.convert(c.center||dt);this._normalizeCenter(ot),te=y.centerPoint.add(nt),le=new p.P(Ge.x,Ge.y).mult(y.worldSize),ce=new p.P(p.a5(ot.lng),p.ae(ot.lat)).mult(y.worldSize).sub(le)}else{te=y.centerPoint.add(J);const Ge=y.pointLocation(te),nt=p.bn.convert(c.center||Ge);this._normalizeCenter(nt),le=y.project(Ge),ce=y.project(nt).sub(le)}const Ae=y.zoomScale(P-w);let se,me;c.around&&(se=p.bn.convert(c.around),me=y.locationPoint(se));const Ie=this._zooming||P!==w,xe=this._rotating||C!==Q,Be=this._pitching||j!==I,ge=!y.isPaddingEqual(q),Me=Ge=>nt=>{if(Ie&&(Ge.zoom=p.U(w,P,nt)),xe&&(Ge.bearing=p.U(C,Q,nt)),Be&&(Ge.pitch=p.U(I,j,nt)),ge&&(Ge.interpolatePadding(B,q,nt),te=Ge.centerPoint.add(J)),se)Ge.setLocationAtPoint(se,me);else{const dt=Ge.zoomScale(Ge.zoom-w),ot=P>w?Math.min(2,Ae):Math.max(.5,Ae),Pt=Math.pow(ot,1-nt),Rt=Ge.unproject(le.add(ce.mult(nt*Pt)).mult(dt));Ge.setLocationAtPoint(Ge.renderWorldCopies?Rt.wrap():Rt,te)}return c.preloadOnly||this._fireMoveEvents(d),Ge};if(c.preloadOnly){const Ge=this._emulate(Me,c.duration,y);return this._preloadTiles(Ge),this}const He={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ie,this._rotating=xe,this._pitching=Be,this._easeId=c.easeId,this._prepareEase(d,c.noMoveStart,He),this._ease(Me(y),Ge=>{"sea"===y.cameraElevationReference&&y.recenterOnTerrain(),this._afterEase(d,Ge)},c),this}_prepareEase(c,d,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),d||y.moving||this.fire(new p.b("movestart",c)),this._zooming&&!y.zooming&&this.fire(new p.b("zoomstart",c)),this._rotating&&!y.rotating&&this.fire(new p.b("rotatestart",c)),this._pitching&&!y.pitching&&this.fire(new p.b("pitchstart",c))}_fireMoveEvents(c){this.fire(new p.b("move",c)),this._zooming&&this.fire(new p.b("zoom",c)),this._rotating&&this.fire(new p.b("rotate",c)),this._pitching&&this.fire(new p.b("pitch",c))}_afterEase(c,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,w=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,y&&this.fire(new p.b("zoomend",c)),w&&this.fire(new p.b("rotateend",c)),C&&this.fire(new p.b("pitchend",c)),this.fire(new p.b("moveend",c))}flyTo(c,d){if(this._prefersReducedMotion(c)){const ct=p.ac(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ct,d)}this.stop(),c=p.e({offset:[0,0],speed:1.2,curve:1.42,easing:p.d0},c);const y=this.transform,w=this.getZoom(),C=this.getBearing(),I=this.getPitch(),B="zoom"in c?p.aa(+c.zoom,y.minZoom,y.maxZoom):w,P="bearing"in c?this._normalizeBearing(c.bearing,C):C,Q="pitch"in c?+c.pitch:I,j=y.zoomScale(B-w),q=p.P.convert(c.offset),J=y.centerPoint.add(q),te=y.pointLocation(J);let le=c.center;if(le&&c.padding){const ct=this._cameraForBounds(this.transform,le,le,P,Q,c);ct&&(le=ct.center)}le=p.bn.convert(le||te),this._normalizeCenter(le);const ce=y.project(te),Ae=y.project(le).sub(ce);let se=c.curve;const me=Math.max(y.width,y.height),Ie=me/j,xe=Ae.mag();if("minZoom"in c){const ct=p.aa(Math.min(c.minZoom,w,B),y.minZoom,y.maxZoom),St=me/y.zoomScale(ct-w);se=Math.sqrt(St/xe*2)}const Be=se*se;function ge(ct){const St=(Ie*Ie-me*me+(ct?-1:1)*Be*Be*xe*xe)/(2*(ct?Ie:me)*Be*xe);return Math.log(Math.sqrt(St*St+1)-St)}function Me(ct){return(Math.exp(ct)-Math.exp(-ct))/2}function He(ct){return(Math.exp(ct)+Math.exp(-ct))/2}const Ge=ge(0);let nt=function(ct){return He(Ge)/He(Ge+se*ct)},dt=function(ct){return me*((He(Ge)*(Me(St=Ge+se*ct)/He(St))-Me(Ge))/Be)/xe;var St},ot=(ge(1)-Ge)/se;if(Math.abs(xe)<1e-6||!isFinite(ot)){if(Math.abs(me-Ie)<1e-6)return this.easeTo(c,d);const ct=Ie<me?-1:1;ot=Math.abs(Math.log(Ie/me))/se,dt=function(){return 0},nt=function(St){return Math.exp(ct*se*St)}}c.duration="duration"in c?+c.duration:1e3*ot/("screenSpeed"in c?+c.screenSpeed/se:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0);const Pt=C!==P,Rt=Q!==I,cn=ct=>St=>{const Ze=St*ot,gt=1/nt(Ze);ct.zoom=1===St?B:w+ct.scaleZoom(gt),Pt&&(ct.bearing=p.U(C,P,St)),Rt&&(ct.pitch=p.U(I,Q,St));const An=1===St?le:ct.unproject(ce.add(Ae.mult(dt(Ze))).mult(gt));return ct.setLocationAtPoint(ct.renderWorldCopies?An.wrap():An,J),ct._updateCameraOnTerrain(),c.preloadOnly||this._fireMoveEvents(d),ct};if(c.preloadOnly){const ct=this._emulate(cn,c.duration,y);return this._preloadTiles(ct),this}return this._zooming=!0,this._rotating=Pt,this._pitching=Rt,this._prepareEase(d,!1),this._ease(cn(y),()=>this._afterEase(d),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,d)}if(!c){const y=this.handlers;y&&y.stop(!1)}return this}_ease(c,d,y){!1===y.animate||0===y.duration?(c(1),d()):(this._easeStart=p.f.now(),this._easeOptions=y,this._onEaseFrame=c,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((p.f.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,d){c=p.bh(c,-180,180);const y=Math.abs(c-d);return Math.abs(c-360-d)<y&&(c-=360),Math.abs(c+360-d)<y&&(c+=360),c}_normalizeCenter(c){const d=this.transform;if(d.maxBounds||"globe"!==d.projection.name&&!d.renderWorldCopies)return;const y=c.lng-d.center.lng;c.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(c){return this._respectPrefersReducedMotion&&p.f.prefersReducedMotion&&!(c&&c.essential)}_emulate(c,d,y){const w=Math.ceil(15*d/1e3),C=[],I=c(y.clone());for(let B=0;B<=w;B++){const P=I(B/w);C.push(P.clone())}return C}}class pl{constructor(c={}){this.options=c,p.aY(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const d=this.options&&this.options.compact;return this._map=c,this._container=Di("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Di("button","mapboxgl-ctrl-attrib-button",this._container),Di("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Di("div","mapboxgl-ctrl-attrib-inner",this._container),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===d&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(c,d){const y=this._map._getUIString(`AttributionControl.${d}`);c.removeAttribute("title"),c.firstElementChild&&c.firstElementChild.setAttribute("title",y)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||p.d5.ACCESS_TOKEN}];if(c){const y=d.reduce((w,C,I)=>(C.value&&(w+=`${C.key}=${C.value}${I<d.length-1?"&":""}`),w),"?");c.href=`${p.d5.FEEDBACK_URL}/${y}#${sm(this._map,!0)}`,c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}}_updateData(c){!c||"metadata"!==c.sourceDataType&&"visibility"!==c.sourceDataType&&"style"!==c.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const d=this._map.style._mergedSourceCaches;for(const w in d){const C=d[w];if(C.used){const I=C.getSource();I.attribution&&c.indexOf(I.attribution)<0&&c.push(I.attribution)}}c.sort((w,C)=>w.length-C.length),c=c.filter((w,C)=>{for(let I=C+1;I<c.length;I++)if(c[I].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=[...this.options.customAttribution,...c]:c.unshift(this.options.customAttribution));const y=c.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,c.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Qh{constructor(){p.aY(["_updateLogo","_updateCompact"],this)}onAdd(c){this._map=c,this._container=Di("div","mapboxgl-ctrl");const d=Di("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&"metadata"!==c.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(0===Object.entries(c).length)return!0;for(const d in c){const y=c[d].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const d=c[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class v_{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const d=++this._id;return this._queue.push({callback:c,id:d,cancelled:!1}),d}remove(c){const d=this._currentlyRunning,y=d?this._queue.concat(d):this._queue;for(const w of y)if(w.id===c)return void(w.cancelled=!0)}run(c=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const y of d)if(!y.cancelled&&(y.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function jh(_,c,d){if(_=new p.bn(_.lng,_.lat),c){const y=new p.bn(_.lng-360,_.lat),w=new p.bn(_.lng+360,_.lat),C=360*Math.ceil(Math.abs(_.lng-d.center.lng)/360),I=d.locationPoint(_).distSqr(c),B=c.x<0||c.y<0||c.x>d.width||c.y>d.height;d.locationPoint(y).distSqr(c)<I&&(B||Math.abs(y.lng-d.center.lng)<C)?_=y:d.locationPoint(w).distSqr(c)<I&&(B||Math.abs(w.lng-d.center.lng)<C)&&(_=w)}for(;Math.abs(_.lng-d.center.lng)>180;){const y=d.locationPoint(_);if(y.x>=0&&y.y>=0&&y.x<=d.width&&y.y<=d.height)break;_.lng>d.center.lng?_.lng-=360:_.lng+=360}return _}const Mu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class $A extends p.E{constructor(c,d){if(super(),(c instanceof HTMLElement||d)&&(c=p.e({element:c},d)),p.aY(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=c&&c.occludedOpacity||.2,c&&c.element)this._element=c.element,this._offset=p.P.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=Di("div");const C=41,I=27,B=ia("svg",{display:"block",height:C*this._scale+"px",width:I*this._scale+"px",viewBox:`0 0 ${I} ${C}`},this._element),P=ia("radialGradient",{id:"shadowGradient"},ia("defs",{},B));ia("stop",{offset:"10%","stop-opacity":.4},P),ia("stop",{offset:"100%","stop-opacity":.05},P),ia("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},B),ia("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},B),ia("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},B),ia("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},B),this._offset=p.P.convert(c&&c.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",C=>{C.preventDefault()}),this._element.addEventListener("mousedown",C=>{C.preventDefault()});const y=this._element.classList;for(const C in Mu)y.remove(`mapboxgl-marker-anchor-${C}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`);const w=c&&c.className?c.className.trim().split(/\s+/):[];y.add(...w),this._popup=null}addTo(c){return c===this._map||(this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._updateMoving),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),c.on("click",this._onMapClick)),this}remove(){const c=this._map;return c&&(c.off("click",this._onMapClick),c.off("move",this._updateMoving),c.off("moveend",this._update),c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler),c.off("mouseup",this._onUp),c.off("touchend",this._onUp),c.off("mousemove",this._onMove),c.off("touchmove",this._onMove),c.off("remove",this._clearFadeTimer),c._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=p.bn.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(24.6+w)],"bottom-right":[-w,-1*(24.6+w)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=c,c._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(c){const d=c.code,y=c.charCode||c.keyCode;"Space"!==d&&"Enter"!==d&&32!==y&&13!==y||this.togglePopup()}_onMapClick(c){const d=c.originalEvent.target,y=this._element;this._popup&&(d===y||y.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?(c.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(c.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const c=this._map,d=this._pos;if(!c||!d)return!1;const y=c.unproject(d),w=c.getFreeCameraOptions();if(!w.position)return!1;const C=w.position.toLngLat();return C.distanceTo(y)<.9*C.distanceTo(this._lngLat)}_evaluateOpacity(){const c=this._map;if(!c)return;const d=this._pos;if(!d||d.x<0||d.x>c.transform.width||d.y<0||d.y>c.transform.height)return void this._clearFadeTimer();const y=c.unproject(d);let w;c._showingGlobe()&&p.d6(c.transform,this._lngLat)?w=0:(w=1-c._queryFogOpacity(y),c.transform._terrainEnabled()&&c.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const c=this._pos;if(!c||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${c.x}px,${c.y}px)\n            ${Mu[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${d.x}px,${d.y}px)\n        `}_calculateXYTransform(){const c=this._pos,d=this._map,y=this.getPitchAlignment();if(!d||!c||"map"!==y)return"";if(!d._showingGlobe()){const P=d.getPitch();return P?`rotateX(${P}deg)`:""}const w=p.bF(p.d7(d.transform,this._lngLat)),C=c.sub(p.d8(d.transform)),I=Math.abs(C.x)+Math.abs(C.y);if(0===I)return"";const B=w/I;return`rotateX(${-C.y*B}deg) rotateY(${C.x*B}deg)`}_calculateZTransform(){const c=this._pos,d=this._map;if(!d||!c)return"";let y=0;const w=this.getRotationAlignment();if("map"===w)if(d._showingGlobe()){const C=d.project(new p.bn(this._lngLat.lng,this._lngLat.lat+.001)),I=d.project(new p.bn(this._lngLat.lng,this._lngLat.lat-.001)).sub(C);y=p.bF(Math.atan2(I.y,I.x))-90}else y=-d.getBearing();else if("horizon"===w){const C=p.O(4,6,d.getZoom()),I=p.d8(d.transform);I.y+=C*d.transform.height;const B=c.sub(I),P=p.bF(Math.atan2(B.y,B.x));y=(P>90?P-270:P+90)*(1-C)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(c){cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=jh(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),!0===c?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(c){return this._offset=p.P.convert(c),this._update(),this}addClassName(c){return this._element.classList.add(c),this}removeClassName(c){return this._element.classList.remove(c),this}toggleClassName(c){return this._element.classList.toggle(c)}_onMove(c){const d=this._map;if(!d)return;const y=this._pointerdownPos,w=this._positionDelta;if(y&&w){if(!this._isDragging){const C=this._clickTolerance||d._clickTolerance;if(c.point.dist(y)<C)return;this._isDragging=!0}this._pos=c.point.sub(w),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new p.b("dragstart"))),this.fire(new p.b("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const c=this._map;c&&(c.off("mousemove",this._onMove),c.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new p.b("dragend")),this._state="inactive"}_addDragHandler(c){const d=this._map,y=this._pos;d&&y&&this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(y),this._pointerdownPos=c.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(c){this._draggable=!!c;const d=this._map;return d&&(c?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(c){return this._occludedOpacity=c||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const qA={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},G0=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function b_(_=new p.P(0,0),c="bottom"){if("number"==typeof _){const d=Math.round(Math.sqrt(.5*Math.pow(_,2)));switch(c){case"top":return new p.P(0,_);case"top-left":return new p.P(d,d);case"top-right":return new p.P(-d,d);case"bottom":return new p.P(0,-_);case"bottom-left":return new p.P(d,-d);case"bottom-right":return new p.P(-d,-d);case"left":return new p.P(_,0);case"right":return new p.P(-_,0)}return new p.P(0,0)}return _ instanceof p.P||Array.isArray(_)?p.P.convert(_):p.P.convert(_[c]||[0,0])}class Xf{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const d=p.cc((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,d,y){this._start=this.getValue(d),this._end=c,this._startTime=d,this._endTime=d+y}}const sf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},dm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1};class KA{constructor(){this.showOverdrawInspector=!1,this.showTileBoundaries=!1,this.showParseStatus=!1,this.continuousRedraw=!1,this.showTileAABBs=!1,this.showPadding=!1,this.showTerrainWireframe=!1,this.showLayers2DWireframe=!1,this.showLayers3DWireframe=!1}}const fm={showCompass:!0,showZoom:!0,visualizePitch:!1};class pu{constructor(c,d,y=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new jA({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,y&&(this.mousePitch=new Vp({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),p.aY(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(c,d){this.mouseRotate.mousedown(c,d),this.mousePitch&&this.mousePitch.mousedown(c,d),Dh()}move(c,d){const y=this.map,w=this.mouseRotate.mousemoveWindow(c,d),C=w&&w.bearingDelta;if(C&&y.setBearing(y.getBearing()+C),this.mousePitch){const I=this.mousePitch.mousemoveWindow(c,d),B=I&&I.pitchDelta;B&&y.setPitch(y.getPitch()+B)}}off(){const c=this.element;c.removeEventListener("mousedown",this.mousedown),c.removeEventListener("touchstart",this.touchstart,{passive:!1}),c.removeEventListener("touchmove",this.touchmove),c.removeEventListener("touchend",this.touchend),c.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Ta(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(c){this.down(p.e({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),Oc(this.element,c)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(c){this.move(c,Oc(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){1!==c.targetTouches.length?this.reset():(this._startPos=this._lastPos=Ul(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){1!==c.targetTouches.length?this.reset():(this._lastPos=Ul(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){0===c.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Yf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Bl={maxWidth:100,unit:"metric"},bd={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:p.dk,supported:Ra,setRTLTextPlugin:p.dm,getRTLTextPluginStatus:p.dn,Map:class extends zo{constructor(_){const c=_;if(null!=(_=p.e({},dm,_)).minZoom&&null!=_.maxZoom&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=_.minPitch&&null!=_.maxPitch&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=_.minPitch&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=_.maxPitch&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(_.antialias&&p.d9(window)&&(_.antialias=!1,p.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new FA(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._repaint=!1,this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._collectResourceTiming=_.collectResourceTiming,this._language=this._parseLanguage(_.language),this._worldview=_.worldview,this._renderTaskQueue=new v_,this._domRenderTaskQueue=new v_,this._controls=[],this._markers=[],this._popups=[],this._mapId=p.aC(),this._locale=p.e({},sf,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._performanceMetricsCollection=_.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Xf(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new p.da(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,this._contextCreateOptions=_.contextCreateOptions?{..._.contextCreateOptions}:{},"string"==typeof _.container){const d=document.getElementById(_.container);if(!d)throw new Error(`Container '${_.container.toString()}' not found.`);this._container=d}else{if(!(_.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&p.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),p.aY(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._debugParams=new KA,this._tp=_.devtools?new rm(this):new rm,this._tp.registerParameter(this._debugParams,["Debug"],"showOverdrawInspector",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileBoundaries",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showParseStatus",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"continuousRedraw",void 0,d=>{this.repaint=d}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileAABBs",void 0,d=>{this.showTileAABBs=d}),this._tp.registerParameter(this._debugParams,["Debug"],"showPadding",void 0,d=>{this.showPadding=d}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showTerrainWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers2DWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers3DWireframe",void 0,()=>{this._update()}),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Q0(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,(_.style||!_.testMode)&&this.setStyle(_.style||p.d5.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),_.hash&&(this._hash=new Lp("string"==typeof _.hash&&_.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==c.center&&null==c.zoom||(this.transform._unmodified=!1),this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch});const d=_.bounds;d&&(this.resize(),this.fitBounds(d,p.e({},_.fitBoundsOptions,{duration:0})))}this.resize(),_.attributionControl&&this.addControl(new pl({customAttribution:_.customAttribution})),this._logoControl=new Qh,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",d=>{this._update("style"===d.dataType),this.fire(new p.b(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new p.b(`${d.dataType}dataloading`,d))})}_getMapId(){return this._mapId}addControl(_,c){if(void 0===c&&(c=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new p.a(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=_.onAdd(this);this._controls.push(_);const y=this._controlPositions[c];return-1!==c.indexOf("bottom")?y.insertBefore(d,y.firstChild):y.appendChild(d),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new p.a(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(_);return c>-1&&this._controls.splice(c,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const c=!this._moving;return c&&this.fire(new p.b("movestart",_)).fire(new p.b("move",_)),this.fire(new p.b("resize",_)),c&&this.fire(new p.b("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(p.ad.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new p.b("zoomstart")).fire(new p.b("zoom")).fire(new p.b("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new p.b("zoomstart")).fire(new p.b("zoom")).fire(new p.b("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new p.b("pitchstart")).fire(new p.b("pitch")).fire(new p.b("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new p.b("pitchstart")).fire(new p.b("pitch")).fire(new p.b("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(_){return"auto"===_?navigator.language:Array.isArray(_)?0===_.length?void 0:_.map(c=>"auto"===c?navigator.language:c):_}setLanguage(_){const c=this._parseLanguage(_);if(!this.style||c===this._language)return this;this._language=c,this.style.reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(_){return this.style&&_!==this._worldview?(this._worldview=_,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(_){return this._lazyInitEmptyStyle(),_?"string"==typeof _&&(_={name:_}):_=null,this._useExplicitProjection=!!_,this._prioritizeAndUpdateProjection(_,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const _=this.transform,c=_.projection.name;let d;"globe"===c&&_.zoom>=p.bx?(_.setMercatorFromTransition(),d=!0):"mercator"===c&&_.zoom<p.bx&&(_.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(_,c){return this._updateProjection(_||c||{name:"mercator"})}_updateProjection(_){let c;return c="globe"===_.name&&this.transform.zoom>=p.bx?this.transform.setMercatorFromTransition():this.transform.setProjection(_),this.style.applyProjectionUpdate(),c&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(_){return this.transform.locationPoint3D(p.bn.convert(_))}unproject(_){return this.transform.pointLocation3D(p.P.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(_,c,d){if("mouseenter"===_||"mouseover"===_){let y=!1;const w=I=>{const B=c.filter(Q=>this.getLayer(Q)),P=B.length?this.queryRenderedFeatures(I.point,{layers:B}):[];P.length?y||(y=!0,d.call(this,new Al(_,this,I.originalEvent,{features:P}))):y=!1},C=()=>{y=!1};return{layers:new Set(c),listener:d,delegates:{mousemove:w,mouseout:C}}}if("mouseleave"===_||"mouseout"===_){let y=!1;const w=I=>{const B=c.filter(P=>this.getLayer(P));(B.length?this.queryRenderedFeatures(I.point,{layers:B}):[]).length?y=!0:y&&(y=!1,d.call(this,new Al(_,this,I.originalEvent)))},C=I=>{y&&(y=!1,d.call(this,new Al(_,this,I.originalEvent)))};return{layers:new Set(c),listener:d,delegates:{mousemove:w,mouseout:C}}}{const y=w=>{const C=c.filter(B=>this.getLayer(B)),I=C.length?this.queryRenderedFeatures(w.point,{layers:C}):[];I.length&&(w.features=I,d.call(this,w),delete w.features)};return{layers:new Set(c),listener:d,delegates:{[_]:y}}}}on(_,c,d){if(void 0===d)return super.on(_,c);if(Array.isArray(c)||(c=[c]),c)for(const w of c)if(!this._isValidId(w))return this;const y=this._createDelegatedListener(_,c,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(y);for(const w in y.delegates)this.on(w,y.delegates[w]);return this}once(_,c,d){if(void 0===d)return super.once(_,c);if(Array.isArray(c)||(c=[c]),c)for(const w of c)if(!this._isValidId(w))return this;const y=this._createDelegatedListener(_,c,d);for(const w in y.delegates)this.once(w,y.delegates[w]);return this}off(_,c,d){if(void 0===d)return super.off(_,c);c=new Set(Array.isArray(c)?c:[c]);for(const C of c)if(!this._isValidId(C))return this;const y=(C,I)=>{if(C.size!==I.size)return!1;for(const B of C)if(!I.has(B))return!1;return!0},w=this._delegatedListeners?this._delegatedListeners[_]:void 0;return w&&(C=>{for(let I=0;I<C.length;I++){const B=C[I];if(B.listener===d&&y(B.layers,c)){for(const P in B.delegates)this.off(P,B.delegates[P]);return C.splice(I,1),this}}})(w),this}queryRenderedFeatures(_,c){if(!this.style)return[];if(void 0!==c||void 0===_||_ instanceof p.P||Array.isArray(_)||(c=_,_=void 0),_=_||[[0,0],[this.transform.width,this.transform.height]],(c=c||{}).layers&&Array.isArray(c.layers))for(const d of c.layers)if(!this._isValidId(d))return[];return this.style.queryRenderedFeatures(_,c,this.transform)}querySourceFeatures(_,c){return this._isValidId(_)?this.style.querySourceFeatures(_,c):[]}isPointOnSurface(_){const{name:c}=this.transform.projection;return"globe"!==c&&"mercator"!==c&&p.w(`${c} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(p.P.convert(_))}setStyle(_,c){return!1!==(c=p.e({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c)).diff&&c.localIdeographFontFamily===this._localIdeographFontFamily&&c.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(_,c))}_getUIString(_){const c=this._locale[_];if(null==c)throw new Error(`Missing UI string '${_}'`);return c}_updateStyle(_,c){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),_&&(this.style=new Mr(this,c||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof _?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Mr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,c){if("string"==typeof _){const d=this._requestManager.normalizeStyleURL(_),y=this._requestManager.transformRequest(d,p.R.Style);p.g(y,(w,C)=>{w?this.fire(new p.a(w)):C&&this._updateDiff(C,c)})}else"object"==typeof _&&this._updateDiff(_,c)}_updateDiff(_,c){try{this.style.setState(_)&&this._update(!0)}catch(d){p.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(_,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(p.w("There is no style added to the map."),!1)}_isValidId(_){return null==_?(this.fire(new p.a(new Error("IDs can't be empty."))),!1):!p.c4(_)||(this.fire(new p.a(new Error(`IDs can't contain special symbols: "${_}".`))),!1)}addSource(_,c){return this._isValidId(_)?(this._lazyInitEmptyStyle(),this.style.addSource(_,c),this._update(!0)):this}isSourceLoaded(_){return!!this._isValidId(_)&&!!this.style&&this.style._isSourceCacheLoaded(_)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(_,c,d){this._lazyInitEmptyStyle(),this.style.addSourceType(_,c,d)}removeSource(_){return this._isValidId(_)?(this.style.removeSource(_),this._updateTerrain(),this._update(!0)):this}getSource(_){return this._isValidId(_)?this.style.getOwnSource(_):null}addImage(_,c,{pixelRatio:d=1,sdf:y=!1,stretchX:w,stretchY:C,content:I}={}){if(this._lazyInitEmptyStyle(),c instanceof HTMLImageElement||ImageBitmap&&c instanceof ImageBitmap){const{width:B,height:P,data:Q}=p.f.getImageData(c);this.style.addImage(_,{data:new p.h({width:B,height:P},Q),pixelRatio:d,stretchX:w,stretchY:C,content:I,sdf:y,version:0})}else if(void 0===c.width||void 0===c.height)this.fire(new p.a(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:B,height:P}=c,Q=c;this.style.addImage(_,{data:new p.h({width:B,height:P},new Uint8Array(Q.data)),pixelRatio:d,stretchX:w,stretchY:C,content:I,sdf:y,version:0,userImage:Q}),Q.onAdd&&Q.onAdd(this,_)}}updateImage(_,c){this._lazyInitEmptyStyle();const d=this.style.getImage(_);if(!d)return void this.fire(new p.a(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=c instanceof HTMLImageElement||ImageBitmap&&c instanceof ImageBitmap?p.f.getImageData(c):c,{width:w,height:C}=y,I=y.data;if(void 0===w||void 0===C)return void this.fire(new p.a(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==d.data.width||C!==d.data.height)return void this.fire(new p.a(new Error(`The width and height of the updated image (${w}, ${C})\n                must be that same as the previous version of the image\n                (${d.data.width}, ${d.data.height})`)));const B=!(c instanceof HTMLImageElement||ImageBitmap&&c instanceof ImageBitmap);d.data.replace(I,B),this.style.updateImage(_,d)}hasImage(_){return _?!!this.style&&!!this.style.getImage(_):(this.fire(new p.a(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,c){p.d(this._requestManager.transformRequest(_,p.R.Image),(d,y)=>{c(d,y instanceof HTMLImageElement?p.f.getImageData(y):y)})}listImages(){return this.style.listImages()}addModel(_,c){this._lazyInitEmptyStyle(),this.style.addModel(_,c)}hasModel(_){return _?this.style.hasModel(_):(this.fire(new p.a(new Error("Missing required model id"))),!1)}removeModel(_){this.style.removeModel(_)}listModels(){return this.style.listModels()}addLayer(_,c){return this._isValidId(_.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(_,c),this._update(!0)):this}getSlot(_){const c=this.getLayer(_);return c&&c.slot||null}setSlot(_,c){return this.style.setSlot(_,c),this.style.mergeLayers(),this._update(!0)}addImport(_,c){return this.style.addImport(_,c),this}updateImport(_,c){return"string"!=typeof c&&c.id!==_?(this.removeImport(_),this.addImport(c)):(this.style.updateImport(_,c),this._update(!0))}removeImport(_){return this.style.removeImport(_),this}moveImport(_,c){return this.style.moveImport(_,c),this._update(!0)}moveLayer(_,c){return this._isValidId(_)?(this.style.moveLayer(_,c),this._update(!0)):this}removeLayer(_){return this._isValidId(_)?(this.style.removeLayer(_),this._update(!0)):this}getLayer(_){return this._isValidId(_)?this.style.getOwnLayer(_):null}setLayerZoomRange(_,c,d){return this._isValidId(_)?(this.style.setLayerZoomRange(_,c,d),this._update(!0)):this}setFilter(_,c,d={}){return this._isValidId(_)?(this.style.setFilter(_,c,d),this._update(!0)):this}getFilter(_){return this._isValidId(_)?this.style.getFilter(_):null}setPaintProperty(_,c,d,y={}){return this._isValidId(_)?(this.style.setPaintProperty(_,c,d,y),this._update(!0)):this}getPaintProperty(_,c){return this._isValidId(_)?this.style.getPaintProperty(_,c):null}setLayoutProperty(_,c,d,y={}){return this._isValidId(_)?(this.style.setLayoutProperty(_,c,d,y),this._update(!0)):this}getLayoutProperty(_,c){return this._isValidId(_)?this.style.getLayoutProperty(_,c):null}getConfigProperty(_,c){return this.style.getConfigProperty(_,c)}setConfigProperty(_,c,d){return this.style.setConfigProperty(_,c,d),this._update(!0)}setLights(_){if(this._lazyInitEmptyStyle(),_&&1===_.length&&"flat"===_[0].type){const c=_[0];c.properties?this.style.setFlatLight(c.properties,c.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(_),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const _=this.style.getLights()||[];return 0===_.length&&_.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),_}setLight(_,c={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:_}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(_){return this.style.setCamera(_),this._triggerCameraUpdate(_)}_triggerCameraUpdate(_){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===_["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(p.bn.convert(_),this.transform):0}setFeatureState(_,c){return this._isValidId(_.source)?(this.style.setFeatureState(_,c),this._update()):this}removeFeatureState(_,c){return this._isValidId(_.source)?(this.style.removeFeatureState(_,c),this._update()):this}getFeatureState(_){return this._isValidId(_.source)?this.style.getFeatureState(_):null}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,c=this._container.getBoundingClientRect().height||300;let d,y,w,C=this._container;for(;C&&(!y||!w);){const I=window.getComputedStyle(C).transform;I&&"none"!==I&&(d=I.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&"0"!==d[0]&&"1"!==d[0]&&(y=d[0]),d[3]&&"0"!==d[3]&&"1"!==d[3]&&(w=d[3])),C=C.parentElement}this._containerWidth=y?Math.abs(_/y):_,this._containerHeight=w?Math.abs(c/w):c}_detectMissingCSS(){"rgb(250, 128, 114)"!==window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&p.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=Di("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=Di("div","mapboxgl-canvas-container",_);this._canvas=Di("canvas","mapboxgl-canvas",c),this._interactive&&(c.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=Di("div","mapboxgl-control-container",_),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{y[w]=Di("div",`mapboxgl-ctrl-${w}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,c){const d=p.f.devicePixelRatio||1;this._canvas.width=d*Math.ceil(_),this._canvas.height=d*Math.ceil(c),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${c}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const c=this._markers.indexOf(_);-1!==c&&this._markers.splice(c,1)}_addPopup(_){this._popups.push(_)}_removePopup(_){const c=this._popups.indexOf(_);-1!==c&&this._popups.splice(c,1)}_setupPainter(){const _=p.e({},Ra.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl2",_);c?(p.db(c,!0),this.painter=new A_(c,this._contextCreateOptions,this.transform,this._tp),this.on("data",d=>{"source"===d.dataType&&this.painter.setTileLoadedFlag(!0)}),p.dc.testSupport(c)):this.fire(new p.a(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new p.b("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new p.b("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let c;this.fire(new p.b("renderstart"));const d=this.painter.context.extTimerQuery,y=p.f.now(),w=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(c=w.createQuery(),w.beginQuery(d.TIME_ELAPSED_EXT,c)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjectionTransition();const C=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const P=this.transform.zoom,Q=this.transform.pitch,j=p.f.now(),q=new p.K(P,{now:j,fadeDuration:C,pitch:Q,transition:this.style.transition});this.style.update(q)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let I=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),I=this._updateAverageElevation(y),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):I=this._updateAverageElevation(y),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,C,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries||this._debugParams.showTileBoundaries,showParseStatus:this.showParseStatus||this._debugParams.showParseStatus,wireframe:{terrain:this.showTerrainWireframe||this._debugParams.showTerrainWireframe,layers2D:this.showLayers2DWireframe||this._debugParams.showLayers2DWireframe,layers3D:this.showLayers3DWireframe||this._debugParams.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector||this._debugParams.showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs||this._debugParams.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:C,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding||this._debugParams.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new p.b("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new p.b("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),c){const P=p.f.now()-y;w.endQuery(d.TIME_ELAPSED_EXT),setTimeout(()=>{const Q=w.getQueryParameter(c,w.QUERY_RESULT)/1e6;w.deleteQuery(c),this.fire(new p.b("gpu-timing-frame",{cpuTime:P,gpuTime:Q}))},50)}if(this.listens("gpu-timing-layer")){const P=this.painter.collectGpuTimers();setTimeout(()=>{const Q=this.painter.queryGpuTimers(P);this.fire(new p.b("gpu-timing-layer",{layerTimes:Q}))},50)}if(this.listens("gpu-timing-deferred-render")){const P=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Q=this.painter.queryGpuTimeDeferredRender(P);this.fire(new p.b("gpu-timing-deferred-render",{gpuTime:Q}))},50)}const B=this._sourcesDirty||this._styleDirty||this._placementDirty||I;if(B||this._repaint)this.triggerRepaint();else{const P=!this.isMoving()&&this.loaded();if(P&&(I=this._updateAverageElevation(y,!0)),I)this.triggerRepaint();else if(this._triggerFrame(!1),P&&(this.fire(new p.b("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Q=this._calculateSpeedIndex();this.fire(new p.b("speedindexcompleted",{speedIndex:Q})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||B||(this._fullyLoaded=!0,this._performanceMetricsCollection&&p.dd(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(_){for(const c of this._markers)_&&!this.getRenderWorldCopies()&&(c._lngLat=c._lngLat.wrap()),c._update();for(const c of this._popups)!_||this.getRenderWorldCopies()||c._trackPointer||(c._lngLat=c._lngLat.wrap()),c._update()}_updateAverageElevation(_,c=!1){const d=w=>(this.transform.averageElevation=w,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&d(0);const y=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(y||(c||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const w=this.transform.averageElevation;let C=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(C)?C=0:this._averageElevationLastSampledAt=_;const I=Math.abs(w-C);if(I>1){if(this._isInitialLoad||y)return this._averageElevation.jumpTo(C),d(C);this._averageElevation.easeTo(C,_,300)}else if(I>1e-4)return this._averageElevation.jumpTo(C),d(C)}return!!this._averageElevation.isEasing(_)&&d(this._averageElevation.getValue(_))}_authenticate(){p.de(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===p.df||401===_.status)){const c=this.painter.context.gl;p.db(c,!1),this._logoControl instanceof Qh&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new p.a(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),p.dg(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const _=this._isDragging();this.painter.updateTerrain(this.style,_)}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const d=this.painter.context.gl,y=d.createFramebuffer();function w(C){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,C,0);const I=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,I),I}return d.bindFramebuffer(d.FRAMEBUFFER,y),this._canvasPixelComparison(w(_),c.canvasCopies.map(w),c.timeStamps)}_canvasPixelComparison(_,c,d){let y=d[1]-d[0];const w=_.length/4;for(let C=0;C<c.length;C++){const I=c[C];let B=0;for(let P=0;P<I.length;P+=4)I[P]===_[P]&&I[P+1]===_[P+1]&&I[P+2]===_[P+2]&&I[P+3]===_[P+3]&&(B+=1);y+=(d[C+2]-d[C+1])*(1-B/w)}return y}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),p.dh(this.painter.context.gl),p.di.remove(),p.dj.remove(),this._removed=!0,this.fire(new p.b("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=p.f.frame(c=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(c)}))}_preloadTiles(_){const c=this.style?Object.values(this.style._sourceCaches):[];return p.b1(c,(d,y)=>d._preloadTiles(_,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}_onVisibilityChange(){"hidden"===document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(_){this._showParseStatus!==_&&(this._showParseStatus=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(_){this._showLayers2DWireframe!==_&&(this._showLayers2DWireframe=_,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(_){this._showLayers3DWireframe!==_&&(this._showLayers3DWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(_){this._showTileAABBs!==_&&(this._showTileAABBs=_,_&&this._update())}_setCacheLimits(_,c){p.dl(_,c)}get version(){return p.dk}},NavigationControl:class{constructor(_){this.options=p.e({},fm,_),this._container=Di("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(p.aY(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>{this._map&&this._map.zoomIn({},{originalEvent:c})}),Di("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>{this._map&&this._map.zoomOut({},{originalEvent:c})}),Di("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(p.aY(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:c}):d.resetNorth({},{originalEvent:c}))}),this._compassIcon=Di("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const _=this._map;if(!_)return;const c=_.getZoom(),d=c===_.getMaxZoom(),y=c===_.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const _=this._map;if(!_)return;const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(_.transform.pitch*(Math.PI/180)),.5)}) rotateX(${_.transform.pitch}deg) rotateZ(${_.transform.angle*(180/Math.PI)}deg)`:`rotate(${_.transform.angle*(180/Math.PI)}deg)`;_._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=c)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),_.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&_.on("pitch",this._rotateCompassArrow),_.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pu(_,this._compass,this.options.visualizePitch)),this._container}onRemove(){const _=this._map;_&&(this._container.remove(),this.options.showZoom&&_.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&_.off("pitch",this._rotateCompassArrow),_.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(_,c){const d=Di("button",_,this._container);return d.type="button",d.addEventListener("click",c),d}_setButtonTitle(_,c){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${c}`);_.setAttribute("aria-label",d),_.firstElementChild&&_.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends p.E{constructor(_){super();const c=navigator.geolocation;this.options=p.e({geolocation:c},Yf,_),p.aY(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Np(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(_){return this._map=_,this._container=Di("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(_){const c=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,_(d)};void 0!==this._supportsGeolocation?_(this._supportsGeolocation):void 0!==navigator.permissions?navigator.permissions.query({name:"geolocation"}).then(d=>c("denied"!==d.state)).catch(()=>c()):c()}_isOutOfMapMaxBounds(_){const c=this._map.getMaxBounds(),d=_.coords;return!!c&&(d.longitude<c.getWest()||d.longitude>c.getEast()||d.latitude<c.getSouth()||d.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new p.b("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(_),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(_),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new p.b("geolocate",_)),this._finish()}}_updateCamera(_){const c=new p.bn(_.coords.longitude,_.coords.latitude),d=_.coords.accuracy,y=this._map.getBearing(),w=p.e({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(d),w,{geolocateSource:!0})}_updateMarker(_){if(_){const c=new p.bn(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map.transform,c=p.bl(1,_._center.lat)*_.worldSize,d=Math.ceil(2*this._accuracy*c);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(1===_.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===_.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new p.b("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=Di("button","mapboxgl-ctrl-geolocate",this._container),Di("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===_){p.w("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Di("div","mapboxgl-user-location"),this._dotElement.appendChild(Di("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Di("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new $A({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Di("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new $A({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||"ACTIVE_LOCK"!==this._watchState||c.originalEvent&&"resize"===c.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new p.b("trackuserlocationend")))})}}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:!0===_.absolute&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return p.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new p.b("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new p.b("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new p.b("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(_={maximumAge:6e5,timeout:0},this._noTimeout=!0):(_=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(c=>{"granted"===c&&_()}).catch(console.error):_()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:pl,ScaleControl:class{constructor(_){this.options=p.e({},Bl,_),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),p.aY(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const _=this.options.maxWidth||100,c=this._map,d=c._containerHeight/2,y=c._containerWidth/2-_/2,w=c.unproject([y,d]),C=c.unproject([y+_,d]),I=w.distanceTo(C);if("imperial"===this.options.unit){const B=3.2808*I;B>5280?this._setScale(_,B/5280,"mile"):this._setScale(_,B,"foot")}else"nautical"===this.options.unit?this._setScale(_,I/1852,"nautical-mile"):I>=1e3?this._setScale(_,I/1e3,"kilometer"):this._setScale(_,I,"meter")}_setScale(_,c,d){this._map._requestDomTask(()=>{const y=function(C){const I=Math.pow(10,`${Math.floor(C)}`.length-1);let B=C/I;return B=B>=10?10:B>=5?5:B>=3?3:B>=2?2:B>=1?1:function(P){const Q=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*Q)/Q}(B),I*B}(c),w=y/c;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==d?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:d}).format(y):`${y}&nbsp;${bd[d]}`,this._container.style.width=_*w+"px"})}onAdd(_){return this._map=_,this._language=_.getLanguage(),this._container=Di("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(_){this._language=_,this._update()}setUnit(_){this.options.unit=_,this._update()}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:p.w("Full screen control 'container' must be a DOM element.")),p.aY(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=Di("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",p.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=Di("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Di("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends p.E{constructor(_){super(),this.options=p.e(Object.create(qA),_),p.aY(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&_.on("preclick",this._onClose),this.options.closeOnMove&&_.on("move",this._onClose),_.on("remove",this.remove),this._update(),_._addPopup(this),this._focusFirstElement(),this._trackPointer?(_.on("mousemove",this._onMouseEvent),_.on("mouseup",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")):_.on("move",this._update),this.fire(new p.b("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const _=this._map;return _&&(_.off("move",this._update),_.off("move",this._onClose),_.off("preclick",this._onClose),_.off("click",this._onClose),_.off("remove",this.remove),_.off("mousemove",this._onMouseEvent),_.off("mouseup",this._onMouseEvent),_.off("drag",this._onMouseEvent),_._canvasContainer&&_._canvasContainer.classList.remove("mapboxgl-track-pointer"),_._removePopup(this),this._map=void 0),this.fire(new p.b("close")),this}getLngLat(){return this._lngLat}setLngLat(_){this._lngLat=p.bn.convert(_),this._pos=null,this._trackPointer=!1,this._update();const c=this._map;return c&&(c.on("move",this._update),c.off("mousemove",this._onMouseEvent),c._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const _=this._map;return _&&(_.off("move",this._update),_.on("mousemove",this._onMouseEvent),_.on("drag",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const c=document.createDocumentFragment(),d=document.createElement("body");let y;for(d.innerHTML=_;y=d.firstChild,y;)c.appendChild(y);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){let c=this._content;if(c)for(;c.hasChildNodes();)c.firstChild&&c.removeChild(c.firstChild);else c=this._content=Di("div","mapboxgl-popup-content",this._container||void 0);if(c.appendChild(_),this.options.closeButton){const d=this._closeButton=Di("button","mapboxgl-popup-close-button",c);d.type="button",d.setAttribute("aria-label","Close popup"),d.setAttribute("aria-hidden","true"),d.innerHTML="&#215;",d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let c;return this._classList.delete(_)?c=!1:(this._classList.add(_),c=!0),this._updateClassList(),c}_onMouseEvent(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const c=this._map,d=this._container,y=this._pos;if(!c||!d||!y)return"bottom";const w=d.offsetWidth,C=d.offsetHeight,I=y.x<w/2,B=y.x>c.transform.width-w/2;if(y.y+_<C)return I?"top-left":B?"top-right":"top";if(y.y>c.transform.height-C){if(I)return"bottom-left";if(B)return"bottom-right"}return I?"left":B?"right":"bottom"}_updateClassList(){const _=this._container;if(!_)return;const c=[...this._classList];c.push("mapboxgl-popup"),this._anchor&&c.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&c.push("mapboxgl-popup-track-pointer"),_.className=c.join(" ")}_update(_){const c=this._map,d=this._content;if(!c||!this._lngLat&&!this._trackPointer||!d)return;let y=this._container;if(y||(y=this._container=Di("div","mapboxgl-popup",c.getContainer()),this._tip=Di("div","mapboxgl-popup-tip",y),y.appendChild(d)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),c.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=jh(this._lngLat,this._pos,c.transform)),!this._trackPointer||_){const w=this._pos=this._trackPointer&&_?_:c.project(this._lngLat),C=b_(this.options.offset),I=this._anchor=this._getAnchor(C.y),B=b_(this.options.offset,I),P=w.add(B).round();c._requestDomTask(()=>{this._container&&I&&(this._container.style.transform=`${Mu[I]} translate(${P.x}px,${P.y}px)`)})}if(!this._marker&&c._showingGlobe()){const w=p.d6(c.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(G0);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._container&&(this._container.style.opacity=`${_}`),this._content&&(this._content.style.pointerEvents=_?"auto":"none")}},Marker:$A,Style:Mr,LngLat:p.bn,LngLatBounds:p.ad,Point:p.P,MercatorCoordinate:p.L,FreeCameraOptions:Kd,Evented:p.E,config:p.d5,prewarm:p.dp,clearPrewarmedResources:p.dq,get accessToken(){return p.d5.ACCESS_TOKEN},set accessToken(_){p.d5.ACCESS_TOKEN=_},get baseApiUrl(){return p.d5.API_URL},set baseApiUrl(_){p.d5.API_URL=_},get workerCount(){return p.dr.workerCount},set workerCount(_){p.dr.workerCount=_},get maxParallelImageRequests(){return p.d5.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){p.d5.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){p.ds(_)},get workerUrl(){return p.dt.workerUrl},set workerUrl(_){p.dt.workerUrl=_},get workerClass(){return p.dt.workerClass},set workerClass(_){p.dt.workerClass=_},get workerParams(){return p.dt.workerParams},set workerParams(_){p.dt.workerParams=_},get dracoUrl(){return p.du()},set dracoUrl(_){p.dv(_)},get meshoptUrl(){return p.dw()},set meshoptUrl(_){p.dx(_)},setNow:p.f.setNow,restoreNow:p.f.restoreNow}}),qr}()},2614:()=>{"use strict";const Sf=":";const Cu=function(zt,...Ct){if(Cu.translate){const Hn=Cu.translate(zt,Ct);zt=Hn[0],Ct=Hn[1]}let vn=Pc(zt[0],zt.raw[0]);for(let Hn=1;Hn<zt.length;Hn++)vn+=Ct[Hn-1]+Pc(zt[Hn],zt.raw[Hn]);return vn},Eu=":";function Pc(zt,Ct){return Ct.charAt(0)===Eu?zt.substring(function Pd(zt,Ct){for(let vn=1,Hn=1;vn<zt.length;vn++,Hn++)if("\\"===Ct[Hn])Hn++;else if(zt[vn]===Sf)return vn;throw new Error(`Unterminated $localize metadata block in "${Ct}".`)}(zt,Ct)+1):zt}globalThis.$localize=Cu},5861:(Sf,Rc,Zs)=>{"use strict";function qr(vo,p,Ai,Ra,ar,El,Di){try{var ia=vo[El](Di),Wa=ia.value}catch(Sa){return void Ai(Sa)}ia.done?p(Wa):Promise.resolve(Wa).then(Ra,ar)}function Mo(vo){return function(){var p=this,Ai=arguments;return new Promise(function(Ra,ar){var El=vo.apply(p,Ai);function Di(Wa){qr(El,Ra,ar,Di,ia,"next",Wa)}function ia(Wa){qr(El,Ra,ar,Di,ia,"throw",Wa)}Di(void 0)})}}Zs.d(Rc,{Z:()=>Mo})},1002:(Sf,Rc,Zs)=>{"use strict";function qr(Mo){return(qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(vo){return typeof vo}:function(vo){return vo&&"function"==typeof Symbol&&vo.constructor===Symbol&&vo!==Symbol.prototype?"symbol":typeof vo})(Mo)}Zs.d(Rc,{Z:()=>qr})}},Sf=>{var Rc=qr=>Sf(Sf.s=qr);Rc(2614),Rc(3747)}]);